# Comparing `tmp/moleculekit-1.8.6.tar.gz` & `tmp/moleculekit-1.8.7.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "moleculekit-1.8.6.tar", last modified: Fri Nov  3 13:44:13 2023, max compression
+gzip compressed data, was "moleculekit-1.8.7.tar", last modified: Wed Nov  8 13:44:31 2023, max compression
```

## Comparing `moleculekit-1.8.6.tar` & `moleculekit-1.8.7.tar`

### file list

```diff
@@ -1,341 +1,341 @@
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.349877 moleculekit-1.8.6/
--rw-r--r--   0 runner    (1001) docker     (127)     2852 2023-11-03 13:43:26.000000 moleculekit-1.8.6/LICENSE
--rw-r--r--   0 runner    (1001) docker     (127)      414 2023-11-03 13:43:26.000000 moleculekit-1.8.6/MANIFEST.in
--rw-r--r--   0 runner    (1001) docker     (127)     4150 2023-11-03 13:44:13.349877 moleculekit-1.8.6/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (127)     3537 2023-11-03 13:43:26.000000 moleculekit-1.8.6/README.md
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.349877 moleculekit-1.8.6/moleculekit/
--rw-r--r--   0 runner    (1001) docker     (127)      584 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/__init__.py
--rw-r--r--   0 runner    (1001) docker     (127)      497 2023-11-03 13:44:13.349877 moleculekit-1.8.6/moleculekit/_version.py
--rw-r--r--   0 runner    (1001) docker     (127)     8110 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/align.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.277877 moleculekit-1.8.6/moleculekit/atomselect/
--rw-r--r--   0 runner    (1001) docker     (127)        0 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/atomselect/__init__.py
--rw-r--r--   0 runner    (1001) docker     (127)     4622 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/atomselect/analyze.py
--rw-r--r--   0 runner    (1001) docker     (127)    15990 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/atomselect/atomselect.py
--rw-r--r--   0 runner    (1001) docker     (127)    11616 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/atomselect/languageparser.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.277877 moleculekit-1.8.6/moleculekit/atomselect_utils/
--rw-r--r--   0 runner    (1001) docker     (127)  1398460 2023-11-03 13:44:05.000000 moleculekit-1.8.6/moleculekit/atomselect_utils/atomselect_utils.cpp
--rw-r--r--   0 runner    (1001) docker     (127)    23213 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/atomselect_utils/atomselect_utils.pyx
--rw-r--r--   0 runner    (1001) docker     (127)     8643 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/bondguesser.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.281877 moleculekit-1.8.6/moleculekit/bondguesser_utils/
--rw-r--r--   0 runner    (1001) docker     (127)  1196227 2023-11-03 13:44:05.000000 moleculekit-1.8.6/moleculekit/bondguesser_utils/bondguesser_utils.cpp
--rw-r--r--   0 runner    (1001) docker     (127)     5632 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/bondguesser_utils/bondguesser_utils.pyx
--rw-r--r--   0 runner    (1001) docker     (127)     1107 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/config.py
--rw-r--r--   0 runner    (1001) docker     (127)     1474 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/dihedral.py
--rw-r--r--   0 runner    (1001) docker     (127)     4249 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/distance.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.281877 moleculekit-1.8.6/moleculekit/distance_utils/
--rw-r--r--   0 runner    (1001) docker     (127)  1337780 2023-11-03 13:44:06.000000 moleculekit-1.8.6/moleculekit/distance_utils/distance_utils.cpp
--rw-r--r--   0 runner    (1001) docker     (127)    12785 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/distance_utils/distance_utils.pyx
--rw-r--r--   0 runner    (1001) docker     (127)     1582 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/home.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.281877 moleculekit-1.8.6/moleculekit/interactions/
--rw-r--r--   0 runner    (1001) docker     (127)      166 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/interactions/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.285877 moleculekit-1.8.6/moleculekit/interactions/cationpi/
--rw-r--r--   0 runner    (1001) docker     (127)  1196201 2023-11-03 13:44:07.000000 moleculekit-1.8.6/moleculekit/interactions/cationpi/cationpi.cpp
--rw-r--r--   0 runner    (1001) docker     (127)     6473 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/interactions/cationpi/cationpi.pyx
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.285877 moleculekit-1.8.6/moleculekit/interactions/hbonds/
--rw-r--r--   0 runner    (1001) docker     (127)  1177014 2023-11-03 13:44:08.000000 moleculekit-1.8.6/moleculekit/interactions/hbonds/hbonds.cpp
--rw-r--r--   0 runner    (1001) docker     (127)     5197 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/interactions/hbonds/hbonds.pyx
--rw-r--r--   0 runner    (1001) docker     (127)    33169 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/interactions/interactions.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.285877 moleculekit-1.8.6/moleculekit/interactions/pipi/
--rw-r--r--   0 runner    (1001) docker     (127)  1201728 2023-11-03 13:44:08.000000 moleculekit-1.8.6/moleculekit/interactions/pipi/pipi.cpp
--rw-r--r--   0 runner    (1001) docker     (127)     7398 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/interactions/pipi/pipi.pyx
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.289877 moleculekit-1.8.6/moleculekit/interactions/sigmahole/
--rw-r--r--   0 runner    (1001) docker     (127)  1190181 2023-11-03 13:44:09.000000 moleculekit-1.8.6/moleculekit/interactions/sigmahole/sigmahole.cpp
--rw-r--r--   0 runner    (1001) docker     (127)     6448 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/interactions/sigmahole/sigmahole.pyx
--rw-r--r--   0 runner    (1001) docker     (127)      428 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/logging.ini
--rw-r--r--   0 runner    (1001) docker     (127)   116818 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/molecule.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.289877 moleculekit-1.8.6/moleculekit/occupancy_utils/
--rw-r--r--   0 runner    (1001) docker     (127)  1116070 2023-11-03 13:44:10.000000 moleculekit-1.8.6/moleculekit/occupancy_utils/occupancy_utils.cpp
--rw-r--r--   0 runner    (1001) docker     (127)     2033 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/occupancy_utils/occupancy_utils.pyx
--rw-r--r--   0 runner    (1001) docker     (127)     9600 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/opm.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.289877 moleculekit-1.8.6/moleculekit/pdbx/
--rw-r--r--   0 runner    (1001) docker     (127)        0 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/pdbx/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.289877 moleculekit-1.8.6/moleculekit/pdbx/reader/
--rw-r--r--   0 runner    (1001) docker     (127)    29964 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/pdbx/reader/PdbxContainers.py
--rw-r--r--   0 runner    (1001) docker     (127)    23002 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/pdbx/reader/PdbxParser.py
--rw-r--r--   0 runner    (1001) docker     (127)    16953 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/pdbx/reader/PdbxReader.py
--rw-r--r--   0 runner    (1001) docker     (127)        0 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/pdbx/reader/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.293877 moleculekit-1.8.6/moleculekit/pdbx/tests/
--rw-r--r--   0 runner    (1001) docker     (127)     8486 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/pdbx/tests/PdbxReadWriteTests.py
--rw-r--r--   0 runner    (1001) docker     (127)     4131 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/pdbx/tests/PdbxReaderTests.py
--rw-r--r--   0 runner    (1001) docker     (127)     5623 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/pdbx/tests/PdbxWriterTests.py
--rw-r--r--   0 runner    (1001) docker     (127)        0 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/pdbx/tests/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.293877 moleculekit-1.8.6/moleculekit/pdbx/writer/
--rw-r--r--   0 runner    (1001) docker     (127)     6656 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/pdbx/writer/PdbxWriter.py
--rw-r--r--   0 runner    (1001) docker     (127)        0 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/pdbx/writer/__init__.py
--rw-r--r--   0 runner    (1001) docker     (127)    14346 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/periodictable.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.293877 moleculekit-1.8.6/moleculekit/ply/
--rw-r--r--   0 runner    (1001) docker     (127)      116 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/ply/__init__.py
--rw-r--r--   0 runner    (1001) docker     (127)    36635 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/ply/lex.py
--rw-r--r--   0 runner    (1001) docker     (127)   100927 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/ply/yacc.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.293877 moleculekit-1.8.6/moleculekit/projections/
--rw-r--r--   0 runner    (1001) docker     (127)      166 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/projections/__init__.py
--rw-r--r--   0 runner    (1001) docker     (127)    12859 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/projections/metriccoordinate.py
--rw-r--r--   0 runner    (1001) docker     (127)    33841 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/projections/metricdihedral.py
--rw-r--r--   0 runner    (1001) docker     (127)    35882 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/projections/metricdistance.py
--rw-r--r--   0 runner    (1001) docker     (127)    10902 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/projections/metricfluctuation.py
--rw-r--r--   0 runner    (1001) docker     (127)     7145 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/projections/metricgyration.py
--rw-r--r--   0 runner    (1001) docker     (127)    27840 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/projections/metricplumed2.py
--rw-r--r--   0 runner    (1001) docker     (127)     7357 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/projections/metricrmsd.py
--rw-r--r--   0 runner    (1001) docker     (127)    11748 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/projections/metricsasa.py
--rw-r--r--   0 runner    (1001) docker     (127)    10752 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/projections/metricsecondarystructure.py
--rw-r--r--   0 runner    (1001) docker     (127)     8486 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/projections/metricshell.py
--rw-r--r--   0 runner    (1001) docker     (127)     6348 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/projections/metricsphericalcoordinate.py
--rw-r--r--   0 runner    (1001) docker     (127)     4785 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/projections/metrictmscore.py
--rw-r--r--   0 runner    (1001) docker     (127)     1208 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/projections/projection.py
--rw-r--r--   0 runner    (1001) docker     (127)     7663 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/projections/util.py
--rw-r--r--   0 runner    (1001) docker     (127)      645 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/pymolgraphics.py
--rw-r--r--   0 runner    (1001) docker     (127)     2451 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/rcsb.py
--rw-r--r--   0 runner    (1001) docker     (127)     3856 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/rdkitintegration.py
--rw-r--r--   0 runner    (1001) docker     (127)   110953 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/readers.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.297877 moleculekit-1.8.6/moleculekit/share/
--rw-r--r--   0 runner    (1001) docker     (127)     5030 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/share/ALA.cif
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.313877 moleculekit-1.8.6/moleculekit/share/atomselect/
--rw-r--r--   0 runner    (1001) docker     (127)     1510 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/share/atomselect/atomselect.json
--rw-r--r--   0 runner    (1001) docker     (127)     1159 2023-11-03 13:43:26.000000 moleculekit-1.8.6/moleculekit/share/backbone.cif
--rw-r--r--   0 runner    (1001) docker     (127) 13559789 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/opm_sequences.json
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.269877 moleculekit-1.8.6/moleculekit/share/pdb2pqr/
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.337877 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/
--rw-r--r--   0 runner    (1001) docker     (127)        0 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/.gitkeep
--rw-r--r--   0 runner    (1001) docker     (127)      310 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/004.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2614 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/004.xml
--rw-r--r--   0 runner    (1001) docker     (127)      258 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/03Y.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2125 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/03Y.xml
--rw-r--r--   0 runner    (1001) docker     (127)      441 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/0A1.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3645 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/0A1.xml
--rw-r--r--   0 runner    (1001) docker     (127)      462 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/0AF.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3851 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/0AF.xml
--rw-r--r--   0 runner    (1001) docker     (127)      479 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/0BN.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3946 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/0BN.xml
--rw-r--r--   0 runner    (1001) docker     (127)      345 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/1MH.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2899 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/1MH.xml
--rw-r--r--   0 runner    (1001) docker     (127)      271 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/2AS.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2263 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/2AS.xml
--rw-r--r--   0 runner    (1001) docker     (127)      556 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/2GX.dat
--rw-r--r--   0 runner    (1001) docker     (127)     4614 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/2GX.xml
--rw-r--r--   0 runner    (1001) docker     (127)      418 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/2ML.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3357 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/2ML.xml
--rw-r--r--   0 runner    (1001) docker     (127)      560 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/2MR.dat
--rw-r--r--   0 runner    (1001) docker     (127)     4541 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/2MR.xml
--rw-r--r--   0 runner    (1001) docker     (127)      484 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/4IN.dat
--rw-r--r--   0 runner    (1001) docker     (127)     4018 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/4IN.xml
--rw-r--r--   0 runner    (1001) docker     (127)      426 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/4PH.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3509 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/4PH.xml
--rw-r--r--   0 runner    (1001) docker     (127)      488 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/4PQ.dat
--rw-r--r--   0 runner    (1001) docker     (127)     4019 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/4PQ.xml
--rw-r--r--   0 runner    (1001) docker     (127)      254 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/5JP.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2113 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/5JP.xml
--rw-r--r--   0 runner    (1001) docker     (127)      308 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/AA4.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2565 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/AA4.xml
--rw-r--r--   0 runner    (1001) docker     (127)      235 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ABA.dat
--rw-r--r--   0 runner    (1001) docker     (127)     1966 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ABA.xml
--rw-r--r--   0 runner    (1001) docker     (127)      403 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/AHP.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3310 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/AHP.xml
--rw-r--r--   0 runner    (1001) docker     (127)      489 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ALC.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3988 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ALC.xml
--rw-r--r--   0 runner    (1001) docker     (127)      483 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ALN.dat
--rw-r--r--   0 runner    (1001) docker     (127)     4032 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ALN.xml
--rw-r--r--   0 runner    (1001) docker     (127)      479 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ALY.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3924 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ALY.xml
--rw-r--r--   0 runner    (1001) docker     (127)      427 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/APD.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3507 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/APD.xml
--rw-r--r--   0 runner    (1001) docker     (127)      382 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/BB8.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3197 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/BB8.xml
--rw-r--r--   0 runner    (1001) docker     (127)      440 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/BCS.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3666 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/BCS.xml
--rw-r--r--   0 runner    (1001) docker     (127)      597 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/BTK.dat
--rw-r--r--   0 runner    (1001) docker     (127)     4823 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/BTK.xml
--rw-r--r--   0 runner    (1001) docker     (127)      290 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/CCS.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2406 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/CCS.xml
--rw-r--r--   0 runner    (1001) docker     (127)      353 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/CGU.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2887 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/CGU.xml
--rw-r--r--   0 runner    (1001) docker     (127)      345 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/CSA.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2863 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/CSA.xml
--rw-r--r--   0 runner    (1001) docker     (127)      215 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/CSO.dat
--rw-r--r--   0 runner    (1001) docker     (127)     1817 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/CSO.xml
--rw-r--r--   0 runner    (1001) docker     (127)      292 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/CSP.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2418 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/CSP.xml
--rw-r--r--   0 runner    (1001) docker     (127)      215 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/CSS.dat
--rw-r--r--   0 runner    (1001) docker     (127)     1818 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/CSS.xml
--rw-r--r--   0 runner    (1001) docker     (127)      320 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/D4P.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2738 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/D4P.xml
--rw-r--r--   0 runner    (1001) docker     (127)      565 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/DA2.dat
--rw-r--r--   0 runner    (1001) docker     (127)     4542 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/DA2.xml
--rw-r--r--   0 runner    (1001) docker     (127)      291 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/DAB.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2412 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/DAB.xml
--rw-r--r--   0 runner    (1001) docker     (127)      403 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/DAH.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3352 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/DAH.xml
--rw-r--r--   0 runner    (1001) docker     (127)      235 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/DPP.dat
--rw-r--r--   0 runner    (1001) docker     (127)     1968 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/DPP.xml
--rw-r--r--   0 runner    (1001) docker     (127)      365 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ESC.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3004 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ESC.xml
--rw-r--r--   0 runner    (1001) docker     (127)      160 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/FGL.dat
--rw-r--r--   0 runner    (1001) docker     (127)     1375 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/FGL.xml
--rw-r--r--   0 runner    (1001) docker     (127)      330 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/GHG.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2724 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/GHG.xml
--rw-r--r--   0 runner    (1001) docker     (127)      347 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/GME.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2863 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/GME.xml
--rw-r--r--   0 runner    (1001) docker     (127)      373 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/GNC.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3033 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/GNC.xml
--rw-r--r--   0 runner    (1001) docker     (127)      515 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HHK.dat
--rw-r--r--   0 runner    (1001) docker     (127)     4198 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HHK.xml
--rw-r--r--   0 runner    (1001) docker     (127)      370 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HLU.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3021 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HLU.xml
--rw-r--r--   0 runner    (1001) docker     (127)      410 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HLX.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3323 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HLX.xml
--rw-r--r--   0 runner    (1001) docker     (127)      404 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HOX.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3352 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HOX.xml
--rw-r--r--   0 runner    (1001) docker     (127)      422 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HPE.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3497 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HPE.xml
--rw-r--r--   0 runner    (1001) docker     (127)      486 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HQA.dat
--rw-r--r--   0 runner    (1001) docker     (127)     4014 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HQA.xml
--rw-r--r--   0 runner    (1001) docker     (127)      460 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HTR.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3844 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HTR.xml
--rw-r--r--   0 runner    (1001) docker     (127)      275 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HYP.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2312 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HYP.xml
--rw-r--r--   0 runner    (1001) docker     (127)      418 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/I2M.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3346 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/I2M.xml
--rw-r--r--   0 runner    (1001) docker     (127)      448 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/IGL.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3727 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/IGL.xml
--rw-r--r--   0 runner    (1001) docker     (127)      357 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/IIL.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2889 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/IIL.xml
--rw-r--r--   0 runner    (1001) docker     (127)      415 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/IML.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3342 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/IML.xml
--rw-r--r--   0 runner    (1001) docker     (127)      439 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/KYN.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3642 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/KYN.xml
--rw-r--r--   0 runner    (1001) docker     (127)      327 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/LME.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2707 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/LME.xml
--rw-r--r--   0 runner    (1001) docker     (127)      372 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/LMQ.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3030 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/LMQ.xml
--rw-r--r--   0 runner    (1001) docker     (127)      419 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/LYZ.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3444 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/LYZ.xml
--rw-r--r--   0 runner    (1001) docker     (127)      583 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/M3L.dat
--rw-r--r--   0 runner    (1001) docker     (127)     4687 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/M3L.xml
--rw-r--r--   0 runner    (1001) docker     (127)      322 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ME0.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2700 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ME0.xml
--rw-r--r--   0 runner    (1001) docker     (127)      424 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MEA.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3518 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MEA.xml
--rw-r--r--   0 runner    (1001) docker     (127)      314 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MEN.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2576 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MEN.xml
--rw-r--r--   0 runner    (1001) docker     (127)      367 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MEQ.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3015 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MEQ.xml
--rw-r--r--   0 runner    (1001) docker     (127)      412 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MLE.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3334 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MLE.xml
--rw-r--r--   0 runner    (1001) docker     (127)      523 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MLY.dat
--rw-r--r--   0 runner    (1001) docker     (127)     4234 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MLY.xml
--rw-r--r--   0 runner    (1001) docker     (127)      461 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MLZ.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3770 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MLZ.xml
--rw-r--r--   0 runner    (1001) docker     (127)      367 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MME.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3017 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MME.xml
--rw-r--r--   0 runner    (1001) docker     (127)      502 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MMO.dat
--rw-r--r--   0 runner    (1001) docker     (127)     4069 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MMO.xml
--rw-r--r--   0 runner    (1001) docker     (127)      356 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MVA.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2885 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MVA.xml
--rw-r--r--   0 runner    (1001) docker     (127)      468 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/NAL.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3983 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/NAL.xml
--rw-r--r--   0 runner    (1001) docker     (127)      254 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/NCY.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2114 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/NCY.xml
--rw-r--r--   0 runner    (1001) docker     (127)      347 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/NLE.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2865 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/NLE.xml
--rw-r--r--   0 runner    (1001) docker     (127)      291 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/NVA.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2417 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/NVA.xml
--rw-r--r--   0 runner    (1001) docker     (127)      319 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/NZC.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2583 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/NZC.xml
--rw-r--r--   0 runner    (1001) docker     (127)      326 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/OCY.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2713 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/OCY.xml
--rw-r--r--   0 runner    (1001) docker     (127)      400 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/OMX.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3359 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/OMX.xml
--rw-r--r--   0 runner    (1001) docker     (127)      327 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ONL.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2714 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ONL.xml
--rw-r--r--   0 runner    (1001) docker     (127)      347 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ORM.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2869 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ORM.xml
--rw-r--r--   0 runner    (1001) docker     (127)     1088 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/P1L.dat
--rw-r--r--   0 runner    (1001) docker     (127)     8741 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/P1L.xml
--rw-r--r--   0 runner    (1001) docker     (127)      235 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/PCA.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2008 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/PCA.xml
--rw-r--r--   0 runner    (1001) docker     (127)      538 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/PRK.dat
--rw-r--r--   0 runner    (1001) docker     (127)     4386 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/PRK.xml
--rw-r--r--   0 runner    (1001) docker     (127)      444 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/PTR.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3645 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/PTR.xml
--rw-r--r--   0 runner    (1001) docker     (127)      252 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/SEP.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2106 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/SEP.xml
--rw-r--r--   0 runner    (1001) docker     (127)      312 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/TPO.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2562 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/TPO.xml
--rw-r--r--   0 runner    (1001) docker     (127)      463 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/TRO.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3862 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/TRO.xml
--rw-r--r--   0 runner    (1001) docker     (127)      421 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/TY2.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3499 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/TY2.xml
--rw-r--r--   0 runner    (1001) docker     (127)      440 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/TYQ.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3651 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/TYQ.xml
--rw-r--r--   0 runner    (1001) docker     (127)      330 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/YCM.dat
--rw-r--r--   0 runner    (1001) docker     (127)     2714 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/YCM.xml
--rw-r--r--   0 runner    (1001) docker     (127)      446 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/YNM.dat
--rw-r--r--   0 runner    (1001) docker     (127)     3673 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/YNM.xml
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.341877 moleculekit-1.8.6/moleculekit/smallmol/
--rw-r--r--   0 runner    (1001) docker     (127)      166 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/smallmol/__init__.py
--rw-r--r--   0 runner    (1001) docker     (127)    43085 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/smallmol/smallmol.py
--rw-r--r--   0 runner    (1001) docker     (127)    16357 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/smallmol/smallmollib.py
--rw-r--r--   0 runner    (1001) docker     (127)     9038 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/smallmol/test_smallmol.py
--rw-r--r--   0 runner    (1001) docker     (127)     5267 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/smallmol/test_smallmollib.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.341877 moleculekit-1.8.6/moleculekit/smallmol/tools/
--rw-r--r--   0 runner    (1001) docker     (127)      166 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/smallmol/tools/__init__.py
--rw-r--r--   0 runner    (1001) docker     (127)    12245 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/smallmol/tools/clustering.py
--rw-r--r--   0 runner    (1001) docker     (127)     2089 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/smallmol/tools/restrainedembed.py
--rw-r--r--   0 runner    (1001) docker     (127)     9657 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/smallmol/tools/test_tools.py
--rw-r--r--   0 runner    (1001) docker     (127)    11720 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/smallmol/util.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.341877 moleculekit-1.8.6/moleculekit/tmalign/
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.341877 moleculekit-1.8.6/moleculekit/tmalign/include/
--rw-r--r--   0 runner    (1001) docker     (127)     1976 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/tmalign/include/TMAlign.h
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.341877 moleculekit-1.8.6/moleculekit/tmalign/src/
--rw-r--r--   0 runner    (1001) docker     (127)   193828 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/tmalign/src/TMAlign.cpp
--rw-r--r--   0 runner    (1001) docker     (127)  1153130 2023-11-03 13:44:10.000000 moleculekit-1.8.6/moleculekit/tmalign/tmalign_util.cpp
--rw-r--r--   0 runner    (1001) docker     (127)     4411 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/tmalign/tmalign_util.pyx
--rw-r--r--   0 runner    (1001) docker     (127)     1659 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/tmalign/tmalignlib.pxd
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.345877 moleculekit-1.8.6/moleculekit/tools/
--rw-r--r--   0 runner    (1001) docker     (127)      166 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/tools/__init__.py
--rw-r--r--   0 runner    (1001) docker     (127)    15163 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/tools/atomtyper.py
--rw-r--r--   0 runner    (1001) docker     (127)    12233 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/tools/autosegment.py
--rw-r--r--   0 runner    (1001) docker     (127)     9955 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/tools/crystalpacking.py
--rw-r--r--   0 runner    (1001) docker     (127)    30487 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/tools/detect.py
--rw-r--r--   0 runner    (1001) docker     (127)     7809 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/tools/docking.py
--rw-r--r--   0 runner    (1001) docker     (127)     9948 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/tools/graphalignment.py
--rw-r--r--   0 runner    (1001) docker     (127)     3973 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/tools/hhblitsprofile.py
--rw-r--r--   0 runner    (1001) docker     (127)     5421 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/tools/moleculechecks.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.345877 moleculekit-1.8.6/moleculekit/tools/obabel_tools/
--rw-r--r--   0 runner    (1001) docker     (127)     2635 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/tools/obabel_tools/__init__.py
--rw-r--r--   0 runner    (1001) docker     (127)     1764 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/tools/obabel_tools/obabel_cli.py
--rw-r--r--   0 runner    (1001) docker     (127)    51713 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/tools/preparation.py
--rw-r--r--   0 runner    (1001) docker     (127)    14329 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/tools/preparation_customres.py
--rw-r--r--   0 runner    (1001) docker     (127)     8446 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/tools/sequencestructuralalignment.py
--rw-r--r--   0 runner    (1001) docker     (127)    22600 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/tools/voxeldescriptors.py
--rw-r--r--   0 runner    (1001) docker     (127)    23670 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/util.py
--rw-r--r--   0 runner    (1001) docker     (127)      205 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/version.py
--rw-r--r--   0 runner    (1001) docker     (127)     5079 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/viewer.py
--rwxr-xr-x   0 runner    (1001) docker     (127)     1957 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/vmd_wrapper
--rw-r--r--   0 runner    (1001) docker     (127)    12009 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/vmdgraphics.py
--rwxr-xr-x   0 runner    (1001) docker     (127)    12291 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/vmdviewer.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.345877 moleculekit-1.8.6/moleculekit/wrapping/
--rw-r--r--   0 runner    (1001) docker     (127)  1131614 2023-11-03 13:44:11.000000 moleculekit-1.8.6/moleculekit/wrapping/wrapping.cpp
--rw-r--r--   0 runner    (1001) docker     (127)     2814 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/wrapping/wrapping.pyx
--rw-r--r--   0 runner    (1001) docker     (127)    45295 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/writers.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.349877 moleculekit-1.8.6/moleculekit/xtc_utils/
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.349877 moleculekit-1.8.6/moleculekit/xtc_utils/include/
--rw-r--r--   0 runner    (1001) docker     (127)    23963 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/xtc_utils/include/xdrfile.h
--rw-r--r--   0 runner    (1001) docker     (127)     1212 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/xtc_utils/include/xdrfile_xtc.h
--rw-r--r--   0 runner    (1001) docker     (127)     1464 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/xtc_utils/include/xtc.h
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.349877 moleculekit-1.8.6/moleculekit/xtc_utils/src/
--rw-r--r--   0 runner    (1001) docker     (127)    64607 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/xtc_utils/src/xdrfile.cpp
--rw-r--r--   0 runner    (1001) docker     (127)     2835 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/xtc_utils/src/xdrfile_xtc.cpp
--rw-r--r--   0 runner    (1001) docker     (127)    13327 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/xtc_utils/src/xtc.cpp
--rw-r--r--   0 runner    (1001) docker     (127)  1171332 2023-11-03 13:44:12.000000 moleculekit-1.8.6/moleculekit/xtc_utils/xtc.cpp
--rw-r--r--   0 runner    (1001) docker     (127)     3257 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/xtc_utils/xtc.pyx
--rw-r--r--   0 runner    (1001) docker     (127)      580 2023-11-03 13:43:27.000000 moleculekit-1.8.6/moleculekit/xtc_utils/xtclib.pxd
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-03 13:44:13.273877 moleculekit-1.8.6/moleculekit.egg-info/
--rw-r--r--   0 runner    (1001) docker     (127)     4150 2023-11-03 13:44:13.000000 moleculekit-1.8.6/moleculekit.egg-info/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (127)    12079 2023-11-03 13:44:13.000000 moleculekit-1.8.6/moleculekit.egg-info/SOURCES.txt
--rw-r--r--   0 runner    (1001) docker     (127)        1 2023-11-03 13:44:13.000000 moleculekit-1.8.6/moleculekit.egg-info/dependency_links.txt
--rw-r--r--   0 runner    (1001) docker     (127)        1 2023-11-03 13:44:12.000000 moleculekit-1.8.6/moleculekit.egg-info/not-zip-safe
--rw-r--r--   0 runner    (1001) docker     (127)       54 2023-11-03 13:44:13.000000 moleculekit-1.8.6/moleculekit.egg-info/requires.txt
--rw-r--r--   0 runner    (1001) docker     (127)       12 2023-11-03 13:44:13.000000 moleculekit-1.8.6/moleculekit.egg-info/top_level.txt
--rw-r--r--   0 runner    (1001) docker     (127)     1158 2023-11-03 13:43:27.000000 moleculekit-1.8.6/pyproject.toml
--rw-r--r--   0 runner    (1001) docker     (127)      212 2023-11-03 13:44:13.349877 moleculekit-1.8.6/setup.cfg
--rw-r--r--   0 runner    (1001) docker     (127)     1974 2023-11-03 13:43:27.000000 moleculekit-1.8.6/setup.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:31.068814 moleculekit-1.8.7/
+-rw-r--r--   0 runner    (1001) docker     (127)     2852 2023-11-08 13:43:53.000000 moleculekit-1.8.7/LICENSE
+-rw-r--r--   0 runner    (1001) docker     (127)      414 2023-11-08 13:43:53.000000 moleculekit-1.8.7/MANIFEST.in
+-rw-r--r--   0 runner    (1001) docker     (127)     4150 2023-11-08 13:44:31.068814 moleculekit-1.8.7/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (127)     3537 2023-11-08 13:43:53.000000 moleculekit-1.8.7/README.md
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:31.068814 moleculekit-1.8.7/moleculekit/
+-rw-r--r--   0 runner    (1001) docker     (127)      584 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (127)      497 2023-11-08 13:44:31.068814 moleculekit-1.8.7/moleculekit/_version.py
+-rw-r--r--   0 runner    (1001) docker     (127)     8110 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/align.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:30.984814 moleculekit-1.8.7/moleculekit/atomselect/
+-rw-r--r--   0 runner    (1001) docker     (127)        0 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/atomselect/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (127)     4622 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/atomselect/analyze.py
+-rw-r--r--   0 runner    (1001) docker     (127)    15990 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/atomselect/atomselect.py
+-rw-r--r--   0 runner    (1001) docker     (127)    11616 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/atomselect/languageparser.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:30.988813 moleculekit-1.8.7/moleculekit/atomselect_utils/
+-rw-r--r--   0 runner    (1001) docker     (127)  1376089 2023-11-08 13:44:22.000000 moleculekit-1.8.7/moleculekit/atomselect_utils/atomselect_utils.cpp
+-rw-r--r--   0 runner    (1001) docker     (127)    22391 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/atomselect_utils/atomselect_utils.pyx
+-rw-r--r--   0 runner    (1001) docker     (127)     9080 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/bondguesser.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:30.988813 moleculekit-1.8.7/moleculekit/bondguesser_utils/
+-rw-r--r--   0 runner    (1001) docker     (127)  1196227 2023-11-08 13:44:23.000000 moleculekit-1.8.7/moleculekit/bondguesser_utils/bondguesser_utils.cpp
+-rw-r--r--   0 runner    (1001) docker     (127)     5632 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/bondguesser_utils/bondguesser_utils.pyx
+-rw-r--r--   0 runner    (1001) docker     (127)     1107 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/config.py
+-rw-r--r--   0 runner    (1001) docker     (127)     1474 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/dihedral.py
+-rw-r--r--   0 runner    (1001) docker     (127)     4249 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/distance.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:30.992813 moleculekit-1.8.7/moleculekit/distance_utils/
+-rw-r--r--   0 runner    (1001) docker     (127)  1337780 2023-11-08 13:44:24.000000 moleculekit-1.8.7/moleculekit/distance_utils/distance_utils.cpp
+-rw-r--r--   0 runner    (1001) docker     (127)    12785 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/distance_utils/distance_utils.pyx
+-rw-r--r--   0 runner    (1001) docker     (127)     1582 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/home.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:30.992813 moleculekit-1.8.7/moleculekit/interactions/
+-rw-r--r--   0 runner    (1001) docker     (127)      166 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/interactions/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:30.992813 moleculekit-1.8.7/moleculekit/interactions/cationpi/
+-rw-r--r--   0 runner    (1001) docker     (127)  1196201 2023-11-08 13:44:24.000000 moleculekit-1.8.7/moleculekit/interactions/cationpi/cationpi.cpp
+-rw-r--r--   0 runner    (1001) docker     (127)     6473 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/interactions/cationpi/cationpi.pyx
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:30.996814 moleculekit-1.8.7/moleculekit/interactions/hbonds/
+-rw-r--r--   0 runner    (1001) docker     (127)  1177014 2023-11-08 13:44:25.000000 moleculekit-1.8.7/moleculekit/interactions/hbonds/hbonds.cpp
+-rw-r--r--   0 runner    (1001) docker     (127)     5197 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/interactions/hbonds/hbonds.pyx
+-rw-r--r--   0 runner    (1001) docker     (127)    33169 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/interactions/interactions.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:30.996814 moleculekit-1.8.7/moleculekit/interactions/pipi/
+-rw-r--r--   0 runner    (1001) docker     (127)  1201728 2023-11-08 13:44:26.000000 moleculekit-1.8.7/moleculekit/interactions/pipi/pipi.cpp
+-rw-r--r--   0 runner    (1001) docker     (127)     7398 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/interactions/pipi/pipi.pyx
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:30.996814 moleculekit-1.8.7/moleculekit/interactions/sigmahole/
+-rw-r--r--   0 runner    (1001) docker     (127)  1190181 2023-11-08 13:44:26.000000 moleculekit-1.8.7/moleculekit/interactions/sigmahole/sigmahole.cpp
+-rw-r--r--   0 runner    (1001) docker     (127)     6448 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/interactions/sigmahole/sigmahole.pyx
+-rw-r--r--   0 runner    (1001) docker     (127)      428 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/logging.ini
+-rw-r--r--   0 runner    (1001) docker     (127)   118138 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/molecule.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:31.000814 moleculekit-1.8.7/moleculekit/occupancy_utils/
+-rw-r--r--   0 runner    (1001) docker     (127)  1116070 2023-11-08 13:44:27.000000 moleculekit-1.8.7/moleculekit/occupancy_utils/occupancy_utils.cpp
+-rw-r--r--   0 runner    (1001) docker     (127)     2033 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/occupancy_utils/occupancy_utils.pyx
+-rw-r--r--   0 runner    (1001) docker     (127)     9600 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/opm.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:31.000814 moleculekit-1.8.7/moleculekit/pdbx/
+-rw-r--r--   0 runner    (1001) docker     (127)        0 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/pdbx/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:31.000814 moleculekit-1.8.7/moleculekit/pdbx/reader/
+-rw-r--r--   0 runner    (1001) docker     (127)    29964 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/pdbx/reader/PdbxContainers.py
+-rw-r--r--   0 runner    (1001) docker     (127)    23002 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/pdbx/reader/PdbxParser.py
+-rw-r--r--   0 runner    (1001) docker     (127)    16953 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/pdbx/reader/PdbxReader.py
+-rw-r--r--   0 runner    (1001) docker     (127)        0 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/pdbx/reader/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:31.000814 moleculekit-1.8.7/moleculekit/pdbx/tests/
+-rw-r--r--   0 runner    (1001) docker     (127)     8486 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/pdbx/tests/PdbxReadWriteTests.py
+-rw-r--r--   0 runner    (1001) docker     (127)     4131 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/pdbx/tests/PdbxReaderTests.py
+-rw-r--r--   0 runner    (1001) docker     (127)     5623 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/pdbx/tests/PdbxWriterTests.py
+-rw-r--r--   0 runner    (1001) docker     (127)        0 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/pdbx/tests/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:31.000814 moleculekit-1.8.7/moleculekit/pdbx/writer/
+-rw-r--r--   0 runner    (1001) docker     (127)     6656 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/pdbx/writer/PdbxWriter.py
+-rw-r--r--   0 runner    (1001) docker     (127)        0 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/pdbx/writer/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (127)    14346 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/periodictable.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:31.004814 moleculekit-1.8.7/moleculekit/ply/
+-rw-r--r--   0 runner    (1001) docker     (127)      116 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/ply/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (127)    36635 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/ply/lex.py
+-rw-r--r--   0 runner    (1001) docker     (127)   100927 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/ply/yacc.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:31.004814 moleculekit-1.8.7/moleculekit/projections/
+-rw-r--r--   0 runner    (1001) docker     (127)      166 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/projections/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (127)    12859 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/projections/metriccoordinate.py
+-rw-r--r--   0 runner    (1001) docker     (127)    33841 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/projections/metricdihedral.py
+-rw-r--r--   0 runner    (1001) docker     (127)    35882 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/projections/metricdistance.py
+-rw-r--r--   0 runner    (1001) docker     (127)    10902 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/projections/metricfluctuation.py
+-rw-r--r--   0 runner    (1001) docker     (127)     7145 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/projections/metricgyration.py
+-rw-r--r--   0 runner    (1001) docker     (127)    27840 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/projections/metricplumed2.py
+-rw-r--r--   0 runner    (1001) docker     (127)     7357 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/projections/metricrmsd.py
+-rw-r--r--   0 runner    (1001) docker     (127)    11748 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/projections/metricsasa.py
+-rw-r--r--   0 runner    (1001) docker     (127)    10752 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/projections/metricsecondarystructure.py
+-rw-r--r--   0 runner    (1001) docker     (127)     8486 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/projections/metricshell.py
+-rw-r--r--   0 runner    (1001) docker     (127)     6348 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/projections/metricsphericalcoordinate.py
+-rw-r--r--   0 runner    (1001) docker     (127)     4785 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/projections/metrictmscore.py
+-rw-r--r--   0 runner    (1001) docker     (127)     1208 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/projections/projection.py
+-rw-r--r--   0 runner    (1001) docker     (127)     7663 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/projections/util.py
+-rw-r--r--   0 runner    (1001) docker     (127)      645 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/pymolgraphics.py
+-rw-r--r--   0 runner    (1001) docker     (127)     2451 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/rcsb.py
+-rw-r--r--   0 runner    (1001) docker     (127)     3856 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/rdkitintegration.py
+-rw-r--r--   0 runner    (1001) docker     (127)   110953 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/readers.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:31.004814 moleculekit-1.8.7/moleculekit/share/
+-rw-r--r--   0 runner    (1001) docker     (127)     5030 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/ALA.cif
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:31.020814 moleculekit-1.8.7/moleculekit/share/atomselect/
+-rw-r--r--   0 runner    (1001) docker     (127)     1510 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/atomselect/atomselect.json
+-rw-r--r--   0 runner    (1001) docker     (127)     1159 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/backbone.cif
+-rw-r--r--   0 runner    (1001) docker     (127) 13559789 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/opm_sequences.json
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:30.976813 moleculekit-1.8.7/moleculekit/share/pdb2pqr/
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:31.052814 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/
+-rw-r--r--   0 runner    (1001) docker     (127)        0 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/.gitkeep
+-rw-r--r--   0 runner    (1001) docker     (127)      310 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/004.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2614 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/004.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      258 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/03Y.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2125 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/03Y.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      441 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/0A1.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3645 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/0A1.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      462 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/0AF.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3851 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/0AF.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      479 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/0BN.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3946 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/0BN.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      345 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/1MH.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2899 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/1MH.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      271 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/2AS.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2263 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/2AS.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      556 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/2GX.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     4614 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/2GX.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      418 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/2ML.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3357 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/2ML.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      560 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/2MR.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     4541 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/2MR.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      484 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/4IN.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     4018 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/4IN.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      426 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/4PH.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3509 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/4PH.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      488 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/4PQ.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     4019 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/4PQ.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      254 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/5JP.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2113 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/5JP.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      308 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/AA4.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2565 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/AA4.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      235 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ABA.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     1966 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ABA.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      403 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/AHP.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3310 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/AHP.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      489 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ALC.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3988 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ALC.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      483 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ALN.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     4032 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ALN.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      479 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ALY.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3924 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ALY.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      427 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/APD.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3507 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/APD.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      382 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/BB8.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3197 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/BB8.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      440 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/BCS.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3666 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/BCS.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      597 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/BTK.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     4823 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/BTK.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      290 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/CCS.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2406 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/CCS.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      353 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/CGU.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2887 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/CGU.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      345 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/CSA.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2863 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/CSA.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      215 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/CSO.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     1817 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/CSO.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      292 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/CSP.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2418 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/CSP.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      215 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/CSS.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     1818 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/CSS.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      320 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/D4P.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2738 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/D4P.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      565 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/DA2.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     4542 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/DA2.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      291 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/DAB.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2412 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/DAB.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      403 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/DAH.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3352 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/DAH.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      235 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/DPP.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     1968 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/DPP.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      365 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ESC.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3004 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ESC.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      160 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/FGL.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     1375 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/FGL.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      330 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/GHG.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2724 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/GHG.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      347 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/GME.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2863 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/GME.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      373 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/GNC.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3033 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/GNC.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      515 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HHK.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     4198 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HHK.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      370 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HLU.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3021 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HLU.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      410 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HLX.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3323 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HLX.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      404 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HOX.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3352 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HOX.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      422 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HPE.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3497 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HPE.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      486 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HQA.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     4014 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HQA.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      460 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HTR.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3844 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HTR.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      275 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HYP.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2312 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HYP.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      418 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/I2M.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3346 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/I2M.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      448 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/IGL.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3727 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/IGL.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      357 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/IIL.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2889 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/IIL.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      415 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/IML.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3342 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/IML.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      439 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/KYN.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3642 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/KYN.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      327 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/LME.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2707 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/LME.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      372 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/LMQ.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3030 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/LMQ.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      419 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/LYZ.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3444 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/LYZ.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      583 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/M3L.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     4687 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/M3L.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      322 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ME0.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2700 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ME0.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      424 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MEA.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3518 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MEA.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      314 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MEN.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2576 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MEN.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      367 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MEQ.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3015 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MEQ.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      412 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MLE.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3334 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MLE.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      523 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MLY.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     4234 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MLY.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      461 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MLZ.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3770 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MLZ.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      367 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MME.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3017 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MME.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      502 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MMO.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     4069 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MMO.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      356 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MVA.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2885 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MVA.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      468 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/NAL.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3983 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/NAL.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      254 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/NCY.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2114 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/NCY.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      347 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/NLE.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2865 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/NLE.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      291 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/NVA.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2417 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/NVA.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      319 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/NZC.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2583 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/NZC.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      326 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/OCY.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2713 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/OCY.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      400 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/OMX.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3359 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/OMX.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      327 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ONL.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2714 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ONL.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      347 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ORM.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2869 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ORM.xml
+-rw-r--r--   0 runner    (1001) docker     (127)     1088 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/P1L.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     8741 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/P1L.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      235 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/PCA.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2008 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/PCA.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      538 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/PRK.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     4386 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/PRK.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      444 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/PTR.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3645 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/PTR.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      252 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/SEP.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2106 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/SEP.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      312 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/TPO.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2562 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/TPO.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      463 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/TRO.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3862 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/TRO.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      421 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/TY2.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3499 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/TY2.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      440 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/TYQ.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3651 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/TYQ.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      330 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/YCM.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     2714 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/YCM.xml
+-rw-r--r--   0 runner    (1001) docker     (127)      446 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/YNM.dat
+-rw-r--r--   0 runner    (1001) docker     (127)     3673 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/YNM.xml
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:31.052814 moleculekit-1.8.7/moleculekit/smallmol/
+-rw-r--r--   0 runner    (1001) docker     (127)      166 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/smallmol/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (127)    43085 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/smallmol/smallmol.py
+-rw-r--r--   0 runner    (1001) docker     (127)    16357 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/smallmol/smallmollib.py
+-rw-r--r--   0 runner    (1001) docker     (127)     9038 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/smallmol/test_smallmol.py
+-rw-r--r--   0 runner    (1001) docker     (127)     5267 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/smallmol/test_smallmollib.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:31.056814 moleculekit-1.8.7/moleculekit/smallmol/tools/
+-rw-r--r--   0 runner    (1001) docker     (127)      166 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/smallmol/tools/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (127)    12245 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/smallmol/tools/clustering.py
+-rw-r--r--   0 runner    (1001) docker     (127)     2089 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/smallmol/tools/restrainedembed.py
+-rw-r--r--   0 runner    (1001) docker     (127)     9657 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/smallmol/tools/test_tools.py
+-rw-r--r--   0 runner    (1001) docker     (127)    11720 2023-11-08 13:43:53.000000 moleculekit-1.8.7/moleculekit/smallmol/util.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:31.056814 moleculekit-1.8.7/moleculekit/tmalign/
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:31.056814 moleculekit-1.8.7/moleculekit/tmalign/include/
+-rw-r--r--   0 runner    (1001) docker     (127)     1976 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/tmalign/include/TMAlign.h
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:31.056814 moleculekit-1.8.7/moleculekit/tmalign/src/
+-rw-r--r--   0 runner    (1001) docker     (127)   193828 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/tmalign/src/TMAlign.cpp
+-rw-r--r--   0 runner    (1001) docker     (127)  1153130 2023-11-08 13:44:28.000000 moleculekit-1.8.7/moleculekit/tmalign/tmalign_util.cpp
+-rw-r--r--   0 runner    (1001) docker     (127)     4411 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/tmalign/tmalign_util.pyx
+-rw-r--r--   0 runner    (1001) docker     (127)     1659 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/tmalign/tmalignlib.pxd
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:31.060814 moleculekit-1.8.7/moleculekit/tools/
+-rw-r--r--   0 runner    (1001) docker     (127)      166 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/tools/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (127)    15163 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/tools/atomtyper.py
+-rw-r--r--   0 runner    (1001) docker     (127)    12233 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/tools/autosegment.py
+-rw-r--r--   0 runner    (1001) docker     (127)     9955 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/tools/crystalpacking.py
+-rw-r--r--   0 runner    (1001) docker     (127)    30487 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/tools/detect.py
+-rw-r--r--   0 runner    (1001) docker     (127)     7809 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/tools/docking.py
+-rw-r--r--   0 runner    (1001) docker     (127)     9948 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/tools/graphalignment.py
+-rw-r--r--   0 runner    (1001) docker     (127)     3973 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/tools/hhblitsprofile.py
+-rw-r--r--   0 runner    (1001) docker     (127)     5421 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/tools/moleculechecks.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:31.060814 moleculekit-1.8.7/moleculekit/tools/obabel_tools/
+-rw-r--r--   0 runner    (1001) docker     (127)     2635 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/tools/obabel_tools/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (127)     1764 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/tools/obabel_tools/obabel_cli.py
+-rw-r--r--   0 runner    (1001) docker     (127)    51713 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/tools/preparation.py
+-rw-r--r--   0 runner    (1001) docker     (127)    14329 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/tools/preparation_customres.py
+-rw-r--r--   0 runner    (1001) docker     (127)     8446 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/tools/sequencestructuralalignment.py
+-rw-r--r--   0 runner    (1001) docker     (127)    22600 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/tools/voxeldescriptors.py
+-rw-r--r--   0 runner    (1001) docker     (127)    23670 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/util.py
+-rw-r--r--   0 runner    (1001) docker     (127)      205 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/version.py
+-rw-r--r--   0 runner    (1001) docker     (127)     5079 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/viewer.py
+-rwxr-xr-x   0 runner    (1001) docker     (127)     1957 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/vmd_wrapper
+-rw-r--r--   0 runner    (1001) docker     (127)    12009 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/vmdgraphics.py
+-rwxr-xr-x   0 runner    (1001) docker     (127)    12291 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/vmdviewer.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:31.064814 moleculekit-1.8.7/moleculekit/wrapping/
+-rw-r--r--   0 runner    (1001) docker     (127)  1202661 2023-11-08 13:44:29.000000 moleculekit-1.8.7/moleculekit/wrapping/wrapping.cpp
+-rw-r--r--   0 runner    (1001) docker     (127)     4814 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/wrapping/wrapping.pyx
+-rw-r--r--   0 runner    (1001) docker     (127)    45295 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/writers.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:31.064814 moleculekit-1.8.7/moleculekit/xtc_utils/
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:31.064814 moleculekit-1.8.7/moleculekit/xtc_utils/include/
+-rw-r--r--   0 runner    (1001) docker     (127)    23963 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/xtc_utils/include/xdrfile.h
+-rw-r--r--   0 runner    (1001) docker     (127)     1212 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/xtc_utils/include/xdrfile_xtc.h
+-rw-r--r--   0 runner    (1001) docker     (127)     1464 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/xtc_utils/include/xtc.h
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:31.064814 moleculekit-1.8.7/moleculekit/xtc_utils/src/
+-rw-r--r--   0 runner    (1001) docker     (127)    64607 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/xtc_utils/src/xdrfile.cpp
+-rw-r--r--   0 runner    (1001) docker     (127)     2835 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/xtc_utils/src/xdrfile_xtc.cpp
+-rw-r--r--   0 runner    (1001) docker     (127)    13327 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/xtc_utils/src/xtc.cpp
+-rw-r--r--   0 runner    (1001) docker     (127)  1171332 2023-11-08 13:44:29.000000 moleculekit-1.8.7/moleculekit/xtc_utils/xtc.cpp
+-rw-r--r--   0 runner    (1001) docker     (127)     3257 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/xtc_utils/xtc.pyx
+-rw-r--r--   0 runner    (1001) docker     (127)      580 2023-11-08 13:43:54.000000 moleculekit-1.8.7/moleculekit/xtc_utils/xtclib.pxd
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2023-11-08 13:44:30.984814 moleculekit-1.8.7/moleculekit.egg-info/
+-rw-r--r--   0 runner    (1001) docker     (127)     4150 2023-11-08 13:44:30.000000 moleculekit-1.8.7/moleculekit.egg-info/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (127)    12079 2023-11-08 13:44:30.000000 moleculekit-1.8.7/moleculekit.egg-info/SOURCES.txt
+-rw-r--r--   0 runner    (1001) docker     (127)        1 2023-11-08 13:44:30.000000 moleculekit-1.8.7/moleculekit.egg-info/dependency_links.txt
+-rw-r--r--   0 runner    (1001) docker     (127)        1 2023-11-08 13:44:29.000000 moleculekit-1.8.7/moleculekit.egg-info/not-zip-safe
+-rw-r--r--   0 runner    (1001) docker     (127)       54 2023-11-08 13:44:30.000000 moleculekit-1.8.7/moleculekit.egg-info/requires.txt
+-rw-r--r--   0 runner    (1001) docker     (127)       12 2023-11-08 13:44:30.000000 moleculekit-1.8.7/moleculekit.egg-info/top_level.txt
+-rw-r--r--   0 runner    (1001) docker     (127)     1158 2023-11-08 13:43:54.000000 moleculekit-1.8.7/pyproject.toml
+-rw-r--r--   0 runner    (1001) docker     (127)      212 2023-11-08 13:44:31.068814 moleculekit-1.8.7/setup.cfg
+-rw-r--r--   0 runner    (1001) docker     (127)     1974 2023-11-08 13:43:54.000000 moleculekit-1.8.7/setup.py
```

### Comparing `moleculekit-1.8.6/LICENSE` & `moleculekit-1.8.7/LICENSE`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/PKG-INFO` & `moleculekit-1.8.7/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: moleculekit
-Version: 1.8.6
+Version: 1.8.7
 Summary: A molecule reading/writing and manipulation package.
 Author-email: Stefan Doerr <s.doerr@acellera.com>
 Project-URL: Homepage, https://github.com/Acellera/moleculekit
 Project-URL: Bug Tracker, https://github.com/Acellera/moleculekit/issues
 Classifier: Programming Language :: Python :: 3
 Classifier: Operating System :: POSIX :: Linux
 Requires-Python: >=3.8
```

### Comparing `moleculekit-1.8.6/README.md` & `moleculekit-1.8.7/README.md`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/__init__.py` & `moleculekit-1.8.7/moleculekit/__init__.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/align.py` & `moleculekit-1.8.7/moleculekit/align.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/atomselect/analyze.py` & `moleculekit-1.8.7/moleculekit/atomselect/analyze.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/atomselect/atomselect.py` & `moleculekit-1.8.7/moleculekit/atomselect/atomselect.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/atomselect/languageparser.py` & `moleculekit-1.8.7/moleculekit/atomselect/languageparser.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/atomselect_utils/atomselect_utils.cpp` & `moleculekit-1.8.7/moleculekit/atomselect_utils/atomselect_utils.cpp`

 * *Files 0% similar despite different names*

```diff
@@ -1,24 +1,24 @@
 /* Generated by Cython 3.0.5 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h"
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include"
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include"
         ],
         "language": "c++",
         "name": "moleculekit.atomselect_utils",
         "sources": [
             "moleculekit/atomselect_utils/atomselect_utils.pyx"
         ]
     },
@@ -1704,177 +1704,177 @@
   Py_ssize_t strides[8];
   Py_ssize_t suboffsets[8];
 } __Pyx_memviewslice;
 #define __Pyx_MemoryView_Len(m)  (m.shape[0])
 
 /* #### Code section: numeric_typedefs ### */
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":730
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":730
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":731
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":731
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":732
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":732
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":733
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":733
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":737
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":737
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":738
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":738
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":739
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":739
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":740
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":740
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":744
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":744
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":745
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":745
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":754
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":754
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":755
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":755
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":757
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":757
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":758
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":758
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":760
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":760
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":761
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":761
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":763
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":763
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":764
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":764
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":765
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":765
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
@@ -1973,42 +1973,42 @@
  *     or the provided default value if no such value was found.
  */
 struct __pyx_opt_args_7cpython_11contextvars_get_value_no_default {
   int __pyx_n;
   PyObject *default_value;
 };
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":767
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":767
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":768
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":768
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":769
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":769
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":771
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":771
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -3145,18 +3145,18 @@
                 __Pyx_memviewslice *memviewslice,
                 PyObject *original_obj);
 
 /* ObjectToMemviewSlice.proto */
 static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(PyObject *, int writable_flag);
 
 /* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(PyObject *, int writable_flag);
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_INT64_t(PyObject *, int writable_flag);
 
 /* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_INT64_t(PyObject *, int writable_flag);
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(PyObject *, int writable_flag);
 
 /* ObjectToMemviewSlice.proto */
 static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn_bool(PyObject *, int writable_flag);
 
 /* ObjectToMemviewSlice.proto */
 static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_FLOAT32_t(PyObject *, int writable_flag);
 
@@ -3528,15 +3528,14 @@
 static bool __pyx_f_11moleculekit_16atomselect_utils__find_fragments(int, int, std::vector<std::vector<int> >  &, std::vector<std::vector<int> >  &, std::vector<std::vector<int> >  &, std::vector<std::vector<int> >  &, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, std::vector<std::string>  &, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice); /*proto*/
 static bool __pyx_f_11moleculekit_16atomselect_utils__fix_backbones(__Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice); /*proto*/
 static bool __pyx_f_11moleculekit_16atomselect_utils__recursive_find_sidechain_atoms(int, std::vector<std::vector<int> >  &, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice); /*proto*/
 static bool __pyx_f_11moleculekit_16atomselect_utils__find_sidechain_atoms(int, std::vector<std::vector<int> >  &, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice); /*proto*/
 static bool __pyx_f_11moleculekit_16atomselect_utils__atomsel_sidechain(std::vector<std::vector<int> >  &, std::vector<std::vector<int> >  &, std::vector<std::vector<int> >  &, __Pyx_memviewslice, __Pyx_memviewslice, std::vector<std::string>  &, __Pyx_memviewslice, __Pyx_memviewslice); /*proto*/
 static std::string __pyx_convert_string_from_py_std__in_string(PyObject *); /*proto*/
 static std::vector<std::string>  __pyx_convert_vector_from_py_std_3a__3a_string(PyObject *); /*proto*/
-static PyObject *__pyx_convert_vector_to_py_int(std::vector<int>  const &); /*proto*/
 static int __pyx_array_allocate_buffer(struct __pyx_array_obj *); /*proto*/
 static struct __pyx_array_obj *__pyx_array_new(PyObject *, Py_ssize_t, char *, char *, char *); /*proto*/
 static PyObject *__pyx_memoryview_new(PyObject *, int, int, __Pyx_TypeInfo *); /*proto*/
 static CYTHON_INLINE int __pyx_memoryview_check(PyObject *); /*proto*/
 static PyObject *_unellipsify(PyObject *, int); /*proto*/
 static int assert_direct_dimensions(Py_ssize_t *, int); /*proto*/
 static struct __pyx_memoryview_obj *__pyx_memview_slice(struct __pyx_memoryview_obj *, PyObject *); /*proto*/
@@ -3576,17 +3575,17 @@
 #define __Pyx_MODULE_NAME "moleculekit.atomselect_utils"
 extern int __pyx_module_is_main_moleculekit__atomselect_utils;
 int __pyx_module_is_main_moleculekit__atomselect_utils = 0;
 
 /* Implementation of "moleculekit.atomselect_utils" */
 /* #### Code section: global_var ### */
 static PyObject *__pyx_builtin_range;
-static PyObject *__pyx_builtin_MemoryError;
 static PyObject *__pyx_builtin___import__;
 static PyObject *__pyx_builtin_ValueError;
+static PyObject *__pyx_builtin_MemoryError;
 static PyObject *__pyx_builtin_enumerate;
 static PyObject *__pyx_builtin_TypeError;
 static PyObject *__pyx_builtin_AssertionError;
 static PyObject *__pyx_builtin_Ellipsis;
 static PyObject *__pyx_builtin_id;
 static PyObject *__pyx_builtin_IndexError;
 static PyObject *__pyx_builtin_ImportError;
@@ -3600,15 +3599,15 @@
 static const char __pyx_k__2[] = ".";
 static const char __pyx_k__3[] = "*";
 static const char __pyx_k__6[] = "'";
 static const char __pyx_k__7[] = ")";
 static const char __pyx_k_gc[] = "gc";
 static const char __pyx_k_id[] = "id";
 static const char __pyx_k_np[] = "np";
-static const char __pyx_k__28[] = "?";
+static const char __pyx_k__26[] = "?";
 static const char __pyx_k_abc[] = "abc";
 static const char __pyx_k_and[] = " and ";
 static const char __pyx_k_got[] = " (got ";
 static const char __pyx_k_new[] = "__new__";
 static const char __pyx_k_obj[] = "obj";
 static const char __pyx_k_sys[] = "sys";
 static const char __pyx_k_base[] = "base";
@@ -3634,15 +3633,14 @@
 static const char __pyx_k_array[] = "array";
 static const char __pyx_k_bonds[] = "bonds";
 static const char __pyx_k_class[] = "__class__";
 static const char __pyx_k_count[] = "count";
 static const char __pyx_k_dtype[] = "dtype";
 static const char __pyx_k_error[] = "error";
 static const char __pyx_k_flags[] = "flags";
-static const char __pyx_k_group[] = "group";
 static const char __pyx_k_index[] = "index";
 static const char __pyx_k_int64[] = "int64";
 static const char __pyx_k_numpy[] = "numpy";
 static const char __pyx_k_range[] = "range";
 static const char __pyx_k_resid[] = "resid";
 static const char __pyx_k_shape[] = "shape";
 static const char __pyx_k_start[] = "start";
@@ -3668,18 +3666,16 @@
 static const char __pyx_k_FLOAT64[] = "FLOAT64";
 static const char __pyx_k_disable[] = "disable";
 static const char __pyx_k_float32[] = "float32";
 static const char __pyx_k_float64[] = "float64";
 static const char __pyx_k_fortran[] = "fortran";
 static const char __pyx_k_memview[] = "memview";
 static const char __pyx_k_n_atoms[] = "n_atoms";
-static const char __pyx_k_n_bonds[] = "n_bonds";
 static const char __pyx_k_nucleic[] = "nucleic";
 static const char __pyx_k_protein[] = "protein";
-static const char __pyx_k_results[] = "results";
 static const char __pyx_k_Ellipsis[] = "Ellipsis";
 static const char __pyx_k_Sequence[] = "Sequence";
 static const char __pyx_k_atm_flgs[] = "atm_flgs";
 static const char __pyx_k_chain_id[] = "chain_id";
 static const char __pyx_k_getstate[] = "__getstate__";
 static const char __pyx_k_itemsize[] = "itemsize";
 static const char __pyx_k_n_source[] = "n_source";
@@ -3720,24 +3716,22 @@
 static const char __pyx_k_pyx_checksum[] = "__pyx_checksum";
 static const char __pyx_k_stringsource[] = "<stringsource>";
 static const char __pyx_k_version_info[] = "version_info";
 static const char __pyx_k_class_getitem[] = "__class_getitem__";
 static const char __pyx_k_reduce_cython[] = "__reduce_cython__";
 static const char __pyx_k_residue_atoms[] = "residue_atoms";
 static const char __pyx_k_AssertionError[] = "AssertionError";
-static const char __pyx_k_has_lower_bond[] = "has_lower_bond";
 static const char __pyx_k_View_MemoryView[] = "View.MemoryView";
 static const char __pyx_k_allocate_buffer[] = "allocate_buffer";
 static const char __pyx_k_collections_abc[] = "collections.abc";
 static const char __pyx_k_dtype_is_object[] = "dtype_is_object";
 static const char __pyx_k_pyx_PickleError[] = "__pyx_PickleError";
 static const char __pyx_k_setstate_cython[] = "__setstate_cython__";
 static const char __pyx_k_within_distance[] = "within_distance";
 static const char __pyx_k_analyze_molecule[] = "analyze_molecule";
-static const char __pyx_k_get_bonded_groups[] = "get_bonded_groups";
 static const char __pyx_k_pyx_unpickle_Enum[] = "__pyx_unpickle_Enum";
 static const char __pyx_k_asyncio_coroutines[] = "asyncio.coroutines";
 static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
 static const char __pyx_k_strided_and_direct[] = "<strided and direct>";
 static const char __pyx_k_strided_and_indirect[] = "<strided and indirect>";
 static const char __pyx_k_Invalid_shape_in_axis[] = "Invalid shape in axis ";
 static const char __pyx_k_contiguous_and_direct[] = "<contiguous and direct>";
@@ -3810,17 +3804,16 @@
 static PyObject *__pyx_pf___pyx_memoryview_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryview_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static void __pyx_memoryviewslice___pyx_pf_15View_dot_MemoryView_16_memoryviewslice___dealloc__(struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryviewslice___reduce_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryviewslice_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView___pyx_unpickle_Enum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v___pyx_type, long __pyx_v___pyx_checksum, PyObject *__pyx_v___pyx_state); /* proto */
 static int __pyx_pf_7cpython_5array_5array___getbuffer__(arrayobject *__pyx_v_self, Py_buffer *__pyx_v_info, CYTHON_UNUSED int __pyx_v_flags); /* proto */
 static void __pyx_pf_7cpython_5array_5array_2__releasebuffer__(CYTHON_UNUSED arrayobject *__pyx_v_self, Py_buffer *__pyx_v_info); /* proto */
-static PyObject *__pyx_pf_11moleculekit_16atomselect_utils_get_bonded_groups(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_bonds, __Pyx_memviewslice __pyx_v_has_lower_bond, int __pyx_v_n_atoms, __Pyx_memviewslice __pyx_v_group); /* proto */
-static PyObject *__pyx_pf_11moleculekit_16atomselect_utils_2analyze_molecule(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_n_atoms, __Pyx_memviewslice __pyx_v_bonds, __Pyx_memviewslice __pyx_v_resid, __Pyx_memviewslice __pyx_v_insertion, __Pyx_memviewslice __pyx_v_chain_id, __Pyx_memviewslice __pyx_v_seg_id, __Pyx_memviewslice __pyx_v_protein, __Pyx_memviewslice __pyx_v_nucleic, __Pyx_memviewslice __pyx_v_protein_bb, __Pyx_memviewslice __pyx_v_nucleic_bb, __Pyx_memviewslice __pyx_v_uq_resid, __Pyx_memviewslice __pyx_v_fragments, __Pyx_memviewslice __pyx_v_masses, __Pyx_memviewslice __pyx_v_sidechain, std::vector<std::string>  __pyx_v_atomnames); /* proto */
-static PyObject *__pyx_pf_11moleculekit_16atomselect_utils_4within_distance(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_coords, float __pyx_v_cutoff, __Pyx_memviewslice __pyx_v_source, __Pyx_memviewslice __pyx_v_source_min, __Pyx_memviewslice __pyx_v_source_max, __Pyx_memviewslice __pyx_v_mask); /* proto */
+static PyObject *__pyx_pf_11moleculekit_16atomselect_utils_analyze_molecule(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_n_atoms, __Pyx_memviewslice __pyx_v_bonds, __Pyx_memviewslice __pyx_v_resid, __Pyx_memviewslice __pyx_v_insertion, __Pyx_memviewslice __pyx_v_chain_id, __Pyx_memviewslice __pyx_v_seg_id, __Pyx_memviewslice __pyx_v_protein, __Pyx_memviewslice __pyx_v_nucleic, __Pyx_memviewslice __pyx_v_protein_bb, __Pyx_memviewslice __pyx_v_nucleic_bb, __Pyx_memviewslice __pyx_v_uq_resid, __Pyx_memviewslice __pyx_v_fragments, __Pyx_memviewslice __pyx_v_masses, __Pyx_memviewslice __pyx_v_sidechain, std::vector<std::string>  __pyx_v_atomnames); /* proto */
+static PyObject *__pyx_pf_11moleculekit_16atomselect_utils_2within_distance(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_coords, float __pyx_v_cutoff, __Pyx_memviewslice __pyx_v_source, __Pyx_memviewslice __pyx_v_source_min, __Pyx_memviewslice __pyx_v_source_max, __Pyx_memviewslice __pyx_v_mask); /* proto */
 static PyObject *__pyx_tp_new_array(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_Enum(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_memoryview(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new__memoryviewslice(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 /* #### Code section: late_includes ### */
 /* #### Code section: module_state ### */
 typedef struct {
@@ -4018,15 +4011,15 @@
   PyObject *__pyx_kp_s_Step_may_not_be_zero_axis_d;
   PyObject *__pyx_n_s_TypeError;
   PyObject *__pyx_n_s_UINT32;
   PyObject *__pyx_kp_s_Unable_to_convert_item_to_object;
   PyObject *__pyx_n_s_ValueError;
   PyObject *__pyx_n_s_View_MemoryView;
   PyObject *__pyx_kp_u__2;
-  PyObject *__pyx_n_s__28;
+  PyObject *__pyx_n_s__26;
   PyObject *__pyx_n_s__3;
   PyObject *__pyx_kp_u__6;
   PyObject *__pyx_kp_u__7;
   PyObject *__pyx_n_s_abc;
   PyObject *__pyx_n_s_allocate_buffer;
   PyObject *__pyx_n_s_analyze_molecule;
   PyObject *__pyx_kp_u_and;
@@ -4066,20 +4059,17 @@
   PyObject *__pyx_n_s_float32;
   PyObject *__pyx_n_s_float64;
   PyObject *__pyx_n_s_format;
   PyObject *__pyx_n_s_fortran;
   PyObject *__pyx_n_u_fortran;
   PyObject *__pyx_n_s_fragments;
   PyObject *__pyx_kp_u_gc;
-  PyObject *__pyx_n_s_get_bonded_groups;
   PyObject *__pyx_n_s_getstate;
   PyObject *__pyx_kp_u_got;
   PyObject *__pyx_kp_u_got_differing_extents_in_dimensi;
-  PyObject *__pyx_n_s_group;
-  PyObject *__pyx_n_s_has_lower_bond;
   PyObject *__pyx_n_s_i;
   PyObject *__pyx_n_s_id;
   PyObject *__pyx_n_s_import;
   PyObject *__pyx_n_s_index;
   PyObject *__pyx_n_s_initializing;
   PyObject *__pyx_n_s_insertion;
   PyObject *__pyx_n_s_int64;
@@ -4094,15 +4084,14 @@
   PyObject *__pyx_n_s_masses;
   PyObject *__pyx_n_s_math;
   PyObject *__pyx_n_s_memview;
   PyObject *__pyx_n_s_mode;
   PyObject *__pyx_n_s_moleculekit_atomselect_utils;
   PyObject *__pyx_kp_s_moleculekit_atomselect_utils_ato;
   PyObject *__pyx_n_s_n_atoms;
-  PyObject *__pyx_n_s_n_bonds;
   PyObject *__pyx_n_s_n_residues;
   PyObject *__pyx_n_s_n_source;
   PyObject *__pyx_n_s_name;
   PyObject *__pyx_n_s_name_2;
   PyObject *__pyx_n_s_ndim;
   PyObject *__pyx_n_s_new;
   PyObject *__pyx_n_s_nfragList;
@@ -4130,15 +4119,14 @@
   PyObject *__pyx_n_s_reduce;
   PyObject *__pyx_n_s_reduce_cython;
   PyObject *__pyx_n_s_reduce_ex;
   PyObject *__pyx_n_s_register;
   PyObject *__pyx_n_s_res_flgs;
   PyObject *__pyx_n_s_resid;
   PyObject *__pyx_n_s_residue_atoms;
-  PyObject *__pyx_n_s_results;
   PyObject *__pyx_n_s_seg_id;
   PyObject *__pyx_n_s_setstate;
   PyObject *__pyx_n_s_setstate_cython;
   PyObject *__pyx_n_s_shape;
   PyObject *__pyx_n_s_sidechain;
   PyObject *__pyx_n_s_size;
   PyObject *__pyx_n_s_source;
@@ -4186,19 +4174,17 @@
   PyObject *__pyx_tuple__16;
   PyObject *__pyx_tuple__17;
   PyObject *__pyx_tuple__18;
   PyObject *__pyx_tuple__19;
   PyObject *__pyx_tuple__20;
   PyObject *__pyx_tuple__22;
   PyObject *__pyx_tuple__24;
-  PyObject *__pyx_tuple__26;
   PyObject *__pyx_codeobj__21;
   PyObject *__pyx_codeobj__23;
   PyObject *__pyx_codeobj__25;
-  PyObject *__pyx_codeobj__27;
 } __pyx_mstate;
 
 #if CYTHON_USE_MODULE_STATE
 #ifdef __cplusplus
 namespace {
   extern struct PyModuleDef __pyx_moduledef;
 } /* anonymous namespace */
@@ -4297,15 +4283,15 @@
   Py_CLEAR(clear_module_state->__pyx_kp_s_Step_may_not_be_zero_axis_d);
   Py_CLEAR(clear_module_state->__pyx_n_s_TypeError);
   Py_CLEAR(clear_module_state->__pyx_n_s_UINT32);
   Py_CLEAR(clear_module_state->__pyx_kp_s_Unable_to_convert_item_to_object);
   Py_CLEAR(clear_module_state->__pyx_n_s_ValueError);
   Py_CLEAR(clear_module_state->__pyx_n_s_View_MemoryView);
   Py_CLEAR(clear_module_state->__pyx_kp_u__2);
-  Py_CLEAR(clear_module_state->__pyx_n_s__28);
+  Py_CLEAR(clear_module_state->__pyx_n_s__26);
   Py_CLEAR(clear_module_state->__pyx_n_s__3);
   Py_CLEAR(clear_module_state->__pyx_kp_u__6);
   Py_CLEAR(clear_module_state->__pyx_kp_u__7);
   Py_CLEAR(clear_module_state->__pyx_n_s_abc);
   Py_CLEAR(clear_module_state->__pyx_n_s_allocate_buffer);
   Py_CLEAR(clear_module_state->__pyx_n_s_analyze_molecule);
   Py_CLEAR(clear_module_state->__pyx_kp_u_and);
@@ -4345,20 +4331,17 @@
   Py_CLEAR(clear_module_state->__pyx_n_s_float32);
   Py_CLEAR(clear_module_state->__pyx_n_s_float64);
   Py_CLEAR(clear_module_state->__pyx_n_s_format);
   Py_CLEAR(clear_module_state->__pyx_n_s_fortran);
   Py_CLEAR(clear_module_state->__pyx_n_u_fortran);
   Py_CLEAR(clear_module_state->__pyx_n_s_fragments);
   Py_CLEAR(clear_module_state->__pyx_kp_u_gc);
-  Py_CLEAR(clear_module_state->__pyx_n_s_get_bonded_groups);
   Py_CLEAR(clear_module_state->__pyx_n_s_getstate);
   Py_CLEAR(clear_module_state->__pyx_kp_u_got);
   Py_CLEAR(clear_module_state->__pyx_kp_u_got_differing_extents_in_dimensi);
-  Py_CLEAR(clear_module_state->__pyx_n_s_group);
-  Py_CLEAR(clear_module_state->__pyx_n_s_has_lower_bond);
   Py_CLEAR(clear_module_state->__pyx_n_s_i);
   Py_CLEAR(clear_module_state->__pyx_n_s_id);
   Py_CLEAR(clear_module_state->__pyx_n_s_import);
   Py_CLEAR(clear_module_state->__pyx_n_s_index);
   Py_CLEAR(clear_module_state->__pyx_n_s_initializing);
   Py_CLEAR(clear_module_state->__pyx_n_s_insertion);
   Py_CLEAR(clear_module_state->__pyx_n_s_int64);
@@ -4373,15 +4356,14 @@
   Py_CLEAR(clear_module_state->__pyx_n_s_masses);
   Py_CLEAR(clear_module_state->__pyx_n_s_math);
   Py_CLEAR(clear_module_state->__pyx_n_s_memview);
   Py_CLEAR(clear_module_state->__pyx_n_s_mode);
   Py_CLEAR(clear_module_state->__pyx_n_s_moleculekit_atomselect_utils);
   Py_CLEAR(clear_module_state->__pyx_kp_s_moleculekit_atomselect_utils_ato);
   Py_CLEAR(clear_module_state->__pyx_n_s_n_atoms);
-  Py_CLEAR(clear_module_state->__pyx_n_s_n_bonds);
   Py_CLEAR(clear_module_state->__pyx_n_s_n_residues);
   Py_CLEAR(clear_module_state->__pyx_n_s_n_source);
   Py_CLEAR(clear_module_state->__pyx_n_s_name);
   Py_CLEAR(clear_module_state->__pyx_n_s_name_2);
   Py_CLEAR(clear_module_state->__pyx_n_s_ndim);
   Py_CLEAR(clear_module_state->__pyx_n_s_new);
   Py_CLEAR(clear_module_state->__pyx_n_s_nfragList);
@@ -4409,15 +4391,14 @@
   Py_CLEAR(clear_module_state->__pyx_n_s_reduce);
   Py_CLEAR(clear_module_state->__pyx_n_s_reduce_cython);
   Py_CLEAR(clear_module_state->__pyx_n_s_reduce_ex);
   Py_CLEAR(clear_module_state->__pyx_n_s_register);
   Py_CLEAR(clear_module_state->__pyx_n_s_res_flgs);
   Py_CLEAR(clear_module_state->__pyx_n_s_resid);
   Py_CLEAR(clear_module_state->__pyx_n_s_residue_atoms);
-  Py_CLEAR(clear_module_state->__pyx_n_s_results);
   Py_CLEAR(clear_module_state->__pyx_n_s_seg_id);
   Py_CLEAR(clear_module_state->__pyx_n_s_setstate);
   Py_CLEAR(clear_module_state->__pyx_n_s_setstate_cython);
   Py_CLEAR(clear_module_state->__pyx_n_s_shape);
   Py_CLEAR(clear_module_state->__pyx_n_s_sidechain);
   Py_CLEAR(clear_module_state->__pyx_n_s_size);
   Py_CLEAR(clear_module_state->__pyx_n_s_source);
@@ -4465,19 +4446,17 @@
   Py_CLEAR(clear_module_state->__pyx_tuple__16);
   Py_CLEAR(clear_module_state->__pyx_tuple__17);
   Py_CLEAR(clear_module_state->__pyx_tuple__18);
   Py_CLEAR(clear_module_state->__pyx_tuple__19);
   Py_CLEAR(clear_module_state->__pyx_tuple__20);
   Py_CLEAR(clear_module_state->__pyx_tuple__22);
   Py_CLEAR(clear_module_state->__pyx_tuple__24);
-  Py_CLEAR(clear_module_state->__pyx_tuple__26);
   Py_CLEAR(clear_module_state->__pyx_codeobj__21);
   Py_CLEAR(clear_module_state->__pyx_codeobj__23);
   Py_CLEAR(clear_module_state->__pyx_codeobj__25);
-  Py_CLEAR(clear_module_state->__pyx_codeobj__27);
   return 0;
 }
 #endif
 /* #### Code section: module_state_traverse ### */
 #if CYTHON_USE_MODULE_STATE
 static int __pyx_m_traverse(PyObject *m, visitproc visit, void *arg) {
   __pyx_mstate *traverse_module_state = __pyx_mstate(m);
@@ -4554,15 +4533,15 @@
   Py_VISIT(traverse_module_state->__pyx_kp_s_Step_may_not_be_zero_axis_d);
   Py_VISIT(traverse_module_state->__pyx_n_s_TypeError);
   Py_VISIT(traverse_module_state->__pyx_n_s_UINT32);
   Py_VISIT(traverse_module_state->__pyx_kp_s_Unable_to_convert_item_to_object);
   Py_VISIT(traverse_module_state->__pyx_n_s_ValueError);
   Py_VISIT(traverse_module_state->__pyx_n_s_View_MemoryView);
   Py_VISIT(traverse_module_state->__pyx_kp_u__2);
-  Py_VISIT(traverse_module_state->__pyx_n_s__28);
+  Py_VISIT(traverse_module_state->__pyx_n_s__26);
   Py_VISIT(traverse_module_state->__pyx_n_s__3);
   Py_VISIT(traverse_module_state->__pyx_kp_u__6);
   Py_VISIT(traverse_module_state->__pyx_kp_u__7);
   Py_VISIT(traverse_module_state->__pyx_n_s_abc);
   Py_VISIT(traverse_module_state->__pyx_n_s_allocate_buffer);
   Py_VISIT(traverse_module_state->__pyx_n_s_analyze_molecule);
   Py_VISIT(traverse_module_state->__pyx_kp_u_and);
@@ -4602,20 +4581,17 @@
   Py_VISIT(traverse_module_state->__pyx_n_s_float32);
   Py_VISIT(traverse_module_state->__pyx_n_s_float64);
   Py_VISIT(traverse_module_state->__pyx_n_s_format);
   Py_VISIT(traverse_module_state->__pyx_n_s_fortran);
   Py_VISIT(traverse_module_state->__pyx_n_u_fortran);
   Py_VISIT(traverse_module_state->__pyx_n_s_fragments);
   Py_VISIT(traverse_module_state->__pyx_kp_u_gc);
-  Py_VISIT(traverse_module_state->__pyx_n_s_get_bonded_groups);
   Py_VISIT(traverse_module_state->__pyx_n_s_getstate);
   Py_VISIT(traverse_module_state->__pyx_kp_u_got);
   Py_VISIT(traverse_module_state->__pyx_kp_u_got_differing_extents_in_dimensi);
-  Py_VISIT(traverse_module_state->__pyx_n_s_group);
-  Py_VISIT(traverse_module_state->__pyx_n_s_has_lower_bond);
   Py_VISIT(traverse_module_state->__pyx_n_s_i);
   Py_VISIT(traverse_module_state->__pyx_n_s_id);
   Py_VISIT(traverse_module_state->__pyx_n_s_import);
   Py_VISIT(traverse_module_state->__pyx_n_s_index);
   Py_VISIT(traverse_module_state->__pyx_n_s_initializing);
   Py_VISIT(traverse_module_state->__pyx_n_s_insertion);
   Py_VISIT(traverse_module_state->__pyx_n_s_int64);
@@ -4630,15 +4606,14 @@
   Py_VISIT(traverse_module_state->__pyx_n_s_masses);
   Py_VISIT(traverse_module_state->__pyx_n_s_math);
   Py_VISIT(traverse_module_state->__pyx_n_s_memview);
   Py_VISIT(traverse_module_state->__pyx_n_s_mode);
   Py_VISIT(traverse_module_state->__pyx_n_s_moleculekit_atomselect_utils);
   Py_VISIT(traverse_module_state->__pyx_kp_s_moleculekit_atomselect_utils_ato);
   Py_VISIT(traverse_module_state->__pyx_n_s_n_atoms);
-  Py_VISIT(traverse_module_state->__pyx_n_s_n_bonds);
   Py_VISIT(traverse_module_state->__pyx_n_s_n_residues);
   Py_VISIT(traverse_module_state->__pyx_n_s_n_source);
   Py_VISIT(traverse_module_state->__pyx_n_s_name);
   Py_VISIT(traverse_module_state->__pyx_n_s_name_2);
   Py_VISIT(traverse_module_state->__pyx_n_s_ndim);
   Py_VISIT(traverse_module_state->__pyx_n_s_new);
   Py_VISIT(traverse_module_state->__pyx_n_s_nfragList);
@@ -4666,15 +4641,14 @@
   Py_VISIT(traverse_module_state->__pyx_n_s_reduce);
   Py_VISIT(traverse_module_state->__pyx_n_s_reduce_cython);
   Py_VISIT(traverse_module_state->__pyx_n_s_reduce_ex);
   Py_VISIT(traverse_module_state->__pyx_n_s_register);
   Py_VISIT(traverse_module_state->__pyx_n_s_res_flgs);
   Py_VISIT(traverse_module_state->__pyx_n_s_resid);
   Py_VISIT(traverse_module_state->__pyx_n_s_residue_atoms);
-  Py_VISIT(traverse_module_state->__pyx_n_s_results);
   Py_VISIT(traverse_module_state->__pyx_n_s_seg_id);
   Py_VISIT(traverse_module_state->__pyx_n_s_setstate);
   Py_VISIT(traverse_module_state->__pyx_n_s_setstate_cython);
   Py_VISIT(traverse_module_state->__pyx_n_s_shape);
   Py_VISIT(traverse_module_state->__pyx_n_s_sidechain);
   Py_VISIT(traverse_module_state->__pyx_n_s_size);
   Py_VISIT(traverse_module_state->__pyx_n_s_source);
@@ -4722,19 +4696,17 @@
   Py_VISIT(traverse_module_state->__pyx_tuple__16);
   Py_VISIT(traverse_module_state->__pyx_tuple__17);
   Py_VISIT(traverse_module_state->__pyx_tuple__18);
   Py_VISIT(traverse_module_state->__pyx_tuple__19);
   Py_VISIT(traverse_module_state->__pyx_tuple__20);
   Py_VISIT(traverse_module_state->__pyx_tuple__22);
   Py_VISIT(traverse_module_state->__pyx_tuple__24);
-  Py_VISIT(traverse_module_state->__pyx_tuple__26);
   Py_VISIT(traverse_module_state->__pyx_codeobj__21);
   Py_VISIT(traverse_module_state->__pyx_codeobj__23);
   Py_VISIT(traverse_module_state->__pyx_codeobj__25);
-  Py_VISIT(traverse_module_state->__pyx_codeobj__27);
   return 0;
 }
 #endif
 /* #### Code section: module_state_defines ### */
 #define __pyx_d __pyx_mstate_global->__pyx_d
 #define __pyx_b __pyx_mstate_global->__pyx_b
 #define __pyx_cython_runtime __pyx_mstate_global->__pyx_cython_runtime
@@ -4929,15 +4901,15 @@
 #define __pyx_kp_s_Step_may_not_be_zero_axis_d __pyx_mstate_global->__pyx_kp_s_Step_may_not_be_zero_axis_d
 #define __pyx_n_s_TypeError __pyx_mstate_global->__pyx_n_s_TypeError
 #define __pyx_n_s_UINT32 __pyx_mstate_global->__pyx_n_s_UINT32
 #define __pyx_kp_s_Unable_to_convert_item_to_object __pyx_mstate_global->__pyx_kp_s_Unable_to_convert_item_to_object
 #define __pyx_n_s_ValueError __pyx_mstate_global->__pyx_n_s_ValueError
 #define __pyx_n_s_View_MemoryView __pyx_mstate_global->__pyx_n_s_View_MemoryView
 #define __pyx_kp_u__2 __pyx_mstate_global->__pyx_kp_u__2
-#define __pyx_n_s__28 __pyx_mstate_global->__pyx_n_s__28
+#define __pyx_n_s__26 __pyx_mstate_global->__pyx_n_s__26
 #define __pyx_n_s__3 __pyx_mstate_global->__pyx_n_s__3
 #define __pyx_kp_u__6 __pyx_mstate_global->__pyx_kp_u__6
 #define __pyx_kp_u__7 __pyx_mstate_global->__pyx_kp_u__7
 #define __pyx_n_s_abc __pyx_mstate_global->__pyx_n_s_abc
 #define __pyx_n_s_allocate_buffer __pyx_mstate_global->__pyx_n_s_allocate_buffer
 #define __pyx_n_s_analyze_molecule __pyx_mstate_global->__pyx_n_s_analyze_molecule
 #define __pyx_kp_u_and __pyx_mstate_global->__pyx_kp_u_and
@@ -4977,20 +4949,17 @@
 #define __pyx_n_s_float32 __pyx_mstate_global->__pyx_n_s_float32
 #define __pyx_n_s_float64 __pyx_mstate_global->__pyx_n_s_float64
 #define __pyx_n_s_format __pyx_mstate_global->__pyx_n_s_format
 #define __pyx_n_s_fortran __pyx_mstate_global->__pyx_n_s_fortran
 #define __pyx_n_u_fortran __pyx_mstate_global->__pyx_n_u_fortran
 #define __pyx_n_s_fragments __pyx_mstate_global->__pyx_n_s_fragments
 #define __pyx_kp_u_gc __pyx_mstate_global->__pyx_kp_u_gc
-#define __pyx_n_s_get_bonded_groups __pyx_mstate_global->__pyx_n_s_get_bonded_groups
 #define __pyx_n_s_getstate __pyx_mstate_global->__pyx_n_s_getstate
 #define __pyx_kp_u_got __pyx_mstate_global->__pyx_kp_u_got
 #define __pyx_kp_u_got_differing_extents_in_dimensi __pyx_mstate_global->__pyx_kp_u_got_differing_extents_in_dimensi
-#define __pyx_n_s_group __pyx_mstate_global->__pyx_n_s_group
-#define __pyx_n_s_has_lower_bond __pyx_mstate_global->__pyx_n_s_has_lower_bond
 #define __pyx_n_s_i __pyx_mstate_global->__pyx_n_s_i
 #define __pyx_n_s_id __pyx_mstate_global->__pyx_n_s_id
 #define __pyx_n_s_import __pyx_mstate_global->__pyx_n_s_import
 #define __pyx_n_s_index __pyx_mstate_global->__pyx_n_s_index
 #define __pyx_n_s_initializing __pyx_mstate_global->__pyx_n_s_initializing
 #define __pyx_n_s_insertion __pyx_mstate_global->__pyx_n_s_insertion
 #define __pyx_n_s_int64 __pyx_mstate_global->__pyx_n_s_int64
@@ -5005,15 +4974,14 @@
 #define __pyx_n_s_masses __pyx_mstate_global->__pyx_n_s_masses
 #define __pyx_n_s_math __pyx_mstate_global->__pyx_n_s_math
 #define __pyx_n_s_memview __pyx_mstate_global->__pyx_n_s_memview
 #define __pyx_n_s_mode __pyx_mstate_global->__pyx_n_s_mode
 #define __pyx_n_s_moleculekit_atomselect_utils __pyx_mstate_global->__pyx_n_s_moleculekit_atomselect_utils
 #define __pyx_kp_s_moleculekit_atomselect_utils_ato __pyx_mstate_global->__pyx_kp_s_moleculekit_atomselect_utils_ato
 #define __pyx_n_s_n_atoms __pyx_mstate_global->__pyx_n_s_n_atoms
-#define __pyx_n_s_n_bonds __pyx_mstate_global->__pyx_n_s_n_bonds
 #define __pyx_n_s_n_residues __pyx_mstate_global->__pyx_n_s_n_residues
 #define __pyx_n_s_n_source __pyx_mstate_global->__pyx_n_s_n_source
 #define __pyx_n_s_name __pyx_mstate_global->__pyx_n_s_name
 #define __pyx_n_s_name_2 __pyx_mstate_global->__pyx_n_s_name_2
 #define __pyx_n_s_ndim __pyx_mstate_global->__pyx_n_s_ndim
 #define __pyx_n_s_new __pyx_mstate_global->__pyx_n_s_new
 #define __pyx_n_s_nfragList __pyx_mstate_global->__pyx_n_s_nfragList
@@ -5041,15 +5009,14 @@
 #define __pyx_n_s_reduce __pyx_mstate_global->__pyx_n_s_reduce
 #define __pyx_n_s_reduce_cython __pyx_mstate_global->__pyx_n_s_reduce_cython
 #define __pyx_n_s_reduce_ex __pyx_mstate_global->__pyx_n_s_reduce_ex
 #define __pyx_n_s_register __pyx_mstate_global->__pyx_n_s_register
 #define __pyx_n_s_res_flgs __pyx_mstate_global->__pyx_n_s_res_flgs
 #define __pyx_n_s_resid __pyx_mstate_global->__pyx_n_s_resid
 #define __pyx_n_s_residue_atoms __pyx_mstate_global->__pyx_n_s_residue_atoms
-#define __pyx_n_s_results __pyx_mstate_global->__pyx_n_s_results
 #define __pyx_n_s_seg_id __pyx_mstate_global->__pyx_n_s_seg_id
 #define __pyx_n_s_setstate __pyx_mstate_global->__pyx_n_s_setstate
 #define __pyx_n_s_setstate_cython __pyx_mstate_global->__pyx_n_s_setstate_cython
 #define __pyx_n_s_shape __pyx_mstate_global->__pyx_n_s_shape
 #define __pyx_n_s_sidechain __pyx_mstate_global->__pyx_n_s_sidechain
 #define __pyx_n_s_size __pyx_mstate_global->__pyx_n_s_size
 #define __pyx_n_s_source __pyx_mstate_global->__pyx_n_s_source
@@ -5097,19 +5064,17 @@
 #define __pyx_tuple__16 __pyx_mstate_global->__pyx_tuple__16
 #define __pyx_tuple__17 __pyx_mstate_global->__pyx_tuple__17
 #define __pyx_tuple__18 __pyx_mstate_global->__pyx_tuple__18
 #define __pyx_tuple__19 __pyx_mstate_global->__pyx_tuple__19
 #define __pyx_tuple__20 __pyx_mstate_global->__pyx_tuple__20
 #define __pyx_tuple__22 __pyx_mstate_global->__pyx_tuple__22
 #define __pyx_tuple__24 __pyx_mstate_global->__pyx_tuple__24
-#define __pyx_tuple__26 __pyx_mstate_global->__pyx_tuple__26
 #define __pyx_codeobj__21 __pyx_mstate_global->__pyx_codeobj__21
 #define __pyx_codeobj__23 __pyx_mstate_global->__pyx_codeobj__23
 #define __pyx_codeobj__25 __pyx_mstate_global->__pyx_codeobj__25
-#define __pyx_codeobj__27 __pyx_mstate_global->__pyx_codeobj__27
 /* #### Code section: module_code ### */
 
 /* "string.from_py":13
  * 
  * @cname("__pyx_convert_string_from_py_std__in_string")
  * cdef string __pyx_convert_string_from_py_std__in_string(object o) except *:             # <<<<<<<<<<<<<<
  *     cdef Py_ssize_t length = 0
@@ -5313,163 +5278,14 @@
   __Pyx_pretend_to_initialize(&__pyx_r);
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_item);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "vector.to_py":66
- * 
- * @cname("__pyx_convert_vector_to_py_int")
- * cdef object __pyx_convert_vector_to_py_int(const vector[X]& v):             # <<<<<<<<<<<<<<
- *     if v.size() > <size_t> PY_SSIZE_T_MAX:
- *         raise MemoryError()
- */
-
-static PyObject *__pyx_convert_vector_to_py_int(std::vector<int>  const &__pyx_v_v) {
-  Py_ssize_t __pyx_v_v_size_signed;
-  PyObject *__pyx_v_o = NULL;
-  Py_ssize_t __pyx_v_i;
-  PyObject *__pyx_v_item = 0;
-  PyObject *__pyx_r = NULL;
-  __Pyx_RefNannyDeclarations
-  int __pyx_t_1;
-  PyObject *__pyx_t_2 = NULL;
-  Py_ssize_t __pyx_t_3;
-  Py_ssize_t __pyx_t_4;
-  Py_ssize_t __pyx_t_5;
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("__pyx_convert_vector_to_py_int", 1);
-
-  /* "vector.to_py":67
- * @cname("__pyx_convert_vector_to_py_int")
- * cdef object __pyx_convert_vector_to_py_int(const vector[X]& v):
- *     if v.size() > <size_t> PY_SSIZE_T_MAX:             # <<<<<<<<<<<<<<
- *         raise MemoryError()
- *     v_size_signed = <Py_ssize_t> v.size()
- */
-  __pyx_t_1 = (__pyx_v_v.size() > ((size_t)PY_SSIZE_T_MAX));
-  if (unlikely(__pyx_t_1)) {
-
-    /* "vector.to_py":68
- * cdef object __pyx_convert_vector_to_py_int(const vector[X]& v):
- *     if v.size() > <size_t> PY_SSIZE_T_MAX:
- *         raise MemoryError()             # <<<<<<<<<<<<<<
- *     v_size_signed = <Py_ssize_t> v.size()
- * 
- */
-    PyErr_NoMemory(); __PYX_ERR(1, 68, __pyx_L1_error)
-
-    /* "vector.to_py":67
- * @cname("__pyx_convert_vector_to_py_int")
- * cdef object __pyx_convert_vector_to_py_int(const vector[X]& v):
- *     if v.size() > <size_t> PY_SSIZE_T_MAX:             # <<<<<<<<<<<<<<
- *         raise MemoryError()
- *     v_size_signed = <Py_ssize_t> v.size()
- */
-  }
-
-  /* "vector.to_py":69
- *     if v.size() > <size_t> PY_SSIZE_T_MAX:
- *         raise MemoryError()
- *     v_size_signed = <Py_ssize_t> v.size()             # <<<<<<<<<<<<<<
- * 
- *     o = PyList_New(v_size_signed)
- */
-  __pyx_v_v_size_signed = ((Py_ssize_t)__pyx_v_v.size());
-
-  /* "vector.to_py":71
- *     v_size_signed = <Py_ssize_t> v.size()
- * 
- *     o = PyList_New(v_size_signed)             # <<<<<<<<<<<<<<
- * 
- *     cdef Py_ssize_t i
- */
-  __pyx_t_2 = PyList_New(__pyx_v_v_size_signed); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 71, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_v_o = ((PyObject*)__pyx_t_2);
-  __pyx_t_2 = 0;
-
-  /* "vector.to_py":76
- *     cdef object item
- * 
- *     for i in range(v_size_signed):             # <<<<<<<<<<<<<<
- *         item = v[i]
- *         Py_INCREF(item)
- */
-  __pyx_t_3 = __pyx_v_v_size_signed;
-  __pyx_t_4 = __pyx_t_3;
-  for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
-    __pyx_v_i = __pyx_t_5;
-
-    /* "vector.to_py":77
- * 
- *     for i in range(v_size_signed):
- *         item = v[i]             # <<<<<<<<<<<<<<
- *         Py_INCREF(item)
- *         PyList_SET_ITEM(o, i, item)
- */
-    __pyx_t_2 = __Pyx_PyInt_From_int((__pyx_v_v[__pyx_v_i])); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 77, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_XDECREF_SET(__pyx_v_item, __pyx_t_2);
-    __pyx_t_2 = 0;
-
-    /* "vector.to_py":78
- *     for i in range(v_size_signed):
- *         item = v[i]
- *         Py_INCREF(item)             # <<<<<<<<<<<<<<
- *         PyList_SET_ITEM(o, i, item)
- * 
- */
-    Py_INCREF(__pyx_v_item);
-
-    /* "vector.to_py":79
- *         item = v[i]
- *         Py_INCREF(item)
- *         PyList_SET_ITEM(o, i, item)             # <<<<<<<<<<<<<<
- * 
- *     return o
- */
-    PyList_SET_ITEM(__pyx_v_o, __pyx_v_i, __pyx_v_item);
-  }
-
-  /* "vector.to_py":81
- *         PyList_SET_ITEM(o, i, item)
- * 
- *     return o             # <<<<<<<<<<<<<<
- * 
- */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(__pyx_v_o);
-  __pyx_r = __pyx_v_o;
-  goto __pyx_L0;
-
-  /* "vector.to_py":66
- * 
- * @cname("__pyx_convert_vector_to_py_int")
- * cdef object __pyx_convert_vector_to_py_int(const vector[X]& v):             # <<<<<<<<<<<<<<
- *     if v.size() > <size_t> PY_SSIZE_T_MAX:
- *         raise MemoryError()
- */
-
-  /* function exit code */
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_AddTraceback("vector.to_py.__pyx_convert_vector_to_py_int", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __pyx_r = 0;
-  __pyx_L0:;
-  __Pyx_XDECREF(__pyx_v_o);
-  __Pyx_XDECREF(__pyx_v_item);
-  __Pyx_XGIVEREF(__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
 /* "View.MemoryView":131
  *         cdef bint dtype_is_object
  * 
  *     def __cinit__(array self, tuple shape, Py_ssize_t itemsize, format not None,             # <<<<<<<<<<<<<<
  *                   mode="c", bint allocate_buffer=True):
  * 
  */
@@ -19088,261 +18904,261 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_7ndarray_4base_base(PyArrayObject *__pyx_v_self) {
   PyObject *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":248
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":248
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  *             return PyArray_BASE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_BASE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
 static CYTHON_INLINE PyArray_Descr *__pyx_f_5numpy_7ndarray_5descr_descr(PyArrayObject *__pyx_v_self) {
   PyArray_Descr *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyArray_Descr *__pyx_t_1;
   __Pyx_RefNannySetupContext("descr", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":254
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":254
  *             """Returns an owned reference to the dtype of the array.
  *             """
  *             return <dtype>PyArray_DESCR(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __pyx_t_1 = PyArray_DESCR(__pyx_v_self);
   __Pyx_INCREF((PyObject *)((PyArray_Descr *)__pyx_t_1));
   __pyx_r = ((PyArray_Descr *)__pyx_t_1);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_7ndarray_4ndim_ndim(PyArrayObject *__pyx_v_self) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":260
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":260
  *             """Returns the number of dimensions in the array.
  *             """
  *             return PyArray_NDIM(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_NDIM(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_5shape_shape(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":268
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":268
  *             Can return NULL for 0-dimensional arrays.
  *             """
  *             return PyArray_DIMS(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_DIMS(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_7strides_strides(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":275
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":275
  *             The number of elements matches the number of dimensions of the array (ndim).
  *             """
  *             return PyArray_STRIDES(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_STRIDES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
 static CYTHON_INLINE npy_intp __pyx_f_5numpy_7ndarray_4size_size(PyArrayObject *__pyx_v_self) {
   npy_intp __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":281
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":281
  *             """Returns the total size (in number of elements) of the array.
  *             """
  *             return PyArray_SIZE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_SIZE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
 static CYTHON_INLINE char *__pyx_f_5numpy_7ndarray_4data_data(PyArrayObject *__pyx_v_self) {
   char *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":290
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":290
  *             of `PyArray_DATA()` instead, which returns a 'void*'.
  *             """
  *             return PyArray_BYTES(self)             # <<<<<<<<<<<<<<
  * 
  *     ctypedef unsigned char      npy_bool
  */
   __pyx_r = PyArray_BYTES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -19351,29 +19167,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":774
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":774
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 774, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -19384,15 +19200,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -19401,29 +19217,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":777
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":777
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -19434,15 +19250,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -19451,29 +19267,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":780
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":780
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 780, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -19484,15 +19300,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -19501,29 +19317,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":783
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":783
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -19534,15 +19350,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -19551,29 +19367,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":786
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":786
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -19584,217 +19400,217 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = PyDataType_HASSUBARRAY(__pyx_v_d);
   if (__pyx_t_1) {
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":790
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":790
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":792
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":792
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":968
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":968
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":969
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":969
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   __pyx_t_1 = PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(2, 969, __pyx_L1_error)
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_AddTraceback("numpy.set_array_base", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":972
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":972
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = (__pyx_v_base == NULL);
   if (__pyx_t_1) {
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":974
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":974
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":975
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":975
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19810,15 +19626,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -19826,68 +19642,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":981
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":981
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 981, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":982
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":982
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 982, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 983, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 983, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19895,15 +19711,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19918,15 +19734,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19942,15 +19758,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19958,68 +19774,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":987
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":987
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 987, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":988
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":988
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 988, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 989, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 989, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -20027,15 +19843,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -20050,15 +19866,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -20074,15 +19890,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -20090,68 +19906,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":993
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":993
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 993, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":994
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":994
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 994, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":995
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":995
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 995, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 995, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -20159,15 +19975,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -20182,170 +19998,170 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1010
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1010
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1025
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1025
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
 static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
   npy_datetime __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1035
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1035
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
 static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
   npy_timedelta __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1042
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1042
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
 static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
   NPY_DATETIMEUNIT __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1049
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1049
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -21284,359 +21100,15 @@
  *     """ set all elements of array to zero. """
  *     memset(self.data.as_chars, 0, Py_SIZE(self) * self.ob_descr.itemsize)
  */
 
   /* function exit code */
 }
 
-/* "moleculekit/atomselect_utils/atomselect_utils.pyx":36
- * 
- * 
- * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
- * @cython.wraparound(False)  # turn off negative index wrapping for entire function
- * def get_bonded_groups(
- */
-
-/* Python wrapper */
-static PyObject *__pyx_pw_11moleculekit_16atomselect_utils_1get_bonded_groups(PyObject *__pyx_self, 
-#if CYTHON_METH_FASTCALL
-PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
-#else
-PyObject *__pyx_args, PyObject *__pyx_kwds
-#endif
-); /*proto*/
-static PyMethodDef __pyx_mdef_11moleculekit_16atomselect_utils_1get_bonded_groups = {"get_bonded_groups", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11moleculekit_16atomselect_utils_1get_bonded_groups, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_11moleculekit_16atomselect_utils_1get_bonded_groups(PyObject *__pyx_self, 
-#if CYTHON_METH_FASTCALL
-PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
-#else
-PyObject *__pyx_args, PyObject *__pyx_kwds
-#endif
-) {
-  __Pyx_memviewslice __pyx_v_bonds = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_has_lower_bond = { 0, 0, { 0 }, { 0 }, { 0 } };
-  int __pyx_v_n_atoms;
-  __Pyx_memviewslice __pyx_v_group = { 0, 0, { 0 }, { 0 }, { 0 } };
-  #if !CYTHON_METH_FASTCALL
-  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
-  #endif
-  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
-  PyObject* values[4] = {0,0,0,0};
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
-  PyObject *__pyx_r = 0;
-  __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("get_bonded_groups (wrapper)", 0);
-  #if !CYTHON_METH_FASTCALL
-  #if CYTHON_ASSUME_SAFE_MACROS
-  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
-  #else
-  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
-  #endif
-  #endif
-  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
-  {
-    PyObject **__pyx_pyargnames[] = {&__pyx_n_s_bonds,&__pyx_n_s_has_lower_bond,&__pyx_n_s_n_atoms,&__pyx_n_s_group,0};
-    if (__pyx_kwds) {
-      Py_ssize_t kw_args;
-      switch (__pyx_nargs) {
-        case  4: values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
-        CYTHON_FALLTHROUGH;
-        case  3: values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
-        CYTHON_FALLTHROUGH;
-        case  2: values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
-        CYTHON_FALLTHROUGH;
-        case  1: values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
-        CYTHON_FALLTHROUGH;
-        case  0: break;
-        default: goto __pyx_L5_argtuple_error;
-      }
-      kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
-      switch (__pyx_nargs) {
-        case  0:
-        if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_bonds)) != 0)) {
-          (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
-          kw_args--;
-        }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 36, __pyx_L3_error)
-        else goto __pyx_L5_argtuple_error;
-        CYTHON_FALLTHROUGH;
-        case  1:
-        if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_has_lower_bond)) != 0)) {
-          (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
-          kw_args--;
-        }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 36, __pyx_L3_error)
-        else {
-          __Pyx_RaiseArgtupleInvalid("get_bonded_groups", 1, 4, 4, 1); __PYX_ERR(0, 36, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  2:
-        if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_atoms)) != 0)) {
-          (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
-          kw_args--;
-        }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 36, __pyx_L3_error)
-        else {
-          __Pyx_RaiseArgtupleInvalid("get_bonded_groups", 1, 4, 4, 2); __PYX_ERR(0, 36, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  3:
-        if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_group)) != 0)) {
-          (void)__Pyx_Arg_NewRef_FASTCALL(values[3]);
-          kw_args--;
-        }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 36, __pyx_L3_error)
-        else {
-          __Pyx_RaiseArgtupleInvalid("get_bonded_groups", 1, 4, 4, 3); __PYX_ERR(0, 36, __pyx_L3_error)
-        }
-      }
-      if (unlikely(kw_args > 0)) {
-        const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "get_bonded_groups") < 0)) __PYX_ERR(0, 36, __pyx_L3_error)
-      }
-    } else if (unlikely(__pyx_nargs != 4)) {
-      goto __pyx_L5_argtuple_error;
-    } else {
-      values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
-      values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
-      values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
-      values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
-    }
-    __pyx_v_bonds = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_bonds.memview)) __PYX_ERR(0, 39, __pyx_L3_error)
-    __pyx_v_has_lower_bond = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_has_lower_bond.memview)) __PYX_ERR(0, 40, __pyx_L3_error)
-    __pyx_v_n_atoms = __Pyx_PyInt_As_int(values[2]); if (unlikely((__pyx_v_n_atoms == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 41, __pyx_L3_error)
-    __pyx_v_group = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_group.memview)) __PYX_ERR(0, 42, __pyx_L3_error)
-  }
-  goto __pyx_L6_skip;
-  __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("get_bonded_groups", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 36, __pyx_L3_error)
-  __pyx_L6_skip:;
-  goto __pyx_L4_argument_unpacking_done;
-  __pyx_L3_error:;
-  {
-    Py_ssize_t __pyx_temp;
-    for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
-      __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
-    }
-  }
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_bonds, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_has_lower_bond, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_group, 1);
-  __Pyx_AddTraceback("moleculekit.atomselect_utils.get_bonded_groups", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __Pyx_RefNannyFinishContext();
-  return NULL;
-  __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11moleculekit_16atomselect_utils_get_bonded_groups(__pyx_self, __pyx_v_bonds, __pyx_v_has_lower_bond, __pyx_v_n_atoms, __pyx_v_group);
-
-  /* function exit code */
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_bonds, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_has_lower_bond, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_group, 1);
-  {
-    Py_ssize_t __pyx_temp;
-    for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
-      __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
-    }
-  }
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-static PyObject *__pyx_pf_11moleculekit_16atomselect_utils_get_bonded_groups(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_bonds, __Pyx_memviewslice __pyx_v_has_lower_bond, int __pyx_v_n_atoms, __Pyx_memviewslice __pyx_v_group) {
-  int __pyx_v_i;
-  int __pyx_v_k;
-  int __pyx_v_n_bonds;
-  std::vector<int>  __pyx_v_results;
-  PyObject *__pyx_r = NULL;
-  __Pyx_RefNannyDeclarations
-  int __pyx_t_1;
-  int __pyx_t_2;
-  int __pyx_t_3;
-  Py_ssize_t __pyx_t_4;
-  Py_ssize_t __pyx_t_5;
-  __pyx_t_11moleculekit_16atomselect_utils_UINT32_t __pyx_t_6;
-  __pyx_t_11moleculekit_16atomselect_utils_UINT32_t __pyx_t_7;
-  __pyx_t_11moleculekit_16atomselect_utils_UINT32_t __pyx_t_8;
-  int __pyx_t_9;
-  size_t __pyx_t_10;
-  PyObject *__pyx_t_11 = NULL;
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("get_bonded_groups", 1);
-
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":45
- *     ):
- *     cdef int i, j, k
- *     cdef int n_bonds = bonds.shape[0]             # <<<<<<<<<<<<<<
- *     cdef vector[int] results
- * 
- */
-  __pyx_v_n_bonds = (__pyx_v_bonds.shape[0]);
-
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":49
- * 
- *     # Mark atoms which have bonds to lower indexes
- *     for i in range(n_bonds):             # <<<<<<<<<<<<<<
- *         has_lower_bond[max(bonds[i, 0], bonds[i, 1])] = 1
- * 
- */
-  __pyx_t_1 = __pyx_v_n_bonds;
-  __pyx_t_2 = __pyx_t_1;
-  for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
-    __pyx_v_i = __pyx_t_3;
-
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":50
- *     # Mark atoms which have bonds to lower indexes
- *     for i in range(n_bonds):
- *         has_lower_bond[max(bonds[i, 0], bonds[i, 1])] = 1             # <<<<<<<<<<<<<<
- * 
- *     # Atoms which don't have bonds to lower indexes are the start of a new fragment
- */
-    __pyx_t_4 = __pyx_v_i;
-    __pyx_t_5 = 1;
-    __pyx_t_6 = (*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_bonds.data + __pyx_t_4 * __pyx_v_bonds.strides[0]) ) + __pyx_t_5 * __pyx_v_bonds.strides[1]) )));
-    __pyx_t_5 = __pyx_v_i;
-    __pyx_t_4 = 0;
-    __pyx_t_7 = (*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_bonds.data + __pyx_t_5 * __pyx_v_bonds.strides[0]) ) + __pyx_t_4 * __pyx_v_bonds.strides[1]) )));
-    __pyx_t_9 = (__pyx_t_6 > __pyx_t_7);
-    if (__pyx_t_9) {
-      __pyx_t_8 = __pyx_t_6;
-    } else {
-      __pyx_t_8 = __pyx_t_7;
-    }
-    __pyx_t_10 = __pyx_t_8;
-    *((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_has_lower_bond.data + __pyx_t_10 * __pyx_v_has_lower_bond.strides[0]) )) = 1;
-  }
-
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":53
- * 
- *     # Atoms which don't have bonds to lower indexes are the start of a new fragment
- *     k = 0             # <<<<<<<<<<<<<<
- *     for i in range(n_atoms):
- *         if not has_lower_bond[i]:
- */
-  __pyx_v_k = 0;
-
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":54
- *     # Atoms which don't have bonds to lower indexes are the start of a new fragment
- *     k = 0
- *     for i in range(n_atoms):             # <<<<<<<<<<<<<<
- *         if not has_lower_bond[i]:
- *             k += 1
- */
-  __pyx_t_1 = __pyx_v_n_atoms;
-  __pyx_t_2 = __pyx_t_1;
-  for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
-    __pyx_v_i = __pyx_t_3;
-
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":55
- *     k = 0
- *     for i in range(n_atoms):
- *         if not has_lower_bond[i]:             # <<<<<<<<<<<<<<
- *             k += 1
- *             results.push_back(i)
- */
-    __pyx_t_4 = __pyx_v_i;
-    __pyx_t_9 = (!((*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_has_lower_bond.data + __pyx_t_4 * __pyx_v_has_lower_bond.strides[0]) ))) != 0));
-    if (__pyx_t_9) {
-
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":56
- *     for i in range(n_atoms):
- *         if not has_lower_bond[i]:
- *             k += 1             # <<<<<<<<<<<<<<
- *             results.push_back(i)
- *         group[i] = k
- */
-      __pyx_v_k = (__pyx_v_k + 1);
-
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":57
- *         if not has_lower_bond[i]:
- *             k += 1
- *             results.push_back(i)             # <<<<<<<<<<<<<<
- *         group[i] = k
- * 
- */
-      try {
-        __pyx_v_results.push_back(__pyx_v_i);
-      } catch(...) {
-        __Pyx_CppExn2PyErr();
-        __PYX_ERR(0, 57, __pyx_L1_error)
-      }
-
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":55
- *     k = 0
- *     for i in range(n_atoms):
- *         if not has_lower_bond[i]:             # <<<<<<<<<<<<<<
- *             k += 1
- *             results.push_back(i)
- */
-    }
-
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":58
- *             k += 1
- *             results.push_back(i)
- *         group[i] = k             # <<<<<<<<<<<<<<
- * 
- *     results.push_back(n_atoms)
- */
-    __pyx_t_4 = __pyx_v_i;
-    *((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_group.data + __pyx_t_4 * __pyx_v_group.strides[0]) )) = __pyx_v_k;
-  }
-
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":60
- *         group[i] = k
- * 
- *     results.push_back(n_atoms)             # <<<<<<<<<<<<<<
- * 
- *     return results
- */
-  try {
-    __pyx_v_results.push_back(__pyx_v_n_atoms);
-  } catch(...) {
-    __Pyx_CppExn2PyErr();
-    __PYX_ERR(0, 60, __pyx_L1_error)
-  }
-
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":62
- *     results.push_back(n_atoms)
- * 
- *     return results             # <<<<<<<<<<<<<<
- * 
- * 
- */
-  __Pyx_XDECREF(__pyx_r);
-  __pyx_t_11 = __pyx_convert_vector_to_py_int(__pyx_v_results); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 62, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_11);
-  __pyx_r = __pyx_t_11;
-  __pyx_t_11 = 0;
-  goto __pyx_L0;
-
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":36
- * 
- * 
- * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
- * @cython.wraparound(False)  # turn off negative index wrapping for entire function
- * def get_bonded_groups(
- */
-
-  /* function exit code */
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_11);
-  __Pyx_AddTraceback("moleculekit.atomselect_utils.get_bonded_groups", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __pyx_r = NULL;
-  __pyx_L0:;
-  __Pyx_XGIVEREF(__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-/* "moleculekit/atomselect_utils/atomselect_utils.pyx":67
+/* "moleculekit/atomselect_utils/atomselect_utils.pyx":39
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _make_uniq_resids(             # <<<<<<<<<<<<<<
  *         int n_atoms,
  *         vector[vector[int]] &atom_bonds,
  */
 
@@ -21660,237 +21132,237 @@
   int __pyx_t_9;
   Py_ssize_t __pyx_t_10;
   int __pyx_t_11;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":82
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":54
  *     cdef UINT32_t ins, num_residues
  * 
  *     residue_atoms.push_back(vector[int]())             # <<<<<<<<<<<<<<
  * 
  *     num_residues = 0
  */
   try {
     __pyx_t_1 = std::vector<int> ();
   } catch(...) {
     __Pyx_CppExn2PyErr();
-    __PYX_ERR(0, 82, __pyx_L1_error)
+    __PYX_ERR(0, 54, __pyx_L1_error)
   }
   try {
     __pyx_v_residue_atoms.push_back(__pyx_t_1);
   } catch(...) {
     __Pyx_CppExn2PyErr();
-    __PYX_ERR(0, 82, __pyx_L1_error)
+    __PYX_ERR(0, 54, __pyx_L1_error)
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":84
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":56
  *     residue_atoms.push_back(vector[int]())
  * 
  *     num_residues = 0             # <<<<<<<<<<<<<<
  *     for i in range(n_atoms):
  *         if not flgs[i]:  # Not numbered yet
  */
   __pyx_v_num_residues = 0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":85
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":57
  * 
  *     num_residues = 0
  *     for i in range(n_atoms):             # <<<<<<<<<<<<<<
  *         if not flgs[i]:  # Not numbered yet
  *             # Find atoms connected to i with same resid and give new uniq_resid
  */
   __pyx_t_2 = __pyx_v_n_atoms;
   __pyx_t_3 = __pyx_t_2;
   for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
     __pyx_v_i = __pyx_t_4;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":86
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":58
  *     num_residues = 0
  *     for i in range(n_atoms):
  *         if not flgs[i]:  # Not numbered yet             # <<<<<<<<<<<<<<
  *             # Find atoms connected to i with same resid and give new uniq_resid
  *             res = resid[i]
  */
     __pyx_t_5 = __pyx_v_i;
     __pyx_t_6 = (!((*((bool *) ( /* dim=0 */ (__pyx_v_flgs.data + __pyx_t_5 * __pyx_v_flgs.strides[0]) ))) != 0));
     if (__pyx_t_6) {
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":88
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":60
  *         if not flgs[i]:  # Not numbered yet
  *             # Find atoms connected to i with same resid and give new uniq_resid
  *             res = resid[i]             # <<<<<<<<<<<<<<
  *             ins = insertion[i]
  * 
  */
       __pyx_t_5 = __pyx_v_i;
       __pyx_v_res = (*((__pyx_t_11moleculekit_16atomselect_utils_INT64_t *) ( /* dim=0 */ (__pyx_v_resid.data + __pyx_t_5 * __pyx_v_resid.strides[0]) )));
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":89
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":61
  *             # Find atoms connected to i with same resid and give new uniq_resid
  *             res = resid[i]
  *             ins = insertion[i]             # <<<<<<<<<<<<<<
  * 
  *             st.push(i)
  */
       __pyx_t_5 = __pyx_v_i;
       __pyx_v_ins = (*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_insertion.data + __pyx_t_5 * __pyx_v_insertion.strides[0]) )));
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":91
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":63
  *             ins = insertion[i]
  * 
  *             st.push(i)             # <<<<<<<<<<<<<<
  * 
  *             while not st.empty():
  */
       try {
         __pyx_v_st.push(__pyx_v_i);
       } catch(...) {
         __Pyx_CppExn2PyErr();
-        __PYX_ERR(0, 91, __pyx_L1_error)
+        __PYX_ERR(0, 63, __pyx_L1_error)
       }
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":93
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":65
  *             st.push(i)
  * 
  *             while not st.empty():             # <<<<<<<<<<<<<<
  *                 j = st.top()
  *                 st.pop()
  */
       while (1) {
         __pyx_t_6 = (!__pyx_v_st.empty());
         if (!__pyx_t_6) break;
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":94
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":66
  * 
  *             while not st.empty():
  *                 j = st.top()             # <<<<<<<<<<<<<<
  *                 st.pop()
  *                 if flgs[j]:
  */
         __pyx_v_j = __pyx_v_st.top();
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":95
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":67
  *             while not st.empty():
  *                 j = st.top()
  *                 st.pop()             # <<<<<<<<<<<<<<
  *                 if flgs[j]:
  *                     continue
  */
         __pyx_v_st.pop();
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":96
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":68
  *                 j = st.top()
  *                 st.pop()
  *                 if flgs[j]:             # <<<<<<<<<<<<<<
  *                     continue
  * 
  */
         __pyx_t_5 = __pyx_v_j;
         __pyx_t_6 = ((*((bool *) ( /* dim=0 */ (__pyx_v_flgs.data + __pyx_t_5 * __pyx_v_flgs.strides[0]) ))) != 0);
         if (__pyx_t_6) {
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":97
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":69
  *                 st.pop()
  *                 if flgs[j]:
  *                     continue             # <<<<<<<<<<<<<<
  * 
  *                 uq_resid[j] = num_residues
  */
           goto __pyx_L6_continue;
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":96
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":68
  *                 j = st.top()
  *                 st.pop()
  *                 if flgs[j]:             # <<<<<<<<<<<<<<
  *                     continue
  * 
  */
         }
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":99
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":71
  *                     continue
  * 
  *                 uq_resid[j] = num_residues             # <<<<<<<<<<<<<<
  *                 residue_atoms[num_residues].push_back(j)
  *                 flgs[j] = True
  */
         __pyx_t_5 = __pyx_v_j;
         *((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_uq_resid.data + __pyx_t_5 * __pyx_v_uq_resid.strides[0]) )) = __pyx_v_num_residues;
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":100
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":72
  * 
  *                 uq_resid[j] = num_residues
  *                 residue_atoms[num_residues].push_back(j)             # <<<<<<<<<<<<<<
  *                 flgs[j] = True
  * 
  */
         try {
           (__pyx_v_residue_atoms[__pyx_v_num_residues]).push_back(__pyx_v_j);
         } catch(...) {
           __Pyx_CppExn2PyErr();
-          __PYX_ERR(0, 100, __pyx_L1_error)
+          __PYX_ERR(0, 72, __pyx_L1_error)
         }
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":101
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":73
  *                 uq_resid[j] = num_residues
  *                 residue_atoms[num_residues].push_back(j)
  *                 flgs[j] = True             # <<<<<<<<<<<<<<
  * 
  *                 for bi in atom_bonds[j]:
  */
         __pyx_t_5 = __pyx_v_j;
         *((bool *) ( /* dim=0 */ (__pyx_v_flgs.data + __pyx_t_5 * __pyx_v_flgs.strides[0]) )) = 1;
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":103
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":75
  *                 flgs[j] = True
  * 
  *                 for bi in atom_bonds[j]:             # <<<<<<<<<<<<<<
  *                     if flgs[bi]:
  *                         continue
  */
         __pyx_t_8 = &(__pyx_v_atom_bonds[__pyx_v_j]);
         __pyx_t_7 = __pyx_t_8->begin();
         for (;;) {
           if (!(__pyx_t_7 != __pyx_t_8->end())) break;
           __pyx_t_9 = *__pyx_t_7;
           ++__pyx_t_7;
           __pyx_v_bi = __pyx_t_9;
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":104
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":76
  * 
  *                 for bi in atom_bonds[j]:
  *                     if flgs[bi]:             # <<<<<<<<<<<<<<
  *                         continue
  *                     if chain_id[j] == chain_id[bi] and seg_id[j] == seg_id[bi] and resid[bi] == res and insertion[bi] == ins:
  */
           __pyx_t_5 = __pyx_v_bi;
           __pyx_t_6 = ((*((bool *) ( /* dim=0 */ (__pyx_v_flgs.data + __pyx_t_5 * __pyx_v_flgs.strides[0]) ))) != 0);
           if (__pyx_t_6) {
 
-            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":105
+            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":77
  *                 for bi in atom_bonds[j]:
  *                     if flgs[bi]:
  *                         continue             # <<<<<<<<<<<<<<
  *                     if chain_id[j] == chain_id[bi] and seg_id[j] == seg_id[bi] and resid[bi] == res and insertion[bi] == ins:
  *                         st.push(bi)
  */
             goto __pyx_L9_continue;
 
-            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":104
+            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":76
  * 
  *                 for bi in atom_bonds[j]:
  *                     if flgs[bi]:             # <<<<<<<<<<<<<<
  *                         continue
  *                     if chain_id[j] == chain_id[bi] and seg_id[j] == seg_id[bi] and resid[bi] == res and insertion[bi] == ins:
  */
           }
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":106
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":78
  *                     if flgs[bi]:
  *                         continue
  *                     if chain_id[j] == chain_id[bi] and seg_id[j] == seg_id[bi] and resid[bi] == res and insertion[bi] == ins:             # <<<<<<<<<<<<<<
  *                         st.push(bi)
  *             num_residues += 1
  */
           __pyx_t_5 = __pyx_v_j;
@@ -21918,108 +21390,108 @@
           }
           __pyx_t_5 = __pyx_v_bi;
           __pyx_t_11 = ((*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_insertion.data + __pyx_t_5 * __pyx_v_insertion.strides[0]) ))) == __pyx_v_ins);
           __pyx_t_6 = __pyx_t_11;
           __pyx_L13_bool_binop_done:;
           if (__pyx_t_6) {
 
-            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":107
+            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":79
  *                         continue
  *                     if chain_id[j] == chain_id[bi] and seg_id[j] == seg_id[bi] and resid[bi] == res and insertion[bi] == ins:
  *                         st.push(bi)             # <<<<<<<<<<<<<<
  *             num_residues += 1
  *             residue_atoms.push_back(vector[int]())
  */
             try {
               __pyx_v_st.push(__pyx_v_bi);
             } catch(...) {
               __Pyx_CppExn2PyErr();
-              __PYX_ERR(0, 107, __pyx_L1_error)
+              __PYX_ERR(0, 79, __pyx_L1_error)
             }
 
-            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":106
+            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":78
  *                     if flgs[bi]:
  *                         continue
  *                     if chain_id[j] == chain_id[bi] and seg_id[j] == seg_id[bi] and resid[bi] == res and insertion[bi] == ins:             # <<<<<<<<<<<<<<
  *                         st.push(bi)
  *             num_residues += 1
  */
           }
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":103
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":75
  *                 flgs[j] = True
  * 
  *                 for bi in atom_bonds[j]:             # <<<<<<<<<<<<<<
  *                     if flgs[bi]:
  *                         continue
  */
           __pyx_L9_continue:;
         }
         __pyx_L6_continue:;
       }
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":108
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":80
  *                     if chain_id[j] == chain_id[bi] and seg_id[j] == seg_id[bi] and resid[bi] == res and insertion[bi] == ins:
  *                         st.push(bi)
  *             num_residues += 1             # <<<<<<<<<<<<<<
  *             residue_atoms.push_back(vector[int]())
  * 
  */
       __pyx_v_num_residues = (__pyx_v_num_residues + 1);
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":109
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":81
  *                         st.push(bi)
  *             num_residues += 1
  *             residue_atoms.push_back(vector[int]())             # <<<<<<<<<<<<<<
  * 
  *     residue_atoms.pop_back()
  */
       try {
         __pyx_t_1 = std::vector<int> ();
       } catch(...) {
         __Pyx_CppExn2PyErr();
-        __PYX_ERR(0, 109, __pyx_L1_error)
+        __PYX_ERR(0, 81, __pyx_L1_error)
       }
       try {
         __pyx_v_residue_atoms.push_back(__pyx_t_1);
       } catch(...) {
         __Pyx_CppExn2PyErr();
-        __PYX_ERR(0, 109, __pyx_L1_error)
+        __PYX_ERR(0, 81, __pyx_L1_error)
       }
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":86
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":58
  *     num_residues = 0
  *     for i in range(n_atoms):
  *         if not flgs[i]:  # Not numbered yet             # <<<<<<<<<<<<<<
  *             # Find atoms connected to i with same resid and give new uniq_resid
  *             res = resid[i]
  */
     }
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":111
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":83
  *             residue_atoms.push_back(vector[int]())
  * 
  *     residue_atoms.pop_back()             # <<<<<<<<<<<<<<
  *     return True
  * 
  */
   __pyx_v_residue_atoms.pop_back();
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":112
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":84
  * 
  *     residue_atoms.pop_back()
  *     return True             # <<<<<<<<<<<<<<
  * 
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  */
   __pyx_r = 1;
   goto __pyx_L0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":67
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":39
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _make_uniq_resids(             # <<<<<<<<<<<<<<
  *         int n_atoms,
  *         vector[vector[int]] &atom_bonds,
  */
 
@@ -22027,15 +21499,15 @@
   __pyx_L1_error:;
   __Pyx_AddTraceback("moleculekit.atomselect_utils._make_uniq_resids", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "moleculekit/atomselect_utils/atomselect_utils.pyx":116
+/* "moleculekit/atomselect_utils/atomselect_utils.pyx":88
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _get_atom_bonds(             # <<<<<<<<<<<<<<
  *         int n_atoms,
  *         UINT32_t[:, :] bonds,
  */
 
@@ -22051,130 +21523,130 @@
   std::vector<int>  __pyx_t_4;
   Py_ssize_t __pyx_t_5;
   Py_ssize_t __pyx_t_6;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":125
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":97
  * 
  *     # Create nested list of bonded atoms
  *     for i in range(n_atoms):             # <<<<<<<<<<<<<<
  *         atom_bonds.push_back(vector[int]())
  * 
  */
   __pyx_t_1 = __pyx_v_n_atoms;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":126
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":98
  *     # Create nested list of bonded atoms
  *     for i in range(n_atoms):
  *         atom_bonds.push_back(vector[int]())             # <<<<<<<<<<<<<<
  * 
  *     n_bonds = bonds.shape[0]
  */
     try {
       __pyx_t_4 = std::vector<int> ();
     } catch(...) {
       __Pyx_CppExn2PyErr();
-      __PYX_ERR(0, 126, __pyx_L1_error)
+      __PYX_ERR(0, 98, __pyx_L1_error)
     }
     try {
       __pyx_v_atom_bonds.push_back(__pyx_t_4);
     } catch(...) {
       __Pyx_CppExn2PyErr();
-      __PYX_ERR(0, 126, __pyx_L1_error)
+      __PYX_ERR(0, 98, __pyx_L1_error)
     }
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":128
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":100
  *         atom_bonds.push_back(vector[int]())
  * 
  *     n_bonds = bonds.shape[0]             # <<<<<<<<<<<<<<
  *     for i in range(n_bonds):
  *         b1 = bonds[i, 0]
  */
   __pyx_v_n_bonds = (__pyx_v_bonds.shape[0]);
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":129
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":101
  * 
  *     n_bonds = bonds.shape[0]
  *     for i in range(n_bonds):             # <<<<<<<<<<<<<<
  *         b1 = bonds[i, 0]
  *         b2 = bonds[i, 1]
  */
   __pyx_t_1 = __pyx_v_n_bonds;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":130
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":102
  *     n_bonds = bonds.shape[0]
  *     for i in range(n_bonds):
  *         b1 = bonds[i, 0]             # <<<<<<<<<<<<<<
  *         b2 = bonds[i, 1]
  *         atom_bonds[b1].push_back(b2)
  */
     __pyx_t_5 = __pyx_v_i;
     __pyx_t_6 = 0;
     __pyx_v_b1 = (*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_bonds.data + __pyx_t_5 * __pyx_v_bonds.strides[0]) ) + __pyx_t_6 * __pyx_v_bonds.strides[1]) )));
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":131
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":103
  *     for i in range(n_bonds):
  *         b1 = bonds[i, 0]
  *         b2 = bonds[i, 1]             # <<<<<<<<<<<<<<
  *         atom_bonds[b1].push_back(b2)
  *         atom_bonds[b2].push_back(b1)
  */
     __pyx_t_6 = __pyx_v_i;
     __pyx_t_5 = 1;
     __pyx_v_b2 = (*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_bonds.data + __pyx_t_6 * __pyx_v_bonds.strides[0]) ) + __pyx_t_5 * __pyx_v_bonds.strides[1]) )));
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":132
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":104
  *         b1 = bonds[i, 0]
  *         b2 = bonds[i, 1]
  *         atom_bonds[b1].push_back(b2)             # <<<<<<<<<<<<<<
  *         atom_bonds[b2].push_back(b1)
  * 
  */
     try {
       (__pyx_v_atom_bonds[__pyx_v_b1]).push_back(__pyx_v_b2);
     } catch(...) {
       __Pyx_CppExn2PyErr();
-      __PYX_ERR(0, 132, __pyx_L1_error)
+      __PYX_ERR(0, 104, __pyx_L1_error)
     }
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":133
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":105
  *         b2 = bonds[i, 1]
  *         atom_bonds[b1].push_back(b2)
  *         atom_bonds[b2].push_back(b1)             # <<<<<<<<<<<<<<
  * 
  *     return True
  */
     try {
       (__pyx_v_atom_bonds[__pyx_v_b2]).push_back(__pyx_v_b1);
     } catch(...) {
       __Pyx_CppExn2PyErr();
-      __PYX_ERR(0, 133, __pyx_L1_error)
+      __PYX_ERR(0, 105, __pyx_L1_error)
     }
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":135
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":107
  *         atom_bonds[b2].push_back(b1)
  * 
  *     return True             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = 1;
   goto __pyx_L0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":116
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":88
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _get_atom_bonds(             # <<<<<<<<<<<<<<
  *         int n_atoms,
  *         UINT32_t[:, :] bonds,
  */
 
@@ -22182,15 +21654,15 @@
   __pyx_L1_error:;
   __Pyx_AddTraceback("moleculekit.atomselect_utils._get_atom_bonds", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "moleculekit/atomselect_utils/atomselect_utils.pyx":140
+/* "moleculekit/atomselect_utils/atomselect_utils.pyx":112
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _has_n_backbone(             # <<<<<<<<<<<<<<
  *         bool[:] bb,
  *         INT64_t[:] resid,
  */
 
@@ -22206,54 +21678,54 @@
   std::vector<int>  *__pyx_t_5;
   int __pyx_t_6;
   Py_ssize_t __pyx_t_7;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":154
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":126
  *     cdef stack[int] st
  *     cdef int j, count
  *     count = 0             # <<<<<<<<<<<<<<
  * 
  *     # find n backbone atoms connected together with the given residueid
  */
   __pyx_v_count = 0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":157
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":129
  * 
  *     # find n backbone atoms connected together with the given residueid
  *     if flgs[i] != 0:             # <<<<<<<<<<<<<<
  *         return False # Already seen
  * 
  */
   __pyx_t_1 = __pyx_v_i;
   __pyx_t_2 = ((*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_flgs.data + __pyx_t_1 * __pyx_v_flgs.strides[0]) ))) != 0);
   if (__pyx_t_2) {
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":158
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":130
  *     # find n backbone atoms connected together with the given residueid
  *     if flgs[i] != 0:
  *         return False # Already seen             # <<<<<<<<<<<<<<
  * 
  *     if not bb[i] or resid[i] != residueid:
  */
     __pyx_r = 0;
     goto __pyx_L0;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":157
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":129
  * 
  *     # find n backbone atoms connected together with the given residueid
  *     if flgs[i] != 0:             # <<<<<<<<<<<<<<
  *         return False # Already seen
  * 
  */
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":160
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":132
  *         return False # Already seen
  * 
  *     if not bb[i] or resid[i] != residueid:             # <<<<<<<<<<<<<<
  *         return False # Not a backbone atom
  * 
  */
   __pyx_t_1 = __pyx_v_i;
@@ -22265,151 +21737,151 @@
   }
   __pyx_t_1 = __pyx_v_i;
   __pyx_t_3 = ((*((__pyx_t_11moleculekit_16atomselect_utils_INT64_t *) ( /* dim=0 */ (__pyx_v_resid.data + __pyx_t_1 * __pyx_v_resid.strides[0]) ))) != __pyx_v_residueid);
   __pyx_t_2 = __pyx_t_3;
   __pyx_L5_bool_binop_done:;
   if (__pyx_t_2) {
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":161
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":133
  * 
  *     if not bb[i] or resid[i] != residueid:
  *         return False # Not a backbone atom             # <<<<<<<<<<<<<<
  * 
  *     st.push(i)
  */
     __pyx_r = 0;
     goto __pyx_L0;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":160
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":132
  *         return False # Already seen
  * 
  *     if not bb[i] or resid[i] != residueid:             # <<<<<<<<<<<<<<
  *         return False # Not a backbone atom
  * 
  */
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":163
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":135
  *         return False # Not a backbone atom
  * 
  *     st.push(i)             # <<<<<<<<<<<<<<
  * 
  *     while not st.empty():
  */
   try {
     __pyx_v_st.push(__pyx_v_i);
   } catch(...) {
     __Pyx_CppExn2PyErr();
-    __PYX_ERR(0, 163, __pyx_L1_error)
+    __PYX_ERR(0, 135, __pyx_L1_error)
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":165
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":137
  *     st.push(i)
  * 
  *     while not st.empty():             # <<<<<<<<<<<<<<
  *         i = st.top()
  *         st.pop()
  */
   while (1) {
     __pyx_t_2 = (!__pyx_v_st.empty());
     if (!__pyx_t_2) break;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":166
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":138
  * 
  *     while not st.empty():
  *         i = st.top()             # <<<<<<<<<<<<<<
  *         st.pop()
  * 
  */
     __pyx_v_i = __pyx_v_st.top();
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":167
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":139
  *     while not st.empty():
  *         i = st.top()
  *         st.pop()             # <<<<<<<<<<<<<<
  * 
  *         flgs[i] = tmpid
  */
     __pyx_v_st.pop();
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":169
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":141
  *         st.pop()
  * 
  *         flgs[i] = tmpid             # <<<<<<<<<<<<<<
  *         count += 1
  *         if count >= n:
  */
     __pyx_t_1 = __pyx_v_i;
     *((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_flgs.data + __pyx_t_1 * __pyx_v_flgs.strides[0]) )) = __pyx_v_tmpid;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":170
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":142
  * 
  *         flgs[i] = tmpid
  *         count += 1             # <<<<<<<<<<<<<<
  *         if count >= n:
  *             return True
  */
     __pyx_v_count = (__pyx_v_count + 1);
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":171
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":143
  *         flgs[i] = tmpid
  *         count += 1
  *         if count >= n:             # <<<<<<<<<<<<<<
  *             return True
  * 
  */
     __pyx_t_2 = (__pyx_v_count >= __pyx_v_n);
     if (__pyx_t_2) {
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":172
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":144
  *         count += 1
  *         if count >= n:
  *             return True             # <<<<<<<<<<<<<<
  * 
  *         for j in atom_bonds[i]:
  */
       __pyx_r = 1;
       goto __pyx_L0;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":171
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":143
  *         flgs[i] = tmpid
  *         count += 1
  *         if count >= n:             # <<<<<<<<<<<<<<
  *             return True
  * 
  */
     }
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":174
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":146
  *             return True
  * 
  *         for j in atom_bonds[i]:             # <<<<<<<<<<<<<<
  *             if flgs[j] == 0:
  *                 if chain_id[i] != chain_id[j] or seg_id[i] != seg_id[j]:
  */
     __pyx_t_5 = &(__pyx_v_atom_bonds[__pyx_v_i]);
     __pyx_t_4 = __pyx_t_5->begin();
     for (;;) {
       if (!(__pyx_t_4 != __pyx_t_5->end())) break;
       __pyx_t_6 = *__pyx_t_4;
       ++__pyx_t_4;
       __pyx_v_j = __pyx_t_6;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":175
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":147
  * 
  *         for j in atom_bonds[i]:
  *             if flgs[j] == 0:             # <<<<<<<<<<<<<<
  *                 if chain_id[i] != chain_id[j] or seg_id[i] != seg_id[j]:
  *                     continue
  */
       __pyx_t_1 = __pyx_v_j;
       __pyx_t_2 = ((*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_flgs.data + __pyx_t_1 * __pyx_v_flgs.strides[0]) ))) == 0);
       if (__pyx_t_2) {
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":176
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":148
  *         for j in atom_bonds[i]:
  *             if flgs[j] == 0:
  *                 if chain_id[i] != chain_id[j] or seg_id[i] != seg_id[j]:             # <<<<<<<<<<<<<<
  *                     continue
  *                 if bb[j] and residueid == resid[j]:
  */
         __pyx_t_1 = __pyx_v_i;
@@ -22423,33 +21895,33 @@
         __pyx_t_7 = __pyx_v_i;
         __pyx_t_1 = __pyx_v_j;
         __pyx_t_3 = ((*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_seg_id.data + __pyx_t_7 * __pyx_v_seg_id.strides[0]) ))) != (*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_seg_id.data + __pyx_t_1 * __pyx_v_seg_id.strides[0]) ))));
         __pyx_t_2 = __pyx_t_3;
         __pyx_L14_bool_binop_done:;
         if (__pyx_t_2) {
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":177
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":149
  *             if flgs[j] == 0:
  *                 if chain_id[i] != chain_id[j] or seg_id[i] != seg_id[j]:
  *                     continue             # <<<<<<<<<<<<<<
  *                 if bb[j] and residueid == resid[j]:
  *                     st.push(j)
  */
           goto __pyx_L10_continue;
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":176
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":148
  *         for j in atom_bonds[i]:
  *             if flgs[j] == 0:
  *                 if chain_id[i] != chain_id[j] or seg_id[i] != seg_id[j]:             # <<<<<<<<<<<<<<
  *                     continue
  *                 if bb[j] and residueid == resid[j]:
  */
         }
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":178
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":150
  *                 if chain_id[i] != chain_id[j] or seg_id[i] != seg_id[j]:
  *                     continue
  *                 if bb[j] and residueid == resid[j]:             # <<<<<<<<<<<<<<
  *                     st.push(j)
  *     return False
  */
         __pyx_t_1 = __pyx_v_j;
@@ -22461,68 +21933,68 @@
         }
         __pyx_t_1 = __pyx_v_j;
         __pyx_t_3 = (__pyx_v_residueid == (*((__pyx_t_11moleculekit_16atomselect_utils_INT64_t *) ( /* dim=0 */ (__pyx_v_resid.data + __pyx_t_1 * __pyx_v_resid.strides[0]) ))));
         __pyx_t_2 = __pyx_t_3;
         __pyx_L17_bool_binop_done:;
         if (__pyx_t_2) {
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":179
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":151
  *                     continue
  *                 if bb[j] and residueid == resid[j]:
  *                     st.push(j)             # <<<<<<<<<<<<<<
  *     return False
  * 
  */
           try {
             __pyx_v_st.push(__pyx_v_j);
           } catch(...) {
             __Pyx_CppExn2PyErr();
-            __PYX_ERR(0, 179, __pyx_L1_error)
+            __PYX_ERR(0, 151, __pyx_L1_error)
           }
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":178
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":150
  *                 if chain_id[i] != chain_id[j] or seg_id[i] != seg_id[j]:
  *                     continue
  *                 if bb[j] and residueid == resid[j]:             # <<<<<<<<<<<<<<
  *                     st.push(j)
  *     return False
  */
         }
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":175
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":147
  * 
  *         for j in atom_bonds[i]:
  *             if flgs[j] == 0:             # <<<<<<<<<<<<<<
  *                 if chain_id[i] != chain_id[j] or seg_id[i] != seg_id[j]:
  *                     continue
  */
       }
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":174
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":146
  *             return True
  * 
  *         for j in atom_bonds[i]:             # <<<<<<<<<<<<<<
  *             if flgs[j] == 0:
  *                 if chain_id[i] != chain_id[j] or seg_id[i] != seg_id[j]:
  */
       __pyx_L10_continue:;
     }
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":180
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":152
  *                 if bb[j] and residueid == resid[j]:
  *                     st.push(j)
  *     return False             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = 0;
   goto __pyx_L0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":140
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":112
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _has_n_backbone(             # <<<<<<<<<<<<<<
  *         bool[:] bb,
  *         INT64_t[:] resid,
  */
 
@@ -22530,15 +22002,15 @@
   __pyx_L1_error:;
   __Pyx_AddTraceback("moleculekit.atomselect_utils._has_n_backbone", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "moleculekit/atomselect_utils/atomselect_utils.pyx":185
+/* "moleculekit/atomselect_utils/atomselect_utils.pyx":157
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _clean_up_connection(             # <<<<<<<<<<<<<<
  *         int i,
  *         UINT32_t tmpid,
  */
 
@@ -22551,167 +22023,167 @@
   std::vector<int> ::iterator __pyx_t_3;
   std::vector<int>  *__pyx_t_4;
   int __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":194
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":166
  *     cdef int j
  * 
  *     if flgs[i] != tmpid: # Been here before             # <<<<<<<<<<<<<<
  *         return False
  * 
  */
   __pyx_t_1 = __pyx_v_i;
   __pyx_t_2 = ((*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_flgs.data + __pyx_t_1 * __pyx_v_flgs.strides[0]) ))) != __pyx_v_tmpid);
   if (__pyx_t_2) {
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":195
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":167
  * 
  *     if flgs[i] != tmpid: # Been here before
  *         return False             # <<<<<<<<<<<<<<
  * 
  *     st.push(i)
  */
     __pyx_r = 0;
     goto __pyx_L0;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":194
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":166
  *     cdef int j
  * 
  *     if flgs[i] != tmpid: # Been here before             # <<<<<<<<<<<<<<
  *         return False
  * 
  */
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":197
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":169
  *         return False
  * 
  *     st.push(i)             # <<<<<<<<<<<<<<
  *     while not st.empty():
  *         i = st.top()
  */
   try {
     __pyx_v_st.push(__pyx_v_i);
   } catch(...) {
     __Pyx_CppExn2PyErr();
-    __PYX_ERR(0, 197, __pyx_L1_error)
+    __PYX_ERR(0, 169, __pyx_L1_error)
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":198
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":170
  * 
  *     st.push(i)
  *     while not st.empty():             # <<<<<<<<<<<<<<
  *         i = st.top()
  *         st.pop()
  */
   while (1) {
     __pyx_t_2 = (!__pyx_v_st.empty());
     if (!__pyx_t_2) break;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":199
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":171
  *     st.push(i)
  *     while not st.empty():
  *         i = st.top()             # <<<<<<<<<<<<<<
  *         st.pop()
  *         flgs[i] = 0
  */
     __pyx_v_i = __pyx_v_st.top();
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":200
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":172
  *     while not st.empty():
  *         i = st.top()
  *         st.pop()             # <<<<<<<<<<<<<<
  *         flgs[i] = 0
  *         for j in atom_bonds[i]:
  */
     __pyx_v_st.pop();
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":201
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":173
  *         i = st.top()
  *         st.pop()
  *         flgs[i] = 0             # <<<<<<<<<<<<<<
  *         for j in atom_bonds[i]:
  *             if flgs[j] == tmpid:
  */
     __pyx_t_1 = __pyx_v_i;
     *((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_flgs.data + __pyx_t_1 * __pyx_v_flgs.strides[0]) )) = 0;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":202
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":174
  *         st.pop()
  *         flgs[i] = 0
  *         for j in atom_bonds[i]:             # <<<<<<<<<<<<<<
  *             if flgs[j] == tmpid:
  *                 st.push(j)
  */
     __pyx_t_4 = &(__pyx_v_atom_bonds[__pyx_v_i]);
     __pyx_t_3 = __pyx_t_4->begin();
     for (;;) {
       if (!(__pyx_t_3 != __pyx_t_4->end())) break;
       __pyx_t_5 = *__pyx_t_3;
       ++__pyx_t_3;
       __pyx_v_j = __pyx_t_5;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":203
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":175
  *         flgs[i] = 0
  *         for j in atom_bonds[i]:
  *             if flgs[j] == tmpid:             # <<<<<<<<<<<<<<
  *                 st.push(j)
  * 
  */
       __pyx_t_1 = __pyx_v_j;
       __pyx_t_2 = ((*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_flgs.data + __pyx_t_1 * __pyx_v_flgs.strides[0]) ))) == __pyx_v_tmpid);
       if (__pyx_t_2) {
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":204
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":176
  *         for j in atom_bonds[i]:
  *             if flgs[j] == tmpid:
  *                 st.push(j)             # <<<<<<<<<<<<<<
  * 
  *     return True
  */
         try {
           __pyx_v_st.push(__pyx_v_j);
         } catch(...) {
           __Pyx_CppExn2PyErr();
-          __PYX_ERR(0, 204, __pyx_L1_error)
+          __PYX_ERR(0, 176, __pyx_L1_error)
         }
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":203
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":175
  *         flgs[i] = 0
  *         for j in atom_bonds[i]:
  *             if flgs[j] == tmpid:             # <<<<<<<<<<<<<<
  *                 st.push(j)
  * 
  */
       }
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":202
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":174
  *         st.pop()
  *         flgs[i] = 0
  *         for j in atom_bonds[i]:             # <<<<<<<<<<<<<<
  *             if flgs[j] == tmpid:
  *                 st.push(j)
  */
     }
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":206
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":178
  *                 st.push(j)
  * 
  *     return True             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = 1;
   goto __pyx_L0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":185
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":157
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _clean_up_connection(             # <<<<<<<<<<<<<<
  *         int i,
  *         UINT32_t tmpid,
  */
 
@@ -22719,15 +22191,15 @@
   __pyx_L1_error:;
   __Pyx_AddTraceback("moleculekit.atomselect_utils._clean_up_connection", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "moleculekit/atomselect_utils/atomselect_utils.pyx":211
+/* "moleculekit/atomselect_utils/atomselect_utils.pyx":183
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _find_connected_atoms_in_resid(             # <<<<<<<<<<<<<<
  *         int i,
  *         UINT32_t tmpid,
  */
 
@@ -22742,15 +22214,15 @@
   std::vector<int>  *__pyx_t_5;
   int __pyx_t_6;
   Py_ssize_t __pyx_t_7;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":225
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":197
  *     cdef int j
  * 
  *     if flgs[i] != 0 or resid[i] != residueid:             # <<<<<<<<<<<<<<
  *         return False
  * 
  */
   __pyx_t_2 = __pyx_v_i;
@@ -22762,112 +22234,112 @@
   }
   __pyx_t_2 = __pyx_v_i;
   __pyx_t_3 = ((*((__pyx_t_11moleculekit_16atomselect_utils_INT64_t *) ( /* dim=0 */ (__pyx_v_resid.data + __pyx_t_2 * __pyx_v_resid.strides[0]) ))) != __pyx_v_residueid);
   __pyx_t_1 = __pyx_t_3;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":226
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":198
  * 
  *     if flgs[i] != 0 or resid[i] != residueid:
  *         return False             # <<<<<<<<<<<<<<
  * 
  *     st.push(i)
  */
     __pyx_r = 0;
     goto __pyx_L0;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":225
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":197
  *     cdef int j
  * 
  *     if flgs[i] != 0 or resid[i] != residueid:             # <<<<<<<<<<<<<<
  *         return False
  * 
  */
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":228
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":200
  *         return False
  * 
  *     st.push(i)             # <<<<<<<<<<<<<<
  *     while not st.empty():
  *         i = st.top()
  */
   try {
     __pyx_v_st.push(__pyx_v_i);
   } catch(...) {
     __Pyx_CppExn2PyErr();
-    __PYX_ERR(0, 228, __pyx_L1_error)
+    __PYX_ERR(0, 200, __pyx_L1_error)
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":229
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":201
  * 
  *     st.push(i)
  *     while not st.empty():             # <<<<<<<<<<<<<<
  *         i = st.top()
  *         st.pop()
  */
   while (1) {
     __pyx_t_1 = (!__pyx_v_st.empty());
     if (!__pyx_t_1) break;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":230
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":202
  *     st.push(i)
  *     while not st.empty():
  *         i = st.top()             # <<<<<<<<<<<<<<
  *         st.pop()
  *         flgs[i] = tmpid
  */
     __pyx_v_i = __pyx_v_st.top();
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":231
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":203
  *     while not st.empty():
  *         i = st.top()
  *         st.pop()             # <<<<<<<<<<<<<<
  *         flgs[i] = tmpid
  *         polymer[i] = True
  */
     __pyx_v_st.pop();
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":232
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":204
  *         i = st.top()
  *         st.pop()
  *         flgs[i] = tmpid             # <<<<<<<<<<<<<<
  *         polymer[i] = True
  * 
  */
     __pyx_t_2 = __pyx_v_i;
     *((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_flgs.data + __pyx_t_2 * __pyx_v_flgs.strides[0]) )) = __pyx_v_tmpid;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":233
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":205
  *         st.pop()
  *         flgs[i] = tmpid
  *         polymer[i] = True             # <<<<<<<<<<<<<<
  * 
  *         for j in atom_bonds[i]:
  */
     __pyx_t_2 = __pyx_v_i;
     *((bool *) ( /* dim=0 */ (__pyx_v_polymer.data + __pyx_t_2 * __pyx_v_polymer.strides[0]) )) = 1;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":235
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":207
  *         polymer[i] = True
  * 
  *         for j in atom_bonds[i]:             # <<<<<<<<<<<<<<
  *             if flgs[j] == 0 and chain_id[i] == chain_id[j] and seg_id[i] == seg_id[j] and residueid == resid[j]:
  *                 st.push(j)
  */
     __pyx_t_5 = &(__pyx_v_atom_bonds[__pyx_v_i]);
     __pyx_t_4 = __pyx_t_5->begin();
     for (;;) {
       if (!(__pyx_t_4 != __pyx_t_5->end())) break;
       __pyx_t_6 = *__pyx_t_4;
       ++__pyx_t_4;
       __pyx_v_j = __pyx_t_6;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":236
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":208
  * 
  *         for j in atom_bonds[i]:
  *             if flgs[j] == 0 and chain_id[i] == chain_id[j] and seg_id[i] == seg_id[j] and residueid == resid[j]:             # <<<<<<<<<<<<<<
  *                 st.push(j)
  *     return True
  */
       __pyx_t_2 = __pyx_v_j;
@@ -22895,58 +22367,58 @@
       }
       __pyx_t_2 = __pyx_v_j;
       __pyx_t_3 = (__pyx_v_residueid == (*((__pyx_t_11moleculekit_16atomselect_utils_INT64_t *) ( /* dim=0 */ (__pyx_v_resid.data + __pyx_t_2 * __pyx_v_resid.strides[0]) ))));
       __pyx_t_1 = __pyx_t_3;
       __pyx_L11_bool_binop_done:;
       if (__pyx_t_1) {
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":237
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":209
  *         for j in atom_bonds[i]:
  *             if flgs[j] == 0 and chain_id[i] == chain_id[j] and seg_id[i] == seg_id[j] and residueid == resid[j]:
  *                 st.push(j)             # <<<<<<<<<<<<<<
  *     return True
  * 
  */
         try {
           __pyx_v_st.push(__pyx_v_j);
         } catch(...) {
           __Pyx_CppExn2PyErr();
-          __PYX_ERR(0, 237, __pyx_L1_error)
+          __PYX_ERR(0, 209, __pyx_L1_error)
         }
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":236
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":208
  * 
  *         for j in atom_bonds[i]:
  *             if flgs[j] == 0 and chain_id[i] == chain_id[j] and seg_id[i] == seg_id[j] and residueid == resid[j]:             # <<<<<<<<<<<<<<
  *                 st.push(j)
  *     return True
  */
       }
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":235
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":207
  *         polymer[i] = True
  * 
  *         for j in atom_bonds[i]:             # <<<<<<<<<<<<<<
  *             if flgs[j] == 0 and chain_id[i] == chain_id[j] and seg_id[i] == seg_id[j] and residueid == resid[j]:
  *                 st.push(j)
  */
     }
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":238
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":210
  *             if flgs[j] == 0 and chain_id[i] == chain_id[j] and seg_id[i] == seg_id[j] and residueid == resid[j]:
  *                 st.push(j)
  *     return True             # <<<<<<<<<<<<<<
  * 
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  */
   __pyx_r = 1;
   goto __pyx_L0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":211
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":183
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _find_connected_atoms_in_resid(             # <<<<<<<<<<<<<<
  *         int i,
  *         UINT32_t tmpid,
  */
 
@@ -22954,15 +22426,15 @@
   __pyx_L1_error:;
   __Pyx_AddTraceback("moleculekit.atomselect_utils._find_connected_atoms_in_resid", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "moleculekit/atomselect_utils/atomselect_utils.pyx":242
+/* "moleculekit/atomselect_utils/atomselect_utils.pyx":214
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _find_and_mark(             # <<<<<<<<<<<<<<
  *         int n,
  *         bool[:] bb,
  */
 
@@ -22978,45 +22450,45 @@
   Py_ssize_t __pyx_t_5;
   int __pyx_t_6;
   bool __pyx_t_7;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":255
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":227
  *     cdef int n_atoms, i
  *     cdef UINT32_t tmpid
  *     n_atoms = bb.shape[0]             # <<<<<<<<<<<<<<
  *     tmpid = 1
  * 
  */
   __pyx_v_n_atoms = (__pyx_v_bb.shape[0]);
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":256
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":228
  *     cdef UINT32_t tmpid
  *     n_atoms = bb.shape[0]
  *     tmpid = 1             # <<<<<<<<<<<<<<
  * 
  *     for i in range(n_atoms):
  */
   __pyx_v_tmpid = 1;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":258
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":230
  *     tmpid = 1
  * 
  *     for i in range(n_atoms):             # <<<<<<<<<<<<<<
  *         if bb[i] and flgs[i] == 0:
  *             if _has_n_backbone(bb, resid, chain_id, seg_id, i, tmpid, flgs, atom_bonds, n, resid[i]):
  */
   __pyx_t_1 = __pyx_v_n_atoms;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":259
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":231
  * 
  *     for i in range(n_atoms):
  *         if bb[i] and flgs[i] == 0:             # <<<<<<<<<<<<<<
  *             if _has_n_backbone(bb, resid, chain_id, seg_id, i, tmpid, flgs, atom_bonds, n, resid[i]):
  *                 _clean_up_connection(i, tmpid, atom_bonds, flgs)
  */
     __pyx_t_5 = __pyx_v_i;
@@ -23028,97 +22500,97 @@
     }
     __pyx_t_5 = __pyx_v_i;
     __pyx_t_6 = ((*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_flgs.data + __pyx_t_5 * __pyx_v_flgs.strides[0]) ))) == 0);
     __pyx_t_4 = __pyx_t_6;
     __pyx_L6_bool_binop_done:;
     if (__pyx_t_4) {
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":260
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":232
  *     for i in range(n_atoms):
  *         if bb[i] and flgs[i] == 0:
  *             if _has_n_backbone(bb, resid, chain_id, seg_id, i, tmpid, flgs, atom_bonds, n, resid[i]):             # <<<<<<<<<<<<<<
  *                 _clean_up_connection(i, tmpid, atom_bonds, flgs)
  *                 _find_connected_atoms_in_resid(i, tmpid, atom_bonds, flgs, resid, chain_id, seg_id, polymer, resid[i])
  */
       __pyx_t_5 = __pyx_v_i;
-      __pyx_t_7 = __pyx_f_11moleculekit_16atomselect_utils__has_n_backbone(__pyx_v_bb, __pyx_v_resid, __pyx_v_chain_id, __pyx_v_seg_id, __pyx_v_i, __pyx_v_tmpid, __pyx_v_flgs, __pyx_v_atom_bonds, __pyx_v_n, (*((__pyx_t_11moleculekit_16atomselect_utils_INT64_t *) ( /* dim=0 */ (__pyx_v_resid.data + __pyx_t_5 * __pyx_v_resid.strides[0]) )))); if (unlikely(__pyx_t_7 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 260, __pyx_L1_error)
+      __pyx_t_7 = __pyx_f_11moleculekit_16atomselect_utils__has_n_backbone(__pyx_v_bb, __pyx_v_resid, __pyx_v_chain_id, __pyx_v_seg_id, __pyx_v_i, __pyx_v_tmpid, __pyx_v_flgs, __pyx_v_atom_bonds, __pyx_v_n, (*((__pyx_t_11moleculekit_16atomselect_utils_INT64_t *) ( /* dim=0 */ (__pyx_v_resid.data + __pyx_t_5 * __pyx_v_resid.strides[0]) )))); if (unlikely(__pyx_t_7 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 232, __pyx_L1_error)
       __pyx_t_4 = (__pyx_t_7 != 0);
       if (__pyx_t_4) {
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":261
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":233
  *         if bb[i] and flgs[i] == 0:
  *             if _has_n_backbone(bb, resid, chain_id, seg_id, i, tmpid, flgs, atom_bonds, n, resid[i]):
  *                 _clean_up_connection(i, tmpid, atom_bonds, flgs)             # <<<<<<<<<<<<<<
  *                 _find_connected_atoms_in_resid(i, tmpid, atom_bonds, flgs, resid, chain_id, seg_id, polymer, resid[i])
  *                 tmpid += 1
  */
-        __pyx_t_7 = __pyx_f_11moleculekit_16atomselect_utils__clean_up_connection(__pyx_v_i, __pyx_v_tmpid, __pyx_v_atom_bonds, __pyx_v_flgs); if (unlikely(__pyx_t_7 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 261, __pyx_L1_error)
+        __pyx_t_7 = __pyx_f_11moleculekit_16atomselect_utils__clean_up_connection(__pyx_v_i, __pyx_v_tmpid, __pyx_v_atom_bonds, __pyx_v_flgs); if (unlikely(__pyx_t_7 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 233, __pyx_L1_error)
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":262
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":234
  *             if _has_n_backbone(bb, resid, chain_id, seg_id, i, tmpid, flgs, atom_bonds, n, resid[i]):
  *                 _clean_up_connection(i, tmpid, atom_bonds, flgs)
  *                 _find_connected_atoms_in_resid(i, tmpid, atom_bonds, flgs, resid, chain_id, seg_id, polymer, resid[i])             # <<<<<<<<<<<<<<
  *                 tmpid += 1
  *             else:
  */
         __pyx_t_5 = __pyx_v_i;
-        __pyx_t_7 = __pyx_f_11moleculekit_16atomselect_utils__find_connected_atoms_in_resid(__pyx_v_i, __pyx_v_tmpid, __pyx_v_atom_bonds, __pyx_v_flgs, __pyx_v_resid, __pyx_v_chain_id, __pyx_v_seg_id, __pyx_v_polymer, (*((__pyx_t_11moleculekit_16atomselect_utils_INT64_t *) ( /* dim=0 */ (__pyx_v_resid.data + __pyx_t_5 * __pyx_v_resid.strides[0]) )))); if (unlikely(__pyx_t_7 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 262, __pyx_L1_error)
+        __pyx_t_7 = __pyx_f_11moleculekit_16atomselect_utils__find_connected_atoms_in_resid(__pyx_v_i, __pyx_v_tmpid, __pyx_v_atom_bonds, __pyx_v_flgs, __pyx_v_resid, __pyx_v_chain_id, __pyx_v_seg_id, __pyx_v_polymer, (*((__pyx_t_11moleculekit_16atomselect_utils_INT64_t *) ( /* dim=0 */ (__pyx_v_resid.data + __pyx_t_5 * __pyx_v_resid.strides[0]) )))); if (unlikely(__pyx_t_7 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 234, __pyx_L1_error)
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":263
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":235
  *                 _clean_up_connection(i, tmpid, atom_bonds, flgs)
  *                 _find_connected_atoms_in_resid(i, tmpid, atom_bonds, flgs, resid, chain_id, seg_id, polymer, resid[i])
  *                 tmpid += 1             # <<<<<<<<<<<<<<
  *             else:
  *                 _clean_up_connection(i, tmpid, atom_bonds, flgs)
  */
         __pyx_v_tmpid = (__pyx_v_tmpid + 1);
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":260
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":232
  *     for i in range(n_atoms):
  *         if bb[i] and flgs[i] == 0:
  *             if _has_n_backbone(bb, resid, chain_id, seg_id, i, tmpid, flgs, atom_bonds, n, resid[i]):             # <<<<<<<<<<<<<<
  *                 _clean_up_connection(i, tmpid, atom_bonds, flgs)
  *                 _find_connected_atoms_in_resid(i, tmpid, atom_bonds, flgs, resid, chain_id, seg_id, polymer, resid[i])
  */
         goto __pyx_L8;
       }
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":265
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":237
  *                 tmpid += 1
  *             else:
  *                 _clean_up_connection(i, tmpid, atom_bonds, flgs)             # <<<<<<<<<<<<<<
  * 
  *     return True
  */
       /*else*/ {
-        __pyx_t_7 = __pyx_f_11moleculekit_16atomselect_utils__clean_up_connection(__pyx_v_i, __pyx_v_tmpid, __pyx_v_atom_bonds, __pyx_v_flgs); if (unlikely(__pyx_t_7 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 265, __pyx_L1_error)
+        __pyx_t_7 = __pyx_f_11moleculekit_16atomselect_utils__clean_up_connection(__pyx_v_i, __pyx_v_tmpid, __pyx_v_atom_bonds, __pyx_v_flgs); if (unlikely(__pyx_t_7 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 237, __pyx_L1_error)
       }
       __pyx_L8:;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":259
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":231
  * 
  *     for i in range(n_atoms):
  *         if bb[i] and flgs[i] == 0:             # <<<<<<<<<<<<<<
  *             if _has_n_backbone(bb, resid, chain_id, seg_id, i, tmpid, flgs, atom_bonds, n, resid[i]):
  *                 _clean_up_connection(i, tmpid, atom_bonds, flgs)
  */
     }
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":267
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":239
  *                 _clean_up_connection(i, tmpid, atom_bonds, flgs)
  * 
  *     return True             # <<<<<<<<<<<<<<
  * 
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  */
   __pyx_r = 1;
   goto __pyx_L0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":242
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":214
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _find_and_mark(             # <<<<<<<<<<<<<<
  *         int n,
  *         bool[:] bb,
  */
 
@@ -23126,58 +22598,58 @@
   __pyx_L1_error:;
   __Pyx_AddTraceback("moleculekit.atomselect_utils._find_and_mark", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "moleculekit/atomselect_utils/atomselect_utils.pyx":271
+/* "moleculekit/atomselect_utils/atomselect_utils.pyx":243
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _find_residues(             # <<<<<<<<<<<<<<
  *         int n_atoms,
  *         bool[:] protein,
  */
 
 static bool __pyx_f_11moleculekit_16atomselect_utils__find_residues(CYTHON_UNUSED int __pyx_v_n_atoms, __Pyx_memviewslice __pyx_v_protein, __Pyx_memviewslice __pyx_v_nucleic, __Pyx_memviewslice __pyx_v_protein_bb, __Pyx_memviewslice __pyx_v_nucleic_bb, __Pyx_memviewslice __pyx_v_resid, __Pyx_memviewslice __pyx_v_chain_id, __Pyx_memviewslice __pyx_v_seg_id, std::vector<std::vector<int> >  &__pyx_v_atom_bonds, __Pyx_memviewslice __pyx_v_flgs) {
   bool __pyx_r;
   bool __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":284
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":256
  *     ):
  *     # TODO: Replace with pure C: cdef UINT32_t[:] flgs = array_new[UINT32](n_atoms)
  *     _find_and_mark(4, protein_bb, protein, flgs, atom_bonds, resid, chain_id, seg_id)             # <<<<<<<<<<<<<<
  *     _find_and_mark(4, nucleic_bb, nucleic, flgs, atom_bonds, resid, chain_id, seg_id)
  *     return True
  */
-  __pyx_t_1 = __pyx_f_11moleculekit_16atomselect_utils__find_and_mark(4, __pyx_v_protein_bb, __pyx_v_protein, __pyx_v_flgs, __pyx_v_atom_bonds, __pyx_v_resid, __pyx_v_chain_id, __pyx_v_seg_id); if (unlikely(__pyx_t_1 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 284, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_11moleculekit_16atomselect_utils__find_and_mark(4, __pyx_v_protein_bb, __pyx_v_protein, __pyx_v_flgs, __pyx_v_atom_bonds, __pyx_v_resid, __pyx_v_chain_id, __pyx_v_seg_id); if (unlikely(__pyx_t_1 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 256, __pyx_L1_error)
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":285
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":257
  *     # TODO: Replace with pure C: cdef UINT32_t[:] flgs = array_new[UINT32](n_atoms)
  *     _find_and_mark(4, protein_bb, protein, flgs, atom_bonds, resid, chain_id, seg_id)
  *     _find_and_mark(4, nucleic_bb, nucleic, flgs, atom_bonds, resid, chain_id, seg_id)             # <<<<<<<<<<<<<<
  *     return True
  * 
  */
-  __pyx_t_1 = __pyx_f_11moleculekit_16atomselect_utils__find_and_mark(4, __pyx_v_nucleic_bb, __pyx_v_nucleic, __pyx_v_flgs, __pyx_v_atom_bonds, __pyx_v_resid, __pyx_v_chain_id, __pyx_v_seg_id); if (unlikely(__pyx_t_1 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 285, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_11moleculekit_16atomselect_utils__find_and_mark(4, __pyx_v_nucleic_bb, __pyx_v_nucleic, __pyx_v_flgs, __pyx_v_atom_bonds, __pyx_v_resid, __pyx_v_chain_id, __pyx_v_seg_id); if (unlikely(__pyx_t_1 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 257, __pyx_L1_error)
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":286
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":258
  *     _find_and_mark(4, protein_bb, protein, flgs, atom_bonds, resid, chain_id, seg_id)
  *     _find_and_mark(4, nucleic_bb, nucleic, flgs, atom_bonds, resid, chain_id, seg_id)
  *     return True             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = 1;
   goto __pyx_L0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":271
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":243
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _find_residues(             # <<<<<<<<<<<<<<
  *         int n_atoms,
  *         bool[:] protein,
  */
 
@@ -23185,15 +22657,15 @@
   __pyx_L1_error:;
   __Pyx_AddTraceback("moleculekit.atomselect_utils._find_residues", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "moleculekit/atomselect_utils/atomselect_utils.pyx":291
+/* "moleculekit/atomselect_utils/atomselect_utils.pyx":263
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _find_connected_fragments(             # <<<<<<<<<<<<<<
  *         int n_residues,
  *         int n_atoms,
  */
 
@@ -23219,140 +22691,140 @@
   int __pyx_t_11;
   Py_ssize_t __pyx_t_12;
   int __pyx_t_13;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":305
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":277
  *     cdef stack[int] st
  *     cdef int i, j, ba, ra, ri, count
  *     count = 0             # <<<<<<<<<<<<<<
  * 
  *     for i in range(n_residues):
  */
   __pyx_v_count = 0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":307
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":279
  *     count = 0
  * 
  *     for i in range(n_residues):             # <<<<<<<<<<<<<<
  *         if not res_flgs[i]:
  *             st.push(i)
  */
   __pyx_t_1 = __pyx_v_n_residues;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":308
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":280
  * 
  *     for i in range(n_residues):
  *         if not res_flgs[i]:             # <<<<<<<<<<<<<<
  *             st.push(i)
  * 
  */
     __pyx_t_4 = __pyx_v_i;
     __pyx_t_5 = (!((*((bool *) ( /* dim=0 */ (__pyx_v_res_flgs.data + __pyx_t_4 * __pyx_v_res_flgs.strides[0]) ))) != 0));
     if (__pyx_t_5) {
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":309
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":281
  *     for i in range(n_residues):
  *         if not res_flgs[i]:
  *             st.push(i)             # <<<<<<<<<<<<<<
  * 
  *             while not st.empty():
  */
       try {
         __pyx_v_st.push(__pyx_v_i);
       } catch(...) {
         __Pyx_CppExn2PyErr();
-        __PYX_ERR(0, 309, __pyx_L1_error)
+        __PYX_ERR(0, 281, __pyx_L1_error)
       }
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":311
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":283
  *             st.push(i)
  * 
  *             while not st.empty():             # <<<<<<<<<<<<<<
  *                 j = st.top()
  *                 st.pop()
  */
       while (1) {
         __pyx_t_5 = (!__pyx_v_st.empty());
         if (!__pyx_t_5) break;
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":312
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":284
  * 
  *             while not st.empty():
  *                 j = st.top()             # <<<<<<<<<<<<<<
  *                 st.pop()
  * 
  */
         __pyx_v_j = __pyx_v_st.top();
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":313
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":285
  *             while not st.empty():
  *                 j = st.top()
  *                 st.pop()             # <<<<<<<<<<<<<<
  * 
  *                 for ra in residue_atoms[j]:
  */
         __pyx_v_st.pop();
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":315
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":287
  *                 st.pop()
  * 
  *                 for ra in residue_atoms[j]:             # <<<<<<<<<<<<<<
  *                     fragments[ra] = count
  * 
  */
         __pyx_t_7 = &(__pyx_v_residue_atoms[__pyx_v_j]);
         __pyx_t_6 = __pyx_t_7->begin();
         for (;;) {
           if (!(__pyx_t_6 != __pyx_t_7->end())) break;
           __pyx_t_8 = *__pyx_t_6;
           ++__pyx_t_6;
           __pyx_v_ra = __pyx_t_8;
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":316
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":288
  * 
  *                 for ra in residue_atoms[j]:
  *                     fragments[ra] = count             # <<<<<<<<<<<<<<
  * 
  *                     for ba in atom_bonds[ra]:
  */
           __pyx_t_4 = __pyx_v_ra;
           *((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_fragments.data + __pyx_t_4 * __pyx_v_fragments.strides[0]) )) = __pyx_v_count;
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":318
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":290
  *                     fragments[ra] = count
  * 
  *                     for ba in atom_bonds[ra]:             # <<<<<<<<<<<<<<
  *                         ri = uq_resid[ba]
  * 
  */
           __pyx_t_10 = &(__pyx_v_atom_bonds[__pyx_v_ra]);
           __pyx_t_9 = __pyx_t_10->begin();
           for (;;) {
             if (!(__pyx_t_9 != __pyx_t_10->end())) break;
             __pyx_t_8 = *__pyx_t_9;
             ++__pyx_t_9;
             __pyx_v_ba = __pyx_t_8;
 
-            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":319
+            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":291
  * 
  *                     for ba in atom_bonds[ra]:
  *                         ri = uq_resid[ba]             # <<<<<<<<<<<<<<
  * 
  *                         if (ri != i and res_flgs[ri] == 0 and
  */
             __pyx_t_4 = __pyx_v_ba;
             __pyx_v_ri = (*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_uq_resid.data + __pyx_t_4 * __pyx_v_uq_resid.strides[0]) )));
 
-            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":321
+            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":293
  *                         ri = uq_resid[ba]
  * 
  *                         if (ri != i and res_flgs[ri] == 0 and             # <<<<<<<<<<<<<<
  *                             chain_id[ra] == chain_id[ba] and
  *                             seg_id[ra] == seg_id[ba] and
  */
             __pyx_t_11 = (__pyx_v_ri != __pyx_v_i);
@@ -23365,15 +22837,15 @@
             __pyx_t_11 = ((*((bool *) ( /* dim=0 */ (__pyx_v_res_flgs.data + __pyx_t_4 * __pyx_v_res_flgs.strides[0]) ))) == 0);
             if (__pyx_t_11) {
             } else {
               __pyx_t_5 = __pyx_t_11;
               goto __pyx_L13_bool_binop_done;
             }
 
-            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":322
+            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":294
  * 
  *                         if (ri != i and res_flgs[ri] == 0 and
  *                             chain_id[ra] == chain_id[ba] and             # <<<<<<<<<<<<<<
  *                             seg_id[ra] == seg_id[ba] and
  *                             not (strcmp(atomnames[ra].c_str(), "SG") == 0 and strcmp(atomnames[ba].c_str(), "SG") == 0)):
  */
             __pyx_t_4 = __pyx_v_ra;
@@ -23381,15 +22853,15 @@
             __pyx_t_11 = ((*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_chain_id.data + __pyx_t_4 * __pyx_v_chain_id.strides[0]) ))) == (*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_chain_id.data + __pyx_t_12 * __pyx_v_chain_id.strides[0]) ))));
             if (__pyx_t_11) {
             } else {
               __pyx_t_5 = __pyx_t_11;
               goto __pyx_L13_bool_binop_done;
             }
 
-            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":323
+            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":295
  *                         if (ri != i and res_flgs[ri] == 0 and
  *                             chain_id[ra] == chain_id[ba] and
  *                             seg_id[ra] == seg_id[ba] and             # <<<<<<<<<<<<<<
  *                             not (strcmp(atomnames[ra].c_str(), "SG") == 0 and strcmp(atomnames[ba].c_str(), "SG") == 0)):
  *                             res_flgs[ri] = True
  */
             __pyx_t_12 = __pyx_v_ra;
@@ -23397,15 +22869,15 @@
             __pyx_t_11 = ((*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_seg_id.data + __pyx_t_12 * __pyx_v_seg_id.strides[0]) ))) == (*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_seg_id.data + __pyx_t_4 * __pyx_v_seg_id.strides[0]) ))));
             if (__pyx_t_11) {
             } else {
               __pyx_t_5 = __pyx_t_11;
               goto __pyx_L13_bool_binop_done;
             }
 
-            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":324
+            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":296
  *                             chain_id[ra] == chain_id[ba] and
  *                             seg_id[ra] == seg_id[ba] and
  *                             not (strcmp(atomnames[ra].c_str(), "SG") == 0 and strcmp(atomnames[ba].c_str(), "SG") == 0)):             # <<<<<<<<<<<<<<
  *                             res_flgs[ri] = True
  *                             st.push(ri)
  */
             __pyx_t_13 = (strcmp((__pyx_v_atomnames[__pyx_v_ra]).c_str(), ((char const *)"SG")) == 0);
@@ -23417,105 +22889,105 @@
             __pyx_t_13 = (strcmp((__pyx_v_atomnames[__pyx_v_ba]).c_str(), ((char const *)"SG")) == 0);
             __pyx_t_11 = __pyx_t_13;
             __pyx_L18_bool_binop_done:;
             __pyx_t_13 = (!__pyx_t_11);
             __pyx_t_5 = __pyx_t_13;
             __pyx_L13_bool_binop_done:;
 
-            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":321
+            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":293
  *                         ri = uq_resid[ba]
  * 
  *                         if (ri != i and res_flgs[ri] == 0 and             # <<<<<<<<<<<<<<
  *                             chain_id[ra] == chain_id[ba] and
  *                             seg_id[ra] == seg_id[ba] and
  */
             if (__pyx_t_5) {
 
-              /* "moleculekit/atomselect_utils/atomselect_utils.pyx":325
+              /* "moleculekit/atomselect_utils/atomselect_utils.pyx":297
  *                             seg_id[ra] == seg_id[ba] and
  *                             not (strcmp(atomnames[ra].c_str(), "SG") == 0 and strcmp(atomnames[ba].c_str(), "SG") == 0)):
  *                             res_flgs[ri] = True             # <<<<<<<<<<<<<<
  *                             st.push(ri)
  *             count += 1
  */
               __pyx_t_4 = __pyx_v_ri;
               *((bool *) ( /* dim=0 */ (__pyx_v_res_flgs.data + __pyx_t_4 * __pyx_v_res_flgs.strides[0]) )) = 1;
 
-              /* "moleculekit/atomselect_utils/atomselect_utils.pyx":326
+              /* "moleculekit/atomselect_utils/atomselect_utils.pyx":298
  *                             not (strcmp(atomnames[ra].c_str(), "SG") == 0 and strcmp(atomnames[ba].c_str(), "SG") == 0)):
  *                             res_flgs[ri] = True
  *                             st.push(ri)             # <<<<<<<<<<<<<<
  *             count += 1
  *     return True
  */
               try {
                 __pyx_v_st.push(__pyx_v_ri);
               } catch(...) {
                 __Pyx_CppExn2PyErr();
-                __PYX_ERR(0, 326, __pyx_L1_error)
+                __PYX_ERR(0, 298, __pyx_L1_error)
               }
 
-              /* "moleculekit/atomselect_utils/atomselect_utils.pyx":321
+              /* "moleculekit/atomselect_utils/atomselect_utils.pyx":293
  *                         ri = uq_resid[ba]
  * 
  *                         if (ri != i and res_flgs[ri] == 0 and             # <<<<<<<<<<<<<<
  *                             chain_id[ra] == chain_id[ba] and
  *                             seg_id[ra] == seg_id[ba] and
  */
             }
 
-            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":318
+            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":290
  *                     fragments[ra] = count
  * 
  *                     for ba in atom_bonds[ra]:             # <<<<<<<<<<<<<<
  *                         ri = uq_resid[ba]
  * 
  */
           }
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":315
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":287
  *                 st.pop()
  * 
  *                 for ra in residue_atoms[j]:             # <<<<<<<<<<<<<<
  *                     fragments[ra] = count
  * 
  */
         }
       }
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":327
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":299
  *                             res_flgs[ri] = True
  *                             st.push(ri)
  *             count += 1             # <<<<<<<<<<<<<<
  *     return True
  * 
  */
       __pyx_v_count = (__pyx_v_count + 1);
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":308
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":280
  * 
  *     for i in range(n_residues):
  *         if not res_flgs[i]:             # <<<<<<<<<<<<<<
  *             st.push(i)
  * 
  */
     }
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":328
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":300
  *                             st.push(ri)
  *             count += 1
  *     return True             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = 1;
   goto __pyx_L0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":291
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":263
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _find_connected_fragments(             # <<<<<<<<<<<<<<
  *         int n_residues,
  *         int n_atoms,
  */
 
@@ -23523,15 +22995,15 @@
   __pyx_L1_error:;
   __Pyx_AddTraceback("moleculekit.atomselect_utils._find_connected_fragments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "moleculekit/atomselect_utils/atomselect_utils.pyx":333
+/* "moleculekit/atomselect_utils/atomselect_utils.pyx":305
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _find_connected_subfragment(             # <<<<<<<<<<<<<<
  *         int resnum,
  *         int fragnum,
  */
 
@@ -23549,15 +23021,15 @@
   std::vector<int>  *__pyx_t_8;
   size_t __pyx_t_9;
   bool __pyx_t_10;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":350
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":322
  *     cdef int ra, ba
  * 
  *     if res_flgs[resnum] or not polymer[residue_atoms[resnum][0]]:             # <<<<<<<<<<<<<<
  *         return False
  * 
  */
   __pyx_t_2 = __pyx_v_resnum;
@@ -23569,154 +23041,154 @@
   }
   __pyx_t_2 = ((__pyx_v_residue_atoms[__pyx_v_resnum])[0]);
   __pyx_t_3 = (!((*((bool *) ( /* dim=0 */ (__pyx_v_polymer.data + __pyx_t_2 * __pyx_v_polymer.strides[0]) ))) != 0));
   __pyx_t_1 = __pyx_t_3;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":351
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":323
  * 
  *     if res_flgs[resnum] or not polymer[residue_atoms[resnum][0]]:
  *         return False             # <<<<<<<<<<<<<<
  * 
  *     pfragList[fragnum].push_back(resnum) # Add residue to protein fragment list
  */
     __pyx_r = 0;
     goto __pyx_L0;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":350
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":322
  *     cdef int ra, ba
  * 
  *     if res_flgs[resnum] or not polymer[residue_atoms[resnum][0]]:             # <<<<<<<<<<<<<<
  *         return False
  * 
  */
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":353
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":325
  *         return False
  * 
  *     pfragList[fragnum].push_back(resnum) # Add residue to protein fragment list             # <<<<<<<<<<<<<<
  *     res_flgs[resnum] = True # Avoid repeats
  * 
  */
   try {
     (__pyx_v_pfragList[__pyx_v_fragnum]).push_back(__pyx_v_resnum);
   } catch(...) {
     __Pyx_CppExn2PyErr();
-    __PYX_ERR(0, 353, __pyx_L1_error)
+    __PYX_ERR(0, 325, __pyx_L1_error)
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":354
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":326
  * 
  *     pfragList[fragnum].push_back(resnum) # Add residue to protein fragment list
  *     res_flgs[resnum] = True # Avoid repeats             # <<<<<<<<<<<<<<
  * 
  *     for ra in residue_atoms[resnum]:
  */
   __pyx_t_2 = __pyx_v_resnum;
   *((bool *) ( /* dim=0 */ (__pyx_v_res_flgs.data + __pyx_t_2 * __pyx_v_res_flgs.strides[0]) )) = 1;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":356
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":328
  *     res_flgs[resnum] = True # Avoid repeats
  * 
  *     for ra in residue_atoms[resnum]:             # <<<<<<<<<<<<<<
  *         if (strcmp(atomnames[ra].c_str(), endatom) != 0 and
  *             strcmp(atomnames[ra].c_str(), altendatom) != 0 and
  */
   __pyx_t_5 = &(__pyx_v_residue_atoms[__pyx_v_resnum]);
   __pyx_t_4 = __pyx_t_5->begin();
   for (;;) {
     if (!(__pyx_t_4 != __pyx_t_5->end())) break;
     __pyx_t_6 = *__pyx_t_4;
     ++__pyx_t_4;
     __pyx_v_ra = __pyx_t_6;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":357
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":329
  * 
  *     for ra in residue_atoms[resnum]:
  *         if (strcmp(atomnames[ra].c_str(), endatom) != 0 and             # <<<<<<<<<<<<<<
  *             strcmp(atomnames[ra].c_str(), altendatom) != 0 and
  *             strcmp(atomnames[ra].c_str(), alt2endatom) != 0):
  */
     __pyx_t_3 = (strcmp((__pyx_v_atomnames[__pyx_v_ra]).c_str(), __pyx_v_endatom) != 0);
     if (__pyx_t_3) {
     } else {
       __pyx_t_1 = __pyx_t_3;
       goto __pyx_L9_bool_binop_done;
     }
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":358
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":330
  *     for ra in residue_atoms[resnum]:
  *         if (strcmp(atomnames[ra].c_str(), endatom) != 0 and
  *             strcmp(atomnames[ra].c_str(), altendatom) != 0 and             # <<<<<<<<<<<<<<
  *             strcmp(atomnames[ra].c_str(), alt2endatom) != 0):
  *             continue
  */
     __pyx_t_3 = (strcmp((__pyx_v_atomnames[__pyx_v_ra]).c_str(), __pyx_v_altendatom) != 0);
     if (__pyx_t_3) {
     } else {
       __pyx_t_1 = __pyx_t_3;
       goto __pyx_L9_bool_binop_done;
     }
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":359
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":331
  *         if (strcmp(atomnames[ra].c_str(), endatom) != 0 and
  *             strcmp(atomnames[ra].c_str(), altendatom) != 0 and
  *             strcmp(atomnames[ra].c_str(), alt2endatom) != 0):             # <<<<<<<<<<<<<<
  *             continue
  * 
  */
     __pyx_t_3 = (strcmp((__pyx_v_atomnames[__pyx_v_ra]).c_str(), __pyx_v_alt2endatom) != 0);
     __pyx_t_1 = __pyx_t_3;
     __pyx_L9_bool_binop_done:;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":357
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":329
  * 
  *     for ra in residue_atoms[resnum]:
  *         if (strcmp(atomnames[ra].c_str(), endatom) != 0 and             # <<<<<<<<<<<<<<
  *             strcmp(atomnames[ra].c_str(), altendatom) != 0 and
  *             strcmp(atomnames[ra].c_str(), alt2endatom) != 0):
  */
     if (__pyx_t_1) {
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":360
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":332
  *             strcmp(atomnames[ra].c_str(), altendatom) != 0 and
  *             strcmp(atomnames[ra].c_str(), alt2endatom) != 0):
  *             continue             # <<<<<<<<<<<<<<
  * 
  *         for ba in atom_bonds[ra]: # Look at the bonds
  */
       goto __pyx_L6_continue;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":357
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":329
  * 
  *     for ra in residue_atoms[resnum]:
  *         if (strcmp(atomnames[ra].c_str(), endatom) != 0 and             # <<<<<<<<<<<<<<
  *             strcmp(atomnames[ra].c_str(), altendatom) != 0 and
  *             strcmp(atomnames[ra].c_str(), alt2endatom) != 0):
  */
     }
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":362
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":334
  *             continue
  * 
  *         for ba in atom_bonds[ra]: # Look at the bonds             # <<<<<<<<<<<<<<
  *             if (backbone[ra] or backbone[ba]) and uq_resid[ba] != resnum and not res_flgs[uq_resid[ba]]:
  *                 _find_connected_subfragment(uq_resid[ba], fragnum, endatom, altendatom, alt2endatom, res_flgs, polymer, backbone, atomnames, uq_resid, residue_atoms, atom_bonds, pfragList)
  */
     __pyx_t_8 = &(__pyx_v_atom_bonds[__pyx_v_ra]);
     __pyx_t_7 = __pyx_t_8->begin();
     for (;;) {
       if (!(__pyx_t_7 != __pyx_t_8->end())) break;
       __pyx_t_6 = *__pyx_t_7;
       ++__pyx_t_7;
       __pyx_v_ba = __pyx_t_6;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":363
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":335
  * 
  *         for ba in atom_bonds[ra]: # Look at the bonds
  *             if (backbone[ra] or backbone[ba]) and uq_resid[ba] != resnum and not res_flgs[uq_resid[ba]]:             # <<<<<<<<<<<<<<
  *                 _find_connected_subfragment(uq_resid[ba], fragnum, endatom, altendatom, alt2endatom, res_flgs, polymer, backbone, atomnames, uq_resid, residue_atoms, atom_bonds, pfragList)
  *                 return True # Only find one, assume no branching
  */
       __pyx_t_2 = __pyx_v_ra;
@@ -23743,73 +23215,73 @@
       __pyx_t_2 = __pyx_v_ba;
       __pyx_t_9 = (*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_uq_resid.data + __pyx_t_2 * __pyx_v_uq_resid.strides[0]) )));
       __pyx_t_3 = (!((*((bool *) ( /* dim=0 */ (__pyx_v_res_flgs.data + __pyx_t_9 * __pyx_v_res_flgs.strides[0]) ))) != 0));
       __pyx_t_1 = __pyx_t_3;
       __pyx_L15_bool_binop_done:;
       if (__pyx_t_1) {
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":364
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":336
  *         for ba in atom_bonds[ra]: # Look at the bonds
  *             if (backbone[ra] or backbone[ba]) and uq_resid[ba] != resnum and not res_flgs[uq_resid[ba]]:
  *                 _find_connected_subfragment(uq_resid[ba], fragnum, endatom, altendatom, alt2endatom, res_flgs, polymer, backbone, atomnames, uq_resid, residue_atoms, atom_bonds, pfragList)             # <<<<<<<<<<<<<<
  *                 return True # Only find one, assume no branching
  *     return True
  */
         __pyx_t_2 = __pyx_v_ba;
-        __pyx_t_10 = __pyx_f_11moleculekit_16atomselect_utils__find_connected_subfragment((*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_uq_resid.data + __pyx_t_2 * __pyx_v_uq_resid.strides[0]) ))), __pyx_v_fragnum, __pyx_v_endatom, __pyx_v_altendatom, __pyx_v_alt2endatom, __pyx_v_res_flgs, __pyx_v_polymer, __pyx_v_backbone, __pyx_v_atomnames, __pyx_v_uq_resid, __pyx_v_residue_atoms, __pyx_v_atom_bonds, __pyx_v_pfragList); if (unlikely(__pyx_t_10 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 364, __pyx_L1_error)
+        __pyx_t_10 = __pyx_f_11moleculekit_16atomselect_utils__find_connected_subfragment((*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_uq_resid.data + __pyx_t_2 * __pyx_v_uq_resid.strides[0]) ))), __pyx_v_fragnum, __pyx_v_endatom, __pyx_v_altendatom, __pyx_v_alt2endatom, __pyx_v_res_flgs, __pyx_v_polymer, __pyx_v_backbone, __pyx_v_atomnames, __pyx_v_uq_resid, __pyx_v_residue_atoms, __pyx_v_atom_bonds, __pyx_v_pfragList); if (unlikely(__pyx_t_10 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 336, __pyx_L1_error)
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":365
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":337
  *             if (backbone[ra] or backbone[ba]) and uq_resid[ba] != resnum and not res_flgs[uq_resid[ba]]:
  *                 _find_connected_subfragment(uq_resid[ba], fragnum, endatom, altendatom, alt2endatom, res_flgs, polymer, backbone, atomnames, uq_resid, residue_atoms, atom_bonds, pfragList)
  *                 return True # Only find one, assume no branching             # <<<<<<<<<<<<<<
  *     return True
  * 
  */
         __pyx_r = 1;
         goto __pyx_L0;
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":363
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":335
  * 
  *         for ba in atom_bonds[ra]: # Look at the bonds
  *             if (backbone[ra] or backbone[ba]) and uq_resid[ba] != resnum and not res_flgs[uq_resid[ba]]:             # <<<<<<<<<<<<<<
  *                 _find_connected_subfragment(uq_resid[ba], fragnum, endatom, altendatom, alt2endatom, res_flgs, polymer, backbone, atomnames, uq_resid, residue_atoms, atom_bonds, pfragList)
  *                 return True # Only find one, assume no branching
  */
       }
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":362
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":334
  *             continue
  * 
  *         for ba in atom_bonds[ra]: # Look at the bonds             # <<<<<<<<<<<<<<
  *             if (backbone[ra] or backbone[ba]) and uq_resid[ba] != resnum and not res_flgs[uq_resid[ba]]:
  *                 _find_connected_subfragment(uq_resid[ba], fragnum, endatom, altendatom, alt2endatom, res_flgs, polymer, backbone, atomnames, uq_resid, residue_atoms, atom_bonds, pfragList)
  */
     }
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":356
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":328
  *     res_flgs[resnum] = True # Avoid repeats
  * 
  *     for ra in residue_atoms[resnum]:             # <<<<<<<<<<<<<<
  *         if (strcmp(atomnames[ra].c_str(), endatom) != 0 and
  *             strcmp(atomnames[ra].c_str(), altendatom) != 0 and
  */
     __pyx_L6_continue:;
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":366
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":338
  *                 _find_connected_subfragment(uq_resid[ba], fragnum, endatom, altendatom, alt2endatom, res_flgs, polymer, backbone, atomnames, uq_resid, residue_atoms, atom_bonds, pfragList)
  *                 return True # Only find one, assume no branching
  *     return True             # <<<<<<<<<<<<<<
  * 
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  */
   __pyx_r = 1;
   goto __pyx_L0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":333
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":305
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _find_connected_subfragment(             # <<<<<<<<<<<<<<
  *         int resnum,
  *         int fragnum,
  */
 
@@ -23817,15 +23289,15 @@
   __pyx_L1_error:;
   __Pyx_AddTraceback("moleculekit.atomselect_utils._find_connected_subfragment", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "moleculekit/atomselect_utils/atomselect_utils.pyx":370
+/* "moleculekit/atomselect_utils/atomselect_utils.pyx":342
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _find_subfragments(             # <<<<<<<<<<<<<<
  *         int n_residues,
  *         vector[vector[int]] &residue_atoms,
  */
 
@@ -23848,36 +23320,36 @@
   std::vector<int>  *__pyx_t_11;
   std::vector<int>  __pyx_t_12;
   bool __pyx_t_13;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":381
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":353
  *         vector[vector[int]] &pfragList,
  *     ):
  *     cdef bool off_res_bonds = False             # <<<<<<<<<<<<<<
  * 
  *     for i in range(n_residues):
  */
   __pyx_v_off_res_bonds = 0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":383
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":355
  *     cdef bool off_res_bonds = False
  * 
  *     for i in range(n_residues):             # <<<<<<<<<<<<<<
  *         if res_flgs[i] or not protein[residue_atoms[i][0]]: # Has been seen before or isn't protein
  *             continue
  */
   __pyx_t_1 = __pyx_v_n_residues;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":384
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":356
  * 
  *     for i in range(n_residues):
  *         if res_flgs[i] or not protein[residue_atoms[i][0]]: # Has been seen before or isn't protein             # <<<<<<<<<<<<<<
  *             continue
  * 
  */
     __pyx_t_5 = __pyx_v_i;
@@ -23889,100 +23361,100 @@
     }
     __pyx_t_5 = ((__pyx_v_residue_atoms[__pyx_v_i])[0]);
     __pyx_t_6 = (!((*((bool *) ( /* dim=0 */ (__pyx_v_protein.data + __pyx_t_5 * __pyx_v_protein.strides[0]) ))) != 0));
     __pyx_t_4 = __pyx_t_6;
     __pyx_L6_bool_binop_done:;
     if (__pyx_t_4) {
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":385
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":357
  *     for i in range(n_residues):
  *         if res_flgs[i] or not protein[residue_atoms[i][0]]: # Has been seen before or isn't protein
  *             continue             # <<<<<<<<<<<<<<
  * 
  *         for ra in residue_atoms[i]:  # Does the residue have a matching starting atom?
  */
       goto __pyx_L3_continue;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":384
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":356
  * 
  *     for i in range(n_residues):
  *         if res_flgs[i] or not protein[residue_atoms[i][0]]: # Has been seen before or isn't protein             # <<<<<<<<<<<<<<
  *             continue
  * 
  */
     }
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":387
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":359
  *             continue
  * 
  *         for ra in residue_atoms[i]:  # Does the residue have a matching starting atom?             # <<<<<<<<<<<<<<
  *             if strcmp(atomnames[ra].c_str(), "N") != 0:
  *                 continue
  */
     __pyx_t_8 = &(__pyx_v_residue_atoms[__pyx_v_i]);
     __pyx_t_7 = __pyx_t_8->begin();
     for (;;) {
       if (!(__pyx_t_7 != __pyx_t_8->end())) break;
       __pyx_t_9 = *__pyx_t_7;
       ++__pyx_t_7;
       __pyx_v_ra = __pyx_t_9;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":388
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":360
  * 
  *         for ra in residue_atoms[i]:  # Does the residue have a matching starting atom?
  *             if strcmp(atomnames[ra].c_str(), "N") != 0:             # <<<<<<<<<<<<<<
  *                 continue
  * 
  */
       __pyx_t_4 = (strcmp((__pyx_v_atomnames[__pyx_v_ra]).c_str(), ((char const *)"N")) != 0);
       if (__pyx_t_4) {
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":389
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":361
  *         for ra in residue_atoms[i]:  # Does the residue have a matching starting atom?
  *             if strcmp(atomnames[ra].c_str(), "N") != 0:
  *                 continue             # <<<<<<<<<<<<<<
  * 
  *             off_res_bonds = False
  */
         goto __pyx_L8_continue;
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":388
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":360
  * 
  *         for ra in residue_atoms[i]:  # Does the residue have a matching starting atom?
  *             if strcmp(atomnames[ra].c_str(), "N") != 0:             # <<<<<<<<<<<<<<
  *                 continue
  * 
  */
       }
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":391
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":363
  *                 continue
  * 
  *             off_res_bonds = False             # <<<<<<<<<<<<<<
  *             for ba in atom_bonds[ra]:
  *                 if uq_resid[ba] != i and protein[ba]: # Are there off-residue bonds to protein?
  */
       __pyx_v_off_res_bonds = 0;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":392
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":364
  * 
  *             off_res_bonds = False
  *             for ba in atom_bonds[ra]:             # <<<<<<<<<<<<<<
  *                 if uq_resid[ba] != i and protein[ba]: # Are there off-residue bonds to protein?
  *                     off_res_bonds = True
  */
       __pyx_t_11 = &(__pyx_v_atom_bonds[__pyx_v_ra]);
       __pyx_t_10 = __pyx_t_11->begin();
       for (;;) {
         if (!(__pyx_t_10 != __pyx_t_11->end())) break;
         __pyx_t_9 = *__pyx_t_10;
         ++__pyx_t_10;
         __pyx_v_ba = __pyx_t_9;
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":393
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":365
  *             off_res_bonds = False
  *             for ba in atom_bonds[ra]:
  *                 if uq_resid[ba] != i and protein[ba]: # Are there off-residue bonds to protein?             # <<<<<<<<<<<<<<
  *                     off_res_bonds = True
  *                     break
  */
         __pyx_t_5 = __pyx_v_ba;
@@ -23994,115 +23466,115 @@
         }
         __pyx_t_5 = __pyx_v_ba;
         __pyx_t_6 = ((*((bool *) ( /* dim=0 */ (__pyx_v_protein.data + __pyx_t_5 * __pyx_v_protein.strides[0]) ))) != 0);
         __pyx_t_4 = __pyx_t_6;
         __pyx_L14_bool_binop_done:;
         if (__pyx_t_4) {
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":394
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":366
  *             for ba in atom_bonds[ra]:
  *                 if uq_resid[ba] != i and protein[ba]: # Are there off-residue bonds to protein?
  *                     off_res_bonds = True             # <<<<<<<<<<<<<<
  *                     break
  * 
  */
           __pyx_v_off_res_bonds = 1;
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":395
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":367
  *                 if uq_resid[ba] != i and protein[ba]: # Are there off-residue bonds to protein?
  *                     off_res_bonds = True
  *                     break             # <<<<<<<<<<<<<<
  * 
  *             if not off_res_bonds:
  */
           goto __pyx_L12_break;
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":393
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":365
  *             off_res_bonds = False
  *             for ba in atom_bonds[ra]:
  *                 if uq_resid[ba] != i and protein[ba]: # Are there off-residue bonds to protein?             # <<<<<<<<<<<<<<
  *                     off_res_bonds = True
  *                     break
  */
         }
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":392
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":364
  * 
  *             off_res_bonds = False
  *             for ba in atom_bonds[ra]:             # <<<<<<<<<<<<<<
  *                 if uq_resid[ba] != i and protein[ba]: # Are there off-residue bonds to protein?
  *                     off_res_bonds = True
  */
       }
       goto __pyx_L16_for_end;
       __pyx_L12_break:;
       goto __pyx_L16_for_end;
       __pyx_L16_for_end:;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":397
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":369
  *                     break
  * 
  *             if not off_res_bonds:             # <<<<<<<<<<<<<<
  *                 pfragList.push_back(vector[int]())
  *                 _find_connected_subfragment(i, pfragList.size() - 1, "C", "", "", res_flgs, protein, protein_bb, atomnames, uq_resid, residue_atoms, atom_bonds, pfragList)
  */
       __pyx_t_4 = (!(__pyx_v_off_res_bonds != 0));
       if (__pyx_t_4) {
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":398
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":370
  * 
  *             if not off_res_bonds:
  *                 pfragList.push_back(vector[int]())             # <<<<<<<<<<<<<<
  *                 _find_connected_subfragment(i, pfragList.size() - 1, "C", "", "", res_flgs, protein, protein_bb, atomnames, uq_resid, residue_atoms, atom_bonds, pfragList)
  * 
  */
         try {
           __pyx_t_12 = std::vector<int> ();
         } catch(...) {
           __Pyx_CppExn2PyErr();
-          __PYX_ERR(0, 398, __pyx_L1_error)
+          __PYX_ERR(0, 370, __pyx_L1_error)
         }
         try {
           __pyx_v_pfragList.push_back(__pyx_t_12);
         } catch(...) {
           __Pyx_CppExn2PyErr();
-          __PYX_ERR(0, 398, __pyx_L1_error)
+          __PYX_ERR(0, 370, __pyx_L1_error)
         }
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":399
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":371
  *             if not off_res_bonds:
  *                 pfragList.push_back(vector[int]())
  *                 _find_connected_subfragment(i, pfragList.size() - 1, "C", "", "", res_flgs, protein, protein_bb, atomnames, uq_resid, residue_atoms, atom_bonds, pfragList)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-        __pyx_t_13 = __pyx_f_11moleculekit_16atomselect_utils__find_connected_subfragment(__pyx_v_i, (__pyx_v_pfragList.size() - 1), ((char const *)"C"), ((char const *)""), ((char const *)""), __pyx_v_res_flgs, __pyx_v_protein, __pyx_v_protein_bb, __pyx_v_atomnames, __pyx_v_uq_resid, __pyx_v_residue_atoms, __pyx_v_atom_bonds, __pyx_v_pfragList); if (unlikely(__pyx_t_13 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 399, __pyx_L1_error)
+        __pyx_t_13 = __pyx_f_11moleculekit_16atomselect_utils__find_connected_subfragment(__pyx_v_i, (__pyx_v_pfragList.size() - 1), ((char const *)"C"), ((char const *)""), ((char const *)""), __pyx_v_res_flgs, __pyx_v_protein, __pyx_v_protein_bb, __pyx_v_atomnames, __pyx_v_uq_resid, __pyx_v_residue_atoms, __pyx_v_atom_bonds, __pyx_v_pfragList); if (unlikely(__pyx_t_13 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 371, __pyx_L1_error)
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":397
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":369
  *                     break
  * 
  *             if not off_res_bonds:             # <<<<<<<<<<<<<<
  *                 pfragList.push_back(vector[int]())
  *                 _find_connected_subfragment(i, pfragList.size() - 1, "C", "", "", res_flgs, protein, protein_bb, atomnames, uq_resid, residue_atoms, atom_bonds, pfragList)
  */
       }
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":387
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":359
  *             continue
  * 
  *         for ra in residue_atoms[i]:  # Does the residue have a matching starting atom?             # <<<<<<<<<<<<<<
  *             if strcmp(atomnames[ra].c_str(), "N") != 0:
  *                 continue
  */
       __pyx_L8_continue:;
     }
     __pyx_L3_continue:;
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":370
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":342
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _find_subfragments(             # <<<<<<<<<<<<<<
  *         int n_residues,
  *         vector[vector[int]] &residue_atoms,
  */
 
@@ -24112,15 +23584,15 @@
   __pyx_L1_error:;
   __Pyx_AddTraceback("moleculekit.atomselect_utils._find_subfragments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "moleculekit/atomselect_utils/atomselect_utils.pyx":404
+/* "moleculekit/atomselect_utils/atomselect_utils.pyx":376
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _find_subfragments_topologically(             # <<<<<<<<<<<<<<
  *         int n_residues,
  *         vector[vector[int]] &residue_atoms,
  */
 
@@ -24143,36 +23615,36 @@
   std::vector<int>  *__pyx_t_11;
   std::vector<int>  __pyx_t_12;
   bool __pyx_t_13;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":415
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":387
  *         vector[vector[int]] &nfragList,
  *     ):
  *     cdef int offresbondcount = 0             # <<<<<<<<<<<<<<
  * 
  *     for i in range(n_residues):
  */
   __pyx_v_offresbondcount = 0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":417
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":389
  *     cdef int offresbondcount = 0
  * 
  *     for i in range(n_residues):             # <<<<<<<<<<<<<<
  *         if res_flgs[i] or not nucleic[residue_atoms[i][0]]: # Has been seen before or isn't nucleic
  *             continue
  */
   __pyx_t_1 = __pyx_v_n_residues;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":418
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":390
  * 
  *     for i in range(n_residues):
  *         if res_flgs[i] or not nucleic[residue_atoms[i][0]]: # Has been seen before or isn't nucleic             # <<<<<<<<<<<<<<
  *             continue
  * 
  */
     __pyx_t_5 = __pyx_v_i;
@@ -24184,72 +23656,72 @@
     }
     __pyx_t_5 = ((__pyx_v_residue_atoms[__pyx_v_i])[0]);
     __pyx_t_6 = (!((*((bool *) ( /* dim=0 */ (__pyx_v_nucleic.data + __pyx_t_5 * __pyx_v_nucleic.strides[0]) ))) != 0));
     __pyx_t_4 = __pyx_t_6;
     __pyx_L6_bool_binop_done:;
     if (__pyx_t_4) {
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":419
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":391
  *     for i in range(n_residues):
  *         if res_flgs[i] or not nucleic[residue_atoms[i][0]]: # Has been seen before or isn't nucleic
  *             continue             # <<<<<<<<<<<<<<
  * 
  *         for ra in residue_atoms[i]:  # Does the residue have a matching starting atom?
  */
       goto __pyx_L3_continue;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":418
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":390
  * 
  *     for i in range(n_residues):
  *         if res_flgs[i] or not nucleic[residue_atoms[i][0]]: # Has been seen before or isn't nucleic             # <<<<<<<<<<<<<<
  *             continue
  * 
  */
     }
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":421
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":393
  *             continue
  * 
  *         for ra in residue_atoms[i]:  # Does the residue have a matching starting atom?             # <<<<<<<<<<<<<<
  *             offresbondcount = 0
  *             for ba in atom_bonds[ra]:
  */
     __pyx_t_8 = &(__pyx_v_residue_atoms[__pyx_v_i]);
     __pyx_t_7 = __pyx_t_8->begin();
     for (;;) {
       if (!(__pyx_t_7 != __pyx_t_8->end())) break;
       __pyx_t_9 = *__pyx_t_7;
       ++__pyx_t_7;
       __pyx_v_ra = __pyx_t_9;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":422
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":394
  * 
  *         for ra in residue_atoms[i]:  # Does the residue have a matching starting atom?
  *             offresbondcount = 0             # <<<<<<<<<<<<<<
  *             for ba in atom_bonds[ra]:
  *                 if uq_resid[ba] != i and nucleic[ba]: # Are there off-residue bonds to protein?
  */
       __pyx_v_offresbondcount = 0;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":423
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":395
  *         for ra in residue_atoms[i]:  # Does the residue have a matching starting atom?
  *             offresbondcount = 0
  *             for ba in atom_bonds[ra]:             # <<<<<<<<<<<<<<
  *                 if uq_resid[ba] != i and nucleic[ba]: # Are there off-residue bonds to protein?
  *                     offresbondcount +=1
  */
       __pyx_t_11 = &(__pyx_v_atom_bonds[__pyx_v_ra]);
       __pyx_t_10 = __pyx_t_11->begin();
       for (;;) {
         if (!(__pyx_t_10 != __pyx_t_11->end())) break;
         __pyx_t_9 = *__pyx_t_10;
         ++__pyx_t_10;
         __pyx_v_ba = __pyx_t_9;
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":424
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":396
  *             offresbondcount = 0
  *             for ba in atom_bonds[ra]:
  *                 if uq_resid[ba] != i and nucleic[ba]: # Are there off-residue bonds to protein?             # <<<<<<<<<<<<<<
  *                     offresbondcount +=1
  * 
  */
         __pyx_t_5 = __pyx_v_ba;
@@ -24261,101 +23733,101 @@
         }
         __pyx_t_5 = __pyx_v_ba;
         __pyx_t_6 = ((*((bool *) ( /* dim=0 */ (__pyx_v_nucleic.data + __pyx_t_5 * __pyx_v_nucleic.strides[0]) ))) != 0);
         __pyx_t_4 = __pyx_t_6;
         __pyx_L13_bool_binop_done:;
         if (__pyx_t_4) {
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":425
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":397
  *             for ba in atom_bonds[ra]:
  *                 if uq_resid[ba] != i and nucleic[ba]: # Are there off-residue bonds to protein?
  *                     offresbondcount +=1             # <<<<<<<<<<<<<<
  * 
  *             if offresbondcount == 1: # Valid fragment start atom. Find residues downchain
  */
           __pyx_v_offresbondcount = (__pyx_v_offresbondcount + 1);
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":424
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":396
  *             offresbondcount = 0
  *             for ba in atom_bonds[ra]:
  *                 if uq_resid[ba] != i and nucleic[ba]: # Are there off-residue bonds to protein?             # <<<<<<<<<<<<<<
  *                     offresbondcount +=1
  * 
  */
         }
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":423
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":395
  *         for ra in residue_atoms[i]:  # Does the residue have a matching starting atom?
  *             offresbondcount = 0
  *             for ba in atom_bonds[ra]:             # <<<<<<<<<<<<<<
  *                 if uq_resid[ba] != i and nucleic[ba]: # Are there off-residue bonds to protein?
  *                     offresbondcount +=1
  */
       }
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":427
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":399
  *                     offresbondcount +=1
  * 
  *             if offresbondcount == 1: # Valid fragment start atom. Find residues downchain             # <<<<<<<<<<<<<<
  *                 nfragList.push_back(vector[int]())
  *                 _find_connected_subfragment(i, nfragList.size() - 1, "O3'", "O3*", "H3T", res_flgs, nucleic, nucleic_bb, atomnames, uq_resid, residue_atoms, atom_bonds, nfragList)
  */
       __pyx_t_4 = (__pyx_v_offresbondcount == 1);
       if (__pyx_t_4) {
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":428
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":400
  * 
  *             if offresbondcount == 1: # Valid fragment start atom. Find residues downchain
  *                 nfragList.push_back(vector[int]())             # <<<<<<<<<<<<<<
  *                 _find_connected_subfragment(i, nfragList.size() - 1, "O3'", "O3*", "H3T", res_flgs, nucleic, nucleic_bb, atomnames, uq_resid, residue_atoms, atom_bonds, nfragList)
  * 
  */
         try {
           __pyx_t_12 = std::vector<int> ();
         } catch(...) {
           __Pyx_CppExn2PyErr();
-          __PYX_ERR(0, 428, __pyx_L1_error)
+          __PYX_ERR(0, 400, __pyx_L1_error)
         }
         try {
           __pyx_v_nfragList.push_back(__pyx_t_12);
         } catch(...) {
           __Pyx_CppExn2PyErr();
-          __PYX_ERR(0, 428, __pyx_L1_error)
+          __PYX_ERR(0, 400, __pyx_L1_error)
         }
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":429
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":401
  *             if offresbondcount == 1: # Valid fragment start atom. Find residues downchain
  *                 nfragList.push_back(vector[int]())
  *                 _find_connected_subfragment(i, nfragList.size() - 1, "O3'", "O3*", "H3T", res_flgs, nucleic, nucleic_bb, atomnames, uq_resid, residue_atoms, atom_bonds, nfragList)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-        __pyx_t_13 = __pyx_f_11moleculekit_16atomselect_utils__find_connected_subfragment(__pyx_v_i, (__pyx_v_nfragList.size() - 1), ((char const *)"O3'"), ((char const *)"O3*"), ((char const *)"H3T"), __pyx_v_res_flgs, __pyx_v_nucleic, __pyx_v_nucleic_bb, __pyx_v_atomnames, __pyx_v_uq_resid, __pyx_v_residue_atoms, __pyx_v_atom_bonds, __pyx_v_nfragList); if (unlikely(__pyx_t_13 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 429, __pyx_L1_error)
+        __pyx_t_13 = __pyx_f_11moleculekit_16atomselect_utils__find_connected_subfragment(__pyx_v_i, (__pyx_v_nfragList.size() - 1), ((char const *)"O3'"), ((char const *)"O3*"), ((char const *)"H3T"), __pyx_v_res_flgs, __pyx_v_nucleic, __pyx_v_nucleic_bb, __pyx_v_atomnames, __pyx_v_uq_resid, __pyx_v_residue_atoms, __pyx_v_atom_bonds, __pyx_v_nfragList); if (unlikely(__pyx_t_13 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 401, __pyx_L1_error)
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":427
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":399
  *                     offresbondcount +=1
  * 
  *             if offresbondcount == 1: # Valid fragment start atom. Find residues downchain             # <<<<<<<<<<<<<<
  *                 nfragList.push_back(vector[int]())
  *                 _find_connected_subfragment(i, nfragList.size() - 1, "O3'", "O3*", "H3T", res_flgs, nucleic, nucleic_bb, atomnames, uq_resid, residue_atoms, atom_bonds, nfragList)
  */
       }
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":421
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":393
  *             continue
  * 
  *         for ra in residue_atoms[i]:  # Does the residue have a matching starting atom?             # <<<<<<<<<<<<<<
  *             offresbondcount = 0
  *             for ba in atom_bonds[ra]:
  */
     }
     __pyx_L3_continue:;
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":404
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":376
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _find_subfragments_topologically(             # <<<<<<<<<<<<<<
  *         int n_residues,
  *         vector[vector[int]] &residue_atoms,
  */
 
@@ -24365,15 +23837,15 @@
   __pyx_L1_error:;
   __Pyx_AddTraceback("moleculekit.atomselect_utils._find_subfragments_topologically", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "moleculekit/atomselect_utils/atomselect_utils.pyx":434
+/* "moleculekit/atomselect_utils/atomselect_utils.pyx":406
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _find_fragments(             # <<<<<<<<<<<<<<
  *         int n_residues,
  *         int n_atoms,
  */
 
@@ -24385,65 +23857,65 @@
   int __pyx_t_3;
   int __pyx_t_4;
   Py_ssize_t __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":452
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":424
  *         UINT32_t[:] fragments,
  *     ):
  *     _find_connected_fragments(n_residues, n_atoms, residue_atoms, atom_bonds, uq_resid, fragments, chain_id, seg_id, atomnames, res_flgs)             # <<<<<<<<<<<<<<
  *     for r in range(n_residues):  # Zero the residue flags
  *         res_flgs[r] = 0
  */
-  __pyx_t_1 = __pyx_f_11moleculekit_16atomselect_utils__find_connected_fragments(__pyx_v_n_residues, __pyx_v_n_atoms, __pyx_v_residue_atoms, __pyx_v_atom_bonds, __pyx_v_uq_resid, __pyx_v_fragments, __pyx_v_chain_id, __pyx_v_seg_id, __pyx_v_atomnames, __pyx_v_res_flgs); if (unlikely(__pyx_t_1 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 452, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_11moleculekit_16atomselect_utils__find_connected_fragments(__pyx_v_n_residues, __pyx_v_n_atoms, __pyx_v_residue_atoms, __pyx_v_atom_bonds, __pyx_v_uq_resid, __pyx_v_fragments, __pyx_v_chain_id, __pyx_v_seg_id, __pyx_v_atomnames, __pyx_v_res_flgs); if (unlikely(__pyx_t_1 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 424, __pyx_L1_error)
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":453
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":425
  *     ):
  *     _find_connected_fragments(n_residues, n_atoms, residue_atoms, atom_bonds, uq_resid, fragments, chain_id, seg_id, atomnames, res_flgs)
  *     for r in range(n_residues):  # Zero the residue flags             # <<<<<<<<<<<<<<
  *         res_flgs[r] = 0
  *     _find_subfragments(n_residues, residue_atoms, atom_bonds, uq_resid, res_flgs, protein_bb, atomnames, protein, pfragList)
  */
   __pyx_t_2 = __pyx_v_n_residues;
   __pyx_t_3 = __pyx_t_2;
   for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
     __pyx_v_r = __pyx_t_4;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":454
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":426
  *     _find_connected_fragments(n_residues, n_atoms, residue_atoms, atom_bonds, uq_resid, fragments, chain_id, seg_id, atomnames, res_flgs)
  *     for r in range(n_residues):  # Zero the residue flags
  *         res_flgs[r] = 0             # <<<<<<<<<<<<<<
  *     _find_subfragments(n_residues, residue_atoms, atom_bonds, uq_resid, res_flgs, protein_bb, atomnames, protein, pfragList)
  *     _find_subfragments_topologically(n_residues, residue_atoms, atom_bonds, uq_resid, res_flgs, nucleic_bb, atomnames, nucleic, nfragList)
  */
     __pyx_t_5 = __pyx_v_r;
     *((bool *) ( /* dim=0 */ (__pyx_v_res_flgs.data + __pyx_t_5 * __pyx_v_res_flgs.strides[0]) )) = 0;
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":455
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":427
  *     for r in range(n_residues):  # Zero the residue flags
  *         res_flgs[r] = 0
  *     _find_subfragments(n_residues, residue_atoms, atom_bonds, uq_resid, res_flgs, protein_bb, atomnames, protein, pfragList)             # <<<<<<<<<<<<<<
  *     _find_subfragments_topologically(n_residues, residue_atoms, atom_bonds, uq_resid, res_flgs, nucleic_bb, atomnames, nucleic, nfragList)
  * 
  */
-  __pyx_t_1 = __pyx_f_11moleculekit_16atomselect_utils__find_subfragments(__pyx_v_n_residues, __pyx_v_residue_atoms, __pyx_v_atom_bonds, __pyx_v_uq_resid, __pyx_v_res_flgs, __pyx_v_protein_bb, __pyx_v_atomnames, __pyx_v_protein, __pyx_v_pfragList); if (unlikely(__pyx_t_1 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 455, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_11moleculekit_16atomselect_utils__find_subfragments(__pyx_v_n_residues, __pyx_v_residue_atoms, __pyx_v_atom_bonds, __pyx_v_uq_resid, __pyx_v_res_flgs, __pyx_v_protein_bb, __pyx_v_atomnames, __pyx_v_protein, __pyx_v_pfragList); if (unlikely(__pyx_t_1 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 427, __pyx_L1_error)
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":456
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":428
  *         res_flgs[r] = 0
  *     _find_subfragments(n_residues, residue_atoms, atom_bonds, uq_resid, res_flgs, protein_bb, atomnames, protein, pfragList)
  *     _find_subfragments_topologically(n_residues, residue_atoms, atom_bonds, uq_resid, res_flgs, nucleic_bb, atomnames, nucleic, nfragList)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_1 = __pyx_f_11moleculekit_16atomselect_utils__find_subfragments_topologically(__pyx_v_n_residues, __pyx_v_residue_atoms, __pyx_v_atom_bonds, __pyx_v_uq_resid, __pyx_v_res_flgs, __pyx_v_nucleic_bb, __pyx_v_atomnames, __pyx_v_nucleic, __pyx_v_nfragList); if (unlikely(__pyx_t_1 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 456, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_11moleculekit_16atomselect_utils__find_subfragments_topologically(__pyx_v_n_residues, __pyx_v_residue_atoms, __pyx_v_atom_bonds, __pyx_v_uq_resid, __pyx_v_res_flgs, __pyx_v_nucleic_bb, __pyx_v_atomnames, __pyx_v_nucleic, __pyx_v_nfragList); if (unlikely(__pyx_t_1 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 428, __pyx_L1_error)
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":434
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":406
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _find_fragments(             # <<<<<<<<<<<<<<
  *         int n_residues,
  *         int n_atoms,
  */
 
@@ -24453,15 +23925,15 @@
   __pyx_L1_error:;
   __Pyx_AddTraceback("moleculekit.atomselect_utils._find_fragments", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "moleculekit/atomselect_utils/atomselect_utils.pyx":461
+/* "moleculekit/atomselect_utils/atomselect_utils.pyx":433
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _fix_backbones(             # <<<<<<<<<<<<<<
  *         bool[:] protein,
  *         bool[:] nucleic,
  */
 
@@ -24472,36 +23944,36 @@
   int __pyx_t_1;
   int __pyx_t_2;
   int __pyx_t_3;
   int __pyx_t_4;
   Py_ssize_t __pyx_t_5;
   int __pyx_t_6;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":470
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":442
  *     # This is necessary since we use just N CA C O names and other
  *     # molecules such as waters or ligands might have them
  *     cdef int n_atoms = protein.shape[0]             # <<<<<<<<<<<<<<
  *     for i in range(n_atoms):
  *         if protein_bb[i] and not protein[i]:
  */
   __pyx_v_n_atoms = (__pyx_v_protein.shape[0]);
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":471
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":443
  *     # molecules such as waters or ligands might have them
  *     cdef int n_atoms = protein.shape[0]
  *     for i in range(n_atoms):             # <<<<<<<<<<<<<<
  *         if protein_bb[i] and not protein[i]:
  *             protein_bb[i] = False
  */
   __pyx_t_1 = __pyx_v_n_atoms;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":472
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":444
  *     cdef int n_atoms = protein.shape[0]
  *     for i in range(n_atoms):
  *         if protein_bb[i] and not protein[i]:             # <<<<<<<<<<<<<<
  *             protein_bb[i] = False
  *         if nucleic_bb[i] and not nucleic[i]:
  */
     __pyx_t_5 = __pyx_v_i;
@@ -24513,34 +23985,34 @@
     }
     __pyx_t_5 = __pyx_v_i;
     __pyx_t_6 = (!((*((bool *) ( /* dim=0 */ (__pyx_v_protein.data + __pyx_t_5 * __pyx_v_protein.strides[0]) ))) != 0));
     __pyx_t_4 = __pyx_t_6;
     __pyx_L6_bool_binop_done:;
     if (__pyx_t_4) {
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":473
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":445
  *     for i in range(n_atoms):
  *         if protein_bb[i] and not protein[i]:
  *             protein_bb[i] = False             # <<<<<<<<<<<<<<
  *         if nucleic_bb[i] and not nucleic[i]:
  *             nucleic_bb[i] = False
  */
       __pyx_t_5 = __pyx_v_i;
       *((bool *) ( /* dim=0 */ (__pyx_v_protein_bb.data + __pyx_t_5 * __pyx_v_protein_bb.strides[0]) )) = 0;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":472
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":444
  *     cdef int n_atoms = protein.shape[0]
  *     for i in range(n_atoms):
  *         if protein_bb[i] and not protein[i]:             # <<<<<<<<<<<<<<
  *             protein_bb[i] = False
  *         if nucleic_bb[i] and not nucleic[i]:
  */
     }
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":474
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":446
  *         if protein_bb[i] and not protein[i]:
  *             protein_bb[i] = False
  *         if nucleic_bb[i] and not nucleic[i]:             # <<<<<<<<<<<<<<
  *             nucleic_bb[i] = False
  * 
  */
     __pyx_t_5 = __pyx_v_i;
@@ -24552,65 +24024,65 @@
     }
     __pyx_t_5 = __pyx_v_i;
     __pyx_t_6 = (!((*((bool *) ( /* dim=0 */ (__pyx_v_nucleic.data + __pyx_t_5 * __pyx_v_nucleic.strides[0]) ))) != 0));
     __pyx_t_4 = __pyx_t_6;
     __pyx_L9_bool_binop_done:;
     if (__pyx_t_4) {
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":475
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":447
  *             protein_bb[i] = False
  *         if nucleic_bb[i] and not nucleic[i]:
  *             nucleic_bb[i] = False             # <<<<<<<<<<<<<<
  * 
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  */
       __pyx_t_5 = __pyx_v_i;
       *((bool *) ( /* dim=0 */ (__pyx_v_nucleic_bb.data + __pyx_t_5 * __pyx_v_nucleic_bb.strides[0]) )) = 0;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":474
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":446
  *         if protein_bb[i] and not protein[i]:
  *             protein_bb[i] = False
  *         if nucleic_bb[i] and not nucleic[i]:             # <<<<<<<<<<<<<<
  *             nucleic_bb[i] = False
  * 
  */
     }
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":461
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":433
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _fix_backbones(             # <<<<<<<<<<<<<<
  *         bool[:] protein,
  *         bool[:] nucleic,
  */
 
   /* function exit code */
   __pyx_r = 0;
   return __pyx_r;
 }
 
-/* "moleculekit/atomselect_utils/atomselect_utils.pyx":477
+/* "moleculekit/atomselect_utils/atomselect_utils.pyx":449
  *             nucleic_bb[i] = False
  * 
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def analyze_molecule(
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11moleculekit_16atomselect_utils_3analyze_molecule(PyObject *__pyx_self, 
+static PyObject *__pyx_pw_11moleculekit_16atomselect_utils_1analyze_molecule(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ); /*proto*/
-static PyMethodDef __pyx_mdef_11moleculekit_16atomselect_utils_3analyze_molecule = {"analyze_molecule", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11moleculekit_16atomselect_utils_3analyze_molecule, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_11moleculekit_16atomselect_utils_3analyze_molecule(PyObject *__pyx_self, 
+static PyMethodDef __pyx_mdef_11moleculekit_16atomselect_utils_1analyze_molecule = {"analyze_molecule", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11moleculekit_16atomselect_utils_1analyze_molecule, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11moleculekit_16atomselect_utils_1analyze_molecule(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ) {
   int __pyx_v_n_atoms;
@@ -24688,160 +24160,160 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_atoms)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 477, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 449, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_bonds)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 477, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 449, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 1); __PYX_ERR(0, 477, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 1); __PYX_ERR(0, 449, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_resid)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 477, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 449, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 2); __PYX_ERR(0, 477, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 2); __PYX_ERR(0, 449, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_insertion)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[3]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 477, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 449, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 3); __PYX_ERR(0, 477, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 3); __PYX_ERR(0, 449, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_chain_id)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[4]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 477, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 449, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 4); __PYX_ERR(0, 477, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 4); __PYX_ERR(0, 449, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_seg_id)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[5]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 477, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 449, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 5); __PYX_ERR(0, 477, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 5); __PYX_ERR(0, 449, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_protein)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[6]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 477, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 449, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 6); __PYX_ERR(0, 477, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 6); __PYX_ERR(0, 449, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  7:
         if (likely((values[7] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_nucleic)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[7]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 477, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 449, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 7); __PYX_ERR(0, 477, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 7); __PYX_ERR(0, 449, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  8:
         if (likely((values[8] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_protein_bb)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[8]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 477, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 449, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 8); __PYX_ERR(0, 477, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 8); __PYX_ERR(0, 449, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  9:
         if (likely((values[9] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_nucleic_bb)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[9]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 477, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 449, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 9); __PYX_ERR(0, 477, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 9); __PYX_ERR(0, 449, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 10:
         if (likely((values[10] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_uq_resid)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[10]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 477, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 449, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 10); __PYX_ERR(0, 477, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 10); __PYX_ERR(0, 449, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 11:
         if (likely((values[11] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_fragments)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[11]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 477, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 449, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 11); __PYX_ERR(0, 477, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 11); __PYX_ERR(0, 449, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 12:
         if (likely((values[12] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_masses)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[12]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 477, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 449, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 12); __PYX_ERR(0, 477, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 12); __PYX_ERR(0, 449, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 13:
         if (likely((values[13] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_sidechain)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[13]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 477, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 449, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 13); __PYX_ERR(0, 477, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 13); __PYX_ERR(0, 449, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 14:
         if (likely((values[14] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_atomnames)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[14]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 477, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 449, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 14); __PYX_ERR(0, 477, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, 14); __PYX_ERR(0, 449, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "analyze_molecule") < 0)) __PYX_ERR(0, 477, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "analyze_molecule") < 0)) __PYX_ERR(0, 449, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 15)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
       values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
@@ -24854,33 +24326,33 @@
       values[9] = __Pyx_Arg_FASTCALL(__pyx_args, 9);
       values[10] = __Pyx_Arg_FASTCALL(__pyx_args, 10);
       values[11] = __Pyx_Arg_FASTCALL(__pyx_args, 11);
       values[12] = __Pyx_Arg_FASTCALL(__pyx_args, 12);
       values[13] = __Pyx_Arg_FASTCALL(__pyx_args, 13);
       values[14] = __Pyx_Arg_FASTCALL(__pyx_args, 14);
     }
-    __pyx_v_n_atoms = __Pyx_PyInt_As_int(values[0]); if (unlikely((__pyx_v_n_atoms == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 480, __pyx_L3_error)
-    __pyx_v_bonds = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_bonds.memview)) __PYX_ERR(0, 481, __pyx_L3_error)
-    __pyx_v_resid = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_INT64_t(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_resid.memview)) __PYX_ERR(0, 482, __pyx_L3_error)
-    __pyx_v_insertion = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_insertion.memview)) __PYX_ERR(0, 483, __pyx_L3_error)
-    __pyx_v_chain_id = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(values[4], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chain_id.memview)) __PYX_ERR(0, 484, __pyx_L3_error)
-    __pyx_v_seg_id = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(values[5], PyBUF_WRITABLE); if (unlikely(!__pyx_v_seg_id.memview)) __PYX_ERR(0, 485, __pyx_L3_error)
-    __pyx_v_protein = __Pyx_PyObject_to_MemoryviewSlice_ds_nn_bool(values[6], PyBUF_WRITABLE); if (unlikely(!__pyx_v_protein.memview)) __PYX_ERR(0, 486, __pyx_L3_error)
-    __pyx_v_nucleic = __Pyx_PyObject_to_MemoryviewSlice_ds_nn_bool(values[7], PyBUF_WRITABLE); if (unlikely(!__pyx_v_nucleic.memview)) __PYX_ERR(0, 487, __pyx_L3_error)
-    __pyx_v_protein_bb = __Pyx_PyObject_to_MemoryviewSlice_ds_nn_bool(values[8], PyBUF_WRITABLE); if (unlikely(!__pyx_v_protein_bb.memview)) __PYX_ERR(0, 488, __pyx_L3_error)
-    __pyx_v_nucleic_bb = __Pyx_PyObject_to_MemoryviewSlice_ds_nn_bool(values[9], PyBUF_WRITABLE); if (unlikely(!__pyx_v_nucleic_bb.memview)) __PYX_ERR(0, 489, __pyx_L3_error)
-    __pyx_v_uq_resid = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(values[10], PyBUF_WRITABLE); if (unlikely(!__pyx_v_uq_resid.memview)) __PYX_ERR(0, 490, __pyx_L3_error)
-    __pyx_v_fragments = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(values[11], PyBUF_WRITABLE); if (unlikely(!__pyx_v_fragments.memview)) __PYX_ERR(0, 491, __pyx_L3_error)
-    __pyx_v_masses = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_FLOAT32_t(values[12], PyBUF_WRITABLE); if (unlikely(!__pyx_v_masses.memview)) __PYX_ERR(0, 492, __pyx_L3_error)
-    __pyx_v_sidechain = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(values[13], PyBUF_WRITABLE); if (unlikely(!__pyx_v_sidechain.memview)) __PYX_ERR(0, 493, __pyx_L3_error)
-    __pyx_v_atomnames = __pyx_convert_vector_from_py_std_3a__3a_string(values[14]); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 494, __pyx_L3_error)
+    __pyx_v_n_atoms = __Pyx_PyInt_As_int(values[0]); if (unlikely((__pyx_v_n_atoms == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 452, __pyx_L3_error)
+    __pyx_v_bonds = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_bonds.memview)) __PYX_ERR(0, 453, __pyx_L3_error)
+    __pyx_v_resid = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_INT64_t(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_resid.memview)) __PYX_ERR(0, 454, __pyx_L3_error)
+    __pyx_v_insertion = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_insertion.memview)) __PYX_ERR(0, 455, __pyx_L3_error)
+    __pyx_v_chain_id = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(values[4], PyBUF_WRITABLE); if (unlikely(!__pyx_v_chain_id.memview)) __PYX_ERR(0, 456, __pyx_L3_error)
+    __pyx_v_seg_id = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(values[5], PyBUF_WRITABLE); if (unlikely(!__pyx_v_seg_id.memview)) __PYX_ERR(0, 457, __pyx_L3_error)
+    __pyx_v_protein = __Pyx_PyObject_to_MemoryviewSlice_ds_nn_bool(values[6], PyBUF_WRITABLE); if (unlikely(!__pyx_v_protein.memview)) __PYX_ERR(0, 458, __pyx_L3_error)
+    __pyx_v_nucleic = __Pyx_PyObject_to_MemoryviewSlice_ds_nn_bool(values[7], PyBUF_WRITABLE); if (unlikely(!__pyx_v_nucleic.memview)) __PYX_ERR(0, 459, __pyx_L3_error)
+    __pyx_v_protein_bb = __Pyx_PyObject_to_MemoryviewSlice_ds_nn_bool(values[8], PyBUF_WRITABLE); if (unlikely(!__pyx_v_protein_bb.memview)) __PYX_ERR(0, 460, __pyx_L3_error)
+    __pyx_v_nucleic_bb = __Pyx_PyObject_to_MemoryviewSlice_ds_nn_bool(values[9], PyBUF_WRITABLE); if (unlikely(!__pyx_v_nucleic_bb.memview)) __PYX_ERR(0, 461, __pyx_L3_error)
+    __pyx_v_uq_resid = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(values[10], PyBUF_WRITABLE); if (unlikely(!__pyx_v_uq_resid.memview)) __PYX_ERR(0, 462, __pyx_L3_error)
+    __pyx_v_fragments = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(values[11], PyBUF_WRITABLE); if (unlikely(!__pyx_v_fragments.memview)) __PYX_ERR(0, 463, __pyx_L3_error)
+    __pyx_v_masses = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_FLOAT32_t(values[12], PyBUF_WRITABLE); if (unlikely(!__pyx_v_masses.memview)) __PYX_ERR(0, 464, __pyx_L3_error)
+    __pyx_v_sidechain = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(values[13], PyBUF_WRITABLE); if (unlikely(!__pyx_v_sidechain.memview)) __PYX_ERR(0, 465, __pyx_L3_error)
+    __pyx_v_atomnames = __pyx_convert_vector_from_py_std_3a__3a_string(values[14]); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 466, __pyx_L3_error)
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, __pyx_nargs); __PYX_ERR(0, 477, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("analyze_molecule", 1, 15, 15, __pyx_nargs); __PYX_ERR(0, 449, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -24899,15 +24371,15 @@
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_fragments, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_masses, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_sidechain, 1);
   __Pyx_AddTraceback("moleculekit.atomselect_utils.analyze_molecule", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11moleculekit_16atomselect_utils_2analyze_molecule(__pyx_self, __pyx_v_n_atoms, __pyx_v_bonds, __pyx_v_resid, __pyx_v_insertion, __pyx_v_chain_id, __pyx_v_seg_id, __pyx_v_protein, __pyx_v_nucleic, __pyx_v_protein_bb, __pyx_v_nucleic_bb, __pyx_v_uq_resid, __pyx_v_fragments, __pyx_v_masses, __pyx_v_sidechain, __PYX_STD_MOVE_IF_SUPPORTED(__pyx_v_atomnames));
+  __pyx_r = __pyx_pf_11moleculekit_16atomselect_utils_analyze_molecule(__pyx_self, __pyx_v_n_atoms, __pyx_v_bonds, __pyx_v_resid, __pyx_v_insertion, __pyx_v_chain_id, __pyx_v_seg_id, __pyx_v_protein, __pyx_v_nucleic, __pyx_v_protein_bb, __pyx_v_nucleic_bb, __pyx_v_uq_resid, __pyx_v_fragments, __pyx_v_masses, __pyx_v_sidechain, __PYX_STD_MOVE_IF_SUPPORTED(__pyx_v_atomnames));
 
   /* function exit code */
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_bonds, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_resid, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_insertion, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_chain_id, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_seg_id, 1);
@@ -24925,15 +24397,15 @@
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11moleculekit_16atomselect_utils_2analyze_molecule(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_n_atoms, __Pyx_memviewslice __pyx_v_bonds, __Pyx_memviewslice __pyx_v_resid, __Pyx_memviewslice __pyx_v_insertion, __Pyx_memviewslice __pyx_v_chain_id, __Pyx_memviewslice __pyx_v_seg_id, __Pyx_memviewslice __pyx_v_protein, __Pyx_memviewslice __pyx_v_nucleic, __Pyx_memviewslice __pyx_v_protein_bb, __Pyx_memviewslice __pyx_v_nucleic_bb, __Pyx_memviewslice __pyx_v_uq_resid, __Pyx_memviewslice __pyx_v_fragments, __Pyx_memviewslice __pyx_v_masses, __Pyx_memviewslice __pyx_v_sidechain, std::vector<std::string>  __pyx_v_atomnames) {
+static PyObject *__pyx_pf_11moleculekit_16atomselect_utils_analyze_molecule(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_n_atoms, __Pyx_memviewslice __pyx_v_bonds, __Pyx_memviewslice __pyx_v_resid, __Pyx_memviewslice __pyx_v_insertion, __Pyx_memviewslice __pyx_v_chain_id, __Pyx_memviewslice __pyx_v_seg_id, __Pyx_memviewslice __pyx_v_protein, __Pyx_memviewslice __pyx_v_nucleic, __Pyx_memviewslice __pyx_v_protein_bb, __Pyx_memviewslice __pyx_v_nucleic_bb, __Pyx_memviewslice __pyx_v_uq_resid, __Pyx_memviewslice __pyx_v_fragments, __Pyx_memviewslice __pyx_v_masses, __Pyx_memviewslice __pyx_v_sidechain, std::vector<std::string>  __pyx_v_atomnames) {
   __Pyx_memviewslice __pyx_v_flgs = { 0, 0, { 0 }, { 0 }, { 0 } };
   std::vector<std::vector<int> >  __pyx_v_atom_bonds;
   std::vector<std::vector<int> >  __pyx_v_residue_atoms;
   std::vector<std::vector<int> >  __pyx_v_pfragList;
   std::vector<std::vector<int> >  __pyx_v_nfragList;
   int __pyx_v_n_residues;
   __Pyx_memviewslice __pyx_v_atm_flgs = { 0, 0, { 0 }, { 0 }, { 0 } };
@@ -24950,193 +24422,193 @@
   __Pyx_memviewslice __pyx_t_8 = { 0, 0, { 0 }, { 0 }, { 0 } };
   Py_ssize_t __pyx_t_9;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("analyze_molecule", 1);
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":496
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":468
  *         vector[string] &atomnames,
  *     ):
  *     cdef bool[:] flgs = np.zeros(n_atoms, dtype=np.bool_)             # <<<<<<<<<<<<<<
  *     cdef vector[vector[int]] atom_bonds
  *     cdef vector[vector[int]] residue_atoms
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 496, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 468, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 496, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 468, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_atoms); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 496, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_atoms); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 468, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 496, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 468, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1)) __PYX_ERR(0, 496, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1)) __PYX_ERR(0, 468, __pyx_L1_error);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 496, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 468, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 496, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 468, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_bool); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 496, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_bool); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 468, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 496, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 468, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 496, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 468, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn_bool(__pyx_t_5, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 496, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn_bool(__pyx_t_5, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 468, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_flgs = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":503
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":475
  *     cdef int n_residues
  * 
  *     _get_atom_bonds(n_atoms, bonds, atom_bonds)             # <<<<<<<<<<<<<<
  * 
  *     # Create unique residue IDs and residue list
  */
-  __pyx_t_7 = __pyx_f_11moleculekit_16atomselect_utils__get_atom_bonds(__pyx_v_n_atoms, __pyx_v_bonds, __pyx_v_atom_bonds); if (unlikely(__pyx_t_7 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 503, __pyx_L1_error)
+  __pyx_t_7 = __pyx_f_11moleculekit_16atomselect_utils__get_atom_bonds(__pyx_v_n_atoms, __pyx_v_bonds, __pyx_v_atom_bonds); if (unlikely(__pyx_t_7 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 475, __pyx_L1_error)
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":506
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":478
  * 
  *     # Create unique residue IDs and residue list
  *     _make_uniq_resids(n_atoms, atom_bonds, residue_atoms, resid, insertion, chain_id, seg_id, uq_resid, flgs)             # <<<<<<<<<<<<<<
  * 
  *     # Mark atoms as protein or nucleic
  */
-  __pyx_t_7 = __pyx_f_11moleculekit_16atomselect_utils__make_uniq_resids(__pyx_v_n_atoms, __pyx_v_atom_bonds, __pyx_v_residue_atoms, __pyx_v_resid, __pyx_v_insertion, __pyx_v_chain_id, __pyx_v_seg_id, __pyx_v_uq_resid, __pyx_v_flgs); if (unlikely(__pyx_t_7 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 506, __pyx_L1_error)
+  __pyx_t_7 = __pyx_f_11moleculekit_16atomselect_utils__make_uniq_resids(__pyx_v_n_atoms, __pyx_v_atom_bonds, __pyx_v_residue_atoms, __pyx_v_resid, __pyx_v_insertion, __pyx_v_chain_id, __pyx_v_seg_id, __pyx_v_uq_resid, __pyx_v_flgs); if (unlikely(__pyx_t_7 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 478, __pyx_L1_error)
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":509
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":481
  * 
  *     # Mark atoms as protein or nucleic
  *     cdef UINT32_t[:] atm_flgs = np.zeros(n_atoms, dtype=UINT32)             # <<<<<<<<<<<<<<
  *     _find_residues(n_atoms, protein, nucleic, protein_bb, nucleic_bb, resid, chain_id, seg_id, atom_bonds, atm_flgs)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 481, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 481, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_atoms); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_atoms); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 481, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 481, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_5);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5)) __PYX_ERR(0, 509, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5)) __PYX_ERR(0, 481, __pyx_L1_error);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 481, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_UINT32); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_UINT32); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 481, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 509, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 481, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 481, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 481, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_atm_flgs = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":510
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":482
  *     # Mark atoms as protein or nucleic
  *     cdef UINT32_t[:] atm_flgs = np.zeros(n_atoms, dtype=UINT32)
  *     _find_residues(n_atoms, protein, nucleic, protein_bb, nucleic_bb, resid, chain_id, seg_id, atom_bonds, atm_flgs)             # <<<<<<<<<<<<<<
  * 
  *     n_residues = uq_resid[n_atoms-1] + 1
  */
-  __pyx_t_7 = __pyx_f_11moleculekit_16atomselect_utils__find_residues(__pyx_v_n_atoms, __pyx_v_protein, __pyx_v_nucleic, __pyx_v_protein_bb, __pyx_v_nucleic_bb, __pyx_v_resid, __pyx_v_chain_id, __pyx_v_seg_id, __pyx_v_atom_bonds, __pyx_v_atm_flgs); if (unlikely(__pyx_t_7 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 510, __pyx_L1_error)
+  __pyx_t_7 = __pyx_f_11moleculekit_16atomselect_utils__find_residues(__pyx_v_n_atoms, __pyx_v_protein, __pyx_v_nucleic, __pyx_v_protein_bb, __pyx_v_nucleic_bb, __pyx_v_resid, __pyx_v_chain_id, __pyx_v_seg_id, __pyx_v_atom_bonds, __pyx_v_atm_flgs); if (unlikely(__pyx_t_7 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 482, __pyx_L1_error)
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":512
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":484
  *     _find_residues(n_atoms, protein, nucleic, protein_bb, nucleic_bb, resid, chain_id, seg_id, atom_bonds, atm_flgs)
  * 
  *     n_residues = uq_resid[n_atoms-1] + 1             # <<<<<<<<<<<<<<
  *     cdef bool[:] res_flgs = np.zeros(n_residues, dtype=np.bool_)
  *     _find_fragments(n_residues, n_atoms, residue_atoms, atom_bonds, pfragList, nfragList, uq_resid, chain_id, seg_id, atomnames, res_flgs, protein, nucleic, protein_bb, nucleic_bb, fragments)#, protein_frag, nucleic_frag, protein_frag_cyclic, nucleic_frag_cyclic)
  */
   __pyx_t_9 = (__pyx_v_n_atoms - 1);
   __pyx_v_n_residues = ((*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_uq_resid.data + __pyx_t_9 * __pyx_v_uq_resid.strides[0]) ))) + 1);
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":513
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":485
  * 
  *     n_residues = uq_resid[n_atoms-1] + 1
  *     cdef bool[:] res_flgs = np.zeros(n_residues, dtype=np.bool_)             # <<<<<<<<<<<<<<
  *     _find_fragments(n_residues, n_atoms, residue_atoms, atom_bonds, pfragList, nfragList, uq_resid, chain_id, seg_id, atomnames, res_flgs, protein, nucleic, protein_bb, nucleic_bb, fragments)#, protein_frag, nucleic_frag, protein_frag_cyclic, nucleic_frag_cyclic)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 513, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 485, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 513, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 485, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_n_residues); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 513, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_n_residues); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 485, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 513, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 485, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_2);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2)) __PYX_ERR(0, 513, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2)) __PYX_ERR(0, 485, __pyx_L1_error);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 513, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 485, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 513, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 485, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_bool); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 513, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_bool); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 485, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 513, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 485, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 513, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 485, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn_bool(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 513, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn_bool(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 485, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_res_flgs = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":514
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":486
  *     n_residues = uq_resid[n_atoms-1] + 1
  *     cdef bool[:] res_flgs = np.zeros(n_residues, dtype=np.bool_)
  *     _find_fragments(n_residues, n_atoms, residue_atoms, atom_bonds, pfragList, nfragList, uq_resid, chain_id, seg_id, atomnames, res_flgs, protein, nucleic, protein_bb, nucleic_bb, fragments)#, protein_frag, nucleic_frag, protein_frag_cyclic, nucleic_frag_cyclic)             # <<<<<<<<<<<<<<
  * 
  *     _fix_backbones(protein, nucleic, protein_bb, nucleic_bb)
  */
-  __pyx_t_7 = __pyx_f_11moleculekit_16atomselect_utils__find_fragments(__pyx_v_n_residues, __pyx_v_n_atoms, __pyx_v_residue_atoms, __pyx_v_atom_bonds, __pyx_v_pfragList, __pyx_v_nfragList, __pyx_v_uq_resid, __pyx_v_chain_id, __pyx_v_seg_id, __pyx_v_atomnames, __pyx_v_res_flgs, __pyx_v_protein, __pyx_v_nucleic, __pyx_v_protein_bb, __pyx_v_nucleic_bb, __pyx_v_fragments); if (unlikely(__pyx_t_7 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 514, __pyx_L1_error)
+  __pyx_t_7 = __pyx_f_11moleculekit_16atomselect_utils__find_fragments(__pyx_v_n_residues, __pyx_v_n_atoms, __pyx_v_residue_atoms, __pyx_v_atom_bonds, __pyx_v_pfragList, __pyx_v_nfragList, __pyx_v_uq_resid, __pyx_v_chain_id, __pyx_v_seg_id, __pyx_v_atomnames, __pyx_v_res_flgs, __pyx_v_protein, __pyx_v_nucleic, __pyx_v_protein_bb, __pyx_v_nucleic_bb, __pyx_v_fragments); if (unlikely(__pyx_t_7 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 486, __pyx_L1_error)
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":516
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":488
  *     _find_fragments(n_residues, n_atoms, residue_atoms, atom_bonds, pfragList, nfragList, uq_resid, chain_id, seg_id, atomnames, res_flgs, protein, nucleic, protein_bb, nucleic_bb, fragments)#, protein_frag, nucleic_frag, protein_frag_cyclic, nucleic_frag_cyclic)
  * 
  *     _fix_backbones(protein, nucleic, protein_bb, nucleic_bb)             # <<<<<<<<<<<<<<
  * 
  *     _atomsel_sidechain(residue_atoms, atom_bonds, pfragList, protein_bb, nucleic_bb, atomnames, masses, sidechain)
  */
-  __pyx_t_7 = __pyx_f_11moleculekit_16atomselect_utils__fix_backbones(__pyx_v_protein, __pyx_v_nucleic, __pyx_v_protein_bb, __pyx_v_nucleic_bb); if (unlikely(__pyx_t_7 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 516, __pyx_L1_error)
+  __pyx_t_7 = __pyx_f_11moleculekit_16atomselect_utils__fix_backbones(__pyx_v_protein, __pyx_v_nucleic, __pyx_v_protein_bb, __pyx_v_nucleic_bb); if (unlikely(__pyx_t_7 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 488, __pyx_L1_error)
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":518
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":490
  *     _fix_backbones(protein, nucleic, protein_bb, nucleic_bb)
  * 
  *     _atomsel_sidechain(residue_atoms, atom_bonds, pfragList, protein_bb, nucleic_bb, atomnames, masses, sidechain)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_7 = __pyx_f_11moleculekit_16atomselect_utils__atomsel_sidechain(__pyx_v_residue_atoms, __pyx_v_atom_bonds, __pyx_v_pfragList, __pyx_v_protein_bb, __pyx_v_nucleic_bb, __pyx_v_atomnames, __pyx_v_masses, __pyx_v_sidechain); if (unlikely(__pyx_t_7 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 518, __pyx_L1_error)
+  __pyx_t_7 = __pyx_f_11moleculekit_16atomselect_utils__atomsel_sidechain(__pyx_v_residue_atoms, __pyx_v_atom_bonds, __pyx_v_pfragList, __pyx_v_protein_bb, __pyx_v_nucleic_bb, __pyx_v_atomnames, __pyx_v_masses, __pyx_v_sidechain); if (unlikely(__pyx_t_7 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 490, __pyx_L1_error)
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":477
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":449
  *             nucleic_bb[i] = False
  * 
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def analyze_molecule(
  */
 
@@ -25158,15 +24630,15 @@
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_atm_flgs, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_res_flgs, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "moleculekit/atomselect_utils/atomselect_utils.pyx":523
+/* "moleculekit/atomselect_utils/atomselect_utils.pyx":495
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _recursive_find_sidechain_atoms(             # <<<<<<<<<<<<<<
  *         int atom_index,
  *         vector[vector[int]] &atom_bonds,
  */
 
@@ -25180,45 +24652,45 @@
   std::vector<int>  *__pyx_t_5;
   int __pyx_t_6;
   bool __pyx_t_7;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":533
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":505
  * 
  *     # Have we been here?
  *     if sidechain[atom_index] == 2:             # <<<<<<<<<<<<<<
  *         return False
  * 
  */
   __pyx_t_1 = __pyx_v_atom_index;
   __pyx_t_2 = ((*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_sidechain.data + __pyx_t_1 * __pyx_v_sidechain.strides[0]) ))) == 2);
   if (__pyx_t_2) {
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":534
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":506
  *     # Have we been here?
  *     if sidechain[atom_index] == 2:
  *         return False             # <<<<<<<<<<<<<<
  * 
  *     # Is it a backbone atom?
  */
     __pyx_r = 0;
     goto __pyx_L0;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":533
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":505
  * 
  *     # Have we been here?
  *     if sidechain[atom_index] == 2:             # <<<<<<<<<<<<<<
  *         return False
  * 
  */
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":537
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":509
  * 
  *     # Is it a backbone atom?
  *     if protein_bb[atom_index] or nucleic_bb[atom_index]:             # <<<<<<<<<<<<<<
  *         return False
  * 
  */
   __pyx_t_1 = __pyx_v_atom_index;
@@ -25230,87 +24702,87 @@
   }
   __pyx_t_1 = __pyx_v_atom_index;
   __pyx_t_3 = ((*((bool *) ( /* dim=0 */ (__pyx_v_nucleic_bb.data + __pyx_t_1 * __pyx_v_nucleic_bb.strides[0]) ))) != 0);
   __pyx_t_2 = __pyx_t_3;
   __pyx_L5_bool_binop_done:;
   if (__pyx_t_2) {
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":538
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":510
  *     # Is it a backbone atom?
  *     if protein_bb[atom_index] or nucleic_bb[atom_index]:
  *         return False             # <<<<<<<<<<<<<<
  * 
  *     sidechain[atom_index] = 2
  */
     __pyx_r = 0;
     goto __pyx_L0;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":537
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":509
  * 
  *     # Is it a backbone atom?
  *     if protein_bb[atom_index] or nucleic_bb[atom_index]:             # <<<<<<<<<<<<<<
  *         return False
  * 
  */
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":540
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":512
  *         return False
  * 
  *     sidechain[atom_index] = 2             # <<<<<<<<<<<<<<
  * 
  *     # Try the atoms it's bonded to
  */
   __pyx_t_1 = __pyx_v_atom_index;
   *((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_sidechain.data + __pyx_t_1 * __pyx_v_sidechain.strides[0]) )) = 2;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":543
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":515
  * 
  *     # Try the atoms it's bonded to
  *     for ba in atom_bonds[atom_index]:             # <<<<<<<<<<<<<<
  *         _recursive_find_sidechain_atoms(ba, atom_bonds, protein_bb, nucleic_bb, sidechain)
  * 
  */
   __pyx_t_5 = &(__pyx_v_atom_bonds[__pyx_v_atom_index]);
   __pyx_t_4 = __pyx_t_5->begin();
   for (;;) {
     if (!(__pyx_t_4 != __pyx_t_5->end())) break;
     __pyx_t_6 = *__pyx_t_4;
     ++__pyx_t_4;
     __pyx_v_ba = __pyx_t_6;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":544
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":516
  *     # Try the atoms it's bonded to
  *     for ba in atom_bonds[atom_index]:
  *         _recursive_find_sidechain_atoms(ba, atom_bonds, protein_bb, nucleic_bb, sidechain)             # <<<<<<<<<<<<<<
  * 
  *     return True
  */
-    __pyx_t_7 = __pyx_f_11moleculekit_16atomselect_utils__recursive_find_sidechain_atoms(__pyx_v_ba, __pyx_v_atom_bonds, __pyx_v_protein_bb, __pyx_v_nucleic_bb, __pyx_v_sidechain); if (unlikely(__pyx_t_7 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 544, __pyx_L1_error)
+    __pyx_t_7 = __pyx_f_11moleculekit_16atomselect_utils__recursive_find_sidechain_atoms(__pyx_v_ba, __pyx_v_atom_bonds, __pyx_v_protein_bb, __pyx_v_nucleic_bb, __pyx_v_sidechain); if (unlikely(__pyx_t_7 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 516, __pyx_L1_error)
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":543
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":515
  * 
  *     # Try the atoms it's bonded to
  *     for ba in atom_bonds[atom_index]:             # <<<<<<<<<<<<<<
  *         _recursive_find_sidechain_atoms(ba, atom_bonds, protein_bb, nucleic_bb, sidechain)
  * 
  */
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":546
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":518
  *         _recursive_find_sidechain_atoms(ba, atom_bonds, protein_bb, nucleic_bb, sidechain)
  * 
  *     return True             # <<<<<<<<<<<<<<
  * 
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  */
   __pyx_r = 1;
   goto __pyx_L0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":523
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":495
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _recursive_find_sidechain_atoms(             # <<<<<<<<<<<<<<
  *         int atom_index,
  *         vector[vector[int]] &atom_bonds,
  */
 
@@ -25318,15 +24790,15 @@
   __pyx_L1_error:;
   __Pyx_AddTraceback("moleculekit.atomselect_utils._recursive_find_sidechain_atoms", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "moleculekit/atomselect_utils/atomselect_utils.pyx":550
+/* "moleculekit/atomselect_utils/atomselect_utils.pyx":522
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _find_sidechain_atoms(             # <<<<<<<<<<<<<<
  *         int n_atoms,
  *         vector[vector[int]] &atom_bonds,
  */
 
@@ -25339,67 +24811,67 @@
   Py_ssize_t __pyx_t_4;
   int __pyx_t_5;
   bool __pyx_t_6;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":559
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":531
  *     cdef int i
  * 
  *     for i in range(n_atoms):             # <<<<<<<<<<<<<<
  *         if sidechain[i]:
  *             _recursive_find_sidechain_atoms(i, atom_bonds, protein_bb, nucleic_bb, sidechain)
  */
   __pyx_t_1 = __pyx_v_n_atoms;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":560
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":532
  * 
  *     for i in range(n_atoms):
  *         if sidechain[i]:             # <<<<<<<<<<<<<<
  *             _recursive_find_sidechain_atoms(i, atom_bonds, protein_bb, nucleic_bb, sidechain)
  * 
  */
     __pyx_t_4 = __pyx_v_i;
     __pyx_t_5 = ((*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_sidechain.data + __pyx_t_4 * __pyx_v_sidechain.strides[0]) ))) != 0);
     if (__pyx_t_5) {
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":561
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":533
  *     for i in range(n_atoms):
  *         if sidechain[i]:
  *             _recursive_find_sidechain_atoms(i, atom_bonds, protein_bb, nucleic_bb, sidechain)             # <<<<<<<<<<<<<<
  * 
  *     return True
  */
-      __pyx_t_6 = __pyx_f_11moleculekit_16atomselect_utils__recursive_find_sidechain_atoms(__pyx_v_i, __pyx_v_atom_bonds, __pyx_v_protein_bb, __pyx_v_nucleic_bb, __pyx_v_sidechain); if (unlikely(__pyx_t_6 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 561, __pyx_L1_error)
+      __pyx_t_6 = __pyx_f_11moleculekit_16atomselect_utils__recursive_find_sidechain_atoms(__pyx_v_i, __pyx_v_atom_bonds, __pyx_v_protein_bb, __pyx_v_nucleic_bb, __pyx_v_sidechain); if (unlikely(__pyx_t_6 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 533, __pyx_L1_error)
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":560
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":532
  * 
  *     for i in range(n_atoms):
  *         if sidechain[i]:             # <<<<<<<<<<<<<<
  *             _recursive_find_sidechain_atoms(i, atom_bonds, protein_bb, nucleic_bb, sidechain)
  * 
  */
     }
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":563
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":535
  *             _recursive_find_sidechain_atoms(i, atom_bonds, protein_bb, nucleic_bb, sidechain)
  * 
  *     return True             # <<<<<<<<<<<<<<
  * 
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  */
   __pyx_r = 1;
   goto __pyx_L0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":550
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":522
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _find_sidechain_atoms(             # <<<<<<<<<<<<<<
  *         int n_atoms,
  *         vector[vector[int]] &atom_bonds,
  */
 
@@ -25407,15 +24879,15 @@
   __pyx_L1_error:;
   __Pyx_AddTraceback("moleculekit.atomselect_utils._find_sidechain_atoms", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "moleculekit/atomselect_utils/atomselect_utils.pyx":567
+/* "moleculekit/atomselect_utils/atomselect_utils.pyx":539
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _atomsel_sidechain(             # <<<<<<<<<<<<<<
  *         vector[vector[int]] &residue_atoms,
  *         vector[vector[int]] &atom_bonds,
  */
 
@@ -25446,182 +24918,182 @@
   Py_ssize_t __pyx_t_10;
   int __pyx_t_11;
   bool __pyx_t_12;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":579
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":551
  *     cdef int ca_idx, b1, b2, c1, c2
  *     cdef FLOAT32_t m1, m2
  *     cdef int n_atoms = protein_bb.shape[0]             # <<<<<<<<<<<<<<
  *     cdef int n_fragments = pfragList.size()
  * 
  */
   __pyx_v_n_atoms = (__pyx_v_protein_bb.shape[0]);
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":580
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":552
  *     cdef FLOAT32_t m1, m2
  *     cdef int n_atoms = protein_bb.shape[0]
  *     cdef int n_fragments = pfragList.size()             # <<<<<<<<<<<<<<
  * 
  *     for f in range(n_fragments):
  */
   __pyx_v_n_fragments = __pyx_v_pfragList.size();
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":582
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":554
  *     cdef int n_fragments = pfragList.size()
  * 
  *     for f in range(n_fragments):             # <<<<<<<<<<<<<<
  *         for res in pfragList[f]:
  * 
  */
   __pyx_t_1 = __pyx_v_n_fragments;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_f = __pyx_t_3;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":583
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":555
  * 
  *     for f in range(n_fragments):
  *         for res in pfragList[f]:             # <<<<<<<<<<<<<<
  * 
  *             ca_idx = -1
  */
     __pyx_t_5 = &(__pyx_v_pfragList[__pyx_v_f]);
     __pyx_t_4 = __pyx_t_5->begin();
     for (;;) {
       if (!(__pyx_t_4 != __pyx_t_5->end())) break;
       __pyx_t_6 = *__pyx_t_4;
       ++__pyx_t_4;
       __pyx_v_res = __pyx_t_6;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":585
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":557
  *         for res in pfragList[f]:
  * 
  *             ca_idx = -1             # <<<<<<<<<<<<<<
  *             for i in residue_atoms[res]:
  *                 if strcmp(atomnames[i].c_str(), "CA") == 0:
  */
       __pyx_v_ca_idx = -1;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":586
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":558
  * 
  *             ca_idx = -1
  *             for i in residue_atoms[res]:             # <<<<<<<<<<<<<<
  *                 if strcmp(atomnames[i].c_str(), "CA") == 0:
  *                     ca_idx = i
  */
       __pyx_t_8 = &(__pyx_v_residue_atoms[__pyx_v_res]);
       __pyx_t_7 = __pyx_t_8->begin();
       for (;;) {
         if (!(__pyx_t_7 != __pyx_t_8->end())) break;
         __pyx_t_6 = *__pyx_t_7;
         ++__pyx_t_7;
         __pyx_v_i = __pyx_t_6;
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":587
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":559
  *             ca_idx = -1
  *             for i in residue_atoms[res]:
  *                 if strcmp(atomnames[i].c_str(), "CA") == 0:             # <<<<<<<<<<<<<<
  *                     ca_idx = i
  * 
  */
         __pyx_t_9 = (strcmp((__pyx_v_atomnames[__pyx_v_i]).c_str(), ((char const *)"CA")) == 0);
         if (__pyx_t_9) {
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":588
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":560
  *             for i in residue_atoms[res]:
  *                 if strcmp(atomnames[i].c_str(), "CA") == 0:
  *                     ca_idx = i             # <<<<<<<<<<<<<<
  * 
  *             if ca_idx < 0:
  */
           __pyx_v_ca_idx = __pyx_v_i;
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":587
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":559
  *             ca_idx = -1
  *             for i in residue_atoms[res]:
  *                 if strcmp(atomnames[i].c_str(), "CA") == 0:             # <<<<<<<<<<<<<<
  *                     ca_idx = i
  * 
  */
         }
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":586
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":558
  * 
  *             ca_idx = -1
  *             for i in residue_atoms[res]:             # <<<<<<<<<<<<<<
  *                 if strcmp(atomnames[i].c_str(), "CA") == 0:
  *                     ca_idx = i
  */
       }
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":590
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":562
  *                     ca_idx = i
  * 
  *             if ca_idx < 0:             # <<<<<<<<<<<<<<
  *                 # printf("Atomselection: sidechain: cannot find CA atom\n")
  *                 continue
  */
       __pyx_t_9 = (__pyx_v_ca_idx < 0);
       if (__pyx_t_9) {
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":592
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":564
  *             if ca_idx < 0:
  *                 # printf("Atomselection: sidechain: cannot find CA atom\n")
  *                 continue             # <<<<<<<<<<<<<<
  * 
  *             # Find at most two neighbours of CA which are not on the backbone
  */
         goto __pyx_L5_continue;
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":590
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":562
  *                     ca_idx = i
  * 
  *             if ca_idx < 0:             # <<<<<<<<<<<<<<
  *                 # printf("Atomselection: sidechain: cannot find CA atom\n")
  *                 continue
  */
       }
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":595
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":567
  * 
  *             # Find at most two neighbours of CA which are not on the backbone
  *             b1 = -1             # <<<<<<<<<<<<<<
  *             b2 = -1
  *             for ba in atom_bonds[ca_idx]:
  */
       __pyx_v_b1 = -1;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":596
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":568
  *             # Find at most two neighbours of CA which are not on the backbone
  *             b1 = -1
  *             b2 = -1             # <<<<<<<<<<<<<<
  *             for ba in atom_bonds[ca_idx]:
  *                 if not protein_bb[ba] and not nucleic_bb[ba]:
  */
       __pyx_v_b2 = -1;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":597
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":569
  *             b1 = -1
  *             b2 = -1
  *             for ba in atom_bonds[ca_idx]:             # <<<<<<<<<<<<<<
  *                 if not protein_bb[ba] and not nucleic_bb[ba]:
  *                     if b1 == -1:
  */
       __pyx_t_8 = &(__pyx_v_atom_bonds[__pyx_v_ca_idx]);
       __pyx_t_7 = __pyx_t_8->begin();
       for (;;) {
         if (!(__pyx_t_7 != __pyx_t_8->end())) break;
         __pyx_t_6 = *__pyx_t_7;
         ++__pyx_t_7;
         __pyx_v_ba = __pyx_t_6;
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":598
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":570
  *             b2 = -1
  *             for ba in atom_bonds[ca_idx]:
  *                 if not protein_bb[ba] and not nucleic_bb[ba]:             # <<<<<<<<<<<<<<
  *                     if b1 == -1:
  *                         b1 = ba
  */
         __pyx_t_10 = __pyx_v_ba;
@@ -25633,161 +25105,161 @@
         }
         __pyx_t_10 = __pyx_v_ba;
         __pyx_t_11 = (!((*((bool *) ( /* dim=0 */ (__pyx_v_nucleic_bb.data + __pyx_t_10 * __pyx_v_nucleic_bb.strides[0]) ))) != 0));
         __pyx_t_9 = __pyx_t_11;
         __pyx_L15_bool_binop_done:;
         if (__pyx_t_9) {
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":599
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":571
  *             for ba in atom_bonds[ca_idx]:
  *                 if not protein_bb[ba] and not nucleic_bb[ba]:
  *                     if b1 == -1:             # <<<<<<<<<<<<<<
  *                         b1 = ba
  *                     else:
  */
           __pyx_t_9 = (__pyx_v_b1 == -1L);
           if (__pyx_t_9) {
 
-            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":600
+            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":572
  *                 if not protein_bb[ba] and not nucleic_bb[ba]:
  *                     if b1 == -1:
  *                         b1 = ba             # <<<<<<<<<<<<<<
  *                     else:
  *                         if b2 == -1:
  */
             __pyx_v_b1 = __pyx_v_ba;
 
-            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":599
+            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":571
  *             for ba in atom_bonds[ca_idx]:
  *                 if not protein_bb[ba] and not nucleic_bb[ba]:
  *                     if b1 == -1:             # <<<<<<<<<<<<<<
  *                         b1 = ba
  *                     else:
  */
             goto __pyx_L17;
           }
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":602
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":574
  *                         b1 = ba
  *                     else:
  *                         if b2 == -1:             # <<<<<<<<<<<<<<
  *                             b2 = ba
  *                         else:
  */
           /*else*/ {
             __pyx_t_9 = (__pyx_v_b2 == -1L);
             if (__pyx_t_9) {
 
-              /* "moleculekit/atomselect_utils/atomselect_utils.pyx":603
+              /* "moleculekit/atomselect_utils/atomselect_utils.pyx":575
  *                     else:
  *                         if b2 == -1:
  *                             b2 = ba             # <<<<<<<<<<<<<<
  *                         else:
  *                             # printf("Atomselection: sidechain: protein residue index %i, CA atom idx %i has more than two non-backbone bonds. Ignoring the others\n", res, ca_idx)
  */
               __pyx_v_b2 = __pyx_v_ba;
 
-              /* "moleculekit/atomselect_utils/atomselect_utils.pyx":602
+              /* "moleculekit/atomselect_utils/atomselect_utils.pyx":574
  *                         b1 = ba
  *                     else:
  *                         if b2 == -1:             # <<<<<<<<<<<<<<
  *                             b2 = ba
  *                         else:
  */
               goto __pyx_L18;
             }
 
-            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":606
+            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":578
  *                         else:
  *                             # printf("Atomselection: sidechain: protein residue index %i, CA atom idx %i has more than two non-backbone bonds. Ignoring the others\n", res, ca_idx)
  *                             pass             # <<<<<<<<<<<<<<
  * 
  *             if b1 == -1:
  */
             /*else*/ {
             }
             __pyx_L18:;
           }
           __pyx_L17:;
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":598
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":570
  *             b2 = -1
  *             for ba in atom_bonds[ca_idx]:
  *                 if not protein_bb[ba] and not nucleic_bb[ba]:             # <<<<<<<<<<<<<<
  *                     if b1 == -1:
  *                         b1 = ba
  */
         }
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":597
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":569
  *             b1 = -1
  *             b2 = -1
  *             for ba in atom_bonds[ca_idx]:             # <<<<<<<<<<<<<<
  *                 if not protein_bb[ba] and not nucleic_bb[ba]:
  *                     if b1 == -1:
  */
       }
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":608
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":580
  *                             pass
  * 
  *             if b1 == -1:             # <<<<<<<<<<<<<<
  *                 continue
  * 
  */
       __pyx_t_9 = (__pyx_v_b1 == -1L);
       if (__pyx_t_9) {
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":609
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":581
  * 
  *             if b1 == -1:
  *                 continue             # <<<<<<<<<<<<<<
  * 
  *             if b2 != -1: # Find the right one. Check number of atoms to see if they have a lone H
  */
         goto __pyx_L5_continue;
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":608
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":580
  *                             pass
  * 
  *             if b1 == -1:             # <<<<<<<<<<<<<<
  *                 continue
  * 
  */
       }
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":611
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":583
  *                 continue
  * 
  *             if b2 != -1: # Find the right one. Check number of atoms to see if they have a lone H             # <<<<<<<<<<<<<<
  *                 c1 = atom_bonds[b1].size()
  *                 c2 = atom_bonds[b2].size()
  */
       __pyx_t_9 = (__pyx_v_b2 != -1L);
       if (__pyx_t_9) {
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":612
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":584
  * 
  *             if b2 != -1: # Find the right one. Check number of atoms to see if they have a lone H
  *                 c1 = atom_bonds[b1].size()             # <<<<<<<<<<<<<<
  *                 c2 = atom_bonds[b2].size()
  * 
  */
         __pyx_v_c1 = (__pyx_v_atom_bonds[__pyx_v_b1]).size();
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":613
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":585
  *             if b2 != -1: # Find the right one. Check number of atoms to see if they have a lone H
  *                 c1 = atom_bonds[b1].size()
  *                 c2 = atom_bonds[b2].size()             # <<<<<<<<<<<<<<
  * 
  *                 if c1 == 1 and c2 > 1:
  */
         __pyx_v_c2 = (__pyx_v_atom_bonds[__pyx_v_b2]).size();
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":615
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":587
  *                 c2 = atom_bonds[b2].size()
  * 
  *                 if c1 == 1 and c2 > 1:             # <<<<<<<<<<<<<<
  *                     b1 = b2
  *                 elif c2 == 1 and c1 > 1:
  */
         __pyx_t_11 = (__pyx_v_c1 == 1);
@@ -25797,34 +25269,34 @@
           goto __pyx_L23_bool_binop_done;
         }
         __pyx_t_11 = (__pyx_v_c2 > 1);
         __pyx_t_9 = __pyx_t_11;
         __pyx_L23_bool_binop_done:;
         if (__pyx_t_9) {
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":616
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":588
  * 
  *                 if c1 == 1 and c2 > 1:
  *                     b1 = b2             # <<<<<<<<<<<<<<
  *                 elif c2 == 1 and c1 > 1:
  *                     b1 = b1
  */
           __pyx_v_b1 = __pyx_v_b2;
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":615
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":587
  *                 c2 = atom_bonds[b2].size()
  * 
  *                 if c1 == 1 and c2 > 1:             # <<<<<<<<<<<<<<
  *                     b1 = b2
  *                 elif c2 == 1 and c1 > 1:
  */
           goto __pyx_L22;
         }
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":617
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":589
  *                 if c1 == 1 and c2 > 1:
  *                     b1 = b2
  *                 elif c2 == 1 and c1 > 1:             # <<<<<<<<<<<<<<
  *                     b1 = b1
  *                 elif c1 == 1 and c2 == 1:
  */
         __pyx_t_11 = (__pyx_v_c2 == 1);
@@ -25834,25 +25306,25 @@
           goto __pyx_L25_bool_binop_done;
         }
         __pyx_t_11 = (__pyx_v_c1 > 1);
         __pyx_t_9 = __pyx_t_11;
         __pyx_L25_bool_binop_done:;
         if (__pyx_t_9) {
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":618
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":590
  *                     b1 = b2
  *                 elif c2 == 1 and c1 > 1:
  *                     b1 = b1             # <<<<<<<<<<<<<<
  *                 elif c1 == 1 and c2 == 1:
  *                     # check the masses
  */
           goto __pyx_L22;
         }
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":619
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":591
  *                 elif c2 == 1 and c1 > 1:
  *                     b1 = b1
  *                 elif c1 == 1 and c2 == 1:             # <<<<<<<<<<<<<<
  *                     # check the masses
  *                     m1 = masses[b1]
  */
         __pyx_t_11 = (__pyx_v_c1 == 1);
@@ -25862,35 +25334,35 @@
           goto __pyx_L27_bool_binop_done;
         }
         __pyx_t_11 = (__pyx_v_c2 == 1);
         __pyx_t_9 = __pyx_t_11;
         __pyx_L27_bool_binop_done:;
         if (__pyx_t_9) {
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":621
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":593
  *                 elif c1 == 1 and c2 == 1:
  *                     # check the masses
  *                     m1 = masses[b1]             # <<<<<<<<<<<<<<
  *                     m2 = masses[b2]
  *                     if m1 > 2.3 and m2 <= 2.3:
  */
           __pyx_t_10 = __pyx_v_b1;
           __pyx_v_m1 = (*((__pyx_t_11moleculekit_16atomselect_utils_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_masses.data + __pyx_t_10 * __pyx_v_masses.strides[0]) )));
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":622
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":594
  *                     # check the masses
  *                     m1 = masses[b1]
  *                     m2 = masses[b2]             # <<<<<<<<<<<<<<
  *                     if m1 > 2.3 and m2 <= 2.3:
  *                         b1 = b2
  */
           __pyx_t_10 = __pyx_v_b2;
           __pyx_v_m2 = (*((__pyx_t_11moleculekit_16atomselect_utils_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_masses.data + __pyx_t_10 * __pyx_v_masses.strides[0]) )));
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":623
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":595
  *                     m1 = masses[b1]
  *                     m2 = masses[b2]
  *                     if m1 > 2.3 and m2 <= 2.3:             # <<<<<<<<<<<<<<
  *                         b1 = b2
  *                     elif m2 > 2.3 and m1 <= 2.3:
  */
           __pyx_t_11 = (__pyx_v_m1 > 2.3);
@@ -25900,34 +25372,34 @@
             goto __pyx_L30_bool_binop_done;
           }
           __pyx_t_11 = (__pyx_v_m2 <= 2.3);
           __pyx_t_9 = __pyx_t_11;
           __pyx_L30_bool_binop_done:;
           if (__pyx_t_9) {
 
-            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":624
+            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":596
  *                     m2 = masses[b2]
  *                     if m1 > 2.3 and m2 <= 2.3:
  *                         b1 = b2             # <<<<<<<<<<<<<<
  *                     elif m2 > 2.3 and m1 <= 2.3:
  *                         b1 = b1
  */
             __pyx_v_b1 = __pyx_v_b2;
 
-            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":623
+            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":595
  *                     m1 = masses[b1]
  *                     m2 = masses[b2]
  *                     if m1 > 2.3 and m2 <= 2.3:             # <<<<<<<<<<<<<<
  *                         b1 = b2
  *                     elif m2 > 2.3 and m1 <= 2.3:
  */
             goto __pyx_L29;
           }
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":625
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":597
  *                     if m1 > 2.3 and m2 <= 2.3:
  *                         b1 = b2
  *                     elif m2 > 2.3 and m1 <= 2.3:             # <<<<<<<<<<<<<<
  *                         b1 = b1
  *                     elif m1 <= 2.0 and m2 <= 2.3:
  */
           __pyx_t_11 = (__pyx_v_m2 > 2.3);
@@ -25937,25 +25409,25 @@
             goto __pyx_L32_bool_binop_done;
           }
           __pyx_t_11 = (__pyx_v_m1 <= 2.3);
           __pyx_t_9 = __pyx_t_11;
           __pyx_L32_bool_binop_done:;
           if (__pyx_t_9) {
 
-            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":626
+            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":598
  *                         b1 = b2
  *                     elif m2 > 2.3 and m1 <= 2.3:
  *                         b1 = b1             # <<<<<<<<<<<<<<
  *                     elif m1 <= 2.0 and m2 <= 2.3:
  *                         # should have two H's, find the "first" of those
  */
             goto __pyx_L29;
           }
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":627
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":599
  *                     elif m2 > 2.3 and m1 <= 2.3:
  *                         b1 = b1
  *                     elif m1 <= 2.0 and m2 <= 2.3:             # <<<<<<<<<<<<<<
  *                         # should have two H's, find the "first" of those
  *                         if strcmp(atomnames[b1].c_str(), atomnames[b2].c_str()) > 0:
  */
           __pyx_t_11 = (__pyx_v_m1 <= 2.0);
@@ -25965,133 +25437,133 @@
             goto __pyx_L34_bool_binop_done;
           }
           __pyx_t_11 = (__pyx_v_m2 <= 2.3);
           __pyx_t_9 = __pyx_t_11;
           __pyx_L34_bool_binop_done:;
           if (__pyx_t_9) {
 
-            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":629
+            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":601
  *                     elif m1 <= 2.0 and m2 <= 2.3:
  *                         # should have two H's, find the "first" of those
  *                         if strcmp(atomnames[b1].c_str(), atomnames[b2].c_str()) > 0:             # <<<<<<<<<<<<<<
  *                             b1 = b2
  *                     else:
  */
             __pyx_t_9 = (strcmp((__pyx_v_atomnames[__pyx_v_b1]).c_str(), (__pyx_v_atomnames[__pyx_v_b2]).c_str()) > 0);
             if (__pyx_t_9) {
 
-              /* "moleculekit/atomselect_utils/atomselect_utils.pyx":630
+              /* "moleculekit/atomselect_utils/atomselect_utils.pyx":602
  *                         # should have two H's, find the "first" of those
  *                         if strcmp(atomnames[b1].c_str(), atomnames[b2].c_str()) > 0:
  *                             b1 = b2             # <<<<<<<<<<<<<<
  *                     else:
  *                         # printf("Atomselect: sidechain: protein residue index %i, CA atom idx %i has sidechain-like atom (indices %i and %i) and we cannot determine which to call a sidechain. Taking a guess...\n", res, ca_idx, b1, b2)
  */
               __pyx_v_b1 = __pyx_v_b2;
 
-              /* "moleculekit/atomselect_utils/atomselect_utils.pyx":629
+              /* "moleculekit/atomselect_utils/atomselect_utils.pyx":601
  *                     elif m1 <= 2.0 and m2 <= 2.3:
  *                         # should have two H's, find the "first" of those
  *                         if strcmp(atomnames[b1].c_str(), atomnames[b2].c_str()) > 0:             # <<<<<<<<<<<<<<
  *                             b1 = b2
  *                     else:
  */
             }
 
-            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":627
+            /* "moleculekit/atomselect_utils/atomselect_utils.pyx":599
  *                     elif m2 > 2.3 and m1 <= 2.3:
  *                         b1 = b1
  *                     elif m1 <= 2.0 and m2 <= 2.3:             # <<<<<<<<<<<<<<
  *                         # should have two H's, find the "first" of those
  *                         if strcmp(atomnames[b1].c_str(), atomnames[b2].c_str()) > 0:
  */
             goto __pyx_L29;
           }
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":633
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":605
  *                     else:
  *                         # printf("Atomselect: sidechain: protein residue index %i, CA atom idx %i has sidechain-like atom (indices %i and %i) and we cannot determine which to call a sidechain. Taking a guess...\n", res, ca_idx, b1, b2)
  *                         if strcmp(atomnames[b1].c_str(), atomnames[b2].c_str()) > 0:             # <<<<<<<<<<<<<<
  *                             b1 = b2
  *             sidechain[b1] = 1
  */
           /*else*/ {
             __pyx_t_9 = (strcmp((__pyx_v_atomnames[__pyx_v_b1]).c_str(), (__pyx_v_atomnames[__pyx_v_b2]).c_str()) > 0);
             if (__pyx_t_9) {
 
-              /* "moleculekit/atomselect_utils/atomselect_utils.pyx":634
+              /* "moleculekit/atomselect_utils/atomselect_utils.pyx":606
  *                         # printf("Atomselect: sidechain: protein residue index %i, CA atom idx %i has sidechain-like atom (indices %i and %i) and we cannot determine which to call a sidechain. Taking a guess...\n", res, ca_idx, b1, b2)
  *                         if strcmp(atomnames[b1].c_str(), atomnames[b2].c_str()) > 0:
  *                             b1 = b2             # <<<<<<<<<<<<<<
  *             sidechain[b1] = 1
  * 
  */
               __pyx_v_b1 = __pyx_v_b2;
 
-              /* "moleculekit/atomselect_utils/atomselect_utils.pyx":633
+              /* "moleculekit/atomselect_utils/atomselect_utils.pyx":605
  *                     else:
  *                         # printf("Atomselect: sidechain: protein residue index %i, CA atom idx %i has sidechain-like atom (indices %i and %i) and we cannot determine which to call a sidechain. Taking a guess...\n", res, ca_idx, b1, b2)
  *                         if strcmp(atomnames[b1].c_str(), atomnames[b2].c_str()) > 0:             # <<<<<<<<<<<<<<
  *                             b1 = b2
  *             sidechain[b1] = 1
  */
             }
           }
           __pyx_L29:;
 
-          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":619
+          /* "moleculekit/atomselect_utils/atomselect_utils.pyx":591
  *                 elif c2 == 1 and c1 > 1:
  *                     b1 = b1
  *                 elif c1 == 1 and c2 == 1:             # <<<<<<<<<<<<<<
  *                     # check the masses
  *                     m1 = masses[b1]
  */
         }
         __pyx_L22:;
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":611
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":583
  *                 continue
  * 
  *             if b2 != -1: # Find the right one. Check number of atoms to see if they have a lone H             # <<<<<<<<<<<<<<
  *                 c1 = atom_bonds[b1].size()
  *                 c2 = atom_bonds[b2].size()
  */
       }
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":635
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":607
  *                         if strcmp(atomnames[b1].c_str(), atomnames[b2].c_str()) > 0:
  *                             b1 = b2
  *             sidechain[b1] = 1             # <<<<<<<<<<<<<<
  * 
  *     _find_sidechain_atoms(n_atoms, atom_bonds, protein_bb, nucleic_bb, sidechain)
  */
       __pyx_t_10 = __pyx_v_b1;
       *((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_sidechain.data + __pyx_t_10 * __pyx_v_sidechain.strides[0]) )) = 1;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":583
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":555
  * 
  *     for f in range(n_fragments):
  *         for res in pfragList[f]:             # <<<<<<<<<<<<<<
  * 
  *             ca_idx = -1
  */
       __pyx_L5_continue:;
     }
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":637
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":609
  *             sidechain[b1] = 1
  * 
  *     _find_sidechain_atoms(n_atoms, atom_bonds, protein_bb, nucleic_bb, sidechain)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_12 = __pyx_f_11moleculekit_16atomselect_utils__find_sidechain_atoms(__pyx_v_n_atoms, __pyx_v_atom_bonds, __pyx_v_protein_bb, __pyx_v_nucleic_bb, __pyx_v_sidechain); if (unlikely(__pyx_t_12 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 637, __pyx_L1_error)
+  __pyx_t_12 = __pyx_f_11moleculekit_16atomselect_utils__find_sidechain_atoms(__pyx_v_n_atoms, __pyx_v_atom_bonds, __pyx_v_protein_bb, __pyx_v_nucleic_bb, __pyx_v_sidechain); if (unlikely(__pyx_t_12 == ((bool)-1) && PyErr_Occurred())) __PYX_ERR(0, 609, __pyx_L1_error)
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":567
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":539
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef bool _atomsel_sidechain(             # <<<<<<<<<<<<<<
  *         vector[vector[int]] &residue_atoms,
  *         vector[vector[int]] &atom_bonds,
  */
 
@@ -26101,32 +25573,32 @@
   __pyx_L1_error:;
   __Pyx_AddTraceback("moleculekit.atomselect_utils._atomsel_sidechain", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "moleculekit/atomselect_utils/atomselect_utils.pyx":640
+/* "moleculekit/atomselect_utils/atomselect_utils.pyx":612
  * 
  * 
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def within_distance(
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11moleculekit_16atomselect_utils_5within_distance(PyObject *__pyx_self, 
+static PyObject *__pyx_pw_11moleculekit_16atomselect_utils_3within_distance(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ); /*proto*/
-static PyMethodDef __pyx_mdef_11moleculekit_16atomselect_utils_5within_distance = {"within_distance", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11moleculekit_16atomselect_utils_5within_distance, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_11moleculekit_16atomselect_utils_5within_distance(PyObject *__pyx_self, 
+static PyMethodDef __pyx_mdef_11moleculekit_16atomselect_utils_3within_distance = {"within_distance", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11moleculekit_16atomselect_utils_3within_distance, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11moleculekit_16atomselect_utils_3within_distance(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ) {
   __Pyx_memviewslice __pyx_v_coords = { 0, 0, { 0 }, { 0 }, { 0 } };
@@ -26177,91 +25649,91 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_coords)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 640, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 612, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_cutoff)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 640, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 612, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("within_distance", 1, 6, 6, 1); __PYX_ERR(0, 640, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("within_distance", 1, 6, 6, 1); __PYX_ERR(0, 612, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_source)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 640, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 612, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("within_distance", 1, 6, 6, 2); __PYX_ERR(0, 640, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("within_distance", 1, 6, 6, 2); __PYX_ERR(0, 612, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_source_min)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[3]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 640, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 612, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("within_distance", 1, 6, 6, 3); __PYX_ERR(0, 640, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("within_distance", 1, 6, 6, 3); __PYX_ERR(0, 612, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_source_max)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[4]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 640, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 612, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("within_distance", 1, 6, 6, 4); __PYX_ERR(0, 640, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("within_distance", 1, 6, 6, 4); __PYX_ERR(0, 612, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_mask)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[5]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 640, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 612, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("within_distance", 1, 6, 6, 5); __PYX_ERR(0, 640, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("within_distance", 1, 6, 6, 5); __PYX_ERR(0, 612, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "within_distance") < 0)) __PYX_ERR(0, 640, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "within_distance") < 0)) __PYX_ERR(0, 612, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 6)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
       values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
       values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
       values[4] = __Pyx_Arg_FASTCALL(__pyx_args, 4);
       values[5] = __Pyx_Arg_FASTCALL(__pyx_args, 5);
     }
-    __pyx_v_coords = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_11moleculekit_16atomselect_utils_FLOAT32_t(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_coords.memview)) __PYX_ERR(0, 643, __pyx_L3_error)
-    __pyx_v_cutoff = __pyx_PyFloat_AsFloat(values[1]); if (unlikely((__pyx_v_cutoff == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 644, __pyx_L3_error)
-    __pyx_v_source = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_source.memview)) __PYX_ERR(0, 645, __pyx_L3_error)
-    __pyx_v_source_min = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_FLOAT32_t(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_source_min.memview)) __PYX_ERR(0, 646, __pyx_L3_error)
-    __pyx_v_source_max = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_FLOAT32_t(values[4], PyBUF_WRITABLE); if (unlikely(!__pyx_v_source_max.memview)) __PYX_ERR(0, 647, __pyx_L3_error)
-    __pyx_v_mask = __Pyx_PyObject_to_MemoryviewSlice_ds_nn_bool(values[5], PyBUF_WRITABLE); if (unlikely(!__pyx_v_mask.memview)) __PYX_ERR(0, 648, __pyx_L3_error)
+    __pyx_v_coords = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_11moleculekit_16atomselect_utils_FLOAT32_t(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_coords.memview)) __PYX_ERR(0, 615, __pyx_L3_error)
+    __pyx_v_cutoff = __pyx_PyFloat_AsFloat(values[1]); if (unlikely((__pyx_v_cutoff == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 616, __pyx_L3_error)
+    __pyx_v_source = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_source.memview)) __PYX_ERR(0, 617, __pyx_L3_error)
+    __pyx_v_source_min = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_FLOAT32_t(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_source_min.memview)) __PYX_ERR(0, 618, __pyx_L3_error)
+    __pyx_v_source_max = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_FLOAT32_t(values[4], PyBUF_WRITABLE); if (unlikely(!__pyx_v_source_max.memview)) __PYX_ERR(0, 619, __pyx_L3_error)
+    __pyx_v_mask = __Pyx_PyObject_to_MemoryviewSlice_ds_nn_bool(values[5], PyBUF_WRITABLE); if (unlikely(!__pyx_v_mask.memview)) __PYX_ERR(0, 620, __pyx_L3_error)
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("within_distance", 1, 6, 6, __pyx_nargs); __PYX_ERR(0, 640, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("within_distance", 1, 6, 6, __pyx_nargs); __PYX_ERR(0, 612, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -26272,15 +25744,15 @@
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_source_min, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_source_max, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_mask, 1);
   __Pyx_AddTraceback("moleculekit.atomselect_utils.within_distance", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11moleculekit_16atomselect_utils_4within_distance(__pyx_self, __pyx_v_coords, __pyx_v_cutoff, __pyx_v_source, __pyx_v_source_min, __pyx_v_source_max, __pyx_v_mask);
+  __pyx_r = __pyx_pf_11moleculekit_16atomselect_utils_2within_distance(__pyx_self, __pyx_v_coords, __pyx_v_cutoff, __pyx_v_source, __pyx_v_source_min, __pyx_v_source_max, __pyx_v_mask);
 
   /* function exit code */
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_coords, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_source, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_source_min, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_source_max, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_mask, 1);
@@ -26290,15 +25762,15 @@
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11moleculekit_16atomselect_utils_4within_distance(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_coords, float __pyx_v_cutoff, __Pyx_memviewslice __pyx_v_source, __Pyx_memviewslice __pyx_v_source_min, __Pyx_memviewslice __pyx_v_source_max, __Pyx_memviewslice __pyx_v_mask) {
+static PyObject *__pyx_pf_11moleculekit_16atomselect_utils_2within_distance(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_coords, float __pyx_v_cutoff, __Pyx_memviewslice __pyx_v_source, __Pyx_memviewslice __pyx_v_source_min, __Pyx_memviewslice __pyx_v_source_max, __Pyx_memviewslice __pyx_v_mask) {
   int __pyx_v_n_atoms;
   int __pyx_v_n_source;
   bool __pyx_v_close_enough;
   int __pyx_v_i;
   int __pyx_v_j;
   int __pyx_v_k;
   __pyx_t_11moleculekit_16atomselect_utils_FLOAT32_t __pyx_v_diff;
@@ -26316,270 +25788,270 @@
   int __pyx_t_9;
   int __pyx_t_10;
   int __pyx_t_11;
   size_t __pyx_t_12;
   Py_ssize_t __pyx_t_13;
   __Pyx_RefNannySetupContext("within_distance", 1);
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":651
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":623
  *     ):
  *     # TODO: Improve with neighbour list / cell list implementation
  *     cdef int n_atoms = coords.shape[0]             # <<<<<<<<<<<<<<
  *     cdef int n_source = source.shape[0]
  *     cdef bool close_enough
  */
   __pyx_v_n_atoms = (__pyx_v_coords.shape[0]);
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":652
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":624
  *     # TODO: Improve with neighbour list / cell list implementation
  *     cdef int n_atoms = coords.shape[0]
  *     cdef int n_source = source.shape[0]             # <<<<<<<<<<<<<<
  *     cdef bool close_enough
  *     cdef int i, j, k
  */
   __pyx_v_n_source = (__pyx_v_source.shape[0]);
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":657
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":629
  *     cdef FLOAT32_t diff, sq_cutoff
  * 
  *     sq_cutoff = cutoff * cutoff             # <<<<<<<<<<<<<<
  * 
  *     for i in range(n_atoms):
  */
   __pyx_v_sq_cutoff = (__pyx_v_cutoff * __pyx_v_cutoff);
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":659
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":631
  *     sq_cutoff = cutoff * cutoff
  * 
  *     for i in range(n_atoms):             # <<<<<<<<<<<<<<
  *         # Trivial check if it's too far from all source atoms
  *         close_enough = False
  */
   __pyx_t_1 = __pyx_v_n_atoms;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":661
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":633
  *     for i in range(n_atoms):
  *         # Trivial check if it's too far from all source atoms
  *         close_enough = False             # <<<<<<<<<<<<<<
  *         for k in range(3):
  *             if coords[i, k] >= (source_min[k] - cutoff):
  */
     __pyx_v_close_enough = 0;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":662
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":634
  *         # Trivial check if it's too far from all source atoms
  *         close_enough = False
  *         for k in range(3):             # <<<<<<<<<<<<<<
  *             if coords[i, k] >= (source_min[k] - cutoff):
  *                 close_enough = True
  */
     for (__pyx_t_4 = 0; __pyx_t_4 < 3; __pyx_t_4+=1) {
       __pyx_v_k = __pyx_t_4;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":663
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":635
  *         close_enough = False
  *         for k in range(3):
  *             if coords[i, k] >= (source_min[k] - cutoff):             # <<<<<<<<<<<<<<
  *                 close_enough = True
  *                 break
  */
       __pyx_t_5 = __pyx_v_i;
       __pyx_t_6 = __pyx_v_k;
       __pyx_t_7 = __pyx_v_k;
       __pyx_t_8 = ((*((__pyx_t_11moleculekit_16atomselect_utils_FLOAT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_5 * __pyx_v_coords.strides[0]) ) + __pyx_t_6 * __pyx_v_coords.strides[1]) ))) >= ((*((__pyx_t_11moleculekit_16atomselect_utils_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_source_min.data + __pyx_t_7 * __pyx_v_source_min.strides[0]) ))) - __pyx_v_cutoff));
       if (__pyx_t_8) {
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":664
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":636
  *         for k in range(3):
  *             if coords[i, k] >= (source_min[k] - cutoff):
  *                 close_enough = True             # <<<<<<<<<<<<<<
  *                 break
  *             if coords[i, k] <= (source_max[k] + cutoff):
  */
         __pyx_v_close_enough = 1;
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":665
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":637
  *             if coords[i, k] >= (source_min[k] - cutoff):
  *                 close_enough = True
  *                 break             # <<<<<<<<<<<<<<
  *             if coords[i, k] <= (source_max[k] + cutoff):
  *                 close_enough = True
  */
         goto __pyx_L6_break;
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":663
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":635
  *         close_enough = False
  *         for k in range(3):
  *             if coords[i, k] >= (source_min[k] - cutoff):             # <<<<<<<<<<<<<<
  *                 close_enough = True
  *                 break
  */
       }
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":666
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":638
  *                 close_enough = True
  *                 break
  *             if coords[i, k] <= (source_max[k] + cutoff):             # <<<<<<<<<<<<<<
  *                 close_enough = True
  *                 break
  */
       __pyx_t_7 = __pyx_v_i;
       __pyx_t_6 = __pyx_v_k;
       __pyx_t_5 = __pyx_v_k;
       __pyx_t_8 = ((*((__pyx_t_11moleculekit_16atomselect_utils_FLOAT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_7 * __pyx_v_coords.strides[0]) ) + __pyx_t_6 * __pyx_v_coords.strides[1]) ))) <= ((*((__pyx_t_11moleculekit_16atomselect_utils_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_source_max.data + __pyx_t_5 * __pyx_v_source_max.strides[0]) ))) + __pyx_v_cutoff));
       if (__pyx_t_8) {
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":667
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":639
  *                 break
  *             if coords[i, k] <= (source_max[k] + cutoff):
  *                 close_enough = True             # <<<<<<<<<<<<<<
  *                 break
  * 
  */
         __pyx_v_close_enough = 1;
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":668
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":640
  *             if coords[i, k] <= (source_max[k] + cutoff):
  *                 close_enough = True
  *                 break             # <<<<<<<<<<<<<<
  * 
  *         if not close_enough:
  */
         goto __pyx_L6_break;
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":666
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":638
  *                 close_enough = True
  *                 break
  *             if coords[i, k] <= (source_max[k] + cutoff):             # <<<<<<<<<<<<<<
  *                 close_enough = True
  *                 break
  */
       }
     }
     __pyx_L6_break:;
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":670
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":642
  *                 break
  * 
  *         if not close_enough:             # <<<<<<<<<<<<<<
  *             continue
  * 
  */
     __pyx_t_8 = (!(__pyx_v_close_enough != 0));
     if (__pyx_t_8) {
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":671
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":643
  * 
  *         if not close_enough:
  *             continue             # <<<<<<<<<<<<<<
  * 
  *         for j in range(n_source):
  */
       goto __pyx_L3_continue;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":670
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":642
  *                 break
  * 
  *         if not close_enough:             # <<<<<<<<<<<<<<
  *             continue
  * 
  */
     }
 
-    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":673
+    /* "moleculekit/atomselect_utils/atomselect_utils.pyx":645
  *             continue
  * 
  *         for j in range(n_source):             # <<<<<<<<<<<<<<
  *             diff = 0
  *             for k in range(3):
  */
     __pyx_t_4 = __pyx_v_n_source;
     __pyx_t_9 = __pyx_t_4;
     for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
       __pyx_v_j = __pyx_t_10;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":674
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":646
  * 
  *         for j in range(n_source):
  *             diff = 0             # <<<<<<<<<<<<<<
  *             for k in range(3):
  *                 diff += (coords[i, k] - coords[source[j], k]) ** 2
  */
       __pyx_v_diff = 0.0;
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":675
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":647
  *         for j in range(n_source):
  *             diff = 0
  *             for k in range(3):             # <<<<<<<<<<<<<<
  *                 diff += (coords[i, k] - coords[source[j], k]) ** 2
  *             if diff < sq_cutoff:
  */
       for (__pyx_t_11 = 0; __pyx_t_11 < 3; __pyx_t_11+=1) {
         __pyx_v_k = __pyx_t_11;
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":676
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":648
  *             diff = 0
  *             for k in range(3):
  *                 diff += (coords[i, k] - coords[source[j], k]) ** 2             # <<<<<<<<<<<<<<
  *             if diff < sq_cutoff:
  *                 mask[i] = True
  */
         __pyx_t_5 = __pyx_v_i;
         __pyx_t_6 = __pyx_v_k;
         __pyx_t_7 = __pyx_v_j;
         __pyx_t_12 = (*((__pyx_t_11moleculekit_16atomselect_utils_UINT32_t *) ( /* dim=0 */ (__pyx_v_source.data + __pyx_t_7 * __pyx_v_source.strides[0]) )));
         __pyx_t_13 = __pyx_v_k;
         __pyx_v_diff = (__pyx_v_diff + powf(((*((__pyx_t_11moleculekit_16atomselect_utils_FLOAT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_5 * __pyx_v_coords.strides[0]) ) + __pyx_t_6 * __pyx_v_coords.strides[1]) ))) - (*((__pyx_t_11moleculekit_16atomselect_utils_FLOAT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_12 * __pyx_v_coords.strides[0]) ) + __pyx_t_13 * __pyx_v_coords.strides[1]) )))), 2.0));
       }
 
-      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":677
+      /* "moleculekit/atomselect_utils/atomselect_utils.pyx":649
  *             for k in range(3):
  *                 diff += (coords[i, k] - coords[source[j], k]) ** 2
  *             if diff < sq_cutoff:             # <<<<<<<<<<<<<<
  *                 mask[i] = True
  *                 break
  */
       __pyx_t_8 = (__pyx_v_diff < __pyx_v_sq_cutoff);
       if (__pyx_t_8) {
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":678
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":650
  *                 diff += (coords[i, k] - coords[source[j], k]) ** 2
  *             if diff < sq_cutoff:
  *                 mask[i] = True             # <<<<<<<<<<<<<<
  *                 break
  * 
  */
         __pyx_t_7 = __pyx_v_i;
         *((bool *) ( /* dim=0 */ (__pyx_v_mask.data + __pyx_t_7 * __pyx_v_mask.strides[0]) )) = 1;
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":679
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":651
  *             if diff < sq_cutoff:
  *                 mask[i] = True
  *                 break             # <<<<<<<<<<<<<<
  * 
  */
         goto __pyx_L11_break;
 
-        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":677
+        /* "moleculekit/atomselect_utils/atomselect_utils.pyx":649
  *             for k in range(3):
  *                 diff += (coords[i, k] - coords[source[j], k]) ** 2
  *             if diff < sq_cutoff:             # <<<<<<<<<<<<<<
  *                 mask[i] = True
  *                 break
  */
       }
     }
     __pyx_L11_break:;
     __pyx_L3_continue:;
   }
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":640
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":612
  * 
  * 
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def within_distance(
  */
 
@@ -27587,15 +27059,15 @@
     {&__pyx_kp_s_Step_may_not_be_zero_axis_d, __pyx_k_Step_may_not_be_zero_axis_d, sizeof(__pyx_k_Step_may_not_be_zero_axis_d), 0, 0, 1, 0},
     {&__pyx_n_s_TypeError, __pyx_k_TypeError, sizeof(__pyx_k_TypeError), 0, 0, 1, 1},
     {&__pyx_n_s_UINT32, __pyx_k_UINT32, sizeof(__pyx_k_UINT32), 0, 0, 1, 1},
     {&__pyx_kp_s_Unable_to_convert_item_to_object, __pyx_k_Unable_to_convert_item_to_object, sizeof(__pyx_k_Unable_to_convert_item_to_object), 0, 0, 1, 0},
     {&__pyx_n_s_ValueError, __pyx_k_ValueError, sizeof(__pyx_k_ValueError), 0, 0, 1, 1},
     {&__pyx_n_s_View_MemoryView, __pyx_k_View_MemoryView, sizeof(__pyx_k_View_MemoryView), 0, 0, 1, 1},
     {&__pyx_kp_u__2, __pyx_k__2, sizeof(__pyx_k__2), 0, 1, 0, 0},
-    {&__pyx_n_s__28, __pyx_k__28, sizeof(__pyx_k__28), 0, 0, 1, 1},
+    {&__pyx_n_s__26, __pyx_k__26, sizeof(__pyx_k__26), 0, 0, 1, 1},
     {&__pyx_n_s__3, __pyx_k__3, sizeof(__pyx_k__3), 0, 0, 1, 1},
     {&__pyx_kp_u__6, __pyx_k__6, sizeof(__pyx_k__6), 0, 1, 0, 0},
     {&__pyx_kp_u__7, __pyx_k__7, sizeof(__pyx_k__7), 0, 1, 0, 0},
     {&__pyx_n_s_abc, __pyx_k_abc, sizeof(__pyx_k_abc), 0, 0, 1, 1},
     {&__pyx_n_s_allocate_buffer, __pyx_k_allocate_buffer, sizeof(__pyx_k_allocate_buffer), 0, 0, 1, 1},
     {&__pyx_n_s_analyze_molecule, __pyx_k_analyze_molecule, sizeof(__pyx_k_analyze_molecule), 0, 0, 1, 1},
     {&__pyx_kp_u_and, __pyx_k_and, sizeof(__pyx_k_and), 0, 1, 0, 0},
@@ -27635,20 +27107,17 @@
     {&__pyx_n_s_float32, __pyx_k_float32, sizeof(__pyx_k_float32), 0, 0, 1, 1},
     {&__pyx_n_s_float64, __pyx_k_float64, sizeof(__pyx_k_float64), 0, 0, 1, 1},
     {&__pyx_n_s_format, __pyx_k_format, sizeof(__pyx_k_format), 0, 0, 1, 1},
     {&__pyx_n_s_fortran, __pyx_k_fortran, sizeof(__pyx_k_fortran), 0, 0, 1, 1},
     {&__pyx_n_u_fortran, __pyx_k_fortran, sizeof(__pyx_k_fortran), 0, 1, 0, 1},
     {&__pyx_n_s_fragments, __pyx_k_fragments, sizeof(__pyx_k_fragments), 0, 0, 1, 1},
     {&__pyx_kp_u_gc, __pyx_k_gc, sizeof(__pyx_k_gc), 0, 1, 0, 0},
-    {&__pyx_n_s_get_bonded_groups, __pyx_k_get_bonded_groups, sizeof(__pyx_k_get_bonded_groups), 0, 0, 1, 1},
     {&__pyx_n_s_getstate, __pyx_k_getstate, sizeof(__pyx_k_getstate), 0, 0, 1, 1},
     {&__pyx_kp_u_got, __pyx_k_got, sizeof(__pyx_k_got), 0, 1, 0, 0},
     {&__pyx_kp_u_got_differing_extents_in_dimensi, __pyx_k_got_differing_extents_in_dimensi, sizeof(__pyx_k_got_differing_extents_in_dimensi), 0, 1, 0, 0},
-    {&__pyx_n_s_group, __pyx_k_group, sizeof(__pyx_k_group), 0, 0, 1, 1},
-    {&__pyx_n_s_has_lower_bond, __pyx_k_has_lower_bond, sizeof(__pyx_k_has_lower_bond), 0, 0, 1, 1},
     {&__pyx_n_s_i, __pyx_k_i, sizeof(__pyx_k_i), 0, 0, 1, 1},
     {&__pyx_n_s_id, __pyx_k_id, sizeof(__pyx_k_id), 0, 0, 1, 1},
     {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
     {&__pyx_n_s_index, __pyx_k_index, sizeof(__pyx_k_index), 0, 0, 1, 1},
     {&__pyx_n_s_initializing, __pyx_k_initializing, sizeof(__pyx_k_initializing), 0, 0, 1, 1},
     {&__pyx_n_s_insertion, __pyx_k_insertion, sizeof(__pyx_k_insertion), 0, 0, 1, 1},
     {&__pyx_n_s_int64, __pyx_k_int64, sizeof(__pyx_k_int64), 0, 0, 1, 1},
@@ -27663,15 +27132,14 @@
     {&__pyx_n_s_masses, __pyx_k_masses, sizeof(__pyx_k_masses), 0, 0, 1, 1},
     {&__pyx_n_s_math, __pyx_k_math, sizeof(__pyx_k_math), 0, 0, 1, 1},
     {&__pyx_n_s_memview, __pyx_k_memview, sizeof(__pyx_k_memview), 0, 0, 1, 1},
     {&__pyx_n_s_mode, __pyx_k_mode, sizeof(__pyx_k_mode), 0, 0, 1, 1},
     {&__pyx_n_s_moleculekit_atomselect_utils, __pyx_k_moleculekit_atomselect_utils, sizeof(__pyx_k_moleculekit_atomselect_utils), 0, 0, 1, 1},
     {&__pyx_kp_s_moleculekit_atomselect_utils_ato, __pyx_k_moleculekit_atomselect_utils_ato, sizeof(__pyx_k_moleculekit_atomselect_utils_ato), 0, 0, 1, 0},
     {&__pyx_n_s_n_atoms, __pyx_k_n_atoms, sizeof(__pyx_k_n_atoms), 0, 0, 1, 1},
-    {&__pyx_n_s_n_bonds, __pyx_k_n_bonds, sizeof(__pyx_k_n_bonds), 0, 0, 1, 1},
     {&__pyx_n_s_n_residues, __pyx_k_n_residues, sizeof(__pyx_k_n_residues), 0, 0, 1, 1},
     {&__pyx_n_s_n_source, __pyx_k_n_source, sizeof(__pyx_k_n_source), 0, 0, 1, 1},
     {&__pyx_n_s_name, __pyx_k_name, sizeof(__pyx_k_name), 0, 0, 1, 1},
     {&__pyx_n_s_name_2, __pyx_k_name_2, sizeof(__pyx_k_name_2), 0, 0, 1, 1},
     {&__pyx_n_s_ndim, __pyx_k_ndim, sizeof(__pyx_k_ndim), 0, 0, 1, 1},
     {&__pyx_n_s_new, __pyx_k_new, sizeof(__pyx_k_new), 0, 0, 1, 1},
     {&__pyx_n_s_nfragList, __pyx_k_nfragList, sizeof(__pyx_k_nfragList), 0, 0, 1, 1},
@@ -27699,15 +27167,14 @@
     {&__pyx_n_s_reduce, __pyx_k_reduce, sizeof(__pyx_k_reduce), 0, 0, 1, 1},
     {&__pyx_n_s_reduce_cython, __pyx_k_reduce_cython, sizeof(__pyx_k_reduce_cython), 0, 0, 1, 1},
     {&__pyx_n_s_reduce_ex, __pyx_k_reduce_ex, sizeof(__pyx_k_reduce_ex), 0, 0, 1, 1},
     {&__pyx_n_s_register, __pyx_k_register, sizeof(__pyx_k_register), 0, 0, 1, 1},
     {&__pyx_n_s_res_flgs, __pyx_k_res_flgs, sizeof(__pyx_k_res_flgs), 0, 0, 1, 1},
     {&__pyx_n_s_resid, __pyx_k_resid, sizeof(__pyx_k_resid), 0, 0, 1, 1},
     {&__pyx_n_s_residue_atoms, __pyx_k_residue_atoms, sizeof(__pyx_k_residue_atoms), 0, 0, 1, 1},
-    {&__pyx_n_s_results, __pyx_k_results, sizeof(__pyx_k_results), 0, 0, 1, 1},
     {&__pyx_n_s_seg_id, __pyx_k_seg_id, sizeof(__pyx_k_seg_id), 0, 0, 1, 1},
     {&__pyx_n_s_setstate, __pyx_k_setstate, sizeof(__pyx_k_setstate), 0, 0, 1, 1},
     {&__pyx_n_s_setstate_cython, __pyx_k_setstate_cython, sizeof(__pyx_k_setstate_cython), 0, 0, 1, 1},
     {&__pyx_n_s_shape, __pyx_k_shape, sizeof(__pyx_k_shape), 0, 0, 1, 1},
     {&__pyx_n_s_sidechain, __pyx_k_sidechain, sizeof(__pyx_k_sidechain), 0, 0, 1, 1},
     {&__pyx_n_s_size, __pyx_k_size, sizeof(__pyx_k_size), 0, 0, 1, 1},
     {&__pyx_n_s_source, __pyx_k_source, sizeof(__pyx_k_source), 0, 0, 1, 1},
@@ -27737,18 +27204,18 @@
     {&__pyx_n_s_zeros, __pyx_k_zeros, sizeof(__pyx_k_zeros), 0, 0, 1, 1},
     {0, 0, 0, 0, 0, 0, 0}
   };
   return __Pyx_InitStrings(__pyx_string_tab);
 }
 /* #### Code section: cached_builtins ### */
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 49, __pyx_L1_error)
-  __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(1, 68, __pyx_L1_error)
+  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 57, __pyx_L1_error)
   __pyx_builtin___import__ = __Pyx_GetBuiltinName(__pyx_n_s_import); if (!__pyx_builtin___import__) __PYX_ERR(1, 100, __pyx_L1_error)
   __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(1, 141, __pyx_L1_error)
+  __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(1, 156, __pyx_L1_error)
   __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(1, 159, __pyx_L1_error)
   __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(1, 2, __pyx_L1_error)
   __pyx_builtin_AssertionError = __Pyx_GetBuiltinName(__pyx_n_s_AssertionError); if (!__pyx_builtin_AssertionError) __PYX_ERR(1, 373, __pyx_L1_error)
   __pyx_builtin_Ellipsis = __Pyx_GetBuiltinName(__pyx_n_s_Ellipsis); if (!__pyx_builtin_Ellipsis) __PYX_ERR(1, 408, __pyx_L1_error)
   __pyx_builtin_id = __Pyx_GetBuiltinName(__pyx_n_s_id); if (!__pyx_builtin_id) __PYX_ERR(1, 618, __pyx_L1_error)
   __pyx_builtin_IndexError = __Pyx_GetBuiltinName(__pyx_n_s_IndexError); if (!__pyx_builtin_IndexError) __PYX_ERR(1, 914, __pyx_L1_error)
   __pyx_builtin_ImportError = __Pyx_GetBuiltinName(__pyx_n_s_ImportError); if (!__pyx_builtin_ImportError) __PYX_ERR(2, 983, __pyx_L1_error)
@@ -27794,26 +27261,26 @@
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError, "Incompatible checksums (0x%x vs (0x82a3537, 0x6ae9995, 0xb068931) = (name))" % __pyx_checksum
  */
   __pyx_tuple__8 = PyTuple_Pack(3, __pyx_int_136983863, __pyx_int_112105877, __pyx_int_184977713); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__8);
   __Pyx_GIVEREF(__pyx_tuple__8);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(2, 983, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__9);
   __Pyx_GIVEREF(__pyx_tuple__9);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(2, 989, __pyx_L1_error)
@@ -27917,49 +27384,37 @@
  *     cdef object __pyx_result
  */
   __pyx_tuple__20 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__20);
   __Pyx_GIVEREF(__pyx_tuple__20);
   __pyx_codeobj__21 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__20, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__21)) __PYX_ERR(1, 1, __pyx_L1_error)
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":36
- * 
- * 
- * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
- * @cython.wraparound(False)  # turn off negative index wrapping for entire function
- * def get_bonded_groups(
- */
-  __pyx_tuple__22 = PyTuple_Pack(9, __pyx_n_s_bonds, __pyx_n_s_has_lower_bond, __pyx_n_s_n_atoms, __pyx_n_s_group, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_n_bonds, __pyx_n_s_results); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 36, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__22);
-  __Pyx_GIVEREF(__pyx_tuple__22);
-  __pyx_codeobj__23 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__22, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_moleculekit_atomselect_utils_ato, __pyx_n_s_get_bonded_groups, 36, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__23)) __PYX_ERR(0, 36, __pyx_L1_error)
-
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":477
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":449
  *             nucleic_bb[i] = False
  * 
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def analyze_molecule(
  */
-  __pyx_tuple__24 = PyTuple_Pack(23, __pyx_n_s_n_atoms, __pyx_n_s_bonds, __pyx_n_s_resid, __pyx_n_s_insertion, __pyx_n_s_chain_id, __pyx_n_s_seg_id, __pyx_n_s_protein, __pyx_n_s_nucleic, __pyx_n_s_protein_bb, __pyx_n_s_nucleic_bb, __pyx_n_s_uq_resid, __pyx_n_s_fragments, __pyx_n_s_masses, __pyx_n_s_sidechain, __pyx_n_s_atomnames, __pyx_n_s_flgs, __pyx_n_s_atom_bonds, __pyx_n_s_residue_atoms, __pyx_n_s_pfragList, __pyx_n_s_nfragList, __pyx_n_s_n_residues, __pyx_n_s_atm_flgs, __pyx_n_s_res_flgs); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 477, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__24);
-  __Pyx_GIVEREF(__pyx_tuple__24);
-  __pyx_codeobj__25 = (PyObject*)__Pyx_PyCode_New(15, 0, 0, 23, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__24, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_moleculekit_atomselect_utils_ato, __pyx_n_s_analyze_molecule, 477, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__25)) __PYX_ERR(0, 477, __pyx_L1_error)
+  __pyx_tuple__22 = PyTuple_Pack(23, __pyx_n_s_n_atoms, __pyx_n_s_bonds, __pyx_n_s_resid, __pyx_n_s_insertion, __pyx_n_s_chain_id, __pyx_n_s_seg_id, __pyx_n_s_protein, __pyx_n_s_nucleic, __pyx_n_s_protein_bb, __pyx_n_s_nucleic_bb, __pyx_n_s_uq_resid, __pyx_n_s_fragments, __pyx_n_s_masses, __pyx_n_s_sidechain, __pyx_n_s_atomnames, __pyx_n_s_flgs, __pyx_n_s_atom_bonds, __pyx_n_s_residue_atoms, __pyx_n_s_pfragList, __pyx_n_s_nfragList, __pyx_n_s_n_residues, __pyx_n_s_atm_flgs, __pyx_n_s_res_flgs); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 449, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__22);
+  __Pyx_GIVEREF(__pyx_tuple__22);
+  __pyx_codeobj__23 = (PyObject*)__Pyx_PyCode_New(15, 0, 0, 23, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__22, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_moleculekit_atomselect_utils_ato, __pyx_n_s_analyze_molecule, 449, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__23)) __PYX_ERR(0, 449, __pyx_L1_error)
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":640
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":612
  * 
  * 
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def within_distance(
  */
-  __pyx_tuple__26 = PyTuple_Pack(14, __pyx_n_s_coords, __pyx_n_s_cutoff, __pyx_n_s_source, __pyx_n_s_source_min, __pyx_n_s_source_max, __pyx_n_s_mask, __pyx_n_s_n_atoms, __pyx_n_s_n_source, __pyx_n_s_close_enough, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_diff, __pyx_n_s_sq_cutoff); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 640, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__26);
-  __Pyx_GIVEREF(__pyx_tuple__26);
-  __pyx_codeobj__27 = (PyObject*)__Pyx_PyCode_New(6, 0, 0, 14, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__26, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_moleculekit_atomselect_utils_ato, __pyx_n_s_within_distance, 640, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__27)) __PYX_ERR(0, 640, __pyx_L1_error)
+  __pyx_tuple__24 = PyTuple_Pack(14, __pyx_n_s_coords, __pyx_n_s_cutoff, __pyx_n_s_source, __pyx_n_s_source_min, __pyx_n_s_source_max, __pyx_n_s_mask, __pyx_n_s_n_atoms, __pyx_n_s_n_source, __pyx_n_s_close_enough, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_diff, __pyx_n_s_sq_cutoff); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 612, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__24);
+  __Pyx_GIVEREF(__pyx_tuple__24);
+  __pyx_codeobj__25 = (PyObject*)__Pyx_PyCode_New(6, 0, 0, 14, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__24, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_moleculekit_atomselect_utils_ato, __pyx_n_s_within_distance, 612, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__25)) __PYX_ERR(0, 612, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 /* #### Code section: init_constants ### */
@@ -29176,48 +28631,36 @@
   __Pyx_GOTREF(__pyx_t_7);
   __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 23, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_FLOAT64, __pyx_t_4) < 0) __PYX_ERR(0, 23, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":36
- * 
- * 
- * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
- * @cython.wraparound(False)  # turn off negative index wrapping for entire function
- * def get_bonded_groups(
- */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11moleculekit_16atomselect_utils_1get_bonded_groups, 0, __pyx_n_s_get_bonded_groups, NULL, __pyx_n_s_moleculekit_atomselect_utils, __pyx_d, ((PyObject *)__pyx_codeobj__23)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 36, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_bonded_groups, __pyx_t_4) < 0) __PYX_ERR(0, 36, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":477
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":449
  *             nucleic_bb[i] = False
  * 
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def analyze_molecule(
  */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11moleculekit_16atomselect_utils_3analyze_molecule, 0, __pyx_n_s_analyze_molecule, NULL, __pyx_n_s_moleculekit_atomselect_utils, __pyx_d, ((PyObject *)__pyx_codeobj__25)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 477, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11moleculekit_16atomselect_utils_1analyze_molecule, 0, __pyx_n_s_analyze_molecule, NULL, __pyx_n_s_moleculekit_atomselect_utils, __pyx_d, ((PyObject *)__pyx_codeobj__23)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 449, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_analyze_molecule, __pyx_t_4) < 0) __PYX_ERR(0, 477, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_analyze_molecule, __pyx_t_4) < 0) __PYX_ERR(0, 449, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":640
+  /* "moleculekit/atomselect_utils/atomselect_utils.pyx":612
  * 
  * 
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def within_distance(
  */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11moleculekit_16atomselect_utils_5within_distance, 0, __pyx_n_s_within_distance, NULL, __pyx_n_s_moleculekit_atomselect_utils, __pyx_d, ((PyObject *)__pyx_codeobj__27)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 640, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11moleculekit_16atomselect_utils_3within_distance, 0, __pyx_n_s_within_distance, NULL, __pyx_n_s_moleculekit_atomselect_utils, __pyx_d, ((PyObject *)__pyx_codeobj__25)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 612, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_within_distance, __pyx_t_4) < 0) __PYX_ERR(0, 640, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_within_distance, __pyx_t_4) < 0) __PYX_ERR(0, 612, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
   /* "moleculekit/atomselect_utils/atomselect_utils.pyx":1
  * # cython: cdivision=True             # <<<<<<<<<<<<<<
  * 
  * import numpy as np
  */
@@ -33990,14 +33433,36 @@
 {
     void *start1, *end1, *start2, *end2;
     __pyx_get_array_memory_extents(slice1, &start1, &end1, ndim, itemsize);
     __pyx_get_array_memory_extents(slice2, &start2, &end2, ndim, itemsize);
     return (start1 < end2) && (start2 < end1);
 }
 
+/* CIntFromPyVerify */
+#define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)\
+    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 0)
+#define __PYX_VERIFY_RETURN_INT_EXC(target_type, func_type, func_value)\
+    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 1)
+#define __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, exc)\
+    {\
+        func_type value = func_value;\
+        if (sizeof(target_type) < sizeof(func_type)) {\
+            if (unlikely(value != (func_type) (target_type) value)) {\
+                func_type zero = 0;\
+                if (exc && unlikely(value == (func_type)-1 && PyErr_Occurred()))\
+                    return (target_type) -1;\
+                if (is_unsigned && unlikely(value < zero))\
+                    goto raise_neg_overflow;\
+                else\
+                    goto raise_overflow;\
+            }\
+        }\
+        return (target_type) value;\
+    }
+
 /* IsLittleEndian */
 static CYTHON_INLINE int __Pyx_Is_Little_Endian(void)
 {
   union {
     uint32_t u32;
     uint8_t u8[4];
   } S;
@@ -34758,71 +34223,49 @@
 __pyx_fail:
     result.memview = NULL;
     result.data = NULL;
     return result;
 }
 
 /* ObjectToMemviewSlice */
-  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(PyObject *obj, int writable_flag) {
+  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_INT64_t(PyObject *obj, int writable_flag) {
     __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
     __Pyx_BufFmt_StackElem stack[1];
     int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
     int retcode;
     if (obj == Py_None) {
         result.memview = (struct __pyx_memoryview_obj *) Py_None;
         return result;
     }
     retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
                                                  PyBUF_RECORDS_RO | writable_flag, 1,
-                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t, stack,
+                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_16atomselect_utils_INT64_t, stack,
                                                  &result, obj);
     if (unlikely(retcode == -1))
         goto __pyx_fail;
     return result;
 __pyx_fail:
     result.memview = NULL;
     result.data = NULL;
     return result;
 }
 
-/* CIntFromPyVerify */
-  #define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)\
-    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 0)
-#define __PYX_VERIFY_RETURN_INT_EXC(target_type, func_type, func_value)\
-    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 1)
-#define __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, exc)\
-    {\
-        func_type value = func_value;\
-        if (sizeof(target_type) < sizeof(func_type)) {\
-            if (unlikely(value != (func_type) (target_type) value)) {\
-                func_type zero = 0;\
-                if (exc && unlikely(value == (func_type)-1 && PyErr_Occurred()))\
-                    return (target_type) -1;\
-                if (is_unsigned && unlikely(value < zero))\
-                    goto raise_neg_overflow;\
-                else\
-                    goto raise_overflow;\
-            }\
-        }\
-        return (target_type) value;\
-    }
-
 /* ObjectToMemviewSlice */
-  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_INT64_t(PyObject *obj, int writable_flag) {
+  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t(PyObject *obj, int writable_flag) {
     __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
     __Pyx_BufFmt_StackElem stack[1];
     int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
     int retcode;
     if (obj == Py_None) {
         result.memview = (struct __pyx_memoryview_obj *) Py_None;
         return result;
     }
     retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
                                                  PyBUF_RECORDS_RO | writable_flag, 1,
-                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_16atomselect_utils_INT64_t, stack,
+                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_16atomselect_utils_UINT32_t, stack,
                                                  &result, obj);
     if (unlikely(retcode == -1))
         goto __pyx_fail;
     return result;
 __pyx_fail:
     result.memview = NULL;
     result.data = NULL;
@@ -36361,15 +35804,15 @@
 __Pyx_PyType_GetName(PyTypeObject* tp)
 {
     PyObject *name = __Pyx_PyObject_GetAttrStr((PyObject *)tp,
                                                __pyx_n_s_name_2);
     if (unlikely(name == NULL) || unlikely(!PyUnicode_Check(name))) {
         PyErr_Clear();
         Py_XDECREF(name);
-        name = __Pyx_NewRef(__pyx_n_s__28);
+        name = __Pyx_NewRef(__pyx_n_s__26);
     }
     return name;
 }
 #endif
 
 /* CheckBinaryVersion */
   static unsigned long __Pyx_get_runtime_version(void) {
```

### Comparing `moleculekit-1.8.6/moleculekit/atomselect_utils/atomselect_utils.pyx` & `moleculekit-1.8.7/moleculekit/atomselect_utils/atomselect_utils.pyx`

 * *Files 1% similar despite different names*

```diff
@@ -28,42 +28,14 @@
 ctypedef np.uint32_t UINT32_t
 ctypedef np.int64_t INT64_t
 ctypedef np.float32_t FLOAT32_t
 ctypedef np.float64_t FLOAT64_t
 
 import cython
 
-
-@cython.boundscheck(False) # turn off bounds-checking for entire function
-@cython.wraparound(False)  # turn off negative index wrapping for entire function
-def get_bonded_groups(
-        UINT32_t[:,:] bonds,
-        UINT32_t[:] has_lower_bond,
-        int n_atoms,
-        UINT32_t[:] group,
-    ):
-    cdef int i, j, k
-    cdef int n_bonds = bonds.shape[0]
-    cdef vector[int] results
-
-    # Mark atoms which have bonds to lower indexes
-    for i in range(n_bonds):
-        has_lower_bond[max(bonds[i, 0], bonds[i, 1])] = 1
-
-    # Atoms which don't have bonds to lower indexes are the start of a new fragment
-    k = 0
-    for i in range(n_atoms):
-        if not has_lower_bond[i]:
-            k += 1
-            results.push_back(i)
-        group[i] = k
-            
-    results.push_back(n_atoms)
-
-    return results
             
 
 @cython.boundscheck(False) # turn off bounds-checking for entire function
 @cython.wraparound(False)  # turn off negative index wrapping for entire function
 cdef bool _make_uniq_resids(
         int n_atoms,
         vector[vector[int]] &atom_bonds,
```

### Comparing `moleculekit-1.8.6/moleculekit/bondguesser.py` & `moleculekit-1.8.7/moleculekit/bondguesser.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,13 @@
 import numpy as np
 from moleculekit.bondguesser_utils import make_grid_neighborlist_nonperiodic, grid_bonds
 import unittest
+import logging
+
+logger = logging.getLogger(__name__)
 
 # VdW radii are from A. Bondi J. Phys. Chem., 68, 441 - 452, 1964
 # H is overriden to 1A from 1.2A in J.Phys.Chem., 100, 7384 - 7391, 1996
 # Unavailable radii are set to 2A
 # Ion radii are taken from CHARMM27 parameters
 vdw_radii = {
     "H": 1,
@@ -216,14 +219,22 @@
     num_boxes = xyz_boxes[0] * xyz_boxes[1] * xyz_boxes[2]
     while num_boxes > max_boxes or num_boxes < 1:
         pairdist = newpairdist
         xyz_boxes = np.floor(xyzrange / pairdist).astype(np.uint32) + 1
         num_boxes = xyz_boxes[0] * xyz_boxes[1] * xyz_boxes[2]
         newpairdist = pairdist * cutoff_incr  # sqrt(2) ~= 1.26
 
+    if num_boxes > 1e6:
+        logger.warning(
+            "It seems like you might be guessing bonds on an unwrapped simulation. "
+            "This can consume large amounts of memory and possibly crash. If you already have "
+            "all the bonds in Molecule pass `guessBonds=False` to the function or perform "
+            "the bond guessing on a wrapped frame."
+        )
+
     # Compute box index for all atoms
     box_idx = np.floor((coords - min_c) / pairdist).astype(int)
     # Clip box indexes within range
     box_idx[:, 0] = np.clip(box_idx[:, 0], 0, xyz_boxes[0] - 1)
     box_idx[:, 1] = np.clip(box_idx[:, 1], 0, xyz_boxes[1] - 1)
     box_idx[:, 2] = np.clip(box_idx[:, 2], 0, xyz_boxes[2] - 1)
```

### Comparing `moleculekit-1.8.6/moleculekit/bondguesser_utils/bondguesser_utils.cpp` & `moleculekit-1.8.7/moleculekit/bondguesser_utils/bondguesser_utils.cpp`

 * *Files 1% similar despite different names*

```diff
@@ -1,24 +1,24 @@
 /* Generated by Cython 3.0.5 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h"
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include"
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include"
         ],
         "language": "c++",
         "name": "moleculekit.bondguesser_utils",
         "sources": [
             "moleculekit/bondguesser_utils/bondguesser_utils.pyx"
         ]
     },
@@ -1672,177 +1672,177 @@
   Py_ssize_t strides[8];
   Py_ssize_t suboffsets[8];
 } __Pyx_memviewslice;
 #define __Pyx_MemoryView_Len(m)  (m.shape[0])
 
 /* #### Code section: numeric_typedefs ### */
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":730
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":730
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":731
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":731
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":732
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":732
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":733
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":733
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":737
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":737
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":738
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":738
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":739
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":739
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":740
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":740
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":744
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":744
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":745
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":745
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":754
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":754
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":755
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":755
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":757
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":757
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":758
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":758
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":760
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":760
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":761
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":761
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":763
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":763
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":764
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":764
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":765
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":765
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
@@ -1902,42 +1902,42 @@
 
 /*--- Type declarations ---*/
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
 struct __pyx_memoryviewslice_obj;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":767
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":767
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":768
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":768
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":769
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":769
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":771
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":771
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -18311,261 +18311,261 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_7ndarray_4base_base(PyArrayObject *__pyx_v_self) {
   PyObject *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":248
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":248
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  *             return PyArray_BASE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_BASE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
 static CYTHON_INLINE PyArray_Descr *__pyx_f_5numpy_7ndarray_5descr_descr(PyArrayObject *__pyx_v_self) {
   PyArray_Descr *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyArray_Descr *__pyx_t_1;
   __Pyx_RefNannySetupContext("descr", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":254
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":254
  *             """Returns an owned reference to the dtype of the array.
  *             """
  *             return <dtype>PyArray_DESCR(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __pyx_t_1 = PyArray_DESCR(__pyx_v_self);
   __Pyx_INCREF((PyObject *)((PyArray_Descr *)__pyx_t_1));
   __pyx_r = ((PyArray_Descr *)__pyx_t_1);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_7ndarray_4ndim_ndim(PyArrayObject *__pyx_v_self) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":260
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":260
  *             """Returns the number of dimensions in the array.
  *             """
  *             return PyArray_NDIM(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_NDIM(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_5shape_shape(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":268
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":268
  *             Can return NULL for 0-dimensional arrays.
  *             """
  *             return PyArray_DIMS(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_DIMS(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_7strides_strides(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":275
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":275
  *             The number of elements matches the number of dimensions of the array (ndim).
  *             """
  *             return PyArray_STRIDES(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_STRIDES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
 static CYTHON_INLINE npy_intp __pyx_f_5numpy_7ndarray_4size_size(PyArrayObject *__pyx_v_self) {
   npy_intp __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":281
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":281
  *             """Returns the total size (in number of elements) of the array.
  *             """
  *             return PyArray_SIZE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_SIZE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
 static CYTHON_INLINE char *__pyx_f_5numpy_7ndarray_4data_data(PyArrayObject *__pyx_v_self) {
   char *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":290
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":290
  *             of `PyArray_DATA()` instead, which returns a 'void*'.
  *             """
  *             return PyArray_BYTES(self)             # <<<<<<<<<<<<<<
  * 
  *     ctypedef unsigned char      npy_bool
  */
   __pyx_r = PyArray_BYTES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -18574,29 +18574,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":774
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":774
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 774, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -18607,15 +18607,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -18624,29 +18624,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":777
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":777
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -18657,15 +18657,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -18674,29 +18674,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":780
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":780
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 780, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -18707,15 +18707,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -18724,29 +18724,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":783
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":783
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -18757,15 +18757,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -18774,29 +18774,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":786
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":786
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -18807,217 +18807,217 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = PyDataType_HASSUBARRAY(__pyx_v_d);
   if (__pyx_t_1) {
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":790
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":790
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":792
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":792
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":968
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":968
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":969
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":969
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   __pyx_t_1 = PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(2, 969, __pyx_L1_error)
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_AddTraceback("numpy.set_array_base", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":972
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":972
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = (__pyx_v_base == NULL);
   if (__pyx_t_1) {
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":974
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":974
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":975
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":975
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19033,15 +19033,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -19049,68 +19049,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":981
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":981
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 981, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":982
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":982
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 982, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 983, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 983, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19118,15 +19118,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19141,15 +19141,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19165,15 +19165,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19181,68 +19181,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":987
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":987
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 987, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":988
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":988
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 988, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 989, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 989, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19250,15 +19250,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19273,15 +19273,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19297,15 +19297,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19313,68 +19313,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":993
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":993
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 993, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":994
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":994
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 994, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":995
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":995
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 995, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 995, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19382,15 +19382,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19405,170 +19405,170 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1010
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1010
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1025
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1025
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
 static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
   npy_datetime __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1035
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1035
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
 static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
   npy_timedelta __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1042
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1042
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
 static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
   NPY_DATETIMEUNIT __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1049
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1049
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -22415,26 +22415,26 @@
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError, "Incompatible checksums (0x%x vs (0x82a3537, 0x6ae9995, 0xb068931) = (name))" % __pyx_checksum
  */
   __pyx_tuple__8 = PyTuple_Pack(3, __pyx_int_136983863, __pyx_int_112105877, __pyx_int_184977713); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__8);
   __Pyx_GIVEREF(__pyx_tuple__8);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(2, 983, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__9);
   __Pyx_GIVEREF(__pyx_tuple__9);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(2, 989, __pyx_L1_error)
```

### Comparing `moleculekit-1.8.6/moleculekit/bondguesser_utils/bondguesser_utils.pyx` & `moleculekit-1.8.7/moleculekit/bondguesser_utils/bondguesser_utils.pyx`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/config.py` & `moleculekit-1.8.7/moleculekit/config.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/dihedral.py` & `moleculekit-1.8.7/moleculekit/dihedral.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/distance.py` & `moleculekit-1.8.7/moleculekit/distance.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/distance_utils/distance_utils.cpp` & `moleculekit-1.8.7/moleculekit/distance_utils/distance_utils.cpp`

 * *Files 0% similar despite different names*

```diff
@@ -1,24 +1,24 @@
 /* Generated by Cython 3.0.5 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h"
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include"
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include"
         ],
         "language": "c++",
         "name": "moleculekit.distance_utils",
         "sources": [
             "moleculekit/distance_utils/distance_utils.pyx"
         ]
     },
@@ -1672,177 +1672,177 @@
   Py_ssize_t strides[8];
   Py_ssize_t suboffsets[8];
 } __Pyx_memviewslice;
 #define __Pyx_MemoryView_Len(m)  (m.shape[0])
 
 /* #### Code section: numeric_typedefs ### */
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":730
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":730
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":731
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":731
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":732
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":732
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":733
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":733
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":737
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":737
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":738
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":738
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":739
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":739
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":740
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":740
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":744
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":744
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":745
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":745
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":754
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":754
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":755
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":755
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":757
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":757
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":758
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":758
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":760
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":760
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":761
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":761
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":763
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":763
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":764
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":764
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":765
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":765
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
@@ -1920,42 +1920,42 @@
 
 /*--- Type declarations ---*/
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
 struct __pyx_memoryviewslice_obj;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":767
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":767
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":768
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":768
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":769
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":769
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":771
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":771
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -19025,261 +19025,261 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_7ndarray_4base_base(PyArrayObject *__pyx_v_self) {
   PyObject *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":248
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":248
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  *             return PyArray_BASE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_BASE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
 static CYTHON_INLINE PyArray_Descr *__pyx_f_5numpy_7ndarray_5descr_descr(PyArrayObject *__pyx_v_self) {
   PyArray_Descr *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyArray_Descr *__pyx_t_1;
   __Pyx_RefNannySetupContext("descr", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":254
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":254
  *             """Returns an owned reference to the dtype of the array.
  *             """
  *             return <dtype>PyArray_DESCR(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __pyx_t_1 = PyArray_DESCR(__pyx_v_self);
   __Pyx_INCREF((PyObject *)((PyArray_Descr *)__pyx_t_1));
   __pyx_r = ((PyArray_Descr *)__pyx_t_1);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_7ndarray_4ndim_ndim(PyArrayObject *__pyx_v_self) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":260
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":260
  *             """Returns the number of dimensions in the array.
  *             """
  *             return PyArray_NDIM(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_NDIM(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_5shape_shape(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":268
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":268
  *             Can return NULL for 0-dimensional arrays.
  *             """
  *             return PyArray_DIMS(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_DIMS(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_7strides_strides(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":275
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":275
  *             The number of elements matches the number of dimensions of the array (ndim).
  *             """
  *             return PyArray_STRIDES(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_STRIDES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
 static CYTHON_INLINE npy_intp __pyx_f_5numpy_7ndarray_4size_size(PyArrayObject *__pyx_v_self) {
   npy_intp __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":281
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":281
  *             """Returns the total size (in number of elements) of the array.
  *             """
  *             return PyArray_SIZE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_SIZE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
 static CYTHON_INLINE char *__pyx_f_5numpy_7ndarray_4data_data(PyArrayObject *__pyx_v_self) {
   char *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":290
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":290
  *             of `PyArray_DATA()` instead, which returns a 'void*'.
  *             """
  *             return PyArray_BYTES(self)             # <<<<<<<<<<<<<<
  * 
  *     ctypedef unsigned char      npy_bool
  */
   __pyx_r = PyArray_BYTES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -19288,29 +19288,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":774
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":774
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 774, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -19321,15 +19321,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -19338,29 +19338,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":777
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":777
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -19371,15 +19371,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -19388,29 +19388,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":780
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":780
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 780, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -19421,15 +19421,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -19438,29 +19438,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":783
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":783
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -19471,15 +19471,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -19488,29 +19488,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":786
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":786
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -19521,217 +19521,217 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = PyDataType_HASSUBARRAY(__pyx_v_d);
   if (__pyx_t_1) {
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":790
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":790
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":792
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":792
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":968
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":968
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":969
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":969
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   __pyx_t_1 = PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(2, 969, __pyx_L1_error)
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_AddTraceback("numpy.set_array_base", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":972
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":972
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = (__pyx_v_base == NULL);
   if (__pyx_t_1) {
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":974
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":974
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":975
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":975
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19747,15 +19747,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -19763,68 +19763,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":981
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":981
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 981, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":982
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":982
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 982, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 983, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 983, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19832,15 +19832,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19855,15 +19855,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19879,15 +19879,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19895,68 +19895,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":987
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":987
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 987, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":988
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":988
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 988, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 989, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 989, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19964,15 +19964,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19987,15 +19987,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -20011,15 +20011,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -20027,68 +20027,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":993
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":993
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 993, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":994
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":994
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 994, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":995
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":995
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 995, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 995, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -20096,15 +20096,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -20119,170 +20119,170 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1010
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1010
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1025
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1025
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
 static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
   npy_datetime __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1035
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1035
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
 static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
   npy_timedelta __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1042
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1042
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
 static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
   NPY_DATETIMEUNIT __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1049
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1049
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -25761,26 +25761,26 @@
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError, "Incompatible checksums (0x%x vs (0x82a3537, 0x6ae9995, 0xb068931) = (name))" % __pyx_checksum
  */
   __pyx_tuple__8 = PyTuple_Pack(3, __pyx_int_136983863, __pyx_int_112105877, __pyx_int_184977713); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__8);
   __Pyx_GIVEREF(__pyx_tuple__8);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(2, 983, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__9);
   __Pyx_GIVEREF(__pyx_tuple__9);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(2, 989, __pyx_L1_error)
```

### Comparing `moleculekit-1.8.6/moleculekit/distance_utils/distance_utils.pyx` & `moleculekit-1.8.7/moleculekit/distance_utils/distance_utils.pyx`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/home.py` & `moleculekit-1.8.7/moleculekit/home.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/interactions/cationpi/cationpi.cpp` & `moleculekit-1.8.7/moleculekit/interactions/pipi/pipi.cpp`

 * *Files 1% similar despite different names*

```diff
@@ -1,32 +1,32 @@
 /* Generated by Cython 3.0.5 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h"
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include"
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include"
         ],
         "language": "c++",
-        "name": "moleculekit.interactions.cationpi",
+        "name": "moleculekit.interactions.pipi",
         "sources": [
-            "moleculekit/interactions/cationpi/cationpi.pyx"
+            "moleculekit/interactions/pipi/pipi.pyx"
         ]
     },
-    "module_name": "moleculekit.interactions.cationpi"
+    "module_name": "moleculekit.interactions.pipi"
 }
 END: Cython Metadata */
 
 #ifndef PY_SSIZE_T_CLEAN
 #define PY_SSIZE_T_CLEAN
 #endif /* PY_SSIZE_T_CLEAN */
 #if defined(CYTHON_LIMITED_API) && 0
@@ -1215,16 +1215,16 @@
     #else
     #warning Please do not define the '__PYX_EXTERN_C' macro externally. Use 'CYTHON_EXTERN_C' instead.
     #endif
 #else
     #define __PYX_EXTERN_C extern "C++"
 #endif
 
-#define __PYX_HAVE__moleculekit__interactions__cationpi
-#define __PYX_HAVE_API__moleculekit__interactions__cationpi
+#define __PYX_HAVE__moleculekit__interactions__pipi
+#define __PYX_HAVE_API__moleculekit__interactions__pipi
 /* Early includes */
 #include <string.h>
 #include <stdio.h>
 
     /* Using NumPy API declarations from "numpy/__init__.cython-30.pxd" */
     
 #include "numpy/arrayobject.h"
@@ -1523,15 +1523,15 @@
   #undef _Complex_I
   #define _Complex_I 1.0fj
 #endif
 
 /* #### Code section: filename_table ### */
 
 static const char *__pyx_f[] = {
-  "moleculekit/interactions/cationpi/cationpi.pyx",
+  "moleculekit/interactions/pipi/pipi.pyx",
   "<stringsource>",
   "__init__.cython-30.pxd",
   "type.pxd",
 };
 /* #### Code section: utility_code_proto_before_types ### */
 /* ForceInitThreads.proto */
 #ifndef __PYX_FORCE_INIT_THREADS
@@ -1672,202 +1672,202 @@
   Py_ssize_t strides[8];
   Py_ssize_t suboffsets[8];
 } __Pyx_memviewslice;
 #define __Pyx_MemoryView_Len(m)  (m.shape[0])
 
 /* #### Code section: numeric_typedefs ### */
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":730
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":730
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":731
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":731
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":732
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":732
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":733
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":733
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":737
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":737
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":738
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":738
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":739
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":739
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":740
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":740
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":744
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":744
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":745
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":745
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":754
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":754
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":755
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":755
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":757
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":757
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":758
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":758
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":760
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":760
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":761
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":761
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":763
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":763
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":764
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":764
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":765
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":765
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
 
-/* "moleculekit/interactions/cationpi/cationpi.pyx":17
+/* "moleculekit/interactions/pipi/pipi.pyx":17
  * # every type in the numpy module there's a corresponding compile-time
  * # type with a _t-suffix.
  * ctypedef np.uint32_t UINT32_t             # <<<<<<<<<<<<<<
  * ctypedef np.float32_t FLOAT32_t
  * 
  */
-typedef __pyx_t_5numpy_uint32_t __pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t;
+typedef __pyx_t_5numpy_uint32_t __pyx_t_11moleculekit_12interactions_4pipi_UINT32_t;
 
-/* "moleculekit/interactions/cationpi/cationpi.pyx":18
+/* "moleculekit/interactions/pipi/pipi.pyx":18
  * # type with a _t-suffix.
  * ctypedef np.uint32_t UINT32_t
  * ctypedef np.float32_t FLOAT32_t             # <<<<<<<<<<<<<<
  * 
  * import cython
  */
-typedef __pyx_t_5numpy_float32_t __pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t;
+typedef __pyx_t_5numpy_float32_t __pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t;
 /* #### Code section: complex_type_declarations ### */
 /* Declarations.proto */
 #if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
   #ifdef __cplusplus
     typedef ::std::complex< float > __pyx_t_float_complex;
   #else
     typedef float _Complex __pyx_t_float_complex;
@@ -1893,42 +1893,42 @@
 
 /*--- Type declarations ---*/
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
 struct __pyx_memoryviewslice_obj;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":767
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":767
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":768
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":768
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":769
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":769
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":771
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":771
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -2642,38 +2642,14 @@
 /* HasAttr.proto */
 #if __PYX_LIMITED_VERSION_HEX >= 0x030d00A1
 #define __Pyx_HasAttr(o, n)  PyObject_HasAttrWithError(o, n)
 #else
 static CYTHON_INLINE int __Pyx_HasAttr(PyObject *, PyObject *);
 #endif
 
-/* IsLittleEndian.proto */
-static CYTHON_INLINE int __Pyx_Is_Little_Endian(void);
-
-/* BufferFormatCheck.proto */
-static const char* __Pyx_BufFmt_CheckString(__Pyx_BufFmt_Context* ctx, const char* ts);
-static void __Pyx_BufFmt_Init(__Pyx_BufFmt_Context* ctx,
-                              __Pyx_BufFmt_StackElem* stack,
-                              __Pyx_TypeInfo* type);
-
-/* BufferGetAndValidate.proto */
-#define __Pyx_GetBufferAndValidate(buf, obj, dtype, flags, nd, cast, stack)\
-    ((obj == Py_None || obj == NULL) ?\
-    (__Pyx_ZeroBuffer(buf), 0) :\
-    __Pyx__GetBufferAndValidate(buf, obj, dtype, flags, nd, cast, stack))
-static int  __Pyx__GetBufferAndValidate(Py_buffer* buf, PyObject* obj,
-    __Pyx_TypeInfo* dtype, int flags, int nd, int cast, __Pyx_BufFmt_StackElem* stack);
-static void __Pyx_ZeroBuffer(Py_buffer* buf);
-static CYTHON_INLINE void __Pyx_SafeReleaseBuffer(Py_buffer* info);
-static Py_ssize_t __Pyx_minusones[] = { -1, -1, -1, -1, -1, -1, -1, -1 };
-static Py_ssize_t __Pyx_zeros[] = { 0, 0, 0, 0, 0, 0, 0, 0 };
-
-#define __Pyx_BufPtrStrided2d(type, buf, i0, s0, i1, s1) (type)((char*)buf + i0 * s0 + i1 * s1)
-#define __Pyx_BufPtrStrided1d(type, buf, i0, s0) (type)((char*)buf + i0 * s0)
-#define __Pyx_BufPtrStrided3d(type, buf, i0, s0, i1, s1, i2, s2) (type)((char*)buf + i0 * s0 + i1 * s1 + i2 * s2)
 /* PyObject_GenericGetAttrNoDict.proto */
 #if CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP && PY_VERSION_HEX < 0x03070000
 static CYTHON_INLINE PyObject* __Pyx_PyObject_GenericGetAttrNoDict(PyObject* obj, PyObject* attr_name);
 #else
 #define __Pyx_PyObject_GenericGetAttrNoDict PyObject_GenericGetAttr
 #endif
 
@@ -2939,14 +2915,23 @@
 static int __pyx_memviewslice_is_contig(const __Pyx_memviewslice mvs, char order, int ndim);
 
 /* OverlappingSlices.proto */
 static int __pyx_slices_overlap(__Pyx_memviewslice *slice1,
                                 __Pyx_memviewslice *slice2,
                                 int ndim, size_t itemsize);
 
+/* IsLittleEndian.proto */
+static CYTHON_INLINE int __Pyx_Is_Little_Endian(void);
+
+/* BufferFormatCheck.proto */
+static const char* __Pyx_BufFmt_CheckString(__Pyx_BufFmt_Context* ctx, const char* ts);
+static void __Pyx_BufFmt_Init(__Pyx_BufFmt_Context* ctx,
+                              __Pyx_BufFmt_StackElem* stack,
+                              __Pyx_TypeInfo* type);
+
 /* TypeInfoCompare.proto */
 static int __pyx_typeinfo_cmp(__Pyx_TypeInfo *a, __Pyx_TypeInfo *b);
 
 /* MemviewSliceValidateAndInit.proto */
 static int __Pyx_ValidateAndInit_memviewslice(
                 int *axes_specs,
                 int c_or_f_flag,
@@ -2954,15 +2939,24 @@
                 int ndim,
                 __Pyx_TypeInfo *dtype,
                 __Pyx_BufFmt_StackElem stack[],
                 __Pyx_memviewslice *memviewslice,
                 PyObject *original_obj);
 
 /* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(PyObject *, int writable_flag);
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_UINT32_t(PyObject *, int writable_flag);
+
+/* ObjectToMemviewSlice.proto */
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(PyObject *, int writable_flag);
+
+/* ObjectToMemviewSlice.proto */
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(PyObject *, int writable_flag);
+
+/* ObjectToMemviewSlice.proto */
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(PyObject *, int writable_flag);
 
 /* CppExceptionConversion.proto */
 #ifndef __Pyx_CppExn2PyErr
 #include <new>
 #include <typeinfo>
 #include <stdexcept>
 #include <ios>
@@ -2998,23 +2992,14 @@
   catch (...)
   {
     PyErr_SetString(PyExc_RuntimeError, "Unknown exception");
   }
 }
 #endif
 
-/* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t(PyObject *, int writable_flag);
-
-/* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(PyObject *, int writable_flag);
-
-/* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(PyObject *, int writable_flag);
-
 /* RealImag.proto */
 #if CYTHON_CCOMPLEX
   #ifdef __cplusplus
     #define __Pyx_CREAL(z) ((z).real())
     #define __Pyx_CIMAG(z) ((z).imag())
   #else
     #define __Pyx_CREAL(z) (__real__(z))
@@ -3140,20 +3125,20 @@
 #define __PYX_XCLEAR_MEMVIEW(slice, have_gil) __Pyx_XCLEAR_MEMVIEW(slice, have_gil, __LINE__)
 static CYTHON_INLINE void __Pyx_INC_MEMVIEW(__Pyx_memviewslice *, int, int);
 static CYTHON_INLINE void __Pyx_XCLEAR_MEMVIEW(__Pyx_memviewslice *, int, int);
 
 /* CIntFromPy.proto */
 static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *);
 
-/* CIntFromPy.proto */
-static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *);
-
 /* CIntToPy.proto */
 static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value);
 
+/* CIntFromPy.proto */
+static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *);
+
 /* None.proto */
 #include <new>
 
 /* CIntToPy.proto */
 static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value);
 
 /* CIntFromPy.proto */
@@ -3224,27 +3209,26 @@
 
 /* Module declarations from "cython.view" */
 
 /* Module declarations from "cython.dataclasses" */
 
 /* Module declarations from "cython" */
 
-/* Module declarations from "moleculekit.interactions.cationpi" */
+/* Module declarations from "moleculekit.interactions.pipi" */
 static PyObject *__pyx_collections_abc_Sequence = 0;
 static PyObject *generic = 0;
 static PyObject *strided = 0;
 static PyObject *indirect = 0;
 static PyObject *contiguous = 0;
 static PyObject *indirect_contiguous = 0;
 static int __pyx_memoryview_thread_locks_used;
 static PyThread_type_lock __pyx_memoryview_thread_locks[8];
-static void __pyx_f_11moleculekit_12interactions_8cationpi__calculate_ring_mean(int, int, int, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice); /*proto*/
-static float __pyx_f_11moleculekit_12interactions_8cationpi__wrapped_dist(int, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice); /*proto*/
-static void __pyx_f_11moleculekit_12interactions_8cationpi__normalize(__Pyx_memviewslice); /*proto*/
-static void __pyx_f_11moleculekit_12interactions_8cationpi__cross_product(__Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice); /*proto*/
+static void __pyx_f_11moleculekit_12interactions_4pipi__calculate_ring_mean(int, int, int, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice); /*proto*/
+static float __pyx_f_11moleculekit_12interactions_4pipi__wrapped_dist(int, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice); /*proto*/
+static void __pyx_f_11moleculekit_12interactions_4pipi__cross_product(__Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice); /*proto*/
 static PyObject *__pyx_convert_vector_to_py_int(std::vector<int>  const &); /*proto*/
 static PyObject *__pyx_convert_vector_to_py_std_3a__3a_vector_3c_int_3e___(std::vector<std::vector<int> >  const &); /*proto*/
 static PyObject *__pyx_convert_vector_to_py_float(std::vector<float>  const &); /*proto*/
 static PyObject *__pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___(std::vector<std::vector<float> >  const &); /*proto*/
 static int __pyx_array_allocate_buffer(struct __pyx_array_obj *); /*proto*/
 static struct __pyx_array_obj *__pyx_array_new(PyObject *, Py_ssize_t, char *, char *, char *); /*proto*/
 static PyObject *__pyx_memoryview_new(PyObject *, int, int, __Pyx_TypeInfo *); /*proto*/
@@ -3276,22 +3260,22 @@
 static void __pyx_memoryview_refcount_copying(__Pyx_memviewslice *, int, int, int); /*proto*/
 static void __pyx_memoryview_refcount_objects_in_slice_with_gil(char *, Py_ssize_t *, Py_ssize_t *, int, int); /*proto*/
 static void __pyx_memoryview_refcount_objects_in_slice(char *, Py_ssize_t *, Py_ssize_t *, int, int); /*proto*/
 static void __pyx_memoryview_slice_assign_scalar(__Pyx_memviewslice *, int, size_t, void *, int); /*proto*/
 static void __pyx_memoryview__slice_assign_scalar(char *, Py_ssize_t *, Py_ssize_t *, int, size_t, void *); /*proto*/
 static PyObject *__pyx_unpickle_Enum__set_state(struct __pyx_MemviewEnum_obj *, PyObject *); /*proto*/
 /* #### Code section: typeinfo ### */
-static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t = { "UINT32_t", NULL, sizeof(__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t), { 0 }, 0, __PYX_IS_UNSIGNED(__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t) ? 'U' : 'I', __PYX_IS_UNSIGNED(__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t), 0 };
-static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t = { "FLOAT32_t", NULL, sizeof(__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t), { 0 }, 0, 'R', 0, 0 };
+static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_4pipi_UINT32_t = { "UINT32_t", NULL, sizeof(__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t), { 0 }, 0, __PYX_IS_UNSIGNED(__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t) ? 'U' : 'I', __PYX_IS_UNSIGNED(__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t), 0 };
+static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t = { "FLOAT32_t", NULL, sizeof(__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t), { 0 }, 0, 'R', 0, 0 };
 /* #### Code section: before_global_var ### */
-#define __Pyx_MODULE_NAME "moleculekit.interactions.cationpi"
-extern int __pyx_module_is_main_moleculekit__interactions__cationpi;
-int __pyx_module_is_main_moleculekit__interactions__cationpi = 0;
+#define __Pyx_MODULE_NAME "moleculekit.interactions.pipi"
+extern int __pyx_module_is_main_moleculekit__interactions__pipi;
+int __pyx_module_is_main_moleculekit__interactions__pipi = 0;
 
-/* Implementation of "moleculekit.interactions.cationpi" */
+/* Implementation of "moleculekit.interactions.pipi" */
 /* #### Code section: global_var ### */
 static PyObject *__pyx_builtin_range;
 static PyObject *__pyx_builtin_MemoryError;
 static PyObject *__pyx_builtin___import__;
 static PyObject *__pyx_builtin_ValueError;
 static PyObject *__pyx_builtin_enumerate;
 static PyObject *__pyx_builtin_TypeError;
@@ -3361,85 +3345,91 @@
 static const char __pyx_k_pickle[] = "pickle";
 static const char __pyx_k_reduce[] = "__reduce__";
 static const char __pyx_k_struct[] = "struct";
 static const char __pyx_k_uint32[] = "uint32";
 static const char __pyx_k_unpack[] = "unpack";
 static const char __pyx_k_update[] = "update";
 static const char __pyx_k_FLOAT32[] = "FLOAT32";
-static const char __pyx_k_cations[] = "cations";
 static const char __pyx_k_disable[] = "disable";
 static const char __pyx_k_float32[] = "float32";
 static const char __pyx_k_fortran[] = "fortran";
 static const char __pyx_k_memview[] = "memview";
-static const char __pyx_k_n_rings[] = "n_rings";
 static const char __pyx_k_results[] = "results";
 static const char __pyx_k_Ellipsis[] = "Ellipsis";
 static const char __pyx_k_Sequence[] = "Sequence";
 static const char __pyx_k_dot_prod[] = "dot_prod";
 static const char __pyx_k_getstate[] = "__getstate__";
 static const char __pyx_k_half_box[] = "half_box";
 static const char __pyx_k_itemsize[] = "itemsize";
 static const char __pyx_k_n_frames[] = "n_frames";
+static const char __pyx_k_n_rings1[] = "n_rings1";
+static const char __pyx_k_n_rings2[] = "n_rings2";
 static const char __pyx_k_pyx_type[] = "__pyx_type";
 static const char __pyx_k_register[] = "register";
 static const char __pyx_k_setstate[] = "__setstate__";
 static const char __pyx_k_TypeError[] = "TypeError";
 static const char __pyx_k_calculate[] = "calculate";
 static const char __pyx_k_enumerate[] = "enumerate";
 static const char __pyx_k_isenabled[] = "isenabled";
-static const char __pyx_k_n_cations[] = "n_cations";
 static const char __pyx_k_pyx_state[] = "__pyx_state";
-static const char __pyx_k_r_end_idx[] = "r_end_idx";
 static const char __pyx_k_reduce_ex[] = "__reduce_ex__";
-static const char __pyx_k_ring_mean[] = "ring_mean";
 static const char __pyx_k_IndexError[] = "IndexError";
 static const char __pyx_k_ValueError[] = "ValueError";
 static const char __pyx_k_distangles[] = "distangles";
 static const char __pyx_k_pyx_result[] = "__pyx_result";
 static const char __pyx_k_pyx_vtable[] = "__pyx_vtable__";
+static const char __pyx_k_r1_end_idx[] = "r1_end_idx";
+static const char __pyx_k_r2_end_idx[] = "r2_end_idx";
+static const char __pyx_k_ring1_mean[] = "ring1_mean";
+static const char __pyx_k_ring2_mean[] = "ring2_mean";
 static const char __pyx_k_ImportError[] = "ImportError";
 static const char __pyx_k_MemoryError[] = "MemoryError";
 static const char __pyx_k_PickleError[] = "PickleError";
-static const char __pyx_k_cation_coor[] = "cation_coor";
 static const char __pyx_k_collections[] = "collections";
-static const char __pyx_k_r_start_idx[] = "r_start_idx";
-static const char __pyx_k_ring_normal[] = "ring_normal";
 static const char __pyx_k_rings_atoms[] = "rings_atoms";
 static const char __pyx_k_initializing[] = "_initializing";
 static const char __pyx_k_is_coroutine[] = "_is_coroutine";
 static const char __pyx_k_pyx_checksum[] = "__pyx_checksum";
+static const char __pyx_k_r1_start_idx[] = "r1_start_idx";
+static const char __pyx_k_r2_start_idx[] = "r2_start_idx";
+static const char __pyx_k_ring1_normal[] = "ring1_normal";
+static const char __pyx_k_ring2_normal[] = "ring2_normal";
 static const char __pyx_k_stringsource[] = "<stringsource>";
 static const char __pyx_k_version_info[] = "version_info";
 static const char __pyx_k_class_getitem[] = "__class_getitem__";
 static const char __pyx_k_reduce_cython[] = "__reduce_cython__";
 static const char __pyx_k_AssertionError[] = "AssertionError";
-static const char __pyx_k_dist_threshold[] = "dist_threshold";
 static const char __pyx_k_View_MemoryView[] = "View.MemoryView";
 static const char __pyx_k_allocate_buffer[] = "allocate_buffer";
 static const char __pyx_k_collections_abc[] = "collections.abc";
+static const char __pyx_k_dist_threshold1[] = "dist_threshold1";
+static const char __pyx_k_dist_threshold2[] = "dist_threshold2";
 static const char __pyx_k_dtype_is_object[] = "dtype_is_object";
 static const char __pyx_k_pyx_PickleError[] = "__pyx_PickleError";
 static const char __pyx_k_setstate_cython[] = "__setstate_cython__";
 static const char __pyx_k_pyx_unpickle_Enum[] = "__pyx_unpickle_Enum";
 static const char __pyx_k_asyncio_coroutines[] = "asyncio.coroutines";
 static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
 static const char __pyx_k_strided_and_direct[] = "<strided and direct>";
-static const char __pyx_k_angle_threshold_min[] = "angle_threshold_min";
-static const char __pyx_k_rings_start_indexes[] = "rings_start_indexes";
+static const char __pyx_k_angle_threshold1_max[] = "angle_threshold1_max";
+static const char __pyx_k_angle_threshold2_min[] = "angle_threshold2_min";
+static const char __pyx_k_rings1_start_indexes[] = "rings1_start_indexes";
+static const char __pyx_k_rings2_start_indexes[] = "rings2_start_indexes";
 static const char __pyx_k_strided_and_indirect[] = "<strided and indirect>";
 static const char __pyx_k_Invalid_shape_in_axis[] = "Invalid shape in axis ";
 static const char __pyx_k_contiguous_and_direct[] = "<contiguous and direct>";
 static const char __pyx_k_Cannot_index_with_type[] = "Cannot index with type '";
 static const char __pyx_k_MemoryView_of_r_object[] = "<MemoryView of %r object>";
 static const char __pyx_k_MemoryView_of_r_at_0x_x[] = "<MemoryView of %r at 0x%x>";
 static const char __pyx_k_contiguous_and_indirect[] = "<contiguous and indirect>";
 static const char __pyx_k_Dimension_d_is_not_direct[] = "Dimension %d is not direct";
 static const char __pyx_k_Index_out_of_bounds_axis_d[] = "Index out of bounds (axis %d)";
 static const char __pyx_k_Step_may_not_be_zero_axis_d[] = "Step may not be zero (axis %d)";
 static const char __pyx_k_itemsize_0_for_cython_array[] = "itemsize <= 0 for cython.array";
+static const char __pyx_k_moleculekit_interactions_pipi[] = "moleculekit.interactions.pipi";
 static const char __pyx_k_unable_to_allocate_array_data[] = "unable to allocate array data.";
 static const char __pyx_k_strided_and_direct_or_indirect[] = "<strided and direct or indirect>";
 static const char __pyx_k_numpy_core_multiarray_failed_to[] = "numpy.core.multiarray failed to import";
 static const char __pyx_k_All_dimensions_preceding_dimensi[] = "All dimensions preceding dimension %d must be indexed and not sliced";
 static const char __pyx_k_Buffer_view_does_not_expose_stri[] = "Buffer view does not expose strides";
 static const char __pyx_k_Can_only_create_a_buffer_that_is[] = "Can only create a buffer that is contiguous in memory.";
 static const char __pyx_k_Cannot_assign_to_read_only_memor[] = "Cannot assign to read-only memoryview";
@@ -3448,19 +3438,18 @@
 static const char __pyx_k_Empty_shape_tuple_for_cython_arr[] = "Empty shape tuple for cython.array";
 static const char __pyx_k_Incompatible_checksums_0x_x_vs_0[] = "Incompatible checksums (0x%x vs (0x82a3537, 0x6ae9995, 0xb068931) = (name))";
 static const char __pyx_k_Indirect_dimensions_not_supporte[] = "Indirect dimensions not supported";
 static const char __pyx_k_Invalid_mode_expected_c_or_fortr[] = "Invalid mode, expected 'c' or 'fortran', got ";
 static const char __pyx_k_Out_of_bounds_on_buffer_access_a[] = "Out of bounds on buffer access (axis ";
 static const char __pyx_k_Unable_to_convert_item_to_object[] = "Unable to convert item to object";
 static const char __pyx_k_got_differing_extents_in_dimensi[] = "got differing extents in dimension ";
-static const char __pyx_k_moleculekit_interactions_cationp[] = "moleculekit/interactions/cationpi/cationpi.pyx";
+static const char __pyx_k_moleculekit_interactions_pipi_pi[] = "moleculekit/interactions/pipi/pipi.pyx";
 static const char __pyx_k_no_default___reduce___due_to_non[] = "no default __reduce__ due to non-trivial __cinit__";
 static const char __pyx_k_numpy_core_umath_failed_to_impor[] = "numpy.core.umath failed to import";
 static const char __pyx_k_unable_to_allocate_shape_and_str[] = "unable to allocate shape and strides.";
-static const char __pyx_k_moleculekit_interactions_cationp_2[] = "moleculekit.interactions.cationpi";
 /* #### Code section: decls ### */
 static int __pyx_array___pyx_pf_15View_dot_MemoryView_5array___cinit__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_shape, Py_ssize_t __pyx_v_itemsize, PyObject *__pyx_v_format, PyObject *__pyx_v_mode, int __pyx_v_allocate_buffer); /* proto */
 static int __pyx_array___pyx_pf_15View_dot_MemoryView_5array_2__getbuffer__(struct __pyx_array_obj *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags); /* proto */
 static void __pyx_array___pyx_pf_15View_dot_MemoryView_5array_4__dealloc__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView_5array_7memview___get__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static Py_ssize_t __pyx_array___pyx_pf_15View_dot_MemoryView_5array_6__len__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_array___pyx_pf_15View_dot_MemoryView_5array_8__getattr__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_attr); /* proto */
@@ -3495,15 +3484,15 @@
 static PyObject *__pyx_memoryview___pyx_pf_15View_dot_MemoryView_10memoryview_22copy_fortran(struct __pyx_memoryview_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryview___reduce_cython__(CYTHON_UNUSED struct __pyx_memoryview_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryview_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryview_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static void __pyx_memoryviewslice___pyx_pf_15View_dot_MemoryView_16_memoryviewslice___dealloc__(struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryviewslice___reduce_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryviewslice_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView___pyx_unpickle_Enum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v___pyx_type, long __pyx_v___pyx_checksum, PyObject *__pyx_v___pyx_state); /* proto */
-static PyObject *__pyx_pf_11moleculekit_12interactions_8cationpi_calculate(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_rings_atoms, PyArrayObject *__pyx_v_rings_start_indexes, PyArrayObject *__pyx_v_cations, PyArrayObject *__pyx_v_coords, PyArrayObject *__pyx_v_box, float __pyx_v_dist_threshold, float __pyx_v_angle_threshold_min); /* proto */
+static PyObject *__pyx_pf_11moleculekit_12interactions_4pipi_calculate(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_rings_atoms, __Pyx_memviewslice __pyx_v_rings1_start_indexes, __Pyx_memviewslice __pyx_v_rings2_start_indexes, __Pyx_memviewslice __pyx_v_coords, __Pyx_memviewslice __pyx_v_box, float __pyx_v_dist_threshold1, float __pyx_v_angle_threshold1_max, float __pyx_v_dist_threshold2, float __pyx_v_angle_threshold2_min); /* proto */
 static PyObject *__pyx_tp_new_array(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_Enum(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_memoryview(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new__memoryviewslice(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 /* #### Code section: late_includes ### */
 /* #### Code section: module_state ### */
 typedef struct {
@@ -3624,36 +3613,36 @@
   PyObject *__pyx_n_s__3;
   PyObject *__pyx_kp_u__6;
   PyObject *__pyx_kp_u__7;
   PyObject *__pyx_n_s_abc;
   PyObject *__pyx_n_s_allocate_buffer;
   PyObject *__pyx_kp_u_and;
   PyObject *__pyx_n_s_angle;
-  PyObject *__pyx_n_s_angle_threshold_min;
+  PyObject *__pyx_n_s_angle_threshold1_max;
+  PyObject *__pyx_n_s_angle_threshold2_min;
   PyObject *__pyx_n_s_asyncio_coroutines;
   PyObject *__pyx_n_s_base;
   PyObject *__pyx_n_s_box;
   PyObject *__pyx_n_s_c;
   PyObject *__pyx_n_u_c;
   PyObject *__pyx_n_s_calculate;
-  PyObject *__pyx_n_s_cation_coor;
-  PyObject *__pyx_n_s_cations;
   PyObject *__pyx_n_s_class;
   PyObject *__pyx_n_s_class_getitem;
   PyObject *__pyx_n_s_cline_in_traceback;
   PyObject *__pyx_n_s_collections;
   PyObject *__pyx_kp_s_collections_abc;
   PyObject *__pyx_kp_s_contiguous_and_direct;
   PyObject *__pyx_kp_s_contiguous_and_indirect;
   PyObject *__pyx_n_s_coords;
   PyObject *__pyx_n_s_count;
   PyObject *__pyx_n_s_dict;
   PyObject *__pyx_kp_u_disable;
   PyObject *__pyx_n_s_dist2;
-  PyObject *__pyx_n_s_dist_threshold;
+  PyObject *__pyx_n_s_dist_threshold1;
+  PyObject *__pyx_n_s_dist_threshold2;
   PyObject *__pyx_n_s_distangles;
   PyObject *__pyx_n_s_dot_prod;
   PyObject *__pyx_n_s_dtype;
   PyObject *__pyx_n_s_dtype_is_object;
   PyObject *__pyx_kp_u_enable;
   PyObject *__pyx_n_s_encode;
   PyObject *__pyx_n_s_enumerate;
@@ -3677,19 +3666,19 @@
   PyObject *__pyx_n_s_is_coroutine;
   PyObject *__pyx_kp_u_isenabled;
   PyObject *__pyx_n_s_itemsize;
   PyObject *__pyx_kp_s_itemsize_0_for_cython_array;
   PyObject *__pyx_n_s_main;
   PyObject *__pyx_n_s_memview;
   PyObject *__pyx_n_s_mode;
-  PyObject *__pyx_kp_s_moleculekit_interactions_cationp;
-  PyObject *__pyx_n_s_moleculekit_interactions_cationp_2;
-  PyObject *__pyx_n_s_n_cations;
+  PyObject *__pyx_n_s_moleculekit_interactions_pipi;
+  PyObject *__pyx_kp_s_moleculekit_interactions_pipi_pi;
   PyObject *__pyx_n_s_n_frames;
-  PyObject *__pyx_n_s_n_rings;
+  PyObject *__pyx_n_s_n_rings1;
+  PyObject *__pyx_n_s_n_rings2;
   PyObject *__pyx_n_s_name;
   PyObject *__pyx_n_s_name_2;
   PyObject *__pyx_n_s_ndim;
   PyObject *__pyx_n_s_new;
   PyObject *__pyx_kp_s_no_default___reduce___due_to_non;
   PyObject *__pyx_n_s_np;
   PyObject *__pyx_n_s_numpy;
@@ -3702,27 +3691,32 @@
   PyObject *__pyx_n_s_pyx_checksum;
   PyObject *__pyx_n_s_pyx_result;
   PyObject *__pyx_n_s_pyx_state;
   PyObject *__pyx_n_s_pyx_type;
   PyObject *__pyx_n_s_pyx_unpickle_Enum;
   PyObject *__pyx_n_s_pyx_vtable;
   PyObject *__pyx_n_s_r1;
+  PyObject *__pyx_n_s_r1_end_idx;
+  PyObject *__pyx_n_s_r1_start_idx;
   PyObject *__pyx_n_s_r2;
-  PyObject *__pyx_n_s_r_end_idx;
-  PyObject *__pyx_n_s_r_start_idx;
+  PyObject *__pyx_n_s_r2_end_idx;
+  PyObject *__pyx_n_s_r2_start_idx;
   PyObject *__pyx_n_s_range;
   PyObject *__pyx_n_s_reduce;
   PyObject *__pyx_n_s_reduce_cython;
   PyObject *__pyx_n_s_reduce_ex;
   PyObject *__pyx_n_s_register;
   PyObject *__pyx_n_s_results;
-  PyObject *__pyx_n_s_ring_mean;
-  PyObject *__pyx_n_s_ring_normal;
+  PyObject *__pyx_n_s_ring1_mean;
+  PyObject *__pyx_n_s_ring1_normal;
+  PyObject *__pyx_n_s_ring2_mean;
+  PyObject *__pyx_n_s_ring2_normal;
+  PyObject *__pyx_n_s_rings1_start_indexes;
+  PyObject *__pyx_n_s_rings2_start_indexes;
   PyObject *__pyx_n_s_rings_atoms;
-  PyObject *__pyx_n_s_rings_start_indexes;
   PyObject *__pyx_n_s_setstate;
   PyObject *__pyx_n_s_setstate_cython;
   PyObject *__pyx_n_s_shape;
   PyObject *__pyx_n_s_size;
   PyObject *__pyx_n_s_spec;
   PyObject *__pyx_n_s_start;
   PyObject *__pyx_n_s_step;
@@ -3874,36 +3868,36 @@
   Py_CLEAR(clear_module_state->__pyx_n_s__3);
   Py_CLEAR(clear_module_state->__pyx_kp_u__6);
   Py_CLEAR(clear_module_state->__pyx_kp_u__7);
   Py_CLEAR(clear_module_state->__pyx_n_s_abc);
   Py_CLEAR(clear_module_state->__pyx_n_s_allocate_buffer);
   Py_CLEAR(clear_module_state->__pyx_kp_u_and);
   Py_CLEAR(clear_module_state->__pyx_n_s_angle);
-  Py_CLEAR(clear_module_state->__pyx_n_s_angle_threshold_min);
+  Py_CLEAR(clear_module_state->__pyx_n_s_angle_threshold1_max);
+  Py_CLEAR(clear_module_state->__pyx_n_s_angle_threshold2_min);
   Py_CLEAR(clear_module_state->__pyx_n_s_asyncio_coroutines);
   Py_CLEAR(clear_module_state->__pyx_n_s_base);
   Py_CLEAR(clear_module_state->__pyx_n_s_box);
   Py_CLEAR(clear_module_state->__pyx_n_s_c);
   Py_CLEAR(clear_module_state->__pyx_n_u_c);
   Py_CLEAR(clear_module_state->__pyx_n_s_calculate);
-  Py_CLEAR(clear_module_state->__pyx_n_s_cation_coor);
-  Py_CLEAR(clear_module_state->__pyx_n_s_cations);
   Py_CLEAR(clear_module_state->__pyx_n_s_class);
   Py_CLEAR(clear_module_state->__pyx_n_s_class_getitem);
   Py_CLEAR(clear_module_state->__pyx_n_s_cline_in_traceback);
   Py_CLEAR(clear_module_state->__pyx_n_s_collections);
   Py_CLEAR(clear_module_state->__pyx_kp_s_collections_abc);
   Py_CLEAR(clear_module_state->__pyx_kp_s_contiguous_and_direct);
   Py_CLEAR(clear_module_state->__pyx_kp_s_contiguous_and_indirect);
   Py_CLEAR(clear_module_state->__pyx_n_s_coords);
   Py_CLEAR(clear_module_state->__pyx_n_s_count);
   Py_CLEAR(clear_module_state->__pyx_n_s_dict);
   Py_CLEAR(clear_module_state->__pyx_kp_u_disable);
   Py_CLEAR(clear_module_state->__pyx_n_s_dist2);
-  Py_CLEAR(clear_module_state->__pyx_n_s_dist_threshold);
+  Py_CLEAR(clear_module_state->__pyx_n_s_dist_threshold1);
+  Py_CLEAR(clear_module_state->__pyx_n_s_dist_threshold2);
   Py_CLEAR(clear_module_state->__pyx_n_s_distangles);
   Py_CLEAR(clear_module_state->__pyx_n_s_dot_prod);
   Py_CLEAR(clear_module_state->__pyx_n_s_dtype);
   Py_CLEAR(clear_module_state->__pyx_n_s_dtype_is_object);
   Py_CLEAR(clear_module_state->__pyx_kp_u_enable);
   Py_CLEAR(clear_module_state->__pyx_n_s_encode);
   Py_CLEAR(clear_module_state->__pyx_n_s_enumerate);
@@ -3927,19 +3921,19 @@
   Py_CLEAR(clear_module_state->__pyx_n_s_is_coroutine);
   Py_CLEAR(clear_module_state->__pyx_kp_u_isenabled);
   Py_CLEAR(clear_module_state->__pyx_n_s_itemsize);
   Py_CLEAR(clear_module_state->__pyx_kp_s_itemsize_0_for_cython_array);
   Py_CLEAR(clear_module_state->__pyx_n_s_main);
   Py_CLEAR(clear_module_state->__pyx_n_s_memview);
   Py_CLEAR(clear_module_state->__pyx_n_s_mode);
-  Py_CLEAR(clear_module_state->__pyx_kp_s_moleculekit_interactions_cationp);
-  Py_CLEAR(clear_module_state->__pyx_n_s_moleculekit_interactions_cationp_2);
-  Py_CLEAR(clear_module_state->__pyx_n_s_n_cations);
+  Py_CLEAR(clear_module_state->__pyx_n_s_moleculekit_interactions_pipi);
+  Py_CLEAR(clear_module_state->__pyx_kp_s_moleculekit_interactions_pipi_pi);
   Py_CLEAR(clear_module_state->__pyx_n_s_n_frames);
-  Py_CLEAR(clear_module_state->__pyx_n_s_n_rings);
+  Py_CLEAR(clear_module_state->__pyx_n_s_n_rings1);
+  Py_CLEAR(clear_module_state->__pyx_n_s_n_rings2);
   Py_CLEAR(clear_module_state->__pyx_n_s_name);
   Py_CLEAR(clear_module_state->__pyx_n_s_name_2);
   Py_CLEAR(clear_module_state->__pyx_n_s_ndim);
   Py_CLEAR(clear_module_state->__pyx_n_s_new);
   Py_CLEAR(clear_module_state->__pyx_kp_s_no_default___reduce___due_to_non);
   Py_CLEAR(clear_module_state->__pyx_n_s_np);
   Py_CLEAR(clear_module_state->__pyx_n_s_numpy);
@@ -3952,27 +3946,32 @@
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_checksum);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_result);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_state);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_type);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_unpickle_Enum);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_vtable);
   Py_CLEAR(clear_module_state->__pyx_n_s_r1);
+  Py_CLEAR(clear_module_state->__pyx_n_s_r1_end_idx);
+  Py_CLEAR(clear_module_state->__pyx_n_s_r1_start_idx);
   Py_CLEAR(clear_module_state->__pyx_n_s_r2);
-  Py_CLEAR(clear_module_state->__pyx_n_s_r_end_idx);
-  Py_CLEAR(clear_module_state->__pyx_n_s_r_start_idx);
+  Py_CLEAR(clear_module_state->__pyx_n_s_r2_end_idx);
+  Py_CLEAR(clear_module_state->__pyx_n_s_r2_start_idx);
   Py_CLEAR(clear_module_state->__pyx_n_s_range);
   Py_CLEAR(clear_module_state->__pyx_n_s_reduce);
   Py_CLEAR(clear_module_state->__pyx_n_s_reduce_cython);
   Py_CLEAR(clear_module_state->__pyx_n_s_reduce_ex);
   Py_CLEAR(clear_module_state->__pyx_n_s_register);
   Py_CLEAR(clear_module_state->__pyx_n_s_results);
-  Py_CLEAR(clear_module_state->__pyx_n_s_ring_mean);
-  Py_CLEAR(clear_module_state->__pyx_n_s_ring_normal);
+  Py_CLEAR(clear_module_state->__pyx_n_s_ring1_mean);
+  Py_CLEAR(clear_module_state->__pyx_n_s_ring1_normal);
+  Py_CLEAR(clear_module_state->__pyx_n_s_ring2_mean);
+  Py_CLEAR(clear_module_state->__pyx_n_s_ring2_normal);
+  Py_CLEAR(clear_module_state->__pyx_n_s_rings1_start_indexes);
+  Py_CLEAR(clear_module_state->__pyx_n_s_rings2_start_indexes);
   Py_CLEAR(clear_module_state->__pyx_n_s_rings_atoms);
-  Py_CLEAR(clear_module_state->__pyx_n_s_rings_start_indexes);
   Py_CLEAR(clear_module_state->__pyx_n_s_setstate);
   Py_CLEAR(clear_module_state->__pyx_n_s_setstate_cython);
   Py_CLEAR(clear_module_state->__pyx_n_s_shape);
   Py_CLEAR(clear_module_state->__pyx_n_s_size);
   Py_CLEAR(clear_module_state->__pyx_n_s_spec);
   Py_CLEAR(clear_module_state->__pyx_n_s_start);
   Py_CLEAR(clear_module_state->__pyx_n_s_step);
@@ -4102,36 +4101,36 @@
   Py_VISIT(traverse_module_state->__pyx_n_s__3);
   Py_VISIT(traverse_module_state->__pyx_kp_u__6);
   Py_VISIT(traverse_module_state->__pyx_kp_u__7);
   Py_VISIT(traverse_module_state->__pyx_n_s_abc);
   Py_VISIT(traverse_module_state->__pyx_n_s_allocate_buffer);
   Py_VISIT(traverse_module_state->__pyx_kp_u_and);
   Py_VISIT(traverse_module_state->__pyx_n_s_angle);
-  Py_VISIT(traverse_module_state->__pyx_n_s_angle_threshold_min);
+  Py_VISIT(traverse_module_state->__pyx_n_s_angle_threshold1_max);
+  Py_VISIT(traverse_module_state->__pyx_n_s_angle_threshold2_min);
   Py_VISIT(traverse_module_state->__pyx_n_s_asyncio_coroutines);
   Py_VISIT(traverse_module_state->__pyx_n_s_base);
   Py_VISIT(traverse_module_state->__pyx_n_s_box);
   Py_VISIT(traverse_module_state->__pyx_n_s_c);
   Py_VISIT(traverse_module_state->__pyx_n_u_c);
   Py_VISIT(traverse_module_state->__pyx_n_s_calculate);
-  Py_VISIT(traverse_module_state->__pyx_n_s_cation_coor);
-  Py_VISIT(traverse_module_state->__pyx_n_s_cations);
   Py_VISIT(traverse_module_state->__pyx_n_s_class);
   Py_VISIT(traverse_module_state->__pyx_n_s_class_getitem);
   Py_VISIT(traverse_module_state->__pyx_n_s_cline_in_traceback);
   Py_VISIT(traverse_module_state->__pyx_n_s_collections);
   Py_VISIT(traverse_module_state->__pyx_kp_s_collections_abc);
   Py_VISIT(traverse_module_state->__pyx_kp_s_contiguous_and_direct);
   Py_VISIT(traverse_module_state->__pyx_kp_s_contiguous_and_indirect);
   Py_VISIT(traverse_module_state->__pyx_n_s_coords);
   Py_VISIT(traverse_module_state->__pyx_n_s_count);
   Py_VISIT(traverse_module_state->__pyx_n_s_dict);
   Py_VISIT(traverse_module_state->__pyx_kp_u_disable);
   Py_VISIT(traverse_module_state->__pyx_n_s_dist2);
-  Py_VISIT(traverse_module_state->__pyx_n_s_dist_threshold);
+  Py_VISIT(traverse_module_state->__pyx_n_s_dist_threshold1);
+  Py_VISIT(traverse_module_state->__pyx_n_s_dist_threshold2);
   Py_VISIT(traverse_module_state->__pyx_n_s_distangles);
   Py_VISIT(traverse_module_state->__pyx_n_s_dot_prod);
   Py_VISIT(traverse_module_state->__pyx_n_s_dtype);
   Py_VISIT(traverse_module_state->__pyx_n_s_dtype_is_object);
   Py_VISIT(traverse_module_state->__pyx_kp_u_enable);
   Py_VISIT(traverse_module_state->__pyx_n_s_encode);
   Py_VISIT(traverse_module_state->__pyx_n_s_enumerate);
@@ -4155,19 +4154,19 @@
   Py_VISIT(traverse_module_state->__pyx_n_s_is_coroutine);
   Py_VISIT(traverse_module_state->__pyx_kp_u_isenabled);
   Py_VISIT(traverse_module_state->__pyx_n_s_itemsize);
   Py_VISIT(traverse_module_state->__pyx_kp_s_itemsize_0_for_cython_array);
   Py_VISIT(traverse_module_state->__pyx_n_s_main);
   Py_VISIT(traverse_module_state->__pyx_n_s_memview);
   Py_VISIT(traverse_module_state->__pyx_n_s_mode);
-  Py_VISIT(traverse_module_state->__pyx_kp_s_moleculekit_interactions_cationp);
-  Py_VISIT(traverse_module_state->__pyx_n_s_moleculekit_interactions_cationp_2);
-  Py_VISIT(traverse_module_state->__pyx_n_s_n_cations);
+  Py_VISIT(traverse_module_state->__pyx_n_s_moleculekit_interactions_pipi);
+  Py_VISIT(traverse_module_state->__pyx_kp_s_moleculekit_interactions_pipi_pi);
   Py_VISIT(traverse_module_state->__pyx_n_s_n_frames);
-  Py_VISIT(traverse_module_state->__pyx_n_s_n_rings);
+  Py_VISIT(traverse_module_state->__pyx_n_s_n_rings1);
+  Py_VISIT(traverse_module_state->__pyx_n_s_n_rings2);
   Py_VISIT(traverse_module_state->__pyx_n_s_name);
   Py_VISIT(traverse_module_state->__pyx_n_s_name_2);
   Py_VISIT(traverse_module_state->__pyx_n_s_ndim);
   Py_VISIT(traverse_module_state->__pyx_n_s_new);
   Py_VISIT(traverse_module_state->__pyx_kp_s_no_default___reduce___due_to_non);
   Py_VISIT(traverse_module_state->__pyx_n_s_np);
   Py_VISIT(traverse_module_state->__pyx_n_s_numpy);
@@ -4180,27 +4179,32 @@
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_checksum);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_result);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_state);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_type);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_unpickle_Enum);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_vtable);
   Py_VISIT(traverse_module_state->__pyx_n_s_r1);
+  Py_VISIT(traverse_module_state->__pyx_n_s_r1_end_idx);
+  Py_VISIT(traverse_module_state->__pyx_n_s_r1_start_idx);
   Py_VISIT(traverse_module_state->__pyx_n_s_r2);
-  Py_VISIT(traverse_module_state->__pyx_n_s_r_end_idx);
-  Py_VISIT(traverse_module_state->__pyx_n_s_r_start_idx);
+  Py_VISIT(traverse_module_state->__pyx_n_s_r2_end_idx);
+  Py_VISIT(traverse_module_state->__pyx_n_s_r2_start_idx);
   Py_VISIT(traverse_module_state->__pyx_n_s_range);
   Py_VISIT(traverse_module_state->__pyx_n_s_reduce);
   Py_VISIT(traverse_module_state->__pyx_n_s_reduce_cython);
   Py_VISIT(traverse_module_state->__pyx_n_s_reduce_ex);
   Py_VISIT(traverse_module_state->__pyx_n_s_register);
   Py_VISIT(traverse_module_state->__pyx_n_s_results);
-  Py_VISIT(traverse_module_state->__pyx_n_s_ring_mean);
-  Py_VISIT(traverse_module_state->__pyx_n_s_ring_normal);
+  Py_VISIT(traverse_module_state->__pyx_n_s_ring1_mean);
+  Py_VISIT(traverse_module_state->__pyx_n_s_ring1_normal);
+  Py_VISIT(traverse_module_state->__pyx_n_s_ring2_mean);
+  Py_VISIT(traverse_module_state->__pyx_n_s_ring2_normal);
+  Py_VISIT(traverse_module_state->__pyx_n_s_rings1_start_indexes);
+  Py_VISIT(traverse_module_state->__pyx_n_s_rings2_start_indexes);
   Py_VISIT(traverse_module_state->__pyx_n_s_rings_atoms);
-  Py_VISIT(traverse_module_state->__pyx_n_s_rings_start_indexes);
   Py_VISIT(traverse_module_state->__pyx_n_s_setstate);
   Py_VISIT(traverse_module_state->__pyx_n_s_setstate_cython);
   Py_VISIT(traverse_module_state->__pyx_n_s_shape);
   Py_VISIT(traverse_module_state->__pyx_n_s_size);
   Py_VISIT(traverse_module_state->__pyx_n_s_spec);
   Py_VISIT(traverse_module_state->__pyx_n_s_start);
   Py_VISIT(traverse_module_state->__pyx_n_s_step);
@@ -4368,36 +4372,36 @@
 #define __pyx_n_s__3 __pyx_mstate_global->__pyx_n_s__3
 #define __pyx_kp_u__6 __pyx_mstate_global->__pyx_kp_u__6
 #define __pyx_kp_u__7 __pyx_mstate_global->__pyx_kp_u__7
 #define __pyx_n_s_abc __pyx_mstate_global->__pyx_n_s_abc
 #define __pyx_n_s_allocate_buffer __pyx_mstate_global->__pyx_n_s_allocate_buffer
 #define __pyx_kp_u_and __pyx_mstate_global->__pyx_kp_u_and
 #define __pyx_n_s_angle __pyx_mstate_global->__pyx_n_s_angle
-#define __pyx_n_s_angle_threshold_min __pyx_mstate_global->__pyx_n_s_angle_threshold_min
+#define __pyx_n_s_angle_threshold1_max __pyx_mstate_global->__pyx_n_s_angle_threshold1_max
+#define __pyx_n_s_angle_threshold2_min __pyx_mstate_global->__pyx_n_s_angle_threshold2_min
 #define __pyx_n_s_asyncio_coroutines __pyx_mstate_global->__pyx_n_s_asyncio_coroutines
 #define __pyx_n_s_base __pyx_mstate_global->__pyx_n_s_base
 #define __pyx_n_s_box __pyx_mstate_global->__pyx_n_s_box
 #define __pyx_n_s_c __pyx_mstate_global->__pyx_n_s_c
 #define __pyx_n_u_c __pyx_mstate_global->__pyx_n_u_c
 #define __pyx_n_s_calculate __pyx_mstate_global->__pyx_n_s_calculate
-#define __pyx_n_s_cation_coor __pyx_mstate_global->__pyx_n_s_cation_coor
-#define __pyx_n_s_cations __pyx_mstate_global->__pyx_n_s_cations
 #define __pyx_n_s_class __pyx_mstate_global->__pyx_n_s_class
 #define __pyx_n_s_class_getitem __pyx_mstate_global->__pyx_n_s_class_getitem
 #define __pyx_n_s_cline_in_traceback __pyx_mstate_global->__pyx_n_s_cline_in_traceback
 #define __pyx_n_s_collections __pyx_mstate_global->__pyx_n_s_collections
 #define __pyx_kp_s_collections_abc __pyx_mstate_global->__pyx_kp_s_collections_abc
 #define __pyx_kp_s_contiguous_and_direct __pyx_mstate_global->__pyx_kp_s_contiguous_and_direct
 #define __pyx_kp_s_contiguous_and_indirect __pyx_mstate_global->__pyx_kp_s_contiguous_and_indirect
 #define __pyx_n_s_coords __pyx_mstate_global->__pyx_n_s_coords
 #define __pyx_n_s_count __pyx_mstate_global->__pyx_n_s_count
 #define __pyx_n_s_dict __pyx_mstate_global->__pyx_n_s_dict
 #define __pyx_kp_u_disable __pyx_mstate_global->__pyx_kp_u_disable
 #define __pyx_n_s_dist2 __pyx_mstate_global->__pyx_n_s_dist2
-#define __pyx_n_s_dist_threshold __pyx_mstate_global->__pyx_n_s_dist_threshold
+#define __pyx_n_s_dist_threshold1 __pyx_mstate_global->__pyx_n_s_dist_threshold1
+#define __pyx_n_s_dist_threshold2 __pyx_mstate_global->__pyx_n_s_dist_threshold2
 #define __pyx_n_s_distangles __pyx_mstate_global->__pyx_n_s_distangles
 #define __pyx_n_s_dot_prod __pyx_mstate_global->__pyx_n_s_dot_prod
 #define __pyx_n_s_dtype __pyx_mstate_global->__pyx_n_s_dtype
 #define __pyx_n_s_dtype_is_object __pyx_mstate_global->__pyx_n_s_dtype_is_object
 #define __pyx_kp_u_enable __pyx_mstate_global->__pyx_kp_u_enable
 #define __pyx_n_s_encode __pyx_mstate_global->__pyx_n_s_encode
 #define __pyx_n_s_enumerate __pyx_mstate_global->__pyx_n_s_enumerate
@@ -4421,19 +4425,19 @@
 #define __pyx_n_s_is_coroutine __pyx_mstate_global->__pyx_n_s_is_coroutine
 #define __pyx_kp_u_isenabled __pyx_mstate_global->__pyx_kp_u_isenabled
 #define __pyx_n_s_itemsize __pyx_mstate_global->__pyx_n_s_itemsize
 #define __pyx_kp_s_itemsize_0_for_cython_array __pyx_mstate_global->__pyx_kp_s_itemsize_0_for_cython_array
 #define __pyx_n_s_main __pyx_mstate_global->__pyx_n_s_main
 #define __pyx_n_s_memview __pyx_mstate_global->__pyx_n_s_memview
 #define __pyx_n_s_mode __pyx_mstate_global->__pyx_n_s_mode
-#define __pyx_kp_s_moleculekit_interactions_cationp __pyx_mstate_global->__pyx_kp_s_moleculekit_interactions_cationp
-#define __pyx_n_s_moleculekit_interactions_cationp_2 __pyx_mstate_global->__pyx_n_s_moleculekit_interactions_cationp_2
-#define __pyx_n_s_n_cations __pyx_mstate_global->__pyx_n_s_n_cations
+#define __pyx_n_s_moleculekit_interactions_pipi __pyx_mstate_global->__pyx_n_s_moleculekit_interactions_pipi
+#define __pyx_kp_s_moleculekit_interactions_pipi_pi __pyx_mstate_global->__pyx_kp_s_moleculekit_interactions_pipi_pi
 #define __pyx_n_s_n_frames __pyx_mstate_global->__pyx_n_s_n_frames
-#define __pyx_n_s_n_rings __pyx_mstate_global->__pyx_n_s_n_rings
+#define __pyx_n_s_n_rings1 __pyx_mstate_global->__pyx_n_s_n_rings1
+#define __pyx_n_s_n_rings2 __pyx_mstate_global->__pyx_n_s_n_rings2
 #define __pyx_n_s_name __pyx_mstate_global->__pyx_n_s_name
 #define __pyx_n_s_name_2 __pyx_mstate_global->__pyx_n_s_name_2
 #define __pyx_n_s_ndim __pyx_mstate_global->__pyx_n_s_ndim
 #define __pyx_n_s_new __pyx_mstate_global->__pyx_n_s_new
 #define __pyx_kp_s_no_default___reduce___due_to_non __pyx_mstate_global->__pyx_kp_s_no_default___reduce___due_to_non
 #define __pyx_n_s_np __pyx_mstate_global->__pyx_n_s_np
 #define __pyx_n_s_numpy __pyx_mstate_global->__pyx_n_s_numpy
@@ -4446,27 +4450,32 @@
 #define __pyx_n_s_pyx_checksum __pyx_mstate_global->__pyx_n_s_pyx_checksum
 #define __pyx_n_s_pyx_result __pyx_mstate_global->__pyx_n_s_pyx_result
 #define __pyx_n_s_pyx_state __pyx_mstate_global->__pyx_n_s_pyx_state
 #define __pyx_n_s_pyx_type __pyx_mstate_global->__pyx_n_s_pyx_type
 #define __pyx_n_s_pyx_unpickle_Enum __pyx_mstate_global->__pyx_n_s_pyx_unpickle_Enum
 #define __pyx_n_s_pyx_vtable __pyx_mstate_global->__pyx_n_s_pyx_vtable
 #define __pyx_n_s_r1 __pyx_mstate_global->__pyx_n_s_r1
+#define __pyx_n_s_r1_end_idx __pyx_mstate_global->__pyx_n_s_r1_end_idx
+#define __pyx_n_s_r1_start_idx __pyx_mstate_global->__pyx_n_s_r1_start_idx
 #define __pyx_n_s_r2 __pyx_mstate_global->__pyx_n_s_r2
-#define __pyx_n_s_r_end_idx __pyx_mstate_global->__pyx_n_s_r_end_idx
-#define __pyx_n_s_r_start_idx __pyx_mstate_global->__pyx_n_s_r_start_idx
+#define __pyx_n_s_r2_end_idx __pyx_mstate_global->__pyx_n_s_r2_end_idx
+#define __pyx_n_s_r2_start_idx __pyx_mstate_global->__pyx_n_s_r2_start_idx
 #define __pyx_n_s_range __pyx_mstate_global->__pyx_n_s_range
 #define __pyx_n_s_reduce __pyx_mstate_global->__pyx_n_s_reduce
 #define __pyx_n_s_reduce_cython __pyx_mstate_global->__pyx_n_s_reduce_cython
 #define __pyx_n_s_reduce_ex __pyx_mstate_global->__pyx_n_s_reduce_ex
 #define __pyx_n_s_register __pyx_mstate_global->__pyx_n_s_register
 #define __pyx_n_s_results __pyx_mstate_global->__pyx_n_s_results
-#define __pyx_n_s_ring_mean __pyx_mstate_global->__pyx_n_s_ring_mean
-#define __pyx_n_s_ring_normal __pyx_mstate_global->__pyx_n_s_ring_normal
+#define __pyx_n_s_ring1_mean __pyx_mstate_global->__pyx_n_s_ring1_mean
+#define __pyx_n_s_ring1_normal __pyx_mstate_global->__pyx_n_s_ring1_normal
+#define __pyx_n_s_ring2_mean __pyx_mstate_global->__pyx_n_s_ring2_mean
+#define __pyx_n_s_ring2_normal __pyx_mstate_global->__pyx_n_s_ring2_normal
+#define __pyx_n_s_rings1_start_indexes __pyx_mstate_global->__pyx_n_s_rings1_start_indexes
+#define __pyx_n_s_rings2_start_indexes __pyx_mstate_global->__pyx_n_s_rings2_start_indexes
 #define __pyx_n_s_rings_atoms __pyx_mstate_global->__pyx_n_s_rings_atoms
-#define __pyx_n_s_rings_start_indexes __pyx_mstate_global->__pyx_n_s_rings_start_indexes
 #define __pyx_n_s_setstate __pyx_mstate_global->__pyx_n_s_setstate
 #define __pyx_n_s_setstate_cython __pyx_mstate_global->__pyx_n_s_setstate_cython
 #define __pyx_n_s_shape __pyx_mstate_global->__pyx_n_s_shape
 #define __pyx_n_s_size __pyx_mstate_global->__pyx_n_s_size
 #define __pyx_n_s_spec __pyx_mstate_global->__pyx_n_s_spec
 #define __pyx_n_s_start __pyx_mstate_global->__pyx_n_s_start
 #define __pyx_n_s_step __pyx_mstate_global->__pyx_n_s_step
@@ -18709,261 +18718,261 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_7ndarray_4base_base(PyArrayObject *__pyx_v_self) {
   PyObject *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":248
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":248
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  *             return PyArray_BASE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_BASE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
 static CYTHON_INLINE PyArray_Descr *__pyx_f_5numpy_7ndarray_5descr_descr(PyArrayObject *__pyx_v_self) {
   PyArray_Descr *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyArray_Descr *__pyx_t_1;
   __Pyx_RefNannySetupContext("descr", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":254
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":254
  *             """Returns an owned reference to the dtype of the array.
  *             """
  *             return <dtype>PyArray_DESCR(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __pyx_t_1 = PyArray_DESCR(__pyx_v_self);
   __Pyx_INCREF((PyObject *)((PyArray_Descr *)__pyx_t_1));
   __pyx_r = ((PyArray_Descr *)__pyx_t_1);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_7ndarray_4ndim_ndim(PyArrayObject *__pyx_v_self) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":260
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":260
  *             """Returns the number of dimensions in the array.
  *             """
  *             return PyArray_NDIM(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_NDIM(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_5shape_shape(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":268
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":268
  *             Can return NULL for 0-dimensional arrays.
  *             """
  *             return PyArray_DIMS(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_DIMS(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_7strides_strides(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":275
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":275
  *             The number of elements matches the number of dimensions of the array (ndim).
  *             """
  *             return PyArray_STRIDES(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_STRIDES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
 static CYTHON_INLINE npy_intp __pyx_f_5numpy_7ndarray_4size_size(PyArrayObject *__pyx_v_self) {
   npy_intp __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":281
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":281
  *             """Returns the total size (in number of elements) of the array.
  *             """
  *             return PyArray_SIZE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_SIZE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
 static CYTHON_INLINE char *__pyx_f_5numpy_7ndarray_4data_data(PyArrayObject *__pyx_v_self) {
   char *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":290
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":290
  *             of `PyArray_DATA()` instead, which returns a 'void*'.
  *             """
  *             return PyArray_BYTES(self)             # <<<<<<<<<<<<<<
  * 
  *     ctypedef unsigned char      npy_bool
  */
   __pyx_r = PyArray_BYTES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -18972,29 +18981,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":774
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":774
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 774, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -19005,15 +19014,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -19022,29 +19031,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":777
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":777
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -19055,15 +19064,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -19072,29 +19081,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":780
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":780
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 780, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -19105,15 +19114,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -19122,29 +19131,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":783
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":783
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -19155,15 +19164,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -19172,29 +19181,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":786
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":786
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -19205,217 +19214,217 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = PyDataType_HASSUBARRAY(__pyx_v_d);
   if (__pyx_t_1) {
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":790
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":790
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":792
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":792
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":968
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":968
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":969
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":969
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   __pyx_t_1 = PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(2, 969, __pyx_L1_error)
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_AddTraceback("numpy.set_array_base", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":972
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":972
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = (__pyx_v_base == NULL);
   if (__pyx_t_1) {
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":974
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":974
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":975
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":975
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19431,15 +19440,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -19447,68 +19456,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":981
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":981
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 981, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":982
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":982
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 982, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 983, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 983, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19516,15 +19525,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19539,15 +19548,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19563,15 +19572,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19579,68 +19588,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":987
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":987
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 987, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":988
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":988
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 988, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 989, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 989, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19648,15 +19657,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19671,15 +19680,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19695,15 +19704,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19711,68 +19720,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":993
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":993
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 993, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":994
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":994
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 994, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":995
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":995
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 995, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 995, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19780,15 +19789,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19803,640 +19812,603 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1010
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1010
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1025
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1025
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
 static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
   npy_datetime __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1035
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1035
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
 static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
   npy_timedelta __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1042
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1042
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
 static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
   NPY_DATETIMEUNIT __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1049
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1049
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "moleculekit/interactions/cationpi/cationpi.pyx":23
+/* "moleculekit/interactions/pipi/pipi.pyx":23
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef void _calculate_ring_mean(             # <<<<<<<<<<<<<<
  *         int f,
  *         int start_idx,
  */
 
-static void __pyx_f_11moleculekit_12interactions_8cationpi__calculate_ring_mean(int __pyx_v_f, int __pyx_v_start_idx, int __pyx_v_end_idx, __Pyx_memviewslice __pyx_v_rings_atoms, __Pyx_memviewslice __pyx_v_coords, __Pyx_memviewslice __pyx_v_ring_mean) {
-  __pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t __pyx_v_coor;
+static void __pyx_f_11moleculekit_12interactions_4pipi__calculate_ring_mean(int __pyx_v_f, int __pyx_v_start_idx, int __pyx_v_end_idx, __Pyx_memviewslice __pyx_v_rings_atoms, __Pyx_memviewslice __pyx_v_coords, __Pyx_memviewslice __pyx_v_ring_mean) {
+  __pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t __pyx_v_coor;
   long __pyx_v_i;
   int __pyx_v_rr;
   long __pyx_t_1;
   Py_ssize_t __pyx_t_2;
   int __pyx_t_3;
   int __pyx_t_4;
   int __pyx_t_5;
   size_t __pyx_t_6;
   Py_ssize_t __pyx_t_7;
   Py_ssize_t __pyx_t_8;
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":32
+  /* "moleculekit/interactions/pipi/pipi.pyx":32
  *     ):
  *     cdef FLOAT32_t coor
  *     for i in range(3):             # <<<<<<<<<<<<<<
  *         ring_mean[i] = 0
  * 
  */
   for (__pyx_t_1 = 0; __pyx_t_1 < 3; __pyx_t_1+=1) {
     __pyx_v_i = __pyx_t_1;
 
-    /* "moleculekit/interactions/cationpi/cationpi.pyx":33
+    /* "moleculekit/interactions/pipi/pipi.pyx":33
  *     cdef FLOAT32_t coor
  *     for i in range(3):
  *         ring_mean[i] = 0             # <<<<<<<<<<<<<<
  * 
  *     for rr in range(start_idx, end_idx):
  */
     __pyx_t_2 = __pyx_v_i;
-    *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_mean.data + __pyx_t_2 * __pyx_v_ring_mean.strides[0]) )) = 0.0;
+    *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_mean.data + __pyx_t_2 * __pyx_v_ring_mean.strides[0]) )) = 0.0;
   }
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":35
+  /* "moleculekit/interactions/pipi/pipi.pyx":35
  *         ring_mean[i] = 0
  * 
  *     for rr in range(start_idx, end_idx):             # <<<<<<<<<<<<<<
  *         for i in range(3):
  *             coor = coords[rings_atoms[rr], i, f]
  */
   __pyx_t_3 = __pyx_v_end_idx;
   __pyx_t_4 = __pyx_t_3;
   for (__pyx_t_5 = __pyx_v_start_idx; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
     __pyx_v_rr = __pyx_t_5;
 
-    /* "moleculekit/interactions/cationpi/cationpi.pyx":36
+    /* "moleculekit/interactions/pipi/pipi.pyx":36
  * 
  *     for rr in range(start_idx, end_idx):
  *         for i in range(3):             # <<<<<<<<<<<<<<
  *             coor = coords[rings_atoms[rr], i, f]
  *             ring_mean[i] = ring_mean[i] + coor
  */
     for (__pyx_t_1 = 0; __pyx_t_1 < 3; __pyx_t_1+=1) {
       __pyx_v_i = __pyx_t_1;
 
-      /* "moleculekit/interactions/cationpi/cationpi.pyx":37
+      /* "moleculekit/interactions/pipi/pipi.pyx":37
  *     for rr in range(start_idx, end_idx):
  *         for i in range(3):
  *             coor = coords[rings_atoms[rr], i, f]             # <<<<<<<<<<<<<<
  *             ring_mean[i] = ring_mean[i] + coor
  * 
  */
       __pyx_t_2 = __pyx_v_rr;
-      __pyx_t_6 = (*((__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_2 * __pyx_v_rings_atoms.strides[0]) )));
+      __pyx_t_6 = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_2 * __pyx_v_rings_atoms.strides[0]) )));
       __pyx_t_7 = __pyx_v_i;
       __pyx_t_8 = __pyx_v_f;
-      __pyx_v_coor = (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_6 * __pyx_v_coords.strides[0]) ) + __pyx_t_7 * __pyx_v_coords.strides[1]) ) + __pyx_t_8 * __pyx_v_coords.strides[2]) )));
+      __pyx_v_coor = (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_6 * __pyx_v_coords.strides[0]) ) + __pyx_t_7 * __pyx_v_coords.strides[1]) ) + __pyx_t_8 * __pyx_v_coords.strides[2]) )));
 
-      /* "moleculekit/interactions/cationpi/cationpi.pyx":38
+      /* "moleculekit/interactions/pipi/pipi.pyx":38
  *         for i in range(3):
  *             coor = coords[rings_atoms[rr], i, f]
  *             ring_mean[i] = ring_mean[i] + coor             # <<<<<<<<<<<<<<
  * 
  *     for i in range(3):
  */
       __pyx_t_2 = __pyx_v_i;
       __pyx_t_8 = __pyx_v_i;
-      *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_mean.data + __pyx_t_8 * __pyx_v_ring_mean.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_mean.data + __pyx_t_2 * __pyx_v_ring_mean.strides[0]) ))) + __pyx_v_coor);
+      *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_mean.data + __pyx_t_8 * __pyx_v_ring_mean.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_mean.data + __pyx_t_2 * __pyx_v_ring_mean.strides[0]) ))) + __pyx_v_coor);
     }
   }
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":40
+  /* "moleculekit/interactions/pipi/pipi.pyx":40
  *             ring_mean[i] = ring_mean[i] + coor
  * 
  *     for i in range(3):             # <<<<<<<<<<<<<<
  *         ring_mean[i] = ring_mean[i] / (end_idx - start_idx)
  * 
  */
   for (__pyx_t_1 = 0; __pyx_t_1 < 3; __pyx_t_1+=1) {
     __pyx_v_i = __pyx_t_1;
 
-    /* "moleculekit/interactions/cationpi/cationpi.pyx":41
+    /* "moleculekit/interactions/pipi/pipi.pyx":41
  * 
  *     for i in range(3):
  *         ring_mean[i] = ring_mean[i] / (end_idx - start_idx)             # <<<<<<<<<<<<<<
  * 
  * 
  */
     __pyx_t_2 = __pyx_v_i;
     __pyx_t_8 = __pyx_v_i;
-    *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_mean.data + __pyx_t_8 * __pyx_v_ring_mean.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_mean.data + __pyx_t_2 * __pyx_v_ring_mean.strides[0]) ))) / ((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t)(__pyx_v_end_idx - __pyx_v_start_idx)));
+    *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_mean.data + __pyx_t_8 * __pyx_v_ring_mean.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_mean.data + __pyx_t_2 * __pyx_v_ring_mean.strides[0]) ))) / ((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t)(__pyx_v_end_idx - __pyx_v_start_idx)));
   }
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":23
+  /* "moleculekit/interactions/pipi/pipi.pyx":23
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef void _calculate_ring_mean(             # <<<<<<<<<<<<<<
  *         int f,
  *         int start_idx,
  */
 
   /* function exit code */
 }
 
-/* "moleculekit/interactions/cationpi/cationpi.pyx":46
+/* "moleculekit/interactions/pipi/pipi.pyx":46
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef float _wrapped_dist(             # <<<<<<<<<<<<<<
  *         int f,
  *         FLOAT32_t[:] point1,
  */
 
-static float __pyx_f_11moleculekit_12interactions_8cationpi__wrapped_dist(int __pyx_v_f, __Pyx_memviewslice __pyx_v_point1, __Pyx_memviewslice __pyx_v_point2, __Pyx_memviewslice __pyx_v_half_box, __Pyx_memviewslice __pyx_v_box) {
-  __pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t __pyx_v_val;
+static float __pyx_f_11moleculekit_12interactions_4pipi__wrapped_dist(int __pyx_v_f, __Pyx_memviewslice __pyx_v_point1, __Pyx_memviewslice __pyx_v_point2, __Pyx_memviewslice __pyx_v_half_box, __Pyx_memviewslice __pyx_v_box) {
+  __pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t __pyx_v_val;
   float __pyx_v_dist2;
   long __pyx_v_i;
   float __pyx_r;
   long __pyx_t_1;
   Py_ssize_t __pyx_t_2;
   Py_ssize_t __pyx_t_3;
   int __pyx_t_4;
   int __pyx_t_5;
   Py_ssize_t __pyx_t_6;
   Py_ssize_t __pyx_t_7;
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":54
+  /* "moleculekit/interactions/pipi/pipi.pyx":54
  *     ):
  *     cdef FLOAT32_t val
  *     cdef float dist2 = 0             # <<<<<<<<<<<<<<
  *     for i in range(3):
  *         val = point1[i] - point2[i]
  */
   __pyx_v_dist2 = 0.0;
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":55
+  /* "moleculekit/interactions/pipi/pipi.pyx":55
  *     cdef FLOAT32_t val
  *     cdef float dist2 = 0
  *     for i in range(3):             # <<<<<<<<<<<<<<
  *         val = point1[i] - point2[i]
  *         # Wrap the distance vector into the periodic box
  */
   for (__pyx_t_1 = 0; __pyx_t_1 < 3; __pyx_t_1+=1) {
     __pyx_v_i = __pyx_t_1;
 
-    /* "moleculekit/interactions/cationpi/cationpi.pyx":56
+    /* "moleculekit/interactions/pipi/pipi.pyx":56
  *     cdef float dist2 = 0
  *     for i in range(3):
  *         val = point1[i] - point2[i]             # <<<<<<<<<<<<<<
  *         # Wrap the distance vector into the periodic box
  *         if abs(val) > half_box[i] and box[i, f] != 0:
  */
     __pyx_t_2 = __pyx_v_i;
     __pyx_t_3 = __pyx_v_i;
-    __pyx_v_val = ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_point1.data + __pyx_t_2 * __pyx_v_point1.strides[0]) ))) - (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_point2.data + __pyx_t_3 * __pyx_v_point2.strides[0]) ))));
+    __pyx_v_val = ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_point1.data + __pyx_t_2 * __pyx_v_point1.strides[0]) ))) - (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_point2.data + __pyx_t_3 * __pyx_v_point2.strides[0]) ))));
 
-    /* "moleculekit/interactions/cationpi/cationpi.pyx":58
+    /* "moleculekit/interactions/pipi/pipi.pyx":58
  *         val = point1[i] - point2[i]
  *         # Wrap the distance vector into the periodic box
  *         if abs(val) > half_box[i] and box[i, f] != 0:             # <<<<<<<<<<<<<<
  *             val = val - box[i, f] * round(val / box[i, f])
  *         dist2 = dist2 + (val * val)
  */
     __pyx_t_3 = __pyx_v_i;
-    __pyx_t_5 = (fabsf(__pyx_v_val) > (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_half_box.data + __pyx_t_3 * __pyx_v_half_box.strides[0]) ))));
+    __pyx_t_5 = (fabsf(__pyx_v_val) > (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_half_box.data + __pyx_t_3 * __pyx_v_half_box.strides[0]) ))));
     if (__pyx_t_5) {
     } else {
       __pyx_t_4 = __pyx_t_5;
       goto __pyx_L6_bool_binop_done;
     }
     __pyx_t_3 = __pyx_v_i;
     __pyx_t_2 = __pyx_v_f;
-    __pyx_t_5 = ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_3 * __pyx_v_box.strides[0]) ) + __pyx_t_2 * __pyx_v_box.strides[1]) ))) != 0.0);
+    __pyx_t_5 = ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_3 * __pyx_v_box.strides[0]) ) + __pyx_t_2 * __pyx_v_box.strides[1]) ))) != 0.0);
     __pyx_t_4 = __pyx_t_5;
     __pyx_L6_bool_binop_done:;
     if (__pyx_t_4) {
 
-      /* "moleculekit/interactions/cationpi/cationpi.pyx":59
+      /* "moleculekit/interactions/pipi/pipi.pyx":59
  *         # Wrap the distance vector into the periodic box
  *         if abs(val) > half_box[i] and box[i, f] != 0:
  *             val = val - box[i, f] * round(val / box[i, f])             # <<<<<<<<<<<<<<
  *         dist2 = dist2 + (val * val)
  *     return dist2
  */
       __pyx_t_2 = __pyx_v_i;
       __pyx_t_3 = __pyx_v_f;
       __pyx_t_6 = __pyx_v_i;
       __pyx_t_7 = __pyx_v_f;
-      __pyx_v_val = (__pyx_v_val - ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_2 * __pyx_v_box.strides[0]) ) + __pyx_t_3 * __pyx_v_box.strides[1]) ))) * round((__pyx_v_val / (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_6 * __pyx_v_box.strides[0]) ) + __pyx_t_7 * __pyx_v_box.strides[1]) )))))));
+      __pyx_v_val = (__pyx_v_val - ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_2 * __pyx_v_box.strides[0]) ) + __pyx_t_3 * __pyx_v_box.strides[1]) ))) * round((__pyx_v_val / (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_6 * __pyx_v_box.strides[0]) ) + __pyx_t_7 * __pyx_v_box.strides[1]) )))))));
 
-      /* "moleculekit/interactions/cationpi/cationpi.pyx":58
+      /* "moleculekit/interactions/pipi/pipi.pyx":58
  *         val = point1[i] - point2[i]
  *         # Wrap the distance vector into the periodic box
  *         if abs(val) > half_box[i] and box[i, f] != 0:             # <<<<<<<<<<<<<<
  *             val = val - box[i, f] * round(val / box[i, f])
  *         dist2 = dist2 + (val * val)
  */
     }
 
-    /* "moleculekit/interactions/cationpi/cationpi.pyx":60
+    /* "moleculekit/interactions/pipi/pipi.pyx":60
  *         if abs(val) > half_box[i] and box[i, f] != 0:
  *             val = val - box[i, f] * round(val / box[i, f])
  *         dist2 = dist2 + (val * val)             # <<<<<<<<<<<<<<
  *     return dist2
  * 
  */
     __pyx_v_dist2 = (__pyx_v_dist2 + (__pyx_v_val * __pyx_v_val));
   }
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":61
+  /* "moleculekit/interactions/pipi/pipi.pyx":61
  *             val = val - box[i, f] * round(val / box[i, f])
  *         dist2 = dist2 + (val * val)
  *     return dist2             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = __pyx_v_dist2;
   goto __pyx_L0;
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":46
+  /* "moleculekit/interactions/pipi/pipi.pyx":46
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef float _wrapped_dist(             # <<<<<<<<<<<<<<
  *         int f,
  *         FLOAT32_t[:] point1,
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "moleculekit/interactions/cationpi/cationpi.pyx":66
- * @cython.boundscheck(False) # turn off bounds-checking for entire function
- * @cython.wraparound(False)  # turn off negative index wrapping for entire function
- * cdef void _normalize(FLOAT32_t[:] vec):             # <<<<<<<<<<<<<<
- *     cdef float vec_norm = 0
- *     for i in range(3):
- */
-
-static void __pyx_f_11moleculekit_12interactions_8cationpi__normalize(__Pyx_memviewslice __pyx_v_vec) {
-  float __pyx_v_vec_norm;
-  long __pyx_v_i;
-  long __pyx_t_1;
-  Py_ssize_t __pyx_t_2;
-  Py_ssize_t __pyx_t_3;
-
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":67
- * @cython.wraparound(False)  # turn off negative index wrapping for entire function
- * cdef void _normalize(FLOAT32_t[:] vec):
- *     cdef float vec_norm = 0             # <<<<<<<<<<<<<<
- *     for i in range(3):
- *         vec_norm = vec_norm + (vec[i] * vec[i])
- */
-  __pyx_v_vec_norm = 0.0;
-
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":68
- * cdef void _normalize(FLOAT32_t[:] vec):
- *     cdef float vec_norm = 0
- *     for i in range(3):             # <<<<<<<<<<<<<<
- *         vec_norm = vec_norm + (vec[i] * vec[i])
- *     vec_norm = sqrt(vec_norm)
- */
-  for (__pyx_t_1 = 0; __pyx_t_1 < 3; __pyx_t_1+=1) {
-    __pyx_v_i = __pyx_t_1;
-
-    /* "moleculekit/interactions/cationpi/cationpi.pyx":69
- *     cdef float vec_norm = 0
- *     for i in range(3):
- *         vec_norm = vec_norm + (vec[i] * vec[i])             # <<<<<<<<<<<<<<
- *     vec_norm = sqrt(vec_norm)
- * 
- */
-    __pyx_t_2 = __pyx_v_i;
-    __pyx_t_3 = __pyx_v_i;
-    __pyx_v_vec_norm = (__pyx_v_vec_norm + ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec.data + __pyx_t_2 * __pyx_v_vec.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec.data + __pyx_t_3 * __pyx_v_vec.strides[0]) )))));
-  }
-
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":70
- *     for i in range(3):
- *         vec_norm = vec_norm + (vec[i] * vec[i])
- *     vec_norm = sqrt(vec_norm)             # <<<<<<<<<<<<<<
- * 
- *     for i in range(3):
- */
-  __pyx_v_vec_norm = sqrt(__pyx_v_vec_norm);
-
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":72
- *     vec_norm = sqrt(vec_norm)
- * 
- *     for i in range(3):             # <<<<<<<<<<<<<<
- *         vec[i] = vec[i] / vec_norm
- * 
- */
-  for (__pyx_t_1 = 0; __pyx_t_1 < 3; __pyx_t_1+=1) {
-    __pyx_v_i = __pyx_t_1;
-
-    /* "moleculekit/interactions/cationpi/cationpi.pyx":73
- * 
- *     for i in range(3):
- *         vec[i] = vec[i] / vec_norm             # <<<<<<<<<<<<<<
- * 
- * 
- */
-    __pyx_t_3 = __pyx_v_i;
-    __pyx_t_2 = __pyx_v_i;
-    *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec.data + __pyx_t_2 * __pyx_v_vec.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec.data + __pyx_t_3 * __pyx_v_vec.strides[0]) ))) / ((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t)__pyx_v_vec_norm));
-  }
-
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":66
- * @cython.boundscheck(False) # turn off bounds-checking for entire function
- * @cython.wraparound(False)  # turn off negative index wrapping for entire function
- * cdef void _normalize(FLOAT32_t[:] vec):             # <<<<<<<<<<<<<<
- *     cdef float vec_norm = 0
- *     for i in range(3):
- */
-
-  /* function exit code */
-}
-
-/* "moleculekit/interactions/cationpi/cationpi.pyx":78
+/* "moleculekit/interactions/pipi/pipi.pyx":66
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef void _cross_product(             # <<<<<<<<<<<<<<
  *         FLOAT32_t[:] vec_a,
  *         FLOAT32_t[:] vec_b,
  */
 
-static void __pyx_f_11moleculekit_12interactions_8cationpi__cross_product(__Pyx_memviewslice __pyx_v_vec_a, __Pyx_memviewslice __pyx_v_vec_b, __Pyx_memviewslice __pyx_v_res) {
+static void __pyx_f_11moleculekit_12interactions_4pipi__cross_product(__Pyx_memviewslice __pyx_v_vec_a, __Pyx_memviewslice __pyx_v_vec_b, __Pyx_memviewslice __pyx_v_res) {
+  float __pyx_v_vec_norm;
+  long __pyx_v_i;
   Py_ssize_t __pyx_t_1;
   Py_ssize_t __pyx_t_2;
   Py_ssize_t __pyx_t_3;
   Py_ssize_t __pyx_t_4;
   Py_ssize_t __pyx_t_5;
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
+  long __pyx_t_6;
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":83
+  /* "moleculekit/interactions/pipi/pipi.pyx":71
  *         FLOAT32_t[:] res,
  *     ):
  *     res[0] = vec_a[1] * vec_b[2] - vec_a[2] * vec_b[1]             # <<<<<<<<<<<<<<
  *     res[1] = vec_a[2] * vec_b[0] - vec_a[0] * vec_b[2]
  *     res[2] = vec_a[0] * vec_b[1] - vec_a[1] * vec_b[0]
  */
   __pyx_t_1 = 1;
   __pyx_t_2 = 2;
   __pyx_t_3 = 2;
   __pyx_t_4 = 1;
   __pyx_t_5 = 0;
-  *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_res.data + __pyx_t_5 * __pyx_v_res.strides[0]) )) = (((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_1 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_2 * __pyx_v_vec_b.strides[0]) )))) - ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_3 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_4 * __pyx_v_vec_b.strides[0]) )))));
+  *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_res.data + __pyx_t_5 * __pyx_v_res.strides[0]) )) = (((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_1 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_2 * __pyx_v_vec_b.strides[0]) )))) - ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_3 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_4 * __pyx_v_vec_b.strides[0]) )))));
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":84
+  /* "moleculekit/interactions/pipi/pipi.pyx":72
  *     ):
  *     res[0] = vec_a[1] * vec_b[2] - vec_a[2] * vec_b[1]
  *     res[1] = vec_a[2] * vec_b[0] - vec_a[0] * vec_b[2]             # <<<<<<<<<<<<<<
  *     res[2] = vec_a[0] * vec_b[1] - vec_a[1] * vec_b[0]
  * 
  */
   __pyx_t_4 = 2;
   __pyx_t_3 = 0;
   __pyx_t_2 = 0;
   __pyx_t_1 = 2;
   __pyx_t_5 = 1;
-  *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_res.data + __pyx_t_5 * __pyx_v_res.strides[0]) )) = (((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_4 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_3 * __pyx_v_vec_b.strides[0]) )))) - ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_2 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_1 * __pyx_v_vec_b.strides[0]) )))));
+  *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_res.data + __pyx_t_5 * __pyx_v_res.strides[0]) )) = (((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_4 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_3 * __pyx_v_vec_b.strides[0]) )))) - ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_2 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_1 * __pyx_v_vec_b.strides[0]) )))));
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":85
+  /* "moleculekit/interactions/pipi/pipi.pyx":73
  *     res[0] = vec_a[1] * vec_b[2] - vec_a[2] * vec_b[1]
  *     res[1] = vec_a[2] * vec_b[0] - vec_a[0] * vec_b[2]
  *     res[2] = vec_a[0] * vec_b[1] - vec_a[1] * vec_b[0]             # <<<<<<<<<<<<<<
  * 
- *     _normalize(res)
+ *     cdef float vec_norm = 0
  */
   __pyx_t_1 = 0;
   __pyx_t_2 = 1;
   __pyx_t_3 = 1;
   __pyx_t_4 = 0;
   __pyx_t_5 = 2;
-  *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_res.data + __pyx_t_5 * __pyx_v_res.strides[0]) )) = (((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_1 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_2 * __pyx_v_vec_b.strides[0]) )))) - ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_3 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_4 * __pyx_v_vec_b.strides[0]) )))));
+  *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_res.data + __pyx_t_5 * __pyx_v_res.strides[0]) )) = (((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_1 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_2 * __pyx_v_vec_b.strides[0]) )))) - ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_3 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_4 * __pyx_v_vec_b.strides[0]) )))));
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":87
+  /* "moleculekit/interactions/pipi/pipi.pyx":75
  *     res[2] = vec_a[0] * vec_b[1] - vec_a[1] * vec_b[0]
  * 
- *     _normalize(res)             # <<<<<<<<<<<<<<
+ *     cdef float vec_norm = 0             # <<<<<<<<<<<<<<
+ *     for i in range(3):
+ *         vec_norm = vec_norm + (res[i] * res[i])
+ */
+  __pyx_v_vec_norm = 0.0;
+
+  /* "moleculekit/interactions/pipi/pipi.pyx":76
  * 
+ *     cdef float vec_norm = 0
+ *     for i in range(3):             # <<<<<<<<<<<<<<
+ *         vec_norm = vec_norm + (res[i] * res[i])
+ *     vec_norm = sqrt(vec_norm)
+ */
+  for (__pyx_t_6 = 0; __pyx_t_6 < 3; __pyx_t_6+=1) {
+    __pyx_v_i = __pyx_t_6;
+
+    /* "moleculekit/interactions/pipi/pipi.pyx":77
+ *     cdef float vec_norm = 0
+ *     for i in range(3):
+ *         vec_norm = vec_norm + (res[i] * res[i])             # <<<<<<<<<<<<<<
+ *     vec_norm = sqrt(vec_norm)
  * 
  */
-  __pyx_f_11moleculekit_12interactions_8cationpi__normalize(__pyx_v_res); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 87, __pyx_L1_error)
+    __pyx_t_4 = __pyx_v_i;
+    __pyx_t_3 = __pyx_v_i;
+    __pyx_v_vec_norm = (__pyx_v_vec_norm + ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_res.data + __pyx_t_4 * __pyx_v_res.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_res.data + __pyx_t_3 * __pyx_v_res.strides[0]) )))));
+  }
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":78
+  /* "moleculekit/interactions/pipi/pipi.pyx":78
+ *     for i in range(3):
+ *         vec_norm = vec_norm + (res[i] * res[i])
+ *     vec_norm = sqrt(vec_norm)             # <<<<<<<<<<<<<<
+ * 
+ *     for i in range(3):
+ */
+  __pyx_v_vec_norm = sqrt(__pyx_v_vec_norm);
+
+  /* "moleculekit/interactions/pipi/pipi.pyx":80
+ *     vec_norm = sqrt(vec_norm)
+ * 
+ *     for i in range(3):             # <<<<<<<<<<<<<<
+ *         res[i] = res[i] / vec_norm
+ * 
+ */
+  for (__pyx_t_6 = 0; __pyx_t_6 < 3; __pyx_t_6+=1) {
+    __pyx_v_i = __pyx_t_6;
+
+    /* "moleculekit/interactions/pipi/pipi.pyx":81
+ * 
+ *     for i in range(3):
+ *         res[i] = res[i] / vec_norm             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+    __pyx_t_3 = __pyx_v_i;
+    __pyx_t_4 = __pyx_v_i;
+    *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_res.data + __pyx_t_4 * __pyx_v_res.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_res.data + __pyx_t_3 * __pyx_v_res.strides[0]) ))) / ((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t)__pyx_v_vec_norm));
+  }
+
+  /* "moleculekit/interactions/pipi/pipi.pyx":66
  * @cython.boundscheck(False) # turn off bounds-checking for entire function
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * cdef void _cross_product(             # <<<<<<<<<<<<<<
  *         FLOAT32_t[:] vec_a,
  *         FLOAT32_t[:] vec_b,
  */
 
   /* function exit code */
-  goto __pyx_L0;
-  __pyx_L1_error:;
-  __Pyx_AddTraceback("moleculekit.interactions.cationpi._cross_product", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __pyx_L0:;
 }
 
-/* "moleculekit/interactions/cationpi/cationpi.pyx":90
+/* "moleculekit/interactions/pipi/pipi.pyx":84
  * 
  * 
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def calculate(
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11moleculekit_12interactions_8cationpi_1calculate(PyObject *__pyx_self, 
+static PyObject *__pyx_pw_11moleculekit_12interactions_4pipi_1calculate(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ); /*proto*/
-static PyMethodDef __pyx_mdef_11moleculekit_12interactions_8cationpi_1calculate = {"calculate", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11moleculekit_12interactions_8cationpi_1calculate, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_11moleculekit_12interactions_8cationpi_1calculate(PyObject *__pyx_self, 
+static PyMethodDef __pyx_mdef_11moleculekit_12interactions_4pipi_1calculate = {"calculate", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11moleculekit_12interactions_4pipi_1calculate, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11moleculekit_12interactions_4pipi_1calculate(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ) {
-  PyArrayObject *__pyx_v_rings_atoms = 0;
-  PyArrayObject *__pyx_v_rings_start_indexes = 0;
-  PyArrayObject *__pyx_v_cations = 0;
-  PyArrayObject *__pyx_v_coords = 0;
-  PyArrayObject *__pyx_v_box = 0;
-  float __pyx_v_dist_threshold;
-  float __pyx_v_angle_threshold_min;
+  __Pyx_memviewslice __pyx_v_rings_atoms = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_rings1_start_indexes = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_rings2_start_indexes = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_coords = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_box = { 0, 0, { 0 }, { 0 }, { 0 } };
+  float __pyx_v_dist_threshold1;
+  float __pyx_v_angle_threshold1_max;
+  float __pyx_v_dist_threshold2;
+  float __pyx_v_angle_threshold2_min;
   #if !CYTHON_METH_FASTCALL
   CYTHON_UNUSED Py_ssize_t __pyx_nargs;
   #endif
   CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
-  PyObject* values[7] = {0,0,0,0,0,0,0};
+  PyObject* values[9] = {0,0,0,0,0,0,0,0,0};
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("calculate (wrapper)", 0);
   #if !CYTHON_METH_FASTCALL
@@ -20444,18 +20416,22 @@
   __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
   #else
   __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
   #endif
   #endif
   __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
   {
-    PyObject **__pyx_pyargnames[] = {&__pyx_n_s_rings_atoms,&__pyx_n_s_rings_start_indexes,&__pyx_n_s_cations,&__pyx_n_s_coords,&__pyx_n_s_box,&__pyx_n_s_dist_threshold,&__pyx_n_s_angle_threshold_min,0};
+    PyObject **__pyx_pyargnames[] = {&__pyx_n_s_rings_atoms,&__pyx_n_s_rings1_start_indexes,&__pyx_n_s_rings2_start_indexes,&__pyx_n_s_coords,&__pyx_n_s_box,&__pyx_n_s_dist_threshold1,&__pyx_n_s_angle_threshold1_max,&__pyx_n_s_dist_threshold2,&__pyx_n_s_angle_threshold2_min,0};
     if (__pyx_kwds) {
       Py_ssize_t kw_args;
       switch (__pyx_nargs) {
+        case  9: values[8] = __Pyx_Arg_FASTCALL(__pyx_args, 8);
+        CYTHON_FALLTHROUGH;
+        case  8: values[7] = __Pyx_Arg_FASTCALL(__pyx_args, 7);
+        CYTHON_FALLTHROUGH;
         case  7: values[6] = __Pyx_Arg_FASTCALL(__pyx_args, 6);
         CYTHON_FALLTHROUGH;
         case  6: values[5] = __Pyx_Arg_FASTCALL(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
         case  5: values[4] = __Pyx_Arg_FASTCALL(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
@@ -20472,975 +20448,1122 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_rings_atoms)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 90, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 84, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_rings_start_indexes)) != 0)) {
+        if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_rings1_start_indexes)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 90, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 84, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("calculate", 0, 5, 7, 1); __PYX_ERR(0, 90, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calculate", 0, 5, 9, 1); __PYX_ERR(0, 84, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
-        if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_cations)) != 0)) {
+        if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_rings2_start_indexes)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 90, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 84, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("calculate", 0, 5, 7, 2); __PYX_ERR(0, 90, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calculate", 0, 5, 9, 2); __PYX_ERR(0, 84, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_coords)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[3]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 90, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 84, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("calculate", 0, 5, 7, 3); __PYX_ERR(0, 90, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calculate", 0, 5, 9, 3); __PYX_ERR(0, 84, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_box)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[4]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 90, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 84, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("calculate", 0, 5, 7, 4); __PYX_ERR(0, 90, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calculate", 0, 5, 9, 4); __PYX_ERR(0, 84, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dist_threshold);
+          PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dist_threshold1);
           if (value) { values[5] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 90, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 84, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_angle_threshold_min);
+          PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_angle_threshold1_max);
           if (value) { values[6] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 90, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 84, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  7:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dist_threshold2);
+          if (value) { values[7] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 84, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  8:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_angle_threshold2_min);
+          if (value) { values[8] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 84, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "calculate") < 0)) __PYX_ERR(0, 90, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "calculate") < 0)) __PYX_ERR(0, 84, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
+        case  9: values[8] = __Pyx_Arg_FASTCALL(__pyx_args, 8);
+        CYTHON_FALLTHROUGH;
+        case  8: values[7] = __Pyx_Arg_FASTCALL(__pyx_args, 7);
+        CYTHON_FALLTHROUGH;
         case  7: values[6] = __Pyx_Arg_FASTCALL(__pyx_args, 6);
         CYTHON_FALLTHROUGH;
         case  6: values[5] = __Pyx_Arg_FASTCALL(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
         case  5: values[4] = __Pyx_Arg_FASTCALL(__pyx_args, 4);
         values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
         values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
         values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
         values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
-    __pyx_v_rings_atoms = ((PyArrayObject *)values[0]);
-    __pyx_v_rings_start_indexes = ((PyArrayObject *)values[1]);
-    __pyx_v_cations = ((PyArrayObject *)values[2]);
-    __pyx_v_coords = ((PyArrayObject *)values[3]);
-    __pyx_v_box = ((PyArrayObject *)values[4]);
+    __pyx_v_rings_atoms = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_UINT32_t(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_rings_atoms.memview)) __PYX_ERR(0, 87, __pyx_L3_error)
+    __pyx_v_rings1_start_indexes = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_UINT32_t(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_rings1_start_indexes.memview)) __PYX_ERR(0, 88, __pyx_L3_error)
+    __pyx_v_rings2_start_indexes = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_UINT32_t(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_rings2_start_indexes.memview)) __PYX_ERR(0, 89, __pyx_L3_error)
+    __pyx_v_coords = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_coords.memview)) __PYX_ERR(0, 90, __pyx_L3_error)
+    __pyx_v_box = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(values[4], PyBUF_WRITABLE); if (unlikely(!__pyx_v_box.memview)) __PYX_ERR(0, 91, __pyx_L3_error)
     if (values[5]) {
-      __pyx_v_dist_threshold = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_dist_threshold == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 98, __pyx_L3_error)
+      __pyx_v_dist_threshold1 = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_dist_threshold1 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 92, __pyx_L3_error)
     } else {
-      __pyx_v_dist_threshold = ((float)((float)5.0));
+      __pyx_v_dist_threshold1 = ((float)((double)4.4));
     }
     if (values[6]) {
-      __pyx_v_angle_threshold_min = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_angle_threshold_min == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 99, __pyx_L3_error)
+      __pyx_v_angle_threshold1_max = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_angle_threshold1_max == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 93, __pyx_L3_error)
     } else {
-      __pyx_v_angle_threshold_min = ((float)((float)60.0));
+      __pyx_v_angle_threshold1_max = ((float)((float)30.0));
+    }
+    if (values[7]) {
+      __pyx_v_dist_threshold2 = __pyx_PyFloat_AsFloat(values[7]); if (unlikely((__pyx_v_dist_threshold2 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 94, __pyx_L3_error)
+    } else {
+      __pyx_v_dist_threshold2 = ((float)((double)5.5));
+    }
+    if (values[8]) {
+      __pyx_v_angle_threshold2_min = __pyx_PyFloat_AsFloat(values[8]); if (unlikely((__pyx_v_angle_threshold2_min == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 95, __pyx_L3_error)
+    } else {
+      __pyx_v_angle_threshold2_min = ((float)((float)60.0));
     }
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("calculate", 0, 5, 7, __pyx_nargs); __PYX_ERR(0, 90, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("calculate", 0, 5, 9, __pyx_nargs); __PYX_ERR(0, 84, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
-  __Pyx_AddTraceback("moleculekit.interactions.cationpi.calculate", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_rings_atoms, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_rings1_start_indexes, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_rings2_start_indexes, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_coords, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_box, 1);
+  __Pyx_AddTraceback("moleculekit.interactions.pipi.calculate", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_rings_atoms), __pyx_ptype_5numpy_ndarray, 1, "rings_atoms", 0))) __PYX_ERR(0, 93, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_rings_start_indexes), __pyx_ptype_5numpy_ndarray, 1, "rings_start_indexes", 0))) __PYX_ERR(0, 94, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_cations), __pyx_ptype_5numpy_ndarray, 1, "cations", 0))) __PYX_ERR(0, 95, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_coords), __pyx_ptype_5numpy_ndarray, 1, "coords", 0))) __PYX_ERR(0, 96, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_box), __pyx_ptype_5numpy_ndarray, 1, "box", 0))) __PYX_ERR(0, 97, __pyx_L1_error)
-  __pyx_r = __pyx_pf_11moleculekit_12interactions_8cationpi_calculate(__pyx_self, __pyx_v_rings_atoms, __pyx_v_rings_start_indexes, __pyx_v_cations, __pyx_v_coords, __pyx_v_box, __pyx_v_dist_threshold, __pyx_v_angle_threshold_min);
+  __pyx_r = __pyx_pf_11moleculekit_12interactions_4pipi_calculate(__pyx_self, __pyx_v_rings_atoms, __pyx_v_rings1_start_indexes, __pyx_v_rings2_start_indexes, __pyx_v_coords, __pyx_v_box, __pyx_v_dist_threshold1, __pyx_v_angle_threshold1_max, __pyx_v_dist_threshold2, __pyx_v_angle_threshold2_min);
 
   /* function exit code */
-  goto __pyx_L0;
-  __pyx_L1_error:;
-  __pyx_r = NULL;
-  __pyx_L0:;
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_rings_atoms, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_rings1_start_indexes, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_rings2_start_indexes, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_coords, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_box, 1);
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11moleculekit_12interactions_8cationpi_calculate(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_rings_atoms, PyArrayObject *__pyx_v_rings_start_indexes, PyArrayObject *__pyx_v_cations, PyArrayObject *__pyx_v_coords, PyArrayObject *__pyx_v_box, float __pyx_v_dist_threshold, float __pyx_v_angle_threshold_min) {
+static PyObject *__pyx_pf_11moleculekit_12interactions_4pipi_calculate(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_rings_atoms, __Pyx_memviewslice __pyx_v_rings1_start_indexes, __Pyx_memviewslice __pyx_v_rings2_start_indexes, __Pyx_memviewslice __pyx_v_coords, __Pyx_memviewslice __pyx_v_box, float __pyx_v_dist_threshold1, float __pyx_v_angle_threshold1_max, float __pyx_v_dist_threshold2, float __pyx_v_angle_threshold2_min) {
   int __pyx_v_r1;
   int __pyx_v_r2;
   int __pyx_v_f;
   int __pyx_v_i;
-  int __pyx_v_n_rings;
-  int __pyx_v_n_cations;
+  int __pyx_v_n_rings1;
+  int __pyx_v_n_rings2;
   int __pyx_v_n_frames;
   std::vector<std::vector<int> >  __pyx_v_results;
   std::vector<std::vector<float> >  __pyx_v_distangles;
-  __Pyx_memviewslice __pyx_v_ring_mean = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_ring_normal = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_ring1_mean = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_ring2_mean = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_ring1_normal = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_ring2_normal = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_half_box = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_cation_coor = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_tmp1 = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_tmp2 = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t __pyx_v_dist2;
-  __pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t __pyx_v_dot_prod;
-  int __pyx_v_r_start_idx;
-  int __pyx_v_r_end_idx;
+  __pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t __pyx_v_dist2;
+  __pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t __pyx_v_dot_prod;
+  int __pyx_v_r1_start_idx;
+  int __pyx_v_r2_start_idx;
+  int __pyx_v_r1_end_idx;
+  int __pyx_v_r2_end_idx;
   double __pyx_v_angle;
-  __Pyx_LocalBuf_ND __pyx_pybuffernd_box;
-  __Pyx_Buffer __pyx_pybuffer_box;
-  __Pyx_LocalBuf_ND __pyx_pybuffernd_cations;
-  __Pyx_Buffer __pyx_pybuffer_cations;
-  __Pyx_LocalBuf_ND __pyx_pybuffernd_coords;
-  __Pyx_Buffer __pyx_pybuffer_coords;
-  __Pyx_LocalBuf_ND __pyx_pybuffernd_rings_atoms;
-  __Pyx_Buffer __pyx_pybuffer_rings_atoms;
-  __Pyx_LocalBuf_ND __pyx_pybuffernd_rings_start_indexes;
-  __Pyx_Buffer __pyx_pybuffer_rings_start_indexes;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
-  npy_intp *__pyx_t_1;
+  PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
-  PyObject *__pyx_t_4 = NULL;
-  __Pyx_memviewslice __pyx_t_5 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_t_4 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_t_5;
   int __pyx_t_6;
   int __pyx_t_7;
-  int __pyx_t_8;
-  std::vector<int>  __pyx_t_9;
-  std::vector<float>  __pyx_t_10;
-  int __pyx_t_11;
+  std::vector<int>  __pyx_t_8;
+  std::vector<float>  __pyx_t_9;
+  int __pyx_t_10;
+  Py_ssize_t __pyx_t_11;
   Py_ssize_t __pyx_t_12;
   Py_ssize_t __pyx_t_13;
-  Py_ssize_t __pyx_t_14;
+  int __pyx_t_14;
   int __pyx_t_15;
   int __pyx_t_16;
   int __pyx_t_17;
   int __pyx_t_18;
   int __pyx_t_19;
-  __Pyx_memviewslice __pyx_t_20 = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_t_21 = { 0, 0, { 0 }, { 0 }, { 0 } };
-  int __pyx_t_22;
-  size_t __pyx_t_23;
-  Py_ssize_t __pyx_t_24;
-  __Pyx_memviewslice __pyx_t_25 = { 0, 0, { 0 }, { 0 }, { 0 } };
-  float __pyx_t_26;
-  int __pyx_t_27;
-  size_t __pyx_t_28;
-  Py_ssize_t __pyx_t_29;
-  Py_ssize_t __pyx_t_30;
-  Py_ssize_t __pyx_t_31;
+  int __pyx_t_20;
+  int __pyx_t_21;
+  size_t __pyx_t_22;
+  Py_ssize_t __pyx_t_23;
+  float __pyx_t_24;
+  size_t __pyx_t_25;
+  Py_ssize_t __pyx_t_26;
+  Py_ssize_t __pyx_t_27;
+  Py_ssize_t __pyx_t_28;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("calculate", 1);
-  __pyx_pybuffer_rings_atoms.pybuffer.buf = NULL;
-  __pyx_pybuffer_rings_atoms.refcount = 0;
-  __pyx_pybuffernd_rings_atoms.data = NULL;
-  __pyx_pybuffernd_rings_atoms.rcbuffer = &__pyx_pybuffer_rings_atoms;
-  __pyx_pybuffer_rings_start_indexes.pybuffer.buf = NULL;
-  __pyx_pybuffer_rings_start_indexes.refcount = 0;
-  __pyx_pybuffernd_rings_start_indexes.data = NULL;
-  __pyx_pybuffernd_rings_start_indexes.rcbuffer = &__pyx_pybuffer_rings_start_indexes;
-  __pyx_pybuffer_cations.pybuffer.buf = NULL;
-  __pyx_pybuffer_cations.refcount = 0;
-  __pyx_pybuffernd_cations.data = NULL;
-  __pyx_pybuffernd_cations.rcbuffer = &__pyx_pybuffer_cations;
-  __pyx_pybuffer_coords.pybuffer.buf = NULL;
-  __pyx_pybuffer_coords.refcount = 0;
-  __pyx_pybuffernd_coords.data = NULL;
-  __pyx_pybuffernd_coords.rcbuffer = &__pyx_pybuffer_coords;
-  __pyx_pybuffer_box.pybuffer.buf = NULL;
-  __pyx_pybuffer_box.refcount = 0;
-  __pyx_pybuffernd_box.data = NULL;
-  __pyx_pybuffernd_box.rcbuffer = &__pyx_pybuffer_box;
-  {
-    __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_rings_atoms.rcbuffer->pybuffer, (PyObject*)__pyx_v_rings_atoms, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 90, __pyx_L1_error)
-  }
-  __pyx_pybuffernd_rings_atoms.diminfo[0].strides = __pyx_pybuffernd_rings_atoms.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_rings_atoms.diminfo[0].shape = __pyx_pybuffernd_rings_atoms.rcbuffer->pybuffer.shape[0];
-  {
-    __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_rings_start_indexes.rcbuffer->pybuffer, (PyObject*)__pyx_v_rings_start_indexes, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 90, __pyx_L1_error)
-  }
-  __pyx_pybuffernd_rings_start_indexes.diminfo[0].strides = __pyx_pybuffernd_rings_start_indexes.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_rings_start_indexes.diminfo[0].shape = __pyx_pybuffernd_rings_start_indexes.rcbuffer->pybuffer.shape[0];
-  {
-    __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_cations.rcbuffer->pybuffer, (PyObject*)__pyx_v_cations, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 90, __pyx_L1_error)
-  }
-  __pyx_pybuffernd_cations.diminfo[0].strides = __pyx_pybuffernd_cations.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_cations.diminfo[0].shape = __pyx_pybuffernd_cations.rcbuffer->pybuffer.shape[0];
-  {
-    __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_coords.rcbuffer->pybuffer, (PyObject*)__pyx_v_coords, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) __PYX_ERR(0, 90, __pyx_L1_error)
-  }
-  __pyx_pybuffernd_coords.diminfo[0].strides = __pyx_pybuffernd_coords.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_coords.diminfo[0].shape = __pyx_pybuffernd_coords.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_coords.diminfo[1].strides = __pyx_pybuffernd_coords.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_coords.diminfo[1].shape = __pyx_pybuffernd_coords.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_coords.diminfo[2].strides = __pyx_pybuffernd_coords.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_coords.diminfo[2].shape = __pyx_pybuffernd_coords.rcbuffer->pybuffer.shape[2];
-  {
-    __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_box.rcbuffer->pybuffer, (PyObject*)__pyx_v_box, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 90, __pyx_L1_error)
-  }
-  __pyx_pybuffernd_box.diminfo[0].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box.diminfo[0].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_box.diminfo[1].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_box.diminfo[1].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[1];
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":102
+  /* "moleculekit/interactions/pipi/pipi.pyx":98
  *     ):
  *     cdef int r1, r2, f, i
- *     cdef int n_rings = rings_start_indexes.shape[0] - 1 # Subtract 1 for the added 0 index at the start             # <<<<<<<<<<<<<<
- *     cdef int n_cations = cations.shape[0]
+ *     cdef int n_rings1 = rings1_start_indexes.shape[0] - 1  # Remove one for the index which we append to the start             # <<<<<<<<<<<<<<
+ *     cdef int n_rings2 = rings2_start_indexes.shape[0] - 1
  *     cdef int n_frames = coords.shape[2]
  */
-  __pyx_t_1 = __pyx_f_5numpy_7ndarray_5shape_shape(((PyArrayObject *)__pyx_v_rings_start_indexes)); if (unlikely(__pyx_t_1 == ((npy_intp *)NULL) && PyErr_Occurred())) __PYX_ERR(0, 102, __pyx_L1_error)
-  __pyx_v_n_rings = ((__pyx_t_1[0]) - 1);
+  __pyx_v_n_rings1 = ((__pyx_v_rings1_start_indexes.shape[0]) - 1);
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":103
+  /* "moleculekit/interactions/pipi/pipi.pyx":99
  *     cdef int r1, r2, f, i
- *     cdef int n_rings = rings_start_indexes.shape[0] - 1 # Subtract 1 for the added 0 index at the start
- *     cdef int n_cations = cations.shape[0]             # <<<<<<<<<<<<<<
+ *     cdef int n_rings1 = rings1_start_indexes.shape[0] - 1  # Remove one for the index which we append to the start
+ *     cdef int n_rings2 = rings2_start_indexes.shape[0] - 1             # <<<<<<<<<<<<<<
  *     cdef int n_frames = coords.shape[2]
  * 
  */
-  __pyx_t_1 = __pyx_f_5numpy_7ndarray_5shape_shape(((PyArrayObject *)__pyx_v_cations)); if (unlikely(__pyx_t_1 == ((npy_intp *)NULL) && PyErr_Occurred())) __PYX_ERR(0, 103, __pyx_L1_error)
-  __pyx_v_n_cations = (__pyx_t_1[0]);
+  __pyx_v_n_rings2 = ((__pyx_v_rings2_start_indexes.shape[0]) - 1);
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":104
- *     cdef int n_rings = rings_start_indexes.shape[0] - 1 # Subtract 1 for the added 0 index at the start
- *     cdef int n_cations = cations.shape[0]
+  /* "moleculekit/interactions/pipi/pipi.pyx":100
+ *     cdef int n_rings1 = rings1_start_indexes.shape[0] - 1  # Remove one for the index which we append to the start
+ *     cdef int n_rings2 = rings2_start_indexes.shape[0] - 1
  *     cdef int n_frames = coords.shape[2]             # <<<<<<<<<<<<<<
  * 
  *     cdef vector[vector[int]] results
  */
-  __pyx_t_1 = __pyx_f_5numpy_7ndarray_5shape_shape(((PyArrayObject *)__pyx_v_coords)); if (unlikely(__pyx_t_1 == ((npy_intp *)NULL) && PyErr_Occurred())) __PYX_ERR(0, 104, __pyx_L1_error)
-  __pyx_v_n_frames = (__pyx_t_1[2]);
+  __pyx_v_n_frames = (__pyx_v_coords.shape[2]);
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":108
+  /* "moleculekit/interactions/pipi/pipi.pyx":104
  *     cdef vector[vector[int]] results
  *     cdef vector[vector[float]] distangles
- *     cdef FLOAT32_t[:] ring_mean = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
- *     cdef FLOAT32_t[:] ring_normal = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] ring1_mean = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
+ *     cdef FLOAT32_t[:] ring2_mean = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] ring1_normal = np.zeros(3, dtype=FLOAT32)
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 104, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 104, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 104, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 104, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 104, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__11, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 104, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 104, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_v_ring1_mean = __pyx_t_4;
+  __pyx_t_4.memview = NULL;
+  __pyx_t_4.data = NULL;
+
+  /* "moleculekit/interactions/pipi/pipi.pyx":105
+ *     cdef vector[vector[float]] distangles
+ *     cdef FLOAT32_t[:] ring1_mean = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] ring2_mean = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
+ *     cdef FLOAT32_t[:] ring1_normal = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] ring2_normal = np.zeros(3, dtype=FLOAT32)
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 105, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 105, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 105, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 105, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 105, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__11, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 105, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 105, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_v_ring2_mean = __pyx_t_4;
+  __pyx_t_4.memview = NULL;
+  __pyx_t_4.data = NULL;
+
+  /* "moleculekit/interactions/pipi/pipi.pyx":106
+ *     cdef FLOAT32_t[:] ring1_mean = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] ring2_mean = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] ring1_normal = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
+ *     cdef FLOAT32_t[:] ring2_normal = np.zeros(3, dtype=FLOAT32)
  *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 108, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 106, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 108, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 106, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 108, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 106, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 108, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 108, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__11, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 108, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 106, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 106, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__11, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 106, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 108, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_v_ring_mean = __pyx_t_5;
-  __pyx_t_5.memview = NULL;
-  __pyx_t_5.data = NULL;
-
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":109
- *     cdef vector[vector[float]] distangles
- *     cdef FLOAT32_t[:] ring_mean = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] ring_normal = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
+  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 106, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_ring1_normal = __pyx_t_4;
+  __pyx_t_4.memview = NULL;
+  __pyx_t_4.data = NULL;
+
+  /* "moleculekit/interactions/pipi/pipi.pyx":107
+ *     cdef FLOAT32_t[:] ring2_mean = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] ring1_normal = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] ring2_normal = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
  *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] cation_coor = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] tmp1 = np.zeros(3, dtype=FLOAT32)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 109, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 109, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 107, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 107, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 109, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 109, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 107, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 107, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 109, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 107, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__11, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 109, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__11, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 107, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 109, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 107, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_v_ring_normal = __pyx_t_5;
-  __pyx_t_5.memview = NULL;
-  __pyx_t_5.data = NULL;
-
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":110
- *     cdef FLOAT32_t[:] ring_mean = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] ring_normal = np.zeros(3, dtype=FLOAT32)
+  __pyx_v_ring2_normal = __pyx_t_4;
+  __pyx_t_4.memview = NULL;
+  __pyx_t_4.data = NULL;
+
+  /* "moleculekit/interactions/pipi/pipi.pyx":108
+ *     cdef FLOAT32_t[:] ring1_normal = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] ring2_normal = np.zeros(3, dtype=FLOAT32)
  *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
- *     cdef FLOAT32_t[:] cation_coor = np.zeros(3, dtype=FLOAT32)
  *     cdef FLOAT32_t[:] tmp1 = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] tmp2 = np.zeros(3, dtype=FLOAT32)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 110, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 110, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 108, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 110, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 110, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 110, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 108, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__11, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 110, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__11, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 110, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 108, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_v_half_box = __pyx_t_5;
-  __pyx_t_5.memview = NULL;
-  __pyx_t_5.data = NULL;
+  __pyx_v_half_box = __pyx_t_4;
+  __pyx_t_4.memview = NULL;
+  __pyx_t_4.data = NULL;
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":111
- *     cdef FLOAT32_t[:] ring_normal = np.zeros(3, dtype=FLOAT32)
+  /* "moleculekit/interactions/pipi/pipi.pyx":109
+ *     cdef FLOAT32_t[:] ring2_normal = np.zeros(3, dtype=FLOAT32)
  *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] cation_coor = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
- *     cdef FLOAT32_t[:] tmp1 = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] tmp1 = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
  *     cdef FLOAT32_t[:] tmp2 = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t dist2, dot_prod
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 111, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 109, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 111, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 109, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 111, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 109, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 111, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 111, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__11, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 111, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 109, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 109, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__11, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 109, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 111, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_v_cation_coor = __pyx_t_5;
-  __pyx_t_5.memview = NULL;
-  __pyx_t_5.data = NULL;
+  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 109, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_tmp1 = __pyx_t_4;
+  __pyx_t_4.memview = NULL;
+  __pyx_t_4.data = NULL;
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":112
+  /* "moleculekit/interactions/pipi/pipi.pyx":110
  *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] cation_coor = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] tmp1 = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
- *     cdef FLOAT32_t[:] tmp2 = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] tmp1 = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] tmp2 = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
  *     cdef FLOAT32_t dist2, dot_prod
+ *     cdef int r1_start_idx, r2_start_idx, r1_end_idx, r2_end_idx
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 112, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 112, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 110, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 110, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 112, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 112, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 110, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 110, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 112, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 110, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__11, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 112, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__11, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 110, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 112, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 110, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_v_tmp1 = __pyx_t_5;
-  __pyx_t_5.memview = NULL;
-  __pyx_t_5.data = NULL;
+  __pyx_v_tmp2 = __pyx_t_4;
+  __pyx_t_4.memview = NULL;
+  __pyx_t_4.data = NULL;
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":113
- *     cdef FLOAT32_t[:] cation_coor = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] tmp1 = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] tmp2 = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
- *     cdef FLOAT32_t dist2, dot_prod
- *     cdef int r_start_idx, r_end_idx
+  /* "moleculekit/interactions/pipi/pipi.pyx":114
+ *     cdef int r1_start_idx, r2_start_idx, r1_end_idx, r2_end_idx
+ * 
+ *     dist_threshold1 = dist_threshold1 * dist_threshold1             # <<<<<<<<<<<<<<
+ *     dist_threshold2 = dist_threshold2 * dist_threshold2
+ * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 113, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 113, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 113, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 113, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 113, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__11, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 113, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 113, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_v_tmp2 = __pyx_t_5;
-  __pyx_t_5.memview = NULL;
-  __pyx_t_5.data = NULL;
+  __pyx_v_dist_threshold1 = (__pyx_v_dist_threshold1 * __pyx_v_dist_threshold1);
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":117
- *     cdef int r_start_idx, r_end_idx
+  /* "moleculekit/interactions/pipi/pipi.pyx":115
  * 
- *     dist_threshold = dist_threshold * dist_threshold             # <<<<<<<<<<<<<<
+ *     dist_threshold1 = dist_threshold1 * dist_threshold1
+ *     dist_threshold2 = dist_threshold2 * dist_threshold2             # <<<<<<<<<<<<<<
  * 
  *     for f in range(n_frames):
  */
-  __pyx_v_dist_threshold = (__pyx_v_dist_threshold * __pyx_v_dist_threshold);
+  __pyx_v_dist_threshold2 = (__pyx_v_dist_threshold2 * __pyx_v_dist_threshold2);
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":119
- *     dist_threshold = dist_threshold * dist_threshold
+  /* "moleculekit/interactions/pipi/pipi.pyx":117
+ *     dist_threshold2 = dist_threshold2 * dist_threshold2
  * 
  *     for f in range(n_frames):             # <<<<<<<<<<<<<<
  *         results.push_back(vector[int]())
  *         distangles.push_back(vector[float]())
  */
-  __pyx_t_6 = __pyx_v_n_frames;
-  __pyx_t_7 = __pyx_t_6;
-  for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
-    __pyx_v_f = __pyx_t_8;
+  __pyx_t_5 = __pyx_v_n_frames;
+  __pyx_t_6 = __pyx_t_5;
+  for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
+    __pyx_v_f = __pyx_t_7;
 
-    /* "moleculekit/interactions/cationpi/cationpi.pyx":120
+    /* "moleculekit/interactions/pipi/pipi.pyx":118
  * 
  *     for f in range(n_frames):
  *         results.push_back(vector[int]())             # <<<<<<<<<<<<<<
  *         distangles.push_back(vector[float]())
  *         for i in range(3):
  */
     try {
-      __pyx_t_9 = std::vector<int> ();
+      __pyx_t_8 = std::vector<int> ();
     } catch(...) {
       __Pyx_CppExn2PyErr();
-      __PYX_ERR(0, 120, __pyx_L1_error)
+      __PYX_ERR(0, 118, __pyx_L1_error)
     }
     try {
-      __pyx_v_results.push_back(__pyx_t_9);
+      __pyx_v_results.push_back(__pyx_t_8);
     } catch(...) {
       __Pyx_CppExn2PyErr();
-      __PYX_ERR(0, 120, __pyx_L1_error)
+      __PYX_ERR(0, 118, __pyx_L1_error)
     }
 
-    /* "moleculekit/interactions/cationpi/cationpi.pyx":121
+    /* "moleculekit/interactions/pipi/pipi.pyx":119
  *     for f in range(n_frames):
  *         results.push_back(vector[int]())
  *         distangles.push_back(vector[float]())             # <<<<<<<<<<<<<<
  *         for i in range(3):
  *             half_box[i] = box[i, f] / 2
  */
     try {
-      __pyx_t_10 = std::vector<float> ();
+      __pyx_t_9 = std::vector<float> ();
     } catch(...) {
       __Pyx_CppExn2PyErr();
-      __PYX_ERR(0, 121, __pyx_L1_error)
+      __PYX_ERR(0, 119, __pyx_L1_error)
     }
     try {
-      __pyx_v_distangles.push_back(__pyx_t_10);
+      __pyx_v_distangles.push_back(__pyx_t_9);
     } catch(...) {
       __Pyx_CppExn2PyErr();
-      __PYX_ERR(0, 121, __pyx_L1_error)
+      __PYX_ERR(0, 119, __pyx_L1_error)
     }
 
-    /* "moleculekit/interactions/cationpi/cationpi.pyx":122
+    /* "moleculekit/interactions/pipi/pipi.pyx":120
  *         results.push_back(vector[int]())
  *         distangles.push_back(vector[float]())
  *         for i in range(3):             # <<<<<<<<<<<<<<
  *             half_box[i] = box[i, f] / 2
  * 
  */
-    for (__pyx_t_11 = 0; __pyx_t_11 < 3; __pyx_t_11+=1) {
-      __pyx_v_i = __pyx_t_11;
+    for (__pyx_t_10 = 0; __pyx_t_10 < 3; __pyx_t_10+=1) {
+      __pyx_v_i = __pyx_t_10;
 
-      /* "moleculekit/interactions/cationpi/cationpi.pyx":123
+      /* "moleculekit/interactions/pipi/pipi.pyx":121
  *         distangles.push_back(vector[float]())
  *         for i in range(3):
  *             half_box[i] = box[i, f] / 2             # <<<<<<<<<<<<<<
  * 
- *         for r1 in range(n_rings):
+ *         for r1 in range(n_rings1):
  */
-      __pyx_t_12 = __pyx_v_i;
-      __pyx_t_13 = __pyx_v_f;
-      __pyx_t_14 = __pyx_v_i;
-      *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_half_box.data + __pyx_t_14 * __pyx_v_half_box.strides[0]) )) = ((*__Pyx_BufPtrStrided2d(__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_box.diminfo[1].strides)) / 2.0);
+      __pyx_t_11 = __pyx_v_i;
+      __pyx_t_12 = __pyx_v_f;
+      __pyx_t_13 = __pyx_v_i;
+      *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_half_box.data + __pyx_t_13 * __pyx_v_half_box.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_11 * __pyx_v_box.strides[0]) ) + __pyx_t_12 * __pyx_v_box.strides[1]) ))) / 2.0);
     }
 
-    /* "moleculekit/interactions/cationpi/cationpi.pyx":125
+    /* "moleculekit/interactions/pipi/pipi.pyx":123
  *             half_box[i] = box[i, f] / 2
  * 
- *         for r1 in range(n_rings):             # <<<<<<<<<<<<<<
- *             for r2 in range(n_cations):
- *                 r_start_idx = rings_start_indexes[r1]
+ *         for r1 in range(n_rings1):             # <<<<<<<<<<<<<<
+ *             for r2 in range(n_rings2):
+ *                 r1_start_idx = rings1_start_indexes[r1]
+ */
+    __pyx_t_10 = __pyx_v_n_rings1;
+    __pyx_t_14 = __pyx_t_10;
+    for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
+      __pyx_v_r1 = __pyx_t_15;
+
+      /* "moleculekit/interactions/pipi/pipi.pyx":124
+ * 
+ *         for r1 in range(n_rings1):
+ *             for r2 in range(n_rings2):             # <<<<<<<<<<<<<<
+ *                 r1_start_idx = rings1_start_indexes[r1]
+ *                 r1_end_idx = rings1_start_indexes[r1+1]
+ */
+      __pyx_t_16 = __pyx_v_n_rings2;
+      __pyx_t_17 = __pyx_t_16;
+      for (__pyx_t_18 = 0; __pyx_t_18 < __pyx_t_17; __pyx_t_18+=1) {
+        __pyx_v_r2 = __pyx_t_18;
+
+        /* "moleculekit/interactions/pipi/pipi.pyx":125
+ *         for r1 in range(n_rings1):
+ *             for r2 in range(n_rings2):
+ *                 r1_start_idx = rings1_start_indexes[r1]             # <<<<<<<<<<<<<<
+ *                 r1_end_idx = rings1_start_indexes[r1+1]
+ *                 r2_start_idx = rings2_start_indexes[r2]
+ */
+        __pyx_t_12 = __pyx_v_r1;
+        __pyx_v_r1_start_idx = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings1_start_indexes.data + __pyx_t_12 * __pyx_v_rings1_start_indexes.strides[0]) )));
+
+        /* "moleculekit/interactions/pipi/pipi.pyx":126
+ *             for r2 in range(n_rings2):
+ *                 r1_start_idx = rings1_start_indexes[r1]
+ *                 r1_end_idx = rings1_start_indexes[r1+1]             # <<<<<<<<<<<<<<
+ *                 r2_start_idx = rings2_start_indexes[r2]
+ *                 r2_end_idx = rings2_start_indexes[r2+1]
+ */
+        __pyx_t_12 = (__pyx_v_r1 + 1);
+        __pyx_v_r1_end_idx = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings1_start_indexes.data + __pyx_t_12 * __pyx_v_rings1_start_indexes.strides[0]) )));
+
+        /* "moleculekit/interactions/pipi/pipi.pyx":127
+ *                 r1_start_idx = rings1_start_indexes[r1]
+ *                 r1_end_idx = rings1_start_indexes[r1+1]
+ *                 r2_start_idx = rings2_start_indexes[r2]             # <<<<<<<<<<<<<<
+ *                 r2_end_idx = rings2_start_indexes[r2+1]
+ * 
+ */
+        __pyx_t_12 = __pyx_v_r2;
+        __pyx_v_r2_start_idx = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings2_start_indexes.data + __pyx_t_12 * __pyx_v_rings2_start_indexes.strides[0]) )));
+
+        /* "moleculekit/interactions/pipi/pipi.pyx":128
+ *                 r1_end_idx = rings1_start_indexes[r1+1]
+ *                 r2_start_idx = rings2_start_indexes[r2]
+ *                 r2_end_idx = rings2_start_indexes[r2+1]             # <<<<<<<<<<<<<<
+ * 
+ *                 if r1_start_idx == r2_start_idx and r1_end_idx == r2_end_idx:
+ */
+        __pyx_t_12 = (__pyx_v_r2 + 1);
+        __pyx_v_r2_end_idx = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings2_start_indexes.data + __pyx_t_12 * __pyx_v_rings2_start_indexes.strides[0]) )));
+
+        /* "moleculekit/interactions/pipi/pipi.pyx":130
+ *                 r2_end_idx = rings2_start_indexes[r2+1]
+ * 
+ *                 if r1_start_idx == r2_start_idx and r1_end_idx == r2_end_idx:             # <<<<<<<<<<<<<<
+ *                     # Skip self-interactions of identical rings
+ *                     continue
+ */
+        __pyx_t_20 = (__pyx_v_r1_start_idx == __pyx_v_r2_start_idx);
+        if (__pyx_t_20) {
+        } else {
+          __pyx_t_19 = __pyx_t_20;
+          goto __pyx_L12_bool_binop_done;
+        }
+        __pyx_t_20 = (__pyx_v_r1_end_idx == __pyx_v_r2_end_idx);
+        __pyx_t_19 = __pyx_t_20;
+        __pyx_L12_bool_binop_done:;
+        if (__pyx_t_19) {
+
+          /* "moleculekit/interactions/pipi/pipi.pyx":132
+ *                 if r1_start_idx == r2_start_idx and r1_end_idx == r2_end_idx:
+ *                     # Skip self-interactions of identical rings
+ *                     continue             # <<<<<<<<<<<<<<
+ * 
+ *                 # Exit early if any of the two ring's atoms are too far
  */
-    __pyx_t_11 = __pyx_v_n_rings;
-    __pyx_t_15 = __pyx_t_11;
-    for (__pyx_t_16 = 0; __pyx_t_16 < __pyx_t_15; __pyx_t_16+=1) {
-      __pyx_v_r1 = __pyx_t_16;
+          goto __pyx_L9_continue;
 
-      /* "moleculekit/interactions/cationpi/cationpi.pyx":126
+          /* "moleculekit/interactions/pipi/pipi.pyx":130
+ *                 r2_end_idx = rings2_start_indexes[r2+1]
  * 
- *         for r1 in range(n_rings):
- *             for r2 in range(n_cations):             # <<<<<<<<<<<<<<
- *                 r_start_idx = rings_start_indexes[r1]
- *                 r_end_idx = rings_start_indexes[r1+1]
+ *                 if r1_start_idx == r2_start_idx and r1_end_idx == r2_end_idx:             # <<<<<<<<<<<<<<
+ *                     # Skip self-interactions of identical rings
+ *                     continue
  */
-      __pyx_t_17 = __pyx_v_n_cations;
-      __pyx_t_18 = __pyx_t_17;
-      for (__pyx_t_19 = 0; __pyx_t_19 < __pyx_t_18; __pyx_t_19+=1) {
-        __pyx_v_r2 = __pyx_t_19;
+        }
 
-        /* "moleculekit/interactions/cationpi/cationpi.pyx":127
- *         for r1 in range(n_rings):
- *             for r2 in range(n_cations):
- *                 r_start_idx = rings_start_indexes[r1]             # <<<<<<<<<<<<<<
- *                 r_end_idx = rings_start_indexes[r1+1]
+        /* "moleculekit/interactions/pipi/pipi.pyx":135
  * 
+ *                 # Exit early if any of the two ring's atoms are too far
+ *                 for i in range(3):             # <<<<<<<<<<<<<<
+ *                     tmp1[i] = coords[rings_atoms[r1_start_idx], i, f]
+ *                     tmp2[i] = coords[rings_atoms[r2_start_idx], i, f]
  */
-        __pyx_t_13 = __pyx_v_r1;
-        __pyx_v_r_start_idx = (*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t *, __pyx_pybuffernd_rings_start_indexes.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_rings_start_indexes.diminfo[0].strides));
+        for (__pyx_t_21 = 0; __pyx_t_21 < 3; __pyx_t_21+=1) {
+          __pyx_v_i = __pyx_t_21;
 
-        /* "moleculekit/interactions/cationpi/cationpi.pyx":128
- *             for r2 in range(n_cations):
- *                 r_start_idx = rings_start_indexes[r1]
- *                 r_end_idx = rings_start_indexes[r1+1]             # <<<<<<<<<<<<<<
+          /* "moleculekit/interactions/pipi/pipi.pyx":136
+ *                 # Exit early if any of the two ring's atoms are too far
+ *                 for i in range(3):
+ *                     tmp1[i] = coords[rings_atoms[r1_start_idx], i, f]             # <<<<<<<<<<<<<<
+ *                     tmp2[i] = coords[rings_atoms[r2_start_idx], i, f]
+ *                 dist2 = _wrapped_dist(f, tmp1, tmp2, half_box, box)
+ */
+          __pyx_t_12 = __pyx_v_r1_start_idx;
+          __pyx_t_22 = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_12 * __pyx_v_rings_atoms.strides[0]) )));
+          __pyx_t_11 = __pyx_v_i;
+          __pyx_t_13 = __pyx_v_f;
+          __pyx_t_23 = __pyx_v_i;
+          *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_tmp1.data + __pyx_t_23 * __pyx_v_tmp1.strides[0]) )) = (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_22 * __pyx_v_coords.strides[0]) ) + __pyx_t_11 * __pyx_v_coords.strides[1]) ) + __pyx_t_13 * __pyx_v_coords.strides[2]) )));
+
+          /* "moleculekit/interactions/pipi/pipi.pyx":137
+ *                 for i in range(3):
+ *                     tmp1[i] = coords[rings_atoms[r1_start_idx], i, f]
+ *                     tmp2[i] = coords[rings_atoms[r2_start_idx], i, f]             # <<<<<<<<<<<<<<
+ *                 dist2 = _wrapped_dist(f, tmp1, tmp2, half_box, box)
+ *                 # Rings too far apart
+ */
+          __pyx_t_12 = __pyx_v_r2_start_idx;
+          __pyx_t_22 = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_12 * __pyx_v_rings_atoms.strides[0]) )));
+          __pyx_t_13 = __pyx_v_i;
+          __pyx_t_11 = __pyx_v_f;
+          __pyx_t_23 = __pyx_v_i;
+          *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_tmp2.data + __pyx_t_23 * __pyx_v_tmp2.strides[0]) )) = (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_22 * __pyx_v_coords.strides[0]) ) + __pyx_t_13 * __pyx_v_coords.strides[1]) ) + __pyx_t_11 * __pyx_v_coords.strides[2]) )));
+        }
+
+        /* "moleculekit/interactions/pipi/pipi.pyx":138
+ *                     tmp1[i] = coords[rings_atoms[r1_start_idx], i, f]
+ *                     tmp2[i] = coords[rings_atoms[r2_start_idx], i, f]
+ *                 dist2 = _wrapped_dist(f, tmp1, tmp2, half_box, box)             # <<<<<<<<<<<<<<
+ *                 # Rings too far apart
+ *                 if dist2 > 225: # If two randomly picked atoms are more than 15A apart early-quit
+ */
+        __pyx_t_24 = __pyx_f_11moleculekit_12interactions_4pipi__wrapped_dist(__pyx_v_f, __pyx_v_tmp1, __pyx_v_tmp2, __pyx_v_half_box, __pyx_v_box); if (unlikely(__pyx_t_24 == ((float)-1) && PyErr_Occurred())) __PYX_ERR(0, 138, __pyx_L1_error)
+        __pyx_v_dist2 = __pyx_t_24;
+
+        /* "moleculekit/interactions/pipi/pipi.pyx":140
+ *                 dist2 = _wrapped_dist(f, tmp1, tmp2, half_box, box)
+ *                 # Rings too far apart
+ *                 if dist2 > 225: # If two randomly picked atoms are more than 15A apart early-quit             # <<<<<<<<<<<<<<
+ *                     continue
  * 
- *                 # Calculate the ring centroid
  */
-        __pyx_t_13 = (__pyx_v_r1 + 1);
-        __pyx_v_r_end_idx = (*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t *, __pyx_pybuffernd_rings_start_indexes.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_rings_start_indexes.diminfo[0].strides));
+        __pyx_t_19 = (__pyx_v_dist2 > 225.0);
+        if (__pyx_t_19) {
 
-        /* "moleculekit/interactions/cationpi/cationpi.pyx":131
+          /* "moleculekit/interactions/pipi/pipi.pyx":141
+ *                 # Rings too far apart
+ *                 if dist2 > 225: # If two randomly picked atoms are more than 15A apart early-quit
+ *                     continue             # <<<<<<<<<<<<<<
  * 
- *                 # Calculate the ring centroid
- *                 _calculate_ring_mean(f, r_start_idx, r_end_idx, rings_atoms, coords, ring_mean)             # <<<<<<<<<<<<<<
+ *                 # Calculate the ring centroids
+ */
+          goto __pyx_L9_continue;
+
+          /* "moleculekit/interactions/pipi/pipi.pyx":140
+ *                 dist2 = _wrapped_dist(f, tmp1, tmp2, half_box, box)
+ *                 # Rings too far apart
+ *                 if dist2 > 225: # If two randomly picked atoms are more than 15A apart early-quit             # <<<<<<<<<<<<<<
+ *                     continue
  * 
- *                 # Cation coordinates
  */
-        __pyx_t_20 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t(((PyObject *)__pyx_v_rings_atoms), PyBUF_WRITABLE); if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(0, 131, __pyx_L1_error)
-        __pyx_t_21 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(((PyObject *)__pyx_v_coords), PyBUF_WRITABLE); if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 131, __pyx_L1_error)
-        __pyx_f_11moleculekit_12interactions_8cationpi__calculate_ring_mean(__pyx_v_f, __pyx_v_r_start_idx, __pyx_v_r_end_idx, __pyx_t_20, __pyx_t_21, __pyx_v_ring_mean); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 131, __pyx_L1_error)
-        __PYX_XCLEAR_MEMVIEW(&__pyx_t_20, 1);
-        __pyx_t_20.memview = NULL; __pyx_t_20.data = NULL;
-        __PYX_XCLEAR_MEMVIEW(&__pyx_t_21, 1);
-        __pyx_t_21.memview = NULL; __pyx_t_21.data = NULL;
+        }
 
-        /* "moleculekit/interactions/cationpi/cationpi.pyx":134
+        /* "moleculekit/interactions/pipi/pipi.pyx":144
  * 
- *                 # Cation coordinates
- *                 for i in range(3):             # <<<<<<<<<<<<<<
- *                     cation_coor[i] = coords[cations[r2], i, f]
+ *                 # Calculate the ring centroids
+ *                 _calculate_ring_mean(f, r1_start_idx, r1_end_idx, rings_atoms, coords, ring1_mean)             # <<<<<<<<<<<<<<
+ *                 _calculate_ring_mean(f, r2_start_idx, r2_end_idx, rings_atoms, coords, ring2_mean)
  * 
  */
-        for (__pyx_t_22 = 0; __pyx_t_22 < 3; __pyx_t_22+=1) {
-          __pyx_v_i = __pyx_t_22;
+        __pyx_f_11moleculekit_12interactions_4pipi__calculate_ring_mean(__pyx_v_f, __pyx_v_r1_start_idx, __pyx_v_r1_end_idx, __pyx_v_rings_atoms, __pyx_v_coords, __pyx_v_ring1_mean); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 144, __pyx_L1_error)
 
-          /* "moleculekit/interactions/cationpi/cationpi.pyx":135
- *                 # Cation coordinates
- *                 for i in range(3):
- *                     cation_coor[i] = coords[cations[r2], i, f]             # <<<<<<<<<<<<<<
+        /* "moleculekit/interactions/pipi/pipi.pyx":145
+ *                 # Calculate the ring centroids
+ *                 _calculate_ring_mean(f, r1_start_idx, r1_end_idx, rings_atoms, coords, ring1_mean)
+ *                 _calculate_ring_mean(f, r2_start_idx, r2_end_idx, rings_atoms, coords, ring2_mean)             # <<<<<<<<<<<<<<
  * 
- *                 # Calculate the wrapped distance between the ring centroid and the cation
+ *                 # Calculate the wrapped distance between the ring centroids
  */
-          __pyx_t_13 = __pyx_v_r2;
-          __pyx_t_23 = (*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t *, __pyx_pybuffernd_cations.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_cations.diminfo[0].strides));
-          __pyx_t_12 = __pyx_v_i;
-          __pyx_t_14 = __pyx_v_f;
-          __pyx_t_24 = __pyx_v_i;
-          *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_cation_coor.data + __pyx_t_24 * __pyx_v_cation_coor.strides[0]) )) = (*__Pyx_BufPtrStrided3d(__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *, __pyx_pybuffernd_coords.rcbuffer->pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_coords.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_coords.diminfo[1].strides, __pyx_t_14, __pyx_pybuffernd_coords.diminfo[2].strides));
-        }
+        __pyx_f_11moleculekit_12interactions_4pipi__calculate_ring_mean(__pyx_v_f, __pyx_v_r2_start_idx, __pyx_v_r2_end_idx, __pyx_v_rings_atoms, __pyx_v_coords, __pyx_v_ring2_mean); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 145, __pyx_L1_error)
 
-        /* "moleculekit/interactions/cationpi/cationpi.pyx":138
+        /* "moleculekit/interactions/pipi/pipi.pyx":148
  * 
- *                 # Calculate the wrapped distance between the ring centroid and the cation
- *                 dist2 = _wrapped_dist(f, ring_mean, cation_coor, half_box, box)             # <<<<<<<<<<<<<<
+ *                 # Calculate the wrapped distance between the ring centroids
+ *                 dist2 = _wrapped_dist(f, ring1_mean, ring2_mean, half_box, box)             # <<<<<<<<<<<<<<
  * 
- *                 # Ring centroid too far apart from cation
+ *                 # Ring centroids too far apart
  */
-        __pyx_t_25 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(((PyObject *)__pyx_v_box), PyBUF_WRITABLE); if (unlikely(!__pyx_t_25.memview)) __PYX_ERR(0, 138, __pyx_L1_error)
-        __pyx_t_26 = __pyx_f_11moleculekit_12interactions_8cationpi__wrapped_dist(__pyx_v_f, __pyx_v_ring_mean, __pyx_v_cation_coor, __pyx_v_half_box, __pyx_t_25); if (unlikely(__pyx_t_26 == ((float)-1) && PyErr_Occurred())) __PYX_ERR(0, 138, __pyx_L1_error)
-        __PYX_XCLEAR_MEMVIEW(&__pyx_t_25, 1);
-        __pyx_t_25.memview = NULL; __pyx_t_25.data = NULL;
-        __pyx_v_dist2 = __pyx_t_26;
+        __pyx_t_24 = __pyx_f_11moleculekit_12interactions_4pipi__wrapped_dist(__pyx_v_f, __pyx_v_ring1_mean, __pyx_v_ring2_mean, __pyx_v_half_box, __pyx_v_box); if (unlikely(__pyx_t_24 == ((float)-1) && PyErr_Occurred())) __PYX_ERR(0, 148, __pyx_L1_error)
+        __pyx_v_dist2 = __pyx_t_24;
 
-        /* "moleculekit/interactions/cationpi/cationpi.pyx":141
+        /* "moleculekit/interactions/pipi/pipi.pyx":151
  * 
- *                 # Ring centroid too far apart from cation
- *                 if dist2 > dist_threshold:             # <<<<<<<<<<<<<<
+ *                 # Ring centroids too far apart
+ *                 if dist2 > dist_threshold2:             # <<<<<<<<<<<<<<
+ *                     # print(r1, r2, sqrt(dist2))
  *                     continue
- * 
  */
-        __pyx_t_27 = (__pyx_v_dist2 > __pyx_v_dist_threshold);
-        if (__pyx_t_27) {
+        __pyx_t_19 = (__pyx_v_dist2 > __pyx_v_dist_threshold2);
+        if (__pyx_t_19) {
 
-          /* "moleculekit/interactions/cationpi/cationpi.pyx":142
- *                 # Ring centroid too far apart from cation
- *                 if dist2 > dist_threshold:
+          /* "moleculekit/interactions/pipi/pipi.pyx":153
+ *                 if dist2 > dist_threshold2:
+ *                     # print(r1, r2, sqrt(dist2))
  *                     continue             # <<<<<<<<<<<<<<
  * 
- *                 # Calculate the plane normal
+ *                 # Calculate the plane normals
  */
           goto __pyx_L9_continue;
 
-          /* "moleculekit/interactions/cationpi/cationpi.pyx":141
+          /* "moleculekit/interactions/pipi/pipi.pyx":151
  * 
- *                 # Ring centroid too far apart from cation
- *                 if dist2 > dist_threshold:             # <<<<<<<<<<<<<<
+ *                 # Ring centroids too far apart
+ *                 if dist2 > dist_threshold2:             # <<<<<<<<<<<<<<
+ *                     # print(r1, r2, sqrt(dist2))
  *                     continue
- * 
  */
         }
 
-        /* "moleculekit/interactions/cationpi/cationpi.pyx":146
- *                 # Calculate the plane normal
- *                 # TODO: This is very bad for non-planar rings. I should calculate the average normal
+        /* "moleculekit/interactions/pipi/pipi.pyx":156
+ * 
+ *                 # Calculate the plane normals
  *                 for i in range(3):             # <<<<<<<<<<<<<<
- *                     tmp1[i] = coords[rings_atoms[r_start_idx], i, f] - coords[rings_atoms[r_start_idx+2], i, f]
- *                     tmp2[i] = coords[rings_atoms[r_start_idx+1], i, f] - coords[rings_atoms[r_start_idx+2], i, f]
+ *                     tmp1[i] = coords[rings_atoms[r1_start_idx], i, f] - coords[rings_atoms[r1_start_idx+2], i, f]
+ *                     tmp2[i] = coords[rings_atoms[r1_start_idx+1], i, f] - coords[rings_atoms[r1_start_idx+2], i, f]
  */
-        for (__pyx_t_22 = 0; __pyx_t_22 < 3; __pyx_t_22+=1) {
-          __pyx_v_i = __pyx_t_22;
+        for (__pyx_t_21 = 0; __pyx_t_21 < 3; __pyx_t_21+=1) {
+          __pyx_v_i = __pyx_t_21;
 
-          /* "moleculekit/interactions/cationpi/cationpi.pyx":147
- *                 # TODO: This is very bad for non-planar rings. I should calculate the average normal
+          /* "moleculekit/interactions/pipi/pipi.pyx":157
+ *                 # Calculate the plane normals
  *                 for i in range(3):
- *                     tmp1[i] = coords[rings_atoms[r_start_idx], i, f] - coords[rings_atoms[r_start_idx+2], i, f]             # <<<<<<<<<<<<<<
- *                     tmp2[i] = coords[rings_atoms[r_start_idx+1], i, f] - coords[rings_atoms[r_start_idx+2], i, f]
- *                 _cross_product(tmp1, tmp2, ring_normal)
- */
-          __pyx_t_13 = __pyx_v_r_start_idx;
-          __pyx_t_23 = (*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t *, __pyx_pybuffernd_rings_atoms.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_rings_atoms.diminfo[0].strides));
-          __pyx_t_14 = __pyx_v_i;
-          __pyx_t_12 = __pyx_v_f;
-          __pyx_t_24 = (__pyx_v_r_start_idx + 2);
-          __pyx_t_28 = (*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t *, __pyx_pybuffernd_rings_atoms.rcbuffer->pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_rings_atoms.diminfo[0].strides));
-          __pyx_t_29 = __pyx_v_i;
-          __pyx_t_30 = __pyx_v_f;
-          __pyx_t_31 = __pyx_v_i;
-          *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_tmp1.data + __pyx_t_31 * __pyx_v_tmp1.strides[0]) )) = ((*__Pyx_BufPtrStrided3d(__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *, __pyx_pybuffernd_coords.rcbuffer->pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_coords.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_coords.diminfo[1].strides, __pyx_t_12, __pyx_pybuffernd_coords.diminfo[2].strides)) - (*__Pyx_BufPtrStrided3d(__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *, __pyx_pybuffernd_coords.rcbuffer->pybuffer.buf, __pyx_t_28, __pyx_pybuffernd_coords.diminfo[0].strides, __pyx_t_29, __pyx_pybuffernd_coords.diminfo[1].strides, __pyx_t_30, __pyx_pybuffernd_coords.diminfo[2].strides)));
+ *                     tmp1[i] = coords[rings_atoms[r1_start_idx], i, f] - coords[rings_atoms[r1_start_idx+2], i, f]             # <<<<<<<<<<<<<<
+ *                     tmp2[i] = coords[rings_atoms[r1_start_idx+1], i, f] - coords[rings_atoms[r1_start_idx+2], i, f]
+ *                 _cross_product(tmp1, tmp2, ring1_normal)
+ */
+          __pyx_t_12 = __pyx_v_r1_start_idx;
+          __pyx_t_22 = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_12 * __pyx_v_rings_atoms.strides[0]) )));
+          __pyx_t_11 = __pyx_v_i;
+          __pyx_t_13 = __pyx_v_f;
+          __pyx_t_23 = (__pyx_v_r1_start_idx + 2);
+          __pyx_t_25 = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_23 * __pyx_v_rings_atoms.strides[0]) )));
+          __pyx_t_26 = __pyx_v_i;
+          __pyx_t_27 = __pyx_v_f;
+          __pyx_t_28 = __pyx_v_i;
+          *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_tmp1.data + __pyx_t_28 * __pyx_v_tmp1.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_22 * __pyx_v_coords.strides[0]) ) + __pyx_t_11 * __pyx_v_coords.strides[1]) ) + __pyx_t_13 * __pyx_v_coords.strides[2]) ))) - (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_25 * __pyx_v_coords.strides[0]) ) + __pyx_t_26 * __pyx_v_coords.strides[1]) ) + __pyx_t_27 * __pyx_v_coords.strides[2]) ))));
 
-          /* "moleculekit/interactions/cationpi/cationpi.pyx":148
+          /* "moleculekit/interactions/pipi/pipi.pyx":158
+ *                 for i in range(3):
+ *                     tmp1[i] = coords[rings_atoms[r1_start_idx], i, f] - coords[rings_atoms[r1_start_idx+2], i, f]
+ *                     tmp2[i] = coords[rings_atoms[r1_start_idx+1], i, f] - coords[rings_atoms[r1_start_idx+2], i, f]             # <<<<<<<<<<<<<<
+ *                 _cross_product(tmp1, tmp2, ring1_normal)
  *                 for i in range(3):
- *                     tmp1[i] = coords[rings_atoms[r_start_idx], i, f] - coords[rings_atoms[r_start_idx+2], i, f]
- *                     tmp2[i] = coords[rings_atoms[r_start_idx+1], i, f] - coords[rings_atoms[r_start_idx+2], i, f]             # <<<<<<<<<<<<<<
- *                 _cross_product(tmp1, tmp2, ring_normal)
- * 
  */
-          __pyx_t_24 = (__pyx_v_r_start_idx + 1);
-          __pyx_t_28 = (*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t *, __pyx_pybuffernd_rings_atoms.rcbuffer->pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_rings_atoms.diminfo[0].strides));
-          __pyx_t_30 = __pyx_v_i;
-          __pyx_t_29 = __pyx_v_f;
-          __pyx_t_13 = (__pyx_v_r_start_idx + 2);
-          __pyx_t_23 = (*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t *, __pyx_pybuffernd_rings_atoms.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_rings_atoms.diminfo[0].strides));
-          __pyx_t_12 = __pyx_v_i;
-          __pyx_t_14 = __pyx_v_f;
-          __pyx_t_31 = __pyx_v_i;
-          *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_tmp2.data + __pyx_t_31 * __pyx_v_tmp2.strides[0]) )) = ((*__Pyx_BufPtrStrided3d(__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *, __pyx_pybuffernd_coords.rcbuffer->pybuffer.buf, __pyx_t_28, __pyx_pybuffernd_coords.diminfo[0].strides, __pyx_t_30, __pyx_pybuffernd_coords.diminfo[1].strides, __pyx_t_29, __pyx_pybuffernd_coords.diminfo[2].strides)) - (*__Pyx_BufPtrStrided3d(__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *, __pyx_pybuffernd_coords.rcbuffer->pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_coords.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_coords.diminfo[1].strides, __pyx_t_14, __pyx_pybuffernd_coords.diminfo[2].strides)));
+          __pyx_t_23 = (__pyx_v_r1_start_idx + 1);
+          __pyx_t_25 = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_23 * __pyx_v_rings_atoms.strides[0]) )));
+          __pyx_t_27 = __pyx_v_i;
+          __pyx_t_26 = __pyx_v_f;
+          __pyx_t_12 = (__pyx_v_r1_start_idx + 2);
+          __pyx_t_22 = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_12 * __pyx_v_rings_atoms.strides[0]) )));
+          __pyx_t_13 = __pyx_v_i;
+          __pyx_t_11 = __pyx_v_f;
+          __pyx_t_28 = __pyx_v_i;
+          *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_tmp2.data + __pyx_t_28 * __pyx_v_tmp2.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_25 * __pyx_v_coords.strides[0]) ) + __pyx_t_27 * __pyx_v_coords.strides[1]) ) + __pyx_t_26 * __pyx_v_coords.strides[2]) ))) - (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_22 * __pyx_v_coords.strides[0]) ) + __pyx_t_13 * __pyx_v_coords.strides[1]) ) + __pyx_t_11 * __pyx_v_coords.strides[2]) ))));
         }
 
-        /* "moleculekit/interactions/cationpi/cationpi.pyx":149
- *                     tmp1[i] = coords[rings_atoms[r_start_idx], i, f] - coords[rings_atoms[r_start_idx+2], i, f]
- *                     tmp2[i] = coords[rings_atoms[r_start_idx+1], i, f] - coords[rings_atoms[r_start_idx+2], i, f]
- *                 _cross_product(tmp1, tmp2, ring_normal)             # <<<<<<<<<<<<<<
- * 
- *                 # Calculate ring-cation vector
+        /* "moleculekit/interactions/pipi/pipi.pyx":159
+ *                     tmp1[i] = coords[rings_atoms[r1_start_idx], i, f] - coords[rings_atoms[r1_start_idx+2], i, f]
+ *                     tmp2[i] = coords[rings_atoms[r1_start_idx+1], i, f] - coords[rings_atoms[r1_start_idx+2], i, f]
+ *                 _cross_product(tmp1, tmp2, ring1_normal)             # <<<<<<<<<<<<<<
+ *                 for i in range(3):
+ *                     tmp1[i] = coords[rings_atoms[r2_start_idx], i, f] - coords[rings_atoms[r2_start_idx+2], i, f]
  */
-        __pyx_f_11moleculekit_12interactions_8cationpi__cross_product(__pyx_v_tmp1, __pyx_v_tmp2, __pyx_v_ring_normal); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 149, __pyx_L1_error)
+        __pyx_f_11moleculekit_12interactions_4pipi__cross_product(__pyx_v_tmp1, __pyx_v_tmp2, __pyx_v_ring1_normal); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 159, __pyx_L1_error)
 
-        /* "moleculekit/interactions/cationpi/cationpi.pyx":152
- * 
- *                 # Calculate ring-cation vector
+        /* "moleculekit/interactions/pipi/pipi.pyx":160
+ *                     tmp2[i] = coords[rings_atoms[r1_start_idx+1], i, f] - coords[rings_atoms[r1_start_idx+2], i, f]
+ *                 _cross_product(tmp1, tmp2, ring1_normal)
  *                 for i in range(3):             # <<<<<<<<<<<<<<
- *                     tmp1[i] = cation_coor[i] - ring_mean[i]
- *                 _normalize(tmp1)
+ *                     tmp1[i] = coords[rings_atoms[r2_start_idx], i, f] - coords[rings_atoms[r2_start_idx+2], i, f]
+ *                     tmp2[i] = coords[rings_atoms[r2_start_idx+1], i, f] - coords[rings_atoms[r2_start_idx+2], i, f]
  */
-        for (__pyx_t_22 = 0; __pyx_t_22 < 3; __pyx_t_22+=1) {
-          __pyx_v_i = __pyx_t_22;
+        for (__pyx_t_21 = 0; __pyx_t_21 < 3; __pyx_t_21+=1) {
+          __pyx_v_i = __pyx_t_21;
+
+          /* "moleculekit/interactions/pipi/pipi.pyx":161
+ *                 _cross_product(tmp1, tmp2, ring1_normal)
+ *                 for i in range(3):
+ *                     tmp1[i] = coords[rings_atoms[r2_start_idx], i, f] - coords[rings_atoms[r2_start_idx+2], i, f]             # <<<<<<<<<<<<<<
+ *                     tmp2[i] = coords[rings_atoms[r2_start_idx+1], i, f] - coords[rings_atoms[r2_start_idx+2], i, f]
+ *                 _cross_product(tmp1, tmp2, ring2_normal)
+ */
+          __pyx_t_12 = __pyx_v_r2_start_idx;
+          __pyx_t_22 = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_12 * __pyx_v_rings_atoms.strides[0]) )));
+          __pyx_t_11 = __pyx_v_i;
+          __pyx_t_13 = __pyx_v_f;
+          __pyx_t_23 = (__pyx_v_r2_start_idx + 2);
+          __pyx_t_25 = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_23 * __pyx_v_rings_atoms.strides[0]) )));
+          __pyx_t_26 = __pyx_v_i;
+          __pyx_t_27 = __pyx_v_f;
+          __pyx_t_28 = __pyx_v_i;
+          *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_tmp1.data + __pyx_t_28 * __pyx_v_tmp1.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_22 * __pyx_v_coords.strides[0]) ) + __pyx_t_11 * __pyx_v_coords.strides[1]) ) + __pyx_t_13 * __pyx_v_coords.strides[2]) ))) - (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_25 * __pyx_v_coords.strides[0]) ) + __pyx_t_26 * __pyx_v_coords.strides[1]) ) + __pyx_t_27 * __pyx_v_coords.strides[2]) ))));
 
-          /* "moleculekit/interactions/cationpi/cationpi.pyx":153
- *                 # Calculate ring-cation vector
+          /* "moleculekit/interactions/pipi/pipi.pyx":162
  *                 for i in range(3):
- *                     tmp1[i] = cation_coor[i] - ring_mean[i]             # <<<<<<<<<<<<<<
- *                 _normalize(tmp1)
+ *                     tmp1[i] = coords[rings_atoms[r2_start_idx], i, f] - coords[rings_atoms[r2_start_idx+2], i, f]
+ *                     tmp2[i] = coords[rings_atoms[r2_start_idx+1], i, f] - coords[rings_atoms[r2_start_idx+2], i, f]             # <<<<<<<<<<<<<<
+ *                 _cross_product(tmp1, tmp2, ring2_normal)
  * 
  */
+          __pyx_t_23 = (__pyx_v_r2_start_idx + 1);
+          __pyx_t_25 = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_23 * __pyx_v_rings_atoms.strides[0]) )));
+          __pyx_t_27 = __pyx_v_i;
+          __pyx_t_26 = __pyx_v_f;
+          __pyx_t_12 = (__pyx_v_r2_start_idx + 2);
+          __pyx_t_22 = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_12 * __pyx_v_rings_atoms.strides[0]) )));
           __pyx_t_13 = __pyx_v_i;
-          __pyx_t_14 = __pyx_v_i;
-          __pyx_t_12 = __pyx_v_i;
-          *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_tmp1.data + __pyx_t_12 * __pyx_v_tmp1.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_cation_coor.data + __pyx_t_13 * __pyx_v_cation_coor.strides[0]) ))) - (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_mean.data + __pyx_t_14 * __pyx_v_ring_mean.strides[0]) ))));
+          __pyx_t_11 = __pyx_v_f;
+          __pyx_t_28 = __pyx_v_i;
+          *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_tmp2.data + __pyx_t_28 * __pyx_v_tmp2.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_25 * __pyx_v_coords.strides[0]) ) + __pyx_t_27 * __pyx_v_coords.strides[1]) ) + __pyx_t_26 * __pyx_v_coords.strides[2]) ))) - (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_22 * __pyx_v_coords.strides[0]) ) + __pyx_t_13 * __pyx_v_coords.strides[1]) ) + __pyx_t_11 * __pyx_v_coords.strides[2]) ))));
         }
 
-        /* "moleculekit/interactions/cationpi/cationpi.pyx":154
- *                 for i in range(3):
- *                     tmp1[i] = cation_coor[i] - ring_mean[i]
- *                 _normalize(tmp1)             # <<<<<<<<<<<<<<
+        /* "moleculekit/interactions/pipi/pipi.pyx":163
+ *                     tmp1[i] = coords[rings_atoms[r2_start_idx], i, f] - coords[rings_atoms[r2_start_idx+2], i, f]
+ *                     tmp2[i] = coords[rings_atoms[r2_start_idx+1], i, f] - coords[rings_atoms[r2_start_idx+2], i, f]
+ *                 _cross_product(tmp1, tmp2, ring2_normal)             # <<<<<<<<<<<<<<
  * 
- *                 # Calculate angle between plane normal and ring-cation vector
+ *                 # Calculate angle between normals
  */
-        __pyx_f_11moleculekit_12interactions_8cationpi__normalize(__pyx_v_tmp1); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 154, __pyx_L1_error)
+        __pyx_f_11moleculekit_12interactions_4pipi__cross_product(__pyx_v_tmp1, __pyx_v_tmp2, __pyx_v_ring2_normal); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 163, __pyx_L1_error)
 
-        /* "moleculekit/interactions/cationpi/cationpi.pyx":157
+        /* "moleculekit/interactions/pipi/pipi.pyx":166
  * 
- *                 # Calculate angle between plane normal and ring-cation vector
+ *                 # Calculate angle between normals
  *                 dot_prod = 0             # <<<<<<<<<<<<<<
  *                 for i in range(3):
- *                     dot_prod = dot_prod + ring_normal[i] * tmp1[i]
+ *                     dot_prod = dot_prod + ring1_normal[i] * ring2_normal[i]
  */
         __pyx_v_dot_prod = 0.0;
 
-        /* "moleculekit/interactions/cationpi/cationpi.pyx":158
- *                 # Calculate angle between plane normal and ring-cation vector
+        /* "moleculekit/interactions/pipi/pipi.pyx":167
+ *                 # Calculate angle between normals
  *                 dot_prod = 0
  *                 for i in range(3):             # <<<<<<<<<<<<<<
- *                     dot_prod = dot_prod + ring_normal[i] * tmp1[i]
+ *                     dot_prod = dot_prod + ring1_normal[i] * ring2_normal[i]
  *                 angle = acos(dot_prod) * 57.29578  # Convert radians to degrees
  */
-        for (__pyx_t_22 = 0; __pyx_t_22 < 3; __pyx_t_22+=1) {
-          __pyx_v_i = __pyx_t_22;
+        for (__pyx_t_21 = 0; __pyx_t_21 < 3; __pyx_t_21+=1) {
+          __pyx_v_i = __pyx_t_21;
 
-          /* "moleculekit/interactions/cationpi/cationpi.pyx":159
+          /* "moleculekit/interactions/pipi/pipi.pyx":168
  *                 dot_prod = 0
  *                 for i in range(3):
- *                     dot_prod = dot_prod + ring_normal[i] * tmp1[i]             # <<<<<<<<<<<<<<
+ *                     dot_prod = dot_prod + ring1_normal[i] * ring2_normal[i]             # <<<<<<<<<<<<<<
  *                 angle = acos(dot_prod) * 57.29578  # Convert radians to degrees
  *                 if angle > 90:  # minimal angle to line. necessary as perpendicular can point either way
  */
-          __pyx_t_14 = __pyx_v_i;
-          __pyx_t_13 = __pyx_v_i;
-          __pyx_v_dot_prod = (__pyx_v_dot_prod + ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_normal.data + __pyx_t_14 * __pyx_v_ring_normal.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_tmp1.data + __pyx_t_13 * __pyx_v_tmp1.strides[0]) )))));
+          __pyx_t_12 = __pyx_v_i;
+          __pyx_t_11 = __pyx_v_i;
+          __pyx_v_dot_prod = (__pyx_v_dot_prod + ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring1_normal.data + __pyx_t_12 * __pyx_v_ring1_normal.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring2_normal.data + __pyx_t_11 * __pyx_v_ring2_normal.strides[0]) )))));
         }
 
-        /* "moleculekit/interactions/cationpi/cationpi.pyx":160
+        /* "moleculekit/interactions/pipi/pipi.pyx":169
  *                 for i in range(3):
- *                     dot_prod = dot_prod + ring_normal[i] * tmp1[i]
+ *                     dot_prod = dot_prod + ring1_normal[i] * ring2_normal[i]
  *                 angle = acos(dot_prod) * 57.29578  # Convert radians to degrees             # <<<<<<<<<<<<<<
  *                 if angle > 90:  # minimal angle to line. necessary as perpendicular can point either way
- *                     angle = 180 - angle
+ *                     angle = 180-angle
  */
         __pyx_v_angle = (acos(__pyx_v_dot_prod) * 57.29578);
 
-        /* "moleculekit/interactions/cationpi/cationpi.pyx":161
- *                     dot_prod = dot_prod + ring_normal[i] * tmp1[i]
+        /* "moleculekit/interactions/pipi/pipi.pyx":170
+ *                     dot_prod = dot_prod + ring1_normal[i] * ring2_normal[i]
  *                 angle = acos(dot_prod) * 57.29578  # Convert radians to degrees
  *                 if angle > 90:  # minimal angle to line. necessary as perpendicular can point either way             # <<<<<<<<<<<<<<
- *                     angle = 180 - angle
- *                 angle = 90 - angle # We want the angle to the plane, not the normal of the plane so 90 - angle
+ *                     angle = 180-angle
+ * 
  */
-        __pyx_t_27 = (__pyx_v_angle > 90.0);
-        if (__pyx_t_27) {
+        __pyx_t_19 = (__pyx_v_angle > 90.0);
+        if (__pyx_t_19) {
 
-          /* "moleculekit/interactions/cationpi/cationpi.pyx":162
+          /* "moleculekit/interactions/pipi/pipi.pyx":171
  *                 angle = acos(dot_prod) * 57.29578  # Convert radians to degrees
  *                 if angle > 90:  # minimal angle to line. necessary as perpendicular can point either way
- *                     angle = 180 - angle             # <<<<<<<<<<<<<<
- *                 angle = 90 - angle # We want the angle to the plane, not the normal of the plane so 90 - angle
+ *                     angle = 180-angle             # <<<<<<<<<<<<<<
  * 
+ *                 # If dist < 4.4 and angle <= 30 deg
  */
           __pyx_v_angle = (180.0 - __pyx_v_angle);
 
-          /* "moleculekit/interactions/cationpi/cationpi.pyx":161
- *                     dot_prod = dot_prod + ring_normal[i] * tmp1[i]
+          /* "moleculekit/interactions/pipi/pipi.pyx":170
+ *                     dot_prod = dot_prod + ring1_normal[i] * ring2_normal[i]
  *                 angle = acos(dot_prod) * 57.29578  # Convert radians to degrees
  *                 if angle > 90:  # minimal angle to line. necessary as perpendicular can point either way             # <<<<<<<<<<<<<<
- *                     angle = 180 - angle
- *                 angle = 90 - angle # We want the angle to the plane, not the normal of the plane so 90 - angle
+ *                     angle = 180-angle
+ * 
  */
         }
 
-        /* "moleculekit/interactions/cationpi/cationpi.pyx":163
- *                 if angle > 90:  # minimal angle to line. necessary as perpendicular can point either way
- *                     angle = 180 - angle
- *                 angle = 90 - angle # We want the angle to the plane, not the normal of the plane so 90 - angle             # <<<<<<<<<<<<<<
- * 
- *                 if angle >= angle_threshold_min:
+        /* "moleculekit/interactions/pipi/pipi.pyx":176
+ *                 # If dist < 5.5 and angle in range [60, 120]
+ *                 # print(r1, r2, sqrt(dist2), angle)
+ *                 if ((dist2 < dist_threshold1 and angle <= angle_threshold1_max) or             # <<<<<<<<<<<<<<
+ *                     (dist2 < dist_threshold2 and angle >= angle_threshold2_min)):
+ *                     results[f].push_back(r1)
  */
-        __pyx_v_angle = (90.0 - __pyx_v_angle);
+        __pyx_t_20 = (__pyx_v_dist2 < __pyx_v_dist_threshold1);
+        if (!__pyx_t_20) {
+          goto __pyx_L27_next_or;
+        } else {
+        }
+        __pyx_t_20 = (__pyx_v_angle <= __pyx_v_angle_threshold1_max);
+        if (!__pyx_t_20) {
+        } else {
+          __pyx_t_19 = __pyx_t_20;
+          goto __pyx_L26_bool_binop_done;
+        }
+        __pyx_L27_next_or:;
 
-        /* "moleculekit/interactions/cationpi/cationpi.pyx":165
- *                 angle = 90 - angle # We want the angle to the plane, not the normal of the plane so 90 - angle
- * 
- *                 if angle >= angle_threshold_min:             # <<<<<<<<<<<<<<
+        /* "moleculekit/interactions/pipi/pipi.pyx":177
+ *                 # print(r1, r2, sqrt(dist2), angle)
+ *                 if ((dist2 < dist_threshold1 and angle <= angle_threshold1_max) or
+ *                     (dist2 < dist_threshold2 and angle >= angle_threshold2_min)):             # <<<<<<<<<<<<<<
+ *                     results[f].push_back(r1)
+ *                     results[f].push_back(r2)
+ */
+        __pyx_t_20 = (__pyx_v_dist2 < __pyx_v_dist_threshold2);
+        if (__pyx_t_20) {
+        } else {
+          __pyx_t_19 = __pyx_t_20;
+          goto __pyx_L26_bool_binop_done;
+        }
+        __pyx_t_20 = (__pyx_v_angle >= __pyx_v_angle_threshold2_min);
+        __pyx_t_19 = __pyx_t_20;
+        __pyx_L26_bool_binop_done:;
+
+        /* "moleculekit/interactions/pipi/pipi.pyx":176
+ *                 # If dist < 5.5 and angle in range [60, 120]
+ *                 # print(r1, r2, sqrt(dist2), angle)
+ *                 if ((dist2 < dist_threshold1 and angle <= angle_threshold1_max) or             # <<<<<<<<<<<<<<
+ *                     (dist2 < dist_threshold2 and angle >= angle_threshold2_min)):
  *                     results[f].push_back(r1)
- *                     results[f].push_back(cations[r2])
  */
-        __pyx_t_27 = (__pyx_v_angle >= __pyx_v_angle_threshold_min);
-        if (__pyx_t_27) {
+        if (__pyx_t_19) {
 
-          /* "moleculekit/interactions/cationpi/cationpi.pyx":166
- * 
- *                 if angle >= angle_threshold_min:
+          /* "moleculekit/interactions/pipi/pipi.pyx":178
+ *                 if ((dist2 < dist_threshold1 and angle <= angle_threshold1_max) or
+ *                     (dist2 < dist_threshold2 and angle >= angle_threshold2_min)):
  *                     results[f].push_back(r1)             # <<<<<<<<<<<<<<
- *                     results[f].push_back(cations[r2])
+ *                     results[f].push_back(r2)
  *                     distangles[f].push_back(sqrt(dist2))
  */
           try {
             (__pyx_v_results[__pyx_v_f]).push_back(__pyx_v_r1);
           } catch(...) {
             __Pyx_CppExn2PyErr();
-            __PYX_ERR(0, 166, __pyx_L1_error)
+            __PYX_ERR(0, 178, __pyx_L1_error)
           }
 
-          /* "moleculekit/interactions/cationpi/cationpi.pyx":167
- *                 if angle >= angle_threshold_min:
+          /* "moleculekit/interactions/pipi/pipi.pyx":179
+ *                     (dist2 < dist_threshold2 and angle >= angle_threshold2_min)):
  *                     results[f].push_back(r1)
- *                     results[f].push_back(cations[r2])             # <<<<<<<<<<<<<<
+ *                     results[f].push_back(r2)             # <<<<<<<<<<<<<<
  *                     distangles[f].push_back(sqrt(dist2))
  *                     distangles[f].push_back(angle)
  */
-          __pyx_t_13 = __pyx_v_r2;
           try {
-            (__pyx_v_results[__pyx_v_f]).push_back((*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t *, __pyx_pybuffernd_cations.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_cations.diminfo[0].strides)));
+            (__pyx_v_results[__pyx_v_f]).push_back(__pyx_v_r2);
           } catch(...) {
             __Pyx_CppExn2PyErr();
-            __PYX_ERR(0, 167, __pyx_L1_error)
+            __PYX_ERR(0, 179, __pyx_L1_error)
           }
 
-          /* "moleculekit/interactions/cationpi/cationpi.pyx":168
+          /* "moleculekit/interactions/pipi/pipi.pyx":180
  *                     results[f].push_back(r1)
- *                     results[f].push_back(cations[r2])
+ *                     results[f].push_back(r2)
  *                     distangles[f].push_back(sqrt(dist2))             # <<<<<<<<<<<<<<
  *                     distangles[f].push_back(angle)
  * 
  */
           try {
             (__pyx_v_distangles[__pyx_v_f]).push_back(sqrt(__pyx_v_dist2));
           } catch(...) {
             __Pyx_CppExn2PyErr();
-            __PYX_ERR(0, 168, __pyx_L1_error)
+            __PYX_ERR(0, 180, __pyx_L1_error)
           }
 
-          /* "moleculekit/interactions/cationpi/cationpi.pyx":169
- *                     results[f].push_back(cations[r2])
+          /* "moleculekit/interactions/pipi/pipi.pyx":181
+ *                     results[f].push_back(r2)
  *                     distangles[f].push_back(sqrt(dist2))
  *                     distangles[f].push_back(angle)             # <<<<<<<<<<<<<<
  * 
  *     return results, distangles
  */
           try {
             (__pyx_v_distangles[__pyx_v_f]).push_back(__pyx_v_angle);
           } catch(...) {
             __Pyx_CppExn2PyErr();
-            __PYX_ERR(0, 169, __pyx_L1_error)
+            __PYX_ERR(0, 181, __pyx_L1_error)
           }
 
-          /* "moleculekit/interactions/cationpi/cationpi.pyx":165
- *                 angle = 90 - angle # We want the angle to the plane, not the normal of the plane so 90 - angle
- * 
- *                 if angle >= angle_threshold_min:             # <<<<<<<<<<<<<<
+          /* "moleculekit/interactions/pipi/pipi.pyx":176
+ *                 # If dist < 5.5 and angle in range [60, 120]
+ *                 # print(r1, r2, sqrt(dist2), angle)
+ *                 if ((dist2 < dist_threshold1 and angle <= angle_threshold1_max) or             # <<<<<<<<<<<<<<
+ *                     (dist2 < dist_threshold2 and angle >= angle_threshold2_min)):
  *                     results[f].push_back(r1)
- *                     results[f].push_back(cations[r2])
  */
         }
         __pyx_L9_continue:;
       }
     }
   }
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":171
+  /* "moleculekit/interactions/pipi/pipi.pyx":183
  *                     distangles[f].push_back(angle)
  * 
  *     return results, distangles             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __pyx_convert_vector_to_py_std_3a__3a_vector_3c_int_3e___(__pyx_v_results); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 171, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___(__pyx_v_distangles); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 171, __pyx_L1_error)
+  __pyx_t_3 = __pyx_convert_vector_to_py_std_3a__3a_vector_3c_int_3e___(__pyx_v_results); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 183, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 171, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GIVEREF(__pyx_t_2);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2)) __PYX_ERR(0, 171, __pyx_L1_error);
+  __pyx_t_1 = __pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___(__pyx_v_distangles); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 183, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 183, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_3)) __PYX_ERR(0, 171, __pyx_L1_error);
-  __pyx_t_2 = 0;
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3)) __PYX_ERR(0, 183, __pyx_L1_error);
+  __Pyx_GIVEREF(__pyx_t_1);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_1)) __PYX_ERR(0, 183, __pyx_L1_error);
   __pyx_t_3 = 0;
-  __pyx_r = __pyx_t_4;
-  __pyx_t_4 = 0;
+  __pyx_t_1 = 0;
+  __pyx_r = __pyx_t_2;
+  __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":90
+  /* "moleculekit/interactions/pipi/pipi.pyx":84
  * 
  * 
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def calculate(
  */
 
   /* function exit code */
   __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_4);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_5, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_20, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_21, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_25, 1);
-  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
-    __Pyx_PyThreadState_declare
-    __Pyx_PyThreadState_assign
-    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
-    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
-    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cations.rcbuffer->pybuffer);
-    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_coords.rcbuffer->pybuffer);
-    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_rings_atoms.rcbuffer->pybuffer);
-    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_rings_start_indexes.rcbuffer->pybuffer);
-  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("moleculekit.interactions.cationpi.calculate", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_t_4, 1);
+  __Pyx_AddTraceback("moleculekit.interactions.pipi.calculate", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
-  goto __pyx_L2;
   __pyx_L0:;
-  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
-  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cations.rcbuffer->pybuffer);
-  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_coords.rcbuffer->pybuffer);
-  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_rings_atoms.rcbuffer->pybuffer);
-  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_rings_start_indexes.rcbuffer->pybuffer);
-  __pyx_L2:;
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_ring_mean, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_ring_normal, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_ring1_mean, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_ring2_mean, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_ring1_normal, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_ring2_normal, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_half_box, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_cation_coor, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_tmp1, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_tmp2, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 static struct __pyx_vtabstruct_array __pyx_vtable_array;
@@ -21577,15 +21700,15 @@
   #endif
   {Py_tp_methods, (void *)__pyx_methods_array},
   {Py_tp_getset, (void *)__pyx_getsets_array},
   {Py_tp_new, (void *)__pyx_tp_new_array},
   {0, 0},
 };
 static PyType_Spec __pyx_type___pyx_array_spec = {
-  "moleculekit.interactions.cationpi.array",
+  "moleculekit.interactions.pipi.array",
   sizeof(struct __pyx_array_obj),
   0,
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_SEQUENCE,
   __pyx_type___pyx_array_slots,
 };
 #else
 
@@ -21623,15 +21746,15 @@
   #endif
   __pyx_array_getbuffer, /*bf_getbuffer*/
   0, /*bf_releasebuffer*/
 };
 
 static PyTypeObject __pyx_type___pyx_array = {
   PyVarObject_HEAD_INIT(0, 0)
-  "moleculekit.interactions.cationpi.""array", /*tp_name*/
+  "moleculekit.interactions.pipi.""array", /*tp_name*/
   sizeof(struct __pyx_array_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc_array, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -21783,25 +21906,25 @@
   {Py_tp_clear, (void *)__pyx_tp_clear_Enum},
   {Py_tp_methods, (void *)__pyx_methods_Enum},
   {Py_tp_init, (void *)__pyx_MemviewEnum___init__},
   {Py_tp_new, (void *)__pyx_tp_new_Enum},
   {0, 0},
 };
 static PyType_Spec __pyx_type___pyx_MemviewEnum_spec = {
-  "moleculekit.interactions.cationpi.Enum",
+  "moleculekit.interactions.pipi.Enum",
   sizeof(struct __pyx_MemviewEnum_obj),
   0,
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC,
   __pyx_type___pyx_MemviewEnum_slots,
 };
 #else
 
 static PyTypeObject __pyx_type___pyx_MemviewEnum = {
   PyVarObject_HEAD_INIT(0, 0)
-  "moleculekit.interactions.cationpi.""Enum", /*tp_name*/
+  "moleculekit.interactions.pipi.""Enum", /*tp_name*/
   sizeof(struct __pyx_MemviewEnum_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc_Enum, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -22090,15 +22213,15 @@
   {Py_tp_clear, (void *)__pyx_tp_clear_memoryview},
   {Py_tp_methods, (void *)__pyx_methods_memoryview},
   {Py_tp_getset, (void *)__pyx_getsets_memoryview},
   {Py_tp_new, (void *)__pyx_tp_new_memoryview},
   {0, 0},
 };
 static PyType_Spec __pyx_type___pyx_memoryview_spec = {
-  "moleculekit.interactions.cationpi.memoryview",
+  "moleculekit.interactions.pipi.memoryview",
   sizeof(struct __pyx_memoryview_obj),
   0,
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC,
   __pyx_type___pyx_memoryview_slots,
 };
 #else
 
@@ -22136,15 +22259,15 @@
   #endif
   __pyx_memoryview_getbuffer, /*bf_getbuffer*/
   0, /*bf_releasebuffer*/
 };
 
 static PyTypeObject __pyx_type___pyx_memoryview = {
   PyVarObject_HEAD_INIT(0, 0)
-  "moleculekit.interactions.cationpi.""memoryview", /*tp_name*/
+  "moleculekit.interactions.pipi.""memoryview", /*tp_name*/
   sizeof(struct __pyx_memoryview_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc_memoryview, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -22290,25 +22413,25 @@
   {Py_tp_traverse, (void *)__pyx_tp_traverse__memoryviewslice},
   {Py_tp_clear, (void *)__pyx_tp_clear__memoryviewslice},
   {Py_tp_methods, (void *)__pyx_methods__memoryviewslice},
   {Py_tp_new, (void *)__pyx_tp_new__memoryviewslice},
   {0, 0},
 };
 static PyType_Spec __pyx_type___pyx_memoryviewslice_spec = {
-  "moleculekit.interactions.cationpi._memoryviewslice",
+  "moleculekit.interactions.pipi._memoryviewslice",
   sizeof(struct __pyx_memoryviewslice_obj),
   0,
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC|Py_TPFLAGS_SEQUENCE,
   __pyx_type___pyx_memoryviewslice_slots,
 };
 #else
 
 static PyTypeObject __pyx_type___pyx_memoryviewslice = {
   PyVarObject_HEAD_INIT(0, 0)
-  "moleculekit.interactions.cationpi.""_memoryviewslice", /*tp_name*/
+  "moleculekit.interactions.pipi.""_memoryviewslice", /*tp_name*/
   sizeof(struct __pyx_memoryviewslice_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc__memoryviewslice, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -22447,36 +22570,36 @@
     {&__pyx_n_s__3, __pyx_k__3, sizeof(__pyx_k__3), 0, 0, 1, 1},
     {&__pyx_kp_u__6, __pyx_k__6, sizeof(__pyx_k__6), 0, 1, 0, 0},
     {&__pyx_kp_u__7, __pyx_k__7, sizeof(__pyx_k__7), 0, 1, 0, 0},
     {&__pyx_n_s_abc, __pyx_k_abc, sizeof(__pyx_k_abc), 0, 0, 1, 1},
     {&__pyx_n_s_allocate_buffer, __pyx_k_allocate_buffer, sizeof(__pyx_k_allocate_buffer), 0, 0, 1, 1},
     {&__pyx_kp_u_and, __pyx_k_and, sizeof(__pyx_k_and), 0, 1, 0, 0},
     {&__pyx_n_s_angle, __pyx_k_angle, sizeof(__pyx_k_angle), 0, 0, 1, 1},
-    {&__pyx_n_s_angle_threshold_min, __pyx_k_angle_threshold_min, sizeof(__pyx_k_angle_threshold_min), 0, 0, 1, 1},
+    {&__pyx_n_s_angle_threshold1_max, __pyx_k_angle_threshold1_max, sizeof(__pyx_k_angle_threshold1_max), 0, 0, 1, 1},
+    {&__pyx_n_s_angle_threshold2_min, __pyx_k_angle_threshold2_min, sizeof(__pyx_k_angle_threshold2_min), 0, 0, 1, 1},
     {&__pyx_n_s_asyncio_coroutines, __pyx_k_asyncio_coroutines, sizeof(__pyx_k_asyncio_coroutines), 0, 0, 1, 1},
     {&__pyx_n_s_base, __pyx_k_base, sizeof(__pyx_k_base), 0, 0, 1, 1},
     {&__pyx_n_s_box, __pyx_k_box, sizeof(__pyx_k_box), 0, 0, 1, 1},
     {&__pyx_n_s_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 0, 1, 1},
     {&__pyx_n_u_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 1, 0, 1},
     {&__pyx_n_s_calculate, __pyx_k_calculate, sizeof(__pyx_k_calculate), 0, 0, 1, 1},
-    {&__pyx_n_s_cation_coor, __pyx_k_cation_coor, sizeof(__pyx_k_cation_coor), 0, 0, 1, 1},
-    {&__pyx_n_s_cations, __pyx_k_cations, sizeof(__pyx_k_cations), 0, 0, 1, 1},
     {&__pyx_n_s_class, __pyx_k_class, sizeof(__pyx_k_class), 0, 0, 1, 1},
     {&__pyx_n_s_class_getitem, __pyx_k_class_getitem, sizeof(__pyx_k_class_getitem), 0, 0, 1, 1},
     {&__pyx_n_s_cline_in_traceback, __pyx_k_cline_in_traceback, sizeof(__pyx_k_cline_in_traceback), 0, 0, 1, 1},
     {&__pyx_n_s_collections, __pyx_k_collections, sizeof(__pyx_k_collections), 0, 0, 1, 1},
     {&__pyx_kp_s_collections_abc, __pyx_k_collections_abc, sizeof(__pyx_k_collections_abc), 0, 0, 1, 0},
     {&__pyx_kp_s_contiguous_and_direct, __pyx_k_contiguous_and_direct, sizeof(__pyx_k_contiguous_and_direct), 0, 0, 1, 0},
     {&__pyx_kp_s_contiguous_and_indirect, __pyx_k_contiguous_and_indirect, sizeof(__pyx_k_contiguous_and_indirect), 0, 0, 1, 0},
     {&__pyx_n_s_coords, __pyx_k_coords, sizeof(__pyx_k_coords), 0, 0, 1, 1},
     {&__pyx_n_s_count, __pyx_k_count, sizeof(__pyx_k_count), 0, 0, 1, 1},
     {&__pyx_n_s_dict, __pyx_k_dict, sizeof(__pyx_k_dict), 0, 0, 1, 1},
     {&__pyx_kp_u_disable, __pyx_k_disable, sizeof(__pyx_k_disable), 0, 1, 0, 0},
     {&__pyx_n_s_dist2, __pyx_k_dist2, sizeof(__pyx_k_dist2), 0, 0, 1, 1},
-    {&__pyx_n_s_dist_threshold, __pyx_k_dist_threshold, sizeof(__pyx_k_dist_threshold), 0, 0, 1, 1},
+    {&__pyx_n_s_dist_threshold1, __pyx_k_dist_threshold1, sizeof(__pyx_k_dist_threshold1), 0, 0, 1, 1},
+    {&__pyx_n_s_dist_threshold2, __pyx_k_dist_threshold2, sizeof(__pyx_k_dist_threshold2), 0, 0, 1, 1},
     {&__pyx_n_s_distangles, __pyx_k_distangles, sizeof(__pyx_k_distangles), 0, 0, 1, 1},
     {&__pyx_n_s_dot_prod, __pyx_k_dot_prod, sizeof(__pyx_k_dot_prod), 0, 0, 1, 1},
     {&__pyx_n_s_dtype, __pyx_k_dtype, sizeof(__pyx_k_dtype), 0, 0, 1, 1},
     {&__pyx_n_s_dtype_is_object, __pyx_k_dtype_is_object, sizeof(__pyx_k_dtype_is_object), 0, 0, 1, 1},
     {&__pyx_kp_u_enable, __pyx_k_enable, sizeof(__pyx_k_enable), 0, 1, 0, 0},
     {&__pyx_n_s_encode, __pyx_k_encode, sizeof(__pyx_k_encode), 0, 0, 1, 1},
     {&__pyx_n_s_enumerate, __pyx_k_enumerate, sizeof(__pyx_k_enumerate), 0, 0, 1, 1},
@@ -22500,19 +22623,19 @@
     {&__pyx_n_s_is_coroutine, __pyx_k_is_coroutine, sizeof(__pyx_k_is_coroutine), 0, 0, 1, 1},
     {&__pyx_kp_u_isenabled, __pyx_k_isenabled, sizeof(__pyx_k_isenabled), 0, 1, 0, 0},
     {&__pyx_n_s_itemsize, __pyx_k_itemsize, sizeof(__pyx_k_itemsize), 0, 0, 1, 1},
     {&__pyx_kp_s_itemsize_0_for_cython_array, __pyx_k_itemsize_0_for_cython_array, sizeof(__pyx_k_itemsize_0_for_cython_array), 0, 0, 1, 0},
     {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
     {&__pyx_n_s_memview, __pyx_k_memview, sizeof(__pyx_k_memview), 0, 0, 1, 1},
     {&__pyx_n_s_mode, __pyx_k_mode, sizeof(__pyx_k_mode), 0, 0, 1, 1},
-    {&__pyx_kp_s_moleculekit_interactions_cationp, __pyx_k_moleculekit_interactions_cationp, sizeof(__pyx_k_moleculekit_interactions_cationp), 0, 0, 1, 0},
-    {&__pyx_n_s_moleculekit_interactions_cationp_2, __pyx_k_moleculekit_interactions_cationp_2, sizeof(__pyx_k_moleculekit_interactions_cationp_2), 0, 0, 1, 1},
-    {&__pyx_n_s_n_cations, __pyx_k_n_cations, sizeof(__pyx_k_n_cations), 0, 0, 1, 1},
+    {&__pyx_n_s_moleculekit_interactions_pipi, __pyx_k_moleculekit_interactions_pipi, sizeof(__pyx_k_moleculekit_interactions_pipi), 0, 0, 1, 1},
+    {&__pyx_kp_s_moleculekit_interactions_pipi_pi, __pyx_k_moleculekit_interactions_pipi_pi, sizeof(__pyx_k_moleculekit_interactions_pipi_pi), 0, 0, 1, 0},
     {&__pyx_n_s_n_frames, __pyx_k_n_frames, sizeof(__pyx_k_n_frames), 0, 0, 1, 1},
-    {&__pyx_n_s_n_rings, __pyx_k_n_rings, sizeof(__pyx_k_n_rings), 0, 0, 1, 1},
+    {&__pyx_n_s_n_rings1, __pyx_k_n_rings1, sizeof(__pyx_k_n_rings1), 0, 0, 1, 1},
+    {&__pyx_n_s_n_rings2, __pyx_k_n_rings2, sizeof(__pyx_k_n_rings2), 0, 0, 1, 1},
     {&__pyx_n_s_name, __pyx_k_name, sizeof(__pyx_k_name), 0, 0, 1, 1},
     {&__pyx_n_s_name_2, __pyx_k_name_2, sizeof(__pyx_k_name_2), 0, 0, 1, 1},
     {&__pyx_n_s_ndim, __pyx_k_ndim, sizeof(__pyx_k_ndim), 0, 0, 1, 1},
     {&__pyx_n_s_new, __pyx_k_new, sizeof(__pyx_k_new), 0, 0, 1, 1},
     {&__pyx_kp_s_no_default___reduce___due_to_non, __pyx_k_no_default___reduce___due_to_non, sizeof(__pyx_k_no_default___reduce___due_to_non), 0, 0, 1, 0},
     {&__pyx_n_s_np, __pyx_k_np, sizeof(__pyx_k_np), 0, 0, 1, 1},
     {&__pyx_n_s_numpy, __pyx_k_numpy, sizeof(__pyx_k_numpy), 0, 0, 1, 1},
@@ -22525,27 +22648,32 @@
     {&__pyx_n_s_pyx_checksum, __pyx_k_pyx_checksum, sizeof(__pyx_k_pyx_checksum), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_result, __pyx_k_pyx_result, sizeof(__pyx_k_pyx_result), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_state, __pyx_k_pyx_state, sizeof(__pyx_k_pyx_state), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_type, __pyx_k_pyx_type, sizeof(__pyx_k_pyx_type), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_unpickle_Enum, __pyx_k_pyx_unpickle_Enum, sizeof(__pyx_k_pyx_unpickle_Enum), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_vtable, __pyx_k_pyx_vtable, sizeof(__pyx_k_pyx_vtable), 0, 0, 1, 1},
     {&__pyx_n_s_r1, __pyx_k_r1, sizeof(__pyx_k_r1), 0, 0, 1, 1},
+    {&__pyx_n_s_r1_end_idx, __pyx_k_r1_end_idx, sizeof(__pyx_k_r1_end_idx), 0, 0, 1, 1},
+    {&__pyx_n_s_r1_start_idx, __pyx_k_r1_start_idx, sizeof(__pyx_k_r1_start_idx), 0, 0, 1, 1},
     {&__pyx_n_s_r2, __pyx_k_r2, sizeof(__pyx_k_r2), 0, 0, 1, 1},
-    {&__pyx_n_s_r_end_idx, __pyx_k_r_end_idx, sizeof(__pyx_k_r_end_idx), 0, 0, 1, 1},
-    {&__pyx_n_s_r_start_idx, __pyx_k_r_start_idx, sizeof(__pyx_k_r_start_idx), 0, 0, 1, 1},
+    {&__pyx_n_s_r2_end_idx, __pyx_k_r2_end_idx, sizeof(__pyx_k_r2_end_idx), 0, 0, 1, 1},
+    {&__pyx_n_s_r2_start_idx, __pyx_k_r2_start_idx, sizeof(__pyx_k_r2_start_idx), 0, 0, 1, 1},
     {&__pyx_n_s_range, __pyx_k_range, sizeof(__pyx_k_range), 0, 0, 1, 1},
     {&__pyx_n_s_reduce, __pyx_k_reduce, sizeof(__pyx_k_reduce), 0, 0, 1, 1},
     {&__pyx_n_s_reduce_cython, __pyx_k_reduce_cython, sizeof(__pyx_k_reduce_cython), 0, 0, 1, 1},
     {&__pyx_n_s_reduce_ex, __pyx_k_reduce_ex, sizeof(__pyx_k_reduce_ex), 0, 0, 1, 1},
     {&__pyx_n_s_register, __pyx_k_register, sizeof(__pyx_k_register), 0, 0, 1, 1},
     {&__pyx_n_s_results, __pyx_k_results, sizeof(__pyx_k_results), 0, 0, 1, 1},
-    {&__pyx_n_s_ring_mean, __pyx_k_ring_mean, sizeof(__pyx_k_ring_mean), 0, 0, 1, 1},
-    {&__pyx_n_s_ring_normal, __pyx_k_ring_normal, sizeof(__pyx_k_ring_normal), 0, 0, 1, 1},
+    {&__pyx_n_s_ring1_mean, __pyx_k_ring1_mean, sizeof(__pyx_k_ring1_mean), 0, 0, 1, 1},
+    {&__pyx_n_s_ring1_normal, __pyx_k_ring1_normal, sizeof(__pyx_k_ring1_normal), 0, 0, 1, 1},
+    {&__pyx_n_s_ring2_mean, __pyx_k_ring2_mean, sizeof(__pyx_k_ring2_mean), 0, 0, 1, 1},
+    {&__pyx_n_s_ring2_normal, __pyx_k_ring2_normal, sizeof(__pyx_k_ring2_normal), 0, 0, 1, 1},
+    {&__pyx_n_s_rings1_start_indexes, __pyx_k_rings1_start_indexes, sizeof(__pyx_k_rings1_start_indexes), 0, 0, 1, 1},
+    {&__pyx_n_s_rings2_start_indexes, __pyx_k_rings2_start_indexes, sizeof(__pyx_k_rings2_start_indexes), 0, 0, 1, 1},
     {&__pyx_n_s_rings_atoms, __pyx_k_rings_atoms, sizeof(__pyx_k_rings_atoms), 0, 0, 1, 1},
-    {&__pyx_n_s_rings_start_indexes, __pyx_k_rings_start_indexes, sizeof(__pyx_k_rings_start_indexes), 0, 0, 1, 1},
     {&__pyx_n_s_setstate, __pyx_k_setstate, sizeof(__pyx_k_setstate), 0, 0, 1, 1},
     {&__pyx_n_s_setstate_cython, __pyx_k_setstate_cython, sizeof(__pyx_k_setstate_cython), 0, 0, 1, 1},
     {&__pyx_n_s_shape, __pyx_k_shape, sizeof(__pyx_k_shape), 0, 0, 1, 1},
     {&__pyx_n_s_size, __pyx_k_size, sizeof(__pyx_k_size), 0, 0, 1, 1},
     {&__pyx_n_s_spec, __pyx_k_spec, sizeof(__pyx_k_spec), 0, 0, 1, 1},
     {&__pyx_n_s_start, __pyx_k_start, sizeof(__pyx_k_start), 0, 0, 1, 1},
     {&__pyx_n_s_step, __pyx_k_step, sizeof(__pyx_k_step), 0, 0, 1, 1},
@@ -22625,44 +22753,44 @@
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError, "Incompatible checksums (0x%x vs (0x82a3537, 0x6ae9995, 0xb068931) = (name))" % __pyx_checksum
  */
   __pyx_tuple__8 = PyTuple_Pack(3, __pyx_int_136983863, __pyx_int_112105877, __pyx_int_184977713); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__8);
   __Pyx_GIVEREF(__pyx_tuple__8);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(2, 983, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__9);
   __Pyx_GIVEREF(__pyx_tuple__9);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(2, 989, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__10);
   __Pyx_GIVEREF(__pyx_tuple__10);
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":108
+  /* "moleculekit/interactions/pipi/pipi.pyx":104
  *     cdef vector[vector[int]] results
  *     cdef vector[vector[float]] distangles
- *     cdef FLOAT32_t[:] ring_mean = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
- *     cdef FLOAT32_t[:] ring_normal = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] ring1_mean = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
+ *     cdef FLOAT32_t[:] ring2_mean = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] ring1_normal = np.zeros(3, dtype=FLOAT32)
  */
-  __pyx_tuple__11 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 108, __pyx_L1_error)
+  __pyx_tuple__11 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 104, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__11);
   __Pyx_GIVEREF(__pyx_tuple__11);
 
   /* "View.MemoryView":100
  * cdef object __pyx_collections_abc_Sequence "__pyx_collections_abc_Sequence"
  * try:
  *     if __import__("sys").version_info >= (3, 3):             # <<<<<<<<<<<<<<
@@ -22759,25 +22887,25 @@
  *     cdef object __pyx_result
  */
   __pyx_tuple__21 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__21);
   __Pyx_GIVEREF(__pyx_tuple__21);
   __pyx_codeobj__22 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__21, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__22)) __PYX_ERR(1, 1, __pyx_L1_error)
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":90
+  /* "moleculekit/interactions/pipi/pipi.pyx":84
  * 
  * 
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def calculate(
  */
-  __pyx_tuple__23 = PyTuple_Pack(27, __pyx_n_s_rings_atoms, __pyx_n_s_rings_start_indexes, __pyx_n_s_cations, __pyx_n_s_coords, __pyx_n_s_box, __pyx_n_s_dist_threshold, __pyx_n_s_angle_threshold_min, __pyx_n_s_r1, __pyx_n_s_r2, __pyx_n_s_f, __pyx_n_s_i, __pyx_n_s_n_rings, __pyx_n_s_n_cations, __pyx_n_s_n_frames, __pyx_n_s_results, __pyx_n_s_distangles, __pyx_n_s_ring_mean, __pyx_n_s_ring_normal, __pyx_n_s_half_box, __pyx_n_s_cation_coor, __pyx_n_s_tmp1, __pyx_n_s_tmp2, __pyx_n_s_dist2, __pyx_n_s_dot_prod, __pyx_n_s_r_start_idx, __pyx_n_s_r_end_idx, __pyx_n_s_angle); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 90, __pyx_L1_error)
+  __pyx_tuple__23 = PyTuple_Pack(32, __pyx_n_s_rings_atoms, __pyx_n_s_rings1_start_indexes, __pyx_n_s_rings2_start_indexes, __pyx_n_s_coords, __pyx_n_s_box, __pyx_n_s_dist_threshold1, __pyx_n_s_angle_threshold1_max, __pyx_n_s_dist_threshold2, __pyx_n_s_angle_threshold2_min, __pyx_n_s_r1, __pyx_n_s_r2, __pyx_n_s_f, __pyx_n_s_i, __pyx_n_s_n_rings1, __pyx_n_s_n_rings2, __pyx_n_s_n_frames, __pyx_n_s_results, __pyx_n_s_distangles, __pyx_n_s_ring1_mean, __pyx_n_s_ring2_mean, __pyx_n_s_ring1_normal, __pyx_n_s_ring2_normal, __pyx_n_s_half_box, __pyx_n_s_tmp1, __pyx_n_s_tmp2, __pyx_n_s_dist2, __pyx_n_s_dot_prod, __pyx_n_s_r1_start_idx, __pyx_n_s_r2_start_idx, __pyx_n_s_r1_end_idx, __pyx_n_s_r2_end_idx, __pyx_n_s_angle); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 84, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__23);
   __Pyx_GIVEREF(__pyx_tuple__23);
-  __pyx_codeobj__24 = (PyObject*)__Pyx_PyCode_New(7, 0, 0, 27, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__23, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_moleculekit_interactions_cationp, __pyx_n_s_calculate, 90, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__24)) __PYX_ERR(0, 90, __pyx_L1_error)
+  __pyx_codeobj__24 = (PyObject*)__Pyx_PyCode_New(9, 0, 0, 32, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__23, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_moleculekit_interactions_pipi_pi, __pyx_n_s_calculate, 84, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__24)) __PYX_ERR(0, 84, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 /* #### Code section: init_constants ### */
@@ -23084,31 +23212,31 @@
   return 0;
 }
 
 
 #if PY_MAJOR_VERSION >= 3
 #if CYTHON_PEP489_MULTI_PHASE_INIT
 static PyObject* __pyx_pymod_create(PyObject *spec, PyModuleDef *def); /*proto*/
-static int __pyx_pymod_exec_cationpi(PyObject* module); /*proto*/
+static int __pyx_pymod_exec_pipi(PyObject* module); /*proto*/
 static PyModuleDef_Slot __pyx_moduledef_slots[] = {
   {Py_mod_create, (void*)__pyx_pymod_create},
-  {Py_mod_exec, (void*)__pyx_pymod_exec_cationpi},
+  {Py_mod_exec, (void*)__pyx_pymod_exec_pipi},
   {0, NULL}
 };
 #endif
 
 #ifdef __cplusplus
 namespace {
   struct PyModuleDef __pyx_moduledef =
   #else
   static struct PyModuleDef __pyx_moduledef =
   #endif
   {
       PyModuleDef_HEAD_INIT,
-      "cationpi",
+      "pipi",
       0, /* m_doc */
     #if CYTHON_PEP489_MULTI_PHASE_INIT
       0, /* m_size */
     #elif CYTHON_USE_MODULE_STATE
       sizeof(__pyx_mstate), /* m_size */
     #else
       -1, /* m_size */
@@ -23148,19 +23276,19 @@
 #else
 #define __Pyx_PyMODINIT_FUNC PyObject *
 #endif
 #endif
 
 
 #if PY_MAJOR_VERSION < 3
-__Pyx_PyMODINIT_FUNC initcationpi(void) CYTHON_SMALL_CODE; /*proto*/
-__Pyx_PyMODINIT_FUNC initcationpi(void)
+__Pyx_PyMODINIT_FUNC initpipi(void) CYTHON_SMALL_CODE; /*proto*/
+__Pyx_PyMODINIT_FUNC initpipi(void)
 #else
-__Pyx_PyMODINIT_FUNC PyInit_cationpi(void) CYTHON_SMALL_CODE; /*proto*/
-__Pyx_PyMODINIT_FUNC PyInit_cationpi(void)
+__Pyx_PyMODINIT_FUNC PyInit_pipi(void) CYTHON_SMALL_CODE; /*proto*/
+__Pyx_PyMODINIT_FUNC PyInit_pipi(void)
 #if CYTHON_PEP489_MULTI_PHASE_INIT
 {
   return PyModuleDef_Init(&__pyx_moduledef);
 }
 static CYTHON_SMALL_CODE int __Pyx_check_single_interpreter(void) {
     #if PY_VERSION_HEX >= 0x030700A1
     static PY_INT64_T main_interpreter_id = -1;
@@ -23233,15 +23361,15 @@
     return module;
 bad:
     Py_XDECREF(module);
     return NULL;
 }
 
 
-static CYTHON_SMALL_CODE int __pyx_pymod_exec_cationpi(PyObject *__pyx_pyinit_module)
+static CYTHON_SMALL_CODE int __pyx_pymod_exec_pipi(PyObject *__pyx_pyinit_module)
 #endif
 #endif
 {
   int stringtab_initialized = 0;
   #if CYTHON_USE_MODULE_STATE
   int pystate_addmodule_run = 0;
   #endif
@@ -23249,40 +23377,42 @@
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_t_6;
   PyObject *__pyx_t_7 = NULL;
   static PyThread_type_lock __pyx_t_8[8];
+  PyObject *__pyx_t_9 = NULL;
+  PyObject *__pyx_t_10 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannyDeclarations
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   if (__pyx_m) {
     if (__pyx_m == __pyx_pyinit_module) return 0;
-    PyErr_SetString(PyExc_RuntimeError, "Module 'cationpi' has already been imported. Re-initialisation is not supported.");
+    PyErr_SetString(PyExc_RuntimeError, "Module 'pipi' has already been imported. Re-initialisation is not supported.");
     return -1;
   }
   #elif PY_MAJOR_VERSION >= 3
   if (__pyx_m) return __Pyx_NewRef(__pyx_m);
   #endif
   /*--- Module creation code ---*/
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   __pyx_m = __pyx_pyinit_module;
   Py_INCREF(__pyx_m);
   #else
   #if PY_MAJOR_VERSION < 3
-  __pyx_m = Py_InitModule4("cationpi", __pyx_methods, 0, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
+  __pyx_m = Py_InitModule4("pipi", __pyx_methods, 0, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
   if (unlikely(!__pyx_m)) __PYX_ERR(0, 1, __pyx_L1_error)
   #elif CYTHON_USE_MODULE_STATE
   __pyx_t_1 = PyModule_Create(&__pyx_moduledef); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)
   {
     int add_module_result = PyState_AddModule(__pyx_t_1, &__pyx_moduledef);
-    __pyx_t_1 = 0; /* transfer ownership from __pyx_t_1 to cationpi pseudovariable */
+    __pyx_t_1 = 0; /* transfer ownership from __pyx_t_1 to pipi pseudovariable */
     if (unlikely((add_module_result < 0))) __PYX_ERR(0, 1, __pyx_L1_error)
     pystate_addmodule_run = 1;
   }
   #else
   __pyx_m = PyModule_Create(&__pyx_moduledef);
   if (unlikely(!__pyx_m)) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
@@ -23298,15 +23428,15 @@
 if (!__Pyx_RefNanny) {
   PyErr_Clear();
   __Pyx_RefNanny = __Pyx_RefNannyImportAPI("Cython.Runtime.refnanny");
   if (!__Pyx_RefNanny)
       Py_FatalError("failed to import 'refnanny' module");
 }
 #endif
-  __Pyx_RefNannySetupContext("__Pyx_PyMODINIT_FUNC PyInit_cationpi(void)", 0);
+  __Pyx_RefNannySetupContext("__Pyx_PyMODINIT_FUNC PyInit_pipi(void)", 0);
   if (__Pyx_check_binary_version(__PYX_LIMITED_VERSION_HEX, __Pyx_get_runtime_version(), CYTHON_COMPILING_IN_LIMITED_API) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #ifdef __Pxy_PyFrame_Initialize_Offsets
   __Pxy_PyFrame_Initialize_Offsets();
   #endif
   __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_empty_bytes = PyBytes_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_empty_unicode = PyUnicode_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_unicode)) __PYX_ERR(0, 1, __pyx_L1_error)
@@ -23336,22 +23466,22 @@
   /*--- Initialize various global constants etc. ---*/
   if (__Pyx_InitConstants() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   stringtab_initialized = 1;
   if (__Pyx_InitGlobals() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #if PY_MAJOR_VERSION < 3 && (__PYX_DEFAULT_STRING_ENCODING_IS_ASCII || __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT)
   if (__Pyx_init_sys_getdefaultencoding_params() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
-  if (__pyx_module_is_main_moleculekit__interactions__cationpi) {
+  if (__pyx_module_is_main_moleculekit__interactions__pipi) {
     if (PyObject_SetAttr(__pyx_m, __pyx_n_s_name_2, __pyx_n_s_main) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   }
   #if PY_MAJOR_VERSION >= 3
   {
     PyObject *modules = PyImport_GetModuleDict(); if (unlikely(!modules)) __PYX_ERR(0, 1, __pyx_L1_error)
-    if (!PyDict_GetItemString(modules, "moleculekit.interactions.cationpi")) {
-      if (unlikely((PyDict_SetItemString(modules, "moleculekit.interactions.cationpi", __pyx_m) < 0))) __PYX_ERR(0, 1, __pyx_L1_error)
+    if (!PyDict_GetItemString(modules, "moleculekit.interactions.pipi")) {
+      if (unlikely((PyDict_SetItemString(modules, "moleculekit.interactions.pipi", __pyx_m) < 0))) __PYX_ERR(0, 1, __pyx_L1_error)
     }
   }
   #endif
   /*--- Builtin init code ---*/
   if (__Pyx_InitCachedBuiltins() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   /*--- Constants init code ---*/
   if (__Pyx_InitCachedConstants() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
@@ -23877,132 +24007,160 @@
  *     cdef object __pyx_result
  */
   __pyx_t_7 = PyCFunction_NewEx(&__pyx_mdef_15View_dot_MemoryView_1__pyx_unpickle_Enum, NULL, __pyx_n_s_View_MemoryView); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_pyx_unpickle_Enum, __pyx_t_7) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":3
+  /* "moleculekit/interactions/pipi/pipi.pyx":3
  * # cython: cdivision=True
  * 
  * import numpy as np             # <<<<<<<<<<<<<<
  * cimport numpy as np
  * from libcpp.vector cimport vector
  */
   __pyx_t_7 = __Pyx_ImportDottedModule(__pyx_n_s_numpy, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_7) < 0) __PYX_ERR(0, 3, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":11
+  /* "moleculekit/interactions/pipi/pipi.pyx":11
  * # DTYPE for this, which is assigned to the usual NumPy runtime
  * # type info object.
  * UINT32 = np.uint32             # <<<<<<<<<<<<<<
  * FLOAT32 = np.float32
  * 
  */
   __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 11, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_uint32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 11, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_UINT32, __pyx_t_4) < 0) __PYX_ERR(0, 11, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":12
+  /* "moleculekit/interactions/pipi/pipi.pyx":12
  * # type info object.
  * UINT32 = np.uint32
  * FLOAT32 = np.float32             # <<<<<<<<<<<<<<
  * 
  * # "ctypedef" assigns a corresponding compile-time type to DTYPE_t. For
  */
   __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 12, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float32); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 12, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_FLOAT32, __pyx_t_7) < 0) __PYX_ERR(0, 12, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":98
- *         np.ndarray[FLOAT32_t, ndim=3] coords,
- *         np.ndarray[FLOAT32_t, ndim=2] box,
- *         float dist_threshold=5,             # <<<<<<<<<<<<<<
- *         float angle_threshold_min=60,
- *     ):
+  /* "moleculekit/interactions/pipi/pipi.pyx":92
+ *         FLOAT32_t[:,:,:] coords,
+ *         FLOAT32_t[:,:] box,
+ *         float dist_threshold1=4.4,             # <<<<<<<<<<<<<<
+ *         float angle_threshold1_max=30,
+ *         float dist_threshold2=5.5,
  */
-  __pyx_t_7 = PyFloat_FromDouble(((float)5.0)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 98, __pyx_L1_error)
+  __pyx_t_7 = PyFloat_FromDouble(((double)4.4)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 92, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":99
- *         np.ndarray[FLOAT32_t, ndim=2] box,
- *         float dist_threshold=5,
- *         float angle_threshold_min=60,             # <<<<<<<<<<<<<<
+  /* "moleculekit/interactions/pipi/pipi.pyx":93
+ *         FLOAT32_t[:,:] box,
+ *         float dist_threshold1=4.4,
+ *         float angle_threshold1_max=30,             # <<<<<<<<<<<<<<
+ *         float dist_threshold2=5.5,
+ *         float angle_threshold2_min=60,
+ */
+  __pyx_t_4 = PyFloat_FromDouble(((float)30.0)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 93, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+
+  /* "moleculekit/interactions/pipi/pipi.pyx":94
+ *         float dist_threshold1=4.4,
+ *         float angle_threshold1_max=30,
+ *         float dist_threshold2=5.5,             # <<<<<<<<<<<<<<
+ *         float angle_threshold2_min=60,
+ *     ):
+ */
+  __pyx_t_5 = PyFloat_FromDouble(((double)5.5)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 94, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+
+  /* "moleculekit/interactions/pipi/pipi.pyx":95
+ *         float angle_threshold1_max=30,
+ *         float dist_threshold2=5.5,
+ *         float angle_threshold2_min=60,             # <<<<<<<<<<<<<<
  *     ):
  *     cdef int r1, r2, f, i
  */
-  __pyx_t_4 = PyFloat_FromDouble(((float)60.0)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 99, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_9 = PyFloat_FromDouble(((float)60.0)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 95, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_9);
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":90
+  /* "moleculekit/interactions/pipi/pipi.pyx":84
  * 
  * 
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def calculate(
  */
-  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 90, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_10 = PyTuple_New(4); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 84, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_10);
   __Pyx_GIVEREF(__pyx_t_7);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_7)) __PYX_ERR(0, 90, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_7)) __PYX_ERR(0, 84, __pyx_L1_error);
   __Pyx_GIVEREF(__pyx_t_4);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4)) __PYX_ERR(0, 90, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_10, 1, __pyx_t_4)) __PYX_ERR(0, 84, __pyx_L1_error);
+  __Pyx_GIVEREF(__pyx_t_5);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_10, 2, __pyx_t_5)) __PYX_ERR(0, 84, __pyx_L1_error);
+  __Pyx_GIVEREF(__pyx_t_9);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_10, 3, __pyx_t_9)) __PYX_ERR(0, 84, __pyx_L1_error);
   __pyx_t_7 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11moleculekit_12interactions_8cationpi_1calculate, 0, __pyx_n_s_calculate, NULL, __pyx_n_s_moleculekit_interactions_cationp_2, __pyx_d, ((PyObject *)__pyx_codeobj__24)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 90, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_4, __pyx_t_5);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_calculate, __pyx_t_4) < 0) __PYX_ERR(0, 90, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_5 = 0;
+  __pyx_t_9 = 0;
+  __pyx_t_9 = __Pyx_CyFunction_New(&__pyx_mdef_11moleculekit_12interactions_4pipi_1calculate, 0, __pyx_n_s_calculate, NULL, __pyx_n_s_moleculekit_interactions_pipi, __pyx_d, ((PyObject *)__pyx_codeobj__24)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 84, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_9);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_9, __pyx_t_10);
+  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_calculate, __pyx_t_9) < 0) __PYX_ERR(0, 84, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-  /* "moleculekit/interactions/cationpi/cationpi.pyx":1
+  /* "moleculekit/interactions/pipi/pipi.pyx":1
  * # cython: cdivision=True             # <<<<<<<<<<<<<<
  * 
  * import numpy as np
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_4) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_9 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_9);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_9) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
   /*--- Wrapped vars code ---*/
 
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_XDECREF(__pyx_t_9);
+  __Pyx_XDECREF(__pyx_t_10);
   if (__pyx_m) {
     if (__pyx_d && stringtab_initialized) {
-      __Pyx_AddTraceback("init moleculekit.interactions.cationpi", __pyx_clineno, __pyx_lineno, __pyx_filename);
+      __Pyx_AddTraceback("init moleculekit.interactions.pipi", __pyx_clineno, __pyx_lineno, __pyx_filename);
     }
     #if !CYTHON_USE_MODULE_STATE
     Py_CLEAR(__pyx_m);
     #else
     Py_DECREF(__pyx_m);
     if (pystate_addmodule_run) {
       PyObject *tp, *value, *tb;
       PyErr_Fetch(&tp, &value, &tb);
       PyState_RemoveModule(&__pyx_moduledef);
       PyErr_Restore(tp, value, tb);
     }
     #endif
   } else if (!PyErr_Occurred()) {
-    PyErr_SetString(PyExc_ImportError, "init moleculekit.interactions.cationpi");
+    PyErr_SetString(PyExc_ImportError, "init moleculekit.interactions.pipi");
   }
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   return (__pyx_m != NULL) ? 0 : -1;
   #elif PY_MAJOR_VERSION >= 3
   return __pyx_m;
@@ -26461,584 +26619,16 @@
     } else {
         Py_DECREF(r);
         return 1;
     }
 }
 #endif
 
-/* IsLittleEndian */
-static CYTHON_INLINE int __Pyx_Is_Little_Endian(void)
-{
-  union {
-    uint32_t u32;
-    uint8_t u8[4];
-  } S;
-  S.u32 = 0x01020304;
-  return S.u8[0] == 4;
-}
-
-/* BufferFormatCheck */
-static void __Pyx_BufFmt_Init(__Pyx_BufFmt_Context* ctx,
-                              __Pyx_BufFmt_StackElem* stack,
-                              __Pyx_TypeInfo* type) {
-  stack[0].field = &ctx->root;
-  stack[0].parent_offset = 0;
-  ctx->root.type = type;
-  ctx->root.name = "buffer dtype";
-  ctx->root.offset = 0;
-  ctx->head = stack;
-  ctx->head->field = &ctx->root;
-  ctx->fmt_offset = 0;
-  ctx->head->parent_offset = 0;
-  ctx->new_packmode = '@';
-  ctx->enc_packmode = '@';
-  ctx->new_count = 1;
-  ctx->enc_count = 0;
-  ctx->enc_type = 0;
-  ctx->is_complex = 0;
-  ctx->is_valid_array = 0;
-  ctx->struct_alignment = 0;
-  while (type->typegroup == 'S') {
-    ++ctx->head;
-    ctx->head->field = type->fields;
-    ctx->head->parent_offset = 0;
-    type = type->fields->type;
-  }
-}
-static int __Pyx_BufFmt_ParseNumber(const char** ts) {
-    int count;
-    const char* t = *ts;
-    if (*t < '0' || *t > '9') {
-      return -1;
-    } else {
-        count = *t++ - '0';
-        while (*t >= '0' && *t <= '9') {
-            count *= 10;
-            count += *t++ - '0';
-        }
-    }
-    *ts = t;
-    return count;
-}
-static int __Pyx_BufFmt_ExpectNumber(const char **ts) {
-    int number = __Pyx_BufFmt_ParseNumber(ts);
-    if (number == -1)
-        PyErr_Format(PyExc_ValueError,\
-                     "Does not understand character buffer dtype format string ('%c')", **ts);
-    return number;
-}
-static void __Pyx_BufFmt_RaiseUnexpectedChar(char ch) {
-  PyErr_Format(PyExc_ValueError,
-               "Unexpected format string character: '%c'", ch);
-}
-static const char* __Pyx_BufFmt_DescribeTypeChar(char ch, int is_complex) {
-  switch (ch) {
-    case '?': return "'bool'";
-    case 'c': return "'char'";
-    case 'b': return "'signed char'";
-    case 'B': return "'unsigned char'";
-    case 'h': return "'short'";
-    case 'H': return "'unsigned short'";
-    case 'i': return "'int'";
-    case 'I': return "'unsigned int'";
-    case 'l': return "'long'";
-    case 'L': return "'unsigned long'";
-    case 'q': return "'long long'";
-    case 'Q': return "'unsigned long long'";
-    case 'f': return (is_complex ? "'complex float'" : "'float'");
-    case 'd': return (is_complex ? "'complex double'" : "'double'");
-    case 'g': return (is_complex ? "'complex long double'" : "'long double'");
-    case 'T': return "a struct";
-    case 'O': return "Python object";
-    case 'P': return "a pointer";
-    case 's': case 'p': return "a string";
-    case 0: return "end";
-    default: return "unparsable format string";
-  }
-}
-static size_t __Pyx_BufFmt_TypeCharToStandardSize(char ch, int is_complex) {
-  switch (ch) {
-    case '?': case 'c': case 'b': case 'B': case 's': case 'p': return 1;
-    case 'h': case 'H': return 2;
-    case 'i': case 'I': case 'l': case 'L': return 4;
-    case 'q': case 'Q': return 8;
-    case 'f': return (is_complex ? 8 : 4);
-    case 'd': return (is_complex ? 16 : 8);
-    case 'g': {
-      PyErr_SetString(PyExc_ValueError, "Python does not define a standard format string size for long double ('g')..");
-      return 0;
-    }
-    case 'O': case 'P': return sizeof(void*);
-    default:
-      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
-      return 0;
-    }
-}
-static size_t __Pyx_BufFmt_TypeCharToNativeSize(char ch, int is_complex) {
-  switch (ch) {
-    case '?': case 'c': case 'b': case 'B': case 's': case 'p': return 1;
-    case 'h': case 'H': return sizeof(short);
-    case 'i': case 'I': return sizeof(int);
-    case 'l': case 'L': return sizeof(long);
-    #ifdef HAVE_LONG_LONG
-    case 'q': case 'Q': return sizeof(PY_LONG_LONG);
-    #endif
-    case 'f': return sizeof(float) * (is_complex ? 2 : 1);
-    case 'd': return sizeof(double) * (is_complex ? 2 : 1);
-    case 'g': return sizeof(long double) * (is_complex ? 2 : 1);
-    case 'O': case 'P': return sizeof(void*);
-    default: {
-      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
-      return 0;
-    }
-  }
-}
-typedef struct { char c; short x; } __Pyx_st_short;
-typedef struct { char c; int x; } __Pyx_st_int;
-typedef struct { char c; long x; } __Pyx_st_long;
-typedef struct { char c; float x; } __Pyx_st_float;
-typedef struct { char c; double x; } __Pyx_st_double;
-typedef struct { char c; long double x; } __Pyx_st_longdouble;
-typedef struct { char c; void *x; } __Pyx_st_void_p;
-#ifdef HAVE_LONG_LONG
-typedef struct { char c; PY_LONG_LONG x; } __Pyx_st_longlong;
-#endif
-static size_t __Pyx_BufFmt_TypeCharToAlignment(char ch, int is_complex) {
-  CYTHON_UNUSED_VAR(is_complex);
-  switch (ch) {
-    case '?': case 'c': case 'b': case 'B': case 's': case 'p': return 1;
-    case 'h': case 'H': return sizeof(__Pyx_st_short) - sizeof(short);
-    case 'i': case 'I': return sizeof(__Pyx_st_int) - sizeof(int);
-    case 'l': case 'L': return sizeof(__Pyx_st_long) - sizeof(long);
-#ifdef HAVE_LONG_LONG
-    case 'q': case 'Q': return sizeof(__Pyx_st_longlong) - sizeof(PY_LONG_LONG);
-#endif
-    case 'f': return sizeof(__Pyx_st_float) - sizeof(float);
-    case 'd': return sizeof(__Pyx_st_double) - sizeof(double);
-    case 'g': return sizeof(__Pyx_st_longdouble) - sizeof(long double);
-    case 'P': case 'O': return sizeof(__Pyx_st_void_p) - sizeof(void*);
-    default:
-      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
-      return 0;
-    }
-}
-/* These are for computing the padding at the end of the struct to align
-   on the first member of the struct. This will probably the same as above,
-   but we don't have any guarantees.
- */
-typedef struct { short x; char c; } __Pyx_pad_short;
-typedef struct { int x; char c; } __Pyx_pad_int;
-typedef struct { long x; char c; } __Pyx_pad_long;
-typedef struct { float x; char c; } __Pyx_pad_float;
-typedef struct { double x; char c; } __Pyx_pad_double;
-typedef struct { long double x; char c; } __Pyx_pad_longdouble;
-typedef struct { void *x; char c; } __Pyx_pad_void_p;
-#ifdef HAVE_LONG_LONG
-typedef struct { PY_LONG_LONG x; char c; } __Pyx_pad_longlong;
-#endif
-static size_t __Pyx_BufFmt_TypeCharToPadding(char ch, int is_complex) {
-  CYTHON_UNUSED_VAR(is_complex);
-  switch (ch) {
-    case '?': case 'c': case 'b': case 'B': case 's': case 'p': return 1;
-    case 'h': case 'H': return sizeof(__Pyx_pad_short) - sizeof(short);
-    case 'i': case 'I': return sizeof(__Pyx_pad_int) - sizeof(int);
-    case 'l': case 'L': return sizeof(__Pyx_pad_long) - sizeof(long);
-#ifdef HAVE_LONG_LONG
-    case 'q': case 'Q': return sizeof(__Pyx_pad_longlong) - sizeof(PY_LONG_LONG);
-#endif
-    case 'f': return sizeof(__Pyx_pad_float) - sizeof(float);
-    case 'd': return sizeof(__Pyx_pad_double) - sizeof(double);
-    case 'g': return sizeof(__Pyx_pad_longdouble) - sizeof(long double);
-    case 'P': case 'O': return sizeof(__Pyx_pad_void_p) - sizeof(void*);
-    default:
-      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
-      return 0;
-    }
-}
-static char __Pyx_BufFmt_TypeCharToGroup(char ch, int is_complex) {
-  switch (ch) {
-    case 'c':
-        return 'H';
-    case 'b': case 'h': case 'i':
-    case 'l': case 'q': case 's': case 'p':
-        return 'I';
-    case '?': case 'B': case 'H': case 'I': case 'L': case 'Q':
-        return 'U';
-    case 'f': case 'd': case 'g':
-        return (is_complex ? 'C' : 'R');
-    case 'O':
-        return 'O';
-    case 'P':
-        return 'P';
-    default: {
-      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
-      return 0;
-    }
-  }
-}
-static void __Pyx_BufFmt_RaiseExpected(__Pyx_BufFmt_Context* ctx) {
-  if (ctx->head == NULL || ctx->head->field == &ctx->root) {
-    const char* expected;
-    const char* quote;
-    if (ctx->head == NULL) {
-      expected = "end";
-      quote = "";
-    } else {
-      expected = ctx->head->field->type->name;
-      quote = "'";
-    }
-    PyErr_Format(PyExc_ValueError,
-                 "Buffer dtype mismatch, expected %s%s%s but got %s",
-                 quote, expected, quote,
-                 __Pyx_BufFmt_DescribeTypeChar(ctx->enc_type, ctx->is_complex));
-  } else {
-    __Pyx_StructField* field = ctx->head->field;
-    __Pyx_StructField* parent = (ctx->head - 1)->field;
-    PyErr_Format(PyExc_ValueError,
-                 "Buffer dtype mismatch, expected '%s' but got %s in '%s.%s'",
-                 field->type->name, __Pyx_BufFmt_DescribeTypeChar(ctx->enc_type, ctx->is_complex),
-                 parent->type->name, field->name);
-  }
-}
-static int __Pyx_BufFmt_ProcessTypeChunk(__Pyx_BufFmt_Context* ctx) {
-  char group;
-  size_t size, offset, arraysize = 1;
-  if (ctx->enc_type == 0) return 0;
-  if (ctx->head->field->type->arraysize[0]) {
-    int i, ndim = 0;
-    if (ctx->enc_type == 's' || ctx->enc_type == 'p') {
-        ctx->is_valid_array = ctx->head->field->type->ndim == 1;
-        ndim = 1;
-        if (ctx->enc_count != ctx->head->field->type->arraysize[0]) {
-            PyErr_Format(PyExc_ValueError,
-                         "Expected a dimension of size %zu, got %zu",
-                         ctx->head->field->type->arraysize[0], ctx->enc_count);
-            return -1;
-        }
-    }
-    if (!ctx->is_valid_array) {
-      PyErr_Format(PyExc_ValueError, "Expected %d dimensions, got %d",
-                   ctx->head->field->type->ndim, ndim);
-      return -1;
-    }
-    for (i = 0; i < ctx->head->field->type->ndim; i++) {
-      arraysize *= ctx->head->field->type->arraysize[i];
-    }
-    ctx->is_valid_array = 0;
-    ctx->enc_count = 1;
-  }
-  group = __Pyx_BufFmt_TypeCharToGroup(ctx->enc_type, ctx->is_complex);
-  do {
-    __Pyx_StructField* field = ctx->head->field;
-    __Pyx_TypeInfo* type = field->type;
-    if (ctx->enc_packmode == '@' || ctx->enc_packmode == '^') {
-      size = __Pyx_BufFmt_TypeCharToNativeSize(ctx->enc_type, ctx->is_complex);
-    } else {
-      size = __Pyx_BufFmt_TypeCharToStandardSize(ctx->enc_type, ctx->is_complex);
-    }
-    if (ctx->enc_packmode == '@') {
-      size_t align_at = __Pyx_BufFmt_TypeCharToAlignment(ctx->enc_type, ctx->is_complex);
-      size_t align_mod_offset;
-      if (align_at == 0) return -1;
-      align_mod_offset = ctx->fmt_offset % align_at;
-      if (align_mod_offset > 0) ctx->fmt_offset += align_at - align_mod_offset;
-      if (ctx->struct_alignment == 0)
-          ctx->struct_alignment = __Pyx_BufFmt_TypeCharToPadding(ctx->enc_type,
-                                                                 ctx->is_complex);
-    }
-    if (type->size != size || type->typegroup != group) {
-      if (type->typegroup == 'C' && type->fields != NULL) {
-        size_t parent_offset = ctx->head->parent_offset + field->offset;
-        ++ctx->head;
-        ctx->head->field = type->fields;
-        ctx->head->parent_offset = parent_offset;
-        continue;
-      }
-      if ((type->typegroup == 'H' || group == 'H') && type->size == size) {
-      } else {
-          __Pyx_BufFmt_RaiseExpected(ctx);
-          return -1;
-      }
-    }
-    offset = ctx->head->parent_offset + field->offset;
-    if (ctx->fmt_offset != offset) {
-      PyErr_Format(PyExc_ValueError,
-                   "Buffer dtype mismatch; next field is at offset %" CYTHON_FORMAT_SSIZE_T "d but %" CYTHON_FORMAT_SSIZE_T "d expected",
-                   (Py_ssize_t)ctx->fmt_offset, (Py_ssize_t)offset);
-      return -1;
-    }
-    ctx->fmt_offset += size;
-    if (arraysize)
-      ctx->fmt_offset += (arraysize - 1) * size;
-    --ctx->enc_count;
-    while (1) {
-      if (field == &ctx->root) {
-        ctx->head = NULL;
-        if (ctx->enc_count != 0) {
-          __Pyx_BufFmt_RaiseExpected(ctx);
-          return -1;
-        }
-        break;
-      }
-      ctx->head->field = ++field;
-      if (field->type == NULL) {
-        --ctx->head;
-        field = ctx->head->field;
-        continue;
-      } else if (field->type->typegroup == 'S') {
-        size_t parent_offset = ctx->head->parent_offset + field->offset;
-        if (field->type->fields->type == NULL) continue;
-        field = field->type->fields;
-        ++ctx->head;
-        ctx->head->field = field;
-        ctx->head->parent_offset = parent_offset;
-        break;
-      } else {
-        break;
-      }
-    }
-  } while (ctx->enc_count);
-  ctx->enc_type = 0;
-  ctx->is_complex = 0;
-  return 0;
-}
-static int
-__pyx_buffmt_parse_array(__Pyx_BufFmt_Context* ctx, const char** tsp)
-{
-    const char *ts = *tsp;
-    int i = 0, number, ndim;
-    ++ts;
-    if (ctx->new_count != 1) {
-        PyErr_SetString(PyExc_ValueError,
-                        "Cannot handle repeated arrays in format string");
-        return -1;
-    }
-    if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return -1;
-    ndim = ctx->head->field->type->ndim;
-    while (*ts && *ts != ')') {
-        switch (*ts) {
-            case ' ': case '\f': case '\r': case '\n': case '\t': case '\v':  continue;
-            default:  break;
-        }
-        number = __Pyx_BufFmt_ExpectNumber(&ts);
-        if (number == -1) return -1;
-        if (i < ndim && (size_t) number != ctx->head->field->type->arraysize[i]) {
-            PyErr_Format(PyExc_ValueError,
-                        "Expected a dimension of size %zu, got %d",
-                        ctx->head->field->type->arraysize[i], number);
-            return -1;
-        }
-        if (*ts != ',' && *ts != ')') {
-            PyErr_Format(PyExc_ValueError,
-                                "Expected a comma in format string, got '%c'", *ts);
-            return -1;
-        }
-        if (*ts == ',') ts++;
-        i++;
-    }
-    if (i != ndim) {
-        PyErr_Format(PyExc_ValueError, "Expected %d dimension(s), got %d",
-                            ctx->head->field->type->ndim, i);
-        return -1;
-    }
-    if (!*ts) {
-        PyErr_SetString(PyExc_ValueError,
-                        "Unexpected end of format string, expected ')'");
-        return -1;
-    }
-    ctx->is_valid_array = 1;
-    ctx->new_count = 1;
-    *tsp = ++ts;
-    return 0;
-}
-static const char* __Pyx_BufFmt_CheckString(__Pyx_BufFmt_Context* ctx, const char* ts) {
-  int got_Z = 0;
-  while (1) {
-    switch(*ts) {
-      case 0:
-        if (ctx->enc_type != 0 && ctx->head == NULL) {
-          __Pyx_BufFmt_RaiseExpected(ctx);
-          return NULL;
-        }
-        if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
-        if (ctx->head != NULL) {
-          __Pyx_BufFmt_RaiseExpected(ctx);
-          return NULL;
-        }
-        return ts;
-      case ' ':
-      case '\r':
-      case '\n':
-        ++ts;
-        break;
-      case '<':
-        if (!__Pyx_Is_Little_Endian()) {
-          PyErr_SetString(PyExc_ValueError, "Little-endian buffer not supported on big-endian compiler");
-          return NULL;
-        }
-        ctx->new_packmode = '=';
-        ++ts;
-        break;
-      case '>':
-      case '!':
-        if (__Pyx_Is_Little_Endian()) {
-          PyErr_SetString(PyExc_ValueError, "Big-endian buffer not supported on little-endian compiler");
-          return NULL;
-        }
-        ctx->new_packmode = '=';
-        ++ts;
-        break;
-      case '=':
-      case '@':
-      case '^':
-        ctx->new_packmode = *ts++;
-        break;
-      case 'T':
-        {
-          const char* ts_after_sub;
-          size_t i, struct_count = ctx->new_count;
-          size_t struct_alignment = ctx->struct_alignment;
-          ctx->new_count = 1;
-          ++ts;
-          if (*ts != '{') {
-            PyErr_SetString(PyExc_ValueError, "Buffer acquisition: Expected '{' after 'T'");
-            return NULL;
-          }
-          if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
-          ctx->enc_type = 0;
-          ctx->enc_count = 0;
-          ctx->struct_alignment = 0;
-          ++ts;
-          ts_after_sub = ts;
-          for (i = 0; i != struct_count; ++i) {
-            ts_after_sub = __Pyx_BufFmt_CheckString(ctx, ts);
-            if (!ts_after_sub) return NULL;
-          }
-          ts = ts_after_sub;
-          if (struct_alignment) ctx->struct_alignment = struct_alignment;
-        }
-        break;
-      case '}':
-        {
-          size_t alignment = ctx->struct_alignment;
-          ++ts;
-          if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
-          ctx->enc_type = 0;
-          if (alignment && ctx->fmt_offset % alignment) {
-            ctx->fmt_offset += alignment - (ctx->fmt_offset % alignment);
-          }
-        }
-        return ts;
-      case 'x':
-        if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
-        ctx->fmt_offset += ctx->new_count;
-        ctx->new_count = 1;
-        ctx->enc_count = 0;
-        ctx->enc_type = 0;
-        ctx->enc_packmode = ctx->new_packmode;
-        ++ts;
-        break;
-      case 'Z':
-        got_Z = 1;
-        ++ts;
-        if (*ts != 'f' && *ts != 'd' && *ts != 'g') {
-          __Pyx_BufFmt_RaiseUnexpectedChar('Z');
-          return NULL;
-        }
-        CYTHON_FALLTHROUGH;
-      case '?': case 'c': case 'b': case 'B': case 'h': case 'H': case 'i': case 'I':
-      case 'l': case 'L': case 'q': case 'Q':
-      case 'f': case 'd': case 'g':
-      case 'O': case 'p':
-        if ((ctx->enc_type == *ts) && (got_Z == ctx->is_complex) &&
-            (ctx->enc_packmode == ctx->new_packmode) && (!ctx->is_valid_array)) {
-          ctx->enc_count += ctx->new_count;
-          ctx->new_count = 1;
-          got_Z = 0;
-          ++ts;
-          break;
-        }
-        CYTHON_FALLTHROUGH;
-      case 's':
-        if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
-        ctx->enc_count = ctx->new_count;
-        ctx->enc_packmode = ctx->new_packmode;
-        ctx->enc_type = *ts;
-        ctx->is_complex = got_Z;
-        ++ts;
-        ctx->new_count = 1;
-        got_Z = 0;
-        break;
-      case ':':
-        ++ts;
-        while(*ts != ':') ++ts;
-        ++ts;
-        break;
-      case '(':
-        if (__pyx_buffmt_parse_array(ctx, &ts) < 0) return NULL;
-        break;
-      default:
-        {
-          int number = __Pyx_BufFmt_ExpectNumber(&ts);
-          if (number == -1) return NULL;
-          ctx->new_count = (size_t)number;
-        }
-    }
-  }
-}
-
-/* BufferGetAndValidate */
-  static CYTHON_INLINE void __Pyx_SafeReleaseBuffer(Py_buffer* info) {
-  if (unlikely(info->buf == NULL)) return;
-  if (info->suboffsets == __Pyx_minusones) info->suboffsets = NULL;
-  __Pyx_ReleaseBuffer(info);
-}
-static void __Pyx_ZeroBuffer(Py_buffer* buf) {
-  buf->buf = NULL;
-  buf->obj = NULL;
-  buf->strides = __Pyx_zeros;
-  buf->shape = __Pyx_zeros;
-  buf->suboffsets = __Pyx_minusones;
-}
-static int __Pyx__GetBufferAndValidate(
-        Py_buffer* buf, PyObject* obj,  __Pyx_TypeInfo* dtype, int flags,
-        int nd, int cast, __Pyx_BufFmt_StackElem* stack)
-{
-  buf->buf = NULL;
-  if (unlikely(__Pyx_GetBuffer(obj, buf, flags) == -1)) {
-    __Pyx_ZeroBuffer(buf);
-    return -1;
-  }
-  if (unlikely(buf->ndim != nd)) {
-    PyErr_Format(PyExc_ValueError,
-                 "Buffer has wrong number of dimensions (expected %d, got %d)",
-                 nd, buf->ndim);
-    goto fail;
-  }
-  if (!cast) {
-    __Pyx_BufFmt_Context ctx;
-    __Pyx_BufFmt_Init(&ctx, stack, dtype);
-    if (!__Pyx_BufFmt_CheckString(&ctx, buf->format)) goto fail;
-  }
-  if (unlikely((size_t)buf->itemsize != dtype->size)) {
-    PyErr_Format(PyExc_ValueError,
-      "Item size of buffer (%" CYTHON_FORMAT_SSIZE_T "d byte%s) does not match size of '%s' (%" CYTHON_FORMAT_SSIZE_T "d byte%s)",
-      buf->itemsize, (buf->itemsize > 1) ? "s" : "",
-      dtype->name, (Py_ssize_t)dtype->size, (dtype->size > 1) ? "s" : "");
-    goto fail;
-  }
-  if (buf->suboffsets == NULL) buf->suboffsets = __Pyx_minusones;
-  return 0;
-fail:;
-  __Pyx_SafeReleaseBuffer(buf);
-  return -1;
-}
-
 /* PyObject_GenericGetAttrNoDict */
-  #if CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP && PY_VERSION_HEX < 0x03070000
+#if CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP && PY_VERSION_HEX < 0x03070000
 static PyObject *__Pyx_RaiseGenericGetAttributeError(PyTypeObject *tp, PyObject *attr_name) {
     __Pyx_TypeName type_name = __Pyx_PyType_GetName(tp);
     PyErr_Format(PyExc_AttributeError,
 #if PY_MAJOR_VERSION >= 3
                  "'" __Pyx_FMT_TYPENAME "' object has no attribute '%U'",
                  type_name, attr_name);
 #else
@@ -27072,25 +26662,25 @@
         }
     }
     return descr;
 }
 #endif
 
 /* PyObject_GenericGetAttr */
-  #if CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP && PY_VERSION_HEX < 0x03070000
+#if CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP && PY_VERSION_HEX < 0x03070000
 static PyObject* __Pyx_PyObject_GenericGetAttr(PyObject* obj, PyObject* attr_name) {
     if (unlikely(Py_TYPE(obj)->tp_dictoffset)) {
         return PyObject_GenericGetAttr(obj, attr_name);
     }
     return __Pyx_PyObject_GenericGetAttrNoDict(obj, attr_name);
 }
 #endif
 
 /* FixUpExtensionType */
-  #if CYTHON_USE_TYPE_SPECS
+#if CYTHON_USE_TYPE_SPECS
 static int __Pyx_fix_up_extension_type_from_spec(PyType_Spec *spec, PyTypeObject *type) {
 #if PY_VERSION_HEX > 0x030900B1 || CYTHON_COMPILING_IN_LIMITED_API
     CYTHON_UNUSED_VAR(spec);
     CYTHON_UNUSED_VAR(type);
 #else
     const PyType_Slot *slot = spec->slots;
     while (slot && slot->slot && slot->slot != Py_tp_members)
@@ -27155,21 +26745,21 @@
     }
 #endif
     return 0;
 }
 #endif
 
 /* PyObjectCallNoArg */
-  static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func) {
+static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func) {
     PyObject *arg[2] = {NULL, NULL};
     return __Pyx_PyObject_FastCall(func, arg + 1, 0 | __Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET);
 }
 
 /* PyObjectGetMethod */
-  static int __Pyx_PyObject_GetMethod(PyObject *obj, PyObject *name, PyObject **method) {
+static int __Pyx_PyObject_GetMethod(PyObject *obj, PyObject *name, PyObject **method) {
     PyObject *attr;
 #if CYTHON_UNPACK_METHODS && CYTHON_COMPILING_IN_CPYTHON && CYTHON_USE_PYTYPE_LOOKUP
     __Pyx_TypeName type_name;
     PyTypeObject *tp = Py_TYPE(obj);
     PyObject *descr;
     descrgetfunc f = NULL;
     PyObject **dictptr, *dict;
@@ -27262,15 +26852,15 @@
     }
 #endif
     *method = attr;
     return 0;
 }
 
 /* PyObjectCallMethod0 */
-  static PyObject* __Pyx_PyObject_CallMethod0(PyObject* obj, PyObject* method_name) {
+static PyObject* __Pyx_PyObject_CallMethod0(PyObject* obj, PyObject* method_name) {
     PyObject *method = NULL, *result = NULL;
     int is_method = __Pyx_PyObject_GetMethod(obj, method_name, &method);
     if (likely(is_method)) {
         result = __Pyx_PyObject_CallOneArg(method, obj);
         Py_DECREF(method);
         return result;
     }
@@ -27278,15 +26868,15 @@
     result = __Pyx_PyObject_CallNoArg(method);
     Py_DECREF(method);
 bad:
     return result;
 }
 
 /* ValidateBasesTuple */
-  #if CYTHON_COMPILING_IN_CPYTHON || CYTHON_COMPILING_IN_LIMITED_API || CYTHON_USE_TYPE_SPECS
+#if CYTHON_COMPILING_IN_CPYTHON || CYTHON_COMPILING_IN_LIMITED_API || CYTHON_USE_TYPE_SPECS
 static int __Pyx_validate_bases_tuple(const char *type_name, Py_ssize_t dictoffset, PyObject *bases) {
     Py_ssize_t i, n;
 #if CYTHON_ASSUME_SAFE_MACROS
     n = PyTuple_GET_SIZE(bases);
 #else
     n = PyTuple_Size(bases);
     if (n < 0) return -1;
@@ -27363,15 +26953,15 @@
 #endif
     }
     return 0;
 }
 #endif
 
 /* PyType_Ready */
-  static int __Pyx_PyType_Ready(PyTypeObject *t) {
+static int __Pyx_PyType_Ready(PyTypeObject *t) {
 #if CYTHON_USE_TYPE_SPECS || !(CYTHON_COMPILING_IN_CPYTHON || CYTHON_COMPILING_IN_LIMITED_API) || defined(PYSTON_MAJOR_VERSION)
     (void)__Pyx_PyObject_CallMethod0;
 #if CYTHON_USE_TYPE_SPECS
     (void)__Pyx_validate_bases_tuple;
 #endif
     return PyType_Ready(t);
 #else
@@ -27445,15 +27035,15 @@
     }
 #endif
     return r;
 #endif
 }
 
 /* SetVTable */
-  static int __Pyx_SetVtable(PyTypeObject *type, void *vtable) {
+static int __Pyx_SetVtable(PyTypeObject *type, void *vtable) {
     PyObject *ob = PyCapsule_New(vtable, 0, 0);
     if (unlikely(!ob))
         goto bad;
 #if CYTHON_COMPILING_IN_LIMITED_API
     if (unlikely(PyObject_SetAttr((PyObject *) type, __pyx_n_s_pyx_vtable, ob) < 0))
 #else
     if (unlikely(PyDict_SetItem(type->tp_dict, __pyx_n_s_pyx_vtable, ob) < 0))
@@ -27463,15 +27053,15 @@
     return 0;
 bad:
     Py_XDECREF(ob);
     return -1;
 }
 
 /* GetVTable */
-  static void* __Pyx_GetVtable(PyTypeObject *type) {
+static void* __Pyx_GetVtable(PyTypeObject *type) {
     void* ptr;
 #if CYTHON_COMPILING_IN_LIMITED_API
     PyObject *ob = PyObject_GetAttr((PyObject *)type, __pyx_n_s_pyx_vtable);
 #else
     PyObject *ob = PyObject_GetItem(type->tp_dict, __pyx_n_s_pyx_vtable);
 #endif
     if (!ob)
@@ -27483,15 +27073,15 @@
     return ptr;
 bad:
     Py_XDECREF(ob);
     return NULL;
 }
 
 /* MergeVTables */
-  #if !CYTHON_COMPILING_IN_LIMITED_API
+#if !CYTHON_COMPILING_IN_LIMITED_API
 static int __Pyx_MergeVtables(PyTypeObject *type) {
     int i;
     void** base_vtables;
     __Pyx_TypeName tp_base_name;
     __Pyx_TypeName base_name;
     void* unknown = (void*)-1;
     PyObject* bases = type->tp_bases;
@@ -27536,15 +27126,15 @@
     __Pyx_DECREF_TypeName(base_name);
     free(base_vtables);
     return -1;
 }
 #endif
 
 /* SetupReduce */
-  #if !CYTHON_COMPILING_IN_LIMITED_API
+#if !CYTHON_COMPILING_IN_LIMITED_API
 static int __Pyx_setup_reduce_is_named(PyObject* meth, PyObject* name) {
   int ret;
   PyObject *name_attr;
   name_attr = __Pyx_PyObject_GetAttrStrNoError(meth, __pyx_n_s_name_2);
   if (likely(name_attr)) {
       ret = PyObject_RichCompareBool(name_attr, name, Py_EQ);
   } else {
@@ -27647,15 +27237,15 @@
     Py_XDECREF(setstate);
     Py_XDECREF(setstate_cython);
     return ret;
 }
 #endif
 
 /* TypeImport */
-  #ifndef __PYX_HAVE_RT_ImportType_3_0_5
+#ifndef __PYX_HAVE_RT_ImportType_3_0_5
 #define __PYX_HAVE_RT_ImportType_3_0_5
 static PyTypeObject *__Pyx_ImportType_3_0_5(PyObject *module, const char *module_name, const char *class_name,
     size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_5 check_size)
 {
     PyObject *result = 0;
     char warning[200];
     Py_ssize_t basicsize;
@@ -27727,20 +27317,20 @@
 bad:
     Py_XDECREF(result);
     return NULL;
 }
 #endif
 
 /* FetchSharedCythonModule */
-  static PyObject *__Pyx_FetchSharedCythonABIModule(void) {
+static PyObject *__Pyx_FetchSharedCythonABIModule(void) {
     return __Pyx_PyImport_AddModuleRef((char*) __PYX_ABI_MODULE_NAME);
 }
 
 /* FetchCommonType */
-  static int __Pyx_VerifyCachedType(PyObject *cached_type,
+static int __Pyx_VerifyCachedType(PyObject *cached_type,
                                const char *name,
                                Py_ssize_t basicsize,
                                Py_ssize_t expected_basicsize) {
     if (!PyType_Check(cached_type)) {
         PyErr_Format(PyExc_TypeError,
             "Shared Cython type %.200s is not a type object", name);
         return -1;
@@ -27833,15 +27423,15 @@
     Py_XDECREF(cached_type);
     cached_type = NULL;
     goto done;
 }
 #endif
 
 /* PyVectorcallFastCallDict */
-  #if CYTHON_METH_FASTCALL
+#if CYTHON_METH_FASTCALL
 static PyObject *__Pyx_PyVectorcall_FastCallDict_kw(PyObject *func, __pyx_vectorcallfunc vc, PyObject *const *args, size_t nargs, PyObject *kw)
 {
     PyObject *res = NULL;
     PyObject *kwnames;
     PyObject **newargs;
     PyObject **kwvalues;
     Py_ssize_t i, pos;
@@ -27889,15 +27479,15 @@
         return vc(func, args, nargs, NULL);
     }
     return __Pyx_PyVectorcall_FastCallDict_kw(func, vc, args, nargs, kw);
 }
 #endif
 
 /* CythonFunctionShared */
-  #if CYTHON_COMPILING_IN_LIMITED_API
+#if CYTHON_COMPILING_IN_LIMITED_API
 static CYTHON_INLINE int __Pyx__IsSameCyOrCFunction(PyObject *func, void *cfunc) {
     if (__Pyx_CyFunction_Check(func)) {
         return PyCFunction_GetFunction(((__pyx_CyFunctionObject*)func)->func) == (PyCFunction) cfunc;
     } else if (PyCFunction_Check(func)) {
         return PyCFunction_GetFunction(func) == (PyCFunction) cfunc;
     }
     return 0;
@@ -28891,28 +28481,28 @@
 static CYTHON_INLINE void __Pyx_CyFunction_SetAnnotationsDict(PyObject *func, PyObject *dict) {
     __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
     m->func_annotations = dict;
     Py_INCREF(dict);
 }
 
 /* CythonFunction */
-  static PyObject *__Pyx_CyFunction_New(PyMethodDef *ml, int flags, PyObject* qualname,
+static PyObject *__Pyx_CyFunction_New(PyMethodDef *ml, int flags, PyObject* qualname,
                                       PyObject *closure, PyObject *module, PyObject* globals, PyObject* code) {
     PyObject *op = __Pyx_CyFunction_Init(
         PyObject_GC_New(__pyx_CyFunctionObject, __pyx_CyFunctionType),
         ml, flags, qualname, closure, module, globals, code
     );
     if (likely(op)) {
         PyObject_GC_Track(op);
     }
     return op;
 }
 
 /* CLineInTraceback */
-  #ifndef CYTHON_CLINE_IN_TRACEBACK
+#ifndef CYTHON_CLINE_IN_TRACEBACK
 static int __Pyx_CLineForTraceback(PyThreadState *tstate, int c_line) {
     PyObject *use_cline;
     PyObject *ptype, *pvalue, *ptraceback;
 #if CYTHON_COMPILING_IN_CPYTHON
     PyObject **cython_runtime_dict;
 #endif
     CYTHON_MAYBE_UNUSED_VAR(tstate);
@@ -28947,15 +28537,15 @@
     }
     __Pyx_ErrRestoreInState(tstate, ptype, pvalue, ptraceback);
     return c_line;
 }
 #endif
 
 /* CodeObjectCache */
-  #if !CYTHON_COMPILING_IN_LIMITED_API
+#if !CYTHON_COMPILING_IN_LIMITED_API
 static int __pyx_bisect_code_objects(__Pyx_CodeObjectCacheEntry* entries, int count, int code_line) {
     int start = 0, mid = 0, end = count - 1;
     if (end >= 0 && code_line > entries[end].code_line) {
         return count;
     }
     while (start < end) {
         mid = start + (end - start) / 2;
@@ -29029,15 +28619,15 @@
     entries[pos].code_object = code_object;
     __pyx_code_cache.count++;
     Py_INCREF(code_object);
 }
 #endif
 
 /* AddTraceback */
-  #include "compile.h"
+#include "compile.h"
 #include "frameobject.h"
 #include "traceback.h"
 #if PY_VERSION_HEX >= 0x030b00a6 && !CYTHON_COMPILING_IN_LIMITED_API
   #ifndef Py_BUILD_CORE
     #define Py_BUILD_CORE 1
   #endif
   #include "internal/pycore_frame.h"
@@ -29247,16 +28837,16 @@
     if ((0)) {}
     view->obj = NULL;
     Py_DECREF(obj);
 }
 #endif
 
 
-  /* MemviewSliceIsContig */
-  static int
+/* MemviewSliceIsContig */
+static int
 __pyx_memviewslice_is_contig(const __Pyx_memviewslice mvs, char order, int ndim)
 {
     int i, index, step, start;
     Py_ssize_t itemsize = mvs.memview->view.itemsize;
     if (order == 'F') {
         step = 1;
         start = 0;
@@ -29270,15 +28860,15 @@
             return 0;
         itemsize *= mvs.shape[index];
     }
     return 1;
 }
 
 /* OverlappingSlices */
-  static void
+static void
 __pyx_get_array_memory_extents(__Pyx_memviewslice *slice,
                                void **out_start, void **out_end,
                                int ndim, size_t itemsize)
 {
     char *start, *end;
     int i;
     start = end = slice->data;
@@ -29305,35 +28895,534 @@
 {
     void *start1, *end1, *start2, *end2;
     __pyx_get_array_memory_extents(slice1, &start1, &end1, ndim, itemsize);
     __pyx_get_array_memory_extents(slice2, &start2, &end2, ndim, itemsize);
     return (start1 < end2) && (start2 < end1);
 }
 
-/* CIntFromPyVerify */
-  #define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)\
-    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 0)
-#define __PYX_VERIFY_RETURN_INT_EXC(target_type, func_type, func_value)\
-    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 1)
-#define __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, exc)\
-    {\
-        func_type value = func_value;\
-        if (sizeof(target_type) < sizeof(func_type)) {\
-            if (unlikely(value != (func_type) (target_type) value)) {\
-                func_type zero = 0;\
-                if (exc && unlikely(value == (func_type)-1 && PyErr_Occurred()))\
-                    return (target_type) -1;\
-                if (is_unsigned && unlikely(value < zero))\
-                    goto raise_neg_overflow;\
-                else\
-                    goto raise_overflow;\
-            }\
-        }\
-        return (target_type) value;\
+/* IsLittleEndian */
+static CYTHON_INLINE int __Pyx_Is_Little_Endian(void)
+{
+  union {
+    uint32_t u32;
+    uint8_t u8[4];
+  } S;
+  S.u32 = 0x01020304;
+  return S.u8[0] == 4;
+}
+
+/* BufferFormatCheck */
+static void __Pyx_BufFmt_Init(__Pyx_BufFmt_Context* ctx,
+                              __Pyx_BufFmt_StackElem* stack,
+                              __Pyx_TypeInfo* type) {
+  stack[0].field = &ctx->root;
+  stack[0].parent_offset = 0;
+  ctx->root.type = type;
+  ctx->root.name = "buffer dtype";
+  ctx->root.offset = 0;
+  ctx->head = stack;
+  ctx->head->field = &ctx->root;
+  ctx->fmt_offset = 0;
+  ctx->head->parent_offset = 0;
+  ctx->new_packmode = '@';
+  ctx->enc_packmode = '@';
+  ctx->new_count = 1;
+  ctx->enc_count = 0;
+  ctx->enc_type = 0;
+  ctx->is_complex = 0;
+  ctx->is_valid_array = 0;
+  ctx->struct_alignment = 0;
+  while (type->typegroup == 'S') {
+    ++ctx->head;
+    ctx->head->field = type->fields;
+    ctx->head->parent_offset = 0;
+    type = type->fields->type;
+  }
+}
+static int __Pyx_BufFmt_ParseNumber(const char** ts) {
+    int count;
+    const char* t = *ts;
+    if (*t < '0' || *t > '9') {
+      return -1;
+    } else {
+        count = *t++ - '0';
+        while (*t >= '0' && *t <= '9') {
+            count *= 10;
+            count += *t++ - '0';
+        }
     }
+    *ts = t;
+    return count;
+}
+static int __Pyx_BufFmt_ExpectNumber(const char **ts) {
+    int number = __Pyx_BufFmt_ParseNumber(ts);
+    if (number == -1)
+        PyErr_Format(PyExc_ValueError,\
+                     "Does not understand character buffer dtype format string ('%c')", **ts);
+    return number;
+}
+static void __Pyx_BufFmt_RaiseUnexpectedChar(char ch) {
+  PyErr_Format(PyExc_ValueError,
+               "Unexpected format string character: '%c'", ch);
+}
+static const char* __Pyx_BufFmt_DescribeTypeChar(char ch, int is_complex) {
+  switch (ch) {
+    case '?': return "'bool'";
+    case 'c': return "'char'";
+    case 'b': return "'signed char'";
+    case 'B': return "'unsigned char'";
+    case 'h': return "'short'";
+    case 'H': return "'unsigned short'";
+    case 'i': return "'int'";
+    case 'I': return "'unsigned int'";
+    case 'l': return "'long'";
+    case 'L': return "'unsigned long'";
+    case 'q': return "'long long'";
+    case 'Q': return "'unsigned long long'";
+    case 'f': return (is_complex ? "'complex float'" : "'float'");
+    case 'd': return (is_complex ? "'complex double'" : "'double'");
+    case 'g': return (is_complex ? "'complex long double'" : "'long double'");
+    case 'T': return "a struct";
+    case 'O': return "Python object";
+    case 'P': return "a pointer";
+    case 's': case 'p': return "a string";
+    case 0: return "end";
+    default: return "unparsable format string";
+  }
+}
+static size_t __Pyx_BufFmt_TypeCharToStandardSize(char ch, int is_complex) {
+  switch (ch) {
+    case '?': case 'c': case 'b': case 'B': case 's': case 'p': return 1;
+    case 'h': case 'H': return 2;
+    case 'i': case 'I': case 'l': case 'L': return 4;
+    case 'q': case 'Q': return 8;
+    case 'f': return (is_complex ? 8 : 4);
+    case 'd': return (is_complex ? 16 : 8);
+    case 'g': {
+      PyErr_SetString(PyExc_ValueError, "Python does not define a standard format string size for long double ('g')..");
+      return 0;
+    }
+    case 'O': case 'P': return sizeof(void*);
+    default:
+      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
+      return 0;
+    }
+}
+static size_t __Pyx_BufFmt_TypeCharToNativeSize(char ch, int is_complex) {
+  switch (ch) {
+    case '?': case 'c': case 'b': case 'B': case 's': case 'p': return 1;
+    case 'h': case 'H': return sizeof(short);
+    case 'i': case 'I': return sizeof(int);
+    case 'l': case 'L': return sizeof(long);
+    #ifdef HAVE_LONG_LONG
+    case 'q': case 'Q': return sizeof(PY_LONG_LONG);
+    #endif
+    case 'f': return sizeof(float) * (is_complex ? 2 : 1);
+    case 'd': return sizeof(double) * (is_complex ? 2 : 1);
+    case 'g': return sizeof(long double) * (is_complex ? 2 : 1);
+    case 'O': case 'P': return sizeof(void*);
+    default: {
+      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
+      return 0;
+    }
+  }
+}
+typedef struct { char c; short x; } __Pyx_st_short;
+typedef struct { char c; int x; } __Pyx_st_int;
+typedef struct { char c; long x; } __Pyx_st_long;
+typedef struct { char c; float x; } __Pyx_st_float;
+typedef struct { char c; double x; } __Pyx_st_double;
+typedef struct { char c; long double x; } __Pyx_st_longdouble;
+typedef struct { char c; void *x; } __Pyx_st_void_p;
+#ifdef HAVE_LONG_LONG
+typedef struct { char c; PY_LONG_LONG x; } __Pyx_st_longlong;
+#endif
+static size_t __Pyx_BufFmt_TypeCharToAlignment(char ch, int is_complex) {
+  CYTHON_UNUSED_VAR(is_complex);
+  switch (ch) {
+    case '?': case 'c': case 'b': case 'B': case 's': case 'p': return 1;
+    case 'h': case 'H': return sizeof(__Pyx_st_short) - sizeof(short);
+    case 'i': case 'I': return sizeof(__Pyx_st_int) - sizeof(int);
+    case 'l': case 'L': return sizeof(__Pyx_st_long) - sizeof(long);
+#ifdef HAVE_LONG_LONG
+    case 'q': case 'Q': return sizeof(__Pyx_st_longlong) - sizeof(PY_LONG_LONG);
+#endif
+    case 'f': return sizeof(__Pyx_st_float) - sizeof(float);
+    case 'd': return sizeof(__Pyx_st_double) - sizeof(double);
+    case 'g': return sizeof(__Pyx_st_longdouble) - sizeof(long double);
+    case 'P': case 'O': return sizeof(__Pyx_st_void_p) - sizeof(void*);
+    default:
+      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
+      return 0;
+    }
+}
+/* These are for computing the padding at the end of the struct to align
+   on the first member of the struct. This will probably the same as above,
+   but we don't have any guarantees.
+ */
+typedef struct { short x; char c; } __Pyx_pad_short;
+typedef struct { int x; char c; } __Pyx_pad_int;
+typedef struct { long x; char c; } __Pyx_pad_long;
+typedef struct { float x; char c; } __Pyx_pad_float;
+typedef struct { double x; char c; } __Pyx_pad_double;
+typedef struct { long double x; char c; } __Pyx_pad_longdouble;
+typedef struct { void *x; char c; } __Pyx_pad_void_p;
+#ifdef HAVE_LONG_LONG
+typedef struct { PY_LONG_LONG x; char c; } __Pyx_pad_longlong;
+#endif
+static size_t __Pyx_BufFmt_TypeCharToPadding(char ch, int is_complex) {
+  CYTHON_UNUSED_VAR(is_complex);
+  switch (ch) {
+    case '?': case 'c': case 'b': case 'B': case 's': case 'p': return 1;
+    case 'h': case 'H': return sizeof(__Pyx_pad_short) - sizeof(short);
+    case 'i': case 'I': return sizeof(__Pyx_pad_int) - sizeof(int);
+    case 'l': case 'L': return sizeof(__Pyx_pad_long) - sizeof(long);
+#ifdef HAVE_LONG_LONG
+    case 'q': case 'Q': return sizeof(__Pyx_pad_longlong) - sizeof(PY_LONG_LONG);
+#endif
+    case 'f': return sizeof(__Pyx_pad_float) - sizeof(float);
+    case 'd': return sizeof(__Pyx_pad_double) - sizeof(double);
+    case 'g': return sizeof(__Pyx_pad_longdouble) - sizeof(long double);
+    case 'P': case 'O': return sizeof(__Pyx_pad_void_p) - sizeof(void*);
+    default:
+      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
+      return 0;
+    }
+}
+static char __Pyx_BufFmt_TypeCharToGroup(char ch, int is_complex) {
+  switch (ch) {
+    case 'c':
+        return 'H';
+    case 'b': case 'h': case 'i':
+    case 'l': case 'q': case 's': case 'p':
+        return 'I';
+    case '?': case 'B': case 'H': case 'I': case 'L': case 'Q':
+        return 'U';
+    case 'f': case 'd': case 'g':
+        return (is_complex ? 'C' : 'R');
+    case 'O':
+        return 'O';
+    case 'P':
+        return 'P';
+    default: {
+      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
+      return 0;
+    }
+  }
+}
+static void __Pyx_BufFmt_RaiseExpected(__Pyx_BufFmt_Context* ctx) {
+  if (ctx->head == NULL || ctx->head->field == &ctx->root) {
+    const char* expected;
+    const char* quote;
+    if (ctx->head == NULL) {
+      expected = "end";
+      quote = "";
+    } else {
+      expected = ctx->head->field->type->name;
+      quote = "'";
+    }
+    PyErr_Format(PyExc_ValueError,
+                 "Buffer dtype mismatch, expected %s%s%s but got %s",
+                 quote, expected, quote,
+                 __Pyx_BufFmt_DescribeTypeChar(ctx->enc_type, ctx->is_complex));
+  } else {
+    __Pyx_StructField* field = ctx->head->field;
+    __Pyx_StructField* parent = (ctx->head - 1)->field;
+    PyErr_Format(PyExc_ValueError,
+                 "Buffer dtype mismatch, expected '%s' but got %s in '%s.%s'",
+                 field->type->name, __Pyx_BufFmt_DescribeTypeChar(ctx->enc_type, ctx->is_complex),
+                 parent->type->name, field->name);
+  }
+}
+static int __Pyx_BufFmt_ProcessTypeChunk(__Pyx_BufFmt_Context* ctx) {
+  char group;
+  size_t size, offset, arraysize = 1;
+  if (ctx->enc_type == 0) return 0;
+  if (ctx->head->field->type->arraysize[0]) {
+    int i, ndim = 0;
+    if (ctx->enc_type == 's' || ctx->enc_type == 'p') {
+        ctx->is_valid_array = ctx->head->field->type->ndim == 1;
+        ndim = 1;
+        if (ctx->enc_count != ctx->head->field->type->arraysize[0]) {
+            PyErr_Format(PyExc_ValueError,
+                         "Expected a dimension of size %zu, got %zu",
+                         ctx->head->field->type->arraysize[0], ctx->enc_count);
+            return -1;
+        }
+    }
+    if (!ctx->is_valid_array) {
+      PyErr_Format(PyExc_ValueError, "Expected %d dimensions, got %d",
+                   ctx->head->field->type->ndim, ndim);
+      return -1;
+    }
+    for (i = 0; i < ctx->head->field->type->ndim; i++) {
+      arraysize *= ctx->head->field->type->arraysize[i];
+    }
+    ctx->is_valid_array = 0;
+    ctx->enc_count = 1;
+  }
+  group = __Pyx_BufFmt_TypeCharToGroup(ctx->enc_type, ctx->is_complex);
+  do {
+    __Pyx_StructField* field = ctx->head->field;
+    __Pyx_TypeInfo* type = field->type;
+    if (ctx->enc_packmode == '@' || ctx->enc_packmode == '^') {
+      size = __Pyx_BufFmt_TypeCharToNativeSize(ctx->enc_type, ctx->is_complex);
+    } else {
+      size = __Pyx_BufFmt_TypeCharToStandardSize(ctx->enc_type, ctx->is_complex);
+    }
+    if (ctx->enc_packmode == '@') {
+      size_t align_at = __Pyx_BufFmt_TypeCharToAlignment(ctx->enc_type, ctx->is_complex);
+      size_t align_mod_offset;
+      if (align_at == 0) return -1;
+      align_mod_offset = ctx->fmt_offset % align_at;
+      if (align_mod_offset > 0) ctx->fmt_offset += align_at - align_mod_offset;
+      if (ctx->struct_alignment == 0)
+          ctx->struct_alignment = __Pyx_BufFmt_TypeCharToPadding(ctx->enc_type,
+                                                                 ctx->is_complex);
+    }
+    if (type->size != size || type->typegroup != group) {
+      if (type->typegroup == 'C' && type->fields != NULL) {
+        size_t parent_offset = ctx->head->parent_offset + field->offset;
+        ++ctx->head;
+        ctx->head->field = type->fields;
+        ctx->head->parent_offset = parent_offset;
+        continue;
+      }
+      if ((type->typegroup == 'H' || group == 'H') && type->size == size) {
+      } else {
+          __Pyx_BufFmt_RaiseExpected(ctx);
+          return -1;
+      }
+    }
+    offset = ctx->head->parent_offset + field->offset;
+    if (ctx->fmt_offset != offset) {
+      PyErr_Format(PyExc_ValueError,
+                   "Buffer dtype mismatch; next field is at offset %" CYTHON_FORMAT_SSIZE_T "d but %" CYTHON_FORMAT_SSIZE_T "d expected",
+                   (Py_ssize_t)ctx->fmt_offset, (Py_ssize_t)offset);
+      return -1;
+    }
+    ctx->fmt_offset += size;
+    if (arraysize)
+      ctx->fmt_offset += (arraysize - 1) * size;
+    --ctx->enc_count;
+    while (1) {
+      if (field == &ctx->root) {
+        ctx->head = NULL;
+        if (ctx->enc_count != 0) {
+          __Pyx_BufFmt_RaiseExpected(ctx);
+          return -1;
+        }
+        break;
+      }
+      ctx->head->field = ++field;
+      if (field->type == NULL) {
+        --ctx->head;
+        field = ctx->head->field;
+        continue;
+      } else if (field->type->typegroup == 'S') {
+        size_t parent_offset = ctx->head->parent_offset + field->offset;
+        if (field->type->fields->type == NULL) continue;
+        field = field->type->fields;
+        ++ctx->head;
+        ctx->head->field = field;
+        ctx->head->parent_offset = parent_offset;
+        break;
+      } else {
+        break;
+      }
+    }
+  } while (ctx->enc_count);
+  ctx->enc_type = 0;
+  ctx->is_complex = 0;
+  return 0;
+}
+static int
+__pyx_buffmt_parse_array(__Pyx_BufFmt_Context* ctx, const char** tsp)
+{
+    const char *ts = *tsp;
+    int i = 0, number, ndim;
+    ++ts;
+    if (ctx->new_count != 1) {
+        PyErr_SetString(PyExc_ValueError,
+                        "Cannot handle repeated arrays in format string");
+        return -1;
+    }
+    if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return -1;
+    ndim = ctx->head->field->type->ndim;
+    while (*ts && *ts != ')') {
+        switch (*ts) {
+            case ' ': case '\f': case '\r': case '\n': case '\t': case '\v':  continue;
+            default:  break;
+        }
+        number = __Pyx_BufFmt_ExpectNumber(&ts);
+        if (number == -1) return -1;
+        if (i < ndim && (size_t) number != ctx->head->field->type->arraysize[i]) {
+            PyErr_Format(PyExc_ValueError,
+                        "Expected a dimension of size %zu, got %d",
+                        ctx->head->field->type->arraysize[i], number);
+            return -1;
+        }
+        if (*ts != ',' && *ts != ')') {
+            PyErr_Format(PyExc_ValueError,
+                                "Expected a comma in format string, got '%c'", *ts);
+            return -1;
+        }
+        if (*ts == ',') ts++;
+        i++;
+    }
+    if (i != ndim) {
+        PyErr_Format(PyExc_ValueError, "Expected %d dimension(s), got %d",
+                            ctx->head->field->type->ndim, i);
+        return -1;
+    }
+    if (!*ts) {
+        PyErr_SetString(PyExc_ValueError,
+                        "Unexpected end of format string, expected ')'");
+        return -1;
+    }
+    ctx->is_valid_array = 1;
+    ctx->new_count = 1;
+    *tsp = ++ts;
+    return 0;
+}
+static const char* __Pyx_BufFmt_CheckString(__Pyx_BufFmt_Context* ctx, const char* ts) {
+  int got_Z = 0;
+  while (1) {
+    switch(*ts) {
+      case 0:
+        if (ctx->enc_type != 0 && ctx->head == NULL) {
+          __Pyx_BufFmt_RaiseExpected(ctx);
+          return NULL;
+        }
+        if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
+        if (ctx->head != NULL) {
+          __Pyx_BufFmt_RaiseExpected(ctx);
+          return NULL;
+        }
+        return ts;
+      case ' ':
+      case '\r':
+      case '\n':
+        ++ts;
+        break;
+      case '<':
+        if (!__Pyx_Is_Little_Endian()) {
+          PyErr_SetString(PyExc_ValueError, "Little-endian buffer not supported on big-endian compiler");
+          return NULL;
+        }
+        ctx->new_packmode = '=';
+        ++ts;
+        break;
+      case '>':
+      case '!':
+        if (__Pyx_Is_Little_Endian()) {
+          PyErr_SetString(PyExc_ValueError, "Big-endian buffer not supported on little-endian compiler");
+          return NULL;
+        }
+        ctx->new_packmode = '=';
+        ++ts;
+        break;
+      case '=':
+      case '@':
+      case '^':
+        ctx->new_packmode = *ts++;
+        break;
+      case 'T':
+        {
+          const char* ts_after_sub;
+          size_t i, struct_count = ctx->new_count;
+          size_t struct_alignment = ctx->struct_alignment;
+          ctx->new_count = 1;
+          ++ts;
+          if (*ts != '{') {
+            PyErr_SetString(PyExc_ValueError, "Buffer acquisition: Expected '{' after 'T'");
+            return NULL;
+          }
+          if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
+          ctx->enc_type = 0;
+          ctx->enc_count = 0;
+          ctx->struct_alignment = 0;
+          ++ts;
+          ts_after_sub = ts;
+          for (i = 0; i != struct_count; ++i) {
+            ts_after_sub = __Pyx_BufFmt_CheckString(ctx, ts);
+            if (!ts_after_sub) return NULL;
+          }
+          ts = ts_after_sub;
+          if (struct_alignment) ctx->struct_alignment = struct_alignment;
+        }
+        break;
+      case '}':
+        {
+          size_t alignment = ctx->struct_alignment;
+          ++ts;
+          if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
+          ctx->enc_type = 0;
+          if (alignment && ctx->fmt_offset % alignment) {
+            ctx->fmt_offset += alignment - (ctx->fmt_offset % alignment);
+          }
+        }
+        return ts;
+      case 'x':
+        if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
+        ctx->fmt_offset += ctx->new_count;
+        ctx->new_count = 1;
+        ctx->enc_count = 0;
+        ctx->enc_type = 0;
+        ctx->enc_packmode = ctx->new_packmode;
+        ++ts;
+        break;
+      case 'Z':
+        got_Z = 1;
+        ++ts;
+        if (*ts != 'f' && *ts != 'd' && *ts != 'g') {
+          __Pyx_BufFmt_RaiseUnexpectedChar('Z');
+          return NULL;
+        }
+        CYTHON_FALLTHROUGH;
+      case '?': case 'c': case 'b': case 'B': case 'h': case 'H': case 'i': case 'I':
+      case 'l': case 'L': case 'q': case 'Q':
+      case 'f': case 'd': case 'g':
+      case 'O': case 'p':
+        if ((ctx->enc_type == *ts) && (got_Z == ctx->is_complex) &&
+            (ctx->enc_packmode == ctx->new_packmode) && (!ctx->is_valid_array)) {
+          ctx->enc_count += ctx->new_count;
+          ctx->new_count = 1;
+          got_Z = 0;
+          ++ts;
+          break;
+        }
+        CYTHON_FALLTHROUGH;
+      case 's':
+        if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
+        ctx->enc_count = ctx->new_count;
+        ctx->enc_packmode = ctx->new_packmode;
+        ctx->enc_type = *ts;
+        ctx->is_complex = got_Z;
+        ++ts;
+        ctx->new_count = 1;
+        got_Z = 0;
+        break;
+      case ':':
+        ++ts;
+        while(*ts != ':') ++ts;
+        ++ts;
+        break;
+      case '(':
+        if (__pyx_buffmt_parse_array(ctx, &ts) < 0) return NULL;
+        break;
+      default:
+        {
+          int number = __Pyx_BufFmt_ExpectNumber(&ts);
+          if (number == -1) return NULL;
+          ctx->new_count = (size_t)number;
+        }
+    }
+  }
+}
 
 /* TypeInfoCompare */
   static int
 __pyx_typeinfo_cmp(__Pyx_TypeInfo *a, __Pyx_TypeInfo *b)
 {
     int i;
     if (!a || !b)
@@ -29551,95 +29640,117 @@
     retval = -1;
 no_fail:
     __Pyx_RefNannyFinishContext();
     return retval;
 }
 
 /* ObjectToMemviewSlice */
-  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(PyObject *obj, int writable_flag) {
+  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_UINT32_t(PyObject *obj, int writable_flag) {
     __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
     __Pyx_BufFmt_StackElem stack[1];
     int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
     int retcode;
     if (obj == Py_None) {
         result.memview = (struct __pyx_memoryview_obj *) Py_None;
         return result;
     }
     retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
                                                  PyBUF_RECORDS_RO | writable_flag, 1,
-                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t, stack,
+                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_4pipi_UINT32_t, stack,
                                                  &result, obj);
     if (unlikely(retcode == -1))
         goto __pyx_fail;
     return result;
 __pyx_fail:
     result.memview = NULL;
     result.data = NULL;
     return result;
 }
 
 /* ObjectToMemviewSlice */
-  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t(PyObject *obj, int writable_flag) {
+  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(PyObject *obj, int writable_flag) {
     __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
     __Pyx_BufFmt_StackElem stack[1];
-    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
+    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
     int retcode;
     if (obj == Py_None) {
         result.memview = (struct __pyx_memoryview_obj *) Py_None;
         return result;
     }
     retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
-                                                 PyBUF_RECORDS_RO | writable_flag, 1,
-                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t, stack,
+                                                 PyBUF_RECORDS_RO | writable_flag, 3,
+                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t, stack,
                                                  &result, obj);
     if (unlikely(retcode == -1))
         goto __pyx_fail;
     return result;
 __pyx_fail:
     result.memview = NULL;
     result.data = NULL;
     return result;
 }
 
 /* ObjectToMemviewSlice */
-  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(PyObject *obj, int writable_flag) {
+  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(PyObject *obj, int writable_flag) {
     __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
     __Pyx_BufFmt_StackElem stack[1];
-    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
+    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
     int retcode;
     if (obj == Py_None) {
         result.memview = (struct __pyx_memoryview_obj *) Py_None;
         return result;
     }
     retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
-                                                 PyBUF_RECORDS_RO | writable_flag, 3,
-                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t, stack,
+                                                 PyBUF_RECORDS_RO | writable_flag, 2,
+                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t, stack,
                                                  &result, obj);
     if (unlikely(retcode == -1))
         goto __pyx_fail;
     return result;
 __pyx_fail:
     result.memview = NULL;
     result.data = NULL;
     return result;
 }
 
+/* CIntFromPyVerify */
+  #define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)\
+    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 0)
+#define __PYX_VERIFY_RETURN_INT_EXC(target_type, func_type, func_value)\
+    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 1)
+#define __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, exc)\
+    {\
+        func_type value = func_value;\
+        if (sizeof(target_type) < sizeof(func_type)) {\
+            if (unlikely(value != (func_type) (target_type) value)) {\
+                func_type zero = 0;\
+                if (exc && unlikely(value == (func_type)-1 && PyErr_Occurred()))\
+                    return (target_type) -1;\
+                if (is_unsigned && unlikely(value < zero))\
+                    goto raise_neg_overflow;\
+                else\
+                    goto raise_overflow;\
+            }\
+        }\
+        return (target_type) value;\
+    }
+
 /* ObjectToMemviewSlice */
-  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(PyObject *obj, int writable_flag) {
+  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(PyObject *obj, int writable_flag) {
     __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
     __Pyx_BufFmt_StackElem stack[1];
-    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
+    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
     int retcode;
     if (obj == Py_None) {
         result.memview = (struct __pyx_memoryview_obj *) Py_None;
         return result;
     }
     retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
-                                                 PyBUF_RECORDS_RO | writable_flag, 2,
-                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t, stack,
+                                                 PyBUF_RECORDS_RO | writable_flag, 1,
+                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t, stack,
                                                  &result, obj);
     if (unlikely(retcode == -1))
         goto __pyx_fail;
     return result;
 __pyx_fail:
     result.memview = NULL;
     result.data = NULL;
@@ -30425,14 +30536,78 @@
     return (long) -1;
 raise_neg_overflow:
     PyErr_SetString(PyExc_OverflowError,
         "can't convert negative value to long");
     return (long) -1;
 }
 
+/* CIntToPy */
+  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wconversion"
+#endif
+    const int neg_one = (int) -1, const_zero = (int) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic pop
+#endif
+    const int is_unsigned = neg_one > const_zero;
+    if (is_unsigned) {
+        if (sizeof(int) < sizeof(long)) {
+            return PyInt_FromLong((long) value);
+        } else if (sizeof(int) <= sizeof(unsigned long)) {
+            return PyLong_FromUnsignedLong((unsigned long) value);
+#ifdef HAVE_LONG_LONG
+        } else if (sizeof(int) <= sizeof(unsigned PY_LONG_LONG)) {
+            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
+#endif
+        }
+    } else {
+        if (sizeof(int) <= sizeof(long)) {
+            return PyInt_FromLong((long) value);
+#ifdef HAVE_LONG_LONG
+        } else if (sizeof(int) <= sizeof(PY_LONG_LONG)) {
+            return PyLong_FromLongLong((PY_LONG_LONG) value);
+#endif
+        }
+    }
+    {
+        int one = 1; int little = (int)*(unsigned char *)&one;
+        unsigned char *bytes = (unsigned char *)&value;
+#if !CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030d0000
+        return _PyLong_FromByteArray(bytes, sizeof(int),
+                                     little, !is_unsigned);
+#else
+        PyObject *from_bytes, *result = NULL;
+        PyObject *py_bytes = NULL, *arg_tuple = NULL, *kwds = NULL, *order_str = NULL;
+        from_bytes = PyObject_GetAttrString((PyObject*)&PyLong_Type, "from_bytes");
+        if (!from_bytes) return NULL;
+        py_bytes = PyBytes_FromStringAndSize((char*)bytes, sizeof(int));
+        if (!py_bytes) goto limited_bad;
+        order_str = PyUnicode_FromString(little ? "little" : "big");
+        if (!order_str) goto limited_bad;
+        arg_tuple = PyTuple_Pack(2, py_bytes, order_str);
+        if (!arg_tuple) goto limited_bad;
+        if (!is_unsigned) {
+            kwds = PyDict_New();
+            if (!kwds) goto limited_bad;
+            if (PyDict_SetItemString(kwds, "signed", __Pyx_NewRef(Py_True))) goto limited_bad;
+        }
+        result = PyObject_Call(from_bytes, arg_tuple, kwds);
+        limited_bad:
+        Py_XDECREF(kwds);
+        Py_XDECREF(arg_tuple);
+        Py_XDECREF(order_str);
+        Py_XDECREF(py_bytes);
+        Py_XDECREF(from_bytes);
+        return result;
+#endif
+    }
+}
+
 /* CIntFromPy */
   static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *x) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
 #endif
     const int neg_one = (int) -1, const_zero = (int) 0;
@@ -30699,78 +30874,14 @@
 raise_neg_overflow:
     PyErr_SetString(PyExc_OverflowError,
         "can't convert negative value to int");
     return (int) -1;
 }
 
 /* CIntToPy */
-  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
-#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
-#pragma GCC diagnostic push
-#pragma GCC diagnostic ignored "-Wconversion"
-#endif
-    const int neg_one = (int) -1, const_zero = (int) 0;
-#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
-#pragma GCC diagnostic pop
-#endif
-    const int is_unsigned = neg_one > const_zero;
-    if (is_unsigned) {
-        if (sizeof(int) < sizeof(long)) {
-            return PyInt_FromLong((long) value);
-        } else if (sizeof(int) <= sizeof(unsigned long)) {
-            return PyLong_FromUnsignedLong((unsigned long) value);
-#ifdef HAVE_LONG_LONG
-        } else if (sizeof(int) <= sizeof(unsigned PY_LONG_LONG)) {
-            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
-#endif
-        }
-    } else {
-        if (sizeof(int) <= sizeof(long)) {
-            return PyInt_FromLong((long) value);
-#ifdef HAVE_LONG_LONG
-        } else if (sizeof(int) <= sizeof(PY_LONG_LONG)) {
-            return PyLong_FromLongLong((PY_LONG_LONG) value);
-#endif
-        }
-    }
-    {
-        int one = 1; int little = (int)*(unsigned char *)&one;
-        unsigned char *bytes = (unsigned char *)&value;
-#if !CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030d0000
-        return _PyLong_FromByteArray(bytes, sizeof(int),
-                                     little, !is_unsigned);
-#else
-        PyObject *from_bytes, *result = NULL;
-        PyObject *py_bytes = NULL, *arg_tuple = NULL, *kwds = NULL, *order_str = NULL;
-        from_bytes = PyObject_GetAttrString((PyObject*)&PyLong_Type, "from_bytes");
-        if (!from_bytes) return NULL;
-        py_bytes = PyBytes_FromStringAndSize((char*)bytes, sizeof(int));
-        if (!py_bytes) goto limited_bad;
-        order_str = PyUnicode_FromString(little ? "little" : "big");
-        if (!order_str) goto limited_bad;
-        arg_tuple = PyTuple_Pack(2, py_bytes, order_str);
-        if (!arg_tuple) goto limited_bad;
-        if (!is_unsigned) {
-            kwds = PyDict_New();
-            if (!kwds) goto limited_bad;
-            if (PyDict_SetItemString(kwds, "signed", __Pyx_NewRef(Py_True))) goto limited_bad;
-        }
-        result = PyObject_Call(from_bytes, arg_tuple, kwds);
-        limited_bad:
-        Py_XDECREF(kwds);
-        Py_XDECREF(arg_tuple);
-        Py_XDECREF(order_str);
-        Py_XDECREF(py_bytes);
-        Py_XDECREF(from_bytes);
-        return result;
-#endif
-    }
-}
-
-/* CIntToPy */
   static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
 #endif
     const long neg_one = (long) -1, const_zero = (long) 0;
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
```

### Comparing `moleculekit-1.8.6/moleculekit/interactions/cationpi/cationpi.pyx` & `moleculekit-1.8.7/moleculekit/interactions/cationpi/cationpi.pyx`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/interactions/hbonds/hbonds.cpp` & `moleculekit-1.8.7/moleculekit/interactions/cationpi/cationpi.cpp`

 * *Files 0% similar despite different names*

```diff
@@ -1,32 +1,32 @@
 /* Generated by Cython 3.0.5 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h"
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include"
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include"
         ],
         "language": "c++",
-        "name": "moleculekit.interactions.hbonds",
+        "name": "moleculekit.interactions.cationpi",
         "sources": [
-            "moleculekit/interactions/hbonds/hbonds.pyx"
+            "moleculekit/interactions/cationpi/cationpi.pyx"
         ]
     },
-    "module_name": "moleculekit.interactions.hbonds"
+    "module_name": "moleculekit.interactions.cationpi"
 }
 END: Cython Metadata */
 
 #ifndef PY_SSIZE_T_CLEAN
 #define PY_SSIZE_T_CLEAN
 #endif /* PY_SSIZE_T_CLEAN */
 #if defined(CYTHON_LIMITED_API) && 0
@@ -1215,16 +1215,16 @@
     #else
     #warning Please do not define the '__PYX_EXTERN_C' macro externally. Use 'CYTHON_EXTERN_C' instead.
     #endif
 #else
     #define __PYX_EXTERN_C extern "C++"
 #endif
 
-#define __PYX_HAVE__moleculekit__interactions__hbonds
-#define __PYX_HAVE_API__moleculekit__interactions__hbonds
+#define __PYX_HAVE__moleculekit__interactions__cationpi
+#define __PYX_HAVE_API__moleculekit__interactions__cationpi
 /* Early includes */
 #include <string.h>
 #include <stdio.h>
 
     /* Using NumPy API declarations from "numpy/__init__.cython-30.pxd" */
     
 #include "numpy/arrayobject.h"
@@ -1523,15 +1523,15 @@
   #undef _Complex_I
   #define _Complex_I 1.0fj
 #endif
 
 /* #### Code section: filename_table ### */
 
 static const char *__pyx_f[] = {
-  "moleculekit/interactions/hbonds/hbonds.pyx",
+  "moleculekit/interactions/cationpi/cationpi.pyx",
   "<stringsource>",
   "__init__.cython-30.pxd",
   "type.pxd",
 };
 /* #### Code section: utility_code_proto_before_types ### */
 /* ForceInitThreads.proto */
 #ifndef __PYX_FORCE_INIT_THREADS
@@ -1672,202 +1672,202 @@
   Py_ssize_t strides[8];
   Py_ssize_t suboffsets[8];
 } __Pyx_memviewslice;
 #define __Pyx_MemoryView_Len(m)  (m.shape[0])
 
 /* #### Code section: numeric_typedefs ### */
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":730
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":730
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":731
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":731
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":732
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":732
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":733
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":733
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":737
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":737
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":738
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":738
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":739
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":739
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":740
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":740
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":744
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":744
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":745
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":745
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":754
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":754
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":755
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":755
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":757
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":757
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":758
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":758
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":760
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":760
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":761
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":761
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":763
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":763
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":764
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":764
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":765
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":765
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
 
-/* "moleculekit/interactions/hbonds/hbonds.pyx":19
+/* "moleculekit/interactions/cationpi/cationpi.pyx":17
  * # every type in the numpy module there's a corresponding compile-time
  * # type with a _t-suffix.
  * ctypedef np.uint32_t UINT32_t             # <<<<<<<<<<<<<<
  * ctypedef np.float32_t FLOAT32_t
  * 
  */
-typedef __pyx_t_5numpy_uint32_t __pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t;
+typedef __pyx_t_5numpy_uint32_t __pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t;
 
-/* "moleculekit/interactions/hbonds/hbonds.pyx":20
+/* "moleculekit/interactions/cationpi/cationpi.pyx":18
  * # type with a _t-suffix.
  * ctypedef np.uint32_t UINT32_t
  * ctypedef np.float32_t FLOAT32_t             # <<<<<<<<<<<<<<
  * 
  * import cython
  */
-typedef __pyx_t_5numpy_float32_t __pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t;
+typedef __pyx_t_5numpy_float32_t __pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t;
 /* #### Code section: complex_type_declarations ### */
 /* Declarations.proto */
 #if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
   #ifdef __cplusplus
     typedef ::std::complex< float > __pyx_t_float_complex;
   #else
     typedef float _Complex __pyx_t_float_complex;
@@ -1893,42 +1893,42 @@
 
 /*--- Type declarations ---*/
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
 struct __pyx_memoryviewslice_obj;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":767
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":767
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":768
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":768
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":769
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":769
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":771
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":771
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -2954,15 +2954,15 @@
                 int ndim,
                 __Pyx_TypeInfo *dtype,
                 __Pyx_BufFmt_StackElem stack[],
                 __Pyx_memviewslice *memviewslice,
                 PyObject *original_obj);
 
 /* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t(PyObject *, int writable_flag);
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(PyObject *, int writable_flag);
 
 /* CppExceptionConversion.proto */
 #ifndef __Pyx_CppExn2PyErr
 #include <new>
 #include <typeinfo>
 #include <stdexcept>
 #include <ios>
@@ -2998,14 +2998,23 @@
   catch (...)
   {
     PyErr_SetString(PyExc_RuntimeError, "Unknown exception");
   }
 }
 #endif
 
+/* ObjectToMemviewSlice.proto */
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t(PyObject *, int writable_flag);
+
+/* ObjectToMemviewSlice.proto */
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(PyObject *, int writable_flag);
+
+/* ObjectToMemviewSlice.proto */
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(PyObject *, int writable_flag);
+
 /* RealImag.proto */
 #if CYTHON_CCOMPLEX
   #ifdef __cplusplus
     #define __Pyx_CREAL(z) ((z).real())
     #define __Pyx_CIMAG(z) ((z).imag())
   #else
     #define __Pyx_CREAL(z) (__real__(z))
@@ -3128,26 +3137,26 @@
     __pyx_atomic_int_type *acquisition_count, PyThread_type_lock lock);
 #define __pyx_get_slice_count_pointer(memview) (&memview->acquisition_count)
 #define __PYX_INC_MEMVIEW(slice, have_gil) __Pyx_INC_MEMVIEW(slice, have_gil, __LINE__)
 #define __PYX_XCLEAR_MEMVIEW(slice, have_gil) __Pyx_XCLEAR_MEMVIEW(slice, have_gil, __LINE__)
 static CYTHON_INLINE void __Pyx_INC_MEMVIEW(__Pyx_memviewslice *, int, int);
 static CYTHON_INLINE void __Pyx_XCLEAR_MEMVIEW(__Pyx_memviewslice *, int, int);
 
-/* CIntToPy.proto */
-static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value);
+/* CIntFromPy.proto */
+static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *);
 
 /* CIntFromPy.proto */
 static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *);
 
+/* CIntToPy.proto */
+static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value);
+
 /* None.proto */
 #include <new>
 
-/* CIntFromPy.proto */
-static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *);
-
 /* CIntToPy.proto */
 static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value);
 
 /* CIntFromPy.proto */
 static CYTHON_INLINE char __Pyx_PyInt_As_char(PyObject *);
 
 /* FormatTypeName.proto */
@@ -3207,35 +3216,39 @@
 
 /* Module declarations from "numpy" */
 
 /* Module declarations from "numpy" */
 
 /* Module declarations from "libcpp.vector" */
 
-/* Module declarations from "libcpp" */
-
 /* Module declarations from "libc.math" */
 
 /* Module declarations from "cython.view" */
 
 /* Module declarations from "cython.dataclasses" */
 
 /* Module declarations from "cython" */
 
-/* Module declarations from "moleculekit.interactions.hbonds" */
+/* Module declarations from "moleculekit.interactions.cationpi" */
 static PyObject *__pyx_collections_abc_Sequence = 0;
 static PyObject *generic = 0;
 static PyObject *strided = 0;
 static PyObject *indirect = 0;
 static PyObject *contiguous = 0;
 static PyObject *indirect_contiguous = 0;
 static int __pyx_memoryview_thread_locks_used;
 static PyThread_type_lock __pyx_memoryview_thread_locks[8];
+static void __pyx_f_11moleculekit_12interactions_8cationpi__calculate_ring_mean(int, int, int, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice); /*proto*/
+static float __pyx_f_11moleculekit_12interactions_8cationpi__wrapped_dist(int, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice); /*proto*/
+static void __pyx_f_11moleculekit_12interactions_8cationpi__normalize(__Pyx_memviewslice); /*proto*/
+static void __pyx_f_11moleculekit_12interactions_8cationpi__cross_product(__Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice); /*proto*/
 static PyObject *__pyx_convert_vector_to_py_int(std::vector<int>  const &); /*proto*/
 static PyObject *__pyx_convert_vector_to_py_std_3a__3a_vector_3c_int_3e___(std::vector<std::vector<int> >  const &); /*proto*/
+static PyObject *__pyx_convert_vector_to_py_float(std::vector<float>  const &); /*proto*/
+static PyObject *__pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___(std::vector<std::vector<float> >  const &); /*proto*/
 static int __pyx_array_allocate_buffer(struct __pyx_array_obj *); /*proto*/
 static struct __pyx_array_obj *__pyx_array_new(PyObject *, Py_ssize_t, char *, char *, char *); /*proto*/
 static PyObject *__pyx_memoryview_new(PyObject *, int, int, __Pyx_TypeInfo *); /*proto*/
 static CYTHON_INLINE int __pyx_memoryview_check(PyObject *); /*proto*/
 static PyObject *_unellipsify(PyObject *, int); /*proto*/
 static int assert_direct_dimensions(Py_ssize_t *, int); /*proto*/
 static struct __pyx_memoryview_obj *__pyx_memview_slice(struct __pyx_memoryview_obj *, PyObject *); /*proto*/
@@ -3263,22 +3276,22 @@
 static void __pyx_memoryview_refcount_copying(__Pyx_memviewslice *, int, int, int); /*proto*/
 static void __pyx_memoryview_refcount_objects_in_slice_with_gil(char *, Py_ssize_t *, Py_ssize_t *, int, int); /*proto*/
 static void __pyx_memoryview_refcount_objects_in_slice(char *, Py_ssize_t *, Py_ssize_t *, int, int); /*proto*/
 static void __pyx_memoryview_slice_assign_scalar(__Pyx_memviewslice *, int, size_t, void *, int); /*proto*/
 static void __pyx_memoryview__slice_assign_scalar(char *, Py_ssize_t *, Py_ssize_t *, int, size_t, void *); /*proto*/
 static PyObject *__pyx_unpickle_Enum__set_state(struct __pyx_MemviewEnum_obj *, PyObject *); /*proto*/
 /* #### Code section: typeinfo ### */
-static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t = { "UINT32_t", NULL, sizeof(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t), { 0 }, 0, __PYX_IS_UNSIGNED(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t) ? 'U' : 'I', __PYX_IS_UNSIGNED(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t), 0 };
-static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t = { "FLOAT32_t", NULL, sizeof(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t), { 0 }, 0, 'R', 0, 0 };
+static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t = { "UINT32_t", NULL, sizeof(__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t), { 0 }, 0, __PYX_IS_UNSIGNED(__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t) ? 'U' : 'I', __PYX_IS_UNSIGNED(__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t), 0 };
+static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t = { "FLOAT32_t", NULL, sizeof(__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t), { 0 }, 0, 'R', 0, 0 };
 /* #### Code section: before_global_var ### */
-#define __Pyx_MODULE_NAME "moleculekit.interactions.hbonds"
-extern int __pyx_module_is_main_moleculekit__interactions__hbonds;
-int __pyx_module_is_main_moleculekit__interactions__hbonds = 0;
+#define __Pyx_MODULE_NAME "moleculekit.interactions.cationpi"
+extern int __pyx_module_is_main_moleculekit__interactions__cationpi;
+int __pyx_module_is_main_moleculekit__interactions__cationpi = 0;
 
-/* Implementation of "moleculekit.interactions.hbonds" */
+/* Implementation of "moleculekit.interactions.cationpi" */
 /* #### Code section: global_var ### */
 static PyObject *__pyx_builtin_range;
 static PyObject *__pyx_builtin_MemoryError;
 static PyObject *__pyx_builtin___import__;
 static PyObject *__pyx_builtin_ValueError;
 static PyObject *__pyx_builtin_enumerate;
 static PyObject *__pyx_builtin_TypeError;
@@ -3286,173 +3299,168 @@
 static PyObject *__pyx_builtin_Ellipsis;
 static PyObject *__pyx_builtin_id;
 static PyObject *__pyx_builtin_IndexError;
 static PyObject *__pyx_builtin_ImportError;
 /* #### Code section: string_decls ### */
 static const char __pyx_k_[] = ": ";
 static const char __pyx_k_O[] = "O";
-static const char __pyx_k_a[] = "a";
 static const char __pyx_k_c[] = "c";
-static const char __pyx_k_d[] = "d";
 static const char __pyx_k_f[] = "f";
 static const char __pyx_k_i[] = "i";
 static const char __pyx_k__2[] = ".";
 static const char __pyx_k__3[] = "*";
 static const char __pyx_k__6[] = "'";
 static const char __pyx_k__7[] = ")";
 static const char __pyx_k_gc[] = "gc";
 static const char __pyx_k_id[] = "id";
 static const char __pyx_k_np[] = "np";
+static const char __pyx_k_r1[] = "r1";
+static const char __pyx_k_r2[] = "r2";
 static const char __pyx_k__25[] = "?";
 static const char __pyx_k_abc[] = "abc";
 static const char __pyx_k_and[] = " and ";
 static const char __pyx_k_box[] = "box";
 static const char __pyx_k_got[] = " (got ";
 static const char __pyx_k_new[] = "__new__";
 static const char __pyx_k_obj[] = "obj";
 static const char __pyx_k_sys[] = "sys";
-static const char __pyx_k_val[] = "val";
 static const char __pyx_k_base[] = "base";
 static const char __pyx_k_dict[] = "__dict__";
 static const char __pyx_k_main[] = "__main__";
-static const char __pyx_k_math[] = "math";
 static const char __pyx_k_mode[] = "mode";
 static const char __pyx_k_name[] = "name";
 static const char __pyx_k_ndim[] = "ndim";
 static const char __pyx_k_pack[] = "pack";
-static const char __pyx_k_sel1[] = "sel1";
-static const char __pyx_k_sel2[] = "sel2";
 static const char __pyx_k_size[] = "size";
 static const char __pyx_k_spec[] = "__spec__";
-static const char __pyx_k_sqrt[] = "sqrt";
 static const char __pyx_k_step[] = "step";
 static const char __pyx_k_stop[] = "stop";
 static const char __pyx_k_test[] = "__test__";
+static const char __pyx_k_tmp1[] = "tmp1";
+static const char __pyx_k_tmp2[] = "tmp2";
 static const char __pyx_k_ASCII[] = "ASCII";
-static const char __pyx_k_a_idx[] = "a_idx";
 static const char __pyx_k_angle[] = "angle";
 static const char __pyx_k_class[] = "__class__";
 static const char __pyx_k_count[] = "count";
-static const char __pyx_k_d_idx[] = "d_idx";
+static const char __pyx_k_dist2[] = "dist2";
 static const char __pyx_k_dtype[] = "dtype";
 static const char __pyx_k_error[] = "error";
 static const char __pyx_k_flags[] = "flags";
 static const char __pyx_k_index[] = "index";
-static const char __pyx_k_intra[] = "intra";
 static const char __pyx_k_numpy[] = "numpy";
 static const char __pyx_k_range[] = "range";
 static const char __pyx_k_shape[] = "shape";
 static const char __pyx_k_start[] = "start";
 static const char __pyx_k_zeros[] = "zeros";
 static const char __pyx_k_UINT32[] = "UINT32";
 static const char __pyx_k_coords[] = "coords";
-static const char __pyx_k_donors[] = "donors";
 static const char __pyx_k_enable[] = "enable";
 static const char __pyx_k_encode[] = "encode";
 static const char __pyx_k_format[] = "format";
 static const char __pyx_k_import[] = "__import__";
 static const char __pyx_k_name_2[] = "__name__";
 static const char __pyx_k_pickle[] = "pickle";
 static const char __pyx_k_reduce[] = "__reduce__";
 static const char __pyx_k_struct[] = "struct";
 static const char __pyx_k_uint32[] = "uint32";
 static const char __pyx_k_unpack[] = "unpack";
 static const char __pyx_k_update[] = "update";
 static const char __pyx_k_FLOAT32[] = "FLOAT32";
-static const char __pyx_k_d_idx_d[] = "d_idx_d";
-static const char __pyx_k_d_idx_h[] = "d_idx_h";
+static const char __pyx_k_cations[] = "cations";
 static const char __pyx_k_disable[] = "disable";
-static const char __pyx_k_dist2_a[] = "dist2_a";
-static const char __pyx_k_dist2_b[] = "dist2_b";
-static const char __pyx_k_dotprod[] = "dotprod";
 static const char __pyx_k_float32[] = "float32";
 static const char __pyx_k_fortran[] = "fortran";
 static const char __pyx_k_memview[] = "memview";
+static const char __pyx_k_n_rings[] = "n_rings";
 static const char __pyx_k_results[] = "results";
 static const char __pyx_k_Ellipsis[] = "Ellipsis";
 static const char __pyx_k_Sequence[] = "Sequence";
+static const char __pyx_k_dot_prod[] = "dot_prod";
 static const char __pyx_k_getstate[] = "__getstate__";
 static const char __pyx_k_half_box[] = "half_box";
 static const char __pyx_k_itemsize[] = "itemsize";
-static const char __pyx_k_n_donors[] = "n_donors";
 static const char __pyx_k_n_frames[] = "n_frames";
 static const char __pyx_k_pyx_type[] = "__pyx_type";
 static const char __pyx_k_register[] = "register";
 static const char __pyx_k_setstate[] = "__setstate__";
 static const char __pyx_k_TypeError[] = "TypeError";
-static const char __pyx_k_acceptors[] = "acceptors";
 static const char __pyx_k_calculate[] = "calculate";
 static const char __pyx_k_enumerate[] = "enumerate";
-static const char __pyx_k_ignore_hs[] = "ignore_hs";
 static const char __pyx_k_isenabled[] = "isenabled";
+static const char __pyx_k_n_cations[] = "n_cations";
 static const char __pyx_k_pyx_state[] = "__pyx_state";
+static const char __pyx_k_r_end_idx[] = "r_end_idx";
 static const char __pyx_k_reduce_ex[] = "__reduce_ex__";
+static const char __pyx_k_ring_mean[] = "ring_mean";
 static const char __pyx_k_IndexError[] = "IndexError";
 static const char __pyx_k_ValueError[] = "ValueError";
-static const char __pyx_k_dist_vec_a[] = "dist_vec_a";
-static const char __pyx_k_dist_vec_b[] = "dist_vec_b";
+static const char __pyx_k_distangles[] = "distangles";
 static const char __pyx_k_pyx_result[] = "__pyx_result";
 static const char __pyx_k_pyx_vtable[] = "__pyx_vtable__";
 static const char __pyx_k_ImportError[] = "ImportError";
 static const char __pyx_k_MemoryError[] = "MemoryError";
 static const char __pyx_k_PickleError[] = "PickleError";
+static const char __pyx_k_cation_coor[] = "cation_coor";
 static const char __pyx_k_collections[] = "collections";
-static const char __pyx_k_n_acceptors[] = "n_acceptors";
+static const char __pyx_k_r_start_idx[] = "r_start_idx";
+static const char __pyx_k_ring_normal[] = "ring_normal";
+static const char __pyx_k_rings_atoms[] = "rings_atoms";
 static const char __pyx_k_initializing[] = "_initializing";
 static const char __pyx_k_is_coroutine[] = "_is_coroutine";
 static const char __pyx_k_pyx_checksum[] = "__pyx_checksum";
 static const char __pyx_k_stringsource[] = "<stringsource>";
 static const char __pyx_k_version_info[] = "version_info";
 static const char __pyx_k_class_getitem[] = "__class_getitem__";
 static const char __pyx_k_reduce_cython[] = "__reduce_cython__";
 static const char __pyx_k_AssertionError[] = "AssertionError";
 static const char __pyx_k_dist_threshold[] = "dist_threshold";
 static const char __pyx_k_View_MemoryView[] = "View.MemoryView";
 static const char __pyx_k_allocate_buffer[] = "allocate_buffer";
-static const char __pyx_k_angle_threshold[] = "angle_threshold";
 static const char __pyx_k_collections_abc[] = "collections.abc";
 static const char __pyx_k_dtype_is_object[] = "dtype_is_object";
 static const char __pyx_k_pyx_PickleError[] = "__pyx_PickleError";
 static const char __pyx_k_setstate_cython[] = "__setstate_cython__";
 static const char __pyx_k_pyx_unpickle_Enum[] = "__pyx_unpickle_Enum";
 static const char __pyx_k_asyncio_coroutines[] = "asyncio.coroutines";
 static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
 static const char __pyx_k_strided_and_direct[] = "<strided and direct>";
+static const char __pyx_k_angle_threshold_min[] = "angle_threshold_min";
+static const char __pyx_k_rings_start_indexes[] = "rings_start_indexes";
 static const char __pyx_k_strided_and_indirect[] = "<strided and indirect>";
 static const char __pyx_k_Invalid_shape_in_axis[] = "Invalid shape in axis ";
 static const char __pyx_k_contiguous_and_direct[] = "<contiguous and direct>";
 static const char __pyx_k_Cannot_index_with_type[] = "Cannot index with type '";
 static const char __pyx_k_MemoryView_of_r_object[] = "<MemoryView of %r object>";
 static const char __pyx_k_MemoryView_of_r_at_0x_x[] = "<MemoryView of %r at 0x%x>";
 static const char __pyx_k_contiguous_and_indirect[] = "<contiguous and indirect>";
 static const char __pyx_k_Dimension_d_is_not_direct[] = "Dimension %d is not direct";
 static const char __pyx_k_Index_out_of_bounds_axis_d[] = "Index out of bounds (axis %d)";
 static const char __pyx_k_Step_may_not_be_zero_axis_d[] = "Step may not be zero (axis %d)";
 static const char __pyx_k_itemsize_0_for_cython_array[] = "itemsize <= 0 for cython.array";
 static const char __pyx_k_unable_to_allocate_array_data[] = "unable to allocate array data.";
 static const char __pyx_k_strided_and_direct_or_indirect[] = "<strided and direct or indirect>";
-static const char __pyx_k_moleculekit_interactions_hbonds[] = "moleculekit/interactions/hbonds/hbonds.pyx";
 static const char __pyx_k_numpy_core_multiarray_failed_to[] = "numpy.core.multiarray failed to import";
 static const char __pyx_k_All_dimensions_preceding_dimensi[] = "All dimensions preceding dimension %d must be indexed and not sliced";
 static const char __pyx_k_Buffer_view_does_not_expose_stri[] = "Buffer view does not expose strides";
 static const char __pyx_k_Can_only_create_a_buffer_that_is[] = "Can only create a buffer that is contiguous in memory.";
 static const char __pyx_k_Cannot_assign_to_read_only_memor[] = "Cannot assign to read-only memoryview";
 static const char __pyx_k_Cannot_create_writable_memory_vi[] = "Cannot create writable memory view from read-only memoryview";
 static const char __pyx_k_Cannot_transpose_memoryview_with[] = "Cannot transpose memoryview with indirect dimensions";
 static const char __pyx_k_Empty_shape_tuple_for_cython_arr[] = "Empty shape tuple for cython.array";
 static const char __pyx_k_Incompatible_checksums_0x_x_vs_0[] = "Incompatible checksums (0x%x vs (0x82a3537, 0x6ae9995, 0xb068931) = (name))";
 static const char __pyx_k_Indirect_dimensions_not_supporte[] = "Indirect dimensions not supported";
 static const char __pyx_k_Invalid_mode_expected_c_or_fortr[] = "Invalid mode, expected 'c' or 'fortran', got ";
 static const char __pyx_k_Out_of_bounds_on_buffer_access_a[] = "Out of bounds on buffer access (axis ";
 static const char __pyx_k_Unable_to_convert_item_to_object[] = "Unable to convert item to object";
 static const char __pyx_k_got_differing_extents_in_dimensi[] = "got differing extents in dimension ";
+static const char __pyx_k_moleculekit_interactions_cationp[] = "moleculekit/interactions/cationpi/cationpi.pyx";
 static const char __pyx_k_no_default___reduce___due_to_non[] = "no default __reduce__ due to non-trivial __cinit__";
 static const char __pyx_k_numpy_core_umath_failed_to_impor[] = "numpy.core.umath failed to import";
 static const char __pyx_k_unable_to_allocate_shape_and_str[] = "unable to allocate shape and strides.";
-static const char __pyx_k_moleculekit_interactions_hbonds_2[] = "moleculekit.interactions.hbonds";
+static const char __pyx_k_moleculekit_interactions_cationp_2[] = "moleculekit.interactions.cationpi";
 /* #### Code section: decls ### */
 static int __pyx_array___pyx_pf_15View_dot_MemoryView_5array___cinit__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_shape, Py_ssize_t __pyx_v_itemsize, PyObject *__pyx_v_format, PyObject *__pyx_v_mode, int __pyx_v_allocate_buffer); /* proto */
 static int __pyx_array___pyx_pf_15View_dot_MemoryView_5array_2__getbuffer__(struct __pyx_array_obj *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags); /* proto */
 static void __pyx_array___pyx_pf_15View_dot_MemoryView_5array_4__dealloc__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView_5array_7memview___get__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static Py_ssize_t __pyx_array___pyx_pf_15View_dot_MemoryView_5array_6__len__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_array___pyx_pf_15View_dot_MemoryView_5array_8__getattr__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_attr); /* proto */
@@ -3487,15 +3495,15 @@
 static PyObject *__pyx_memoryview___pyx_pf_15View_dot_MemoryView_10memoryview_22copy_fortran(struct __pyx_memoryview_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryview___reduce_cython__(CYTHON_UNUSED struct __pyx_memoryview_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryview_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryview_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static void __pyx_memoryviewslice___pyx_pf_15View_dot_MemoryView_16_memoryviewslice___dealloc__(struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryviewslice___reduce_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryviewslice_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView___pyx_unpickle_Enum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v___pyx_type, long __pyx_v___pyx_checksum, PyObject *__pyx_v___pyx_state); /* proto */
-static PyObject *__pyx_pf_11moleculekit_12interactions_6hbonds_calculate(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_donors, PyArrayObject *__pyx_v_acceptors, PyArrayObject *__pyx_v_coords, PyArrayObject *__pyx_v_box, PyArrayObject *__pyx_v_sel1, PyArrayObject *__pyx_v_sel2, float __pyx_v_dist_threshold, float __pyx_v_angle_threshold, bool __pyx_v_intra, bool __pyx_v_ignore_hs); /* proto */
+static PyObject *__pyx_pf_11moleculekit_12interactions_8cationpi_calculate(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_rings_atoms, PyArrayObject *__pyx_v_rings_start_indexes, PyArrayObject *__pyx_v_cations, PyArrayObject *__pyx_v_coords, PyArrayObject *__pyx_v_box, float __pyx_v_dist_threshold, float __pyx_v_angle_threshold_min); /* proto */
 static PyObject *__pyx_tp_new_array(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_Enum(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_memoryview(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new__memoryviewslice(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 /* #### Code section: late_includes ### */
 /* #### Code section: module_state ### */
 typedef struct {
@@ -3564,16 +3572,14 @@
   #if CYTHON_USE_MODULE_STATE
   #endif
   #if CYTHON_USE_MODULE_STATE
   #endif
   #if CYTHON_USE_MODULE_STATE
   #endif
   #if CYTHON_USE_MODULE_STATE
-  #endif
-  #if CYTHON_USE_MODULE_STATE
   PyObject *__pyx_type___pyx_array;
   PyObject *__pyx_type___pyx_MemviewEnum;
   PyObject *__pyx_type___pyx_memoryview;
   PyObject *__pyx_type___pyx_memoryviewslice;
   #endif
   PyTypeObject *__pyx_array_type;
   PyTypeObject *__pyx_MemviewEnum_type;
@@ -3614,50 +3620,42 @@
   PyObject *__pyx_n_s_ValueError;
   PyObject *__pyx_n_s_View_MemoryView;
   PyObject *__pyx_kp_u__2;
   PyObject *__pyx_n_s__25;
   PyObject *__pyx_n_s__3;
   PyObject *__pyx_kp_u__6;
   PyObject *__pyx_kp_u__7;
-  PyObject *__pyx_n_s_a;
-  PyObject *__pyx_n_s_a_idx;
   PyObject *__pyx_n_s_abc;
-  PyObject *__pyx_n_s_acceptors;
   PyObject *__pyx_n_s_allocate_buffer;
   PyObject *__pyx_kp_u_and;
   PyObject *__pyx_n_s_angle;
-  PyObject *__pyx_n_s_angle_threshold;
+  PyObject *__pyx_n_s_angle_threshold_min;
   PyObject *__pyx_n_s_asyncio_coroutines;
   PyObject *__pyx_n_s_base;
   PyObject *__pyx_n_s_box;
   PyObject *__pyx_n_s_c;
   PyObject *__pyx_n_u_c;
   PyObject *__pyx_n_s_calculate;
+  PyObject *__pyx_n_s_cation_coor;
+  PyObject *__pyx_n_s_cations;
   PyObject *__pyx_n_s_class;
   PyObject *__pyx_n_s_class_getitem;
   PyObject *__pyx_n_s_cline_in_traceback;
   PyObject *__pyx_n_s_collections;
   PyObject *__pyx_kp_s_collections_abc;
   PyObject *__pyx_kp_s_contiguous_and_direct;
   PyObject *__pyx_kp_s_contiguous_and_indirect;
   PyObject *__pyx_n_s_coords;
   PyObject *__pyx_n_s_count;
-  PyObject *__pyx_n_s_d;
-  PyObject *__pyx_n_s_d_idx;
-  PyObject *__pyx_n_s_d_idx_d;
-  PyObject *__pyx_n_s_d_idx_h;
   PyObject *__pyx_n_s_dict;
   PyObject *__pyx_kp_u_disable;
-  PyObject *__pyx_n_s_dist2_a;
-  PyObject *__pyx_n_s_dist2_b;
+  PyObject *__pyx_n_s_dist2;
   PyObject *__pyx_n_s_dist_threshold;
-  PyObject *__pyx_n_s_dist_vec_a;
-  PyObject *__pyx_n_s_dist_vec_b;
-  PyObject *__pyx_n_s_donors;
-  PyObject *__pyx_n_s_dotprod;
+  PyObject *__pyx_n_s_distangles;
+  PyObject *__pyx_n_s_dot_prod;
   PyObject *__pyx_n_s_dtype;
   PyObject *__pyx_n_s_dtype_is_object;
   PyObject *__pyx_kp_u_enable;
   PyObject *__pyx_n_s_encode;
   PyObject *__pyx_n_s_enumerate;
   PyObject *__pyx_n_s_error;
   PyObject *__pyx_n_s_f;
@@ -3669,32 +3667,29 @@
   PyObject *__pyx_kp_u_gc;
   PyObject *__pyx_n_s_getstate;
   PyObject *__pyx_kp_u_got;
   PyObject *__pyx_kp_u_got_differing_extents_in_dimensi;
   PyObject *__pyx_n_s_half_box;
   PyObject *__pyx_n_s_i;
   PyObject *__pyx_n_s_id;
-  PyObject *__pyx_n_s_ignore_hs;
   PyObject *__pyx_n_s_import;
   PyObject *__pyx_n_s_index;
   PyObject *__pyx_n_s_initializing;
-  PyObject *__pyx_n_s_intra;
   PyObject *__pyx_n_s_is_coroutine;
   PyObject *__pyx_kp_u_isenabled;
   PyObject *__pyx_n_s_itemsize;
   PyObject *__pyx_kp_s_itemsize_0_for_cython_array;
   PyObject *__pyx_n_s_main;
-  PyObject *__pyx_n_s_math;
   PyObject *__pyx_n_s_memview;
   PyObject *__pyx_n_s_mode;
-  PyObject *__pyx_kp_s_moleculekit_interactions_hbonds;
-  PyObject *__pyx_n_s_moleculekit_interactions_hbonds_2;
-  PyObject *__pyx_n_s_n_acceptors;
-  PyObject *__pyx_n_s_n_donors;
+  PyObject *__pyx_kp_s_moleculekit_interactions_cationp;
+  PyObject *__pyx_n_s_moleculekit_interactions_cationp_2;
+  PyObject *__pyx_n_s_n_cations;
   PyObject *__pyx_n_s_n_frames;
+  PyObject *__pyx_n_s_n_rings;
   PyObject *__pyx_n_s_name;
   PyObject *__pyx_n_s_name_2;
   PyObject *__pyx_n_s_ndim;
   PyObject *__pyx_n_s_new;
   PyObject *__pyx_kp_s_no_default___reduce___due_to_non;
   PyObject *__pyx_n_s_np;
   PyObject *__pyx_n_s_numpy;
@@ -3706,44 +3701,50 @@
   PyObject *__pyx_n_s_pyx_PickleError;
   PyObject *__pyx_n_s_pyx_checksum;
   PyObject *__pyx_n_s_pyx_result;
   PyObject *__pyx_n_s_pyx_state;
   PyObject *__pyx_n_s_pyx_type;
   PyObject *__pyx_n_s_pyx_unpickle_Enum;
   PyObject *__pyx_n_s_pyx_vtable;
+  PyObject *__pyx_n_s_r1;
+  PyObject *__pyx_n_s_r2;
+  PyObject *__pyx_n_s_r_end_idx;
+  PyObject *__pyx_n_s_r_start_idx;
   PyObject *__pyx_n_s_range;
   PyObject *__pyx_n_s_reduce;
   PyObject *__pyx_n_s_reduce_cython;
   PyObject *__pyx_n_s_reduce_ex;
   PyObject *__pyx_n_s_register;
   PyObject *__pyx_n_s_results;
-  PyObject *__pyx_n_s_sel1;
-  PyObject *__pyx_n_s_sel2;
+  PyObject *__pyx_n_s_ring_mean;
+  PyObject *__pyx_n_s_ring_normal;
+  PyObject *__pyx_n_s_rings_atoms;
+  PyObject *__pyx_n_s_rings_start_indexes;
   PyObject *__pyx_n_s_setstate;
   PyObject *__pyx_n_s_setstate_cython;
   PyObject *__pyx_n_s_shape;
   PyObject *__pyx_n_s_size;
   PyObject *__pyx_n_s_spec;
-  PyObject *__pyx_n_s_sqrt;
   PyObject *__pyx_n_s_start;
   PyObject *__pyx_n_s_step;
   PyObject *__pyx_n_s_stop;
   PyObject *__pyx_kp_s_strided_and_direct;
   PyObject *__pyx_kp_s_strided_and_direct_or_indirect;
   PyObject *__pyx_kp_s_strided_and_indirect;
   PyObject *__pyx_kp_s_stringsource;
   PyObject *__pyx_n_s_struct;
   PyObject *__pyx_n_s_sys;
   PyObject *__pyx_n_s_test;
+  PyObject *__pyx_n_s_tmp1;
+  PyObject *__pyx_n_s_tmp2;
   PyObject *__pyx_n_s_uint32;
   PyObject *__pyx_kp_s_unable_to_allocate_array_data;
   PyObject *__pyx_kp_s_unable_to_allocate_shape_and_str;
   PyObject *__pyx_n_s_unpack;
   PyObject *__pyx_n_s_update;
-  PyObject *__pyx_n_s_val;
   PyObject *__pyx_n_s_version_info;
   PyObject *__pyx_n_s_zeros;
   PyObject *__pyx_int_0;
   PyObject *__pyx_int_1;
   PyObject *__pyx_int_3;
   PyObject *__pyx_int_112105877;
   PyObject *__pyx_int_136983863;
@@ -3869,50 +3870,42 @@
   Py_CLEAR(clear_module_state->__pyx_n_s_ValueError);
   Py_CLEAR(clear_module_state->__pyx_n_s_View_MemoryView);
   Py_CLEAR(clear_module_state->__pyx_kp_u__2);
   Py_CLEAR(clear_module_state->__pyx_n_s__25);
   Py_CLEAR(clear_module_state->__pyx_n_s__3);
   Py_CLEAR(clear_module_state->__pyx_kp_u__6);
   Py_CLEAR(clear_module_state->__pyx_kp_u__7);
-  Py_CLEAR(clear_module_state->__pyx_n_s_a);
-  Py_CLEAR(clear_module_state->__pyx_n_s_a_idx);
   Py_CLEAR(clear_module_state->__pyx_n_s_abc);
-  Py_CLEAR(clear_module_state->__pyx_n_s_acceptors);
   Py_CLEAR(clear_module_state->__pyx_n_s_allocate_buffer);
   Py_CLEAR(clear_module_state->__pyx_kp_u_and);
   Py_CLEAR(clear_module_state->__pyx_n_s_angle);
-  Py_CLEAR(clear_module_state->__pyx_n_s_angle_threshold);
+  Py_CLEAR(clear_module_state->__pyx_n_s_angle_threshold_min);
   Py_CLEAR(clear_module_state->__pyx_n_s_asyncio_coroutines);
   Py_CLEAR(clear_module_state->__pyx_n_s_base);
   Py_CLEAR(clear_module_state->__pyx_n_s_box);
   Py_CLEAR(clear_module_state->__pyx_n_s_c);
   Py_CLEAR(clear_module_state->__pyx_n_u_c);
   Py_CLEAR(clear_module_state->__pyx_n_s_calculate);
+  Py_CLEAR(clear_module_state->__pyx_n_s_cation_coor);
+  Py_CLEAR(clear_module_state->__pyx_n_s_cations);
   Py_CLEAR(clear_module_state->__pyx_n_s_class);
   Py_CLEAR(clear_module_state->__pyx_n_s_class_getitem);
   Py_CLEAR(clear_module_state->__pyx_n_s_cline_in_traceback);
   Py_CLEAR(clear_module_state->__pyx_n_s_collections);
   Py_CLEAR(clear_module_state->__pyx_kp_s_collections_abc);
   Py_CLEAR(clear_module_state->__pyx_kp_s_contiguous_and_direct);
   Py_CLEAR(clear_module_state->__pyx_kp_s_contiguous_and_indirect);
   Py_CLEAR(clear_module_state->__pyx_n_s_coords);
   Py_CLEAR(clear_module_state->__pyx_n_s_count);
-  Py_CLEAR(clear_module_state->__pyx_n_s_d);
-  Py_CLEAR(clear_module_state->__pyx_n_s_d_idx);
-  Py_CLEAR(clear_module_state->__pyx_n_s_d_idx_d);
-  Py_CLEAR(clear_module_state->__pyx_n_s_d_idx_h);
   Py_CLEAR(clear_module_state->__pyx_n_s_dict);
   Py_CLEAR(clear_module_state->__pyx_kp_u_disable);
-  Py_CLEAR(clear_module_state->__pyx_n_s_dist2_a);
-  Py_CLEAR(clear_module_state->__pyx_n_s_dist2_b);
+  Py_CLEAR(clear_module_state->__pyx_n_s_dist2);
   Py_CLEAR(clear_module_state->__pyx_n_s_dist_threshold);
-  Py_CLEAR(clear_module_state->__pyx_n_s_dist_vec_a);
-  Py_CLEAR(clear_module_state->__pyx_n_s_dist_vec_b);
-  Py_CLEAR(clear_module_state->__pyx_n_s_donors);
-  Py_CLEAR(clear_module_state->__pyx_n_s_dotprod);
+  Py_CLEAR(clear_module_state->__pyx_n_s_distangles);
+  Py_CLEAR(clear_module_state->__pyx_n_s_dot_prod);
   Py_CLEAR(clear_module_state->__pyx_n_s_dtype);
   Py_CLEAR(clear_module_state->__pyx_n_s_dtype_is_object);
   Py_CLEAR(clear_module_state->__pyx_kp_u_enable);
   Py_CLEAR(clear_module_state->__pyx_n_s_encode);
   Py_CLEAR(clear_module_state->__pyx_n_s_enumerate);
   Py_CLEAR(clear_module_state->__pyx_n_s_error);
   Py_CLEAR(clear_module_state->__pyx_n_s_f);
@@ -3924,32 +3917,29 @@
   Py_CLEAR(clear_module_state->__pyx_kp_u_gc);
   Py_CLEAR(clear_module_state->__pyx_n_s_getstate);
   Py_CLEAR(clear_module_state->__pyx_kp_u_got);
   Py_CLEAR(clear_module_state->__pyx_kp_u_got_differing_extents_in_dimensi);
   Py_CLEAR(clear_module_state->__pyx_n_s_half_box);
   Py_CLEAR(clear_module_state->__pyx_n_s_i);
   Py_CLEAR(clear_module_state->__pyx_n_s_id);
-  Py_CLEAR(clear_module_state->__pyx_n_s_ignore_hs);
   Py_CLEAR(clear_module_state->__pyx_n_s_import);
   Py_CLEAR(clear_module_state->__pyx_n_s_index);
   Py_CLEAR(clear_module_state->__pyx_n_s_initializing);
-  Py_CLEAR(clear_module_state->__pyx_n_s_intra);
   Py_CLEAR(clear_module_state->__pyx_n_s_is_coroutine);
   Py_CLEAR(clear_module_state->__pyx_kp_u_isenabled);
   Py_CLEAR(clear_module_state->__pyx_n_s_itemsize);
   Py_CLEAR(clear_module_state->__pyx_kp_s_itemsize_0_for_cython_array);
   Py_CLEAR(clear_module_state->__pyx_n_s_main);
-  Py_CLEAR(clear_module_state->__pyx_n_s_math);
   Py_CLEAR(clear_module_state->__pyx_n_s_memview);
   Py_CLEAR(clear_module_state->__pyx_n_s_mode);
-  Py_CLEAR(clear_module_state->__pyx_kp_s_moleculekit_interactions_hbonds);
-  Py_CLEAR(clear_module_state->__pyx_n_s_moleculekit_interactions_hbonds_2);
-  Py_CLEAR(clear_module_state->__pyx_n_s_n_acceptors);
-  Py_CLEAR(clear_module_state->__pyx_n_s_n_donors);
+  Py_CLEAR(clear_module_state->__pyx_kp_s_moleculekit_interactions_cationp);
+  Py_CLEAR(clear_module_state->__pyx_n_s_moleculekit_interactions_cationp_2);
+  Py_CLEAR(clear_module_state->__pyx_n_s_n_cations);
   Py_CLEAR(clear_module_state->__pyx_n_s_n_frames);
+  Py_CLEAR(clear_module_state->__pyx_n_s_n_rings);
   Py_CLEAR(clear_module_state->__pyx_n_s_name);
   Py_CLEAR(clear_module_state->__pyx_n_s_name_2);
   Py_CLEAR(clear_module_state->__pyx_n_s_ndim);
   Py_CLEAR(clear_module_state->__pyx_n_s_new);
   Py_CLEAR(clear_module_state->__pyx_kp_s_no_default___reduce___due_to_non);
   Py_CLEAR(clear_module_state->__pyx_n_s_np);
   Py_CLEAR(clear_module_state->__pyx_n_s_numpy);
@@ -3961,44 +3951,50 @@
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_PickleError);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_checksum);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_result);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_state);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_type);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_unpickle_Enum);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_vtable);
+  Py_CLEAR(clear_module_state->__pyx_n_s_r1);
+  Py_CLEAR(clear_module_state->__pyx_n_s_r2);
+  Py_CLEAR(clear_module_state->__pyx_n_s_r_end_idx);
+  Py_CLEAR(clear_module_state->__pyx_n_s_r_start_idx);
   Py_CLEAR(clear_module_state->__pyx_n_s_range);
   Py_CLEAR(clear_module_state->__pyx_n_s_reduce);
   Py_CLEAR(clear_module_state->__pyx_n_s_reduce_cython);
   Py_CLEAR(clear_module_state->__pyx_n_s_reduce_ex);
   Py_CLEAR(clear_module_state->__pyx_n_s_register);
   Py_CLEAR(clear_module_state->__pyx_n_s_results);
-  Py_CLEAR(clear_module_state->__pyx_n_s_sel1);
-  Py_CLEAR(clear_module_state->__pyx_n_s_sel2);
+  Py_CLEAR(clear_module_state->__pyx_n_s_ring_mean);
+  Py_CLEAR(clear_module_state->__pyx_n_s_ring_normal);
+  Py_CLEAR(clear_module_state->__pyx_n_s_rings_atoms);
+  Py_CLEAR(clear_module_state->__pyx_n_s_rings_start_indexes);
   Py_CLEAR(clear_module_state->__pyx_n_s_setstate);
   Py_CLEAR(clear_module_state->__pyx_n_s_setstate_cython);
   Py_CLEAR(clear_module_state->__pyx_n_s_shape);
   Py_CLEAR(clear_module_state->__pyx_n_s_size);
   Py_CLEAR(clear_module_state->__pyx_n_s_spec);
-  Py_CLEAR(clear_module_state->__pyx_n_s_sqrt);
   Py_CLEAR(clear_module_state->__pyx_n_s_start);
   Py_CLEAR(clear_module_state->__pyx_n_s_step);
   Py_CLEAR(clear_module_state->__pyx_n_s_stop);
   Py_CLEAR(clear_module_state->__pyx_kp_s_strided_and_direct);
   Py_CLEAR(clear_module_state->__pyx_kp_s_strided_and_direct_or_indirect);
   Py_CLEAR(clear_module_state->__pyx_kp_s_strided_and_indirect);
   Py_CLEAR(clear_module_state->__pyx_kp_s_stringsource);
   Py_CLEAR(clear_module_state->__pyx_n_s_struct);
   Py_CLEAR(clear_module_state->__pyx_n_s_sys);
   Py_CLEAR(clear_module_state->__pyx_n_s_test);
+  Py_CLEAR(clear_module_state->__pyx_n_s_tmp1);
+  Py_CLEAR(clear_module_state->__pyx_n_s_tmp2);
   Py_CLEAR(clear_module_state->__pyx_n_s_uint32);
   Py_CLEAR(clear_module_state->__pyx_kp_s_unable_to_allocate_array_data);
   Py_CLEAR(clear_module_state->__pyx_kp_s_unable_to_allocate_shape_and_str);
   Py_CLEAR(clear_module_state->__pyx_n_s_unpack);
   Py_CLEAR(clear_module_state->__pyx_n_s_update);
-  Py_CLEAR(clear_module_state->__pyx_n_s_val);
   Py_CLEAR(clear_module_state->__pyx_n_s_version_info);
   Py_CLEAR(clear_module_state->__pyx_n_s_zeros);
   Py_CLEAR(clear_module_state->__pyx_int_0);
   Py_CLEAR(clear_module_state->__pyx_int_1);
   Py_CLEAR(clear_module_state->__pyx_int_3);
   Py_CLEAR(clear_module_state->__pyx_int_112105877);
   Py_CLEAR(clear_module_state->__pyx_int_136983863);
@@ -4102,50 +4098,42 @@
   Py_VISIT(traverse_module_state->__pyx_n_s_ValueError);
   Py_VISIT(traverse_module_state->__pyx_n_s_View_MemoryView);
   Py_VISIT(traverse_module_state->__pyx_kp_u__2);
   Py_VISIT(traverse_module_state->__pyx_n_s__25);
   Py_VISIT(traverse_module_state->__pyx_n_s__3);
   Py_VISIT(traverse_module_state->__pyx_kp_u__6);
   Py_VISIT(traverse_module_state->__pyx_kp_u__7);
-  Py_VISIT(traverse_module_state->__pyx_n_s_a);
-  Py_VISIT(traverse_module_state->__pyx_n_s_a_idx);
   Py_VISIT(traverse_module_state->__pyx_n_s_abc);
-  Py_VISIT(traverse_module_state->__pyx_n_s_acceptors);
   Py_VISIT(traverse_module_state->__pyx_n_s_allocate_buffer);
   Py_VISIT(traverse_module_state->__pyx_kp_u_and);
   Py_VISIT(traverse_module_state->__pyx_n_s_angle);
-  Py_VISIT(traverse_module_state->__pyx_n_s_angle_threshold);
+  Py_VISIT(traverse_module_state->__pyx_n_s_angle_threshold_min);
   Py_VISIT(traverse_module_state->__pyx_n_s_asyncio_coroutines);
   Py_VISIT(traverse_module_state->__pyx_n_s_base);
   Py_VISIT(traverse_module_state->__pyx_n_s_box);
   Py_VISIT(traverse_module_state->__pyx_n_s_c);
   Py_VISIT(traverse_module_state->__pyx_n_u_c);
   Py_VISIT(traverse_module_state->__pyx_n_s_calculate);
+  Py_VISIT(traverse_module_state->__pyx_n_s_cation_coor);
+  Py_VISIT(traverse_module_state->__pyx_n_s_cations);
   Py_VISIT(traverse_module_state->__pyx_n_s_class);
   Py_VISIT(traverse_module_state->__pyx_n_s_class_getitem);
   Py_VISIT(traverse_module_state->__pyx_n_s_cline_in_traceback);
   Py_VISIT(traverse_module_state->__pyx_n_s_collections);
   Py_VISIT(traverse_module_state->__pyx_kp_s_collections_abc);
   Py_VISIT(traverse_module_state->__pyx_kp_s_contiguous_and_direct);
   Py_VISIT(traverse_module_state->__pyx_kp_s_contiguous_and_indirect);
   Py_VISIT(traverse_module_state->__pyx_n_s_coords);
   Py_VISIT(traverse_module_state->__pyx_n_s_count);
-  Py_VISIT(traverse_module_state->__pyx_n_s_d);
-  Py_VISIT(traverse_module_state->__pyx_n_s_d_idx);
-  Py_VISIT(traverse_module_state->__pyx_n_s_d_idx_d);
-  Py_VISIT(traverse_module_state->__pyx_n_s_d_idx_h);
   Py_VISIT(traverse_module_state->__pyx_n_s_dict);
   Py_VISIT(traverse_module_state->__pyx_kp_u_disable);
-  Py_VISIT(traverse_module_state->__pyx_n_s_dist2_a);
-  Py_VISIT(traverse_module_state->__pyx_n_s_dist2_b);
+  Py_VISIT(traverse_module_state->__pyx_n_s_dist2);
   Py_VISIT(traverse_module_state->__pyx_n_s_dist_threshold);
-  Py_VISIT(traverse_module_state->__pyx_n_s_dist_vec_a);
-  Py_VISIT(traverse_module_state->__pyx_n_s_dist_vec_b);
-  Py_VISIT(traverse_module_state->__pyx_n_s_donors);
-  Py_VISIT(traverse_module_state->__pyx_n_s_dotprod);
+  Py_VISIT(traverse_module_state->__pyx_n_s_distangles);
+  Py_VISIT(traverse_module_state->__pyx_n_s_dot_prod);
   Py_VISIT(traverse_module_state->__pyx_n_s_dtype);
   Py_VISIT(traverse_module_state->__pyx_n_s_dtype_is_object);
   Py_VISIT(traverse_module_state->__pyx_kp_u_enable);
   Py_VISIT(traverse_module_state->__pyx_n_s_encode);
   Py_VISIT(traverse_module_state->__pyx_n_s_enumerate);
   Py_VISIT(traverse_module_state->__pyx_n_s_error);
   Py_VISIT(traverse_module_state->__pyx_n_s_f);
@@ -4157,32 +4145,29 @@
   Py_VISIT(traverse_module_state->__pyx_kp_u_gc);
   Py_VISIT(traverse_module_state->__pyx_n_s_getstate);
   Py_VISIT(traverse_module_state->__pyx_kp_u_got);
   Py_VISIT(traverse_module_state->__pyx_kp_u_got_differing_extents_in_dimensi);
   Py_VISIT(traverse_module_state->__pyx_n_s_half_box);
   Py_VISIT(traverse_module_state->__pyx_n_s_i);
   Py_VISIT(traverse_module_state->__pyx_n_s_id);
-  Py_VISIT(traverse_module_state->__pyx_n_s_ignore_hs);
   Py_VISIT(traverse_module_state->__pyx_n_s_import);
   Py_VISIT(traverse_module_state->__pyx_n_s_index);
   Py_VISIT(traverse_module_state->__pyx_n_s_initializing);
-  Py_VISIT(traverse_module_state->__pyx_n_s_intra);
   Py_VISIT(traverse_module_state->__pyx_n_s_is_coroutine);
   Py_VISIT(traverse_module_state->__pyx_kp_u_isenabled);
   Py_VISIT(traverse_module_state->__pyx_n_s_itemsize);
   Py_VISIT(traverse_module_state->__pyx_kp_s_itemsize_0_for_cython_array);
   Py_VISIT(traverse_module_state->__pyx_n_s_main);
-  Py_VISIT(traverse_module_state->__pyx_n_s_math);
   Py_VISIT(traverse_module_state->__pyx_n_s_memview);
   Py_VISIT(traverse_module_state->__pyx_n_s_mode);
-  Py_VISIT(traverse_module_state->__pyx_kp_s_moleculekit_interactions_hbonds);
-  Py_VISIT(traverse_module_state->__pyx_n_s_moleculekit_interactions_hbonds_2);
-  Py_VISIT(traverse_module_state->__pyx_n_s_n_acceptors);
-  Py_VISIT(traverse_module_state->__pyx_n_s_n_donors);
+  Py_VISIT(traverse_module_state->__pyx_kp_s_moleculekit_interactions_cationp);
+  Py_VISIT(traverse_module_state->__pyx_n_s_moleculekit_interactions_cationp_2);
+  Py_VISIT(traverse_module_state->__pyx_n_s_n_cations);
   Py_VISIT(traverse_module_state->__pyx_n_s_n_frames);
+  Py_VISIT(traverse_module_state->__pyx_n_s_n_rings);
   Py_VISIT(traverse_module_state->__pyx_n_s_name);
   Py_VISIT(traverse_module_state->__pyx_n_s_name_2);
   Py_VISIT(traverse_module_state->__pyx_n_s_ndim);
   Py_VISIT(traverse_module_state->__pyx_n_s_new);
   Py_VISIT(traverse_module_state->__pyx_kp_s_no_default___reduce___due_to_non);
   Py_VISIT(traverse_module_state->__pyx_n_s_np);
   Py_VISIT(traverse_module_state->__pyx_n_s_numpy);
@@ -4194,44 +4179,50 @@
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_PickleError);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_checksum);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_result);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_state);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_type);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_unpickle_Enum);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_vtable);
+  Py_VISIT(traverse_module_state->__pyx_n_s_r1);
+  Py_VISIT(traverse_module_state->__pyx_n_s_r2);
+  Py_VISIT(traverse_module_state->__pyx_n_s_r_end_idx);
+  Py_VISIT(traverse_module_state->__pyx_n_s_r_start_idx);
   Py_VISIT(traverse_module_state->__pyx_n_s_range);
   Py_VISIT(traverse_module_state->__pyx_n_s_reduce);
   Py_VISIT(traverse_module_state->__pyx_n_s_reduce_cython);
   Py_VISIT(traverse_module_state->__pyx_n_s_reduce_ex);
   Py_VISIT(traverse_module_state->__pyx_n_s_register);
   Py_VISIT(traverse_module_state->__pyx_n_s_results);
-  Py_VISIT(traverse_module_state->__pyx_n_s_sel1);
-  Py_VISIT(traverse_module_state->__pyx_n_s_sel2);
+  Py_VISIT(traverse_module_state->__pyx_n_s_ring_mean);
+  Py_VISIT(traverse_module_state->__pyx_n_s_ring_normal);
+  Py_VISIT(traverse_module_state->__pyx_n_s_rings_atoms);
+  Py_VISIT(traverse_module_state->__pyx_n_s_rings_start_indexes);
   Py_VISIT(traverse_module_state->__pyx_n_s_setstate);
   Py_VISIT(traverse_module_state->__pyx_n_s_setstate_cython);
   Py_VISIT(traverse_module_state->__pyx_n_s_shape);
   Py_VISIT(traverse_module_state->__pyx_n_s_size);
   Py_VISIT(traverse_module_state->__pyx_n_s_spec);
-  Py_VISIT(traverse_module_state->__pyx_n_s_sqrt);
   Py_VISIT(traverse_module_state->__pyx_n_s_start);
   Py_VISIT(traverse_module_state->__pyx_n_s_step);
   Py_VISIT(traverse_module_state->__pyx_n_s_stop);
   Py_VISIT(traverse_module_state->__pyx_kp_s_strided_and_direct);
   Py_VISIT(traverse_module_state->__pyx_kp_s_strided_and_direct_or_indirect);
   Py_VISIT(traverse_module_state->__pyx_kp_s_strided_and_indirect);
   Py_VISIT(traverse_module_state->__pyx_kp_s_stringsource);
   Py_VISIT(traverse_module_state->__pyx_n_s_struct);
   Py_VISIT(traverse_module_state->__pyx_n_s_sys);
   Py_VISIT(traverse_module_state->__pyx_n_s_test);
+  Py_VISIT(traverse_module_state->__pyx_n_s_tmp1);
+  Py_VISIT(traverse_module_state->__pyx_n_s_tmp2);
   Py_VISIT(traverse_module_state->__pyx_n_s_uint32);
   Py_VISIT(traverse_module_state->__pyx_kp_s_unable_to_allocate_array_data);
   Py_VISIT(traverse_module_state->__pyx_kp_s_unable_to_allocate_shape_and_str);
   Py_VISIT(traverse_module_state->__pyx_n_s_unpack);
   Py_VISIT(traverse_module_state->__pyx_n_s_update);
-  Py_VISIT(traverse_module_state->__pyx_n_s_val);
   Py_VISIT(traverse_module_state->__pyx_n_s_version_info);
   Py_VISIT(traverse_module_state->__pyx_n_s_zeros);
   Py_VISIT(traverse_module_state->__pyx_int_0);
   Py_VISIT(traverse_module_state->__pyx_int_1);
   Py_VISIT(traverse_module_state->__pyx_int_3);
   Py_VISIT(traverse_module_state->__pyx_int_112105877);
   Py_VISIT(traverse_module_state->__pyx_int_136983863);
@@ -4325,16 +4316,14 @@
 #if CYTHON_USE_MODULE_STATE
 #endif
 #if CYTHON_USE_MODULE_STATE
 #endif
 #if CYTHON_USE_MODULE_STATE
 #endif
 #if CYTHON_USE_MODULE_STATE
-#endif
-#if CYTHON_USE_MODULE_STATE
 #define __pyx_type___pyx_array __pyx_mstate_global->__pyx_type___pyx_array
 #define __pyx_type___pyx_MemviewEnum __pyx_mstate_global->__pyx_type___pyx_MemviewEnum
 #define __pyx_type___pyx_memoryview __pyx_mstate_global->__pyx_type___pyx_memoryview
 #define __pyx_type___pyx_memoryviewslice __pyx_mstate_global->__pyx_type___pyx_memoryviewslice
 #endif
 #define __pyx_array_type __pyx_mstate_global->__pyx_array_type
 #define __pyx_MemviewEnum_type __pyx_mstate_global->__pyx_MemviewEnum_type
@@ -4375,50 +4364,42 @@
 #define __pyx_n_s_ValueError __pyx_mstate_global->__pyx_n_s_ValueError
 #define __pyx_n_s_View_MemoryView __pyx_mstate_global->__pyx_n_s_View_MemoryView
 #define __pyx_kp_u__2 __pyx_mstate_global->__pyx_kp_u__2
 #define __pyx_n_s__25 __pyx_mstate_global->__pyx_n_s__25
 #define __pyx_n_s__3 __pyx_mstate_global->__pyx_n_s__3
 #define __pyx_kp_u__6 __pyx_mstate_global->__pyx_kp_u__6
 #define __pyx_kp_u__7 __pyx_mstate_global->__pyx_kp_u__7
-#define __pyx_n_s_a __pyx_mstate_global->__pyx_n_s_a
-#define __pyx_n_s_a_idx __pyx_mstate_global->__pyx_n_s_a_idx
 #define __pyx_n_s_abc __pyx_mstate_global->__pyx_n_s_abc
-#define __pyx_n_s_acceptors __pyx_mstate_global->__pyx_n_s_acceptors
 #define __pyx_n_s_allocate_buffer __pyx_mstate_global->__pyx_n_s_allocate_buffer
 #define __pyx_kp_u_and __pyx_mstate_global->__pyx_kp_u_and
 #define __pyx_n_s_angle __pyx_mstate_global->__pyx_n_s_angle
-#define __pyx_n_s_angle_threshold __pyx_mstate_global->__pyx_n_s_angle_threshold
+#define __pyx_n_s_angle_threshold_min __pyx_mstate_global->__pyx_n_s_angle_threshold_min
 #define __pyx_n_s_asyncio_coroutines __pyx_mstate_global->__pyx_n_s_asyncio_coroutines
 #define __pyx_n_s_base __pyx_mstate_global->__pyx_n_s_base
 #define __pyx_n_s_box __pyx_mstate_global->__pyx_n_s_box
 #define __pyx_n_s_c __pyx_mstate_global->__pyx_n_s_c
 #define __pyx_n_u_c __pyx_mstate_global->__pyx_n_u_c
 #define __pyx_n_s_calculate __pyx_mstate_global->__pyx_n_s_calculate
+#define __pyx_n_s_cation_coor __pyx_mstate_global->__pyx_n_s_cation_coor
+#define __pyx_n_s_cations __pyx_mstate_global->__pyx_n_s_cations
 #define __pyx_n_s_class __pyx_mstate_global->__pyx_n_s_class
 #define __pyx_n_s_class_getitem __pyx_mstate_global->__pyx_n_s_class_getitem
 #define __pyx_n_s_cline_in_traceback __pyx_mstate_global->__pyx_n_s_cline_in_traceback
 #define __pyx_n_s_collections __pyx_mstate_global->__pyx_n_s_collections
 #define __pyx_kp_s_collections_abc __pyx_mstate_global->__pyx_kp_s_collections_abc
 #define __pyx_kp_s_contiguous_and_direct __pyx_mstate_global->__pyx_kp_s_contiguous_and_direct
 #define __pyx_kp_s_contiguous_and_indirect __pyx_mstate_global->__pyx_kp_s_contiguous_and_indirect
 #define __pyx_n_s_coords __pyx_mstate_global->__pyx_n_s_coords
 #define __pyx_n_s_count __pyx_mstate_global->__pyx_n_s_count
-#define __pyx_n_s_d __pyx_mstate_global->__pyx_n_s_d
-#define __pyx_n_s_d_idx __pyx_mstate_global->__pyx_n_s_d_idx
-#define __pyx_n_s_d_idx_d __pyx_mstate_global->__pyx_n_s_d_idx_d
-#define __pyx_n_s_d_idx_h __pyx_mstate_global->__pyx_n_s_d_idx_h
 #define __pyx_n_s_dict __pyx_mstate_global->__pyx_n_s_dict
 #define __pyx_kp_u_disable __pyx_mstate_global->__pyx_kp_u_disable
-#define __pyx_n_s_dist2_a __pyx_mstate_global->__pyx_n_s_dist2_a
-#define __pyx_n_s_dist2_b __pyx_mstate_global->__pyx_n_s_dist2_b
+#define __pyx_n_s_dist2 __pyx_mstate_global->__pyx_n_s_dist2
 #define __pyx_n_s_dist_threshold __pyx_mstate_global->__pyx_n_s_dist_threshold
-#define __pyx_n_s_dist_vec_a __pyx_mstate_global->__pyx_n_s_dist_vec_a
-#define __pyx_n_s_dist_vec_b __pyx_mstate_global->__pyx_n_s_dist_vec_b
-#define __pyx_n_s_donors __pyx_mstate_global->__pyx_n_s_donors
-#define __pyx_n_s_dotprod __pyx_mstate_global->__pyx_n_s_dotprod
+#define __pyx_n_s_distangles __pyx_mstate_global->__pyx_n_s_distangles
+#define __pyx_n_s_dot_prod __pyx_mstate_global->__pyx_n_s_dot_prod
 #define __pyx_n_s_dtype __pyx_mstate_global->__pyx_n_s_dtype
 #define __pyx_n_s_dtype_is_object __pyx_mstate_global->__pyx_n_s_dtype_is_object
 #define __pyx_kp_u_enable __pyx_mstate_global->__pyx_kp_u_enable
 #define __pyx_n_s_encode __pyx_mstate_global->__pyx_n_s_encode
 #define __pyx_n_s_enumerate __pyx_mstate_global->__pyx_n_s_enumerate
 #define __pyx_n_s_error __pyx_mstate_global->__pyx_n_s_error
 #define __pyx_n_s_f __pyx_mstate_global->__pyx_n_s_f
@@ -4430,32 +4411,29 @@
 #define __pyx_kp_u_gc __pyx_mstate_global->__pyx_kp_u_gc
 #define __pyx_n_s_getstate __pyx_mstate_global->__pyx_n_s_getstate
 #define __pyx_kp_u_got __pyx_mstate_global->__pyx_kp_u_got
 #define __pyx_kp_u_got_differing_extents_in_dimensi __pyx_mstate_global->__pyx_kp_u_got_differing_extents_in_dimensi
 #define __pyx_n_s_half_box __pyx_mstate_global->__pyx_n_s_half_box
 #define __pyx_n_s_i __pyx_mstate_global->__pyx_n_s_i
 #define __pyx_n_s_id __pyx_mstate_global->__pyx_n_s_id
-#define __pyx_n_s_ignore_hs __pyx_mstate_global->__pyx_n_s_ignore_hs
 #define __pyx_n_s_import __pyx_mstate_global->__pyx_n_s_import
 #define __pyx_n_s_index __pyx_mstate_global->__pyx_n_s_index
 #define __pyx_n_s_initializing __pyx_mstate_global->__pyx_n_s_initializing
-#define __pyx_n_s_intra __pyx_mstate_global->__pyx_n_s_intra
 #define __pyx_n_s_is_coroutine __pyx_mstate_global->__pyx_n_s_is_coroutine
 #define __pyx_kp_u_isenabled __pyx_mstate_global->__pyx_kp_u_isenabled
 #define __pyx_n_s_itemsize __pyx_mstate_global->__pyx_n_s_itemsize
 #define __pyx_kp_s_itemsize_0_for_cython_array __pyx_mstate_global->__pyx_kp_s_itemsize_0_for_cython_array
 #define __pyx_n_s_main __pyx_mstate_global->__pyx_n_s_main
-#define __pyx_n_s_math __pyx_mstate_global->__pyx_n_s_math
 #define __pyx_n_s_memview __pyx_mstate_global->__pyx_n_s_memview
 #define __pyx_n_s_mode __pyx_mstate_global->__pyx_n_s_mode
-#define __pyx_kp_s_moleculekit_interactions_hbonds __pyx_mstate_global->__pyx_kp_s_moleculekit_interactions_hbonds
-#define __pyx_n_s_moleculekit_interactions_hbonds_2 __pyx_mstate_global->__pyx_n_s_moleculekit_interactions_hbonds_2
-#define __pyx_n_s_n_acceptors __pyx_mstate_global->__pyx_n_s_n_acceptors
-#define __pyx_n_s_n_donors __pyx_mstate_global->__pyx_n_s_n_donors
+#define __pyx_kp_s_moleculekit_interactions_cationp __pyx_mstate_global->__pyx_kp_s_moleculekit_interactions_cationp
+#define __pyx_n_s_moleculekit_interactions_cationp_2 __pyx_mstate_global->__pyx_n_s_moleculekit_interactions_cationp_2
+#define __pyx_n_s_n_cations __pyx_mstate_global->__pyx_n_s_n_cations
 #define __pyx_n_s_n_frames __pyx_mstate_global->__pyx_n_s_n_frames
+#define __pyx_n_s_n_rings __pyx_mstate_global->__pyx_n_s_n_rings
 #define __pyx_n_s_name __pyx_mstate_global->__pyx_n_s_name
 #define __pyx_n_s_name_2 __pyx_mstate_global->__pyx_n_s_name_2
 #define __pyx_n_s_ndim __pyx_mstate_global->__pyx_n_s_ndim
 #define __pyx_n_s_new __pyx_mstate_global->__pyx_n_s_new
 #define __pyx_kp_s_no_default___reduce___due_to_non __pyx_mstate_global->__pyx_kp_s_no_default___reduce___due_to_non
 #define __pyx_n_s_np __pyx_mstate_global->__pyx_n_s_np
 #define __pyx_n_s_numpy __pyx_mstate_global->__pyx_n_s_numpy
@@ -4467,44 +4445,50 @@
 #define __pyx_n_s_pyx_PickleError __pyx_mstate_global->__pyx_n_s_pyx_PickleError
 #define __pyx_n_s_pyx_checksum __pyx_mstate_global->__pyx_n_s_pyx_checksum
 #define __pyx_n_s_pyx_result __pyx_mstate_global->__pyx_n_s_pyx_result
 #define __pyx_n_s_pyx_state __pyx_mstate_global->__pyx_n_s_pyx_state
 #define __pyx_n_s_pyx_type __pyx_mstate_global->__pyx_n_s_pyx_type
 #define __pyx_n_s_pyx_unpickle_Enum __pyx_mstate_global->__pyx_n_s_pyx_unpickle_Enum
 #define __pyx_n_s_pyx_vtable __pyx_mstate_global->__pyx_n_s_pyx_vtable
+#define __pyx_n_s_r1 __pyx_mstate_global->__pyx_n_s_r1
+#define __pyx_n_s_r2 __pyx_mstate_global->__pyx_n_s_r2
+#define __pyx_n_s_r_end_idx __pyx_mstate_global->__pyx_n_s_r_end_idx
+#define __pyx_n_s_r_start_idx __pyx_mstate_global->__pyx_n_s_r_start_idx
 #define __pyx_n_s_range __pyx_mstate_global->__pyx_n_s_range
 #define __pyx_n_s_reduce __pyx_mstate_global->__pyx_n_s_reduce
 #define __pyx_n_s_reduce_cython __pyx_mstate_global->__pyx_n_s_reduce_cython
 #define __pyx_n_s_reduce_ex __pyx_mstate_global->__pyx_n_s_reduce_ex
 #define __pyx_n_s_register __pyx_mstate_global->__pyx_n_s_register
 #define __pyx_n_s_results __pyx_mstate_global->__pyx_n_s_results
-#define __pyx_n_s_sel1 __pyx_mstate_global->__pyx_n_s_sel1
-#define __pyx_n_s_sel2 __pyx_mstate_global->__pyx_n_s_sel2
+#define __pyx_n_s_ring_mean __pyx_mstate_global->__pyx_n_s_ring_mean
+#define __pyx_n_s_ring_normal __pyx_mstate_global->__pyx_n_s_ring_normal
+#define __pyx_n_s_rings_atoms __pyx_mstate_global->__pyx_n_s_rings_atoms
+#define __pyx_n_s_rings_start_indexes __pyx_mstate_global->__pyx_n_s_rings_start_indexes
 #define __pyx_n_s_setstate __pyx_mstate_global->__pyx_n_s_setstate
 #define __pyx_n_s_setstate_cython __pyx_mstate_global->__pyx_n_s_setstate_cython
 #define __pyx_n_s_shape __pyx_mstate_global->__pyx_n_s_shape
 #define __pyx_n_s_size __pyx_mstate_global->__pyx_n_s_size
 #define __pyx_n_s_spec __pyx_mstate_global->__pyx_n_s_spec
-#define __pyx_n_s_sqrt __pyx_mstate_global->__pyx_n_s_sqrt
 #define __pyx_n_s_start __pyx_mstate_global->__pyx_n_s_start
 #define __pyx_n_s_step __pyx_mstate_global->__pyx_n_s_step
 #define __pyx_n_s_stop __pyx_mstate_global->__pyx_n_s_stop
 #define __pyx_kp_s_strided_and_direct __pyx_mstate_global->__pyx_kp_s_strided_and_direct
 #define __pyx_kp_s_strided_and_direct_or_indirect __pyx_mstate_global->__pyx_kp_s_strided_and_direct_or_indirect
 #define __pyx_kp_s_strided_and_indirect __pyx_mstate_global->__pyx_kp_s_strided_and_indirect
 #define __pyx_kp_s_stringsource __pyx_mstate_global->__pyx_kp_s_stringsource
 #define __pyx_n_s_struct __pyx_mstate_global->__pyx_n_s_struct
 #define __pyx_n_s_sys __pyx_mstate_global->__pyx_n_s_sys
 #define __pyx_n_s_test __pyx_mstate_global->__pyx_n_s_test
+#define __pyx_n_s_tmp1 __pyx_mstate_global->__pyx_n_s_tmp1
+#define __pyx_n_s_tmp2 __pyx_mstate_global->__pyx_n_s_tmp2
 #define __pyx_n_s_uint32 __pyx_mstate_global->__pyx_n_s_uint32
 #define __pyx_kp_s_unable_to_allocate_array_data __pyx_mstate_global->__pyx_kp_s_unable_to_allocate_array_data
 #define __pyx_kp_s_unable_to_allocate_shape_and_str __pyx_mstate_global->__pyx_kp_s_unable_to_allocate_shape_and_str
 #define __pyx_n_s_unpack __pyx_mstate_global->__pyx_n_s_unpack
 #define __pyx_n_s_update __pyx_mstate_global->__pyx_n_s_update
-#define __pyx_n_s_val __pyx_mstate_global->__pyx_n_s_val
 #define __pyx_n_s_version_info __pyx_mstate_global->__pyx_n_s_version_info
 #define __pyx_n_s_zeros __pyx_mstate_global->__pyx_n_s_zeros
 #define __pyx_int_0 __pyx_mstate_global->__pyx_int_0
 #define __pyx_int_1 __pyx_mstate_global->__pyx_int_1
 #define __pyx_int_3 __pyx_mstate_global->__pyx_int_3
 #define __pyx_int_112105877 __pyx_mstate_global->__pyx_int_112105877
 #define __pyx_int_136983863 __pyx_mstate_global->__pyx_int_136983863
@@ -4817,14 +4801,296 @@
   __Pyx_XDECREF(__pyx_v_o);
   __Pyx_XDECREF(__pyx_v_item);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
+static PyObject *__pyx_convert_vector_to_py_float(std::vector<float>  const &__pyx_v_v) {
+  Py_ssize_t __pyx_v_v_size_signed;
+  PyObject *__pyx_v_o = NULL;
+  Py_ssize_t __pyx_v_i;
+  PyObject *__pyx_v_item = 0;
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  int __pyx_t_1;
+  PyObject *__pyx_t_2 = NULL;
+  Py_ssize_t __pyx_t_3;
+  Py_ssize_t __pyx_t_4;
+  Py_ssize_t __pyx_t_5;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__pyx_convert_vector_to_py_float", 1);
+
+  /* "vector.to_py":67
+ * @cname("__pyx_convert_vector_to_py_float")
+ * cdef object __pyx_convert_vector_to_py_float(const vector[X]& v):
+ *     if v.size() > <size_t> PY_SSIZE_T_MAX:             # <<<<<<<<<<<<<<
+ *         raise MemoryError()
+ *     v_size_signed = <Py_ssize_t> v.size()
+ */
+  __pyx_t_1 = (__pyx_v_v.size() > ((size_t)PY_SSIZE_T_MAX));
+  if (unlikely(__pyx_t_1)) {
+
+    /* "vector.to_py":68
+ * cdef object __pyx_convert_vector_to_py_float(const vector[X]& v):
+ *     if v.size() > <size_t> PY_SSIZE_T_MAX:
+ *         raise MemoryError()             # <<<<<<<<<<<<<<
+ *     v_size_signed = <Py_ssize_t> v.size()
+ * 
+ */
+    PyErr_NoMemory(); __PYX_ERR(1, 68, __pyx_L1_error)
+
+    /* "vector.to_py":67
+ * @cname("__pyx_convert_vector_to_py_float")
+ * cdef object __pyx_convert_vector_to_py_float(const vector[X]& v):
+ *     if v.size() > <size_t> PY_SSIZE_T_MAX:             # <<<<<<<<<<<<<<
+ *         raise MemoryError()
+ *     v_size_signed = <Py_ssize_t> v.size()
+ */
+  }
+
+  /* "vector.to_py":69
+ *     if v.size() > <size_t> PY_SSIZE_T_MAX:
+ *         raise MemoryError()
+ *     v_size_signed = <Py_ssize_t> v.size()             # <<<<<<<<<<<<<<
+ * 
+ *     o = PyList_New(v_size_signed)
+ */
+  __pyx_v_v_size_signed = ((Py_ssize_t)__pyx_v_v.size());
+
+  /* "vector.to_py":71
+ *     v_size_signed = <Py_ssize_t> v.size()
+ * 
+ *     o = PyList_New(v_size_signed)             # <<<<<<<<<<<<<<
+ * 
+ *     cdef Py_ssize_t i
+ */
+  __pyx_t_2 = PyList_New(__pyx_v_v_size_signed); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 71, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_v_o = ((PyObject*)__pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "vector.to_py":76
+ *     cdef object item
+ * 
+ *     for i in range(v_size_signed):             # <<<<<<<<<<<<<<
+ *         item = v[i]
+ *         Py_INCREF(item)
+ */
+  __pyx_t_3 = __pyx_v_v_size_signed;
+  __pyx_t_4 = __pyx_t_3;
+  for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
+    __pyx_v_i = __pyx_t_5;
+
+    /* "vector.to_py":77
+ * 
+ *     for i in range(v_size_signed):
+ *         item = v[i]             # <<<<<<<<<<<<<<
+ *         Py_INCREF(item)
+ *         PyList_SET_ITEM(o, i, item)
+ */
+    __pyx_t_2 = PyFloat_FromDouble((__pyx_v_v[__pyx_v_i])); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 77, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_XDECREF_SET(__pyx_v_item, __pyx_t_2);
+    __pyx_t_2 = 0;
+
+    /* "vector.to_py":78
+ *     for i in range(v_size_signed):
+ *         item = v[i]
+ *         Py_INCREF(item)             # <<<<<<<<<<<<<<
+ *         PyList_SET_ITEM(o, i, item)
+ * 
+ */
+    Py_INCREF(__pyx_v_item);
+
+    /* "vector.to_py":79
+ *         item = v[i]
+ *         Py_INCREF(item)
+ *         PyList_SET_ITEM(o, i, item)             # <<<<<<<<<<<<<<
+ * 
+ *     return o
+ */
+    PyList_SET_ITEM(__pyx_v_o, __pyx_v_i, __pyx_v_item);
+  }
+
+  /* "vector.to_py":81
+ *         PyList_SET_ITEM(o, i, item)
+ * 
+ *     return o             # <<<<<<<<<<<<<<
+ * 
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __Pyx_INCREF(__pyx_v_o);
+  __pyx_r = __pyx_v_o;
+  goto __pyx_L0;
+
+  /* "vector.to_py":66
+ * 
+ * @cname("__pyx_convert_vector_to_py_float")
+ * cdef object __pyx_convert_vector_to_py_float(const vector[X]& v):             # <<<<<<<<<<<<<<
+ *     if v.size() > <size_t> PY_SSIZE_T_MAX:
+ *         raise MemoryError()
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_AddTraceback("vector.to_py.__pyx_convert_vector_to_py_float", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_XDECREF(__pyx_v_o);
+  __Pyx_XDECREF(__pyx_v_item);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___(std::vector<std::vector<float> >  const &__pyx_v_v) {
+  Py_ssize_t __pyx_v_v_size_signed;
+  PyObject *__pyx_v_o = NULL;
+  Py_ssize_t __pyx_v_i;
+  PyObject *__pyx_v_item = 0;
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  int __pyx_t_1;
+  PyObject *__pyx_t_2 = NULL;
+  Py_ssize_t __pyx_t_3;
+  Py_ssize_t __pyx_t_4;
+  Py_ssize_t __pyx_t_5;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___", 1);
+
+  /* "vector.to_py":67
+ * @cname("__pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___")
+ * cdef object __pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___(const vector[X]& v):
+ *     if v.size() > <size_t> PY_SSIZE_T_MAX:             # <<<<<<<<<<<<<<
+ *         raise MemoryError()
+ *     v_size_signed = <Py_ssize_t> v.size()
+ */
+  __pyx_t_1 = (__pyx_v_v.size() > ((size_t)PY_SSIZE_T_MAX));
+  if (unlikely(__pyx_t_1)) {
+
+    /* "vector.to_py":68
+ * cdef object __pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___(const vector[X]& v):
+ *     if v.size() > <size_t> PY_SSIZE_T_MAX:
+ *         raise MemoryError()             # <<<<<<<<<<<<<<
+ *     v_size_signed = <Py_ssize_t> v.size()
+ * 
+ */
+    PyErr_NoMemory(); __PYX_ERR(1, 68, __pyx_L1_error)
+
+    /* "vector.to_py":67
+ * @cname("__pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___")
+ * cdef object __pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___(const vector[X]& v):
+ *     if v.size() > <size_t> PY_SSIZE_T_MAX:             # <<<<<<<<<<<<<<
+ *         raise MemoryError()
+ *     v_size_signed = <Py_ssize_t> v.size()
+ */
+  }
+
+  /* "vector.to_py":69
+ *     if v.size() > <size_t> PY_SSIZE_T_MAX:
+ *         raise MemoryError()
+ *     v_size_signed = <Py_ssize_t> v.size()             # <<<<<<<<<<<<<<
+ * 
+ *     o = PyList_New(v_size_signed)
+ */
+  __pyx_v_v_size_signed = ((Py_ssize_t)__pyx_v_v.size());
+
+  /* "vector.to_py":71
+ *     v_size_signed = <Py_ssize_t> v.size()
+ * 
+ *     o = PyList_New(v_size_signed)             # <<<<<<<<<<<<<<
+ * 
+ *     cdef Py_ssize_t i
+ */
+  __pyx_t_2 = PyList_New(__pyx_v_v_size_signed); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 71, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_v_o = ((PyObject*)__pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "vector.to_py":76
+ *     cdef object item
+ * 
+ *     for i in range(v_size_signed):             # <<<<<<<<<<<<<<
+ *         item = v[i]
+ *         Py_INCREF(item)
+ */
+  __pyx_t_3 = __pyx_v_v_size_signed;
+  __pyx_t_4 = __pyx_t_3;
+  for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
+    __pyx_v_i = __pyx_t_5;
+
+    /* "vector.to_py":77
+ * 
+ *     for i in range(v_size_signed):
+ *         item = v[i]             # <<<<<<<<<<<<<<
+ *         Py_INCREF(item)
+ *         PyList_SET_ITEM(o, i, item)
+ */
+    __pyx_t_2 = __pyx_convert_vector_to_py_float((__pyx_v_v[__pyx_v_i])); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 77, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_XDECREF_SET(__pyx_v_item, __pyx_t_2);
+    __pyx_t_2 = 0;
+
+    /* "vector.to_py":78
+ *     for i in range(v_size_signed):
+ *         item = v[i]
+ *         Py_INCREF(item)             # <<<<<<<<<<<<<<
+ *         PyList_SET_ITEM(o, i, item)
+ * 
+ */
+    Py_INCREF(__pyx_v_item);
+
+    /* "vector.to_py":79
+ *         item = v[i]
+ *         Py_INCREF(item)
+ *         PyList_SET_ITEM(o, i, item)             # <<<<<<<<<<<<<<
+ * 
+ *     return o
+ */
+    PyList_SET_ITEM(__pyx_v_o, __pyx_v_i, __pyx_v_item);
+  }
+
+  /* "vector.to_py":81
+ *         PyList_SET_ITEM(o, i, item)
+ * 
+ *     return o             # <<<<<<<<<<<<<<
+ * 
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __Pyx_INCREF(__pyx_v_o);
+  __pyx_r = __pyx_v_o;
+  goto __pyx_L0;
+
+  /* "vector.to_py":66
+ * 
+ * @cname("__pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___")
+ * cdef object __pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___(const vector[X]& v):             # <<<<<<<<<<<<<<
+ *     if v.size() > <size_t> PY_SSIZE_T_MAX:
+ *         raise MemoryError()
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_AddTraceback("vector.to_py.__pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_XDECREF(__pyx_v_o);
+  __Pyx_XDECREF(__pyx_v_item);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
 /* "View.MemoryView":131
  *         cdef bint dtype_is_object
  * 
  *     def __cinit__(array self, tuple shape, Py_ssize_t itemsize, format not None,             # <<<<<<<<<<<<<<
  *                   mode="c", bint allocate_buffer=True):
  * 
  */
@@ -18443,261 +18709,261 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_7ndarray_4base_base(PyArrayObject *__pyx_v_self) {
   PyObject *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":248
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":248
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  *             return PyArray_BASE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_BASE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
 static CYTHON_INLINE PyArray_Descr *__pyx_f_5numpy_7ndarray_5descr_descr(PyArrayObject *__pyx_v_self) {
   PyArray_Descr *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyArray_Descr *__pyx_t_1;
   __Pyx_RefNannySetupContext("descr", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":254
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":254
  *             """Returns an owned reference to the dtype of the array.
  *             """
  *             return <dtype>PyArray_DESCR(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __pyx_t_1 = PyArray_DESCR(__pyx_v_self);
   __Pyx_INCREF((PyObject *)((PyArray_Descr *)__pyx_t_1));
   __pyx_r = ((PyArray_Descr *)__pyx_t_1);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_7ndarray_4ndim_ndim(PyArrayObject *__pyx_v_self) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":260
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":260
  *             """Returns the number of dimensions in the array.
  *             """
  *             return PyArray_NDIM(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_NDIM(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_5shape_shape(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":268
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":268
  *             Can return NULL for 0-dimensional arrays.
  *             """
  *             return PyArray_DIMS(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_DIMS(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_7strides_strides(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":275
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":275
  *             The number of elements matches the number of dimensions of the array (ndim).
  *             """
  *             return PyArray_STRIDES(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_STRIDES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
 static CYTHON_INLINE npy_intp __pyx_f_5numpy_7ndarray_4size_size(PyArrayObject *__pyx_v_self) {
   npy_intp __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":281
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":281
  *             """Returns the total size (in number of elements) of the array.
  *             """
  *             return PyArray_SIZE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_SIZE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
 static CYTHON_INLINE char *__pyx_f_5numpy_7ndarray_4data_data(PyArrayObject *__pyx_v_self) {
   char *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":290
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":290
  *             of `PyArray_DATA()` instead, which returns a 'void*'.
  *             """
  *             return PyArray_BYTES(self)             # <<<<<<<<<<<<<<
  * 
  *     ctypedef unsigned char      npy_bool
  */
   __pyx_r = PyArray_BYTES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -18706,29 +18972,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":774
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":774
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 774, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -18739,15 +19005,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -18756,29 +19022,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":777
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":777
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -18789,15 +19055,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -18806,29 +19072,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":780
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":780
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 780, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -18839,15 +19105,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -18856,29 +19122,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":783
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":783
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -18889,15 +19155,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -18906,29 +19172,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":786
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":786
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -18939,217 +19205,217 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = PyDataType_HASSUBARRAY(__pyx_v_d);
   if (__pyx_t_1) {
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":790
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":790
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":792
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":792
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":968
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":968
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":969
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":969
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   __pyx_t_1 = PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(2, 969, __pyx_L1_error)
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_AddTraceback("numpy.set_array_base", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":972
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":972
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = (__pyx_v_base == NULL);
   if (__pyx_t_1) {
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":974
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":974
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":975
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":975
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19165,15 +19431,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -19181,68 +19447,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":981
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":981
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 981, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":982
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":982
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 982, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 983, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 983, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19250,15 +19516,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19273,15 +19539,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19297,15 +19563,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19313,68 +19579,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":987
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":987
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 987, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":988
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":988
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 988, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 989, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 989, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19382,15 +19648,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19405,15 +19671,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19429,15 +19695,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19445,68 +19711,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":993
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":993
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 993, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":994
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":994
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 994, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":995
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":995
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 995, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 995, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19514,15 +19780,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19537,221 +19803,640 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1010
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1010
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1025
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1025
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
 static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
   npy_datetime __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1035
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1035
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
 static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
   npy_timedelta __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1042
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1042
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
 static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
   NPY_DATETIMEUNIT __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1049
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1049
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "moleculekit/interactions/hbonds/hbonds.pyx":23
+/* "moleculekit/interactions/cationpi/cationpi.pyx":23
+ * @cython.boundscheck(False) # turn off bounds-checking for entire function
+ * @cython.wraparound(False)  # turn off negative index wrapping for entire function
+ * cdef void _calculate_ring_mean(             # <<<<<<<<<<<<<<
+ *         int f,
+ *         int start_idx,
+ */
+
+static void __pyx_f_11moleculekit_12interactions_8cationpi__calculate_ring_mean(int __pyx_v_f, int __pyx_v_start_idx, int __pyx_v_end_idx, __Pyx_memviewslice __pyx_v_rings_atoms, __Pyx_memviewslice __pyx_v_coords, __Pyx_memviewslice __pyx_v_ring_mean) {
+  __pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t __pyx_v_coor;
+  long __pyx_v_i;
+  int __pyx_v_rr;
+  long __pyx_t_1;
+  Py_ssize_t __pyx_t_2;
+  int __pyx_t_3;
+  int __pyx_t_4;
+  int __pyx_t_5;
+  size_t __pyx_t_6;
+  Py_ssize_t __pyx_t_7;
+  Py_ssize_t __pyx_t_8;
+
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":32
+ *     ):
+ *     cdef FLOAT32_t coor
+ *     for i in range(3):             # <<<<<<<<<<<<<<
+ *         ring_mean[i] = 0
+ * 
+ */
+  for (__pyx_t_1 = 0; __pyx_t_1 < 3; __pyx_t_1+=1) {
+    __pyx_v_i = __pyx_t_1;
+
+    /* "moleculekit/interactions/cationpi/cationpi.pyx":33
+ *     cdef FLOAT32_t coor
+ *     for i in range(3):
+ *         ring_mean[i] = 0             # <<<<<<<<<<<<<<
+ * 
+ *     for rr in range(start_idx, end_idx):
+ */
+    __pyx_t_2 = __pyx_v_i;
+    *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_mean.data + __pyx_t_2 * __pyx_v_ring_mean.strides[0]) )) = 0.0;
+  }
+
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":35
+ *         ring_mean[i] = 0
+ * 
+ *     for rr in range(start_idx, end_idx):             # <<<<<<<<<<<<<<
+ *         for i in range(3):
+ *             coor = coords[rings_atoms[rr], i, f]
+ */
+  __pyx_t_3 = __pyx_v_end_idx;
+  __pyx_t_4 = __pyx_t_3;
+  for (__pyx_t_5 = __pyx_v_start_idx; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
+    __pyx_v_rr = __pyx_t_5;
+
+    /* "moleculekit/interactions/cationpi/cationpi.pyx":36
+ * 
+ *     for rr in range(start_idx, end_idx):
+ *         for i in range(3):             # <<<<<<<<<<<<<<
+ *             coor = coords[rings_atoms[rr], i, f]
+ *             ring_mean[i] = ring_mean[i] + coor
+ */
+    for (__pyx_t_1 = 0; __pyx_t_1 < 3; __pyx_t_1+=1) {
+      __pyx_v_i = __pyx_t_1;
+
+      /* "moleculekit/interactions/cationpi/cationpi.pyx":37
+ *     for rr in range(start_idx, end_idx):
+ *         for i in range(3):
+ *             coor = coords[rings_atoms[rr], i, f]             # <<<<<<<<<<<<<<
+ *             ring_mean[i] = ring_mean[i] + coor
+ * 
+ */
+      __pyx_t_2 = __pyx_v_rr;
+      __pyx_t_6 = (*((__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_2 * __pyx_v_rings_atoms.strides[0]) )));
+      __pyx_t_7 = __pyx_v_i;
+      __pyx_t_8 = __pyx_v_f;
+      __pyx_v_coor = (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_6 * __pyx_v_coords.strides[0]) ) + __pyx_t_7 * __pyx_v_coords.strides[1]) ) + __pyx_t_8 * __pyx_v_coords.strides[2]) )));
+
+      /* "moleculekit/interactions/cationpi/cationpi.pyx":38
+ *         for i in range(3):
+ *             coor = coords[rings_atoms[rr], i, f]
+ *             ring_mean[i] = ring_mean[i] + coor             # <<<<<<<<<<<<<<
+ * 
+ *     for i in range(3):
+ */
+      __pyx_t_2 = __pyx_v_i;
+      __pyx_t_8 = __pyx_v_i;
+      *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_mean.data + __pyx_t_8 * __pyx_v_ring_mean.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_mean.data + __pyx_t_2 * __pyx_v_ring_mean.strides[0]) ))) + __pyx_v_coor);
+    }
+  }
+
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":40
+ *             ring_mean[i] = ring_mean[i] + coor
+ * 
+ *     for i in range(3):             # <<<<<<<<<<<<<<
+ *         ring_mean[i] = ring_mean[i] / (end_idx - start_idx)
+ * 
+ */
+  for (__pyx_t_1 = 0; __pyx_t_1 < 3; __pyx_t_1+=1) {
+    __pyx_v_i = __pyx_t_1;
+
+    /* "moleculekit/interactions/cationpi/cationpi.pyx":41
+ * 
+ *     for i in range(3):
+ *         ring_mean[i] = ring_mean[i] / (end_idx - start_idx)             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+    __pyx_t_2 = __pyx_v_i;
+    __pyx_t_8 = __pyx_v_i;
+    *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_mean.data + __pyx_t_8 * __pyx_v_ring_mean.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_mean.data + __pyx_t_2 * __pyx_v_ring_mean.strides[0]) ))) / ((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t)(__pyx_v_end_idx - __pyx_v_start_idx)));
+  }
+
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":23
+ * @cython.boundscheck(False) # turn off bounds-checking for entire function
+ * @cython.wraparound(False)  # turn off negative index wrapping for entire function
+ * cdef void _calculate_ring_mean(             # <<<<<<<<<<<<<<
+ *         int f,
+ *         int start_idx,
+ */
+
+  /* function exit code */
+}
+
+/* "moleculekit/interactions/cationpi/cationpi.pyx":46
+ * @cython.boundscheck(False) # turn off bounds-checking for entire function
+ * @cython.wraparound(False)  # turn off negative index wrapping for entire function
+ * cdef float _wrapped_dist(             # <<<<<<<<<<<<<<
+ *         int f,
+ *         FLOAT32_t[:] point1,
+ */
+
+static float __pyx_f_11moleculekit_12interactions_8cationpi__wrapped_dist(int __pyx_v_f, __Pyx_memviewslice __pyx_v_point1, __Pyx_memviewslice __pyx_v_point2, __Pyx_memviewslice __pyx_v_half_box, __Pyx_memviewslice __pyx_v_box) {
+  __pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t __pyx_v_val;
+  float __pyx_v_dist2;
+  long __pyx_v_i;
+  float __pyx_r;
+  long __pyx_t_1;
+  Py_ssize_t __pyx_t_2;
+  Py_ssize_t __pyx_t_3;
+  int __pyx_t_4;
+  int __pyx_t_5;
+  Py_ssize_t __pyx_t_6;
+  Py_ssize_t __pyx_t_7;
+
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":54
+ *     ):
+ *     cdef FLOAT32_t val
+ *     cdef float dist2 = 0             # <<<<<<<<<<<<<<
+ *     for i in range(3):
+ *         val = point1[i] - point2[i]
+ */
+  __pyx_v_dist2 = 0.0;
+
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":55
+ *     cdef FLOAT32_t val
+ *     cdef float dist2 = 0
+ *     for i in range(3):             # <<<<<<<<<<<<<<
+ *         val = point1[i] - point2[i]
+ *         # Wrap the distance vector into the periodic box
+ */
+  for (__pyx_t_1 = 0; __pyx_t_1 < 3; __pyx_t_1+=1) {
+    __pyx_v_i = __pyx_t_1;
+
+    /* "moleculekit/interactions/cationpi/cationpi.pyx":56
+ *     cdef float dist2 = 0
+ *     for i in range(3):
+ *         val = point1[i] - point2[i]             # <<<<<<<<<<<<<<
+ *         # Wrap the distance vector into the periodic box
+ *         if abs(val) > half_box[i] and box[i, f] != 0:
+ */
+    __pyx_t_2 = __pyx_v_i;
+    __pyx_t_3 = __pyx_v_i;
+    __pyx_v_val = ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_point1.data + __pyx_t_2 * __pyx_v_point1.strides[0]) ))) - (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_point2.data + __pyx_t_3 * __pyx_v_point2.strides[0]) ))));
+
+    /* "moleculekit/interactions/cationpi/cationpi.pyx":58
+ *         val = point1[i] - point2[i]
+ *         # Wrap the distance vector into the periodic box
+ *         if abs(val) > half_box[i] and box[i, f] != 0:             # <<<<<<<<<<<<<<
+ *             val = val - box[i, f] * round(val / box[i, f])
+ *         dist2 = dist2 + (val * val)
+ */
+    __pyx_t_3 = __pyx_v_i;
+    __pyx_t_5 = (fabsf(__pyx_v_val) > (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_half_box.data + __pyx_t_3 * __pyx_v_half_box.strides[0]) ))));
+    if (__pyx_t_5) {
+    } else {
+      __pyx_t_4 = __pyx_t_5;
+      goto __pyx_L6_bool_binop_done;
+    }
+    __pyx_t_3 = __pyx_v_i;
+    __pyx_t_2 = __pyx_v_f;
+    __pyx_t_5 = ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_3 * __pyx_v_box.strides[0]) ) + __pyx_t_2 * __pyx_v_box.strides[1]) ))) != 0.0);
+    __pyx_t_4 = __pyx_t_5;
+    __pyx_L6_bool_binop_done:;
+    if (__pyx_t_4) {
+
+      /* "moleculekit/interactions/cationpi/cationpi.pyx":59
+ *         # Wrap the distance vector into the periodic box
+ *         if abs(val) > half_box[i] and box[i, f] != 0:
+ *             val = val - box[i, f] * round(val / box[i, f])             # <<<<<<<<<<<<<<
+ *         dist2 = dist2 + (val * val)
+ *     return dist2
+ */
+      __pyx_t_2 = __pyx_v_i;
+      __pyx_t_3 = __pyx_v_f;
+      __pyx_t_6 = __pyx_v_i;
+      __pyx_t_7 = __pyx_v_f;
+      __pyx_v_val = (__pyx_v_val - ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_2 * __pyx_v_box.strides[0]) ) + __pyx_t_3 * __pyx_v_box.strides[1]) ))) * round((__pyx_v_val / (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_6 * __pyx_v_box.strides[0]) ) + __pyx_t_7 * __pyx_v_box.strides[1]) )))))));
+
+      /* "moleculekit/interactions/cationpi/cationpi.pyx":58
+ *         val = point1[i] - point2[i]
+ *         # Wrap the distance vector into the periodic box
+ *         if abs(val) > half_box[i] and box[i, f] != 0:             # <<<<<<<<<<<<<<
+ *             val = val - box[i, f] * round(val / box[i, f])
+ *         dist2 = dist2 + (val * val)
+ */
+    }
+
+    /* "moleculekit/interactions/cationpi/cationpi.pyx":60
+ *         if abs(val) > half_box[i] and box[i, f] != 0:
+ *             val = val - box[i, f] * round(val / box[i, f])
+ *         dist2 = dist2 + (val * val)             # <<<<<<<<<<<<<<
+ *     return dist2
+ * 
+ */
+    __pyx_v_dist2 = (__pyx_v_dist2 + (__pyx_v_val * __pyx_v_val));
+  }
+
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":61
+ *             val = val - box[i, f] * round(val / box[i, f])
+ *         dist2 = dist2 + (val * val)
+ *     return dist2             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __pyx_r = __pyx_v_dist2;
+  goto __pyx_L0;
+
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":46
+ * @cython.boundscheck(False) # turn off bounds-checking for entire function
+ * @cython.wraparound(False)  # turn off negative index wrapping for entire function
+ * cdef float _wrapped_dist(             # <<<<<<<<<<<<<<
+ *         int f,
+ *         FLOAT32_t[:] point1,
+ */
+
+  /* function exit code */
+  __pyx_L0:;
+  return __pyx_r;
+}
+
+/* "moleculekit/interactions/cationpi/cationpi.pyx":66
+ * @cython.boundscheck(False) # turn off bounds-checking for entire function
+ * @cython.wraparound(False)  # turn off negative index wrapping for entire function
+ * cdef void _normalize(FLOAT32_t[:] vec):             # <<<<<<<<<<<<<<
+ *     cdef float vec_norm = 0
+ *     for i in range(3):
+ */
+
+static void __pyx_f_11moleculekit_12interactions_8cationpi__normalize(__Pyx_memviewslice __pyx_v_vec) {
+  float __pyx_v_vec_norm;
+  long __pyx_v_i;
+  long __pyx_t_1;
+  Py_ssize_t __pyx_t_2;
+  Py_ssize_t __pyx_t_3;
+
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":67
+ * @cython.wraparound(False)  # turn off negative index wrapping for entire function
+ * cdef void _normalize(FLOAT32_t[:] vec):
+ *     cdef float vec_norm = 0             # <<<<<<<<<<<<<<
+ *     for i in range(3):
+ *         vec_norm = vec_norm + (vec[i] * vec[i])
+ */
+  __pyx_v_vec_norm = 0.0;
+
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":68
+ * cdef void _normalize(FLOAT32_t[:] vec):
+ *     cdef float vec_norm = 0
+ *     for i in range(3):             # <<<<<<<<<<<<<<
+ *         vec_norm = vec_norm + (vec[i] * vec[i])
+ *     vec_norm = sqrt(vec_norm)
+ */
+  for (__pyx_t_1 = 0; __pyx_t_1 < 3; __pyx_t_1+=1) {
+    __pyx_v_i = __pyx_t_1;
+
+    /* "moleculekit/interactions/cationpi/cationpi.pyx":69
+ *     cdef float vec_norm = 0
+ *     for i in range(3):
+ *         vec_norm = vec_norm + (vec[i] * vec[i])             # <<<<<<<<<<<<<<
+ *     vec_norm = sqrt(vec_norm)
+ * 
+ */
+    __pyx_t_2 = __pyx_v_i;
+    __pyx_t_3 = __pyx_v_i;
+    __pyx_v_vec_norm = (__pyx_v_vec_norm + ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec.data + __pyx_t_2 * __pyx_v_vec.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec.data + __pyx_t_3 * __pyx_v_vec.strides[0]) )))));
+  }
+
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":70
+ *     for i in range(3):
+ *         vec_norm = vec_norm + (vec[i] * vec[i])
+ *     vec_norm = sqrt(vec_norm)             # <<<<<<<<<<<<<<
+ * 
+ *     for i in range(3):
+ */
+  __pyx_v_vec_norm = sqrt(__pyx_v_vec_norm);
+
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":72
+ *     vec_norm = sqrt(vec_norm)
+ * 
+ *     for i in range(3):             # <<<<<<<<<<<<<<
+ *         vec[i] = vec[i] / vec_norm
+ * 
+ */
+  for (__pyx_t_1 = 0; __pyx_t_1 < 3; __pyx_t_1+=1) {
+    __pyx_v_i = __pyx_t_1;
+
+    /* "moleculekit/interactions/cationpi/cationpi.pyx":73
+ * 
+ *     for i in range(3):
+ *         vec[i] = vec[i] / vec_norm             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+    __pyx_t_3 = __pyx_v_i;
+    __pyx_t_2 = __pyx_v_i;
+    *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec.data + __pyx_t_2 * __pyx_v_vec.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec.data + __pyx_t_3 * __pyx_v_vec.strides[0]) ))) / ((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t)__pyx_v_vec_norm));
+  }
+
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":66
+ * @cython.boundscheck(False) # turn off bounds-checking for entire function
+ * @cython.wraparound(False)  # turn off negative index wrapping for entire function
+ * cdef void _normalize(FLOAT32_t[:] vec):             # <<<<<<<<<<<<<<
+ *     cdef float vec_norm = 0
+ *     for i in range(3):
+ */
+
+  /* function exit code */
+}
+
+/* "moleculekit/interactions/cationpi/cationpi.pyx":78
+ * @cython.boundscheck(False) # turn off bounds-checking for entire function
+ * @cython.wraparound(False)  # turn off negative index wrapping for entire function
+ * cdef void _cross_product(             # <<<<<<<<<<<<<<
+ *         FLOAT32_t[:] vec_a,
+ *         FLOAT32_t[:] vec_b,
+ */
+
+static void __pyx_f_11moleculekit_12interactions_8cationpi__cross_product(__Pyx_memviewslice __pyx_v_vec_a, __Pyx_memviewslice __pyx_v_vec_b, __Pyx_memviewslice __pyx_v_res) {
+  Py_ssize_t __pyx_t_1;
+  Py_ssize_t __pyx_t_2;
+  Py_ssize_t __pyx_t_3;
+  Py_ssize_t __pyx_t_4;
+  Py_ssize_t __pyx_t_5;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":83
+ *         FLOAT32_t[:] res,
+ *     ):
+ *     res[0] = vec_a[1] * vec_b[2] - vec_a[2] * vec_b[1]             # <<<<<<<<<<<<<<
+ *     res[1] = vec_a[2] * vec_b[0] - vec_a[0] * vec_b[2]
+ *     res[2] = vec_a[0] * vec_b[1] - vec_a[1] * vec_b[0]
+ */
+  __pyx_t_1 = 1;
+  __pyx_t_2 = 2;
+  __pyx_t_3 = 2;
+  __pyx_t_4 = 1;
+  __pyx_t_5 = 0;
+  *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_res.data + __pyx_t_5 * __pyx_v_res.strides[0]) )) = (((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_1 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_2 * __pyx_v_vec_b.strides[0]) )))) - ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_3 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_4 * __pyx_v_vec_b.strides[0]) )))));
+
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":84
+ *     ):
+ *     res[0] = vec_a[1] * vec_b[2] - vec_a[2] * vec_b[1]
+ *     res[1] = vec_a[2] * vec_b[0] - vec_a[0] * vec_b[2]             # <<<<<<<<<<<<<<
+ *     res[2] = vec_a[0] * vec_b[1] - vec_a[1] * vec_b[0]
+ * 
+ */
+  __pyx_t_4 = 2;
+  __pyx_t_3 = 0;
+  __pyx_t_2 = 0;
+  __pyx_t_1 = 2;
+  __pyx_t_5 = 1;
+  *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_res.data + __pyx_t_5 * __pyx_v_res.strides[0]) )) = (((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_4 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_3 * __pyx_v_vec_b.strides[0]) )))) - ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_2 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_1 * __pyx_v_vec_b.strides[0]) )))));
+
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":85
+ *     res[0] = vec_a[1] * vec_b[2] - vec_a[2] * vec_b[1]
+ *     res[1] = vec_a[2] * vec_b[0] - vec_a[0] * vec_b[2]
+ *     res[2] = vec_a[0] * vec_b[1] - vec_a[1] * vec_b[0]             # <<<<<<<<<<<<<<
+ * 
+ *     _normalize(res)
+ */
+  __pyx_t_1 = 0;
+  __pyx_t_2 = 1;
+  __pyx_t_3 = 1;
+  __pyx_t_4 = 0;
+  __pyx_t_5 = 2;
+  *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_res.data + __pyx_t_5 * __pyx_v_res.strides[0]) )) = (((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_1 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_2 * __pyx_v_vec_b.strides[0]) )))) - ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_3 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_4 * __pyx_v_vec_b.strides[0]) )))));
+
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":87
+ *     res[2] = vec_a[0] * vec_b[1] - vec_a[1] * vec_b[0]
+ * 
+ *     _normalize(res)             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __pyx_f_11moleculekit_12interactions_8cationpi__normalize(__pyx_v_res); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 87, __pyx_L1_error)
+
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":78
+ * @cython.boundscheck(False) # turn off bounds-checking for entire function
+ * @cython.wraparound(False)  # turn off negative index wrapping for entire function
+ * cdef void _cross_product(             # <<<<<<<<<<<<<<
+ *         FLOAT32_t[:] vec_a,
+ *         FLOAT32_t[:] vec_b,
+ */
+
+  /* function exit code */
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_AddTraceback("moleculekit.interactions.cationpi._cross_product", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_L0:;
+}
+
+/* "moleculekit/interactions/cationpi/cationpi.pyx":90
+ * 
  * 
- * import cython
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def calculate(
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11moleculekit_12interactions_6hbonds_1calculate(PyObject *__pyx_self, 
+static PyObject *__pyx_pw_11moleculekit_12interactions_8cationpi_1calculate(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ); /*proto*/
-static PyMethodDef __pyx_mdef_11moleculekit_12interactions_6hbonds_1calculate = {"calculate", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11moleculekit_12interactions_6hbonds_1calculate, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_11moleculekit_12interactions_6hbonds_1calculate(PyObject *__pyx_self, 
+static PyMethodDef __pyx_mdef_11moleculekit_12interactions_8cationpi_1calculate = {"calculate", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11moleculekit_12interactions_8cationpi_1calculate, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11moleculekit_12interactions_8cationpi_1calculate(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ) {
-  PyArrayObject *__pyx_v_donors = 0;
-  PyArrayObject *__pyx_v_acceptors = 0;
+  PyArrayObject *__pyx_v_rings_atoms = 0;
+  PyArrayObject *__pyx_v_rings_start_indexes = 0;
+  PyArrayObject *__pyx_v_cations = 0;
   PyArrayObject *__pyx_v_coords = 0;
   PyArrayObject *__pyx_v_box = 0;
-  PyArrayObject *__pyx_v_sel1 = 0;
-  PyArrayObject *__pyx_v_sel2 = 0;
   float __pyx_v_dist_threshold;
-  float __pyx_v_angle_threshold;
-  bool __pyx_v_intra;
-  bool __pyx_v_ignore_hs;
+  float __pyx_v_angle_threshold_min;
   #if !CYTHON_METH_FASTCALL
   CYTHON_UNUSED Py_ssize_t __pyx_nargs;
   #endif
   CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
-  PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
+  PyObject* values[7] = {0,0,0,0,0,0,0};
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("calculate (wrapper)", 0);
   #if !CYTHON_METH_FASTCALL
@@ -19759,24 +20444,18 @@
   __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
   #else
   __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
   #endif
   #endif
   __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
   {
-    PyObject **__pyx_pyargnames[] = {&__pyx_n_s_donors,&__pyx_n_s_acceptors,&__pyx_n_s_coords,&__pyx_n_s_box,&__pyx_n_s_sel1,&__pyx_n_s_sel2,&__pyx_n_s_dist_threshold,&__pyx_n_s_angle_threshold,&__pyx_n_s_intra,&__pyx_n_s_ignore_hs,0};
+    PyObject **__pyx_pyargnames[] = {&__pyx_n_s_rings_atoms,&__pyx_n_s_rings_start_indexes,&__pyx_n_s_cations,&__pyx_n_s_coords,&__pyx_n_s_box,&__pyx_n_s_dist_threshold,&__pyx_n_s_angle_threshold_min,0};
     if (__pyx_kwds) {
       Py_ssize_t kw_args;
       switch (__pyx_nargs) {
-        case 10: values[9] = __Pyx_Arg_FASTCALL(__pyx_args, 9);
-        CYTHON_FALLTHROUGH;
-        case  9: values[8] = __Pyx_Arg_FASTCALL(__pyx_args, 8);
-        CYTHON_FALLTHROUGH;
-        case  8: values[7] = __Pyx_Arg_FASTCALL(__pyx_args, 7);
-        CYTHON_FALLTHROUGH;
         case  7: values[6] = __Pyx_Arg_FASTCALL(__pyx_args, 6);
         CYTHON_FALLTHROUGH;
         case  6: values[5] = __Pyx_Arg_FASTCALL(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
         case  5: values[4] = __Pyx_Arg_FASTCALL(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
@@ -19789,197 +20468,132 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
-        if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_donors)) != 0)) {
+        if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_rings_atoms)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 23, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 90, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_acceptors)) != 0)) {
+        if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_rings_start_indexes)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 23, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 90, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("calculate", 0, 6, 10, 1); __PYX_ERR(0, 23, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calculate", 0, 5, 7, 1); __PYX_ERR(0, 90, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
-        if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_coords)) != 0)) {
+        if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_cations)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 23, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 90, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("calculate", 0, 6, 10, 2); __PYX_ERR(0, 23, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calculate", 0, 5, 7, 2); __PYX_ERR(0, 90, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
-        if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_box)) != 0)) {
+        if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_coords)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[3]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 23, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 90, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("calculate", 0, 6, 10, 3); __PYX_ERR(0, 23, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calculate", 0, 5, 7, 3); __PYX_ERR(0, 90, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
-        if (likely((values[4] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_sel1)) != 0)) {
+        if (likely((values[4] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_box)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[4]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 23, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 90, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("calculate", 0, 6, 10, 4); __PYX_ERR(0, 23, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calculate", 0, 5, 7, 4); __PYX_ERR(0, 90, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
-        if (likely((values[5] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_sel2)) != 0)) {
-          (void)__Pyx_Arg_NewRef_FASTCALL(values[5]);
-          kw_args--;
-        }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 23, __pyx_L3_error)
-        else {
-          __Pyx_RaiseArgtupleInvalid("calculate", 0, 6, 10, 5); __PYX_ERR(0, 23, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  6:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dist_threshold);
-          if (value) { values[6] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 23, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  7:
-        if (kw_args > 0) {
-          PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_angle_threshold);
-          if (value) { values[7] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 23, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  8:
-        if (kw_args > 0) {
-          PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_intra);
-          if (value) { values[8] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 23, __pyx_L3_error)
+          if (value) { values[5] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 90, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
-        case  9:
+        case  6:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_ignore_hs);
-          if (value) { values[9] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 23, __pyx_L3_error)
+          PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_angle_threshold_min);
+          if (value) { values[6] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 90, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "calculate") < 0)) __PYX_ERR(0, 23, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "calculate") < 0)) __PYX_ERR(0, 90, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
-        case 10: values[9] = __Pyx_Arg_FASTCALL(__pyx_args, 9);
-        CYTHON_FALLTHROUGH;
-        case  9: values[8] = __Pyx_Arg_FASTCALL(__pyx_args, 8);
-        CYTHON_FALLTHROUGH;
-        case  8: values[7] = __Pyx_Arg_FASTCALL(__pyx_args, 7);
-        CYTHON_FALLTHROUGH;
         case  7: values[6] = __Pyx_Arg_FASTCALL(__pyx_args, 6);
         CYTHON_FALLTHROUGH;
         case  6: values[5] = __Pyx_Arg_FASTCALL(__pyx_args, 5);
-        values[4] = __Pyx_Arg_FASTCALL(__pyx_args, 4);
+        CYTHON_FALLTHROUGH;
+        case  5: values[4] = __Pyx_Arg_FASTCALL(__pyx_args, 4);
         values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
         values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
         values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
         values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
-    __pyx_v_donors = ((PyArrayObject *)values[0]);
-    __pyx_v_acceptors = ((PyArrayObject *)values[1]);
-    __pyx_v_coords = ((PyArrayObject *)values[2]);
-    __pyx_v_box = ((PyArrayObject *)values[3]);
-    __pyx_v_sel1 = ((PyArrayObject *)values[4]);
-    __pyx_v_sel2 = ((PyArrayObject *)values[5]);
-    if (values[6]) {
-      __pyx_v_dist_threshold = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_dist_threshold == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 32, __pyx_L3_error)
-    } else {
-      __pyx_v_dist_threshold = ((float)((double)2.5));
-    }
-    if (values[7]) {
-      __pyx_v_angle_threshold = __pyx_PyFloat_AsFloat(values[7]); if (unlikely((__pyx_v_angle_threshold == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 33, __pyx_L3_error)
-    } else {
-      __pyx_v_angle_threshold = ((float)((float)120.0));
-    }
-    if (values[8]) {
-      __pyx_v_intra = __Pyx_PyObject_IsTrue(values[8]); if (unlikely((__pyx_v_intra == ((bool)-1)) && PyErr_Occurred())) __PYX_ERR(0, 34, __pyx_L3_error)
+    __pyx_v_rings_atoms = ((PyArrayObject *)values[0]);
+    __pyx_v_rings_start_indexes = ((PyArrayObject *)values[1]);
+    __pyx_v_cations = ((PyArrayObject *)values[2]);
+    __pyx_v_coords = ((PyArrayObject *)values[3]);
+    __pyx_v_box = ((PyArrayObject *)values[4]);
+    if (values[5]) {
+      __pyx_v_dist_threshold = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_dist_threshold == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 98, __pyx_L3_error)
     } else {
-
-      /* "moleculekit/interactions/hbonds/hbonds.pyx":34
- *         float dist_threshold=2.5,
- *         float angle_threshold=120,
- *         bool intra=False,             # <<<<<<<<<<<<<<
- *         bool ignore_hs=False,
- *     ):
- */
-      __pyx_v_intra = ((bool)((int)0));
+      __pyx_v_dist_threshold = ((float)((float)5.0));
     }
-    if (values[9]) {
-      __pyx_v_ignore_hs = __Pyx_PyObject_IsTrue(values[9]); if (unlikely((__pyx_v_ignore_hs == ((bool)-1)) && PyErr_Occurred())) __PYX_ERR(0, 35, __pyx_L3_error)
+    if (values[6]) {
+      __pyx_v_angle_threshold_min = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_angle_threshold_min == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 99, __pyx_L3_error)
     } else {
-
-      /* "moleculekit/interactions/hbonds/hbonds.pyx":35
- *         float angle_threshold=120,
- *         bool intra=False,
- *         bool ignore_hs=False,             # <<<<<<<<<<<<<<
- *     ):
- *     cdef int d, a, f, i
- */
-      __pyx_v_ignore_hs = ((bool)((int)0));
+      __pyx_v_angle_threshold_min = ((float)((float)60.0));
     }
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("calculate", 0, 6, 10, __pyx_nargs); __PYX_ERR(0, 23, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("calculate", 0, 5, 7, __pyx_nargs); __PYX_ERR(0, 90, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
-  __Pyx_AddTraceback("moleculekit.interactions.hbonds.calculate", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("moleculekit.interactions.cationpi.calculate", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_donors), __pyx_ptype_5numpy_ndarray, 1, "donors", 0))) __PYX_ERR(0, 26, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_acceptors), __pyx_ptype_5numpy_ndarray, 1, "acceptors", 0))) __PYX_ERR(0, 27, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_coords), __pyx_ptype_5numpy_ndarray, 1, "coords", 0))) __PYX_ERR(0, 28, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_box), __pyx_ptype_5numpy_ndarray, 1, "box", 0))) __PYX_ERR(0, 29, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sel1), __pyx_ptype_5numpy_ndarray, 1, "sel1", 0))) __PYX_ERR(0, 30, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sel2), __pyx_ptype_5numpy_ndarray, 1, "sel2", 0))) __PYX_ERR(0, 31, __pyx_L1_error)
-  __pyx_r = __pyx_pf_11moleculekit_12interactions_6hbonds_calculate(__pyx_self, __pyx_v_donors, __pyx_v_acceptors, __pyx_v_coords, __pyx_v_box, __pyx_v_sel1, __pyx_v_sel2, __pyx_v_dist_threshold, __pyx_v_angle_threshold, __pyx_v_intra, __pyx_v_ignore_hs);
-
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":23
- * 
- * import cython
- * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
- * @cython.wraparound(False)  # turn off negative index wrapping for entire function
- * def calculate(
- */
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_rings_atoms), __pyx_ptype_5numpy_ndarray, 1, "rings_atoms", 0))) __PYX_ERR(0, 93, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_rings_start_indexes), __pyx_ptype_5numpy_ndarray, 1, "rings_start_indexes", 0))) __PYX_ERR(0, 94, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_cations), __pyx_ptype_5numpy_ndarray, 1, "cations", 0))) __PYX_ERR(0, 95, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_coords), __pyx_ptype_5numpy_ndarray, 1, "coords", 0))) __PYX_ERR(0, 96, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_box), __pyx_ptype_5numpy_ndarray, 1, "box", 0))) __PYX_ERR(0, 97, __pyx_L1_error)
+  __pyx_r = __pyx_pf_11moleculekit_12interactions_8cationpi_calculate(__pyx_self, __pyx_v_rings_atoms, __pyx_v_rings_start_indexes, __pyx_v_cations, __pyx_v_coords, __pyx_v_box, __pyx_v_dist_threshold, __pyx_v_angle_threshold_min);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
   {
@@ -19988,1105 +20602,847 @@
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11moleculekit_12interactions_6hbonds_calculate(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_donors, PyArrayObject *__pyx_v_acceptors, PyArrayObject *__pyx_v_coords, PyArrayObject *__pyx_v_box, PyArrayObject *__pyx_v_sel1, PyArrayObject *__pyx_v_sel2, float __pyx_v_dist_threshold, float __pyx_v_angle_threshold, bool __pyx_v_intra, bool __pyx_v_ignore_hs) {
-  int __pyx_v_d;
-  int __pyx_v_a;
+static PyObject *__pyx_pf_11moleculekit_12interactions_8cationpi_calculate(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_rings_atoms, PyArrayObject *__pyx_v_rings_start_indexes, PyArrayObject *__pyx_v_cations, PyArrayObject *__pyx_v_coords, PyArrayObject *__pyx_v_box, float __pyx_v_dist_threshold, float __pyx_v_angle_threshold_min) {
+  int __pyx_v_r1;
+  int __pyx_v_r2;
   int __pyx_v_f;
   int __pyx_v_i;
-  int __pyx_v_n_donors;
-  int __pyx_v_n_acceptors;
+  int __pyx_v_n_rings;
+  int __pyx_v_n_cations;
   int __pyx_v_n_frames;
   std::vector<std::vector<int> >  __pyx_v_results;
-  __Pyx_memviewslice __pyx_v_dist_vec_a = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_dist_vec_b = { 0, 0, { 0 }, { 0 }, { 0 } };
+  std::vector<std::vector<float> >  __pyx_v_distangles;
+  __Pyx_memviewslice __pyx_v_ring_mean = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_ring_normal = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_half_box = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t __pyx_v_dist2_a;
-  __pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t __pyx_v_dist2_b;
-  __pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t __pyx_v_dotprod;
-  __pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t __pyx_v_val;
-  __pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t __pyx_v_angle;
-  __pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t __pyx_v_d_idx_d;
-  __pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t __pyx_v_d_idx_h;
-  __pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t __pyx_v_d_idx;
-  __pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t __pyx_v_a_idx;
-  __Pyx_LocalBuf_ND __pyx_pybuffernd_acceptors;
-  __Pyx_Buffer __pyx_pybuffer_acceptors;
+  __Pyx_memviewslice __pyx_v_cation_coor = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_tmp1 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_tmp2 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t __pyx_v_dist2;
+  __pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t __pyx_v_dot_prod;
+  int __pyx_v_r_start_idx;
+  int __pyx_v_r_end_idx;
+  double __pyx_v_angle;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_box;
   __Pyx_Buffer __pyx_pybuffer_box;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_cations;
+  __Pyx_Buffer __pyx_pybuffer_cations;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_coords;
   __Pyx_Buffer __pyx_pybuffer_coords;
-  __Pyx_LocalBuf_ND __pyx_pybuffernd_donors;
-  __Pyx_Buffer __pyx_pybuffer_donors;
-  __Pyx_LocalBuf_ND __pyx_pybuffernd_sel1;
-  __Pyx_Buffer __pyx_pybuffer_sel1;
-  __Pyx_LocalBuf_ND __pyx_pybuffernd_sel2;
-  __Pyx_Buffer __pyx_pybuffer_sel2;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_rings_atoms;
+  __Pyx_Buffer __pyx_pybuffer_rings_atoms;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_rings_start_indexes;
+  __Pyx_Buffer __pyx_pybuffer_rings_start_indexes;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   npy_intp *__pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   __Pyx_memviewslice __pyx_t_5 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_t_6;
   int __pyx_t_7;
   int __pyx_t_8;
   std::vector<int>  __pyx_t_9;
-  int __pyx_t_10;
-  Py_ssize_t __pyx_t_11;
+  std::vector<float>  __pyx_t_10;
+  int __pyx_t_11;
   Py_ssize_t __pyx_t_12;
   Py_ssize_t __pyx_t_13;
-  int __pyx_t_14;
+  Py_ssize_t __pyx_t_14;
   int __pyx_t_15;
   int __pyx_t_16;
   int __pyx_t_17;
   int __pyx_t_18;
   int __pyx_t_19;
-  size_t __pyx_t_20;
-  int __pyx_t_21;
+  __Pyx_memviewslice __pyx_t_20 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_t_21 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_t_22;
   size_t __pyx_t_23;
   Py_ssize_t __pyx_t_24;
+  __Pyx_memviewslice __pyx_t_25 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  float __pyx_t_26;
+  int __pyx_t_27;
+  size_t __pyx_t_28;
+  Py_ssize_t __pyx_t_29;
+  Py_ssize_t __pyx_t_30;
+  Py_ssize_t __pyx_t_31;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("calculate", 1);
-  __pyx_pybuffer_donors.pybuffer.buf = NULL;
-  __pyx_pybuffer_donors.refcount = 0;
-  __pyx_pybuffernd_donors.data = NULL;
-  __pyx_pybuffernd_donors.rcbuffer = &__pyx_pybuffer_donors;
-  __pyx_pybuffer_acceptors.pybuffer.buf = NULL;
-  __pyx_pybuffer_acceptors.refcount = 0;
-  __pyx_pybuffernd_acceptors.data = NULL;
-  __pyx_pybuffernd_acceptors.rcbuffer = &__pyx_pybuffer_acceptors;
+  __pyx_pybuffer_rings_atoms.pybuffer.buf = NULL;
+  __pyx_pybuffer_rings_atoms.refcount = 0;
+  __pyx_pybuffernd_rings_atoms.data = NULL;
+  __pyx_pybuffernd_rings_atoms.rcbuffer = &__pyx_pybuffer_rings_atoms;
+  __pyx_pybuffer_rings_start_indexes.pybuffer.buf = NULL;
+  __pyx_pybuffer_rings_start_indexes.refcount = 0;
+  __pyx_pybuffernd_rings_start_indexes.data = NULL;
+  __pyx_pybuffernd_rings_start_indexes.rcbuffer = &__pyx_pybuffer_rings_start_indexes;
+  __pyx_pybuffer_cations.pybuffer.buf = NULL;
+  __pyx_pybuffer_cations.refcount = 0;
+  __pyx_pybuffernd_cations.data = NULL;
+  __pyx_pybuffernd_cations.rcbuffer = &__pyx_pybuffer_cations;
   __pyx_pybuffer_coords.pybuffer.buf = NULL;
   __pyx_pybuffer_coords.refcount = 0;
   __pyx_pybuffernd_coords.data = NULL;
   __pyx_pybuffernd_coords.rcbuffer = &__pyx_pybuffer_coords;
   __pyx_pybuffer_box.pybuffer.buf = NULL;
   __pyx_pybuffer_box.refcount = 0;
   __pyx_pybuffernd_box.data = NULL;
   __pyx_pybuffernd_box.rcbuffer = &__pyx_pybuffer_box;
-  __pyx_pybuffer_sel1.pybuffer.buf = NULL;
-  __pyx_pybuffer_sel1.refcount = 0;
-  __pyx_pybuffernd_sel1.data = NULL;
-  __pyx_pybuffernd_sel1.rcbuffer = &__pyx_pybuffer_sel1;
-  __pyx_pybuffer_sel2.pybuffer.buf = NULL;
-  __pyx_pybuffer_sel2.refcount = 0;
-  __pyx_pybuffernd_sel2.data = NULL;
-  __pyx_pybuffernd_sel2.rcbuffer = &__pyx_pybuffer_sel2;
-  {
-    __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_donors.rcbuffer->pybuffer, (PyObject*)__pyx_v_donors, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 23, __pyx_L1_error)
-  }
-  __pyx_pybuffernd_donors.diminfo[0].strides = __pyx_pybuffernd_donors.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_donors.diminfo[0].shape = __pyx_pybuffernd_donors.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_donors.diminfo[1].strides = __pyx_pybuffernd_donors.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_donors.diminfo[1].shape = __pyx_pybuffernd_donors.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_acceptors.rcbuffer->pybuffer, (PyObject*)__pyx_v_acceptors, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 23, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_rings_atoms.rcbuffer->pybuffer, (PyObject*)__pyx_v_rings_atoms, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 90, __pyx_L1_error)
   }
-  __pyx_pybuffernd_acceptors.diminfo[0].strides = __pyx_pybuffernd_acceptors.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_acceptors.diminfo[0].shape = __pyx_pybuffernd_acceptors.rcbuffer->pybuffer.shape[0];
+  __pyx_pybuffernd_rings_atoms.diminfo[0].strides = __pyx_pybuffernd_rings_atoms.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_rings_atoms.diminfo[0].shape = __pyx_pybuffernd_rings_atoms.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_coords.rcbuffer->pybuffer, (PyObject*)__pyx_v_coords, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) __PYX_ERR(0, 23, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_rings_start_indexes.rcbuffer->pybuffer, (PyObject*)__pyx_v_rings_start_indexes, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 90, __pyx_L1_error)
   }
-  __pyx_pybuffernd_coords.diminfo[0].strides = __pyx_pybuffernd_coords.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_coords.diminfo[0].shape = __pyx_pybuffernd_coords.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_coords.diminfo[1].strides = __pyx_pybuffernd_coords.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_coords.diminfo[1].shape = __pyx_pybuffernd_coords.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_coords.diminfo[2].strides = __pyx_pybuffernd_coords.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_coords.diminfo[2].shape = __pyx_pybuffernd_coords.rcbuffer->pybuffer.shape[2];
+  __pyx_pybuffernd_rings_start_indexes.diminfo[0].strides = __pyx_pybuffernd_rings_start_indexes.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_rings_start_indexes.diminfo[0].shape = __pyx_pybuffernd_rings_start_indexes.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_box.rcbuffer->pybuffer, (PyObject*)__pyx_v_box, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 23, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_cations.rcbuffer->pybuffer, (PyObject*)__pyx_v_cations, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 90, __pyx_L1_error)
   }
-  __pyx_pybuffernd_box.diminfo[0].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box.diminfo[0].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_box.diminfo[1].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_box.diminfo[1].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[1];
+  __pyx_pybuffernd_cations.diminfo[0].strides = __pyx_pybuffernd_cations.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_cations.diminfo[0].shape = __pyx_pybuffernd_cations.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_sel1.rcbuffer->pybuffer, (PyObject*)__pyx_v_sel1, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 23, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_coords.rcbuffer->pybuffer, (PyObject*)__pyx_v_coords, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) __PYX_ERR(0, 90, __pyx_L1_error)
   }
-  __pyx_pybuffernd_sel1.diminfo[0].strides = __pyx_pybuffernd_sel1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_sel1.diminfo[0].shape = __pyx_pybuffernd_sel1.rcbuffer->pybuffer.shape[0];
+  __pyx_pybuffernd_coords.diminfo[0].strides = __pyx_pybuffernd_coords.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_coords.diminfo[0].shape = __pyx_pybuffernd_coords.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_coords.diminfo[1].strides = __pyx_pybuffernd_coords.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_coords.diminfo[1].shape = __pyx_pybuffernd_coords.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_coords.diminfo[2].strides = __pyx_pybuffernd_coords.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_coords.diminfo[2].shape = __pyx_pybuffernd_coords.rcbuffer->pybuffer.shape[2];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_sel2.rcbuffer->pybuffer, (PyObject*)__pyx_v_sel2, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 23, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_box.rcbuffer->pybuffer, (PyObject*)__pyx_v_box, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 90, __pyx_L1_error)
   }
-  __pyx_pybuffernd_sel2.diminfo[0].strides = __pyx_pybuffernd_sel2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_sel2.diminfo[0].shape = __pyx_pybuffernd_sel2.rcbuffer->pybuffer.shape[0];
+  __pyx_pybuffernd_box.diminfo[0].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box.diminfo[0].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_box.diminfo[1].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_box.diminfo[1].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[1];
 
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":38
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":102
  *     ):
- *     cdef int d, a, f, i
- *     cdef int n_donors = donors.shape[0]             # <<<<<<<<<<<<<<
- *     cdef int n_acceptors = acceptors.shape[0]
+ *     cdef int r1, r2, f, i
+ *     cdef int n_rings = rings_start_indexes.shape[0] - 1 # Subtract 1 for the added 0 index at the start             # <<<<<<<<<<<<<<
+ *     cdef int n_cations = cations.shape[0]
  *     cdef int n_frames = coords.shape[2]
  */
-  __pyx_t_1 = __pyx_f_5numpy_7ndarray_5shape_shape(((PyArrayObject *)__pyx_v_donors)); if (unlikely(__pyx_t_1 == ((npy_intp *)NULL) && PyErr_Occurred())) __PYX_ERR(0, 38, __pyx_L1_error)
-  __pyx_v_n_donors = (__pyx_t_1[0]);
+  __pyx_t_1 = __pyx_f_5numpy_7ndarray_5shape_shape(((PyArrayObject *)__pyx_v_rings_start_indexes)); if (unlikely(__pyx_t_1 == ((npy_intp *)NULL) && PyErr_Occurred())) __PYX_ERR(0, 102, __pyx_L1_error)
+  __pyx_v_n_rings = ((__pyx_t_1[0]) - 1);
 
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":39
- *     cdef int d, a, f, i
- *     cdef int n_donors = donors.shape[0]
- *     cdef int n_acceptors = acceptors.shape[0]             # <<<<<<<<<<<<<<
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":103
+ *     cdef int r1, r2, f, i
+ *     cdef int n_rings = rings_start_indexes.shape[0] - 1 # Subtract 1 for the added 0 index at the start
+ *     cdef int n_cations = cations.shape[0]             # <<<<<<<<<<<<<<
  *     cdef int n_frames = coords.shape[2]
- *     cdef vector[vector[int]] results
+ * 
  */
-  __pyx_t_1 = __pyx_f_5numpy_7ndarray_5shape_shape(((PyArrayObject *)__pyx_v_acceptors)); if (unlikely(__pyx_t_1 == ((npy_intp *)NULL) && PyErr_Occurred())) __PYX_ERR(0, 39, __pyx_L1_error)
-  __pyx_v_n_acceptors = (__pyx_t_1[0]);
+  __pyx_t_1 = __pyx_f_5numpy_7ndarray_5shape_shape(((PyArrayObject *)__pyx_v_cations)); if (unlikely(__pyx_t_1 == ((npy_intp *)NULL) && PyErr_Occurred())) __PYX_ERR(0, 103, __pyx_L1_error)
+  __pyx_v_n_cations = (__pyx_t_1[0]);
 
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":40
- *     cdef int n_donors = donors.shape[0]
- *     cdef int n_acceptors = acceptors.shape[0]
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":104
+ *     cdef int n_rings = rings_start_indexes.shape[0] - 1 # Subtract 1 for the added 0 index at the start
+ *     cdef int n_cations = cations.shape[0]
  *     cdef int n_frames = coords.shape[2]             # <<<<<<<<<<<<<<
+ * 
  *     cdef vector[vector[int]] results
- *     cdef FLOAT32_t[:] dist_vec_a = np.zeros(3, dtype=FLOAT32)
  */
-  __pyx_t_1 = __pyx_f_5numpy_7ndarray_5shape_shape(((PyArrayObject *)__pyx_v_coords)); if (unlikely(__pyx_t_1 == ((npy_intp *)NULL) && PyErr_Occurred())) __PYX_ERR(0, 40, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_5numpy_7ndarray_5shape_shape(((PyArrayObject *)__pyx_v_coords)); if (unlikely(__pyx_t_1 == ((npy_intp *)NULL) && PyErr_Occurred())) __PYX_ERR(0, 104, __pyx_L1_error)
   __pyx_v_n_frames = (__pyx_t_1[2]);
 
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":42
- *     cdef int n_frames = coords.shape[2]
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":108
  *     cdef vector[vector[int]] results
- *     cdef FLOAT32_t[:] dist_vec_a = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
- *     cdef FLOAT32_t[:] dist_vec_b = np.zeros(3, dtype=FLOAT32)
+ *     cdef vector[vector[float]] distangles
+ *     cdef FLOAT32_t[:] ring_mean = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
+ *     cdef FLOAT32_t[:] ring_normal = np.zeros(3, dtype=FLOAT32)
  *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 42, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 42, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 42, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 42, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 42, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 108, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__11, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 42, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__11, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 42, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 108, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_v_dist_vec_a = __pyx_t_5;
+  __pyx_v_ring_mean = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":43
- *     cdef vector[vector[int]] results
- *     cdef FLOAT32_t[:] dist_vec_a = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] dist_vec_b = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":109
+ *     cdef vector[vector[float]] distangles
+ *     cdef FLOAT32_t[:] ring_mean = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] ring_normal = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
  *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t dist2_a, dist2_b, dotprod, val, angle
+ *     cdef FLOAT32_t[:] cation_coor = np.zeros(3, dtype=FLOAT32)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 43, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 109, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 43, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 109, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 43, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 109, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 43, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 109, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 43, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 109, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__11, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 43, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__11, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 109, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 43, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 109, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_v_dist_vec_b = __pyx_t_5;
+  __pyx_v_ring_normal = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":44
- *     cdef FLOAT32_t[:] dist_vec_a = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] dist_vec_b = np.zeros(3, dtype=FLOAT32)
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":110
+ *     cdef FLOAT32_t[:] ring_mean = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] ring_normal = np.zeros(3, dtype=FLOAT32)
  *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
- *     cdef FLOAT32_t dist2_a, dist2_b, dotprod, val, angle
- *     cdef UINT32_t d_idx_d, d_idx_h, d_idx, a_idx
+ *     cdef FLOAT32_t[:] cation_coor = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] tmp1 = np.zeros(3, dtype=FLOAT32)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 44, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 110, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 44, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 110, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 44, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 110, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 44, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 110, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 44, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 110, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__11, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 44, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__11, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 110, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 44, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 110, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_half_box = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":48
- *     cdef UINT32_t d_idx_d, d_idx_h, d_idx, a_idx
- * 
- *     dist_threshold = dist_threshold * dist_threshold             # <<<<<<<<<<<<<<
- *     angle_threshold = angle_threshold / 57.29578
- * 
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":111
+ *     cdef FLOAT32_t[:] ring_normal = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] cation_coor = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
+ *     cdef FLOAT32_t[:] tmp1 = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] tmp2 = np.zeros(3, dtype=FLOAT32)
  */
-  __pyx_v_dist_threshold = (__pyx_v_dist_threshold * __pyx_v_dist_threshold);
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 111, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 111, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 111, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 111, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 111, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__11, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 111, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 111, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_v_cation_coor = __pyx_t_5;
+  __pyx_t_5.memview = NULL;
+  __pyx_t_5.data = NULL;
+
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":112
+ *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] cation_coor = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] tmp1 = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
+ *     cdef FLOAT32_t[:] tmp2 = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t dist2, dot_prod
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 112, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 112, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 112, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 112, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 112, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__11, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 112, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 112, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_v_tmp1 = __pyx_t_5;
+  __pyx_t_5.memview = NULL;
+  __pyx_t_5.data = NULL;
+
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":113
+ *     cdef FLOAT32_t[:] cation_coor = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] tmp1 = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] tmp2 = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
+ *     cdef FLOAT32_t dist2, dot_prod
+ *     cdef int r_start_idx, r_end_idx
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 113, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 113, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 113, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 113, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 113, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__11, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 113, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 113, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_v_tmp2 = __pyx_t_5;
+  __pyx_t_5.memview = NULL;
+  __pyx_t_5.data = NULL;
 
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":49
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":117
+ *     cdef int r_start_idx, r_end_idx
  * 
- *     dist_threshold = dist_threshold * dist_threshold
- *     angle_threshold = angle_threshold / 57.29578             # <<<<<<<<<<<<<<
+ *     dist_threshold = dist_threshold * dist_threshold             # <<<<<<<<<<<<<<
  * 
  *     for f in range(n_frames):
  */
-  __pyx_v_angle_threshold = (((double)__pyx_v_angle_threshold) / 57.29578);
+  __pyx_v_dist_threshold = (__pyx_v_dist_threshold * __pyx_v_dist_threshold);
 
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":51
- *     angle_threshold = angle_threshold / 57.29578
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":119
+ *     dist_threshold = dist_threshold * dist_threshold
  * 
  *     for f in range(n_frames):             # <<<<<<<<<<<<<<
  *         results.push_back(vector[int]())
- *         for i in range(3):
+ *         distangles.push_back(vector[float]())
  */
   __pyx_t_6 = __pyx_v_n_frames;
   __pyx_t_7 = __pyx_t_6;
   for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
     __pyx_v_f = __pyx_t_8;
 
-    /* "moleculekit/interactions/hbonds/hbonds.pyx":52
+    /* "moleculekit/interactions/cationpi/cationpi.pyx":120
  * 
  *     for f in range(n_frames):
  *         results.push_back(vector[int]())             # <<<<<<<<<<<<<<
+ *         distangles.push_back(vector[float]())
  *         for i in range(3):
- *             half_box[i] = box[i, f] / 2
  */
     try {
       __pyx_t_9 = std::vector<int> ();
     } catch(...) {
       __Pyx_CppExn2PyErr();
-      __PYX_ERR(0, 52, __pyx_L1_error)
+      __PYX_ERR(0, 120, __pyx_L1_error)
     }
     try {
       __pyx_v_results.push_back(__pyx_t_9);
     } catch(...) {
       __Pyx_CppExn2PyErr();
-      __PYX_ERR(0, 52, __pyx_L1_error)
+      __PYX_ERR(0, 120, __pyx_L1_error)
     }
 
-    /* "moleculekit/interactions/hbonds/hbonds.pyx":53
+    /* "moleculekit/interactions/cationpi/cationpi.pyx":121
  *     for f in range(n_frames):
  *         results.push_back(vector[int]())
+ *         distangles.push_back(vector[float]())             # <<<<<<<<<<<<<<
+ *         for i in range(3):
+ *             half_box[i] = box[i, f] / 2
+ */
+    try {
+      __pyx_t_10 = std::vector<float> ();
+    } catch(...) {
+      __Pyx_CppExn2PyErr();
+      __PYX_ERR(0, 121, __pyx_L1_error)
+    }
+    try {
+      __pyx_v_distangles.push_back(__pyx_t_10);
+    } catch(...) {
+      __Pyx_CppExn2PyErr();
+      __PYX_ERR(0, 121, __pyx_L1_error)
+    }
+
+    /* "moleculekit/interactions/cationpi/cationpi.pyx":122
+ *         results.push_back(vector[int]())
+ *         distangles.push_back(vector[float]())
  *         for i in range(3):             # <<<<<<<<<<<<<<
  *             half_box[i] = box[i, f] / 2
  * 
  */
-    for (__pyx_t_10 = 0; __pyx_t_10 < 3; __pyx_t_10+=1) {
-      __pyx_v_i = __pyx_t_10;
+    for (__pyx_t_11 = 0; __pyx_t_11 < 3; __pyx_t_11+=1) {
+      __pyx_v_i = __pyx_t_11;
 
-      /* "moleculekit/interactions/hbonds/hbonds.pyx":54
- *         results.push_back(vector[int]())
+      /* "moleculekit/interactions/cationpi/cationpi.pyx":123
+ *         distangles.push_back(vector[float]())
  *         for i in range(3):
  *             half_box[i] = box[i, f] / 2             # <<<<<<<<<<<<<<
  * 
- *         for d in range(n_donors):
+ *         for r1 in range(n_rings):
  */
-      __pyx_t_11 = __pyx_v_i;
-      __pyx_t_12 = __pyx_v_f;
-      __pyx_t_13 = __pyx_v_i;
-      *((__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_half_box.data + __pyx_t_13 * __pyx_v_half_box.strides[0]) )) = ((*__Pyx_BufPtrStrided2d(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_box.diminfo[1].strides)) / 2.0);
+      __pyx_t_12 = __pyx_v_i;
+      __pyx_t_13 = __pyx_v_f;
+      __pyx_t_14 = __pyx_v_i;
+      *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_half_box.data + __pyx_t_14 * __pyx_v_half_box.strides[0]) )) = ((*__Pyx_BufPtrStrided2d(__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_box.diminfo[1].strides)) / 2.0);
     }
 
-    /* "moleculekit/interactions/hbonds/hbonds.pyx":56
+    /* "moleculekit/interactions/cationpi/cationpi.pyx":125
  *             half_box[i] = box[i, f] / 2
  * 
- *         for d in range(n_donors):             # <<<<<<<<<<<<<<
- *             for a in range(n_acceptors):
- *                 a_idx = acceptors[a]
- */
-    __pyx_t_10 = __pyx_v_n_donors;
-    __pyx_t_14 = __pyx_t_10;
-    for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
-      __pyx_v_d = __pyx_t_15;
-
-      /* "moleculekit/interactions/hbonds/hbonds.pyx":57
- * 
- *         for d in range(n_donors):
- *             for a in range(n_acceptors):             # <<<<<<<<<<<<<<
- *                 a_idx = acceptors[a]
- *                 d_idx_d = donors[d, 0]
- */
-      __pyx_t_16 = __pyx_v_n_acceptors;
-      __pyx_t_17 = __pyx_t_16;
-      for (__pyx_t_18 = 0; __pyx_t_18 < __pyx_t_17; __pyx_t_18+=1) {
-        __pyx_v_a = __pyx_t_18;
-
-        /* "moleculekit/interactions/hbonds/hbonds.pyx":58
- *         for d in range(n_donors):
- *             for a in range(n_acceptors):
- *                 a_idx = acceptors[a]             # <<<<<<<<<<<<<<
- *                 d_idx_d = donors[d, 0]
- *                 d_idx_h = donors[d, 1]
- */
-        __pyx_t_12 = __pyx_v_a;
-        __pyx_v_a_idx = (*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t *, __pyx_pybuffernd_acceptors.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_acceptors.diminfo[0].strides));
-
-        /* "moleculekit/interactions/hbonds/hbonds.pyx":59
- *             for a in range(n_acceptors):
- *                 a_idx = acceptors[a]
- *                 d_idx_d = donors[d, 0]             # <<<<<<<<<<<<<<
- *                 d_idx_h = donors[d, 1]
- * 
- */
-        __pyx_t_12 = __pyx_v_d;
-        __pyx_t_11 = 0;
-        __pyx_v_d_idx_d = (*__Pyx_BufPtrStrided2d(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t *, __pyx_pybuffernd_donors.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_donors.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_donors.diminfo[1].strides));
-
-        /* "moleculekit/interactions/hbonds/hbonds.pyx":60
- *                 a_idx = acceptors[a]
- *                 d_idx_d = donors[d, 0]
- *                 d_idx_h = donors[d, 1]             # <<<<<<<<<<<<<<
- * 
- *                 # Don't calculate h-bonds with identical donor-acceptor atom
- */
-        __pyx_t_11 = __pyx_v_d;
-        __pyx_t_12 = 1;
-        __pyx_v_d_idx_h = (*__Pyx_BufPtrStrided2d(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t *, __pyx_pybuffernd_donors.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_donors.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_donors.diminfo[1].strides));
-
-        /* "moleculekit/interactions/hbonds/hbonds.pyx":63
- * 
- *                 # Don't calculate h-bonds with identical donor-acceptor atom
- *                 if a_idx == d_idx_d:             # <<<<<<<<<<<<<<
- *                     continue
- * 
+ *         for r1 in range(n_rings):             # <<<<<<<<<<<<<<
+ *             for r2 in range(n_cations):
+ *                 r_start_idx = rings_start_indexes[r1]
  */
-        __pyx_t_19 = (__pyx_v_a_idx == __pyx_v_d_idx_d);
-        if (__pyx_t_19) {
+    __pyx_t_11 = __pyx_v_n_rings;
+    __pyx_t_15 = __pyx_t_11;
+    for (__pyx_t_16 = 0; __pyx_t_16 < __pyx_t_15; __pyx_t_16+=1) {
+      __pyx_v_r1 = __pyx_t_16;
 
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":64
- *                 # Don't calculate h-bonds with identical donor-acceptor atom
- *                 if a_idx == d_idx_d:
- *                     continue             # <<<<<<<<<<<<<<
+      /* "moleculekit/interactions/cationpi/cationpi.pyx":126
  * 
- *                 if intra:
+ *         for r1 in range(n_rings):
+ *             for r2 in range(n_cations):             # <<<<<<<<<<<<<<
+ *                 r_start_idx = rings_start_indexes[r1]
+ *                 r_end_idx = rings_start_indexes[r1+1]
  */
-          goto __pyx_L9_continue;
+      __pyx_t_17 = __pyx_v_n_cations;
+      __pyx_t_18 = __pyx_t_17;
+      for (__pyx_t_19 = 0; __pyx_t_19 < __pyx_t_18; __pyx_t_19+=1) {
+        __pyx_v_r2 = __pyx_t_19;
 
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":63
- * 
- *                 # Don't calculate h-bonds with identical donor-acceptor atom
- *                 if a_idx == d_idx_d:             # <<<<<<<<<<<<<<
- *                     continue
+        /* "moleculekit/interactions/cationpi/cationpi.pyx":127
+ *         for r1 in range(n_rings):
+ *             for r2 in range(n_cations):
+ *                 r_start_idx = rings_start_indexes[r1]             # <<<<<<<<<<<<<<
+ *                 r_end_idx = rings_start_indexes[r1+1]
  * 
  */
-        }
+        __pyx_t_13 = __pyx_v_r1;
+        __pyx_v_r_start_idx = (*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t *, __pyx_pybuffernd_rings_start_indexes.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_rings_start_indexes.diminfo[0].strides));
 
-        /* "moleculekit/interactions/hbonds/hbonds.pyx":66
- *                     continue
+        /* "moleculekit/interactions/cationpi/cationpi.pyx":128
+ *             for r2 in range(n_cations):
+ *                 r_start_idx = rings_start_indexes[r1]
+ *                 r_end_idx = rings_start_indexes[r1+1]             # <<<<<<<<<<<<<<
  * 
- *                 if intra:             # <<<<<<<<<<<<<<
- *                     # Both donor and acceptors must be selected
- *                     if sel1[a_idx] == 0 or sel1[d_idx_d] == 0:
- */
-        __pyx_t_19 = (__pyx_v_intra != 0);
-        if (__pyx_t_19) {
-
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":68
- *                 if intra:
- *                     # Both donor and acceptors must be selected
- *                     if sel1[a_idx] == 0 or sel1[d_idx_d] == 0:             # <<<<<<<<<<<<<<
- *                         continue
- *                 else:
- */
-          __pyx_t_20 = __pyx_v_a_idx;
-          __pyx_t_21 = ((*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t *, __pyx_pybuffernd_sel1.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_sel1.diminfo[0].strides)) == 0);
-          if (!__pyx_t_21) {
-          } else {
-            __pyx_t_19 = __pyx_t_21;
-            goto __pyx_L14_bool_binop_done;
-          }
-          __pyx_t_20 = __pyx_v_d_idx_d;
-          __pyx_t_21 = ((*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t *, __pyx_pybuffernd_sel1.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_sel1.diminfo[0].strides)) == 0);
-          __pyx_t_19 = __pyx_t_21;
-          __pyx_L14_bool_binop_done:;
-          if (__pyx_t_19) {
-
-            /* "moleculekit/interactions/hbonds/hbonds.pyx":69
- *                     # Both donor and acceptors must be selected
- *                     if sel1[a_idx] == 0 or sel1[d_idx_d] == 0:
- *                         continue             # <<<<<<<<<<<<<<
- *                 else:
- *                     # Donor and acceptor must belong to different selections
+ *                 # Calculate the ring centroid
  */
-            goto __pyx_L9_continue;
-
-            /* "moleculekit/interactions/hbonds/hbonds.pyx":68
- *                 if intra:
- *                     # Both donor and acceptors must be selected
- *                     if sel1[a_idx] == 0 or sel1[d_idx_d] == 0:             # <<<<<<<<<<<<<<
- *                         continue
- *                 else:
- */
-          }
+        __pyx_t_13 = (__pyx_v_r1 + 1);
+        __pyx_v_r_end_idx = (*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t *, __pyx_pybuffernd_rings_start_indexes.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_rings_start_indexes.diminfo[0].strides));
 
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":66
- *                     continue
+        /* "moleculekit/interactions/cationpi/cationpi.pyx":131
  * 
- *                 if intra:             # <<<<<<<<<<<<<<
- *                     # Both donor and acceptors must be selected
- *                     if sel1[a_idx] == 0 or sel1[d_idx_d] == 0:
- */
-          goto __pyx_L12;
-        }
-
-        /* "moleculekit/interactions/hbonds/hbonds.pyx":72
- *                 else:
- *                     # Donor and acceptor must belong to different selections
- *                     if not ((sel1[a_idx] == 1 and sel2[d_idx_d] == 1) or (sel2[a_idx] == 1 and sel1[d_idx_d] == 1)):             # <<<<<<<<<<<<<<
- *                         continue
+ *                 # Calculate the ring centroid
+ *                 _calculate_ring_mean(f, r_start_idx, r_end_idx, rings_atoms, coords, ring_mean)             # <<<<<<<<<<<<<<
  * 
+ *                 # Cation coordinates
  */
-        /*else*/ {
-          __pyx_t_20 = __pyx_v_a_idx;
-          __pyx_t_21 = ((*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t *, __pyx_pybuffernd_sel1.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_sel1.diminfo[0].strides)) == 1);
-          if (!__pyx_t_21) {
-            goto __pyx_L18_next_or;
-          } else {
-          }
-          __pyx_t_20 = __pyx_v_d_idx_d;
-          __pyx_t_21 = ((*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t *, __pyx_pybuffernd_sel2.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_sel2.diminfo[0].strides)) == 1);
-          if (!__pyx_t_21) {
-          } else {
-            __pyx_t_19 = __pyx_t_21;
-            goto __pyx_L17_bool_binop_done;
-          }
-          __pyx_L18_next_or:;
-          __pyx_t_20 = __pyx_v_a_idx;
-          __pyx_t_21 = ((*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t *, __pyx_pybuffernd_sel2.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_sel2.diminfo[0].strides)) == 1);
-          if (__pyx_t_21) {
-          } else {
-            __pyx_t_19 = __pyx_t_21;
-            goto __pyx_L17_bool_binop_done;
-          }
-          __pyx_t_20 = __pyx_v_d_idx_d;
-          __pyx_t_21 = ((*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t *, __pyx_pybuffernd_sel1.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_sel1.diminfo[0].strides)) == 1);
-          __pyx_t_19 = __pyx_t_21;
-          __pyx_L17_bool_binop_done:;
-          __pyx_t_21 = (!__pyx_t_19);
-          if (__pyx_t_21) {
-
-            /* "moleculekit/interactions/hbonds/hbonds.pyx":73
- *                     # Donor and acceptor must belong to different selections
- *                     if not ((sel1[a_idx] == 1 and sel2[d_idx_d] == 1) or (sel2[a_idx] == 1 and sel1[d_idx_d] == 1)):
- *                         continue             # <<<<<<<<<<<<<<
- * 
- *                 dist2_a = 0
- */
-            goto __pyx_L9_continue;
-
-            /* "moleculekit/interactions/hbonds/hbonds.pyx":72
- *                 else:
- *                     # Donor and acceptor must belong to different selections
- *                     if not ((sel1[a_idx] == 1 and sel2[d_idx_d] == 1) or (sel2[a_idx] == 1 and sel1[d_idx_d] == 1)):             # <<<<<<<<<<<<<<
- *                         continue
- * 
- */
-          }
-        }
-        __pyx_L12:;
+        __pyx_t_20 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t(((PyObject *)__pyx_v_rings_atoms), PyBUF_WRITABLE); if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(0, 131, __pyx_L1_error)
+        __pyx_t_21 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(((PyObject *)__pyx_v_coords), PyBUF_WRITABLE); if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 131, __pyx_L1_error)
+        __pyx_f_11moleculekit_12interactions_8cationpi__calculate_ring_mean(__pyx_v_f, __pyx_v_r_start_idx, __pyx_v_r_end_idx, __pyx_t_20, __pyx_t_21, __pyx_v_ring_mean); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 131, __pyx_L1_error)
+        __PYX_XCLEAR_MEMVIEW(&__pyx_t_20, 1);
+        __pyx_t_20.memview = NULL; __pyx_t_20.data = NULL;
+        __PYX_XCLEAR_MEMVIEW(&__pyx_t_21, 1);
+        __pyx_t_21.memview = NULL; __pyx_t_21.data = NULL;
 
-        /* "moleculekit/interactions/hbonds/hbonds.pyx":75
- *                         continue
+        /* "moleculekit/interactions/cationpi/cationpi.pyx":134
  * 
- *                 dist2_a = 0             # <<<<<<<<<<<<<<
- *                 dist2_b = 0
- *                 d_idx = d_idx_h
- */
-        __pyx_v_dist2_a = 0.0;
-
-        /* "moleculekit/interactions/hbonds/hbonds.pyx":76
- * 
- *                 dist2_a = 0
- *                 dist2_b = 0             # <<<<<<<<<<<<<<
- *                 d_idx = d_idx_h
- *                 if ignore_hs: # If we ignore the hydrogen just calculate heavy to heavy distance
- */
-        __pyx_v_dist2_b = 0.0;
-
-        /* "moleculekit/interactions/hbonds/hbonds.pyx":77
- *                 dist2_a = 0
- *                 dist2_b = 0
- *                 d_idx = d_idx_h             # <<<<<<<<<<<<<<
- *                 if ignore_hs: # If we ignore the hydrogen just calculate heavy to heavy distance
- *                     d_idx = d_idx_d
- */
-        __pyx_v_d_idx = __pyx_v_d_idx_h;
-
-        /* "moleculekit/interactions/hbonds/hbonds.pyx":78
- *                 dist2_b = 0
- *                 d_idx = d_idx_h
- *                 if ignore_hs: # If we ignore the hydrogen just calculate heavy to heavy distance             # <<<<<<<<<<<<<<
- *                     d_idx = d_idx_d
- *                 # Calculate donor hydrogen (or heavy if ignore_hs) to acceptor vector
- */
-        __pyx_t_21 = (__pyx_v_ignore_hs != 0);
-        if (__pyx_t_21) {
-
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":79
- *                 d_idx = d_idx_h
- *                 if ignore_hs: # If we ignore the hydrogen just calculate heavy to heavy distance
- *                     d_idx = d_idx_d             # <<<<<<<<<<<<<<
- *                 # Calculate donor hydrogen (or heavy if ignore_hs) to acceptor vector
- *                 for i in range(3):
- */
-          __pyx_v_d_idx = __pyx_v_d_idx_d;
-
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":78
- *                 dist2_b = 0
- *                 d_idx = d_idx_h
- *                 if ignore_hs: # If we ignore the hydrogen just calculate heavy to heavy distance             # <<<<<<<<<<<<<<
- *                     d_idx = d_idx_d
- *                 # Calculate donor hydrogen (or heavy if ignore_hs) to acceptor vector
- */
-        }
-
-        /* "moleculekit/interactions/hbonds/hbonds.pyx":81
- *                     d_idx = d_idx_d
- *                 # Calculate donor hydrogen (or heavy if ignore_hs) to acceptor vector
+ *                 # Cation coordinates
  *                 for i in range(3):             # <<<<<<<<<<<<<<
- *                     val = coords[a_idx, i, f] - coords[d_idx, i, f]
- *                     # Wrap the distance vector into the periodic box
+ *                     cation_coor[i] = coords[cations[r2], i, f]
+ * 
  */
         for (__pyx_t_22 = 0; __pyx_t_22 < 3; __pyx_t_22+=1) {
           __pyx_v_i = __pyx_t_22;
 
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":82
- *                 # Calculate donor hydrogen (or heavy if ignore_hs) to acceptor vector
+          /* "moleculekit/interactions/cationpi/cationpi.pyx":135
+ *                 # Cation coordinates
  *                 for i in range(3):
- *                     val = coords[a_idx, i, f] - coords[d_idx, i, f]             # <<<<<<<<<<<<<<
- *                     # Wrap the distance vector into the periodic box
- *                     if abs(val) > half_box[i] and box[i, f] != 0:
+ *                     cation_coor[i] = coords[cations[r2], i, f]             # <<<<<<<<<<<<<<
+ * 
+ *                 # Calculate the wrapped distance between the ring centroid and the cation
  */
-          __pyx_t_20 = __pyx_v_a_idx;
+          __pyx_t_13 = __pyx_v_r2;
+          __pyx_t_23 = (*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t *, __pyx_pybuffernd_cations.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_cations.diminfo[0].strides));
           __pyx_t_12 = __pyx_v_i;
-          __pyx_t_11 = __pyx_v_f;
-          __pyx_t_23 = __pyx_v_d_idx;
-          __pyx_t_13 = __pyx_v_i;
-          __pyx_t_24 = __pyx_v_f;
-          __pyx_v_val = ((*__Pyx_BufPtrStrided3d(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *, __pyx_pybuffernd_coords.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_coords.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_coords.diminfo[1].strides, __pyx_t_11, __pyx_pybuffernd_coords.diminfo[2].strides)) - (*__Pyx_BufPtrStrided3d(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *, __pyx_pybuffernd_coords.rcbuffer->pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_coords.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_coords.diminfo[1].strides, __pyx_t_24, __pyx_pybuffernd_coords.diminfo[2].strides)));
-
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":84
- *                     val = coords[a_idx, i, f] - coords[d_idx, i, f]
- *                     # Wrap the distance vector into the periodic box
- *                     if abs(val) > half_box[i] and box[i, f] != 0:             # <<<<<<<<<<<<<<
- *                         val = val - box[i, f] * round(val / box[i, f])
- *                     dist_vec_a[i] = val
- */
-          __pyx_t_24 = __pyx_v_i;
-          __pyx_t_19 = (fabsf(__pyx_v_val) > (*((__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_half_box.data + __pyx_t_24 * __pyx_v_half_box.strides[0]) ))));
-          if (__pyx_t_19) {
-          } else {
-            __pyx_t_21 = __pyx_t_19;
-            goto __pyx_L25_bool_binop_done;
-          }
+          __pyx_t_14 = __pyx_v_f;
           __pyx_t_24 = __pyx_v_i;
-          __pyx_t_13 = __pyx_v_f;
-          __pyx_t_19 = ((*__Pyx_BufPtrStrided2d(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_box.diminfo[1].strides)) != 0.0);
-          __pyx_t_21 = __pyx_t_19;
-          __pyx_L25_bool_binop_done:;
-          if (__pyx_t_21) {
-
-            /* "moleculekit/interactions/hbonds/hbonds.pyx":85
- *                     # Wrap the distance vector into the periodic box
- *                     if abs(val) > half_box[i] and box[i, f] != 0:
- *                         val = val - box[i, f] * round(val / box[i, f])             # <<<<<<<<<<<<<<
- *                     dist_vec_a[i] = val
- *                     dist2_a = dist2_a + (val * val)
- */
-            __pyx_t_13 = __pyx_v_i;
-            __pyx_t_24 = __pyx_v_f;
-            __pyx_t_11 = __pyx_v_i;
-            __pyx_t_12 = __pyx_v_f;
-            __pyx_v_val = (__pyx_v_val - ((*__Pyx_BufPtrStrided2d(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_24, __pyx_pybuffernd_box.diminfo[1].strides)) * round((__pyx_v_val / (*__Pyx_BufPtrStrided2d(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_box.diminfo[1].strides))))));
-
-            /* "moleculekit/interactions/hbonds/hbonds.pyx":84
- *                     val = coords[a_idx, i, f] - coords[d_idx, i, f]
- *                     # Wrap the distance vector into the periodic box
- *                     if abs(val) > half_box[i] and box[i, f] != 0:             # <<<<<<<<<<<<<<
- *                         val = val - box[i, f] * round(val / box[i, f])
- *                     dist_vec_a[i] = val
- */
-          }
+          *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_cation_coor.data + __pyx_t_24 * __pyx_v_cation_coor.strides[0]) )) = (*__Pyx_BufPtrStrided3d(__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *, __pyx_pybuffernd_coords.rcbuffer->pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_coords.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_coords.diminfo[1].strides, __pyx_t_14, __pyx_pybuffernd_coords.diminfo[2].strides));
+        }
 
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":86
- *                     if abs(val) > half_box[i] and box[i, f] != 0:
- *                         val = val - box[i, f] * round(val / box[i, f])
- *                     dist_vec_a[i] = val             # <<<<<<<<<<<<<<
- *                     dist2_a = dist2_a + (val * val)
+        /* "moleculekit/interactions/cationpi/cationpi.pyx":138
  * 
- */
-          __pyx_t_12 = __pyx_v_i;
-          *((__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_dist_vec_a.data + __pyx_t_12 * __pyx_v_dist_vec_a.strides[0]) )) = __pyx_v_val;
-
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":87
- *                         val = val - box[i, f] * round(val / box[i, f])
- *                     dist_vec_a[i] = val
- *                     dist2_a = dist2_a + (val * val)             # <<<<<<<<<<<<<<
+ *                 # Calculate the wrapped distance between the ring centroid and the cation
+ *                 dist2 = _wrapped_dist(f, ring_mean, cation_coor, half_box, box)             # <<<<<<<<<<<<<<
  * 
- *                 # Donor hydrogen too far from acceptor
+ *                 # Ring centroid too far apart from cation
  */
-          __pyx_v_dist2_a = (__pyx_v_dist2_a + (__pyx_v_val * __pyx_v_val));
-        }
+        __pyx_t_25 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(((PyObject *)__pyx_v_box), PyBUF_WRITABLE); if (unlikely(!__pyx_t_25.memview)) __PYX_ERR(0, 138, __pyx_L1_error)
+        __pyx_t_26 = __pyx_f_11moleculekit_12interactions_8cationpi__wrapped_dist(__pyx_v_f, __pyx_v_ring_mean, __pyx_v_cation_coor, __pyx_v_half_box, __pyx_t_25); if (unlikely(__pyx_t_26 == ((float)-1) && PyErr_Occurred())) __PYX_ERR(0, 138, __pyx_L1_error)
+        __PYX_XCLEAR_MEMVIEW(&__pyx_t_25, 1);
+        __pyx_t_25.memview = NULL; __pyx_t_25.data = NULL;
+        __pyx_v_dist2 = __pyx_t_26;
 
-        /* "moleculekit/interactions/hbonds/hbonds.pyx":90
+        /* "moleculekit/interactions/cationpi/cationpi.pyx":141
  * 
- *                 # Donor hydrogen too far from acceptor
- *                 if dist2_a > dist_threshold:             # <<<<<<<<<<<<<<
+ *                 # Ring centroid too far apart from cation
+ *                 if dist2 > dist_threshold:             # <<<<<<<<<<<<<<
  *                     continue
  * 
  */
-        __pyx_t_21 = (__pyx_v_dist2_a > __pyx_v_dist_threshold);
-        if (__pyx_t_21) {
+        __pyx_t_27 = (__pyx_v_dist2 > __pyx_v_dist_threshold);
+        if (__pyx_t_27) {
 
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":91
- *                 # Donor hydrogen too far from acceptor
- *                 if dist2_a > dist_threshold:
+          /* "moleculekit/interactions/cationpi/cationpi.pyx":142
+ *                 # Ring centroid too far apart from cation
+ *                 if dist2 > dist_threshold:
  *                     continue             # <<<<<<<<<<<<<<
  * 
- *                 # If we ignore the hydrogens skip the angle part. We have found a match already
+ *                 # Calculate the plane normal
  */
           goto __pyx_L9_continue;
 
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":90
+          /* "moleculekit/interactions/cationpi/cationpi.pyx":141
  * 
- *                 # Donor hydrogen too far from acceptor
- *                 if dist2_a > dist_threshold:             # <<<<<<<<<<<<<<
+ *                 # Ring centroid too far apart from cation
+ *                 if dist2 > dist_threshold:             # <<<<<<<<<<<<<<
  *                     continue
  * 
  */
         }
 
-        /* "moleculekit/interactions/hbonds/hbonds.pyx":94
- * 
- *                 # If we ignore the hydrogens skip the angle part. We have found a match already
- *                 if ignore_hs:             # <<<<<<<<<<<<<<
- *                     results[f].push_back(d_idx_d)
- *                     results[f].push_back(-1)  # No hydrogen to add here
- */
-        __pyx_t_21 = (__pyx_v_ignore_hs != 0);
-        if (__pyx_t_21) {
-
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":95
- *                 # If we ignore the hydrogens skip the angle part. We have found a match already
- *                 if ignore_hs:
- *                     results[f].push_back(d_idx_d)             # <<<<<<<<<<<<<<
- *                     results[f].push_back(-1)  # No hydrogen to add here
- *                     results[f].push_back(a_idx)
- */
-          try {
-            (__pyx_v_results[__pyx_v_f]).push_back(__pyx_v_d_idx_d);
-          } catch(...) {
-            __Pyx_CppExn2PyErr();
-            __PYX_ERR(0, 95, __pyx_L1_error)
-          }
-
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":96
- *                 if ignore_hs:
- *                     results[f].push_back(d_idx_d)
- *                     results[f].push_back(-1)  # No hydrogen to add here             # <<<<<<<<<<<<<<
- *                     results[f].push_back(a_idx)
- *                     continue
+        /* "moleculekit/interactions/cationpi/cationpi.pyx":146
+ *                 # Calculate the plane normal
+ *                 # TODO: This is very bad for non-planar rings. I should calculate the average normal
+ *                 for i in range(3):             # <<<<<<<<<<<<<<
+ *                     tmp1[i] = coords[rings_atoms[r_start_idx], i, f] - coords[rings_atoms[r_start_idx+2], i, f]
+ *                     tmp2[i] = coords[rings_atoms[r_start_idx+1], i, f] - coords[rings_atoms[r_start_idx+2], i, f]
  */
-          try {
-            (__pyx_v_results[__pyx_v_f]).push_back(-1);
-          } catch(...) {
-            __Pyx_CppExn2PyErr();
-            __PYX_ERR(0, 96, __pyx_L1_error)
-          }
+        for (__pyx_t_22 = 0; __pyx_t_22 < 3; __pyx_t_22+=1) {
+          __pyx_v_i = __pyx_t_22;
 
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":97
- *                     results[f].push_back(d_idx_d)
- *                     results[f].push_back(-1)  # No hydrogen to add here
- *                     results[f].push_back(a_idx)             # <<<<<<<<<<<<<<
- *                     continue
- * 
- */
-          try {
-            (__pyx_v_results[__pyx_v_f]).push_back(__pyx_v_a_idx);
-          } catch(...) {
-            __Pyx_CppExn2PyErr();
-            __PYX_ERR(0, 97, __pyx_L1_error)
-          }
+          /* "moleculekit/interactions/cationpi/cationpi.pyx":147
+ *                 # TODO: This is very bad for non-planar rings. I should calculate the average normal
+ *                 for i in range(3):
+ *                     tmp1[i] = coords[rings_atoms[r_start_idx], i, f] - coords[rings_atoms[r_start_idx+2], i, f]             # <<<<<<<<<<<<<<
+ *                     tmp2[i] = coords[rings_atoms[r_start_idx+1], i, f] - coords[rings_atoms[r_start_idx+2], i, f]
+ *                 _cross_product(tmp1, tmp2, ring_normal)
+ */
+          __pyx_t_13 = __pyx_v_r_start_idx;
+          __pyx_t_23 = (*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t *, __pyx_pybuffernd_rings_atoms.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_rings_atoms.diminfo[0].strides));
+          __pyx_t_14 = __pyx_v_i;
+          __pyx_t_12 = __pyx_v_f;
+          __pyx_t_24 = (__pyx_v_r_start_idx + 2);
+          __pyx_t_28 = (*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t *, __pyx_pybuffernd_rings_atoms.rcbuffer->pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_rings_atoms.diminfo[0].strides));
+          __pyx_t_29 = __pyx_v_i;
+          __pyx_t_30 = __pyx_v_f;
+          __pyx_t_31 = __pyx_v_i;
+          *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_tmp1.data + __pyx_t_31 * __pyx_v_tmp1.strides[0]) )) = ((*__Pyx_BufPtrStrided3d(__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *, __pyx_pybuffernd_coords.rcbuffer->pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_coords.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_coords.diminfo[1].strides, __pyx_t_12, __pyx_pybuffernd_coords.diminfo[2].strides)) - (*__Pyx_BufPtrStrided3d(__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *, __pyx_pybuffernd_coords.rcbuffer->pybuffer.buf, __pyx_t_28, __pyx_pybuffernd_coords.diminfo[0].strides, __pyx_t_29, __pyx_pybuffernd_coords.diminfo[1].strides, __pyx_t_30, __pyx_pybuffernd_coords.diminfo[2].strides)));
 
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":98
- *                     results[f].push_back(-1)  # No hydrogen to add here
- *                     results[f].push_back(a_idx)
- *                     continue             # <<<<<<<<<<<<<<
+          /* "moleculekit/interactions/cationpi/cationpi.pyx":148
+ *                 for i in range(3):
+ *                     tmp1[i] = coords[rings_atoms[r_start_idx], i, f] - coords[rings_atoms[r_start_idx+2], i, f]
+ *                     tmp2[i] = coords[rings_atoms[r_start_idx+1], i, f] - coords[rings_atoms[r_start_idx+2], i, f]             # <<<<<<<<<<<<<<
+ *                 _cross_product(tmp1, tmp2, ring_normal)
  * 
- *                 # Calculate donor heavy to donor hydrogen vector for the angle
  */
-          goto __pyx_L9_continue;
+          __pyx_t_24 = (__pyx_v_r_start_idx + 1);
+          __pyx_t_28 = (*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t *, __pyx_pybuffernd_rings_atoms.rcbuffer->pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_rings_atoms.diminfo[0].strides));
+          __pyx_t_30 = __pyx_v_i;
+          __pyx_t_29 = __pyx_v_f;
+          __pyx_t_13 = (__pyx_v_r_start_idx + 2);
+          __pyx_t_23 = (*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t *, __pyx_pybuffernd_rings_atoms.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_rings_atoms.diminfo[0].strides));
+          __pyx_t_12 = __pyx_v_i;
+          __pyx_t_14 = __pyx_v_f;
+          __pyx_t_31 = __pyx_v_i;
+          *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_tmp2.data + __pyx_t_31 * __pyx_v_tmp2.strides[0]) )) = ((*__Pyx_BufPtrStrided3d(__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *, __pyx_pybuffernd_coords.rcbuffer->pybuffer.buf, __pyx_t_28, __pyx_pybuffernd_coords.diminfo[0].strides, __pyx_t_30, __pyx_pybuffernd_coords.diminfo[1].strides, __pyx_t_29, __pyx_pybuffernd_coords.diminfo[2].strides)) - (*__Pyx_BufPtrStrided3d(__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *, __pyx_pybuffernd_coords.rcbuffer->pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_coords.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_coords.diminfo[1].strides, __pyx_t_14, __pyx_pybuffernd_coords.diminfo[2].strides)));
+        }
 
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":94
+        /* "moleculekit/interactions/cationpi/cationpi.pyx":149
+ *                     tmp1[i] = coords[rings_atoms[r_start_idx], i, f] - coords[rings_atoms[r_start_idx+2], i, f]
+ *                     tmp2[i] = coords[rings_atoms[r_start_idx+1], i, f] - coords[rings_atoms[r_start_idx+2], i, f]
+ *                 _cross_product(tmp1, tmp2, ring_normal)             # <<<<<<<<<<<<<<
  * 
- *                 # If we ignore the hydrogens skip the angle part. We have found a match already
- *                 if ignore_hs:             # <<<<<<<<<<<<<<
- *                     results[f].push_back(d_idx_d)
- *                     results[f].push_back(-1)  # No hydrogen to add here
+ *                 # Calculate ring-cation vector
  */
-        }
+        __pyx_f_11moleculekit_12interactions_8cationpi__cross_product(__pyx_v_tmp1, __pyx_v_tmp2, __pyx_v_ring_normal); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 149, __pyx_L1_error)
 
-        /* "moleculekit/interactions/hbonds/hbonds.pyx":101
+        /* "moleculekit/interactions/cationpi/cationpi.pyx":152
  * 
- *                 # Calculate donor heavy to donor hydrogen vector for the angle
+ *                 # Calculate ring-cation vector
  *                 for i in range(3):             # <<<<<<<<<<<<<<
- *                     val = coords[d_idx_d, i, f] - coords[d_idx_h, i, f]
- *                     # Wrap the distance vector into the periodic box
+ *                     tmp1[i] = cation_coor[i] - ring_mean[i]
+ *                 _normalize(tmp1)
  */
         for (__pyx_t_22 = 0; __pyx_t_22 < 3; __pyx_t_22+=1) {
           __pyx_v_i = __pyx_t_22;
 
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":102
- *                 # Calculate donor heavy to donor hydrogen vector for the angle
+          /* "moleculekit/interactions/cationpi/cationpi.pyx":153
+ *                 # Calculate ring-cation vector
  *                 for i in range(3):
- *                     val = coords[d_idx_d, i, f] - coords[d_idx_h, i, f]             # <<<<<<<<<<<<<<
- *                     # Wrap the distance vector into the periodic box
- *                     if abs(val) > half_box[i] and box[i, f] != 0:
- */
-          __pyx_t_23 = __pyx_v_d_idx_d;
-          __pyx_t_12 = __pyx_v_i;
-          __pyx_t_11 = __pyx_v_f;
-          __pyx_t_20 = __pyx_v_d_idx_h;
-          __pyx_t_24 = __pyx_v_i;
-          __pyx_t_13 = __pyx_v_f;
-          __pyx_v_val = ((*__Pyx_BufPtrStrided3d(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *, __pyx_pybuffernd_coords.rcbuffer->pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_coords.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_coords.diminfo[1].strides, __pyx_t_11, __pyx_pybuffernd_coords.diminfo[2].strides)) - (*__Pyx_BufPtrStrided3d(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *, __pyx_pybuffernd_coords.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_coords.diminfo[0].strides, __pyx_t_24, __pyx_pybuffernd_coords.diminfo[1].strides, __pyx_t_13, __pyx_pybuffernd_coords.diminfo[2].strides)));
-
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":104
- *                     val = coords[d_idx_d, i, f] - coords[d_idx_h, i, f]
- *                     # Wrap the distance vector into the periodic box
- *                     if abs(val) > half_box[i] and box[i, f] != 0:             # <<<<<<<<<<<<<<
- *                         val = val - box[i, f] * round(val / box[i, f])
- *                     dist_vec_b[i] = val
- */
-          __pyx_t_13 = __pyx_v_i;
-          __pyx_t_19 = (fabsf(__pyx_v_val) > (*((__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_half_box.data + __pyx_t_13 * __pyx_v_half_box.strides[0]) ))));
-          if (__pyx_t_19) {
-          } else {
-            __pyx_t_21 = __pyx_t_19;
-            goto __pyx_L32_bool_binop_done;
-          }
-          __pyx_t_13 = __pyx_v_i;
-          __pyx_t_24 = __pyx_v_f;
-          __pyx_t_19 = ((*__Pyx_BufPtrStrided2d(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_24, __pyx_pybuffernd_box.diminfo[1].strides)) != 0.0);
-          __pyx_t_21 = __pyx_t_19;
-          __pyx_L32_bool_binop_done:;
-          if (__pyx_t_21) {
-
-            /* "moleculekit/interactions/hbonds/hbonds.pyx":105
- *                     # Wrap the distance vector into the periodic box
- *                     if abs(val) > half_box[i] and box[i, f] != 0:
- *                         val = val - box[i, f] * round(val / box[i, f])             # <<<<<<<<<<<<<<
- *                     dist_vec_b[i] = val
- *                     dist2_b = dist2_b + (val * val)
- */
-            __pyx_t_24 = __pyx_v_i;
-            __pyx_t_13 = __pyx_v_f;
-            __pyx_t_11 = __pyx_v_i;
-            __pyx_t_12 = __pyx_v_f;
-            __pyx_v_val = (__pyx_v_val - ((*__Pyx_BufPtrStrided2d(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_box.diminfo[1].strides)) * round((__pyx_v_val / (*__Pyx_BufPtrStrided2d(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_box.diminfo[1].strides))))));
-
-            /* "moleculekit/interactions/hbonds/hbonds.pyx":104
- *                     val = coords[d_idx_d, i, f] - coords[d_idx_h, i, f]
- *                     # Wrap the distance vector into the periodic box
- *                     if abs(val) > half_box[i] and box[i, f] != 0:             # <<<<<<<<<<<<<<
- *                         val = val - box[i, f] * round(val / box[i, f])
- *                     dist_vec_b[i] = val
- */
-          }
-
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":106
- *                     if abs(val) > half_box[i] and box[i, f] != 0:
- *                         val = val - box[i, f] * round(val / box[i, f])
- *                     dist_vec_b[i] = val             # <<<<<<<<<<<<<<
- *                     dist2_b = dist2_b + (val * val)
+ *                     tmp1[i] = cation_coor[i] - ring_mean[i]             # <<<<<<<<<<<<<<
+ *                 _normalize(tmp1)
  * 
  */
+          __pyx_t_13 = __pyx_v_i;
+          __pyx_t_14 = __pyx_v_i;
           __pyx_t_12 = __pyx_v_i;
-          *((__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_dist_vec_b.data + __pyx_t_12 * __pyx_v_dist_vec_b.strides[0]) )) = __pyx_v_val;
-
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":107
- *                         val = val - box[i, f] * round(val / box[i, f])
- *                     dist_vec_b[i] = val
- *                     dist2_b = dist2_b + (val * val)             # <<<<<<<<<<<<<<
- * 
- *                 # Overlapping atoms? Weird case but best exit
- */
-          __pyx_v_dist2_b = (__pyx_v_dist2_b + (__pyx_v_val * __pyx_v_val));
+          *((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_tmp1.data + __pyx_t_12 * __pyx_v_tmp1.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_cation_coor.data + __pyx_t_13 * __pyx_v_cation_coor.strides[0]) ))) - (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_mean.data + __pyx_t_14 * __pyx_v_ring_mean.strides[0]) ))));
         }
 
-        /* "moleculekit/interactions/hbonds/hbonds.pyx":110
- * 
- *                 # Overlapping atoms? Weird case but best exit
- *                 if dist2_a == 0 or dist2_b == 0:             # <<<<<<<<<<<<<<
- *                     continue
- * 
- */
-        __pyx_t_19 = (__pyx_v_dist2_a == 0.0);
-        if (!__pyx_t_19) {
-        } else {
-          __pyx_t_21 = __pyx_t_19;
-          goto __pyx_L35_bool_binop_done;
-        }
-        __pyx_t_19 = (__pyx_v_dist2_b == 0.0);
-        __pyx_t_21 = __pyx_t_19;
-        __pyx_L35_bool_binop_done:;
-        if (__pyx_t_21) {
-
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":111
- *                 # Overlapping atoms? Weird case but best exit
- *                 if dist2_a == 0 or dist2_b == 0:
- *                     continue             # <<<<<<<<<<<<<<
+        /* "moleculekit/interactions/cationpi/cationpi.pyx":154
+ *                 for i in range(3):
+ *                     tmp1[i] = cation_coor[i] - ring_mean[i]
+ *                 _normalize(tmp1)             # <<<<<<<<<<<<<<
  * 
- *                 # Calculate the angle
+ *                 # Calculate angle between plane normal and ring-cation vector
  */
-          goto __pyx_L9_continue;
+        __pyx_f_11moleculekit_12interactions_8cationpi__normalize(__pyx_v_tmp1); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 154, __pyx_L1_error)
 
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":110
- * 
- *                 # Overlapping atoms? Weird case but best exit
- *                 if dist2_a == 0 or dist2_b == 0:             # <<<<<<<<<<<<<<
- *                     continue
+        /* "moleculekit/interactions/cationpi/cationpi.pyx":157
  * 
- */
-        }
-
-        /* "moleculekit/interactions/hbonds/hbonds.pyx":115
- *                 # Calculate the angle
- *                 # Calculate vector dot product
- *                 dotprod = 0             # <<<<<<<<<<<<<<
+ *                 # Calculate angle between plane normal and ring-cation vector
+ *                 dot_prod = 0             # <<<<<<<<<<<<<<
  *                 for i in range(3):
- *                     dotprod = dotprod + dist_vec_a[i] * dist_vec_b[i]
+ *                     dot_prod = dot_prod + ring_normal[i] * tmp1[i]
  */
-        __pyx_v_dotprod = 0.0;
+        __pyx_v_dot_prod = 0.0;
 
-        /* "moleculekit/interactions/hbonds/hbonds.pyx":116
- *                 # Calculate vector dot product
- *                 dotprod = 0
+        /* "moleculekit/interactions/cationpi/cationpi.pyx":158
+ *                 # Calculate angle between plane normal and ring-cation vector
+ *                 dot_prod = 0
  *                 for i in range(3):             # <<<<<<<<<<<<<<
- *                     dotprod = dotprod + dist_vec_a[i] * dist_vec_b[i]
- * 
+ *                     dot_prod = dot_prod + ring_normal[i] * tmp1[i]
+ *                 angle = acos(dot_prod) * 57.29578  # Convert radians to degrees
  */
         for (__pyx_t_22 = 0; __pyx_t_22 < 3; __pyx_t_22+=1) {
           __pyx_v_i = __pyx_t_22;
 
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":117
- *                 dotprod = 0
+          /* "moleculekit/interactions/cationpi/cationpi.pyx":159
+ *                 dot_prod = 0
  *                 for i in range(3):
- *                     dotprod = dotprod + dist_vec_a[i] * dist_vec_b[i]             # <<<<<<<<<<<<<<
- * 
- *                 angle = dotprod / (sqrt(dist2_a) * sqrt(dist2_b))
+ *                     dot_prod = dot_prod + ring_normal[i] * tmp1[i]             # <<<<<<<<<<<<<<
+ *                 angle = acos(dot_prod) * 57.29578  # Convert radians to degrees
+ *                 if angle > 90:  # minimal angle to line. necessary as perpendicular can point either way
  */
-          __pyx_t_12 = __pyx_v_i;
-          __pyx_t_11 = __pyx_v_i;
-          __pyx_v_dotprod = (__pyx_v_dotprod + ((*((__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_dist_vec_a.data + __pyx_t_12 * __pyx_v_dist_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_dist_vec_b.data + __pyx_t_11 * __pyx_v_dist_vec_b.strides[0]) )))));
+          __pyx_t_14 = __pyx_v_i;
+          __pyx_t_13 = __pyx_v_i;
+          __pyx_v_dot_prod = (__pyx_v_dot_prod + ((*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_normal.data + __pyx_t_14 * __pyx_v_ring_normal.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_tmp1.data + __pyx_t_13 * __pyx_v_tmp1.strides[0]) )))));
         }
 
-        /* "moleculekit/interactions/hbonds/hbonds.pyx":119
- *                     dotprod = dotprod + dist_vec_a[i] * dist_vec_b[i]
- * 
- *                 angle = dotprod / (sqrt(dist2_a) * sqrt(dist2_b))             # <<<<<<<<<<<<<<
- *                 # Prevent numerical issues with acos
- *                 if angle > 1:
+        /* "moleculekit/interactions/cationpi/cationpi.pyx":160
+ *                 for i in range(3):
+ *                     dot_prod = dot_prod + ring_normal[i] * tmp1[i]
+ *                 angle = acos(dot_prod) * 57.29578  # Convert radians to degrees             # <<<<<<<<<<<<<<
+ *                 if angle > 90:  # minimal angle to line. necessary as perpendicular can point either way
+ *                     angle = 180 - angle
  */
-        __pyx_v_angle = (((double)__pyx_v_dotprod) / (sqrt(__pyx_v_dist2_a) * sqrt(__pyx_v_dist2_b)));
+        __pyx_v_angle = (acos(__pyx_v_dot_prod) * 57.29578);
 
-        /* "moleculekit/interactions/hbonds/hbonds.pyx":121
- *                 angle = dotprod / (sqrt(dist2_a) * sqrt(dist2_b))
- *                 # Prevent numerical issues with acos
- *                 if angle > 1:             # <<<<<<<<<<<<<<
- *                     angle = 1
- *                 if angle < -1:
+        /* "moleculekit/interactions/cationpi/cationpi.pyx":161
+ *                     dot_prod = dot_prod + ring_normal[i] * tmp1[i]
+ *                 angle = acos(dot_prod) * 57.29578  # Convert radians to degrees
+ *                 if angle > 90:  # minimal angle to line. necessary as perpendicular can point either way             # <<<<<<<<<<<<<<
+ *                     angle = 180 - angle
+ *                 angle = 90 - angle # We want the angle to the plane, not the normal of the plane so 90 - angle
  */
-        __pyx_t_21 = (__pyx_v_angle > 1.0);
-        if (__pyx_t_21) {
+        __pyx_t_27 = (__pyx_v_angle > 90.0);
+        if (__pyx_t_27) {
 
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":122
- *                 # Prevent numerical issues with acos
- *                 if angle > 1:
- *                     angle = 1             # <<<<<<<<<<<<<<
- *                 if angle < -1:
- *                     angle = -1
+          /* "moleculekit/interactions/cationpi/cationpi.pyx":162
+ *                 angle = acos(dot_prod) * 57.29578  # Convert radians to degrees
+ *                 if angle > 90:  # minimal angle to line. necessary as perpendicular can point either way
+ *                     angle = 180 - angle             # <<<<<<<<<<<<<<
+ *                 angle = 90 - angle # We want the angle to the plane, not the normal of the plane so 90 - angle
+ * 
  */
-          __pyx_v_angle = 1.0;
+          __pyx_v_angle = (180.0 - __pyx_v_angle);
 
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":121
- *                 angle = dotprod / (sqrt(dist2_a) * sqrt(dist2_b))
- *                 # Prevent numerical issues with acos
- *                 if angle > 1:             # <<<<<<<<<<<<<<
- *                     angle = 1
- *                 if angle < -1:
+          /* "moleculekit/interactions/cationpi/cationpi.pyx":161
+ *                     dot_prod = dot_prod + ring_normal[i] * tmp1[i]
+ *                 angle = acos(dot_prod) * 57.29578  # Convert radians to degrees
+ *                 if angle > 90:  # minimal angle to line. necessary as perpendicular can point either way             # <<<<<<<<<<<<<<
+ *                     angle = 180 - angle
+ *                 angle = 90 - angle # We want the angle to the plane, not the normal of the plane so 90 - angle
  */
         }
 
-        /* "moleculekit/interactions/hbonds/hbonds.pyx":123
- *                 if angle > 1:
- *                     angle = 1
- *                 if angle < -1:             # <<<<<<<<<<<<<<
- *                     angle = -1
- *                 angle = acos(angle)
- */
-        __pyx_t_21 = (__pyx_v_angle < -1.0);
-        if (__pyx_t_21) {
-
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":124
- *                     angle = 1
- *                 if angle < -1:
- *                     angle = -1             # <<<<<<<<<<<<<<
- *                 angle = acos(angle)
+        /* "moleculekit/interactions/cationpi/cationpi.pyx":163
+ *                 if angle > 90:  # minimal angle to line. necessary as perpendicular can point either way
+ *                     angle = 180 - angle
+ *                 angle = 90 - angle # We want the angle to the plane, not the normal of the plane so 90 - angle             # <<<<<<<<<<<<<<
  * 
+ *                 if angle >= angle_threshold_min:
  */
-          __pyx_v_angle = -1.0;
+        __pyx_v_angle = (90.0 - __pyx_v_angle);
 
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":123
- *                 if angle > 1:
- *                     angle = 1
- *                 if angle < -1:             # <<<<<<<<<<<<<<
- *                     angle = -1
- *                 angle = acos(angle)
- */
-        }
-
-        /* "moleculekit/interactions/hbonds/hbonds.pyx":125
- *                 if angle < -1:
- *                     angle = -1
- *                 angle = acos(angle)             # <<<<<<<<<<<<<<
+        /* "moleculekit/interactions/cationpi/cationpi.pyx":165
+ *                 angle = 90 - angle # We want the angle to the plane, not the normal of the plane so 90 - angle
  * 
- *                 if angle > angle_threshold:
+ *                 if angle >= angle_threshold_min:             # <<<<<<<<<<<<<<
+ *                     results[f].push_back(r1)
+ *                     results[f].push_back(cations[r2])
  */
-        __pyx_v_angle = acos(__pyx_v_angle);
+        __pyx_t_27 = (__pyx_v_angle >= __pyx_v_angle_threshold_min);
+        if (__pyx_t_27) {
 
-        /* "moleculekit/interactions/hbonds/hbonds.pyx":127
- *                 angle = acos(angle)
+          /* "moleculekit/interactions/cationpi/cationpi.pyx":166
  * 
- *                 if angle > angle_threshold:             # <<<<<<<<<<<<<<
- *                     results[f].push_back(d_idx_d)
- *                     results[f].push_back(d_idx_h)
+ *                 if angle >= angle_threshold_min:
+ *                     results[f].push_back(r1)             # <<<<<<<<<<<<<<
+ *                     results[f].push_back(cations[r2])
+ *                     distangles[f].push_back(sqrt(dist2))
  */
-        __pyx_t_21 = (__pyx_v_angle > __pyx_v_angle_threshold);
-        if (__pyx_t_21) {
+          try {
+            (__pyx_v_results[__pyx_v_f]).push_back(__pyx_v_r1);
+          } catch(...) {
+            __Pyx_CppExn2PyErr();
+            __PYX_ERR(0, 166, __pyx_L1_error)
+          }
 
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":128
- * 
- *                 if angle > angle_threshold:
- *                     results[f].push_back(d_idx_d)             # <<<<<<<<<<<<<<
- *                     results[f].push_back(d_idx_h)
- *                     results[f].push_back(a_idx)
+          /* "moleculekit/interactions/cationpi/cationpi.pyx":167
+ *                 if angle >= angle_threshold_min:
+ *                     results[f].push_back(r1)
+ *                     results[f].push_back(cations[r2])             # <<<<<<<<<<<<<<
+ *                     distangles[f].push_back(sqrt(dist2))
+ *                     distangles[f].push_back(angle)
  */
+          __pyx_t_13 = __pyx_v_r2;
           try {
-            (__pyx_v_results[__pyx_v_f]).push_back(__pyx_v_d_idx_d);
+            (__pyx_v_results[__pyx_v_f]).push_back((*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t *, __pyx_pybuffernd_cations.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_cations.diminfo[0].strides)));
           } catch(...) {
             __Pyx_CppExn2PyErr();
-            __PYX_ERR(0, 128, __pyx_L1_error)
+            __PYX_ERR(0, 167, __pyx_L1_error)
           }
 
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":129
- *                 if angle > angle_threshold:
- *                     results[f].push_back(d_idx_d)
- *                     results[f].push_back(d_idx_h)             # <<<<<<<<<<<<<<
- *                     results[f].push_back(a_idx)
+          /* "moleculekit/interactions/cationpi/cationpi.pyx":168
+ *                     results[f].push_back(r1)
+ *                     results[f].push_back(cations[r2])
+ *                     distangles[f].push_back(sqrt(dist2))             # <<<<<<<<<<<<<<
+ *                     distangles[f].push_back(angle)
  * 
  */
           try {
-            (__pyx_v_results[__pyx_v_f]).push_back(__pyx_v_d_idx_h);
+            (__pyx_v_distangles[__pyx_v_f]).push_back(sqrt(__pyx_v_dist2));
           } catch(...) {
             __Pyx_CppExn2PyErr();
-            __PYX_ERR(0, 129, __pyx_L1_error)
+            __PYX_ERR(0, 168, __pyx_L1_error)
           }
 
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":130
- *                     results[f].push_back(d_idx_d)
- *                     results[f].push_back(d_idx_h)
- *                     results[f].push_back(a_idx)             # <<<<<<<<<<<<<<
+          /* "moleculekit/interactions/cationpi/cationpi.pyx":169
+ *                     results[f].push_back(cations[r2])
+ *                     distangles[f].push_back(sqrt(dist2))
+ *                     distangles[f].push_back(angle)             # <<<<<<<<<<<<<<
  * 
- *     return results
+ *     return results, distangles
  */
           try {
-            (__pyx_v_results[__pyx_v_f]).push_back(__pyx_v_a_idx);
+            (__pyx_v_distangles[__pyx_v_f]).push_back(__pyx_v_angle);
           } catch(...) {
             __Pyx_CppExn2PyErr();
-            __PYX_ERR(0, 130, __pyx_L1_error)
+            __PYX_ERR(0, 169, __pyx_L1_error)
           }
 
-          /* "moleculekit/interactions/hbonds/hbonds.pyx":127
- *                 angle = acos(angle)
+          /* "moleculekit/interactions/cationpi/cationpi.pyx":165
+ *                 angle = 90 - angle # We want the angle to the plane, not the normal of the plane so 90 - angle
  * 
- *                 if angle > angle_threshold:             # <<<<<<<<<<<<<<
- *                     results[f].push_back(d_idx_d)
- *                     results[f].push_back(d_idx_h)
+ *                 if angle >= angle_threshold_min:             # <<<<<<<<<<<<<<
+ *                     results[f].push_back(r1)
+ *                     results[f].push_back(cations[r2])
  */
         }
         __pyx_L9_continue:;
       }
     }
   }
 
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":132
- *                     results[f].push_back(a_idx)
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":171
+ *                     distangles[f].push_back(angle)
  * 
- *     return results             # <<<<<<<<<<<<<<
+ *     return results, distangles             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __pyx_convert_vector_to_py_std_3a__3a_vector_3c_int_3e___(__pyx_v_results); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 132, __pyx_L1_error)
+  __pyx_t_2 = __pyx_convert_vector_to_py_std_3a__3a_vector_3c_int_3e___(__pyx_v_results); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 171, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_r = __pyx_t_2;
+  __pyx_t_3 = __pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___(__pyx_v_distangles); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 171, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 171, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_GIVEREF(__pyx_t_2);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2)) __PYX_ERR(0, 171, __pyx_L1_error);
+  __Pyx_GIVEREF(__pyx_t_3);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_3)) __PYX_ERR(0, 171, __pyx_L1_error);
   __pyx_t_2 = 0;
+  __pyx_t_3 = 0;
+  __pyx_r = __pyx_t_4;
+  __pyx_t_4 = 0;
   goto __pyx_L0;
 
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":23
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":90
+ * 
  * 
- * import cython
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def calculate(
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_5, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_t_20, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_t_21, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_t_25, 1);
   { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
     __Pyx_PyThreadState_declare
     __Pyx_PyThreadState_assign
     __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
-    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_acceptors.rcbuffer->pybuffer);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cations.rcbuffer->pybuffer);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_coords.rcbuffer->pybuffer);
-    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_donors.rcbuffer->pybuffer);
-    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_sel1.rcbuffer->pybuffer);
-    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_sel2.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_rings_atoms.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_rings_start_indexes.rcbuffer->pybuffer);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("moleculekit.interactions.hbonds.calculate", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("moleculekit.interactions.cationpi.calculate", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
-  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_acceptors.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cations.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_coords.rcbuffer->pybuffer);
-  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_donors.rcbuffer->pybuffer);
-  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_sel1.rcbuffer->pybuffer);
-  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_sel2.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_rings_atoms.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_rings_start_indexes.rcbuffer->pybuffer);
   __pyx_L2:;
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_dist_vec_a, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_dist_vec_b, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_ring_mean, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_ring_normal, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_half_box, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_cation_coor, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_tmp1, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_tmp2, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 static struct __pyx_vtabstruct_array __pyx_vtable_array;
 
 static PyObject *__pyx_tp_new_array(PyTypeObject *t, PyObject *a, PyObject *k) {
@@ -21221,15 +21577,15 @@
   #endif
   {Py_tp_methods, (void *)__pyx_methods_array},
   {Py_tp_getset, (void *)__pyx_getsets_array},
   {Py_tp_new, (void *)__pyx_tp_new_array},
   {0, 0},
 };
 static PyType_Spec __pyx_type___pyx_array_spec = {
-  "moleculekit.interactions.hbonds.array",
+  "moleculekit.interactions.cationpi.array",
   sizeof(struct __pyx_array_obj),
   0,
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_SEQUENCE,
   __pyx_type___pyx_array_slots,
 };
 #else
 
@@ -21267,15 +21623,15 @@
   #endif
   __pyx_array_getbuffer, /*bf_getbuffer*/
   0, /*bf_releasebuffer*/
 };
 
 static PyTypeObject __pyx_type___pyx_array = {
   PyVarObject_HEAD_INIT(0, 0)
-  "moleculekit.interactions.hbonds.""array", /*tp_name*/
+  "moleculekit.interactions.cationpi.""array", /*tp_name*/
   sizeof(struct __pyx_array_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc_array, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -21427,25 +21783,25 @@
   {Py_tp_clear, (void *)__pyx_tp_clear_Enum},
   {Py_tp_methods, (void *)__pyx_methods_Enum},
   {Py_tp_init, (void *)__pyx_MemviewEnum___init__},
   {Py_tp_new, (void *)__pyx_tp_new_Enum},
   {0, 0},
 };
 static PyType_Spec __pyx_type___pyx_MemviewEnum_spec = {
-  "moleculekit.interactions.hbonds.Enum",
+  "moleculekit.interactions.cationpi.Enum",
   sizeof(struct __pyx_MemviewEnum_obj),
   0,
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC,
   __pyx_type___pyx_MemviewEnum_slots,
 };
 #else
 
 static PyTypeObject __pyx_type___pyx_MemviewEnum = {
   PyVarObject_HEAD_INIT(0, 0)
-  "moleculekit.interactions.hbonds.""Enum", /*tp_name*/
+  "moleculekit.interactions.cationpi.""Enum", /*tp_name*/
   sizeof(struct __pyx_MemviewEnum_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc_Enum, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -21734,15 +22090,15 @@
   {Py_tp_clear, (void *)__pyx_tp_clear_memoryview},
   {Py_tp_methods, (void *)__pyx_methods_memoryview},
   {Py_tp_getset, (void *)__pyx_getsets_memoryview},
   {Py_tp_new, (void *)__pyx_tp_new_memoryview},
   {0, 0},
 };
 static PyType_Spec __pyx_type___pyx_memoryview_spec = {
-  "moleculekit.interactions.hbonds.memoryview",
+  "moleculekit.interactions.cationpi.memoryview",
   sizeof(struct __pyx_memoryview_obj),
   0,
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC,
   __pyx_type___pyx_memoryview_slots,
 };
 #else
 
@@ -21780,15 +22136,15 @@
   #endif
   __pyx_memoryview_getbuffer, /*bf_getbuffer*/
   0, /*bf_releasebuffer*/
 };
 
 static PyTypeObject __pyx_type___pyx_memoryview = {
   PyVarObject_HEAD_INIT(0, 0)
-  "moleculekit.interactions.hbonds.""memoryview", /*tp_name*/
+  "moleculekit.interactions.cationpi.""memoryview", /*tp_name*/
   sizeof(struct __pyx_memoryview_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc_memoryview, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -21934,25 +22290,25 @@
   {Py_tp_traverse, (void *)__pyx_tp_traverse__memoryviewslice},
   {Py_tp_clear, (void *)__pyx_tp_clear__memoryviewslice},
   {Py_tp_methods, (void *)__pyx_methods__memoryviewslice},
   {Py_tp_new, (void *)__pyx_tp_new__memoryviewslice},
   {0, 0},
 };
 static PyType_Spec __pyx_type___pyx_memoryviewslice_spec = {
-  "moleculekit.interactions.hbonds._memoryviewslice",
+  "moleculekit.interactions.cationpi._memoryviewslice",
   sizeof(struct __pyx_memoryviewslice_obj),
   0,
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC|Py_TPFLAGS_SEQUENCE,
   __pyx_type___pyx_memoryviewslice_slots,
 };
 #else
 
 static PyTypeObject __pyx_type___pyx_memoryviewslice = {
   PyVarObject_HEAD_INIT(0, 0)
-  "moleculekit.interactions.hbonds.""_memoryviewslice", /*tp_name*/
+  "moleculekit.interactions.cationpi.""_memoryviewslice", /*tp_name*/
   sizeof(struct __pyx_memoryviewslice_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc__memoryviewslice, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -22087,50 +22443,42 @@
     {&__pyx_n_s_ValueError, __pyx_k_ValueError, sizeof(__pyx_k_ValueError), 0, 0, 1, 1},
     {&__pyx_n_s_View_MemoryView, __pyx_k_View_MemoryView, sizeof(__pyx_k_View_MemoryView), 0, 0, 1, 1},
     {&__pyx_kp_u__2, __pyx_k__2, sizeof(__pyx_k__2), 0, 1, 0, 0},
     {&__pyx_n_s__25, __pyx_k__25, sizeof(__pyx_k__25), 0, 0, 1, 1},
     {&__pyx_n_s__3, __pyx_k__3, sizeof(__pyx_k__3), 0, 0, 1, 1},
     {&__pyx_kp_u__6, __pyx_k__6, sizeof(__pyx_k__6), 0, 1, 0, 0},
     {&__pyx_kp_u__7, __pyx_k__7, sizeof(__pyx_k__7), 0, 1, 0, 0},
-    {&__pyx_n_s_a, __pyx_k_a, sizeof(__pyx_k_a), 0, 0, 1, 1},
-    {&__pyx_n_s_a_idx, __pyx_k_a_idx, sizeof(__pyx_k_a_idx), 0, 0, 1, 1},
     {&__pyx_n_s_abc, __pyx_k_abc, sizeof(__pyx_k_abc), 0, 0, 1, 1},
-    {&__pyx_n_s_acceptors, __pyx_k_acceptors, sizeof(__pyx_k_acceptors), 0, 0, 1, 1},
     {&__pyx_n_s_allocate_buffer, __pyx_k_allocate_buffer, sizeof(__pyx_k_allocate_buffer), 0, 0, 1, 1},
     {&__pyx_kp_u_and, __pyx_k_and, sizeof(__pyx_k_and), 0, 1, 0, 0},
     {&__pyx_n_s_angle, __pyx_k_angle, sizeof(__pyx_k_angle), 0, 0, 1, 1},
-    {&__pyx_n_s_angle_threshold, __pyx_k_angle_threshold, sizeof(__pyx_k_angle_threshold), 0, 0, 1, 1},
+    {&__pyx_n_s_angle_threshold_min, __pyx_k_angle_threshold_min, sizeof(__pyx_k_angle_threshold_min), 0, 0, 1, 1},
     {&__pyx_n_s_asyncio_coroutines, __pyx_k_asyncio_coroutines, sizeof(__pyx_k_asyncio_coroutines), 0, 0, 1, 1},
     {&__pyx_n_s_base, __pyx_k_base, sizeof(__pyx_k_base), 0, 0, 1, 1},
     {&__pyx_n_s_box, __pyx_k_box, sizeof(__pyx_k_box), 0, 0, 1, 1},
     {&__pyx_n_s_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 0, 1, 1},
     {&__pyx_n_u_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 1, 0, 1},
     {&__pyx_n_s_calculate, __pyx_k_calculate, sizeof(__pyx_k_calculate), 0, 0, 1, 1},
+    {&__pyx_n_s_cation_coor, __pyx_k_cation_coor, sizeof(__pyx_k_cation_coor), 0, 0, 1, 1},
+    {&__pyx_n_s_cations, __pyx_k_cations, sizeof(__pyx_k_cations), 0, 0, 1, 1},
     {&__pyx_n_s_class, __pyx_k_class, sizeof(__pyx_k_class), 0, 0, 1, 1},
     {&__pyx_n_s_class_getitem, __pyx_k_class_getitem, sizeof(__pyx_k_class_getitem), 0, 0, 1, 1},
     {&__pyx_n_s_cline_in_traceback, __pyx_k_cline_in_traceback, sizeof(__pyx_k_cline_in_traceback), 0, 0, 1, 1},
     {&__pyx_n_s_collections, __pyx_k_collections, sizeof(__pyx_k_collections), 0, 0, 1, 1},
     {&__pyx_kp_s_collections_abc, __pyx_k_collections_abc, sizeof(__pyx_k_collections_abc), 0, 0, 1, 0},
     {&__pyx_kp_s_contiguous_and_direct, __pyx_k_contiguous_and_direct, sizeof(__pyx_k_contiguous_and_direct), 0, 0, 1, 0},
     {&__pyx_kp_s_contiguous_and_indirect, __pyx_k_contiguous_and_indirect, sizeof(__pyx_k_contiguous_and_indirect), 0, 0, 1, 0},
     {&__pyx_n_s_coords, __pyx_k_coords, sizeof(__pyx_k_coords), 0, 0, 1, 1},
     {&__pyx_n_s_count, __pyx_k_count, sizeof(__pyx_k_count), 0, 0, 1, 1},
-    {&__pyx_n_s_d, __pyx_k_d, sizeof(__pyx_k_d), 0, 0, 1, 1},
-    {&__pyx_n_s_d_idx, __pyx_k_d_idx, sizeof(__pyx_k_d_idx), 0, 0, 1, 1},
-    {&__pyx_n_s_d_idx_d, __pyx_k_d_idx_d, sizeof(__pyx_k_d_idx_d), 0, 0, 1, 1},
-    {&__pyx_n_s_d_idx_h, __pyx_k_d_idx_h, sizeof(__pyx_k_d_idx_h), 0, 0, 1, 1},
     {&__pyx_n_s_dict, __pyx_k_dict, sizeof(__pyx_k_dict), 0, 0, 1, 1},
     {&__pyx_kp_u_disable, __pyx_k_disable, sizeof(__pyx_k_disable), 0, 1, 0, 0},
-    {&__pyx_n_s_dist2_a, __pyx_k_dist2_a, sizeof(__pyx_k_dist2_a), 0, 0, 1, 1},
-    {&__pyx_n_s_dist2_b, __pyx_k_dist2_b, sizeof(__pyx_k_dist2_b), 0, 0, 1, 1},
+    {&__pyx_n_s_dist2, __pyx_k_dist2, sizeof(__pyx_k_dist2), 0, 0, 1, 1},
     {&__pyx_n_s_dist_threshold, __pyx_k_dist_threshold, sizeof(__pyx_k_dist_threshold), 0, 0, 1, 1},
-    {&__pyx_n_s_dist_vec_a, __pyx_k_dist_vec_a, sizeof(__pyx_k_dist_vec_a), 0, 0, 1, 1},
-    {&__pyx_n_s_dist_vec_b, __pyx_k_dist_vec_b, sizeof(__pyx_k_dist_vec_b), 0, 0, 1, 1},
-    {&__pyx_n_s_donors, __pyx_k_donors, sizeof(__pyx_k_donors), 0, 0, 1, 1},
-    {&__pyx_n_s_dotprod, __pyx_k_dotprod, sizeof(__pyx_k_dotprod), 0, 0, 1, 1},
+    {&__pyx_n_s_distangles, __pyx_k_distangles, sizeof(__pyx_k_distangles), 0, 0, 1, 1},
+    {&__pyx_n_s_dot_prod, __pyx_k_dot_prod, sizeof(__pyx_k_dot_prod), 0, 0, 1, 1},
     {&__pyx_n_s_dtype, __pyx_k_dtype, sizeof(__pyx_k_dtype), 0, 0, 1, 1},
     {&__pyx_n_s_dtype_is_object, __pyx_k_dtype_is_object, sizeof(__pyx_k_dtype_is_object), 0, 0, 1, 1},
     {&__pyx_kp_u_enable, __pyx_k_enable, sizeof(__pyx_k_enable), 0, 1, 0, 0},
     {&__pyx_n_s_encode, __pyx_k_encode, sizeof(__pyx_k_encode), 0, 0, 1, 1},
     {&__pyx_n_s_enumerate, __pyx_k_enumerate, sizeof(__pyx_k_enumerate), 0, 0, 1, 1},
     {&__pyx_n_s_error, __pyx_k_error, sizeof(__pyx_k_error), 0, 0, 1, 1},
     {&__pyx_n_s_f, __pyx_k_f, sizeof(__pyx_k_f), 0, 0, 1, 1},
@@ -22142,32 +22490,29 @@
     {&__pyx_kp_u_gc, __pyx_k_gc, sizeof(__pyx_k_gc), 0, 1, 0, 0},
     {&__pyx_n_s_getstate, __pyx_k_getstate, sizeof(__pyx_k_getstate), 0, 0, 1, 1},
     {&__pyx_kp_u_got, __pyx_k_got, sizeof(__pyx_k_got), 0, 1, 0, 0},
     {&__pyx_kp_u_got_differing_extents_in_dimensi, __pyx_k_got_differing_extents_in_dimensi, sizeof(__pyx_k_got_differing_extents_in_dimensi), 0, 1, 0, 0},
     {&__pyx_n_s_half_box, __pyx_k_half_box, sizeof(__pyx_k_half_box), 0, 0, 1, 1},
     {&__pyx_n_s_i, __pyx_k_i, sizeof(__pyx_k_i), 0, 0, 1, 1},
     {&__pyx_n_s_id, __pyx_k_id, sizeof(__pyx_k_id), 0, 0, 1, 1},
-    {&__pyx_n_s_ignore_hs, __pyx_k_ignore_hs, sizeof(__pyx_k_ignore_hs), 0, 0, 1, 1},
     {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
     {&__pyx_n_s_index, __pyx_k_index, sizeof(__pyx_k_index), 0, 0, 1, 1},
     {&__pyx_n_s_initializing, __pyx_k_initializing, sizeof(__pyx_k_initializing), 0, 0, 1, 1},
-    {&__pyx_n_s_intra, __pyx_k_intra, sizeof(__pyx_k_intra), 0, 0, 1, 1},
     {&__pyx_n_s_is_coroutine, __pyx_k_is_coroutine, sizeof(__pyx_k_is_coroutine), 0, 0, 1, 1},
     {&__pyx_kp_u_isenabled, __pyx_k_isenabled, sizeof(__pyx_k_isenabled), 0, 1, 0, 0},
     {&__pyx_n_s_itemsize, __pyx_k_itemsize, sizeof(__pyx_k_itemsize), 0, 0, 1, 1},
     {&__pyx_kp_s_itemsize_0_for_cython_array, __pyx_k_itemsize_0_for_cython_array, sizeof(__pyx_k_itemsize_0_for_cython_array), 0, 0, 1, 0},
     {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
-    {&__pyx_n_s_math, __pyx_k_math, sizeof(__pyx_k_math), 0, 0, 1, 1},
     {&__pyx_n_s_memview, __pyx_k_memview, sizeof(__pyx_k_memview), 0, 0, 1, 1},
     {&__pyx_n_s_mode, __pyx_k_mode, sizeof(__pyx_k_mode), 0, 0, 1, 1},
-    {&__pyx_kp_s_moleculekit_interactions_hbonds, __pyx_k_moleculekit_interactions_hbonds, sizeof(__pyx_k_moleculekit_interactions_hbonds), 0, 0, 1, 0},
-    {&__pyx_n_s_moleculekit_interactions_hbonds_2, __pyx_k_moleculekit_interactions_hbonds_2, sizeof(__pyx_k_moleculekit_interactions_hbonds_2), 0, 0, 1, 1},
-    {&__pyx_n_s_n_acceptors, __pyx_k_n_acceptors, sizeof(__pyx_k_n_acceptors), 0, 0, 1, 1},
-    {&__pyx_n_s_n_donors, __pyx_k_n_donors, sizeof(__pyx_k_n_donors), 0, 0, 1, 1},
+    {&__pyx_kp_s_moleculekit_interactions_cationp, __pyx_k_moleculekit_interactions_cationp, sizeof(__pyx_k_moleculekit_interactions_cationp), 0, 0, 1, 0},
+    {&__pyx_n_s_moleculekit_interactions_cationp_2, __pyx_k_moleculekit_interactions_cationp_2, sizeof(__pyx_k_moleculekit_interactions_cationp_2), 0, 0, 1, 1},
+    {&__pyx_n_s_n_cations, __pyx_k_n_cations, sizeof(__pyx_k_n_cations), 0, 0, 1, 1},
     {&__pyx_n_s_n_frames, __pyx_k_n_frames, sizeof(__pyx_k_n_frames), 0, 0, 1, 1},
+    {&__pyx_n_s_n_rings, __pyx_k_n_rings, sizeof(__pyx_k_n_rings), 0, 0, 1, 1},
     {&__pyx_n_s_name, __pyx_k_name, sizeof(__pyx_k_name), 0, 0, 1, 1},
     {&__pyx_n_s_name_2, __pyx_k_name_2, sizeof(__pyx_k_name_2), 0, 0, 1, 1},
     {&__pyx_n_s_ndim, __pyx_k_ndim, sizeof(__pyx_k_ndim), 0, 0, 1, 1},
     {&__pyx_n_s_new, __pyx_k_new, sizeof(__pyx_k_new), 0, 0, 1, 1},
     {&__pyx_kp_s_no_default___reduce___due_to_non, __pyx_k_no_default___reduce___due_to_non, sizeof(__pyx_k_no_default___reduce___due_to_non), 0, 0, 1, 0},
     {&__pyx_n_s_np, __pyx_k_np, sizeof(__pyx_k_np), 0, 0, 1, 1},
     {&__pyx_n_s_numpy, __pyx_k_numpy, sizeof(__pyx_k_numpy), 0, 0, 1, 1},
@@ -22179,53 +22524,59 @@
     {&__pyx_n_s_pyx_PickleError, __pyx_k_pyx_PickleError, sizeof(__pyx_k_pyx_PickleError), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_checksum, __pyx_k_pyx_checksum, sizeof(__pyx_k_pyx_checksum), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_result, __pyx_k_pyx_result, sizeof(__pyx_k_pyx_result), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_state, __pyx_k_pyx_state, sizeof(__pyx_k_pyx_state), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_type, __pyx_k_pyx_type, sizeof(__pyx_k_pyx_type), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_unpickle_Enum, __pyx_k_pyx_unpickle_Enum, sizeof(__pyx_k_pyx_unpickle_Enum), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_vtable, __pyx_k_pyx_vtable, sizeof(__pyx_k_pyx_vtable), 0, 0, 1, 1},
+    {&__pyx_n_s_r1, __pyx_k_r1, sizeof(__pyx_k_r1), 0, 0, 1, 1},
+    {&__pyx_n_s_r2, __pyx_k_r2, sizeof(__pyx_k_r2), 0, 0, 1, 1},
+    {&__pyx_n_s_r_end_idx, __pyx_k_r_end_idx, sizeof(__pyx_k_r_end_idx), 0, 0, 1, 1},
+    {&__pyx_n_s_r_start_idx, __pyx_k_r_start_idx, sizeof(__pyx_k_r_start_idx), 0, 0, 1, 1},
     {&__pyx_n_s_range, __pyx_k_range, sizeof(__pyx_k_range), 0, 0, 1, 1},
     {&__pyx_n_s_reduce, __pyx_k_reduce, sizeof(__pyx_k_reduce), 0, 0, 1, 1},
     {&__pyx_n_s_reduce_cython, __pyx_k_reduce_cython, sizeof(__pyx_k_reduce_cython), 0, 0, 1, 1},
     {&__pyx_n_s_reduce_ex, __pyx_k_reduce_ex, sizeof(__pyx_k_reduce_ex), 0, 0, 1, 1},
     {&__pyx_n_s_register, __pyx_k_register, sizeof(__pyx_k_register), 0, 0, 1, 1},
     {&__pyx_n_s_results, __pyx_k_results, sizeof(__pyx_k_results), 0, 0, 1, 1},
-    {&__pyx_n_s_sel1, __pyx_k_sel1, sizeof(__pyx_k_sel1), 0, 0, 1, 1},
-    {&__pyx_n_s_sel2, __pyx_k_sel2, sizeof(__pyx_k_sel2), 0, 0, 1, 1},
+    {&__pyx_n_s_ring_mean, __pyx_k_ring_mean, sizeof(__pyx_k_ring_mean), 0, 0, 1, 1},
+    {&__pyx_n_s_ring_normal, __pyx_k_ring_normal, sizeof(__pyx_k_ring_normal), 0, 0, 1, 1},
+    {&__pyx_n_s_rings_atoms, __pyx_k_rings_atoms, sizeof(__pyx_k_rings_atoms), 0, 0, 1, 1},
+    {&__pyx_n_s_rings_start_indexes, __pyx_k_rings_start_indexes, sizeof(__pyx_k_rings_start_indexes), 0, 0, 1, 1},
     {&__pyx_n_s_setstate, __pyx_k_setstate, sizeof(__pyx_k_setstate), 0, 0, 1, 1},
     {&__pyx_n_s_setstate_cython, __pyx_k_setstate_cython, sizeof(__pyx_k_setstate_cython), 0, 0, 1, 1},
     {&__pyx_n_s_shape, __pyx_k_shape, sizeof(__pyx_k_shape), 0, 0, 1, 1},
     {&__pyx_n_s_size, __pyx_k_size, sizeof(__pyx_k_size), 0, 0, 1, 1},
     {&__pyx_n_s_spec, __pyx_k_spec, sizeof(__pyx_k_spec), 0, 0, 1, 1},
-    {&__pyx_n_s_sqrt, __pyx_k_sqrt, sizeof(__pyx_k_sqrt), 0, 0, 1, 1},
     {&__pyx_n_s_start, __pyx_k_start, sizeof(__pyx_k_start), 0, 0, 1, 1},
     {&__pyx_n_s_step, __pyx_k_step, sizeof(__pyx_k_step), 0, 0, 1, 1},
     {&__pyx_n_s_stop, __pyx_k_stop, sizeof(__pyx_k_stop), 0, 0, 1, 1},
     {&__pyx_kp_s_strided_and_direct, __pyx_k_strided_and_direct, sizeof(__pyx_k_strided_and_direct), 0, 0, 1, 0},
     {&__pyx_kp_s_strided_and_direct_or_indirect, __pyx_k_strided_and_direct_or_indirect, sizeof(__pyx_k_strided_and_direct_or_indirect), 0, 0, 1, 0},
     {&__pyx_kp_s_strided_and_indirect, __pyx_k_strided_and_indirect, sizeof(__pyx_k_strided_and_indirect), 0, 0, 1, 0},
     {&__pyx_kp_s_stringsource, __pyx_k_stringsource, sizeof(__pyx_k_stringsource), 0, 0, 1, 0},
     {&__pyx_n_s_struct, __pyx_k_struct, sizeof(__pyx_k_struct), 0, 0, 1, 1},
     {&__pyx_n_s_sys, __pyx_k_sys, sizeof(__pyx_k_sys), 0, 0, 1, 1},
     {&__pyx_n_s_test, __pyx_k_test, sizeof(__pyx_k_test), 0, 0, 1, 1},
+    {&__pyx_n_s_tmp1, __pyx_k_tmp1, sizeof(__pyx_k_tmp1), 0, 0, 1, 1},
+    {&__pyx_n_s_tmp2, __pyx_k_tmp2, sizeof(__pyx_k_tmp2), 0, 0, 1, 1},
     {&__pyx_n_s_uint32, __pyx_k_uint32, sizeof(__pyx_k_uint32), 0, 0, 1, 1},
     {&__pyx_kp_s_unable_to_allocate_array_data, __pyx_k_unable_to_allocate_array_data, sizeof(__pyx_k_unable_to_allocate_array_data), 0, 0, 1, 0},
     {&__pyx_kp_s_unable_to_allocate_shape_and_str, __pyx_k_unable_to_allocate_shape_and_str, sizeof(__pyx_k_unable_to_allocate_shape_and_str), 0, 0, 1, 0},
     {&__pyx_n_s_unpack, __pyx_k_unpack, sizeof(__pyx_k_unpack), 0, 0, 1, 1},
     {&__pyx_n_s_update, __pyx_k_update, sizeof(__pyx_k_update), 0, 0, 1, 1},
-    {&__pyx_n_s_val, __pyx_k_val, sizeof(__pyx_k_val), 0, 0, 1, 1},
     {&__pyx_n_s_version_info, __pyx_k_version_info, sizeof(__pyx_k_version_info), 0, 0, 1, 1},
     {&__pyx_n_s_zeros, __pyx_k_zeros, sizeof(__pyx_k_zeros), 0, 0, 1, 1},
     {0, 0, 0, 0, 0, 0, 0}
   };
   return __Pyx_InitStrings(__pyx_string_tab);
 }
 /* #### Code section: cached_builtins ### */
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 51, __pyx_L1_error)
+  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 32, __pyx_L1_error)
   __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(1, 68, __pyx_L1_error)
   __pyx_builtin___import__ = __Pyx_GetBuiltinName(__pyx_n_s_import); if (!__pyx_builtin___import__) __PYX_ERR(1, 100, __pyx_L1_error)
   __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(1, 141, __pyx_L1_error)
   __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(1, 159, __pyx_L1_error)
   __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(1, 2, __pyx_L1_error)
   __pyx_builtin_AssertionError = __Pyx_GetBuiltinName(__pyx_n_s_AssertionError); if (!__pyx_builtin_AssertionError) __PYX_ERR(1, 373, __pyx_L1_error)
   __pyx_builtin_Ellipsis = __Pyx_GetBuiltinName(__pyx_n_s_Ellipsis); if (!__pyx_builtin_Ellipsis) __PYX_ERR(1, 408, __pyx_L1_error)
@@ -22274,44 +22625,44 @@
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError, "Incompatible checksums (0x%x vs (0x82a3537, 0x6ae9995, 0xb068931) = (name))" % __pyx_checksum
  */
   __pyx_tuple__8 = PyTuple_Pack(3, __pyx_int_136983863, __pyx_int_112105877, __pyx_int_184977713); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__8);
   __Pyx_GIVEREF(__pyx_tuple__8);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(2, 983, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__9);
   __Pyx_GIVEREF(__pyx_tuple__9);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(2, 989, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__10);
   __Pyx_GIVEREF(__pyx_tuple__10);
 
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":42
- *     cdef int n_frames = coords.shape[2]
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":108
  *     cdef vector[vector[int]] results
- *     cdef FLOAT32_t[:] dist_vec_a = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
- *     cdef FLOAT32_t[:] dist_vec_b = np.zeros(3, dtype=FLOAT32)
+ *     cdef vector[vector[float]] distangles
+ *     cdef FLOAT32_t[:] ring_mean = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
+ *     cdef FLOAT32_t[:] ring_normal = np.zeros(3, dtype=FLOAT32)
  *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)
  */
-  __pyx_tuple__11 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 42, __pyx_L1_error)
+  __pyx_tuple__11 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__11);
   __Pyx_GIVEREF(__pyx_tuple__11);
 
   /* "View.MemoryView":100
  * cdef object __pyx_collections_abc_Sequence "__pyx_collections_abc_Sequence"
  * try:
  *     if __import__("sys").version_info >= (3, 3):             # <<<<<<<<<<<<<<
@@ -22408,25 +22759,25 @@
  *     cdef object __pyx_result
  */
   __pyx_tuple__21 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__21);
   __Pyx_GIVEREF(__pyx_tuple__21);
   __pyx_codeobj__22 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__21, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__22)) __PYX_ERR(1, 1, __pyx_L1_error)
 
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":23
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":90
+ * 
  * 
- * import cython
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def calculate(
  */
-  __pyx_tuple__23 = PyTuple_Pack(30, __pyx_n_s_donors, __pyx_n_s_acceptors, __pyx_n_s_coords, __pyx_n_s_box, __pyx_n_s_sel1, __pyx_n_s_sel2, __pyx_n_s_dist_threshold, __pyx_n_s_angle_threshold, __pyx_n_s_intra, __pyx_n_s_ignore_hs, __pyx_n_s_d, __pyx_n_s_a, __pyx_n_s_f, __pyx_n_s_i, __pyx_n_s_n_donors, __pyx_n_s_n_acceptors, __pyx_n_s_n_frames, __pyx_n_s_results, __pyx_n_s_dist_vec_a, __pyx_n_s_dist_vec_b, __pyx_n_s_half_box, __pyx_n_s_dist2_a, __pyx_n_s_dist2_b, __pyx_n_s_dotprod, __pyx_n_s_val, __pyx_n_s_angle, __pyx_n_s_d_idx_d, __pyx_n_s_d_idx_h, __pyx_n_s_d_idx, __pyx_n_s_a_idx); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 23, __pyx_L1_error)
+  __pyx_tuple__23 = PyTuple_Pack(27, __pyx_n_s_rings_atoms, __pyx_n_s_rings_start_indexes, __pyx_n_s_cations, __pyx_n_s_coords, __pyx_n_s_box, __pyx_n_s_dist_threshold, __pyx_n_s_angle_threshold_min, __pyx_n_s_r1, __pyx_n_s_r2, __pyx_n_s_f, __pyx_n_s_i, __pyx_n_s_n_rings, __pyx_n_s_n_cations, __pyx_n_s_n_frames, __pyx_n_s_results, __pyx_n_s_distangles, __pyx_n_s_ring_mean, __pyx_n_s_ring_normal, __pyx_n_s_half_box, __pyx_n_s_cation_coor, __pyx_n_s_tmp1, __pyx_n_s_tmp2, __pyx_n_s_dist2, __pyx_n_s_dot_prod, __pyx_n_s_r_start_idx, __pyx_n_s_r_end_idx, __pyx_n_s_angle); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 90, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__23);
   __Pyx_GIVEREF(__pyx_tuple__23);
-  __pyx_codeobj__24 = (PyObject*)__Pyx_PyCode_New(10, 0, 0, 30, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__23, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_moleculekit_interactions_hbonds, __pyx_n_s_calculate, 23, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__24)) __PYX_ERR(0, 23, __pyx_L1_error)
+  __pyx_codeobj__24 = (PyObject*)__Pyx_PyCode_New(7, 0, 0, 27, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__23, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_moleculekit_interactions_cationp, __pyx_n_s_calculate, 90, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__24)) __PYX_ERR(0, 90, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 /* #### Code section: init_constants ### */
@@ -22733,31 +23084,31 @@
   return 0;
 }
 
 
 #if PY_MAJOR_VERSION >= 3
 #if CYTHON_PEP489_MULTI_PHASE_INIT
 static PyObject* __pyx_pymod_create(PyObject *spec, PyModuleDef *def); /*proto*/
-static int __pyx_pymod_exec_hbonds(PyObject* module); /*proto*/
+static int __pyx_pymod_exec_cationpi(PyObject* module); /*proto*/
 static PyModuleDef_Slot __pyx_moduledef_slots[] = {
   {Py_mod_create, (void*)__pyx_pymod_create},
-  {Py_mod_exec, (void*)__pyx_pymod_exec_hbonds},
+  {Py_mod_exec, (void*)__pyx_pymod_exec_cationpi},
   {0, NULL}
 };
 #endif
 
 #ifdef __cplusplus
 namespace {
   struct PyModuleDef __pyx_moduledef =
   #else
   static struct PyModuleDef __pyx_moduledef =
   #endif
   {
       PyModuleDef_HEAD_INIT,
-      "hbonds",
+      "cationpi",
       0, /* m_doc */
     #if CYTHON_PEP489_MULTI_PHASE_INIT
       0, /* m_size */
     #elif CYTHON_USE_MODULE_STATE
       sizeof(__pyx_mstate), /* m_size */
     #else
       -1, /* m_size */
@@ -22797,19 +23148,19 @@
 #else
 #define __Pyx_PyMODINIT_FUNC PyObject *
 #endif
 #endif
 
 
 #if PY_MAJOR_VERSION < 3
-__Pyx_PyMODINIT_FUNC inithbonds(void) CYTHON_SMALL_CODE; /*proto*/
-__Pyx_PyMODINIT_FUNC inithbonds(void)
+__Pyx_PyMODINIT_FUNC initcationpi(void) CYTHON_SMALL_CODE; /*proto*/
+__Pyx_PyMODINIT_FUNC initcationpi(void)
 #else
-__Pyx_PyMODINIT_FUNC PyInit_hbonds(void) CYTHON_SMALL_CODE; /*proto*/
-__Pyx_PyMODINIT_FUNC PyInit_hbonds(void)
+__Pyx_PyMODINIT_FUNC PyInit_cationpi(void) CYTHON_SMALL_CODE; /*proto*/
+__Pyx_PyMODINIT_FUNC PyInit_cationpi(void)
 #if CYTHON_PEP489_MULTI_PHASE_INIT
 {
   return PyModuleDef_Init(&__pyx_moduledef);
 }
 static CYTHON_SMALL_CODE int __Pyx_check_single_interpreter(void) {
     #if PY_VERSION_HEX >= 0x030700A1
     static PY_INT64_T main_interpreter_id = -1;
@@ -22882,15 +23233,15 @@
     return module;
 bad:
     Py_XDECREF(module);
     return NULL;
 }
 
 
-static CYTHON_SMALL_CODE int __pyx_pymod_exec_hbonds(PyObject *__pyx_pyinit_module)
+static CYTHON_SMALL_CODE int __pyx_pymod_exec_cationpi(PyObject *__pyx_pyinit_module)
 #endif
 #endif
 {
   int stringtab_initialized = 0;
   #if CYTHON_USE_MODULE_STATE
   int pystate_addmodule_run = 0;
   #endif
@@ -22898,42 +23249,40 @@
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_t_6;
   PyObject *__pyx_t_7 = NULL;
   static PyThread_type_lock __pyx_t_8[8];
-  PyObject *__pyx_t_9 = NULL;
-  PyObject *__pyx_t_10 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannyDeclarations
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   if (__pyx_m) {
     if (__pyx_m == __pyx_pyinit_module) return 0;
-    PyErr_SetString(PyExc_RuntimeError, "Module 'hbonds' has already been imported. Re-initialisation is not supported.");
+    PyErr_SetString(PyExc_RuntimeError, "Module 'cationpi' has already been imported. Re-initialisation is not supported.");
     return -1;
   }
   #elif PY_MAJOR_VERSION >= 3
   if (__pyx_m) return __Pyx_NewRef(__pyx_m);
   #endif
   /*--- Module creation code ---*/
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   __pyx_m = __pyx_pyinit_module;
   Py_INCREF(__pyx_m);
   #else
   #if PY_MAJOR_VERSION < 3
-  __pyx_m = Py_InitModule4("hbonds", __pyx_methods, 0, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
+  __pyx_m = Py_InitModule4("cationpi", __pyx_methods, 0, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
   if (unlikely(!__pyx_m)) __PYX_ERR(0, 1, __pyx_L1_error)
   #elif CYTHON_USE_MODULE_STATE
   __pyx_t_1 = PyModule_Create(&__pyx_moduledef); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)
   {
     int add_module_result = PyState_AddModule(__pyx_t_1, &__pyx_moduledef);
-    __pyx_t_1 = 0; /* transfer ownership from __pyx_t_1 to hbonds pseudovariable */
+    __pyx_t_1 = 0; /* transfer ownership from __pyx_t_1 to cationpi pseudovariable */
     if (unlikely((add_module_result < 0))) __PYX_ERR(0, 1, __pyx_L1_error)
     pystate_addmodule_run = 1;
   }
   #else
   __pyx_m = PyModule_Create(&__pyx_moduledef);
   if (unlikely(!__pyx_m)) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
@@ -22949,15 +23298,15 @@
 if (!__Pyx_RefNanny) {
   PyErr_Clear();
   __Pyx_RefNanny = __Pyx_RefNannyImportAPI("Cython.Runtime.refnanny");
   if (!__Pyx_RefNanny)
       Py_FatalError("failed to import 'refnanny' module");
 }
 #endif
-  __Pyx_RefNannySetupContext("__Pyx_PyMODINIT_FUNC PyInit_hbonds(void)", 0);
+  __Pyx_RefNannySetupContext("__Pyx_PyMODINIT_FUNC PyInit_cationpi(void)", 0);
   if (__Pyx_check_binary_version(__PYX_LIMITED_VERSION_HEX, __Pyx_get_runtime_version(), CYTHON_COMPILING_IN_LIMITED_API) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #ifdef __Pxy_PyFrame_Initialize_Offsets
   __Pxy_PyFrame_Initialize_Offsets();
   #endif
   __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_empty_bytes = PyBytes_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_empty_unicode = PyUnicode_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_unicode)) __PYX_ERR(0, 1, __pyx_L1_error)
@@ -22987,22 +23336,22 @@
   /*--- Initialize various global constants etc. ---*/
   if (__Pyx_InitConstants() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   stringtab_initialized = 1;
   if (__Pyx_InitGlobals() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #if PY_MAJOR_VERSION < 3 && (__PYX_DEFAULT_STRING_ENCODING_IS_ASCII || __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT)
   if (__Pyx_init_sys_getdefaultencoding_params() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
-  if (__pyx_module_is_main_moleculekit__interactions__hbonds) {
+  if (__pyx_module_is_main_moleculekit__interactions__cationpi) {
     if (PyObject_SetAttr(__pyx_m, __pyx_n_s_name_2, __pyx_n_s_main) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   }
   #if PY_MAJOR_VERSION >= 3
   {
     PyObject *modules = PyImport_GetModuleDict(); if (unlikely(!modules)) __PYX_ERR(0, 1, __pyx_L1_error)
-    if (!PyDict_GetItemString(modules, "moleculekit.interactions.hbonds")) {
-      if (unlikely((PyDict_SetItemString(modules, "moleculekit.interactions.hbonds", __pyx_m) < 0))) __PYX_ERR(0, 1, __pyx_L1_error)
+    if (!PyDict_GetItemString(modules, "moleculekit.interactions.cationpi")) {
+      if (unlikely((PyDict_SetItemString(modules, "moleculekit.interactions.cationpi", __pyx_m) < 0))) __PYX_ERR(0, 1, __pyx_L1_error)
     }
   }
   #endif
   /*--- Builtin init code ---*/
   if (__Pyx_InitCachedBuiltins() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   /*--- Constants init code ---*/
   if (__Pyx_InitCachedConstants() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
@@ -23528,181 +23877,132 @@
  *     cdef object __pyx_result
  */
   __pyx_t_7 = PyCFunction_NewEx(&__pyx_mdef_15View_dot_MemoryView_1__pyx_unpickle_Enum, NULL, __pyx_n_s_View_MemoryView); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_pyx_unpickle_Enum, __pyx_t_7) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":3
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":3
  * # cython: cdivision=True
  * 
  * import numpy as np             # <<<<<<<<<<<<<<
- * from math import sqrt
  * cimport numpy as np
+ * from libcpp.vector cimport vector
  */
   __pyx_t_7 = __Pyx_ImportDottedModule(__pyx_n_s_numpy, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_7) < 0) __PYX_ERR(0, 3, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":4
- * 
- * import numpy as np
- * from math import sqrt             # <<<<<<<<<<<<<<
- * cimport numpy as np
- * from libcpp.vector cimport vector
- */
-  __pyx_t_7 = PyList_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_INCREF(__pyx_n_s_sqrt);
-  __Pyx_GIVEREF(__pyx_n_s_sqrt);
-  if (__Pyx_PyList_SET_ITEM(__pyx_t_7, 0, __pyx_n_s_sqrt)) __PYX_ERR(0, 4, __pyx_L1_error);
-  __pyx_t_4 = __Pyx_Import(__pyx_n_s_math, __pyx_t_7, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_ImportFrom(__pyx_t_4, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_sqrt, __pyx_t_7) < 0) __PYX_ERR(0, 4, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":13
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":11
  * # DTYPE for this, which is assigned to the usual NumPy runtime
  * # type info object.
  * UINT32 = np.uint32             # <<<<<<<<<<<<<<
  * FLOAT32 = np.float32
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 13, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_uint32); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 13, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 11, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_UINT32, __pyx_t_7) < 0) __PYX_ERR(0, 13, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_uint32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 11, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_UINT32, __pyx_t_4) < 0) __PYX_ERR(0, 11, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":14
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":12
  * # type info object.
  * UINT32 = np.uint32
  * FLOAT32 = np.float32             # <<<<<<<<<<<<<<
  * 
  * # "ctypedef" assigns a corresponding compile-time type to DTYPE_t. For
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 14, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_float32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 14, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_FLOAT32, __pyx_t_4) < 0) __PYX_ERR(0, 14, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":32
- *         np.ndarray[UINT32_t, ndim=1] sel1,
- *         np.ndarray[UINT32_t, ndim=1] sel2,
- *         float dist_threshold=2.5,             # <<<<<<<<<<<<<<
- *         float angle_threshold=120,
- *         bool intra=False,
- */
-  __pyx_t_4 = PyFloat_FromDouble(((double)2.5)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 32, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 12, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":33
- *         np.ndarray[UINT32_t, ndim=1] sel2,
- *         float dist_threshold=2.5,
- *         float angle_threshold=120,             # <<<<<<<<<<<<<<
- *         bool intra=False,
- *         bool ignore_hs=False,
- */
-  __pyx_t_7 = PyFloat_FromDouble(((float)120.0)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 33, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float32); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 12, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_FLOAT32, __pyx_t_7) < 0) __PYX_ERR(0, 12, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":34
- *         float dist_threshold=2.5,
- *         float angle_threshold=120,
- *         bool intra=False,             # <<<<<<<<<<<<<<
- *         bool ignore_hs=False,
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":98
+ *         np.ndarray[FLOAT32_t, ndim=3] coords,
+ *         np.ndarray[FLOAT32_t, ndim=2] box,
+ *         float dist_threshold=5,             # <<<<<<<<<<<<<<
+ *         float angle_threshold_min=60,
  *     ):
  */
-  __pyx_t_5 = __Pyx_PyBool_FromLong(((int)0)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 34, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_7 = PyFloat_FromDouble(((float)5.0)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 98, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
 
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":35
- *         float angle_threshold=120,
- *         bool intra=False,
- *         bool ignore_hs=False,             # <<<<<<<<<<<<<<
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":99
+ *         np.ndarray[FLOAT32_t, ndim=2] box,
+ *         float dist_threshold=5,
+ *         float angle_threshold_min=60,             # <<<<<<<<<<<<<<
  *     ):
- *     cdef int d, a, f, i
+ *     cdef int r1, r2, f, i
  */
-  __pyx_t_9 = __Pyx_PyBool_FromLong(((int)0)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 35, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_9);
+  __pyx_t_4 = PyFloat_FromDouble(((float)60.0)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 99, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
 
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":23
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":90
+ * 
  * 
- * import cython
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def calculate(
  */
-  __pyx_t_10 = PyTuple_New(4); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 23, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_10);
-  __Pyx_GIVEREF(__pyx_t_4);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_4)) __PYX_ERR(0, 23, __pyx_L1_error);
+  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 90, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_7);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_10, 1, __pyx_t_7)) __PYX_ERR(0, 23, __pyx_L1_error);
-  __Pyx_GIVEREF(__pyx_t_5);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_10, 2, __pyx_t_5)) __PYX_ERR(0, 23, __pyx_L1_error);
-  __Pyx_GIVEREF(__pyx_t_9);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_10, 3, __pyx_t_9)) __PYX_ERR(0, 23, __pyx_L1_error);
-  __pyx_t_4 = 0;
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_7)) __PYX_ERR(0, 90, __pyx_L1_error);
+  __Pyx_GIVEREF(__pyx_t_4);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4)) __PYX_ERR(0, 90, __pyx_L1_error);
   __pyx_t_7 = 0;
-  __pyx_t_5 = 0;
-  __pyx_t_9 = 0;
-  __pyx_t_9 = __Pyx_CyFunction_New(&__pyx_mdef_11moleculekit_12interactions_6hbonds_1calculate, 0, __pyx_n_s_calculate, NULL, __pyx_n_s_moleculekit_interactions_hbonds_2, __pyx_d, ((PyObject *)__pyx_codeobj__24)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 23, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_9);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_9, __pyx_t_10);
-  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_calculate, __pyx_t_9) < 0) __PYX_ERR(0, 23, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+  __pyx_t_4 = 0;
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11moleculekit_12interactions_8cationpi_1calculate, 0, __pyx_n_s_calculate, NULL, __pyx_n_s_moleculekit_interactions_cationp_2, __pyx_d, ((PyObject *)__pyx_codeobj__24)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 90, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_4, __pyx_t_5);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_calculate, __pyx_t_4) < 0) __PYX_ERR(0, 90, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "moleculekit/interactions/hbonds/hbonds.pyx":1
+  /* "moleculekit/interactions/cationpi/cationpi.pyx":1
  * # cython: cdivision=True             # <<<<<<<<<<<<<<
  * 
  * import numpy as np
  */
-  __pyx_t_9 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_9);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_9) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_4) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
   /*--- Wrapped vars code ---*/
 
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_7);
-  __Pyx_XDECREF(__pyx_t_9);
-  __Pyx_XDECREF(__pyx_t_10);
   if (__pyx_m) {
     if (__pyx_d && stringtab_initialized) {
-      __Pyx_AddTraceback("init moleculekit.interactions.hbonds", __pyx_clineno, __pyx_lineno, __pyx_filename);
+      __Pyx_AddTraceback("init moleculekit.interactions.cationpi", __pyx_clineno, __pyx_lineno, __pyx_filename);
     }
     #if !CYTHON_USE_MODULE_STATE
     Py_CLEAR(__pyx_m);
     #else
     Py_DECREF(__pyx_m);
     if (pystate_addmodule_run) {
       PyObject *tp, *value, *tb;
       PyErr_Fetch(&tp, &value, &tb);
       PyState_RemoveModule(&__pyx_moduledef);
       PyErr_Restore(tp, value, tb);
     }
     #endif
   } else if (!PyErr_Occurred()) {
-    PyErr_SetString(PyExc_ImportError, "init moleculekit.interactions.hbonds");
+    PyErr_SetString(PyExc_ImportError, "init moleculekit.interactions.cationpi");
   }
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   return (__pyx_m != NULL) ? 0 : -1;
   #elif PY_MAJOR_VERSION >= 3
   return __pyx_m;
@@ -29005,14 +29305,36 @@
 {
     void *start1, *end1, *start2, *end2;
     __pyx_get_array_memory_extents(slice1, &start1, &end1, ndim, itemsize);
     __pyx_get_array_memory_extents(slice2, &start2, &end2, ndim, itemsize);
     return (start1 < end2) && (start2 < end1);
 }
 
+/* CIntFromPyVerify */
+  #define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)\
+    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 0)
+#define __PYX_VERIFY_RETURN_INT_EXC(target_type, func_type, func_value)\
+    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 1)
+#define __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, exc)\
+    {\
+        func_type value = func_value;\
+        if (sizeof(target_type) < sizeof(func_type)) {\
+            if (unlikely(value != (func_type) (target_type) value)) {\
+                func_type zero = 0;\
+                if (exc && unlikely(value == (func_type)-1 && PyErr_Occurred()))\
+                    return (target_type) -1;\
+                if (is_unsigned && unlikely(value < zero))\
+                    goto raise_neg_overflow;\
+                else\
+                    goto raise_overflow;\
+            }\
+        }\
+        return (target_type) value;\
+    }
+
 /* TypeInfoCompare */
   static int
 __pyx_typeinfo_cmp(__Pyx_TypeInfo *a, __Pyx_TypeInfo *b)
 {
     int i;
     if (!a || !b)
         return 0;
@@ -29229,57 +29551,104 @@
     retval = -1;
 no_fail:
     __Pyx_RefNannyFinishContext();
     return retval;
 }
 
 /* ObjectToMemviewSlice */
-  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t(PyObject *obj, int writable_flag) {
+  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(PyObject *obj, int writable_flag) {
     __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
     __Pyx_BufFmt_StackElem stack[1];
     int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
     int retcode;
     if (obj == Py_None) {
         result.memview = (struct __pyx_memoryview_obj *) Py_None;
         return result;
     }
     retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
                                                  PyBUF_RECORDS_RO | writable_flag, 1,
-                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t, stack,
+                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t, stack,
                                                  &result, obj);
     if (unlikely(retcode == -1))
         goto __pyx_fail;
     return result;
 __pyx_fail:
     result.memview = NULL;
     result.data = NULL;
     return result;
 }
 
-/* CIntFromPyVerify */
-  #define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)\
-    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 0)
-#define __PYX_VERIFY_RETURN_INT_EXC(target_type, func_type, func_value)\
-    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 1)
-#define __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, exc)\
-    {\
-        func_type value = func_value;\
-        if (sizeof(target_type) < sizeof(func_type)) {\
-            if (unlikely(value != (func_type) (target_type) value)) {\
-                func_type zero = 0;\
-                if (exc && unlikely(value == (func_type)-1 && PyErr_Occurred()))\
-                    return (target_type) -1;\
-                if (is_unsigned && unlikely(value < zero))\
-                    goto raise_neg_overflow;\
-                else\
-                    goto raise_overflow;\
-            }\
-        }\
-        return (target_type) value;\
+/* ObjectToMemviewSlice */
+  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t(PyObject *obj, int writable_flag) {
+    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
+    __Pyx_BufFmt_StackElem stack[1];
+    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
+    int retcode;
+    if (obj == Py_None) {
+        result.memview = (struct __pyx_memoryview_obj *) Py_None;
+        return result;
+    }
+    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
+                                                 PyBUF_RECORDS_RO | writable_flag, 1,
+                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_8cationpi_UINT32_t, stack,
+                                                 &result, obj);
+    if (unlikely(retcode == -1))
+        goto __pyx_fail;
+    return result;
+__pyx_fail:
+    result.memview = NULL;
+    result.data = NULL;
+    return result;
+}
+
+/* ObjectToMemviewSlice */
+  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(PyObject *obj, int writable_flag) {
+    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
+    __Pyx_BufFmt_StackElem stack[1];
+    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
+    int retcode;
+    if (obj == Py_None) {
+        result.memview = (struct __pyx_memoryview_obj *) Py_None;
+        return result;
+    }
+    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
+                                                 PyBUF_RECORDS_RO | writable_flag, 3,
+                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t, stack,
+                                                 &result, obj);
+    if (unlikely(retcode == -1))
+        goto __pyx_fail;
+    return result;
+__pyx_fail:
+    result.memview = NULL;
+    result.data = NULL;
+    return result;
+}
+
+/* ObjectToMemviewSlice */
+  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t(PyObject *obj, int writable_flag) {
+    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
+    __Pyx_BufFmt_StackElem stack[1];
+    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
+    int retcode;
+    if (obj == Py_None) {
+        result.memview = (struct __pyx_memoryview_obj *) Py_None;
+        return result;
     }
+    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
+                                                 PyBUF_RECORDS_RO | writable_flag, 2,
+                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_8cationpi_FLOAT32_t, stack,
+                                                 &result, obj);
+    if (unlikely(retcode == -1))
+        goto __pyx_fail;
+    return result;
+__pyx_fail:
+    result.memview = NULL;
+    result.data = NULL;
+    return result;
+}
 
 /* Declarations */
   #if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
   #ifdef __cplusplus
     static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float x, float y) {
       return ::std::complex< float >(x, y);
     }
@@ -29783,238 +30152,174 @@
         }
     } else {
         __pyx_fatalerror("Acquisition count is %d (line %d)",
                          old_acquisition_count-1, lineno);
     }
 }
 
-/* CIntToPy */
-  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
-#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
-#pragma GCC diagnostic push
-#pragma GCC diagnostic ignored "-Wconversion"
-#endif
-    const int neg_one = (int) -1, const_zero = (int) 0;
-#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
-#pragma GCC diagnostic pop
-#endif
-    const int is_unsigned = neg_one > const_zero;
-    if (is_unsigned) {
-        if (sizeof(int) < sizeof(long)) {
-            return PyInt_FromLong((long) value);
-        } else if (sizeof(int) <= sizeof(unsigned long)) {
-            return PyLong_FromUnsignedLong((unsigned long) value);
-#ifdef HAVE_LONG_LONG
-        } else if (sizeof(int) <= sizeof(unsigned PY_LONG_LONG)) {
-            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
-#endif
-        }
-    } else {
-        if (sizeof(int) <= sizeof(long)) {
-            return PyInt_FromLong((long) value);
-#ifdef HAVE_LONG_LONG
-        } else if (sizeof(int) <= sizeof(PY_LONG_LONG)) {
-            return PyLong_FromLongLong((PY_LONG_LONG) value);
-#endif
-        }
-    }
-    {
-        int one = 1; int little = (int)*(unsigned char *)&one;
-        unsigned char *bytes = (unsigned char *)&value;
-#if !CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030d0000
-        return _PyLong_FromByteArray(bytes, sizeof(int),
-                                     little, !is_unsigned);
-#else
-        PyObject *from_bytes, *result = NULL;
-        PyObject *py_bytes = NULL, *arg_tuple = NULL, *kwds = NULL, *order_str = NULL;
-        from_bytes = PyObject_GetAttrString((PyObject*)&PyLong_Type, "from_bytes");
-        if (!from_bytes) return NULL;
-        py_bytes = PyBytes_FromStringAndSize((char*)bytes, sizeof(int));
-        if (!py_bytes) goto limited_bad;
-        order_str = PyUnicode_FromString(little ? "little" : "big");
-        if (!order_str) goto limited_bad;
-        arg_tuple = PyTuple_Pack(2, py_bytes, order_str);
-        if (!arg_tuple) goto limited_bad;
-        if (!is_unsigned) {
-            kwds = PyDict_New();
-            if (!kwds) goto limited_bad;
-            if (PyDict_SetItemString(kwds, "signed", __Pyx_NewRef(Py_True))) goto limited_bad;
-        }
-        result = PyObject_Call(from_bytes, arg_tuple, kwds);
-        limited_bad:
-        Py_XDECREF(kwds);
-        Py_XDECREF(arg_tuple);
-        Py_XDECREF(order_str);
-        Py_XDECREF(py_bytes);
-        Py_XDECREF(from_bytes);
-        return result;
-#endif
-    }
-}
-
 /* CIntFromPy */
-  static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *x) {
+  static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *x) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
 #endif
-    const int neg_one = (int) -1, const_zero = (int) 0;
+    const long neg_one = (long) -1, const_zero = (long) 0;
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic pop
 #endif
     const int is_unsigned = neg_one > const_zero;
 #if PY_MAJOR_VERSION < 3
     if (likely(PyInt_Check(x))) {
-        if ((sizeof(int) < sizeof(long))) {
-            __PYX_VERIFY_RETURN_INT(int, long, PyInt_AS_LONG(x))
+        if ((sizeof(long) < sizeof(long))) {
+            __PYX_VERIFY_RETURN_INT(long, long, PyInt_AS_LONG(x))
         } else {
             long val = PyInt_AS_LONG(x);
             if (is_unsigned && unlikely(val < 0)) {
                 goto raise_neg_overflow;
             }
-            return (int) val;
+            return (long) val;
         }
     } else
 #endif
     if (likely(PyLong_Check(x))) {
         if (is_unsigned) {
 #if CYTHON_USE_PYLONG_INTERNALS
             if (unlikely(__Pyx_PyLong_IsNeg(x))) {
                 goto raise_neg_overflow;
             } else if (__Pyx_PyLong_IsCompact(x)) {
-                __PYX_VERIFY_RETURN_INT(int, __Pyx_compact_upylong, __Pyx_PyLong_CompactValueUnsigned(x))
+                __PYX_VERIFY_RETURN_INT(long, __Pyx_compact_upylong, __Pyx_PyLong_CompactValueUnsigned(x))
             } else {
                 const digit* digits = __Pyx_PyLong_Digits(x);
                 assert(__Pyx_PyLong_DigitCount(x) > 1);
                 switch (__Pyx_PyLong_DigitCount(x)) {
                     case 2:
-                        if ((8 * sizeof(int) > 1 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(long) > 1 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(int) >= 2 * PyLong_SHIFT)) {
-                                return (int) (((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
+                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(long) >= 2 * PyLong_SHIFT)) {
+                                return (long) (((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
                             }
                         }
                         break;
                     case 3:
-                        if ((8 * sizeof(int) > 2 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(long) > 2 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(int) >= 3 * PyLong_SHIFT)) {
-                                return (int) (((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
+                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(long) >= 3 * PyLong_SHIFT)) {
+                                return (long) (((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
                             }
                         }
                         break;
                     case 4:
-                        if ((8 * sizeof(int) > 3 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(long) > 3 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(int) >= 4 * PyLong_SHIFT)) {
-                                return (int) (((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
+                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(long) >= 4 * PyLong_SHIFT)) {
+                                return (long) (((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
                             }
                         }
                         break;
                 }
             }
 #endif
 #if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX < 0x030C00A7
             if (unlikely(Py_SIZE(x) < 0)) {
                 goto raise_neg_overflow;
             }
 #else
             {
                 int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
                 if (unlikely(result < 0))
-                    return (int) -1;
+                    return (long) -1;
                 if (unlikely(result == 1))
                     goto raise_neg_overflow;
             }
 #endif
-            if ((sizeof(int) <= sizeof(unsigned long))) {
-                __PYX_VERIFY_RETURN_INT_EXC(int, unsigned long, PyLong_AsUnsignedLong(x))
+            if ((sizeof(long) <= sizeof(unsigned long))) {
+                __PYX_VERIFY_RETURN_INT_EXC(long, unsigned long, PyLong_AsUnsignedLong(x))
 #ifdef HAVE_LONG_LONG
-            } else if ((sizeof(int) <= sizeof(unsigned PY_LONG_LONG))) {
-                __PYX_VERIFY_RETURN_INT_EXC(int, unsigned PY_LONG_LONG, PyLong_AsUnsignedLongLong(x))
+            } else if ((sizeof(long) <= sizeof(unsigned PY_LONG_LONG))) {
+                __PYX_VERIFY_RETURN_INT_EXC(long, unsigned PY_LONG_LONG, PyLong_AsUnsignedLongLong(x))
 #endif
             }
         } else {
 #if CYTHON_USE_PYLONG_INTERNALS
             if (__Pyx_PyLong_IsCompact(x)) {
-                __PYX_VERIFY_RETURN_INT(int, __Pyx_compact_pylong, __Pyx_PyLong_CompactValue(x))
+                __PYX_VERIFY_RETURN_INT(long, __Pyx_compact_pylong, __Pyx_PyLong_CompactValue(x))
             } else {
                 const digit* digits = __Pyx_PyLong_Digits(x);
                 assert(__Pyx_PyLong_DigitCount(x) > 1);
                 switch (__Pyx_PyLong_SignedDigitCount(x)) {
                     case -2:
-                        if ((8 * sizeof(int) - 1 > 1 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(long) - 1 > 1 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(int) - 1 > 2 * PyLong_SHIFT)) {
-                                return (int) (((int)-1)*(((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(long) - 1 > 2 * PyLong_SHIFT)) {
+                                return (long) (((long)-1)*(((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                             }
                         }
                         break;
                     case 2:
-                        if ((8 * sizeof(int) > 1 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(long) > 1 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(int) - 1 > 2 * PyLong_SHIFT)) {
-                                return (int) ((((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(long) - 1 > 2 * PyLong_SHIFT)) {
+                                return (long) ((((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                             }
                         }
                         break;
                     case -3:
-                        if ((8 * sizeof(int) - 1 > 2 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(long) - 1 > 2 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(int) - 1 > 3 * PyLong_SHIFT)) {
-                                return (int) (((int)-1)*(((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(long) - 1 > 3 * PyLong_SHIFT)) {
+                                return (long) (((long)-1)*(((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                             }
                         }
                         break;
                     case 3:
-                        if ((8 * sizeof(int) > 2 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(long) > 2 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(int) - 1 > 3 * PyLong_SHIFT)) {
-                                return (int) ((((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(long) - 1 > 3 * PyLong_SHIFT)) {
+                                return (long) ((((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                             }
                         }
                         break;
                     case -4:
-                        if ((8 * sizeof(int) - 1 > 3 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(long) - 1 > 3 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(int) - 1 > 4 * PyLong_SHIFT)) {
-                                return (int) (((int)-1)*(((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(long) - 1 > 4 * PyLong_SHIFT)) {
+                                return (long) (((long)-1)*(((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                             }
                         }
                         break;
                     case 4:
-                        if ((8 * sizeof(int) > 3 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(long) > 3 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(int) - 1 > 4 * PyLong_SHIFT)) {
-                                return (int) ((((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(long) - 1 > 4 * PyLong_SHIFT)) {
+                                return (long) ((((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                             }
                         }
                         break;
                 }
             }
 #endif
-            if ((sizeof(int) <= sizeof(long))) {
-                __PYX_VERIFY_RETURN_INT_EXC(int, long, PyLong_AsLong(x))
+            if ((sizeof(long) <= sizeof(long))) {
+                __PYX_VERIFY_RETURN_INT_EXC(long, long, PyLong_AsLong(x))
 #ifdef HAVE_LONG_LONG
-            } else if ((sizeof(int) <= sizeof(PY_LONG_LONG))) {
-                __PYX_VERIFY_RETURN_INT_EXC(int, PY_LONG_LONG, PyLong_AsLongLong(x))
+            } else if ((sizeof(long) <= sizeof(PY_LONG_LONG))) {
+                __PYX_VERIFY_RETURN_INT_EXC(long, PY_LONG_LONG, PyLong_AsLongLong(x))
 #endif
             }
         }
         {
-            int val;
+            long val;
             PyObject *v = __Pyx_PyNumber_IntOrLong(x);
 #if PY_MAJOR_VERSION < 3
             if (likely(v) && !PyLong_Check(v)) {
                 PyObject *tmp = v;
                 v = PyNumber_Long(tmp);
                 Py_DECREF(tmp);
             }
@@ -30033,261 +30338,261 @@
                 long idigit;
                 int chunk_size = (sizeof(long) < 8) ? 30 : 62;
                 if (unlikely(!PyLong_CheckExact(v))) {
                     PyObject *tmp = v;
                     v = PyNumber_Long(v);
                     assert(PyLong_CheckExact(v));
                     Py_DECREF(tmp);
-                    if (unlikely(!v)) return (int) -1;
+                    if (unlikely(!v)) return (long) -1;
                 }
 #if CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030B0000
                 if (Py_SIZE(x) == 0)
-                    return (int) 0;
+                    return (long) 0;
                 is_negative = Py_SIZE(x) < 0;
 #else
                 {
                     int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
                     if (unlikely(result < 0))
-                        return (int) -1;
+                        return (long) -1;
                     is_negative = result == 1;
                 }
 #endif
                 if (is_unsigned && unlikely(is_negative)) {
                     goto raise_neg_overflow;
                 } else if (is_negative) {
                     stepval = PyNumber_Invert(v);
                     if (unlikely(!stepval))
-                        return (int) -1;
+                        return (long) -1;
                 } else {
                     stepval = __Pyx_NewRef(v);
                 }
-                val = (int) 0;
+                val = (long) 0;
                 mask = PyLong_FromLong((1L << chunk_size) - 1); if (unlikely(!mask)) goto done;
                 shift = PyLong_FromLong(chunk_size); if (unlikely(!shift)) goto done;
-                for (bits = 0; bits < (int) sizeof(int) * 8 - chunk_size; bits += chunk_size) {
+                for (bits = 0; bits < (int) sizeof(long) * 8 - chunk_size; bits += chunk_size) {
                     PyObject *tmp, *digit;
                     digit = PyNumber_And(stepval, mask);
                     if (unlikely(!digit)) goto done;
                     idigit = PyLong_AsLong(digit);
                     Py_DECREF(digit);
                     if (unlikely(idigit < 0)) goto done;
                     tmp = PyNumber_Rshift(stepval, shift);
                     if (unlikely(!tmp)) goto done;
                     Py_DECREF(stepval); stepval = tmp;
-                    val |= ((int) idigit) << bits;
+                    val |= ((long) idigit) << bits;
                     #if CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030B0000
                     if (Py_SIZE(stepval) == 0)
                         goto unpacking_done;
                     #endif
                 }
                 idigit = PyLong_AsLong(stepval);
                 if (unlikely(idigit < 0)) goto done;
-                remaining_bits = ((int) sizeof(int) * 8) - bits - (is_unsigned ? 0 : 1);
+                remaining_bits = ((int) sizeof(long) * 8) - bits - (is_unsigned ? 0 : 1);
                 if (unlikely(idigit >= (1L << remaining_bits)))
                     goto raise_overflow;
-                val |= ((int) idigit) << bits;
+                val |= ((long) idigit) << bits;
             #if CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030B0000
             unpacking_done:
             #endif
                 if (!is_unsigned) {
-                    if (unlikely(val & (((int) 1) << (sizeof(int) * 8 - 1))))
+                    if (unlikely(val & (((long) 1) << (sizeof(long) * 8 - 1))))
                         goto raise_overflow;
                     if (is_negative)
                         val = ~val;
                 }
                 ret = 0;
             done:
                 Py_XDECREF(shift);
                 Py_XDECREF(mask);
                 Py_XDECREF(stepval);
 #endif
                 Py_DECREF(v);
                 if (likely(!ret))
                     return val;
             }
-            return (int) -1;
+            return (long) -1;
         }
     } else {
-        int val;
+        long val;
         PyObject *tmp = __Pyx_PyNumber_IntOrLong(x);
-        if (!tmp) return (int) -1;
-        val = __Pyx_PyInt_As_int(tmp);
+        if (!tmp) return (long) -1;
+        val = __Pyx_PyInt_As_long(tmp);
         Py_DECREF(tmp);
         return val;
     }
 raise_overflow:
     PyErr_SetString(PyExc_OverflowError,
-        "value too large to convert to int");
-    return (int) -1;
+        "value too large to convert to long");
+    return (long) -1;
 raise_neg_overflow:
     PyErr_SetString(PyExc_OverflowError,
-        "can't convert negative value to int");
-    return (int) -1;
+        "can't convert negative value to long");
+    return (long) -1;
 }
 
 /* CIntFromPy */
-  static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *x) {
+  static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *x) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
 #endif
-    const long neg_one = (long) -1, const_zero = (long) 0;
+    const int neg_one = (int) -1, const_zero = (int) 0;
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic pop
 #endif
     const int is_unsigned = neg_one > const_zero;
 #if PY_MAJOR_VERSION < 3
     if (likely(PyInt_Check(x))) {
-        if ((sizeof(long) < sizeof(long))) {
-            __PYX_VERIFY_RETURN_INT(long, long, PyInt_AS_LONG(x))
+        if ((sizeof(int) < sizeof(long))) {
+            __PYX_VERIFY_RETURN_INT(int, long, PyInt_AS_LONG(x))
         } else {
             long val = PyInt_AS_LONG(x);
             if (is_unsigned && unlikely(val < 0)) {
                 goto raise_neg_overflow;
             }
-            return (long) val;
+            return (int) val;
         }
     } else
 #endif
     if (likely(PyLong_Check(x))) {
         if (is_unsigned) {
 #if CYTHON_USE_PYLONG_INTERNALS
             if (unlikely(__Pyx_PyLong_IsNeg(x))) {
                 goto raise_neg_overflow;
             } else if (__Pyx_PyLong_IsCompact(x)) {
-                __PYX_VERIFY_RETURN_INT(long, __Pyx_compact_upylong, __Pyx_PyLong_CompactValueUnsigned(x))
+                __PYX_VERIFY_RETURN_INT(int, __Pyx_compact_upylong, __Pyx_PyLong_CompactValueUnsigned(x))
             } else {
                 const digit* digits = __Pyx_PyLong_Digits(x);
                 assert(__Pyx_PyLong_DigitCount(x) > 1);
                 switch (__Pyx_PyLong_DigitCount(x)) {
                     case 2:
-                        if ((8 * sizeof(long) > 1 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(int) > 1 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(long) >= 2 * PyLong_SHIFT)) {
-                                return (long) (((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
+                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(int) >= 2 * PyLong_SHIFT)) {
+                                return (int) (((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
                             }
                         }
                         break;
                     case 3:
-                        if ((8 * sizeof(long) > 2 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(int) > 2 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(long) >= 3 * PyLong_SHIFT)) {
-                                return (long) (((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
+                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(int) >= 3 * PyLong_SHIFT)) {
+                                return (int) (((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
                             }
                         }
                         break;
                     case 4:
-                        if ((8 * sizeof(long) > 3 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(int) > 3 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(long) >= 4 * PyLong_SHIFT)) {
-                                return (long) (((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
+                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(int) >= 4 * PyLong_SHIFT)) {
+                                return (int) (((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
                             }
                         }
                         break;
                 }
             }
 #endif
 #if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX < 0x030C00A7
             if (unlikely(Py_SIZE(x) < 0)) {
                 goto raise_neg_overflow;
             }
 #else
             {
                 int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
                 if (unlikely(result < 0))
-                    return (long) -1;
+                    return (int) -1;
                 if (unlikely(result == 1))
                     goto raise_neg_overflow;
             }
 #endif
-            if ((sizeof(long) <= sizeof(unsigned long))) {
-                __PYX_VERIFY_RETURN_INT_EXC(long, unsigned long, PyLong_AsUnsignedLong(x))
+            if ((sizeof(int) <= sizeof(unsigned long))) {
+                __PYX_VERIFY_RETURN_INT_EXC(int, unsigned long, PyLong_AsUnsignedLong(x))
 #ifdef HAVE_LONG_LONG
-            } else if ((sizeof(long) <= sizeof(unsigned PY_LONG_LONG))) {
-                __PYX_VERIFY_RETURN_INT_EXC(long, unsigned PY_LONG_LONG, PyLong_AsUnsignedLongLong(x))
+            } else if ((sizeof(int) <= sizeof(unsigned PY_LONG_LONG))) {
+                __PYX_VERIFY_RETURN_INT_EXC(int, unsigned PY_LONG_LONG, PyLong_AsUnsignedLongLong(x))
 #endif
             }
         } else {
 #if CYTHON_USE_PYLONG_INTERNALS
             if (__Pyx_PyLong_IsCompact(x)) {
-                __PYX_VERIFY_RETURN_INT(long, __Pyx_compact_pylong, __Pyx_PyLong_CompactValue(x))
+                __PYX_VERIFY_RETURN_INT(int, __Pyx_compact_pylong, __Pyx_PyLong_CompactValue(x))
             } else {
                 const digit* digits = __Pyx_PyLong_Digits(x);
                 assert(__Pyx_PyLong_DigitCount(x) > 1);
                 switch (__Pyx_PyLong_SignedDigitCount(x)) {
                     case -2:
-                        if ((8 * sizeof(long) - 1 > 1 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(int) - 1 > 1 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(long) - 1 > 2 * PyLong_SHIFT)) {
-                                return (long) (((long)-1)*(((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(int) - 1 > 2 * PyLong_SHIFT)) {
+                                return (int) (((int)-1)*(((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                             }
                         }
                         break;
                     case 2:
-                        if ((8 * sizeof(long) > 1 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(int) > 1 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(long) - 1 > 2 * PyLong_SHIFT)) {
-                                return (long) ((((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(int) - 1 > 2 * PyLong_SHIFT)) {
+                                return (int) ((((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                             }
                         }
                         break;
                     case -3:
-                        if ((8 * sizeof(long) - 1 > 2 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(int) - 1 > 2 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(long) - 1 > 3 * PyLong_SHIFT)) {
-                                return (long) (((long)-1)*(((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(int) - 1 > 3 * PyLong_SHIFT)) {
+                                return (int) (((int)-1)*(((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                             }
                         }
                         break;
                     case 3:
-                        if ((8 * sizeof(long) > 2 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(int) > 2 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(long) - 1 > 3 * PyLong_SHIFT)) {
-                                return (long) ((((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(int) - 1 > 3 * PyLong_SHIFT)) {
+                                return (int) ((((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                             }
                         }
                         break;
                     case -4:
-                        if ((8 * sizeof(long) - 1 > 3 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(int) - 1 > 3 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(long) - 1 > 4 * PyLong_SHIFT)) {
-                                return (long) (((long)-1)*(((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(int) - 1 > 4 * PyLong_SHIFT)) {
+                                return (int) (((int)-1)*(((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                             }
                         }
                         break;
                     case 4:
-                        if ((8 * sizeof(long) > 3 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(int) > 3 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(long) - 1 > 4 * PyLong_SHIFT)) {
-                                return (long) ((((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(int) - 1 > 4 * PyLong_SHIFT)) {
+                                return (int) ((((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                             }
                         }
                         break;
                 }
             }
 #endif
-            if ((sizeof(long) <= sizeof(long))) {
-                __PYX_VERIFY_RETURN_INT_EXC(long, long, PyLong_AsLong(x))
+            if ((sizeof(int) <= sizeof(long))) {
+                __PYX_VERIFY_RETURN_INT_EXC(int, long, PyLong_AsLong(x))
 #ifdef HAVE_LONG_LONG
-            } else if ((sizeof(long) <= sizeof(PY_LONG_LONG))) {
-                __PYX_VERIFY_RETURN_INT_EXC(long, PY_LONG_LONG, PyLong_AsLongLong(x))
+            } else if ((sizeof(int) <= sizeof(PY_LONG_LONG))) {
+                __PYX_VERIFY_RETURN_INT_EXC(int, PY_LONG_LONG, PyLong_AsLongLong(x))
 #endif
             }
         }
         {
-            long val;
+            int val;
             PyObject *v = __Pyx_PyNumber_IntOrLong(x);
 #if PY_MAJOR_VERSION < 3
             if (likely(v) && !PyLong_Check(v)) {
                 PyObject *tmp = v;
                 v = PyNumber_Long(tmp);
                 Py_DECREF(tmp);
             }
@@ -30306,99 +30611,163 @@
                 long idigit;
                 int chunk_size = (sizeof(long) < 8) ? 30 : 62;
                 if (unlikely(!PyLong_CheckExact(v))) {
                     PyObject *tmp = v;
                     v = PyNumber_Long(v);
                     assert(PyLong_CheckExact(v));
                     Py_DECREF(tmp);
-                    if (unlikely(!v)) return (long) -1;
+                    if (unlikely(!v)) return (int) -1;
                 }
 #if CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030B0000
                 if (Py_SIZE(x) == 0)
-                    return (long) 0;
+                    return (int) 0;
                 is_negative = Py_SIZE(x) < 0;
 #else
                 {
                     int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
                     if (unlikely(result < 0))
-                        return (long) -1;
+                        return (int) -1;
                     is_negative = result == 1;
                 }
 #endif
                 if (is_unsigned && unlikely(is_negative)) {
                     goto raise_neg_overflow;
                 } else if (is_negative) {
                     stepval = PyNumber_Invert(v);
                     if (unlikely(!stepval))
-                        return (long) -1;
+                        return (int) -1;
                 } else {
                     stepval = __Pyx_NewRef(v);
                 }
-                val = (long) 0;
+                val = (int) 0;
                 mask = PyLong_FromLong((1L << chunk_size) - 1); if (unlikely(!mask)) goto done;
                 shift = PyLong_FromLong(chunk_size); if (unlikely(!shift)) goto done;
-                for (bits = 0; bits < (int) sizeof(long) * 8 - chunk_size; bits += chunk_size) {
+                for (bits = 0; bits < (int) sizeof(int) * 8 - chunk_size; bits += chunk_size) {
                     PyObject *tmp, *digit;
                     digit = PyNumber_And(stepval, mask);
                     if (unlikely(!digit)) goto done;
                     idigit = PyLong_AsLong(digit);
                     Py_DECREF(digit);
                     if (unlikely(idigit < 0)) goto done;
                     tmp = PyNumber_Rshift(stepval, shift);
                     if (unlikely(!tmp)) goto done;
                     Py_DECREF(stepval); stepval = tmp;
-                    val |= ((long) idigit) << bits;
+                    val |= ((int) idigit) << bits;
                     #if CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030B0000
                     if (Py_SIZE(stepval) == 0)
                         goto unpacking_done;
                     #endif
                 }
                 idigit = PyLong_AsLong(stepval);
                 if (unlikely(idigit < 0)) goto done;
-                remaining_bits = ((int) sizeof(long) * 8) - bits - (is_unsigned ? 0 : 1);
+                remaining_bits = ((int) sizeof(int) * 8) - bits - (is_unsigned ? 0 : 1);
                 if (unlikely(idigit >= (1L << remaining_bits)))
                     goto raise_overflow;
-                val |= ((long) idigit) << bits;
+                val |= ((int) idigit) << bits;
             #if CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030B0000
             unpacking_done:
             #endif
                 if (!is_unsigned) {
-                    if (unlikely(val & (((long) 1) << (sizeof(long) * 8 - 1))))
+                    if (unlikely(val & (((int) 1) << (sizeof(int) * 8 - 1))))
                         goto raise_overflow;
                     if (is_negative)
                         val = ~val;
                 }
                 ret = 0;
             done:
                 Py_XDECREF(shift);
                 Py_XDECREF(mask);
                 Py_XDECREF(stepval);
 #endif
                 Py_DECREF(v);
                 if (likely(!ret))
                     return val;
             }
-            return (long) -1;
+            return (int) -1;
         }
     } else {
-        long val;
+        int val;
         PyObject *tmp = __Pyx_PyNumber_IntOrLong(x);
-        if (!tmp) return (long) -1;
-        val = __Pyx_PyInt_As_long(tmp);
+        if (!tmp) return (int) -1;
+        val = __Pyx_PyInt_As_int(tmp);
         Py_DECREF(tmp);
         return val;
     }
 raise_overflow:
     PyErr_SetString(PyExc_OverflowError,
-        "value too large to convert to long");
-    return (long) -1;
+        "value too large to convert to int");
+    return (int) -1;
 raise_neg_overflow:
     PyErr_SetString(PyExc_OverflowError,
-        "can't convert negative value to long");
-    return (long) -1;
+        "can't convert negative value to int");
+    return (int) -1;
+}
+
+/* CIntToPy */
+  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wconversion"
+#endif
+    const int neg_one = (int) -1, const_zero = (int) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic pop
+#endif
+    const int is_unsigned = neg_one > const_zero;
+    if (is_unsigned) {
+        if (sizeof(int) < sizeof(long)) {
+            return PyInt_FromLong((long) value);
+        } else if (sizeof(int) <= sizeof(unsigned long)) {
+            return PyLong_FromUnsignedLong((unsigned long) value);
+#ifdef HAVE_LONG_LONG
+        } else if (sizeof(int) <= sizeof(unsigned PY_LONG_LONG)) {
+            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
+#endif
+        }
+    } else {
+        if (sizeof(int) <= sizeof(long)) {
+            return PyInt_FromLong((long) value);
+#ifdef HAVE_LONG_LONG
+        } else if (sizeof(int) <= sizeof(PY_LONG_LONG)) {
+            return PyLong_FromLongLong((PY_LONG_LONG) value);
+#endif
+        }
+    }
+    {
+        int one = 1; int little = (int)*(unsigned char *)&one;
+        unsigned char *bytes = (unsigned char *)&value;
+#if !CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030d0000
+        return _PyLong_FromByteArray(bytes, sizeof(int),
+                                     little, !is_unsigned);
+#else
+        PyObject *from_bytes, *result = NULL;
+        PyObject *py_bytes = NULL, *arg_tuple = NULL, *kwds = NULL, *order_str = NULL;
+        from_bytes = PyObject_GetAttrString((PyObject*)&PyLong_Type, "from_bytes");
+        if (!from_bytes) return NULL;
+        py_bytes = PyBytes_FromStringAndSize((char*)bytes, sizeof(int));
+        if (!py_bytes) goto limited_bad;
+        order_str = PyUnicode_FromString(little ? "little" : "big");
+        if (!order_str) goto limited_bad;
+        arg_tuple = PyTuple_Pack(2, py_bytes, order_str);
+        if (!arg_tuple) goto limited_bad;
+        if (!is_unsigned) {
+            kwds = PyDict_New();
+            if (!kwds) goto limited_bad;
+            if (PyDict_SetItemString(kwds, "signed", __Pyx_NewRef(Py_True))) goto limited_bad;
+        }
+        result = PyObject_Call(from_bytes, arg_tuple, kwds);
+        limited_bad:
+        Py_XDECREF(kwds);
+        Py_XDECREF(arg_tuple);
+        Py_XDECREF(order_str);
+        Py_XDECREF(py_bytes);
+        Py_XDECREF(from_bytes);
+        return result;
+#endif
+    }
 }
 
 /* CIntToPy */
   static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
```

### Comparing `moleculekit-1.8.6/moleculekit/interactions/hbonds/hbonds.pyx` & `moleculekit-1.8.7/moleculekit/interactions/hbonds/hbonds.pyx`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/interactions/interactions.py` & `moleculekit-1.8.7/moleculekit/interactions/interactions.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/interactions/pipi/pipi.cpp` & `moleculekit-1.8.7/moleculekit/interactions/hbonds/hbonds.cpp`

 * *Files 1% similar despite different names*

```diff
@@ -1,32 +1,32 @@
 /* Generated by Cython 3.0.5 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h"
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include"
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include"
         ],
         "language": "c++",
-        "name": "moleculekit.interactions.pipi",
+        "name": "moleculekit.interactions.hbonds",
         "sources": [
-            "moleculekit/interactions/pipi/pipi.pyx"
+            "moleculekit/interactions/hbonds/hbonds.pyx"
         ]
     },
-    "module_name": "moleculekit.interactions.pipi"
+    "module_name": "moleculekit.interactions.hbonds"
 }
 END: Cython Metadata */
 
 #ifndef PY_SSIZE_T_CLEAN
 #define PY_SSIZE_T_CLEAN
 #endif /* PY_SSIZE_T_CLEAN */
 #if defined(CYTHON_LIMITED_API) && 0
@@ -1215,16 +1215,16 @@
     #else
     #warning Please do not define the '__PYX_EXTERN_C' macro externally. Use 'CYTHON_EXTERN_C' instead.
     #endif
 #else
     #define __PYX_EXTERN_C extern "C++"
 #endif
 
-#define __PYX_HAVE__moleculekit__interactions__pipi
-#define __PYX_HAVE_API__moleculekit__interactions__pipi
+#define __PYX_HAVE__moleculekit__interactions__hbonds
+#define __PYX_HAVE_API__moleculekit__interactions__hbonds
 /* Early includes */
 #include <string.h>
 #include <stdio.h>
 
     /* Using NumPy API declarations from "numpy/__init__.cython-30.pxd" */
     
 #include "numpy/arrayobject.h"
@@ -1523,15 +1523,15 @@
   #undef _Complex_I
   #define _Complex_I 1.0fj
 #endif
 
 /* #### Code section: filename_table ### */
 
 static const char *__pyx_f[] = {
-  "moleculekit/interactions/pipi/pipi.pyx",
+  "moleculekit/interactions/hbonds/hbonds.pyx",
   "<stringsource>",
   "__init__.cython-30.pxd",
   "type.pxd",
 };
 /* #### Code section: utility_code_proto_before_types ### */
 /* ForceInitThreads.proto */
 #ifndef __PYX_FORCE_INIT_THREADS
@@ -1672,202 +1672,202 @@
   Py_ssize_t strides[8];
   Py_ssize_t suboffsets[8];
 } __Pyx_memviewslice;
 #define __Pyx_MemoryView_Len(m)  (m.shape[0])
 
 /* #### Code section: numeric_typedefs ### */
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":730
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":730
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":731
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":731
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":732
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":732
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":733
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":733
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":737
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":737
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":738
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":738
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":739
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":739
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":740
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":740
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":744
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":744
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":745
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":745
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":754
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":754
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":755
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":755
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":757
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":757
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":758
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":758
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":760
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":760
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":761
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":761
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":763
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":763
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":764
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":764
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":765
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":765
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
 
-/* "moleculekit/interactions/pipi/pipi.pyx":17
+/* "moleculekit/interactions/hbonds/hbonds.pyx":19
  * # every type in the numpy module there's a corresponding compile-time
  * # type with a _t-suffix.
  * ctypedef np.uint32_t UINT32_t             # <<<<<<<<<<<<<<
  * ctypedef np.float32_t FLOAT32_t
  * 
  */
-typedef __pyx_t_5numpy_uint32_t __pyx_t_11moleculekit_12interactions_4pipi_UINT32_t;
+typedef __pyx_t_5numpy_uint32_t __pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t;
 
-/* "moleculekit/interactions/pipi/pipi.pyx":18
+/* "moleculekit/interactions/hbonds/hbonds.pyx":20
  * # type with a _t-suffix.
  * ctypedef np.uint32_t UINT32_t
  * ctypedef np.float32_t FLOAT32_t             # <<<<<<<<<<<<<<
  * 
  * import cython
  */
-typedef __pyx_t_5numpy_float32_t __pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t;
+typedef __pyx_t_5numpy_float32_t __pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t;
 /* #### Code section: complex_type_declarations ### */
 /* Declarations.proto */
 #if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
   #ifdef __cplusplus
     typedef ::std::complex< float > __pyx_t_float_complex;
   #else
     typedef float _Complex __pyx_t_float_complex;
@@ -1893,42 +1893,42 @@
 
 /*--- Type declarations ---*/
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
 struct __pyx_memoryviewslice_obj;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":767
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":767
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":768
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":768
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":769
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":769
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":771
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":771
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -2642,14 +2642,38 @@
 /* HasAttr.proto */
 #if __PYX_LIMITED_VERSION_HEX >= 0x030d00A1
 #define __Pyx_HasAttr(o, n)  PyObject_HasAttrWithError(o, n)
 #else
 static CYTHON_INLINE int __Pyx_HasAttr(PyObject *, PyObject *);
 #endif
 
+/* IsLittleEndian.proto */
+static CYTHON_INLINE int __Pyx_Is_Little_Endian(void);
+
+/* BufferFormatCheck.proto */
+static const char* __Pyx_BufFmt_CheckString(__Pyx_BufFmt_Context* ctx, const char* ts);
+static void __Pyx_BufFmt_Init(__Pyx_BufFmt_Context* ctx,
+                              __Pyx_BufFmt_StackElem* stack,
+                              __Pyx_TypeInfo* type);
+
+/* BufferGetAndValidate.proto */
+#define __Pyx_GetBufferAndValidate(buf, obj, dtype, flags, nd, cast, stack)\
+    ((obj == Py_None || obj == NULL) ?\
+    (__Pyx_ZeroBuffer(buf), 0) :\
+    __Pyx__GetBufferAndValidate(buf, obj, dtype, flags, nd, cast, stack))
+static int  __Pyx__GetBufferAndValidate(Py_buffer* buf, PyObject* obj,
+    __Pyx_TypeInfo* dtype, int flags, int nd, int cast, __Pyx_BufFmt_StackElem* stack);
+static void __Pyx_ZeroBuffer(Py_buffer* buf);
+static CYTHON_INLINE void __Pyx_SafeReleaseBuffer(Py_buffer* info);
+static Py_ssize_t __Pyx_minusones[] = { -1, -1, -1, -1, -1, -1, -1, -1 };
+static Py_ssize_t __Pyx_zeros[] = { 0, 0, 0, 0, 0, 0, 0, 0 };
+
+#define __Pyx_BufPtrStrided2d(type, buf, i0, s0, i1, s1) (type)((char*)buf + i0 * s0 + i1 * s1)
+#define __Pyx_BufPtrStrided1d(type, buf, i0, s0) (type)((char*)buf + i0 * s0)
+#define __Pyx_BufPtrStrided3d(type, buf, i0, s0, i1, s1, i2, s2) (type)((char*)buf + i0 * s0 + i1 * s1 + i2 * s2)
 /* PyObject_GenericGetAttrNoDict.proto */
 #if CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP && PY_VERSION_HEX < 0x03070000
 static CYTHON_INLINE PyObject* __Pyx_PyObject_GenericGetAttrNoDict(PyObject* obj, PyObject* attr_name);
 #else
 #define __Pyx_PyObject_GenericGetAttrNoDict PyObject_GenericGetAttr
 #endif
 
@@ -2915,23 +2939,14 @@
 static int __pyx_memviewslice_is_contig(const __Pyx_memviewslice mvs, char order, int ndim);
 
 /* OverlappingSlices.proto */
 static int __pyx_slices_overlap(__Pyx_memviewslice *slice1,
                                 __Pyx_memviewslice *slice2,
                                 int ndim, size_t itemsize);
 
-/* IsLittleEndian.proto */
-static CYTHON_INLINE int __Pyx_Is_Little_Endian(void);
-
-/* BufferFormatCheck.proto */
-static const char* __Pyx_BufFmt_CheckString(__Pyx_BufFmt_Context* ctx, const char* ts);
-static void __Pyx_BufFmt_Init(__Pyx_BufFmt_Context* ctx,
-                              __Pyx_BufFmt_StackElem* stack,
-                              __Pyx_TypeInfo* type);
-
 /* TypeInfoCompare.proto */
 static int __pyx_typeinfo_cmp(__Pyx_TypeInfo *a, __Pyx_TypeInfo *b);
 
 /* MemviewSliceValidateAndInit.proto */
 static int __Pyx_ValidateAndInit_memviewslice(
                 int *axes_specs,
                 int c_or_f_flag,
@@ -2939,24 +2954,15 @@
                 int ndim,
                 __Pyx_TypeInfo *dtype,
                 __Pyx_BufFmt_StackElem stack[],
                 __Pyx_memviewslice *memviewslice,
                 PyObject *original_obj);
 
 /* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_UINT32_t(PyObject *, int writable_flag);
-
-/* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(PyObject *, int writable_flag);
-
-/* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(PyObject *, int writable_flag);
-
-/* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(PyObject *, int writable_flag);
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t(PyObject *, int writable_flag);
 
 /* CppExceptionConversion.proto */
 #ifndef __Pyx_CppExn2PyErr
 #include <new>
 #include <typeinfo>
 #include <stdexcept>
 #include <ios>
@@ -3122,26 +3128,26 @@
     __pyx_atomic_int_type *acquisition_count, PyThread_type_lock lock);
 #define __pyx_get_slice_count_pointer(memview) (&memview->acquisition_count)
 #define __PYX_INC_MEMVIEW(slice, have_gil) __Pyx_INC_MEMVIEW(slice, have_gil, __LINE__)
 #define __PYX_XCLEAR_MEMVIEW(slice, have_gil) __Pyx_XCLEAR_MEMVIEW(slice, have_gil, __LINE__)
 static CYTHON_INLINE void __Pyx_INC_MEMVIEW(__Pyx_memviewslice *, int, int);
 static CYTHON_INLINE void __Pyx_XCLEAR_MEMVIEW(__Pyx_memviewslice *, int, int);
 
-/* CIntFromPy.proto */
-static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *);
-
 /* CIntToPy.proto */
 static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value);
 
 /* CIntFromPy.proto */
 static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *);
 
 /* None.proto */
 #include <new>
 
+/* CIntFromPy.proto */
+static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *);
+
 /* CIntToPy.proto */
 static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value);
 
 /* CIntFromPy.proto */
 static CYTHON_INLINE char __Pyx_PyInt_As_char(PyObject *);
 
 /* FormatTypeName.proto */
@@ -3201,38 +3207,35 @@
 
 /* Module declarations from "numpy" */
 
 /* Module declarations from "numpy" */
 
 /* Module declarations from "libcpp.vector" */
 
+/* Module declarations from "libcpp" */
+
 /* Module declarations from "libc.math" */
 
 /* Module declarations from "cython.view" */
 
 /* Module declarations from "cython.dataclasses" */
 
 /* Module declarations from "cython" */
 
-/* Module declarations from "moleculekit.interactions.pipi" */
+/* Module declarations from "moleculekit.interactions.hbonds" */
 static PyObject *__pyx_collections_abc_Sequence = 0;
 static PyObject *generic = 0;
 static PyObject *strided = 0;
 static PyObject *indirect = 0;
 static PyObject *contiguous = 0;
 static PyObject *indirect_contiguous = 0;
 static int __pyx_memoryview_thread_locks_used;
 static PyThread_type_lock __pyx_memoryview_thread_locks[8];
-static void __pyx_f_11moleculekit_12interactions_4pipi__calculate_ring_mean(int, int, int, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice); /*proto*/
-static float __pyx_f_11moleculekit_12interactions_4pipi__wrapped_dist(int, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice); /*proto*/
-static void __pyx_f_11moleculekit_12interactions_4pipi__cross_product(__Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice); /*proto*/
 static PyObject *__pyx_convert_vector_to_py_int(std::vector<int>  const &); /*proto*/
 static PyObject *__pyx_convert_vector_to_py_std_3a__3a_vector_3c_int_3e___(std::vector<std::vector<int> >  const &); /*proto*/
-static PyObject *__pyx_convert_vector_to_py_float(std::vector<float>  const &); /*proto*/
-static PyObject *__pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___(std::vector<std::vector<float> >  const &); /*proto*/
 static int __pyx_array_allocate_buffer(struct __pyx_array_obj *); /*proto*/
 static struct __pyx_array_obj *__pyx_array_new(PyObject *, Py_ssize_t, char *, char *, char *); /*proto*/
 static PyObject *__pyx_memoryview_new(PyObject *, int, int, __Pyx_TypeInfo *); /*proto*/
 static CYTHON_INLINE int __pyx_memoryview_check(PyObject *); /*proto*/
 static PyObject *_unellipsify(PyObject *, int); /*proto*/
 static int assert_direct_dimensions(Py_ssize_t *, int); /*proto*/
 static struct __pyx_memoryview_obj *__pyx_memview_slice(struct __pyx_memoryview_obj *, PyObject *); /*proto*/
@@ -3260,22 +3263,22 @@
 static void __pyx_memoryview_refcount_copying(__Pyx_memviewslice *, int, int, int); /*proto*/
 static void __pyx_memoryview_refcount_objects_in_slice_with_gil(char *, Py_ssize_t *, Py_ssize_t *, int, int); /*proto*/
 static void __pyx_memoryview_refcount_objects_in_slice(char *, Py_ssize_t *, Py_ssize_t *, int, int); /*proto*/
 static void __pyx_memoryview_slice_assign_scalar(__Pyx_memviewslice *, int, size_t, void *, int); /*proto*/
 static void __pyx_memoryview__slice_assign_scalar(char *, Py_ssize_t *, Py_ssize_t *, int, size_t, void *); /*proto*/
 static PyObject *__pyx_unpickle_Enum__set_state(struct __pyx_MemviewEnum_obj *, PyObject *); /*proto*/
 /* #### Code section: typeinfo ### */
-static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_4pipi_UINT32_t = { "UINT32_t", NULL, sizeof(__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t), { 0 }, 0, __PYX_IS_UNSIGNED(__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t) ? 'U' : 'I', __PYX_IS_UNSIGNED(__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t), 0 };
-static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t = { "FLOAT32_t", NULL, sizeof(__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t), { 0 }, 0, 'R', 0, 0 };
+static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t = { "UINT32_t", NULL, sizeof(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t), { 0 }, 0, __PYX_IS_UNSIGNED(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t) ? 'U' : 'I', __PYX_IS_UNSIGNED(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t), 0 };
+static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t = { "FLOAT32_t", NULL, sizeof(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t), { 0 }, 0, 'R', 0, 0 };
 /* #### Code section: before_global_var ### */
-#define __Pyx_MODULE_NAME "moleculekit.interactions.pipi"
-extern int __pyx_module_is_main_moleculekit__interactions__pipi;
-int __pyx_module_is_main_moleculekit__interactions__pipi = 0;
+#define __Pyx_MODULE_NAME "moleculekit.interactions.hbonds"
+extern int __pyx_module_is_main_moleculekit__interactions__hbonds;
+int __pyx_module_is_main_moleculekit__interactions__hbonds = 0;
 
-/* Implementation of "moleculekit.interactions.pipi" */
+/* Implementation of "moleculekit.interactions.hbonds" */
 /* #### Code section: global_var ### */
 static PyObject *__pyx_builtin_range;
 static PyObject *__pyx_builtin_MemoryError;
 static PyObject *__pyx_builtin___import__;
 static PyObject *__pyx_builtin_ValueError;
 static PyObject *__pyx_builtin_enumerate;
 static PyObject *__pyx_builtin_TypeError;
@@ -3283,173 +3286,173 @@
 static PyObject *__pyx_builtin_Ellipsis;
 static PyObject *__pyx_builtin_id;
 static PyObject *__pyx_builtin_IndexError;
 static PyObject *__pyx_builtin_ImportError;
 /* #### Code section: string_decls ### */
 static const char __pyx_k_[] = ": ";
 static const char __pyx_k_O[] = "O";
+static const char __pyx_k_a[] = "a";
 static const char __pyx_k_c[] = "c";
+static const char __pyx_k_d[] = "d";
 static const char __pyx_k_f[] = "f";
 static const char __pyx_k_i[] = "i";
 static const char __pyx_k__2[] = ".";
 static const char __pyx_k__3[] = "*";
 static const char __pyx_k__6[] = "'";
 static const char __pyx_k__7[] = ")";
 static const char __pyx_k_gc[] = "gc";
 static const char __pyx_k_id[] = "id";
 static const char __pyx_k_np[] = "np";
-static const char __pyx_k_r1[] = "r1";
-static const char __pyx_k_r2[] = "r2";
 static const char __pyx_k__25[] = "?";
 static const char __pyx_k_abc[] = "abc";
 static const char __pyx_k_and[] = " and ";
 static const char __pyx_k_box[] = "box";
 static const char __pyx_k_got[] = " (got ";
 static const char __pyx_k_new[] = "__new__";
 static const char __pyx_k_obj[] = "obj";
 static const char __pyx_k_sys[] = "sys";
+static const char __pyx_k_val[] = "val";
 static const char __pyx_k_base[] = "base";
 static const char __pyx_k_dict[] = "__dict__";
 static const char __pyx_k_main[] = "__main__";
+static const char __pyx_k_math[] = "math";
 static const char __pyx_k_mode[] = "mode";
 static const char __pyx_k_name[] = "name";
 static const char __pyx_k_ndim[] = "ndim";
 static const char __pyx_k_pack[] = "pack";
+static const char __pyx_k_sel1[] = "sel1";
+static const char __pyx_k_sel2[] = "sel2";
 static const char __pyx_k_size[] = "size";
 static const char __pyx_k_spec[] = "__spec__";
+static const char __pyx_k_sqrt[] = "sqrt";
 static const char __pyx_k_step[] = "step";
 static const char __pyx_k_stop[] = "stop";
 static const char __pyx_k_test[] = "__test__";
-static const char __pyx_k_tmp1[] = "tmp1";
-static const char __pyx_k_tmp2[] = "tmp2";
 static const char __pyx_k_ASCII[] = "ASCII";
+static const char __pyx_k_a_idx[] = "a_idx";
 static const char __pyx_k_angle[] = "angle";
 static const char __pyx_k_class[] = "__class__";
 static const char __pyx_k_count[] = "count";
-static const char __pyx_k_dist2[] = "dist2";
+static const char __pyx_k_d_idx[] = "d_idx";
 static const char __pyx_k_dtype[] = "dtype";
 static const char __pyx_k_error[] = "error";
 static const char __pyx_k_flags[] = "flags";
 static const char __pyx_k_index[] = "index";
+static const char __pyx_k_intra[] = "intra";
 static const char __pyx_k_numpy[] = "numpy";
 static const char __pyx_k_range[] = "range";
 static const char __pyx_k_shape[] = "shape";
 static const char __pyx_k_start[] = "start";
 static const char __pyx_k_zeros[] = "zeros";
 static const char __pyx_k_UINT32[] = "UINT32";
 static const char __pyx_k_coords[] = "coords";
+static const char __pyx_k_donors[] = "donors";
 static const char __pyx_k_enable[] = "enable";
 static const char __pyx_k_encode[] = "encode";
 static const char __pyx_k_format[] = "format";
 static const char __pyx_k_import[] = "__import__";
 static const char __pyx_k_name_2[] = "__name__";
 static const char __pyx_k_pickle[] = "pickle";
 static const char __pyx_k_reduce[] = "__reduce__";
 static const char __pyx_k_struct[] = "struct";
 static const char __pyx_k_uint32[] = "uint32";
 static const char __pyx_k_unpack[] = "unpack";
 static const char __pyx_k_update[] = "update";
 static const char __pyx_k_FLOAT32[] = "FLOAT32";
+static const char __pyx_k_d_idx_d[] = "d_idx_d";
+static const char __pyx_k_d_idx_h[] = "d_idx_h";
 static const char __pyx_k_disable[] = "disable";
+static const char __pyx_k_dist2_a[] = "dist2_a";
+static const char __pyx_k_dist2_b[] = "dist2_b";
+static const char __pyx_k_dotprod[] = "dotprod";
 static const char __pyx_k_float32[] = "float32";
 static const char __pyx_k_fortran[] = "fortran";
 static const char __pyx_k_memview[] = "memview";
 static const char __pyx_k_results[] = "results";
 static const char __pyx_k_Ellipsis[] = "Ellipsis";
 static const char __pyx_k_Sequence[] = "Sequence";
-static const char __pyx_k_dot_prod[] = "dot_prod";
 static const char __pyx_k_getstate[] = "__getstate__";
 static const char __pyx_k_half_box[] = "half_box";
 static const char __pyx_k_itemsize[] = "itemsize";
+static const char __pyx_k_n_donors[] = "n_donors";
 static const char __pyx_k_n_frames[] = "n_frames";
-static const char __pyx_k_n_rings1[] = "n_rings1";
-static const char __pyx_k_n_rings2[] = "n_rings2";
 static const char __pyx_k_pyx_type[] = "__pyx_type";
 static const char __pyx_k_register[] = "register";
 static const char __pyx_k_setstate[] = "__setstate__";
 static const char __pyx_k_TypeError[] = "TypeError";
+static const char __pyx_k_acceptors[] = "acceptors";
 static const char __pyx_k_calculate[] = "calculate";
 static const char __pyx_k_enumerate[] = "enumerate";
+static const char __pyx_k_ignore_hs[] = "ignore_hs";
 static const char __pyx_k_isenabled[] = "isenabled";
 static const char __pyx_k_pyx_state[] = "__pyx_state";
 static const char __pyx_k_reduce_ex[] = "__reduce_ex__";
 static const char __pyx_k_IndexError[] = "IndexError";
 static const char __pyx_k_ValueError[] = "ValueError";
-static const char __pyx_k_distangles[] = "distangles";
+static const char __pyx_k_dist_vec_a[] = "dist_vec_a";
+static const char __pyx_k_dist_vec_b[] = "dist_vec_b";
 static const char __pyx_k_pyx_result[] = "__pyx_result";
 static const char __pyx_k_pyx_vtable[] = "__pyx_vtable__";
-static const char __pyx_k_r1_end_idx[] = "r1_end_idx";
-static const char __pyx_k_r2_end_idx[] = "r2_end_idx";
-static const char __pyx_k_ring1_mean[] = "ring1_mean";
-static const char __pyx_k_ring2_mean[] = "ring2_mean";
 static const char __pyx_k_ImportError[] = "ImportError";
 static const char __pyx_k_MemoryError[] = "MemoryError";
 static const char __pyx_k_PickleError[] = "PickleError";
 static const char __pyx_k_collections[] = "collections";
-static const char __pyx_k_rings_atoms[] = "rings_atoms";
+static const char __pyx_k_n_acceptors[] = "n_acceptors";
 static const char __pyx_k_initializing[] = "_initializing";
 static const char __pyx_k_is_coroutine[] = "_is_coroutine";
 static const char __pyx_k_pyx_checksum[] = "__pyx_checksum";
-static const char __pyx_k_r1_start_idx[] = "r1_start_idx";
-static const char __pyx_k_r2_start_idx[] = "r2_start_idx";
-static const char __pyx_k_ring1_normal[] = "ring1_normal";
-static const char __pyx_k_ring2_normal[] = "ring2_normal";
 static const char __pyx_k_stringsource[] = "<stringsource>";
 static const char __pyx_k_version_info[] = "version_info";
 static const char __pyx_k_class_getitem[] = "__class_getitem__";
 static const char __pyx_k_reduce_cython[] = "__reduce_cython__";
 static const char __pyx_k_AssertionError[] = "AssertionError";
+static const char __pyx_k_dist_threshold[] = "dist_threshold";
 static const char __pyx_k_View_MemoryView[] = "View.MemoryView";
 static const char __pyx_k_allocate_buffer[] = "allocate_buffer";
+static const char __pyx_k_angle_threshold[] = "angle_threshold";
 static const char __pyx_k_collections_abc[] = "collections.abc";
-static const char __pyx_k_dist_threshold1[] = "dist_threshold1";
-static const char __pyx_k_dist_threshold2[] = "dist_threshold2";
 static const char __pyx_k_dtype_is_object[] = "dtype_is_object";
 static const char __pyx_k_pyx_PickleError[] = "__pyx_PickleError";
 static const char __pyx_k_setstate_cython[] = "__setstate_cython__";
 static const char __pyx_k_pyx_unpickle_Enum[] = "__pyx_unpickle_Enum";
 static const char __pyx_k_asyncio_coroutines[] = "asyncio.coroutines";
 static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
 static const char __pyx_k_strided_and_direct[] = "<strided and direct>";
-static const char __pyx_k_angle_threshold1_max[] = "angle_threshold1_max";
-static const char __pyx_k_angle_threshold2_min[] = "angle_threshold2_min";
-static const char __pyx_k_rings1_start_indexes[] = "rings1_start_indexes";
-static const char __pyx_k_rings2_start_indexes[] = "rings2_start_indexes";
 static const char __pyx_k_strided_and_indirect[] = "<strided and indirect>";
 static const char __pyx_k_Invalid_shape_in_axis[] = "Invalid shape in axis ";
 static const char __pyx_k_contiguous_and_direct[] = "<contiguous and direct>";
 static const char __pyx_k_Cannot_index_with_type[] = "Cannot index with type '";
 static const char __pyx_k_MemoryView_of_r_object[] = "<MemoryView of %r object>";
 static const char __pyx_k_MemoryView_of_r_at_0x_x[] = "<MemoryView of %r at 0x%x>";
 static const char __pyx_k_contiguous_and_indirect[] = "<contiguous and indirect>";
 static const char __pyx_k_Dimension_d_is_not_direct[] = "Dimension %d is not direct";
 static const char __pyx_k_Index_out_of_bounds_axis_d[] = "Index out of bounds (axis %d)";
 static const char __pyx_k_Step_may_not_be_zero_axis_d[] = "Step may not be zero (axis %d)";
 static const char __pyx_k_itemsize_0_for_cython_array[] = "itemsize <= 0 for cython.array";
-static const char __pyx_k_moleculekit_interactions_pipi[] = "moleculekit.interactions.pipi";
 static const char __pyx_k_unable_to_allocate_array_data[] = "unable to allocate array data.";
 static const char __pyx_k_strided_and_direct_or_indirect[] = "<strided and direct or indirect>";
+static const char __pyx_k_moleculekit_interactions_hbonds[] = "moleculekit/interactions/hbonds/hbonds.pyx";
 static const char __pyx_k_numpy_core_multiarray_failed_to[] = "numpy.core.multiarray failed to import";
 static const char __pyx_k_All_dimensions_preceding_dimensi[] = "All dimensions preceding dimension %d must be indexed and not sliced";
 static const char __pyx_k_Buffer_view_does_not_expose_stri[] = "Buffer view does not expose strides";
 static const char __pyx_k_Can_only_create_a_buffer_that_is[] = "Can only create a buffer that is contiguous in memory.";
 static const char __pyx_k_Cannot_assign_to_read_only_memor[] = "Cannot assign to read-only memoryview";
 static const char __pyx_k_Cannot_create_writable_memory_vi[] = "Cannot create writable memory view from read-only memoryview";
 static const char __pyx_k_Cannot_transpose_memoryview_with[] = "Cannot transpose memoryview with indirect dimensions";
 static const char __pyx_k_Empty_shape_tuple_for_cython_arr[] = "Empty shape tuple for cython.array";
 static const char __pyx_k_Incompatible_checksums_0x_x_vs_0[] = "Incompatible checksums (0x%x vs (0x82a3537, 0x6ae9995, 0xb068931) = (name))";
 static const char __pyx_k_Indirect_dimensions_not_supporte[] = "Indirect dimensions not supported";
 static const char __pyx_k_Invalid_mode_expected_c_or_fortr[] = "Invalid mode, expected 'c' or 'fortran', got ";
 static const char __pyx_k_Out_of_bounds_on_buffer_access_a[] = "Out of bounds on buffer access (axis ";
 static const char __pyx_k_Unable_to_convert_item_to_object[] = "Unable to convert item to object";
 static const char __pyx_k_got_differing_extents_in_dimensi[] = "got differing extents in dimension ";
-static const char __pyx_k_moleculekit_interactions_pipi_pi[] = "moleculekit/interactions/pipi/pipi.pyx";
 static const char __pyx_k_no_default___reduce___due_to_non[] = "no default __reduce__ due to non-trivial __cinit__";
 static const char __pyx_k_numpy_core_umath_failed_to_impor[] = "numpy.core.umath failed to import";
 static const char __pyx_k_unable_to_allocate_shape_and_str[] = "unable to allocate shape and strides.";
+static const char __pyx_k_moleculekit_interactions_hbonds_2[] = "moleculekit.interactions.hbonds";
 /* #### Code section: decls ### */
 static int __pyx_array___pyx_pf_15View_dot_MemoryView_5array___cinit__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_shape, Py_ssize_t __pyx_v_itemsize, PyObject *__pyx_v_format, PyObject *__pyx_v_mode, int __pyx_v_allocate_buffer); /* proto */
 static int __pyx_array___pyx_pf_15View_dot_MemoryView_5array_2__getbuffer__(struct __pyx_array_obj *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags); /* proto */
 static void __pyx_array___pyx_pf_15View_dot_MemoryView_5array_4__dealloc__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView_5array_7memview___get__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static Py_ssize_t __pyx_array___pyx_pf_15View_dot_MemoryView_5array_6__len__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_array___pyx_pf_15View_dot_MemoryView_5array_8__getattr__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_attr); /* proto */
@@ -3484,15 +3487,15 @@
 static PyObject *__pyx_memoryview___pyx_pf_15View_dot_MemoryView_10memoryview_22copy_fortran(struct __pyx_memoryview_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryview___reduce_cython__(CYTHON_UNUSED struct __pyx_memoryview_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryview_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryview_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static void __pyx_memoryviewslice___pyx_pf_15View_dot_MemoryView_16_memoryviewslice___dealloc__(struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryviewslice___reduce_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryviewslice_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView___pyx_unpickle_Enum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v___pyx_type, long __pyx_v___pyx_checksum, PyObject *__pyx_v___pyx_state); /* proto */
-static PyObject *__pyx_pf_11moleculekit_12interactions_4pipi_calculate(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_rings_atoms, __Pyx_memviewslice __pyx_v_rings1_start_indexes, __Pyx_memviewslice __pyx_v_rings2_start_indexes, __Pyx_memviewslice __pyx_v_coords, __Pyx_memviewslice __pyx_v_box, float __pyx_v_dist_threshold1, float __pyx_v_angle_threshold1_max, float __pyx_v_dist_threshold2, float __pyx_v_angle_threshold2_min); /* proto */
+static PyObject *__pyx_pf_11moleculekit_12interactions_6hbonds_calculate(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_donors, PyArrayObject *__pyx_v_acceptors, PyArrayObject *__pyx_v_coords, PyArrayObject *__pyx_v_box, PyArrayObject *__pyx_v_sel1, PyArrayObject *__pyx_v_sel2, float __pyx_v_dist_threshold, float __pyx_v_angle_threshold, bool __pyx_v_intra, bool __pyx_v_ignore_hs); /* proto */
 static PyObject *__pyx_tp_new_array(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_Enum(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_memoryview(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new__memoryviewslice(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 /* #### Code section: late_includes ### */
 /* #### Code section: module_state ### */
 typedef struct {
@@ -3561,14 +3564,16 @@
   #if CYTHON_USE_MODULE_STATE
   #endif
   #if CYTHON_USE_MODULE_STATE
   #endif
   #if CYTHON_USE_MODULE_STATE
   #endif
   #if CYTHON_USE_MODULE_STATE
+  #endif
+  #if CYTHON_USE_MODULE_STATE
   PyObject *__pyx_type___pyx_array;
   PyObject *__pyx_type___pyx_MemviewEnum;
   PyObject *__pyx_type___pyx_memoryview;
   PyObject *__pyx_type___pyx_memoryviewslice;
   #endif
   PyTypeObject *__pyx_array_type;
   PyTypeObject *__pyx_MemviewEnum_type;
@@ -3609,20 +3614,22 @@
   PyObject *__pyx_n_s_ValueError;
   PyObject *__pyx_n_s_View_MemoryView;
   PyObject *__pyx_kp_u__2;
   PyObject *__pyx_n_s__25;
   PyObject *__pyx_n_s__3;
   PyObject *__pyx_kp_u__6;
   PyObject *__pyx_kp_u__7;
+  PyObject *__pyx_n_s_a;
+  PyObject *__pyx_n_s_a_idx;
   PyObject *__pyx_n_s_abc;
+  PyObject *__pyx_n_s_acceptors;
   PyObject *__pyx_n_s_allocate_buffer;
   PyObject *__pyx_kp_u_and;
   PyObject *__pyx_n_s_angle;
-  PyObject *__pyx_n_s_angle_threshold1_max;
-  PyObject *__pyx_n_s_angle_threshold2_min;
+  PyObject *__pyx_n_s_angle_threshold;
   PyObject *__pyx_n_s_asyncio_coroutines;
   PyObject *__pyx_n_s_base;
   PyObject *__pyx_n_s_box;
   PyObject *__pyx_n_s_c;
   PyObject *__pyx_n_u_c;
   PyObject *__pyx_n_s_calculate;
   PyObject *__pyx_n_s_class;
@@ -3630,21 +3637,27 @@
   PyObject *__pyx_n_s_cline_in_traceback;
   PyObject *__pyx_n_s_collections;
   PyObject *__pyx_kp_s_collections_abc;
   PyObject *__pyx_kp_s_contiguous_and_direct;
   PyObject *__pyx_kp_s_contiguous_and_indirect;
   PyObject *__pyx_n_s_coords;
   PyObject *__pyx_n_s_count;
+  PyObject *__pyx_n_s_d;
+  PyObject *__pyx_n_s_d_idx;
+  PyObject *__pyx_n_s_d_idx_d;
+  PyObject *__pyx_n_s_d_idx_h;
   PyObject *__pyx_n_s_dict;
   PyObject *__pyx_kp_u_disable;
-  PyObject *__pyx_n_s_dist2;
-  PyObject *__pyx_n_s_dist_threshold1;
-  PyObject *__pyx_n_s_dist_threshold2;
-  PyObject *__pyx_n_s_distangles;
-  PyObject *__pyx_n_s_dot_prod;
+  PyObject *__pyx_n_s_dist2_a;
+  PyObject *__pyx_n_s_dist2_b;
+  PyObject *__pyx_n_s_dist_threshold;
+  PyObject *__pyx_n_s_dist_vec_a;
+  PyObject *__pyx_n_s_dist_vec_b;
+  PyObject *__pyx_n_s_donors;
+  PyObject *__pyx_n_s_dotprod;
   PyObject *__pyx_n_s_dtype;
   PyObject *__pyx_n_s_dtype_is_object;
   PyObject *__pyx_kp_u_enable;
   PyObject *__pyx_n_s_encode;
   PyObject *__pyx_n_s_enumerate;
   PyObject *__pyx_n_s_error;
   PyObject *__pyx_n_s_f;
@@ -3656,29 +3669,32 @@
   PyObject *__pyx_kp_u_gc;
   PyObject *__pyx_n_s_getstate;
   PyObject *__pyx_kp_u_got;
   PyObject *__pyx_kp_u_got_differing_extents_in_dimensi;
   PyObject *__pyx_n_s_half_box;
   PyObject *__pyx_n_s_i;
   PyObject *__pyx_n_s_id;
+  PyObject *__pyx_n_s_ignore_hs;
   PyObject *__pyx_n_s_import;
   PyObject *__pyx_n_s_index;
   PyObject *__pyx_n_s_initializing;
+  PyObject *__pyx_n_s_intra;
   PyObject *__pyx_n_s_is_coroutine;
   PyObject *__pyx_kp_u_isenabled;
   PyObject *__pyx_n_s_itemsize;
   PyObject *__pyx_kp_s_itemsize_0_for_cython_array;
   PyObject *__pyx_n_s_main;
+  PyObject *__pyx_n_s_math;
   PyObject *__pyx_n_s_memview;
   PyObject *__pyx_n_s_mode;
-  PyObject *__pyx_n_s_moleculekit_interactions_pipi;
-  PyObject *__pyx_kp_s_moleculekit_interactions_pipi_pi;
+  PyObject *__pyx_kp_s_moleculekit_interactions_hbonds;
+  PyObject *__pyx_n_s_moleculekit_interactions_hbonds_2;
+  PyObject *__pyx_n_s_n_acceptors;
+  PyObject *__pyx_n_s_n_donors;
   PyObject *__pyx_n_s_n_frames;
-  PyObject *__pyx_n_s_n_rings1;
-  PyObject *__pyx_n_s_n_rings2;
   PyObject *__pyx_n_s_name;
   PyObject *__pyx_n_s_name_2;
   PyObject *__pyx_n_s_ndim;
   PyObject *__pyx_n_s_new;
   PyObject *__pyx_kp_s_no_default___reduce___due_to_non;
   PyObject *__pyx_n_s_np;
   PyObject *__pyx_n_s_numpy;
@@ -3690,55 +3706,44 @@
   PyObject *__pyx_n_s_pyx_PickleError;
   PyObject *__pyx_n_s_pyx_checksum;
   PyObject *__pyx_n_s_pyx_result;
   PyObject *__pyx_n_s_pyx_state;
   PyObject *__pyx_n_s_pyx_type;
   PyObject *__pyx_n_s_pyx_unpickle_Enum;
   PyObject *__pyx_n_s_pyx_vtable;
-  PyObject *__pyx_n_s_r1;
-  PyObject *__pyx_n_s_r1_end_idx;
-  PyObject *__pyx_n_s_r1_start_idx;
-  PyObject *__pyx_n_s_r2;
-  PyObject *__pyx_n_s_r2_end_idx;
-  PyObject *__pyx_n_s_r2_start_idx;
   PyObject *__pyx_n_s_range;
   PyObject *__pyx_n_s_reduce;
   PyObject *__pyx_n_s_reduce_cython;
   PyObject *__pyx_n_s_reduce_ex;
   PyObject *__pyx_n_s_register;
   PyObject *__pyx_n_s_results;
-  PyObject *__pyx_n_s_ring1_mean;
-  PyObject *__pyx_n_s_ring1_normal;
-  PyObject *__pyx_n_s_ring2_mean;
-  PyObject *__pyx_n_s_ring2_normal;
-  PyObject *__pyx_n_s_rings1_start_indexes;
-  PyObject *__pyx_n_s_rings2_start_indexes;
-  PyObject *__pyx_n_s_rings_atoms;
+  PyObject *__pyx_n_s_sel1;
+  PyObject *__pyx_n_s_sel2;
   PyObject *__pyx_n_s_setstate;
   PyObject *__pyx_n_s_setstate_cython;
   PyObject *__pyx_n_s_shape;
   PyObject *__pyx_n_s_size;
   PyObject *__pyx_n_s_spec;
+  PyObject *__pyx_n_s_sqrt;
   PyObject *__pyx_n_s_start;
   PyObject *__pyx_n_s_step;
   PyObject *__pyx_n_s_stop;
   PyObject *__pyx_kp_s_strided_and_direct;
   PyObject *__pyx_kp_s_strided_and_direct_or_indirect;
   PyObject *__pyx_kp_s_strided_and_indirect;
   PyObject *__pyx_kp_s_stringsource;
   PyObject *__pyx_n_s_struct;
   PyObject *__pyx_n_s_sys;
   PyObject *__pyx_n_s_test;
-  PyObject *__pyx_n_s_tmp1;
-  PyObject *__pyx_n_s_tmp2;
   PyObject *__pyx_n_s_uint32;
   PyObject *__pyx_kp_s_unable_to_allocate_array_data;
   PyObject *__pyx_kp_s_unable_to_allocate_shape_and_str;
   PyObject *__pyx_n_s_unpack;
   PyObject *__pyx_n_s_update;
+  PyObject *__pyx_n_s_val;
   PyObject *__pyx_n_s_version_info;
   PyObject *__pyx_n_s_zeros;
   PyObject *__pyx_int_0;
   PyObject *__pyx_int_1;
   PyObject *__pyx_int_3;
   PyObject *__pyx_int_112105877;
   PyObject *__pyx_int_136983863;
@@ -3864,20 +3869,22 @@
   Py_CLEAR(clear_module_state->__pyx_n_s_ValueError);
   Py_CLEAR(clear_module_state->__pyx_n_s_View_MemoryView);
   Py_CLEAR(clear_module_state->__pyx_kp_u__2);
   Py_CLEAR(clear_module_state->__pyx_n_s__25);
   Py_CLEAR(clear_module_state->__pyx_n_s__3);
   Py_CLEAR(clear_module_state->__pyx_kp_u__6);
   Py_CLEAR(clear_module_state->__pyx_kp_u__7);
+  Py_CLEAR(clear_module_state->__pyx_n_s_a);
+  Py_CLEAR(clear_module_state->__pyx_n_s_a_idx);
   Py_CLEAR(clear_module_state->__pyx_n_s_abc);
+  Py_CLEAR(clear_module_state->__pyx_n_s_acceptors);
   Py_CLEAR(clear_module_state->__pyx_n_s_allocate_buffer);
   Py_CLEAR(clear_module_state->__pyx_kp_u_and);
   Py_CLEAR(clear_module_state->__pyx_n_s_angle);
-  Py_CLEAR(clear_module_state->__pyx_n_s_angle_threshold1_max);
-  Py_CLEAR(clear_module_state->__pyx_n_s_angle_threshold2_min);
+  Py_CLEAR(clear_module_state->__pyx_n_s_angle_threshold);
   Py_CLEAR(clear_module_state->__pyx_n_s_asyncio_coroutines);
   Py_CLEAR(clear_module_state->__pyx_n_s_base);
   Py_CLEAR(clear_module_state->__pyx_n_s_box);
   Py_CLEAR(clear_module_state->__pyx_n_s_c);
   Py_CLEAR(clear_module_state->__pyx_n_u_c);
   Py_CLEAR(clear_module_state->__pyx_n_s_calculate);
   Py_CLEAR(clear_module_state->__pyx_n_s_class);
@@ -3885,21 +3892,27 @@
   Py_CLEAR(clear_module_state->__pyx_n_s_cline_in_traceback);
   Py_CLEAR(clear_module_state->__pyx_n_s_collections);
   Py_CLEAR(clear_module_state->__pyx_kp_s_collections_abc);
   Py_CLEAR(clear_module_state->__pyx_kp_s_contiguous_and_direct);
   Py_CLEAR(clear_module_state->__pyx_kp_s_contiguous_and_indirect);
   Py_CLEAR(clear_module_state->__pyx_n_s_coords);
   Py_CLEAR(clear_module_state->__pyx_n_s_count);
+  Py_CLEAR(clear_module_state->__pyx_n_s_d);
+  Py_CLEAR(clear_module_state->__pyx_n_s_d_idx);
+  Py_CLEAR(clear_module_state->__pyx_n_s_d_idx_d);
+  Py_CLEAR(clear_module_state->__pyx_n_s_d_idx_h);
   Py_CLEAR(clear_module_state->__pyx_n_s_dict);
   Py_CLEAR(clear_module_state->__pyx_kp_u_disable);
-  Py_CLEAR(clear_module_state->__pyx_n_s_dist2);
-  Py_CLEAR(clear_module_state->__pyx_n_s_dist_threshold1);
-  Py_CLEAR(clear_module_state->__pyx_n_s_dist_threshold2);
-  Py_CLEAR(clear_module_state->__pyx_n_s_distangles);
-  Py_CLEAR(clear_module_state->__pyx_n_s_dot_prod);
+  Py_CLEAR(clear_module_state->__pyx_n_s_dist2_a);
+  Py_CLEAR(clear_module_state->__pyx_n_s_dist2_b);
+  Py_CLEAR(clear_module_state->__pyx_n_s_dist_threshold);
+  Py_CLEAR(clear_module_state->__pyx_n_s_dist_vec_a);
+  Py_CLEAR(clear_module_state->__pyx_n_s_dist_vec_b);
+  Py_CLEAR(clear_module_state->__pyx_n_s_donors);
+  Py_CLEAR(clear_module_state->__pyx_n_s_dotprod);
   Py_CLEAR(clear_module_state->__pyx_n_s_dtype);
   Py_CLEAR(clear_module_state->__pyx_n_s_dtype_is_object);
   Py_CLEAR(clear_module_state->__pyx_kp_u_enable);
   Py_CLEAR(clear_module_state->__pyx_n_s_encode);
   Py_CLEAR(clear_module_state->__pyx_n_s_enumerate);
   Py_CLEAR(clear_module_state->__pyx_n_s_error);
   Py_CLEAR(clear_module_state->__pyx_n_s_f);
@@ -3911,29 +3924,32 @@
   Py_CLEAR(clear_module_state->__pyx_kp_u_gc);
   Py_CLEAR(clear_module_state->__pyx_n_s_getstate);
   Py_CLEAR(clear_module_state->__pyx_kp_u_got);
   Py_CLEAR(clear_module_state->__pyx_kp_u_got_differing_extents_in_dimensi);
   Py_CLEAR(clear_module_state->__pyx_n_s_half_box);
   Py_CLEAR(clear_module_state->__pyx_n_s_i);
   Py_CLEAR(clear_module_state->__pyx_n_s_id);
+  Py_CLEAR(clear_module_state->__pyx_n_s_ignore_hs);
   Py_CLEAR(clear_module_state->__pyx_n_s_import);
   Py_CLEAR(clear_module_state->__pyx_n_s_index);
   Py_CLEAR(clear_module_state->__pyx_n_s_initializing);
+  Py_CLEAR(clear_module_state->__pyx_n_s_intra);
   Py_CLEAR(clear_module_state->__pyx_n_s_is_coroutine);
   Py_CLEAR(clear_module_state->__pyx_kp_u_isenabled);
   Py_CLEAR(clear_module_state->__pyx_n_s_itemsize);
   Py_CLEAR(clear_module_state->__pyx_kp_s_itemsize_0_for_cython_array);
   Py_CLEAR(clear_module_state->__pyx_n_s_main);
+  Py_CLEAR(clear_module_state->__pyx_n_s_math);
   Py_CLEAR(clear_module_state->__pyx_n_s_memview);
   Py_CLEAR(clear_module_state->__pyx_n_s_mode);
-  Py_CLEAR(clear_module_state->__pyx_n_s_moleculekit_interactions_pipi);
-  Py_CLEAR(clear_module_state->__pyx_kp_s_moleculekit_interactions_pipi_pi);
+  Py_CLEAR(clear_module_state->__pyx_kp_s_moleculekit_interactions_hbonds);
+  Py_CLEAR(clear_module_state->__pyx_n_s_moleculekit_interactions_hbonds_2);
+  Py_CLEAR(clear_module_state->__pyx_n_s_n_acceptors);
+  Py_CLEAR(clear_module_state->__pyx_n_s_n_donors);
   Py_CLEAR(clear_module_state->__pyx_n_s_n_frames);
-  Py_CLEAR(clear_module_state->__pyx_n_s_n_rings1);
-  Py_CLEAR(clear_module_state->__pyx_n_s_n_rings2);
   Py_CLEAR(clear_module_state->__pyx_n_s_name);
   Py_CLEAR(clear_module_state->__pyx_n_s_name_2);
   Py_CLEAR(clear_module_state->__pyx_n_s_ndim);
   Py_CLEAR(clear_module_state->__pyx_n_s_new);
   Py_CLEAR(clear_module_state->__pyx_kp_s_no_default___reduce___due_to_non);
   Py_CLEAR(clear_module_state->__pyx_n_s_np);
   Py_CLEAR(clear_module_state->__pyx_n_s_numpy);
@@ -3945,55 +3961,44 @@
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_PickleError);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_checksum);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_result);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_state);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_type);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_unpickle_Enum);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_vtable);
-  Py_CLEAR(clear_module_state->__pyx_n_s_r1);
-  Py_CLEAR(clear_module_state->__pyx_n_s_r1_end_idx);
-  Py_CLEAR(clear_module_state->__pyx_n_s_r1_start_idx);
-  Py_CLEAR(clear_module_state->__pyx_n_s_r2);
-  Py_CLEAR(clear_module_state->__pyx_n_s_r2_end_idx);
-  Py_CLEAR(clear_module_state->__pyx_n_s_r2_start_idx);
   Py_CLEAR(clear_module_state->__pyx_n_s_range);
   Py_CLEAR(clear_module_state->__pyx_n_s_reduce);
   Py_CLEAR(clear_module_state->__pyx_n_s_reduce_cython);
   Py_CLEAR(clear_module_state->__pyx_n_s_reduce_ex);
   Py_CLEAR(clear_module_state->__pyx_n_s_register);
   Py_CLEAR(clear_module_state->__pyx_n_s_results);
-  Py_CLEAR(clear_module_state->__pyx_n_s_ring1_mean);
-  Py_CLEAR(clear_module_state->__pyx_n_s_ring1_normal);
-  Py_CLEAR(clear_module_state->__pyx_n_s_ring2_mean);
-  Py_CLEAR(clear_module_state->__pyx_n_s_ring2_normal);
-  Py_CLEAR(clear_module_state->__pyx_n_s_rings1_start_indexes);
-  Py_CLEAR(clear_module_state->__pyx_n_s_rings2_start_indexes);
-  Py_CLEAR(clear_module_state->__pyx_n_s_rings_atoms);
+  Py_CLEAR(clear_module_state->__pyx_n_s_sel1);
+  Py_CLEAR(clear_module_state->__pyx_n_s_sel2);
   Py_CLEAR(clear_module_state->__pyx_n_s_setstate);
   Py_CLEAR(clear_module_state->__pyx_n_s_setstate_cython);
   Py_CLEAR(clear_module_state->__pyx_n_s_shape);
   Py_CLEAR(clear_module_state->__pyx_n_s_size);
   Py_CLEAR(clear_module_state->__pyx_n_s_spec);
+  Py_CLEAR(clear_module_state->__pyx_n_s_sqrt);
   Py_CLEAR(clear_module_state->__pyx_n_s_start);
   Py_CLEAR(clear_module_state->__pyx_n_s_step);
   Py_CLEAR(clear_module_state->__pyx_n_s_stop);
   Py_CLEAR(clear_module_state->__pyx_kp_s_strided_and_direct);
   Py_CLEAR(clear_module_state->__pyx_kp_s_strided_and_direct_or_indirect);
   Py_CLEAR(clear_module_state->__pyx_kp_s_strided_and_indirect);
   Py_CLEAR(clear_module_state->__pyx_kp_s_stringsource);
   Py_CLEAR(clear_module_state->__pyx_n_s_struct);
   Py_CLEAR(clear_module_state->__pyx_n_s_sys);
   Py_CLEAR(clear_module_state->__pyx_n_s_test);
-  Py_CLEAR(clear_module_state->__pyx_n_s_tmp1);
-  Py_CLEAR(clear_module_state->__pyx_n_s_tmp2);
   Py_CLEAR(clear_module_state->__pyx_n_s_uint32);
   Py_CLEAR(clear_module_state->__pyx_kp_s_unable_to_allocate_array_data);
   Py_CLEAR(clear_module_state->__pyx_kp_s_unable_to_allocate_shape_and_str);
   Py_CLEAR(clear_module_state->__pyx_n_s_unpack);
   Py_CLEAR(clear_module_state->__pyx_n_s_update);
+  Py_CLEAR(clear_module_state->__pyx_n_s_val);
   Py_CLEAR(clear_module_state->__pyx_n_s_version_info);
   Py_CLEAR(clear_module_state->__pyx_n_s_zeros);
   Py_CLEAR(clear_module_state->__pyx_int_0);
   Py_CLEAR(clear_module_state->__pyx_int_1);
   Py_CLEAR(clear_module_state->__pyx_int_3);
   Py_CLEAR(clear_module_state->__pyx_int_112105877);
   Py_CLEAR(clear_module_state->__pyx_int_136983863);
@@ -4097,20 +4102,22 @@
   Py_VISIT(traverse_module_state->__pyx_n_s_ValueError);
   Py_VISIT(traverse_module_state->__pyx_n_s_View_MemoryView);
   Py_VISIT(traverse_module_state->__pyx_kp_u__2);
   Py_VISIT(traverse_module_state->__pyx_n_s__25);
   Py_VISIT(traverse_module_state->__pyx_n_s__3);
   Py_VISIT(traverse_module_state->__pyx_kp_u__6);
   Py_VISIT(traverse_module_state->__pyx_kp_u__7);
+  Py_VISIT(traverse_module_state->__pyx_n_s_a);
+  Py_VISIT(traverse_module_state->__pyx_n_s_a_idx);
   Py_VISIT(traverse_module_state->__pyx_n_s_abc);
+  Py_VISIT(traverse_module_state->__pyx_n_s_acceptors);
   Py_VISIT(traverse_module_state->__pyx_n_s_allocate_buffer);
   Py_VISIT(traverse_module_state->__pyx_kp_u_and);
   Py_VISIT(traverse_module_state->__pyx_n_s_angle);
-  Py_VISIT(traverse_module_state->__pyx_n_s_angle_threshold1_max);
-  Py_VISIT(traverse_module_state->__pyx_n_s_angle_threshold2_min);
+  Py_VISIT(traverse_module_state->__pyx_n_s_angle_threshold);
   Py_VISIT(traverse_module_state->__pyx_n_s_asyncio_coroutines);
   Py_VISIT(traverse_module_state->__pyx_n_s_base);
   Py_VISIT(traverse_module_state->__pyx_n_s_box);
   Py_VISIT(traverse_module_state->__pyx_n_s_c);
   Py_VISIT(traverse_module_state->__pyx_n_u_c);
   Py_VISIT(traverse_module_state->__pyx_n_s_calculate);
   Py_VISIT(traverse_module_state->__pyx_n_s_class);
@@ -4118,21 +4125,27 @@
   Py_VISIT(traverse_module_state->__pyx_n_s_cline_in_traceback);
   Py_VISIT(traverse_module_state->__pyx_n_s_collections);
   Py_VISIT(traverse_module_state->__pyx_kp_s_collections_abc);
   Py_VISIT(traverse_module_state->__pyx_kp_s_contiguous_and_direct);
   Py_VISIT(traverse_module_state->__pyx_kp_s_contiguous_and_indirect);
   Py_VISIT(traverse_module_state->__pyx_n_s_coords);
   Py_VISIT(traverse_module_state->__pyx_n_s_count);
+  Py_VISIT(traverse_module_state->__pyx_n_s_d);
+  Py_VISIT(traverse_module_state->__pyx_n_s_d_idx);
+  Py_VISIT(traverse_module_state->__pyx_n_s_d_idx_d);
+  Py_VISIT(traverse_module_state->__pyx_n_s_d_idx_h);
   Py_VISIT(traverse_module_state->__pyx_n_s_dict);
   Py_VISIT(traverse_module_state->__pyx_kp_u_disable);
-  Py_VISIT(traverse_module_state->__pyx_n_s_dist2);
-  Py_VISIT(traverse_module_state->__pyx_n_s_dist_threshold1);
-  Py_VISIT(traverse_module_state->__pyx_n_s_dist_threshold2);
-  Py_VISIT(traverse_module_state->__pyx_n_s_distangles);
-  Py_VISIT(traverse_module_state->__pyx_n_s_dot_prod);
+  Py_VISIT(traverse_module_state->__pyx_n_s_dist2_a);
+  Py_VISIT(traverse_module_state->__pyx_n_s_dist2_b);
+  Py_VISIT(traverse_module_state->__pyx_n_s_dist_threshold);
+  Py_VISIT(traverse_module_state->__pyx_n_s_dist_vec_a);
+  Py_VISIT(traverse_module_state->__pyx_n_s_dist_vec_b);
+  Py_VISIT(traverse_module_state->__pyx_n_s_donors);
+  Py_VISIT(traverse_module_state->__pyx_n_s_dotprod);
   Py_VISIT(traverse_module_state->__pyx_n_s_dtype);
   Py_VISIT(traverse_module_state->__pyx_n_s_dtype_is_object);
   Py_VISIT(traverse_module_state->__pyx_kp_u_enable);
   Py_VISIT(traverse_module_state->__pyx_n_s_encode);
   Py_VISIT(traverse_module_state->__pyx_n_s_enumerate);
   Py_VISIT(traverse_module_state->__pyx_n_s_error);
   Py_VISIT(traverse_module_state->__pyx_n_s_f);
@@ -4144,29 +4157,32 @@
   Py_VISIT(traverse_module_state->__pyx_kp_u_gc);
   Py_VISIT(traverse_module_state->__pyx_n_s_getstate);
   Py_VISIT(traverse_module_state->__pyx_kp_u_got);
   Py_VISIT(traverse_module_state->__pyx_kp_u_got_differing_extents_in_dimensi);
   Py_VISIT(traverse_module_state->__pyx_n_s_half_box);
   Py_VISIT(traverse_module_state->__pyx_n_s_i);
   Py_VISIT(traverse_module_state->__pyx_n_s_id);
+  Py_VISIT(traverse_module_state->__pyx_n_s_ignore_hs);
   Py_VISIT(traverse_module_state->__pyx_n_s_import);
   Py_VISIT(traverse_module_state->__pyx_n_s_index);
   Py_VISIT(traverse_module_state->__pyx_n_s_initializing);
+  Py_VISIT(traverse_module_state->__pyx_n_s_intra);
   Py_VISIT(traverse_module_state->__pyx_n_s_is_coroutine);
   Py_VISIT(traverse_module_state->__pyx_kp_u_isenabled);
   Py_VISIT(traverse_module_state->__pyx_n_s_itemsize);
   Py_VISIT(traverse_module_state->__pyx_kp_s_itemsize_0_for_cython_array);
   Py_VISIT(traverse_module_state->__pyx_n_s_main);
+  Py_VISIT(traverse_module_state->__pyx_n_s_math);
   Py_VISIT(traverse_module_state->__pyx_n_s_memview);
   Py_VISIT(traverse_module_state->__pyx_n_s_mode);
-  Py_VISIT(traverse_module_state->__pyx_n_s_moleculekit_interactions_pipi);
-  Py_VISIT(traverse_module_state->__pyx_kp_s_moleculekit_interactions_pipi_pi);
+  Py_VISIT(traverse_module_state->__pyx_kp_s_moleculekit_interactions_hbonds);
+  Py_VISIT(traverse_module_state->__pyx_n_s_moleculekit_interactions_hbonds_2);
+  Py_VISIT(traverse_module_state->__pyx_n_s_n_acceptors);
+  Py_VISIT(traverse_module_state->__pyx_n_s_n_donors);
   Py_VISIT(traverse_module_state->__pyx_n_s_n_frames);
-  Py_VISIT(traverse_module_state->__pyx_n_s_n_rings1);
-  Py_VISIT(traverse_module_state->__pyx_n_s_n_rings2);
   Py_VISIT(traverse_module_state->__pyx_n_s_name);
   Py_VISIT(traverse_module_state->__pyx_n_s_name_2);
   Py_VISIT(traverse_module_state->__pyx_n_s_ndim);
   Py_VISIT(traverse_module_state->__pyx_n_s_new);
   Py_VISIT(traverse_module_state->__pyx_kp_s_no_default___reduce___due_to_non);
   Py_VISIT(traverse_module_state->__pyx_n_s_np);
   Py_VISIT(traverse_module_state->__pyx_n_s_numpy);
@@ -4178,55 +4194,44 @@
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_PickleError);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_checksum);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_result);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_state);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_type);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_unpickle_Enum);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_vtable);
-  Py_VISIT(traverse_module_state->__pyx_n_s_r1);
-  Py_VISIT(traverse_module_state->__pyx_n_s_r1_end_idx);
-  Py_VISIT(traverse_module_state->__pyx_n_s_r1_start_idx);
-  Py_VISIT(traverse_module_state->__pyx_n_s_r2);
-  Py_VISIT(traverse_module_state->__pyx_n_s_r2_end_idx);
-  Py_VISIT(traverse_module_state->__pyx_n_s_r2_start_idx);
   Py_VISIT(traverse_module_state->__pyx_n_s_range);
   Py_VISIT(traverse_module_state->__pyx_n_s_reduce);
   Py_VISIT(traverse_module_state->__pyx_n_s_reduce_cython);
   Py_VISIT(traverse_module_state->__pyx_n_s_reduce_ex);
   Py_VISIT(traverse_module_state->__pyx_n_s_register);
   Py_VISIT(traverse_module_state->__pyx_n_s_results);
-  Py_VISIT(traverse_module_state->__pyx_n_s_ring1_mean);
-  Py_VISIT(traverse_module_state->__pyx_n_s_ring1_normal);
-  Py_VISIT(traverse_module_state->__pyx_n_s_ring2_mean);
-  Py_VISIT(traverse_module_state->__pyx_n_s_ring2_normal);
-  Py_VISIT(traverse_module_state->__pyx_n_s_rings1_start_indexes);
-  Py_VISIT(traverse_module_state->__pyx_n_s_rings2_start_indexes);
-  Py_VISIT(traverse_module_state->__pyx_n_s_rings_atoms);
+  Py_VISIT(traverse_module_state->__pyx_n_s_sel1);
+  Py_VISIT(traverse_module_state->__pyx_n_s_sel2);
   Py_VISIT(traverse_module_state->__pyx_n_s_setstate);
   Py_VISIT(traverse_module_state->__pyx_n_s_setstate_cython);
   Py_VISIT(traverse_module_state->__pyx_n_s_shape);
   Py_VISIT(traverse_module_state->__pyx_n_s_size);
   Py_VISIT(traverse_module_state->__pyx_n_s_spec);
+  Py_VISIT(traverse_module_state->__pyx_n_s_sqrt);
   Py_VISIT(traverse_module_state->__pyx_n_s_start);
   Py_VISIT(traverse_module_state->__pyx_n_s_step);
   Py_VISIT(traverse_module_state->__pyx_n_s_stop);
   Py_VISIT(traverse_module_state->__pyx_kp_s_strided_and_direct);
   Py_VISIT(traverse_module_state->__pyx_kp_s_strided_and_direct_or_indirect);
   Py_VISIT(traverse_module_state->__pyx_kp_s_strided_and_indirect);
   Py_VISIT(traverse_module_state->__pyx_kp_s_stringsource);
   Py_VISIT(traverse_module_state->__pyx_n_s_struct);
   Py_VISIT(traverse_module_state->__pyx_n_s_sys);
   Py_VISIT(traverse_module_state->__pyx_n_s_test);
-  Py_VISIT(traverse_module_state->__pyx_n_s_tmp1);
-  Py_VISIT(traverse_module_state->__pyx_n_s_tmp2);
   Py_VISIT(traverse_module_state->__pyx_n_s_uint32);
   Py_VISIT(traverse_module_state->__pyx_kp_s_unable_to_allocate_array_data);
   Py_VISIT(traverse_module_state->__pyx_kp_s_unable_to_allocate_shape_and_str);
   Py_VISIT(traverse_module_state->__pyx_n_s_unpack);
   Py_VISIT(traverse_module_state->__pyx_n_s_update);
+  Py_VISIT(traverse_module_state->__pyx_n_s_val);
   Py_VISIT(traverse_module_state->__pyx_n_s_version_info);
   Py_VISIT(traverse_module_state->__pyx_n_s_zeros);
   Py_VISIT(traverse_module_state->__pyx_int_0);
   Py_VISIT(traverse_module_state->__pyx_int_1);
   Py_VISIT(traverse_module_state->__pyx_int_3);
   Py_VISIT(traverse_module_state->__pyx_int_112105877);
   Py_VISIT(traverse_module_state->__pyx_int_136983863);
@@ -4320,14 +4325,16 @@
 #if CYTHON_USE_MODULE_STATE
 #endif
 #if CYTHON_USE_MODULE_STATE
 #endif
 #if CYTHON_USE_MODULE_STATE
 #endif
 #if CYTHON_USE_MODULE_STATE
+#endif
+#if CYTHON_USE_MODULE_STATE
 #define __pyx_type___pyx_array __pyx_mstate_global->__pyx_type___pyx_array
 #define __pyx_type___pyx_MemviewEnum __pyx_mstate_global->__pyx_type___pyx_MemviewEnum
 #define __pyx_type___pyx_memoryview __pyx_mstate_global->__pyx_type___pyx_memoryview
 #define __pyx_type___pyx_memoryviewslice __pyx_mstate_global->__pyx_type___pyx_memoryviewslice
 #endif
 #define __pyx_array_type __pyx_mstate_global->__pyx_array_type
 #define __pyx_MemviewEnum_type __pyx_mstate_global->__pyx_MemviewEnum_type
@@ -4368,20 +4375,22 @@
 #define __pyx_n_s_ValueError __pyx_mstate_global->__pyx_n_s_ValueError
 #define __pyx_n_s_View_MemoryView __pyx_mstate_global->__pyx_n_s_View_MemoryView
 #define __pyx_kp_u__2 __pyx_mstate_global->__pyx_kp_u__2
 #define __pyx_n_s__25 __pyx_mstate_global->__pyx_n_s__25
 #define __pyx_n_s__3 __pyx_mstate_global->__pyx_n_s__3
 #define __pyx_kp_u__6 __pyx_mstate_global->__pyx_kp_u__6
 #define __pyx_kp_u__7 __pyx_mstate_global->__pyx_kp_u__7
+#define __pyx_n_s_a __pyx_mstate_global->__pyx_n_s_a
+#define __pyx_n_s_a_idx __pyx_mstate_global->__pyx_n_s_a_idx
 #define __pyx_n_s_abc __pyx_mstate_global->__pyx_n_s_abc
+#define __pyx_n_s_acceptors __pyx_mstate_global->__pyx_n_s_acceptors
 #define __pyx_n_s_allocate_buffer __pyx_mstate_global->__pyx_n_s_allocate_buffer
 #define __pyx_kp_u_and __pyx_mstate_global->__pyx_kp_u_and
 #define __pyx_n_s_angle __pyx_mstate_global->__pyx_n_s_angle
-#define __pyx_n_s_angle_threshold1_max __pyx_mstate_global->__pyx_n_s_angle_threshold1_max
-#define __pyx_n_s_angle_threshold2_min __pyx_mstate_global->__pyx_n_s_angle_threshold2_min
+#define __pyx_n_s_angle_threshold __pyx_mstate_global->__pyx_n_s_angle_threshold
 #define __pyx_n_s_asyncio_coroutines __pyx_mstate_global->__pyx_n_s_asyncio_coroutines
 #define __pyx_n_s_base __pyx_mstate_global->__pyx_n_s_base
 #define __pyx_n_s_box __pyx_mstate_global->__pyx_n_s_box
 #define __pyx_n_s_c __pyx_mstate_global->__pyx_n_s_c
 #define __pyx_n_u_c __pyx_mstate_global->__pyx_n_u_c
 #define __pyx_n_s_calculate __pyx_mstate_global->__pyx_n_s_calculate
 #define __pyx_n_s_class __pyx_mstate_global->__pyx_n_s_class
@@ -4389,21 +4398,27 @@
 #define __pyx_n_s_cline_in_traceback __pyx_mstate_global->__pyx_n_s_cline_in_traceback
 #define __pyx_n_s_collections __pyx_mstate_global->__pyx_n_s_collections
 #define __pyx_kp_s_collections_abc __pyx_mstate_global->__pyx_kp_s_collections_abc
 #define __pyx_kp_s_contiguous_and_direct __pyx_mstate_global->__pyx_kp_s_contiguous_and_direct
 #define __pyx_kp_s_contiguous_and_indirect __pyx_mstate_global->__pyx_kp_s_contiguous_and_indirect
 #define __pyx_n_s_coords __pyx_mstate_global->__pyx_n_s_coords
 #define __pyx_n_s_count __pyx_mstate_global->__pyx_n_s_count
+#define __pyx_n_s_d __pyx_mstate_global->__pyx_n_s_d
+#define __pyx_n_s_d_idx __pyx_mstate_global->__pyx_n_s_d_idx
+#define __pyx_n_s_d_idx_d __pyx_mstate_global->__pyx_n_s_d_idx_d
+#define __pyx_n_s_d_idx_h __pyx_mstate_global->__pyx_n_s_d_idx_h
 #define __pyx_n_s_dict __pyx_mstate_global->__pyx_n_s_dict
 #define __pyx_kp_u_disable __pyx_mstate_global->__pyx_kp_u_disable
-#define __pyx_n_s_dist2 __pyx_mstate_global->__pyx_n_s_dist2
-#define __pyx_n_s_dist_threshold1 __pyx_mstate_global->__pyx_n_s_dist_threshold1
-#define __pyx_n_s_dist_threshold2 __pyx_mstate_global->__pyx_n_s_dist_threshold2
-#define __pyx_n_s_distangles __pyx_mstate_global->__pyx_n_s_distangles
-#define __pyx_n_s_dot_prod __pyx_mstate_global->__pyx_n_s_dot_prod
+#define __pyx_n_s_dist2_a __pyx_mstate_global->__pyx_n_s_dist2_a
+#define __pyx_n_s_dist2_b __pyx_mstate_global->__pyx_n_s_dist2_b
+#define __pyx_n_s_dist_threshold __pyx_mstate_global->__pyx_n_s_dist_threshold
+#define __pyx_n_s_dist_vec_a __pyx_mstate_global->__pyx_n_s_dist_vec_a
+#define __pyx_n_s_dist_vec_b __pyx_mstate_global->__pyx_n_s_dist_vec_b
+#define __pyx_n_s_donors __pyx_mstate_global->__pyx_n_s_donors
+#define __pyx_n_s_dotprod __pyx_mstate_global->__pyx_n_s_dotprod
 #define __pyx_n_s_dtype __pyx_mstate_global->__pyx_n_s_dtype
 #define __pyx_n_s_dtype_is_object __pyx_mstate_global->__pyx_n_s_dtype_is_object
 #define __pyx_kp_u_enable __pyx_mstate_global->__pyx_kp_u_enable
 #define __pyx_n_s_encode __pyx_mstate_global->__pyx_n_s_encode
 #define __pyx_n_s_enumerate __pyx_mstate_global->__pyx_n_s_enumerate
 #define __pyx_n_s_error __pyx_mstate_global->__pyx_n_s_error
 #define __pyx_n_s_f __pyx_mstate_global->__pyx_n_s_f
@@ -4415,29 +4430,32 @@
 #define __pyx_kp_u_gc __pyx_mstate_global->__pyx_kp_u_gc
 #define __pyx_n_s_getstate __pyx_mstate_global->__pyx_n_s_getstate
 #define __pyx_kp_u_got __pyx_mstate_global->__pyx_kp_u_got
 #define __pyx_kp_u_got_differing_extents_in_dimensi __pyx_mstate_global->__pyx_kp_u_got_differing_extents_in_dimensi
 #define __pyx_n_s_half_box __pyx_mstate_global->__pyx_n_s_half_box
 #define __pyx_n_s_i __pyx_mstate_global->__pyx_n_s_i
 #define __pyx_n_s_id __pyx_mstate_global->__pyx_n_s_id
+#define __pyx_n_s_ignore_hs __pyx_mstate_global->__pyx_n_s_ignore_hs
 #define __pyx_n_s_import __pyx_mstate_global->__pyx_n_s_import
 #define __pyx_n_s_index __pyx_mstate_global->__pyx_n_s_index
 #define __pyx_n_s_initializing __pyx_mstate_global->__pyx_n_s_initializing
+#define __pyx_n_s_intra __pyx_mstate_global->__pyx_n_s_intra
 #define __pyx_n_s_is_coroutine __pyx_mstate_global->__pyx_n_s_is_coroutine
 #define __pyx_kp_u_isenabled __pyx_mstate_global->__pyx_kp_u_isenabled
 #define __pyx_n_s_itemsize __pyx_mstate_global->__pyx_n_s_itemsize
 #define __pyx_kp_s_itemsize_0_for_cython_array __pyx_mstate_global->__pyx_kp_s_itemsize_0_for_cython_array
 #define __pyx_n_s_main __pyx_mstate_global->__pyx_n_s_main
+#define __pyx_n_s_math __pyx_mstate_global->__pyx_n_s_math
 #define __pyx_n_s_memview __pyx_mstate_global->__pyx_n_s_memview
 #define __pyx_n_s_mode __pyx_mstate_global->__pyx_n_s_mode
-#define __pyx_n_s_moleculekit_interactions_pipi __pyx_mstate_global->__pyx_n_s_moleculekit_interactions_pipi
-#define __pyx_kp_s_moleculekit_interactions_pipi_pi __pyx_mstate_global->__pyx_kp_s_moleculekit_interactions_pipi_pi
+#define __pyx_kp_s_moleculekit_interactions_hbonds __pyx_mstate_global->__pyx_kp_s_moleculekit_interactions_hbonds
+#define __pyx_n_s_moleculekit_interactions_hbonds_2 __pyx_mstate_global->__pyx_n_s_moleculekit_interactions_hbonds_2
+#define __pyx_n_s_n_acceptors __pyx_mstate_global->__pyx_n_s_n_acceptors
+#define __pyx_n_s_n_donors __pyx_mstate_global->__pyx_n_s_n_donors
 #define __pyx_n_s_n_frames __pyx_mstate_global->__pyx_n_s_n_frames
-#define __pyx_n_s_n_rings1 __pyx_mstate_global->__pyx_n_s_n_rings1
-#define __pyx_n_s_n_rings2 __pyx_mstate_global->__pyx_n_s_n_rings2
 #define __pyx_n_s_name __pyx_mstate_global->__pyx_n_s_name
 #define __pyx_n_s_name_2 __pyx_mstate_global->__pyx_n_s_name_2
 #define __pyx_n_s_ndim __pyx_mstate_global->__pyx_n_s_ndim
 #define __pyx_n_s_new __pyx_mstate_global->__pyx_n_s_new
 #define __pyx_kp_s_no_default___reduce___due_to_non __pyx_mstate_global->__pyx_kp_s_no_default___reduce___due_to_non
 #define __pyx_n_s_np __pyx_mstate_global->__pyx_n_s_np
 #define __pyx_n_s_numpy __pyx_mstate_global->__pyx_n_s_numpy
@@ -4449,55 +4467,44 @@
 #define __pyx_n_s_pyx_PickleError __pyx_mstate_global->__pyx_n_s_pyx_PickleError
 #define __pyx_n_s_pyx_checksum __pyx_mstate_global->__pyx_n_s_pyx_checksum
 #define __pyx_n_s_pyx_result __pyx_mstate_global->__pyx_n_s_pyx_result
 #define __pyx_n_s_pyx_state __pyx_mstate_global->__pyx_n_s_pyx_state
 #define __pyx_n_s_pyx_type __pyx_mstate_global->__pyx_n_s_pyx_type
 #define __pyx_n_s_pyx_unpickle_Enum __pyx_mstate_global->__pyx_n_s_pyx_unpickle_Enum
 #define __pyx_n_s_pyx_vtable __pyx_mstate_global->__pyx_n_s_pyx_vtable
-#define __pyx_n_s_r1 __pyx_mstate_global->__pyx_n_s_r1
-#define __pyx_n_s_r1_end_idx __pyx_mstate_global->__pyx_n_s_r1_end_idx
-#define __pyx_n_s_r1_start_idx __pyx_mstate_global->__pyx_n_s_r1_start_idx
-#define __pyx_n_s_r2 __pyx_mstate_global->__pyx_n_s_r2
-#define __pyx_n_s_r2_end_idx __pyx_mstate_global->__pyx_n_s_r2_end_idx
-#define __pyx_n_s_r2_start_idx __pyx_mstate_global->__pyx_n_s_r2_start_idx
 #define __pyx_n_s_range __pyx_mstate_global->__pyx_n_s_range
 #define __pyx_n_s_reduce __pyx_mstate_global->__pyx_n_s_reduce
 #define __pyx_n_s_reduce_cython __pyx_mstate_global->__pyx_n_s_reduce_cython
 #define __pyx_n_s_reduce_ex __pyx_mstate_global->__pyx_n_s_reduce_ex
 #define __pyx_n_s_register __pyx_mstate_global->__pyx_n_s_register
 #define __pyx_n_s_results __pyx_mstate_global->__pyx_n_s_results
-#define __pyx_n_s_ring1_mean __pyx_mstate_global->__pyx_n_s_ring1_mean
-#define __pyx_n_s_ring1_normal __pyx_mstate_global->__pyx_n_s_ring1_normal
-#define __pyx_n_s_ring2_mean __pyx_mstate_global->__pyx_n_s_ring2_mean
-#define __pyx_n_s_ring2_normal __pyx_mstate_global->__pyx_n_s_ring2_normal
-#define __pyx_n_s_rings1_start_indexes __pyx_mstate_global->__pyx_n_s_rings1_start_indexes
-#define __pyx_n_s_rings2_start_indexes __pyx_mstate_global->__pyx_n_s_rings2_start_indexes
-#define __pyx_n_s_rings_atoms __pyx_mstate_global->__pyx_n_s_rings_atoms
+#define __pyx_n_s_sel1 __pyx_mstate_global->__pyx_n_s_sel1
+#define __pyx_n_s_sel2 __pyx_mstate_global->__pyx_n_s_sel2
 #define __pyx_n_s_setstate __pyx_mstate_global->__pyx_n_s_setstate
 #define __pyx_n_s_setstate_cython __pyx_mstate_global->__pyx_n_s_setstate_cython
 #define __pyx_n_s_shape __pyx_mstate_global->__pyx_n_s_shape
 #define __pyx_n_s_size __pyx_mstate_global->__pyx_n_s_size
 #define __pyx_n_s_spec __pyx_mstate_global->__pyx_n_s_spec
+#define __pyx_n_s_sqrt __pyx_mstate_global->__pyx_n_s_sqrt
 #define __pyx_n_s_start __pyx_mstate_global->__pyx_n_s_start
 #define __pyx_n_s_step __pyx_mstate_global->__pyx_n_s_step
 #define __pyx_n_s_stop __pyx_mstate_global->__pyx_n_s_stop
 #define __pyx_kp_s_strided_and_direct __pyx_mstate_global->__pyx_kp_s_strided_and_direct
 #define __pyx_kp_s_strided_and_direct_or_indirect __pyx_mstate_global->__pyx_kp_s_strided_and_direct_or_indirect
 #define __pyx_kp_s_strided_and_indirect __pyx_mstate_global->__pyx_kp_s_strided_and_indirect
 #define __pyx_kp_s_stringsource __pyx_mstate_global->__pyx_kp_s_stringsource
 #define __pyx_n_s_struct __pyx_mstate_global->__pyx_n_s_struct
 #define __pyx_n_s_sys __pyx_mstate_global->__pyx_n_s_sys
 #define __pyx_n_s_test __pyx_mstate_global->__pyx_n_s_test
-#define __pyx_n_s_tmp1 __pyx_mstate_global->__pyx_n_s_tmp1
-#define __pyx_n_s_tmp2 __pyx_mstate_global->__pyx_n_s_tmp2
 #define __pyx_n_s_uint32 __pyx_mstate_global->__pyx_n_s_uint32
 #define __pyx_kp_s_unable_to_allocate_array_data __pyx_mstate_global->__pyx_kp_s_unable_to_allocate_array_data
 #define __pyx_kp_s_unable_to_allocate_shape_and_str __pyx_mstate_global->__pyx_kp_s_unable_to_allocate_shape_and_str
 #define __pyx_n_s_unpack __pyx_mstate_global->__pyx_n_s_unpack
 #define __pyx_n_s_update __pyx_mstate_global->__pyx_n_s_update
+#define __pyx_n_s_val __pyx_mstate_global->__pyx_n_s_val
 #define __pyx_n_s_version_info __pyx_mstate_global->__pyx_n_s_version_info
 #define __pyx_n_s_zeros __pyx_mstate_global->__pyx_n_s_zeros
 #define __pyx_int_0 __pyx_mstate_global->__pyx_int_0
 #define __pyx_int_1 __pyx_mstate_global->__pyx_int_1
 #define __pyx_int_3 __pyx_mstate_global->__pyx_int_3
 #define __pyx_int_112105877 __pyx_mstate_global->__pyx_int_112105877
 #define __pyx_int_136983863 __pyx_mstate_global->__pyx_int_136983863
@@ -4810,296 +4817,14 @@
   __Pyx_XDECREF(__pyx_v_o);
   __Pyx_XDECREF(__pyx_v_item);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_convert_vector_to_py_float(std::vector<float>  const &__pyx_v_v) {
-  Py_ssize_t __pyx_v_v_size_signed;
-  PyObject *__pyx_v_o = NULL;
-  Py_ssize_t __pyx_v_i;
-  PyObject *__pyx_v_item = 0;
-  PyObject *__pyx_r = NULL;
-  __Pyx_RefNannyDeclarations
-  int __pyx_t_1;
-  PyObject *__pyx_t_2 = NULL;
-  Py_ssize_t __pyx_t_3;
-  Py_ssize_t __pyx_t_4;
-  Py_ssize_t __pyx_t_5;
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("__pyx_convert_vector_to_py_float", 1);
-
-  /* "vector.to_py":67
- * @cname("__pyx_convert_vector_to_py_float")
- * cdef object __pyx_convert_vector_to_py_float(const vector[X]& v):
- *     if v.size() > <size_t> PY_SSIZE_T_MAX:             # <<<<<<<<<<<<<<
- *         raise MemoryError()
- *     v_size_signed = <Py_ssize_t> v.size()
- */
-  __pyx_t_1 = (__pyx_v_v.size() > ((size_t)PY_SSIZE_T_MAX));
-  if (unlikely(__pyx_t_1)) {
-
-    /* "vector.to_py":68
- * cdef object __pyx_convert_vector_to_py_float(const vector[X]& v):
- *     if v.size() > <size_t> PY_SSIZE_T_MAX:
- *         raise MemoryError()             # <<<<<<<<<<<<<<
- *     v_size_signed = <Py_ssize_t> v.size()
- * 
- */
-    PyErr_NoMemory(); __PYX_ERR(1, 68, __pyx_L1_error)
-
-    /* "vector.to_py":67
- * @cname("__pyx_convert_vector_to_py_float")
- * cdef object __pyx_convert_vector_to_py_float(const vector[X]& v):
- *     if v.size() > <size_t> PY_SSIZE_T_MAX:             # <<<<<<<<<<<<<<
- *         raise MemoryError()
- *     v_size_signed = <Py_ssize_t> v.size()
- */
-  }
-
-  /* "vector.to_py":69
- *     if v.size() > <size_t> PY_SSIZE_T_MAX:
- *         raise MemoryError()
- *     v_size_signed = <Py_ssize_t> v.size()             # <<<<<<<<<<<<<<
- * 
- *     o = PyList_New(v_size_signed)
- */
-  __pyx_v_v_size_signed = ((Py_ssize_t)__pyx_v_v.size());
-
-  /* "vector.to_py":71
- *     v_size_signed = <Py_ssize_t> v.size()
- * 
- *     o = PyList_New(v_size_signed)             # <<<<<<<<<<<<<<
- * 
- *     cdef Py_ssize_t i
- */
-  __pyx_t_2 = PyList_New(__pyx_v_v_size_signed); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 71, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_v_o = ((PyObject*)__pyx_t_2);
-  __pyx_t_2 = 0;
-
-  /* "vector.to_py":76
- *     cdef object item
- * 
- *     for i in range(v_size_signed):             # <<<<<<<<<<<<<<
- *         item = v[i]
- *         Py_INCREF(item)
- */
-  __pyx_t_3 = __pyx_v_v_size_signed;
-  __pyx_t_4 = __pyx_t_3;
-  for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
-    __pyx_v_i = __pyx_t_5;
-
-    /* "vector.to_py":77
- * 
- *     for i in range(v_size_signed):
- *         item = v[i]             # <<<<<<<<<<<<<<
- *         Py_INCREF(item)
- *         PyList_SET_ITEM(o, i, item)
- */
-    __pyx_t_2 = PyFloat_FromDouble((__pyx_v_v[__pyx_v_i])); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 77, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_XDECREF_SET(__pyx_v_item, __pyx_t_2);
-    __pyx_t_2 = 0;
-
-    /* "vector.to_py":78
- *     for i in range(v_size_signed):
- *         item = v[i]
- *         Py_INCREF(item)             # <<<<<<<<<<<<<<
- *         PyList_SET_ITEM(o, i, item)
- * 
- */
-    Py_INCREF(__pyx_v_item);
-
-    /* "vector.to_py":79
- *         item = v[i]
- *         Py_INCREF(item)
- *         PyList_SET_ITEM(o, i, item)             # <<<<<<<<<<<<<<
- * 
- *     return o
- */
-    PyList_SET_ITEM(__pyx_v_o, __pyx_v_i, __pyx_v_item);
-  }
-
-  /* "vector.to_py":81
- *         PyList_SET_ITEM(o, i, item)
- * 
- *     return o             # <<<<<<<<<<<<<<
- * 
- */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(__pyx_v_o);
-  __pyx_r = __pyx_v_o;
-  goto __pyx_L0;
-
-  /* "vector.to_py":66
- * 
- * @cname("__pyx_convert_vector_to_py_float")
- * cdef object __pyx_convert_vector_to_py_float(const vector[X]& v):             # <<<<<<<<<<<<<<
- *     if v.size() > <size_t> PY_SSIZE_T_MAX:
- *         raise MemoryError()
- */
-
-  /* function exit code */
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_AddTraceback("vector.to_py.__pyx_convert_vector_to_py_float", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __pyx_r = 0;
-  __pyx_L0:;
-  __Pyx_XDECREF(__pyx_v_o);
-  __Pyx_XDECREF(__pyx_v_item);
-  __Pyx_XGIVEREF(__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-static PyObject *__pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___(std::vector<std::vector<float> >  const &__pyx_v_v) {
-  Py_ssize_t __pyx_v_v_size_signed;
-  PyObject *__pyx_v_o = NULL;
-  Py_ssize_t __pyx_v_i;
-  PyObject *__pyx_v_item = 0;
-  PyObject *__pyx_r = NULL;
-  __Pyx_RefNannyDeclarations
-  int __pyx_t_1;
-  PyObject *__pyx_t_2 = NULL;
-  Py_ssize_t __pyx_t_3;
-  Py_ssize_t __pyx_t_4;
-  Py_ssize_t __pyx_t_5;
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("__pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___", 1);
-
-  /* "vector.to_py":67
- * @cname("__pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___")
- * cdef object __pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___(const vector[X]& v):
- *     if v.size() > <size_t> PY_SSIZE_T_MAX:             # <<<<<<<<<<<<<<
- *         raise MemoryError()
- *     v_size_signed = <Py_ssize_t> v.size()
- */
-  __pyx_t_1 = (__pyx_v_v.size() > ((size_t)PY_SSIZE_T_MAX));
-  if (unlikely(__pyx_t_1)) {
-
-    /* "vector.to_py":68
- * cdef object __pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___(const vector[X]& v):
- *     if v.size() > <size_t> PY_SSIZE_T_MAX:
- *         raise MemoryError()             # <<<<<<<<<<<<<<
- *     v_size_signed = <Py_ssize_t> v.size()
- * 
- */
-    PyErr_NoMemory(); __PYX_ERR(1, 68, __pyx_L1_error)
-
-    /* "vector.to_py":67
- * @cname("__pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___")
- * cdef object __pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___(const vector[X]& v):
- *     if v.size() > <size_t> PY_SSIZE_T_MAX:             # <<<<<<<<<<<<<<
- *         raise MemoryError()
- *     v_size_signed = <Py_ssize_t> v.size()
- */
-  }
-
-  /* "vector.to_py":69
- *     if v.size() > <size_t> PY_SSIZE_T_MAX:
- *         raise MemoryError()
- *     v_size_signed = <Py_ssize_t> v.size()             # <<<<<<<<<<<<<<
- * 
- *     o = PyList_New(v_size_signed)
- */
-  __pyx_v_v_size_signed = ((Py_ssize_t)__pyx_v_v.size());
-
-  /* "vector.to_py":71
- *     v_size_signed = <Py_ssize_t> v.size()
- * 
- *     o = PyList_New(v_size_signed)             # <<<<<<<<<<<<<<
- * 
- *     cdef Py_ssize_t i
- */
-  __pyx_t_2 = PyList_New(__pyx_v_v_size_signed); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 71, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_v_o = ((PyObject*)__pyx_t_2);
-  __pyx_t_2 = 0;
-
-  /* "vector.to_py":76
- *     cdef object item
- * 
- *     for i in range(v_size_signed):             # <<<<<<<<<<<<<<
- *         item = v[i]
- *         Py_INCREF(item)
- */
-  __pyx_t_3 = __pyx_v_v_size_signed;
-  __pyx_t_4 = __pyx_t_3;
-  for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
-    __pyx_v_i = __pyx_t_5;
-
-    /* "vector.to_py":77
- * 
- *     for i in range(v_size_signed):
- *         item = v[i]             # <<<<<<<<<<<<<<
- *         Py_INCREF(item)
- *         PyList_SET_ITEM(o, i, item)
- */
-    __pyx_t_2 = __pyx_convert_vector_to_py_float((__pyx_v_v[__pyx_v_i])); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 77, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_XDECREF_SET(__pyx_v_item, __pyx_t_2);
-    __pyx_t_2 = 0;
-
-    /* "vector.to_py":78
- *     for i in range(v_size_signed):
- *         item = v[i]
- *         Py_INCREF(item)             # <<<<<<<<<<<<<<
- *         PyList_SET_ITEM(o, i, item)
- * 
- */
-    Py_INCREF(__pyx_v_item);
-
-    /* "vector.to_py":79
- *         item = v[i]
- *         Py_INCREF(item)
- *         PyList_SET_ITEM(o, i, item)             # <<<<<<<<<<<<<<
- * 
- *     return o
- */
-    PyList_SET_ITEM(__pyx_v_o, __pyx_v_i, __pyx_v_item);
-  }
-
-  /* "vector.to_py":81
- *         PyList_SET_ITEM(o, i, item)
- * 
- *     return o             # <<<<<<<<<<<<<<
- * 
- */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(__pyx_v_o);
-  __pyx_r = __pyx_v_o;
-  goto __pyx_L0;
-
-  /* "vector.to_py":66
- * 
- * @cname("__pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___")
- * cdef object __pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___(const vector[X]& v):             # <<<<<<<<<<<<<<
- *     if v.size() > <size_t> PY_SSIZE_T_MAX:
- *         raise MemoryError()
- */
-
-  /* function exit code */
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_AddTraceback("vector.to_py.__pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __pyx_r = 0;
-  __pyx_L0:;
-  __Pyx_XDECREF(__pyx_v_o);
-  __Pyx_XDECREF(__pyx_v_item);
-  __Pyx_XGIVEREF(__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
 /* "View.MemoryView":131
  *         cdef bint dtype_is_object
  * 
  *     def __cinit__(array self, tuple shape, Py_ssize_t itemsize, format not None,             # <<<<<<<<<<<<<<
  *                   mode="c", bint allocate_buffer=True):
  * 
  */
@@ -18718,261 +18443,261 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_7ndarray_4base_base(PyArrayObject *__pyx_v_self) {
   PyObject *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":248
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":248
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  *             return PyArray_BASE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_BASE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
 static CYTHON_INLINE PyArray_Descr *__pyx_f_5numpy_7ndarray_5descr_descr(PyArrayObject *__pyx_v_self) {
   PyArray_Descr *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyArray_Descr *__pyx_t_1;
   __Pyx_RefNannySetupContext("descr", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":254
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":254
  *             """Returns an owned reference to the dtype of the array.
  *             """
  *             return <dtype>PyArray_DESCR(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __pyx_t_1 = PyArray_DESCR(__pyx_v_self);
   __Pyx_INCREF((PyObject *)((PyArray_Descr *)__pyx_t_1));
   __pyx_r = ((PyArray_Descr *)__pyx_t_1);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_7ndarray_4ndim_ndim(PyArrayObject *__pyx_v_self) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":260
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":260
  *             """Returns the number of dimensions in the array.
  *             """
  *             return PyArray_NDIM(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_NDIM(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_5shape_shape(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":268
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":268
  *             Can return NULL for 0-dimensional arrays.
  *             """
  *             return PyArray_DIMS(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_DIMS(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_7strides_strides(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":275
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":275
  *             The number of elements matches the number of dimensions of the array (ndim).
  *             """
  *             return PyArray_STRIDES(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_STRIDES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
 static CYTHON_INLINE npy_intp __pyx_f_5numpy_7ndarray_4size_size(PyArrayObject *__pyx_v_self) {
   npy_intp __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":281
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":281
  *             """Returns the total size (in number of elements) of the array.
  *             """
  *             return PyArray_SIZE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_SIZE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
 static CYTHON_INLINE char *__pyx_f_5numpy_7ndarray_4data_data(PyArrayObject *__pyx_v_self) {
   char *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":290
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":290
  *             of `PyArray_DATA()` instead, which returns a 'void*'.
  *             """
  *             return PyArray_BYTES(self)             # <<<<<<<<<<<<<<
  * 
  *     ctypedef unsigned char      npy_bool
  */
   __pyx_r = PyArray_BYTES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -18981,29 +18706,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":774
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":774
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 774, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -19014,15 +18739,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -19031,29 +18756,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":777
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":777
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -19064,15 +18789,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -19081,29 +18806,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":780
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":780
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 780, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -19114,15 +18839,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -19131,29 +18856,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":783
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":783
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -19164,15 +18889,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -19181,29 +18906,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":786
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":786
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -19214,217 +18939,217 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = PyDataType_HASSUBARRAY(__pyx_v_d);
   if (__pyx_t_1) {
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":790
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":790
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":792
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":792
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":968
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":968
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":969
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":969
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   __pyx_t_1 = PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(2, 969, __pyx_L1_error)
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_AddTraceback("numpy.set_array_base", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":972
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":972
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = (__pyx_v_base == NULL);
   if (__pyx_t_1) {
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":974
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":974
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":975
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":975
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19440,15 +19165,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -19456,68 +19181,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":981
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":981
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 981, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":982
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":982
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 982, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 983, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 983, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19525,15 +19250,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19548,15 +19273,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19572,15 +19297,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19588,68 +19313,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":987
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":987
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 987, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":988
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":988
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 988, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 989, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 989, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19657,15 +19382,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19680,15 +19405,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19704,15 +19429,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19720,68 +19445,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":993
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":993
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 993, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":994
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":994
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 994, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":995
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":995
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 995, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 995, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19789,15 +19514,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19812,603 +19537,221 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1010
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1010
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1025
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1025
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
 static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
   npy_datetime __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1035
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1035
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
 static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
   npy_timedelta __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1042
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1042
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
 static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
   NPY_DATETIMEUNIT __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1049
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1049
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "moleculekit/interactions/pipi/pipi.pyx":23
- * @cython.boundscheck(False) # turn off bounds-checking for entire function
- * @cython.wraparound(False)  # turn off negative index wrapping for entire function
- * cdef void _calculate_ring_mean(             # <<<<<<<<<<<<<<
- *         int f,
- *         int start_idx,
- */
-
-static void __pyx_f_11moleculekit_12interactions_4pipi__calculate_ring_mean(int __pyx_v_f, int __pyx_v_start_idx, int __pyx_v_end_idx, __Pyx_memviewslice __pyx_v_rings_atoms, __Pyx_memviewslice __pyx_v_coords, __Pyx_memviewslice __pyx_v_ring_mean) {
-  __pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t __pyx_v_coor;
-  long __pyx_v_i;
-  int __pyx_v_rr;
-  long __pyx_t_1;
-  Py_ssize_t __pyx_t_2;
-  int __pyx_t_3;
-  int __pyx_t_4;
-  int __pyx_t_5;
-  size_t __pyx_t_6;
-  Py_ssize_t __pyx_t_7;
-  Py_ssize_t __pyx_t_8;
-
-  /* "moleculekit/interactions/pipi/pipi.pyx":32
- *     ):
- *     cdef FLOAT32_t coor
- *     for i in range(3):             # <<<<<<<<<<<<<<
- *         ring_mean[i] = 0
- * 
- */
-  for (__pyx_t_1 = 0; __pyx_t_1 < 3; __pyx_t_1+=1) {
-    __pyx_v_i = __pyx_t_1;
-
-    /* "moleculekit/interactions/pipi/pipi.pyx":33
- *     cdef FLOAT32_t coor
- *     for i in range(3):
- *         ring_mean[i] = 0             # <<<<<<<<<<<<<<
- * 
- *     for rr in range(start_idx, end_idx):
- */
-    __pyx_t_2 = __pyx_v_i;
-    *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_mean.data + __pyx_t_2 * __pyx_v_ring_mean.strides[0]) )) = 0.0;
-  }
-
-  /* "moleculekit/interactions/pipi/pipi.pyx":35
- *         ring_mean[i] = 0
- * 
- *     for rr in range(start_idx, end_idx):             # <<<<<<<<<<<<<<
- *         for i in range(3):
- *             coor = coords[rings_atoms[rr], i, f]
- */
-  __pyx_t_3 = __pyx_v_end_idx;
-  __pyx_t_4 = __pyx_t_3;
-  for (__pyx_t_5 = __pyx_v_start_idx; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
-    __pyx_v_rr = __pyx_t_5;
-
-    /* "moleculekit/interactions/pipi/pipi.pyx":36
- * 
- *     for rr in range(start_idx, end_idx):
- *         for i in range(3):             # <<<<<<<<<<<<<<
- *             coor = coords[rings_atoms[rr], i, f]
- *             ring_mean[i] = ring_mean[i] + coor
- */
-    for (__pyx_t_1 = 0; __pyx_t_1 < 3; __pyx_t_1+=1) {
-      __pyx_v_i = __pyx_t_1;
-
-      /* "moleculekit/interactions/pipi/pipi.pyx":37
- *     for rr in range(start_idx, end_idx):
- *         for i in range(3):
- *             coor = coords[rings_atoms[rr], i, f]             # <<<<<<<<<<<<<<
- *             ring_mean[i] = ring_mean[i] + coor
- * 
- */
-      __pyx_t_2 = __pyx_v_rr;
-      __pyx_t_6 = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_2 * __pyx_v_rings_atoms.strides[0]) )));
-      __pyx_t_7 = __pyx_v_i;
-      __pyx_t_8 = __pyx_v_f;
-      __pyx_v_coor = (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_6 * __pyx_v_coords.strides[0]) ) + __pyx_t_7 * __pyx_v_coords.strides[1]) ) + __pyx_t_8 * __pyx_v_coords.strides[2]) )));
-
-      /* "moleculekit/interactions/pipi/pipi.pyx":38
- *         for i in range(3):
- *             coor = coords[rings_atoms[rr], i, f]
- *             ring_mean[i] = ring_mean[i] + coor             # <<<<<<<<<<<<<<
- * 
- *     for i in range(3):
- */
-      __pyx_t_2 = __pyx_v_i;
-      __pyx_t_8 = __pyx_v_i;
-      *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_mean.data + __pyx_t_8 * __pyx_v_ring_mean.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_mean.data + __pyx_t_2 * __pyx_v_ring_mean.strides[0]) ))) + __pyx_v_coor);
-    }
-  }
-
-  /* "moleculekit/interactions/pipi/pipi.pyx":40
- *             ring_mean[i] = ring_mean[i] + coor
- * 
- *     for i in range(3):             # <<<<<<<<<<<<<<
- *         ring_mean[i] = ring_mean[i] / (end_idx - start_idx)
- * 
- */
-  for (__pyx_t_1 = 0; __pyx_t_1 < 3; __pyx_t_1+=1) {
-    __pyx_v_i = __pyx_t_1;
-
-    /* "moleculekit/interactions/pipi/pipi.pyx":41
- * 
- *     for i in range(3):
- *         ring_mean[i] = ring_mean[i] / (end_idx - start_idx)             # <<<<<<<<<<<<<<
- * 
- * 
- */
-    __pyx_t_2 = __pyx_v_i;
-    __pyx_t_8 = __pyx_v_i;
-    *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_mean.data + __pyx_t_8 * __pyx_v_ring_mean.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring_mean.data + __pyx_t_2 * __pyx_v_ring_mean.strides[0]) ))) / ((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t)(__pyx_v_end_idx - __pyx_v_start_idx)));
-  }
-
-  /* "moleculekit/interactions/pipi/pipi.pyx":23
- * @cython.boundscheck(False) # turn off bounds-checking for entire function
- * @cython.wraparound(False)  # turn off negative index wrapping for entire function
- * cdef void _calculate_ring_mean(             # <<<<<<<<<<<<<<
- *         int f,
- *         int start_idx,
- */
-
-  /* function exit code */
-}
-
-/* "moleculekit/interactions/pipi/pipi.pyx":46
- * @cython.boundscheck(False) # turn off bounds-checking for entire function
- * @cython.wraparound(False)  # turn off negative index wrapping for entire function
- * cdef float _wrapped_dist(             # <<<<<<<<<<<<<<
- *         int f,
- *         FLOAT32_t[:] point1,
- */
-
-static float __pyx_f_11moleculekit_12interactions_4pipi__wrapped_dist(int __pyx_v_f, __Pyx_memviewslice __pyx_v_point1, __Pyx_memviewslice __pyx_v_point2, __Pyx_memviewslice __pyx_v_half_box, __Pyx_memviewslice __pyx_v_box) {
-  __pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t __pyx_v_val;
-  float __pyx_v_dist2;
-  long __pyx_v_i;
-  float __pyx_r;
-  long __pyx_t_1;
-  Py_ssize_t __pyx_t_2;
-  Py_ssize_t __pyx_t_3;
-  int __pyx_t_4;
-  int __pyx_t_5;
-  Py_ssize_t __pyx_t_6;
-  Py_ssize_t __pyx_t_7;
-
-  /* "moleculekit/interactions/pipi/pipi.pyx":54
- *     ):
- *     cdef FLOAT32_t val
- *     cdef float dist2 = 0             # <<<<<<<<<<<<<<
- *     for i in range(3):
- *         val = point1[i] - point2[i]
- */
-  __pyx_v_dist2 = 0.0;
-
-  /* "moleculekit/interactions/pipi/pipi.pyx":55
- *     cdef FLOAT32_t val
- *     cdef float dist2 = 0
- *     for i in range(3):             # <<<<<<<<<<<<<<
- *         val = point1[i] - point2[i]
- *         # Wrap the distance vector into the periodic box
- */
-  for (__pyx_t_1 = 0; __pyx_t_1 < 3; __pyx_t_1+=1) {
-    __pyx_v_i = __pyx_t_1;
-
-    /* "moleculekit/interactions/pipi/pipi.pyx":56
- *     cdef float dist2 = 0
- *     for i in range(3):
- *         val = point1[i] - point2[i]             # <<<<<<<<<<<<<<
- *         # Wrap the distance vector into the periodic box
- *         if abs(val) > half_box[i] and box[i, f] != 0:
- */
-    __pyx_t_2 = __pyx_v_i;
-    __pyx_t_3 = __pyx_v_i;
-    __pyx_v_val = ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_point1.data + __pyx_t_2 * __pyx_v_point1.strides[0]) ))) - (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_point2.data + __pyx_t_3 * __pyx_v_point2.strides[0]) ))));
-
-    /* "moleculekit/interactions/pipi/pipi.pyx":58
- *         val = point1[i] - point2[i]
- *         # Wrap the distance vector into the periodic box
- *         if abs(val) > half_box[i] and box[i, f] != 0:             # <<<<<<<<<<<<<<
- *             val = val - box[i, f] * round(val / box[i, f])
- *         dist2 = dist2 + (val * val)
- */
-    __pyx_t_3 = __pyx_v_i;
-    __pyx_t_5 = (fabsf(__pyx_v_val) > (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_half_box.data + __pyx_t_3 * __pyx_v_half_box.strides[0]) ))));
-    if (__pyx_t_5) {
-    } else {
-      __pyx_t_4 = __pyx_t_5;
-      goto __pyx_L6_bool_binop_done;
-    }
-    __pyx_t_3 = __pyx_v_i;
-    __pyx_t_2 = __pyx_v_f;
-    __pyx_t_5 = ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_3 * __pyx_v_box.strides[0]) ) + __pyx_t_2 * __pyx_v_box.strides[1]) ))) != 0.0);
-    __pyx_t_4 = __pyx_t_5;
-    __pyx_L6_bool_binop_done:;
-    if (__pyx_t_4) {
-
-      /* "moleculekit/interactions/pipi/pipi.pyx":59
- *         # Wrap the distance vector into the periodic box
- *         if abs(val) > half_box[i] and box[i, f] != 0:
- *             val = val - box[i, f] * round(val / box[i, f])             # <<<<<<<<<<<<<<
- *         dist2 = dist2 + (val * val)
- *     return dist2
- */
-      __pyx_t_2 = __pyx_v_i;
-      __pyx_t_3 = __pyx_v_f;
-      __pyx_t_6 = __pyx_v_i;
-      __pyx_t_7 = __pyx_v_f;
-      __pyx_v_val = (__pyx_v_val - ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_2 * __pyx_v_box.strides[0]) ) + __pyx_t_3 * __pyx_v_box.strides[1]) ))) * round((__pyx_v_val / (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_6 * __pyx_v_box.strides[0]) ) + __pyx_t_7 * __pyx_v_box.strides[1]) )))))));
-
-      /* "moleculekit/interactions/pipi/pipi.pyx":58
- *         val = point1[i] - point2[i]
- *         # Wrap the distance vector into the periodic box
- *         if abs(val) > half_box[i] and box[i, f] != 0:             # <<<<<<<<<<<<<<
- *             val = val - box[i, f] * round(val / box[i, f])
- *         dist2 = dist2 + (val * val)
- */
-    }
-
-    /* "moleculekit/interactions/pipi/pipi.pyx":60
- *         if abs(val) > half_box[i] and box[i, f] != 0:
- *             val = val - box[i, f] * round(val / box[i, f])
- *         dist2 = dist2 + (val * val)             # <<<<<<<<<<<<<<
- *     return dist2
- * 
- */
-    __pyx_v_dist2 = (__pyx_v_dist2 + (__pyx_v_val * __pyx_v_val));
-  }
-
-  /* "moleculekit/interactions/pipi/pipi.pyx":61
- *             val = val - box[i, f] * round(val / box[i, f])
- *         dist2 = dist2 + (val * val)
- *     return dist2             # <<<<<<<<<<<<<<
- * 
- * 
- */
-  __pyx_r = __pyx_v_dist2;
-  goto __pyx_L0;
-
-  /* "moleculekit/interactions/pipi/pipi.pyx":46
- * @cython.boundscheck(False) # turn off bounds-checking for entire function
- * @cython.wraparound(False)  # turn off negative index wrapping for entire function
- * cdef float _wrapped_dist(             # <<<<<<<<<<<<<<
- *         int f,
- *         FLOAT32_t[:] point1,
- */
-
-  /* function exit code */
-  __pyx_L0:;
-  return __pyx_r;
-}
-
-/* "moleculekit/interactions/pipi/pipi.pyx":66
- * @cython.boundscheck(False) # turn off bounds-checking for entire function
- * @cython.wraparound(False)  # turn off negative index wrapping for entire function
- * cdef void _cross_product(             # <<<<<<<<<<<<<<
- *         FLOAT32_t[:] vec_a,
- *         FLOAT32_t[:] vec_b,
- */
-
-static void __pyx_f_11moleculekit_12interactions_4pipi__cross_product(__Pyx_memviewslice __pyx_v_vec_a, __Pyx_memviewslice __pyx_v_vec_b, __Pyx_memviewslice __pyx_v_res) {
-  float __pyx_v_vec_norm;
-  long __pyx_v_i;
-  Py_ssize_t __pyx_t_1;
-  Py_ssize_t __pyx_t_2;
-  Py_ssize_t __pyx_t_3;
-  Py_ssize_t __pyx_t_4;
-  Py_ssize_t __pyx_t_5;
-  long __pyx_t_6;
-
-  /* "moleculekit/interactions/pipi/pipi.pyx":71
- *         FLOAT32_t[:] res,
- *     ):
- *     res[0] = vec_a[1] * vec_b[2] - vec_a[2] * vec_b[1]             # <<<<<<<<<<<<<<
- *     res[1] = vec_a[2] * vec_b[0] - vec_a[0] * vec_b[2]
- *     res[2] = vec_a[0] * vec_b[1] - vec_a[1] * vec_b[0]
- */
-  __pyx_t_1 = 1;
-  __pyx_t_2 = 2;
-  __pyx_t_3 = 2;
-  __pyx_t_4 = 1;
-  __pyx_t_5 = 0;
-  *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_res.data + __pyx_t_5 * __pyx_v_res.strides[0]) )) = (((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_1 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_2 * __pyx_v_vec_b.strides[0]) )))) - ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_3 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_4 * __pyx_v_vec_b.strides[0]) )))));
-
-  /* "moleculekit/interactions/pipi/pipi.pyx":72
- *     ):
- *     res[0] = vec_a[1] * vec_b[2] - vec_a[2] * vec_b[1]
- *     res[1] = vec_a[2] * vec_b[0] - vec_a[0] * vec_b[2]             # <<<<<<<<<<<<<<
- *     res[2] = vec_a[0] * vec_b[1] - vec_a[1] * vec_b[0]
- * 
- */
-  __pyx_t_4 = 2;
-  __pyx_t_3 = 0;
-  __pyx_t_2 = 0;
-  __pyx_t_1 = 2;
-  __pyx_t_5 = 1;
-  *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_res.data + __pyx_t_5 * __pyx_v_res.strides[0]) )) = (((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_4 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_3 * __pyx_v_vec_b.strides[0]) )))) - ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_2 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_1 * __pyx_v_vec_b.strides[0]) )))));
-
-  /* "moleculekit/interactions/pipi/pipi.pyx":73
- *     res[0] = vec_a[1] * vec_b[2] - vec_a[2] * vec_b[1]
- *     res[1] = vec_a[2] * vec_b[0] - vec_a[0] * vec_b[2]
- *     res[2] = vec_a[0] * vec_b[1] - vec_a[1] * vec_b[0]             # <<<<<<<<<<<<<<
- * 
- *     cdef float vec_norm = 0
- */
-  __pyx_t_1 = 0;
-  __pyx_t_2 = 1;
-  __pyx_t_3 = 1;
-  __pyx_t_4 = 0;
-  __pyx_t_5 = 2;
-  *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_res.data + __pyx_t_5 * __pyx_v_res.strides[0]) )) = (((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_1 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_2 * __pyx_v_vec_b.strides[0]) )))) - ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_a.data + __pyx_t_3 * __pyx_v_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_vec_b.data + __pyx_t_4 * __pyx_v_vec_b.strides[0]) )))));
-
-  /* "moleculekit/interactions/pipi/pipi.pyx":75
- *     res[2] = vec_a[0] * vec_b[1] - vec_a[1] * vec_b[0]
- * 
- *     cdef float vec_norm = 0             # <<<<<<<<<<<<<<
- *     for i in range(3):
- *         vec_norm = vec_norm + (res[i] * res[i])
- */
-  __pyx_v_vec_norm = 0.0;
-
-  /* "moleculekit/interactions/pipi/pipi.pyx":76
- * 
- *     cdef float vec_norm = 0
- *     for i in range(3):             # <<<<<<<<<<<<<<
- *         vec_norm = vec_norm + (res[i] * res[i])
- *     vec_norm = sqrt(vec_norm)
- */
-  for (__pyx_t_6 = 0; __pyx_t_6 < 3; __pyx_t_6+=1) {
-    __pyx_v_i = __pyx_t_6;
-
-    /* "moleculekit/interactions/pipi/pipi.pyx":77
- *     cdef float vec_norm = 0
- *     for i in range(3):
- *         vec_norm = vec_norm + (res[i] * res[i])             # <<<<<<<<<<<<<<
- *     vec_norm = sqrt(vec_norm)
- * 
- */
-    __pyx_t_4 = __pyx_v_i;
-    __pyx_t_3 = __pyx_v_i;
-    __pyx_v_vec_norm = (__pyx_v_vec_norm + ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_res.data + __pyx_t_4 * __pyx_v_res.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_res.data + __pyx_t_3 * __pyx_v_res.strides[0]) )))));
-  }
-
-  /* "moleculekit/interactions/pipi/pipi.pyx":78
- *     for i in range(3):
- *         vec_norm = vec_norm + (res[i] * res[i])
- *     vec_norm = sqrt(vec_norm)             # <<<<<<<<<<<<<<
- * 
- *     for i in range(3):
- */
-  __pyx_v_vec_norm = sqrt(__pyx_v_vec_norm);
-
-  /* "moleculekit/interactions/pipi/pipi.pyx":80
- *     vec_norm = sqrt(vec_norm)
- * 
- *     for i in range(3):             # <<<<<<<<<<<<<<
- *         res[i] = res[i] / vec_norm
- * 
- */
-  for (__pyx_t_6 = 0; __pyx_t_6 < 3; __pyx_t_6+=1) {
-    __pyx_v_i = __pyx_t_6;
-
-    /* "moleculekit/interactions/pipi/pipi.pyx":81
- * 
- *     for i in range(3):
- *         res[i] = res[i] / vec_norm             # <<<<<<<<<<<<<<
- * 
- * 
- */
-    __pyx_t_3 = __pyx_v_i;
-    __pyx_t_4 = __pyx_v_i;
-    *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_res.data + __pyx_t_4 * __pyx_v_res.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_res.data + __pyx_t_3 * __pyx_v_res.strides[0]) ))) / ((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t)__pyx_v_vec_norm));
-  }
-
-  /* "moleculekit/interactions/pipi/pipi.pyx":66
- * @cython.boundscheck(False) # turn off bounds-checking for entire function
- * @cython.wraparound(False)  # turn off negative index wrapping for entire function
- * cdef void _cross_product(             # <<<<<<<<<<<<<<
- *         FLOAT32_t[:] vec_a,
- *         FLOAT32_t[:] vec_b,
- */
-
-  /* function exit code */
-}
-
-/* "moleculekit/interactions/pipi/pipi.pyx":84
- * 
+/* "moleculekit/interactions/hbonds/hbonds.pyx":23
  * 
+ * import cython
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def calculate(
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11moleculekit_12interactions_4pipi_1calculate(PyObject *__pyx_self, 
+static PyObject *__pyx_pw_11moleculekit_12interactions_6hbonds_1calculate(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ); /*proto*/
-static PyMethodDef __pyx_mdef_11moleculekit_12interactions_4pipi_1calculate = {"calculate", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11moleculekit_12interactions_4pipi_1calculate, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_11moleculekit_12interactions_4pipi_1calculate(PyObject *__pyx_self, 
+static PyMethodDef __pyx_mdef_11moleculekit_12interactions_6hbonds_1calculate = {"calculate", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11moleculekit_12interactions_6hbonds_1calculate, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11moleculekit_12interactions_6hbonds_1calculate(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ) {
-  __Pyx_memviewslice __pyx_v_rings_atoms = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_rings1_start_indexes = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_rings2_start_indexes = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_coords = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_box = { 0, 0, { 0 }, { 0 }, { 0 } };
-  float __pyx_v_dist_threshold1;
-  float __pyx_v_angle_threshold1_max;
-  float __pyx_v_dist_threshold2;
-  float __pyx_v_angle_threshold2_min;
+  PyArrayObject *__pyx_v_donors = 0;
+  PyArrayObject *__pyx_v_acceptors = 0;
+  PyArrayObject *__pyx_v_coords = 0;
+  PyArrayObject *__pyx_v_box = 0;
+  PyArrayObject *__pyx_v_sel1 = 0;
+  PyArrayObject *__pyx_v_sel2 = 0;
+  float __pyx_v_dist_threshold;
+  float __pyx_v_angle_threshold;
+  bool __pyx_v_intra;
+  bool __pyx_v_ignore_hs;
   #if !CYTHON_METH_FASTCALL
   CYTHON_UNUSED Py_ssize_t __pyx_nargs;
   #endif
   CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
-  PyObject* values[9] = {0,0,0,0,0,0,0,0,0};
+  PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("calculate (wrapper)", 0);
   #if !CYTHON_METH_FASTCALL
@@ -20416,18 +19759,20 @@
   __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
   #else
   __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
   #endif
   #endif
   __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
   {
-    PyObject **__pyx_pyargnames[] = {&__pyx_n_s_rings_atoms,&__pyx_n_s_rings1_start_indexes,&__pyx_n_s_rings2_start_indexes,&__pyx_n_s_coords,&__pyx_n_s_box,&__pyx_n_s_dist_threshold1,&__pyx_n_s_angle_threshold1_max,&__pyx_n_s_dist_threshold2,&__pyx_n_s_angle_threshold2_min,0};
+    PyObject **__pyx_pyargnames[] = {&__pyx_n_s_donors,&__pyx_n_s_acceptors,&__pyx_n_s_coords,&__pyx_n_s_box,&__pyx_n_s_sel1,&__pyx_n_s_sel2,&__pyx_n_s_dist_threshold,&__pyx_n_s_angle_threshold,&__pyx_n_s_intra,&__pyx_n_s_ignore_hs,0};
     if (__pyx_kwds) {
       Py_ssize_t kw_args;
       switch (__pyx_nargs) {
+        case 10: values[9] = __Pyx_Arg_FASTCALL(__pyx_args, 9);
+        CYTHON_FALLTHROUGH;
         case  9: values[8] = __Pyx_Arg_FASTCALL(__pyx_args, 8);
         CYTHON_FALLTHROUGH;
         case  8: values[7] = __Pyx_Arg_FASTCALL(__pyx_args, 7);
         CYTHON_FALLTHROUGH;
         case  7: values[6] = __Pyx_Arg_FASTCALL(__pyx_args, 6);
         CYTHON_FALLTHROUGH;
         case  6: values[5] = __Pyx_Arg_FASTCALL(__pyx_args, 5);
@@ -20444,1128 +19789,1304 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
-        if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_rings_atoms)) != 0)) {
+        if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_donors)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 84, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 23, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_rings1_start_indexes)) != 0)) {
+        if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_acceptors)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 84, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 23, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("calculate", 0, 5, 9, 1); __PYX_ERR(0, 84, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calculate", 0, 6, 10, 1); __PYX_ERR(0, 23, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
-        if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_rings2_start_indexes)) != 0)) {
+        if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_coords)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 84, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 23, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("calculate", 0, 5, 9, 2); __PYX_ERR(0, 84, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calculate", 0, 6, 10, 2); __PYX_ERR(0, 23, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
-        if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_coords)) != 0)) {
+        if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_box)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[3]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 84, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 23, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("calculate", 0, 5, 9, 3); __PYX_ERR(0, 84, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calculate", 0, 6, 10, 3); __PYX_ERR(0, 23, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
-        if (likely((values[4] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_box)) != 0)) {
+        if (likely((values[4] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_sel1)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[4]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 84, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 23, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("calculate", 0, 5, 9, 4); __PYX_ERR(0, 84, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calculate", 0, 6, 10, 4); __PYX_ERR(0, 23, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
-        if (kw_args > 0) {
-          PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dist_threshold1);
-          if (value) { values[5] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 84, __pyx_L3_error)
+        if (likely((values[5] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_sel2)) != 0)) {
+          (void)__Pyx_Arg_NewRef_FASTCALL(values[5]);
+          kw_args--;
+        }
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 23, __pyx_L3_error)
+        else {
+          __Pyx_RaiseArgtupleInvalid("calculate", 0, 6, 10, 5); __PYX_ERR(0, 23, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_angle_threshold1_max);
+          PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dist_threshold);
           if (value) { values[6] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 84, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 23, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  7:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dist_threshold2);
+          PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_angle_threshold);
           if (value) { values[7] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 84, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 23, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  8:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_angle_threshold2_min);
+          PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_intra);
           if (value) { values[8] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 84, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 23, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  9:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_ignore_hs);
+          if (value) { values[9] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 23, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "calculate") < 0)) __PYX_ERR(0, 84, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "calculate") < 0)) __PYX_ERR(0, 23, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
+        case 10: values[9] = __Pyx_Arg_FASTCALL(__pyx_args, 9);
+        CYTHON_FALLTHROUGH;
         case  9: values[8] = __Pyx_Arg_FASTCALL(__pyx_args, 8);
         CYTHON_FALLTHROUGH;
         case  8: values[7] = __Pyx_Arg_FASTCALL(__pyx_args, 7);
         CYTHON_FALLTHROUGH;
         case  7: values[6] = __Pyx_Arg_FASTCALL(__pyx_args, 6);
         CYTHON_FALLTHROUGH;
         case  6: values[5] = __Pyx_Arg_FASTCALL(__pyx_args, 5);
-        CYTHON_FALLTHROUGH;
-        case  5: values[4] = __Pyx_Arg_FASTCALL(__pyx_args, 4);
+        values[4] = __Pyx_Arg_FASTCALL(__pyx_args, 4);
         values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
         values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
         values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
         values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
-    __pyx_v_rings_atoms = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_UINT32_t(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_rings_atoms.memview)) __PYX_ERR(0, 87, __pyx_L3_error)
-    __pyx_v_rings1_start_indexes = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_UINT32_t(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_rings1_start_indexes.memview)) __PYX_ERR(0, 88, __pyx_L3_error)
-    __pyx_v_rings2_start_indexes = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_UINT32_t(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_rings2_start_indexes.memview)) __PYX_ERR(0, 89, __pyx_L3_error)
-    __pyx_v_coords = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_coords.memview)) __PYX_ERR(0, 90, __pyx_L3_error)
-    __pyx_v_box = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(values[4], PyBUF_WRITABLE); if (unlikely(!__pyx_v_box.memview)) __PYX_ERR(0, 91, __pyx_L3_error)
-    if (values[5]) {
-      __pyx_v_dist_threshold1 = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_dist_threshold1 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 92, __pyx_L3_error)
-    } else {
-      __pyx_v_dist_threshold1 = ((float)((double)4.4));
-    }
+    __pyx_v_donors = ((PyArrayObject *)values[0]);
+    __pyx_v_acceptors = ((PyArrayObject *)values[1]);
+    __pyx_v_coords = ((PyArrayObject *)values[2]);
+    __pyx_v_box = ((PyArrayObject *)values[3]);
+    __pyx_v_sel1 = ((PyArrayObject *)values[4]);
+    __pyx_v_sel2 = ((PyArrayObject *)values[5]);
     if (values[6]) {
-      __pyx_v_angle_threshold1_max = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_angle_threshold1_max == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 93, __pyx_L3_error)
+      __pyx_v_dist_threshold = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_dist_threshold == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 32, __pyx_L3_error)
     } else {
-      __pyx_v_angle_threshold1_max = ((float)((float)30.0));
+      __pyx_v_dist_threshold = ((float)((double)2.5));
     }
     if (values[7]) {
-      __pyx_v_dist_threshold2 = __pyx_PyFloat_AsFloat(values[7]); if (unlikely((__pyx_v_dist_threshold2 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 94, __pyx_L3_error)
+      __pyx_v_angle_threshold = __pyx_PyFloat_AsFloat(values[7]); if (unlikely((__pyx_v_angle_threshold == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 33, __pyx_L3_error)
     } else {
-      __pyx_v_dist_threshold2 = ((float)((double)5.5));
+      __pyx_v_angle_threshold = ((float)((float)120.0));
     }
     if (values[8]) {
-      __pyx_v_angle_threshold2_min = __pyx_PyFloat_AsFloat(values[8]); if (unlikely((__pyx_v_angle_threshold2_min == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 95, __pyx_L3_error)
+      __pyx_v_intra = __Pyx_PyObject_IsTrue(values[8]); if (unlikely((__pyx_v_intra == ((bool)-1)) && PyErr_Occurred())) __PYX_ERR(0, 34, __pyx_L3_error)
+    } else {
+
+      /* "moleculekit/interactions/hbonds/hbonds.pyx":34
+ *         float dist_threshold=2.5,
+ *         float angle_threshold=120,
+ *         bool intra=False,             # <<<<<<<<<<<<<<
+ *         bool ignore_hs=False,
+ *     ):
+ */
+      __pyx_v_intra = ((bool)((int)0));
+    }
+    if (values[9]) {
+      __pyx_v_ignore_hs = __Pyx_PyObject_IsTrue(values[9]); if (unlikely((__pyx_v_ignore_hs == ((bool)-1)) && PyErr_Occurred())) __PYX_ERR(0, 35, __pyx_L3_error)
     } else {
-      __pyx_v_angle_threshold2_min = ((float)((float)60.0));
+
+      /* "moleculekit/interactions/hbonds/hbonds.pyx":35
+ *         float angle_threshold=120,
+ *         bool intra=False,
+ *         bool ignore_hs=False,             # <<<<<<<<<<<<<<
+ *     ):
+ *     cdef int d, a, f, i
+ */
+      __pyx_v_ignore_hs = ((bool)((int)0));
     }
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("calculate", 0, 5, 9, __pyx_nargs); __PYX_ERR(0, 84, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("calculate", 0, 6, 10, __pyx_nargs); __PYX_ERR(0, 23, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_rings_atoms, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_rings1_start_indexes, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_rings2_start_indexes, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_coords, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_box, 1);
-  __Pyx_AddTraceback("moleculekit.interactions.pipi.calculate", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("moleculekit.interactions.hbonds.calculate", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11moleculekit_12interactions_4pipi_calculate(__pyx_self, __pyx_v_rings_atoms, __pyx_v_rings1_start_indexes, __pyx_v_rings2_start_indexes, __pyx_v_coords, __pyx_v_box, __pyx_v_dist_threshold1, __pyx_v_angle_threshold1_max, __pyx_v_dist_threshold2, __pyx_v_angle_threshold2_min);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_donors), __pyx_ptype_5numpy_ndarray, 1, "donors", 0))) __PYX_ERR(0, 26, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_acceptors), __pyx_ptype_5numpy_ndarray, 1, "acceptors", 0))) __PYX_ERR(0, 27, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_coords), __pyx_ptype_5numpy_ndarray, 1, "coords", 0))) __PYX_ERR(0, 28, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_box), __pyx_ptype_5numpy_ndarray, 1, "box", 0))) __PYX_ERR(0, 29, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sel1), __pyx_ptype_5numpy_ndarray, 1, "sel1", 0))) __PYX_ERR(0, 30, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sel2), __pyx_ptype_5numpy_ndarray, 1, "sel2", 0))) __PYX_ERR(0, 31, __pyx_L1_error)
+  __pyx_r = __pyx_pf_11moleculekit_12interactions_6hbonds_calculate(__pyx_self, __pyx_v_donors, __pyx_v_acceptors, __pyx_v_coords, __pyx_v_box, __pyx_v_sel1, __pyx_v_sel2, __pyx_v_dist_threshold, __pyx_v_angle_threshold, __pyx_v_intra, __pyx_v_ignore_hs);
+
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":23
+ * 
+ * import cython
+ * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
+ * @cython.wraparound(False)  # turn off negative index wrapping for entire function
+ * def calculate(
+ */
 
   /* function exit code */
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_rings_atoms, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_rings1_start_indexes, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_rings2_start_indexes, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_coords, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_box, 1);
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __pyx_r = NULL;
+  __pyx_L0:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11moleculekit_12interactions_4pipi_calculate(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_rings_atoms, __Pyx_memviewslice __pyx_v_rings1_start_indexes, __Pyx_memviewslice __pyx_v_rings2_start_indexes, __Pyx_memviewslice __pyx_v_coords, __Pyx_memviewslice __pyx_v_box, float __pyx_v_dist_threshold1, float __pyx_v_angle_threshold1_max, float __pyx_v_dist_threshold2, float __pyx_v_angle_threshold2_min) {
-  int __pyx_v_r1;
-  int __pyx_v_r2;
+static PyObject *__pyx_pf_11moleculekit_12interactions_6hbonds_calculate(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_donors, PyArrayObject *__pyx_v_acceptors, PyArrayObject *__pyx_v_coords, PyArrayObject *__pyx_v_box, PyArrayObject *__pyx_v_sel1, PyArrayObject *__pyx_v_sel2, float __pyx_v_dist_threshold, float __pyx_v_angle_threshold, bool __pyx_v_intra, bool __pyx_v_ignore_hs) {
+  int __pyx_v_d;
+  int __pyx_v_a;
   int __pyx_v_f;
   int __pyx_v_i;
-  int __pyx_v_n_rings1;
-  int __pyx_v_n_rings2;
+  int __pyx_v_n_donors;
+  int __pyx_v_n_acceptors;
   int __pyx_v_n_frames;
   std::vector<std::vector<int> >  __pyx_v_results;
-  std::vector<std::vector<float> >  __pyx_v_distangles;
-  __Pyx_memviewslice __pyx_v_ring1_mean = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_ring2_mean = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_ring1_normal = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_ring2_normal = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_dist_vec_a = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_dist_vec_b = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_half_box = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_tmp1 = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_tmp2 = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t __pyx_v_dist2;
-  __pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t __pyx_v_dot_prod;
-  int __pyx_v_r1_start_idx;
-  int __pyx_v_r2_start_idx;
-  int __pyx_v_r1_end_idx;
-  int __pyx_v_r2_end_idx;
-  double __pyx_v_angle;
+  __pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t __pyx_v_dist2_a;
+  __pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t __pyx_v_dist2_b;
+  __pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t __pyx_v_dotprod;
+  __pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t __pyx_v_val;
+  __pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t __pyx_v_angle;
+  __pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t __pyx_v_d_idx_d;
+  __pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t __pyx_v_d_idx_h;
+  __pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t __pyx_v_d_idx;
+  __pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t __pyx_v_a_idx;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_acceptors;
+  __Pyx_Buffer __pyx_pybuffer_acceptors;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_box;
+  __Pyx_Buffer __pyx_pybuffer_box;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_coords;
+  __Pyx_Buffer __pyx_pybuffer_coords;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_donors;
+  __Pyx_Buffer __pyx_pybuffer_donors;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_sel1;
+  __Pyx_Buffer __pyx_pybuffer_sel1;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_sel2;
+  __Pyx_Buffer __pyx_pybuffer_sel2;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
-  PyObject *__pyx_t_1 = NULL;
+  npy_intp *__pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
-  __Pyx_memviewslice __pyx_t_4 = { 0, 0, { 0 }, { 0 }, { 0 } };
-  int __pyx_t_5;
+  PyObject *__pyx_t_4 = NULL;
+  __Pyx_memviewslice __pyx_t_5 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_t_6;
   int __pyx_t_7;
-  std::vector<int>  __pyx_t_8;
-  std::vector<float>  __pyx_t_9;
+  int __pyx_t_8;
+  std::vector<int>  __pyx_t_9;
   int __pyx_t_10;
   Py_ssize_t __pyx_t_11;
   Py_ssize_t __pyx_t_12;
   Py_ssize_t __pyx_t_13;
   int __pyx_t_14;
   int __pyx_t_15;
   int __pyx_t_16;
   int __pyx_t_17;
   int __pyx_t_18;
   int __pyx_t_19;
-  int __pyx_t_20;
+  size_t __pyx_t_20;
   int __pyx_t_21;
-  size_t __pyx_t_22;
-  Py_ssize_t __pyx_t_23;
-  float __pyx_t_24;
-  size_t __pyx_t_25;
-  Py_ssize_t __pyx_t_26;
-  Py_ssize_t __pyx_t_27;
-  Py_ssize_t __pyx_t_28;
+  int __pyx_t_22;
+  size_t __pyx_t_23;
+  Py_ssize_t __pyx_t_24;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("calculate", 1);
+  __pyx_pybuffer_donors.pybuffer.buf = NULL;
+  __pyx_pybuffer_donors.refcount = 0;
+  __pyx_pybuffernd_donors.data = NULL;
+  __pyx_pybuffernd_donors.rcbuffer = &__pyx_pybuffer_donors;
+  __pyx_pybuffer_acceptors.pybuffer.buf = NULL;
+  __pyx_pybuffer_acceptors.refcount = 0;
+  __pyx_pybuffernd_acceptors.data = NULL;
+  __pyx_pybuffernd_acceptors.rcbuffer = &__pyx_pybuffer_acceptors;
+  __pyx_pybuffer_coords.pybuffer.buf = NULL;
+  __pyx_pybuffer_coords.refcount = 0;
+  __pyx_pybuffernd_coords.data = NULL;
+  __pyx_pybuffernd_coords.rcbuffer = &__pyx_pybuffer_coords;
+  __pyx_pybuffer_box.pybuffer.buf = NULL;
+  __pyx_pybuffer_box.refcount = 0;
+  __pyx_pybuffernd_box.data = NULL;
+  __pyx_pybuffernd_box.rcbuffer = &__pyx_pybuffer_box;
+  __pyx_pybuffer_sel1.pybuffer.buf = NULL;
+  __pyx_pybuffer_sel1.refcount = 0;
+  __pyx_pybuffernd_sel1.data = NULL;
+  __pyx_pybuffernd_sel1.rcbuffer = &__pyx_pybuffer_sel1;
+  __pyx_pybuffer_sel2.pybuffer.buf = NULL;
+  __pyx_pybuffer_sel2.refcount = 0;
+  __pyx_pybuffernd_sel2.data = NULL;
+  __pyx_pybuffernd_sel2.rcbuffer = &__pyx_pybuffer_sel2;
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_donors.rcbuffer->pybuffer, (PyObject*)__pyx_v_donors, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 23, __pyx_L1_error)
+  }
+  __pyx_pybuffernd_donors.diminfo[0].strides = __pyx_pybuffernd_donors.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_donors.diminfo[0].shape = __pyx_pybuffernd_donors.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_donors.diminfo[1].strides = __pyx_pybuffernd_donors.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_donors.diminfo[1].shape = __pyx_pybuffernd_donors.rcbuffer->pybuffer.shape[1];
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_acceptors.rcbuffer->pybuffer, (PyObject*)__pyx_v_acceptors, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 23, __pyx_L1_error)
+  }
+  __pyx_pybuffernd_acceptors.diminfo[0].strides = __pyx_pybuffernd_acceptors.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_acceptors.diminfo[0].shape = __pyx_pybuffernd_acceptors.rcbuffer->pybuffer.shape[0];
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_coords.rcbuffer->pybuffer, (PyObject*)__pyx_v_coords, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) __PYX_ERR(0, 23, __pyx_L1_error)
+  }
+  __pyx_pybuffernd_coords.diminfo[0].strides = __pyx_pybuffernd_coords.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_coords.diminfo[0].shape = __pyx_pybuffernd_coords.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_coords.diminfo[1].strides = __pyx_pybuffernd_coords.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_coords.diminfo[1].shape = __pyx_pybuffernd_coords.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_coords.diminfo[2].strides = __pyx_pybuffernd_coords.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_coords.diminfo[2].shape = __pyx_pybuffernd_coords.rcbuffer->pybuffer.shape[2];
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_box.rcbuffer->pybuffer, (PyObject*)__pyx_v_box, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 23, __pyx_L1_error)
+  }
+  __pyx_pybuffernd_box.diminfo[0].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box.diminfo[0].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_box.diminfo[1].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_box.diminfo[1].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[1];
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_sel1.rcbuffer->pybuffer, (PyObject*)__pyx_v_sel1, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 23, __pyx_L1_error)
+  }
+  __pyx_pybuffernd_sel1.diminfo[0].strides = __pyx_pybuffernd_sel1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_sel1.diminfo[0].shape = __pyx_pybuffernd_sel1.rcbuffer->pybuffer.shape[0];
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_sel2.rcbuffer->pybuffer, (PyObject*)__pyx_v_sel2, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 23, __pyx_L1_error)
+  }
+  __pyx_pybuffernd_sel2.diminfo[0].strides = __pyx_pybuffernd_sel2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_sel2.diminfo[0].shape = __pyx_pybuffernd_sel2.rcbuffer->pybuffer.shape[0];
 
-  /* "moleculekit/interactions/pipi/pipi.pyx":98
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":38
  *     ):
- *     cdef int r1, r2, f, i
- *     cdef int n_rings1 = rings1_start_indexes.shape[0] - 1  # Remove one for the index which we append to the start             # <<<<<<<<<<<<<<
- *     cdef int n_rings2 = rings2_start_indexes.shape[0] - 1
+ *     cdef int d, a, f, i
+ *     cdef int n_donors = donors.shape[0]             # <<<<<<<<<<<<<<
+ *     cdef int n_acceptors = acceptors.shape[0]
  *     cdef int n_frames = coords.shape[2]
  */
-  __pyx_v_n_rings1 = ((__pyx_v_rings1_start_indexes.shape[0]) - 1);
+  __pyx_t_1 = __pyx_f_5numpy_7ndarray_5shape_shape(((PyArrayObject *)__pyx_v_donors)); if (unlikely(__pyx_t_1 == ((npy_intp *)NULL) && PyErr_Occurred())) __PYX_ERR(0, 38, __pyx_L1_error)
+  __pyx_v_n_donors = (__pyx_t_1[0]);
 
-  /* "moleculekit/interactions/pipi/pipi.pyx":99
- *     cdef int r1, r2, f, i
- *     cdef int n_rings1 = rings1_start_indexes.shape[0] - 1  # Remove one for the index which we append to the start
- *     cdef int n_rings2 = rings2_start_indexes.shape[0] - 1             # <<<<<<<<<<<<<<
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":39
+ *     cdef int d, a, f, i
+ *     cdef int n_donors = donors.shape[0]
+ *     cdef int n_acceptors = acceptors.shape[0]             # <<<<<<<<<<<<<<
  *     cdef int n_frames = coords.shape[2]
- * 
+ *     cdef vector[vector[int]] results
  */
-  __pyx_v_n_rings2 = ((__pyx_v_rings2_start_indexes.shape[0]) - 1);
+  __pyx_t_1 = __pyx_f_5numpy_7ndarray_5shape_shape(((PyArrayObject *)__pyx_v_acceptors)); if (unlikely(__pyx_t_1 == ((npy_intp *)NULL) && PyErr_Occurred())) __PYX_ERR(0, 39, __pyx_L1_error)
+  __pyx_v_n_acceptors = (__pyx_t_1[0]);
 
-  /* "moleculekit/interactions/pipi/pipi.pyx":100
- *     cdef int n_rings1 = rings1_start_indexes.shape[0] - 1  # Remove one for the index which we append to the start
- *     cdef int n_rings2 = rings2_start_indexes.shape[0] - 1
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":40
+ *     cdef int n_donors = donors.shape[0]
+ *     cdef int n_acceptors = acceptors.shape[0]
  *     cdef int n_frames = coords.shape[2]             # <<<<<<<<<<<<<<
- * 
  *     cdef vector[vector[int]] results
+ *     cdef FLOAT32_t[:] dist_vec_a = np.zeros(3, dtype=FLOAT32)
  */
-  __pyx_v_n_frames = (__pyx_v_coords.shape[2]);
+  __pyx_t_1 = __pyx_f_5numpy_7ndarray_5shape_shape(((PyArrayObject *)__pyx_v_coords)); if (unlikely(__pyx_t_1 == ((npy_intp *)NULL) && PyErr_Occurred())) __PYX_ERR(0, 40, __pyx_L1_error)
+  __pyx_v_n_frames = (__pyx_t_1[2]);
 
-  /* "moleculekit/interactions/pipi/pipi.pyx":104
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":42
+ *     cdef int n_frames = coords.shape[2]
  *     cdef vector[vector[int]] results
- *     cdef vector[vector[float]] distangles
- *     cdef FLOAT32_t[:] ring1_mean = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
- *     cdef FLOAT32_t[:] ring2_mean = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] ring1_normal = np.zeros(3, dtype=FLOAT32)
- */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 104, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 104, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 104, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 104, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 104, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__11, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 104, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 104, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_v_ring1_mean = __pyx_t_4;
-  __pyx_t_4.memview = NULL;
-  __pyx_t_4.data = NULL;
-
-  /* "moleculekit/interactions/pipi/pipi.pyx":105
- *     cdef vector[vector[float]] distangles
- *     cdef FLOAT32_t[:] ring1_mean = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] ring2_mean = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
- *     cdef FLOAT32_t[:] ring1_normal = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] ring2_normal = np.zeros(3, dtype=FLOAT32)
- */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 105, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 105, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 105, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 105, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 105, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__11, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 105, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 105, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_v_ring2_mean = __pyx_t_4;
-  __pyx_t_4.memview = NULL;
-  __pyx_t_4.data = NULL;
-
-  /* "moleculekit/interactions/pipi/pipi.pyx":106
- *     cdef FLOAT32_t[:] ring1_mean = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] ring2_mean = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] ring1_normal = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
- *     cdef FLOAT32_t[:] ring2_normal = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] dist_vec_a = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
+ *     cdef FLOAT32_t[:] dist_vec_b = np.zeros(3, dtype=FLOAT32)
  *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 106, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 42, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 106, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 42, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 106, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 42, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 106, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 106, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__11, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 106, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 42, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 42, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__11, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 42, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 106, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_ring1_normal = __pyx_t_4;
-  __pyx_t_4.memview = NULL;
-  __pyx_t_4.data = NULL;
-
-  /* "moleculekit/interactions/pipi/pipi.pyx":107
- *     cdef FLOAT32_t[:] ring2_mean = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] ring1_normal = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] ring2_normal = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 42, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_v_dist_vec_a = __pyx_t_5;
+  __pyx_t_5.memview = NULL;
+  __pyx_t_5.data = NULL;
+
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":43
+ *     cdef vector[vector[int]] results
+ *     cdef FLOAT32_t[:] dist_vec_a = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] dist_vec_b = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
  *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] tmp1 = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t dist2_a, dist2_b, dotprod, val, angle
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 107, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 107, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 43, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 43, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 107, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 107, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 43, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 43, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 107, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 43, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__11, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 107, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__11, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 43, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 107, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 43, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_v_ring2_normal = __pyx_t_4;
-  __pyx_t_4.memview = NULL;
-  __pyx_t_4.data = NULL;
-
-  /* "moleculekit/interactions/pipi/pipi.pyx":108
- *     cdef FLOAT32_t[:] ring1_normal = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] ring2_normal = np.zeros(3, dtype=FLOAT32)
+  __pyx_v_dist_vec_b = __pyx_t_5;
+  __pyx_t_5.memview = NULL;
+  __pyx_t_5.data = NULL;
+
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":44
+ *     cdef FLOAT32_t[:] dist_vec_a = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] dist_vec_b = np.zeros(3, dtype=FLOAT32)
  *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
- *     cdef FLOAT32_t[:] tmp1 = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] tmp2 = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t dist2_a, dist2_b, dotprod, val, angle
+ *     cdef UINT32_t d_idx_d, d_idx_h, d_idx, a_idx
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 108, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 108, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 108, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 44, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 108, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 108, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__11, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 108, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 44, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 108, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_v_half_box = __pyx_t_4;
-  __pyx_t_4.memview = NULL;
-  __pyx_t_4.data = NULL;
-
-  /* "moleculekit/interactions/pipi/pipi.pyx":109
- *     cdef FLOAT32_t[:] ring2_normal = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] tmp1 = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
- *     cdef FLOAT32_t[:] tmp2 = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t dist2, dot_prod
- */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 109, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 109, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 44, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 109, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 44, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 109, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 109, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__11, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 109, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 44, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 109, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_tmp1 = __pyx_t_4;
-  __pyx_t_4.memview = NULL;
-  __pyx_t_4.data = NULL;
-
-  /* "moleculekit/interactions/pipi/pipi.pyx":110
- *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] tmp1 = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] tmp2 = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
- *     cdef FLOAT32_t dist2, dot_prod
- *     cdef int r1_start_idx, r2_start_idx, r1_end_idx, r2_end_idx
- */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 110, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 110, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__11, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 44, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 110, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 110, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 110, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__11, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 110, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 44, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 110, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_v_tmp2 = __pyx_t_4;
-  __pyx_t_4.memview = NULL;
-  __pyx_t_4.data = NULL;
+  __pyx_v_half_box = __pyx_t_5;
+  __pyx_t_5.memview = NULL;
+  __pyx_t_5.data = NULL;
 
-  /* "moleculekit/interactions/pipi/pipi.pyx":114
- *     cdef int r1_start_idx, r2_start_idx, r1_end_idx, r2_end_idx
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":48
+ *     cdef UINT32_t d_idx_d, d_idx_h, d_idx, a_idx
  * 
- *     dist_threshold1 = dist_threshold1 * dist_threshold1             # <<<<<<<<<<<<<<
- *     dist_threshold2 = dist_threshold2 * dist_threshold2
+ *     dist_threshold = dist_threshold * dist_threshold             # <<<<<<<<<<<<<<
+ *     angle_threshold = angle_threshold / 57.29578
  * 
  */
-  __pyx_v_dist_threshold1 = (__pyx_v_dist_threshold1 * __pyx_v_dist_threshold1);
+  __pyx_v_dist_threshold = (__pyx_v_dist_threshold * __pyx_v_dist_threshold);
 
-  /* "moleculekit/interactions/pipi/pipi.pyx":115
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":49
  * 
- *     dist_threshold1 = dist_threshold1 * dist_threshold1
- *     dist_threshold2 = dist_threshold2 * dist_threshold2             # <<<<<<<<<<<<<<
+ *     dist_threshold = dist_threshold * dist_threshold
+ *     angle_threshold = angle_threshold / 57.29578             # <<<<<<<<<<<<<<
  * 
  *     for f in range(n_frames):
  */
-  __pyx_v_dist_threshold2 = (__pyx_v_dist_threshold2 * __pyx_v_dist_threshold2);
+  __pyx_v_angle_threshold = (((double)__pyx_v_angle_threshold) / 57.29578);
 
-  /* "moleculekit/interactions/pipi/pipi.pyx":117
- *     dist_threshold2 = dist_threshold2 * dist_threshold2
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":51
+ *     angle_threshold = angle_threshold / 57.29578
  * 
  *     for f in range(n_frames):             # <<<<<<<<<<<<<<
  *         results.push_back(vector[int]())
- *         distangles.push_back(vector[float]())
+ *         for i in range(3):
  */
-  __pyx_t_5 = __pyx_v_n_frames;
-  __pyx_t_6 = __pyx_t_5;
-  for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
-    __pyx_v_f = __pyx_t_7;
+  __pyx_t_6 = __pyx_v_n_frames;
+  __pyx_t_7 = __pyx_t_6;
+  for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
+    __pyx_v_f = __pyx_t_8;
 
-    /* "moleculekit/interactions/pipi/pipi.pyx":118
+    /* "moleculekit/interactions/hbonds/hbonds.pyx":52
  * 
  *     for f in range(n_frames):
  *         results.push_back(vector[int]())             # <<<<<<<<<<<<<<
- *         distangles.push_back(vector[float]())
- *         for i in range(3):
- */
-    try {
-      __pyx_t_8 = std::vector<int> ();
-    } catch(...) {
-      __Pyx_CppExn2PyErr();
-      __PYX_ERR(0, 118, __pyx_L1_error)
-    }
-    try {
-      __pyx_v_results.push_back(__pyx_t_8);
-    } catch(...) {
-      __Pyx_CppExn2PyErr();
-      __PYX_ERR(0, 118, __pyx_L1_error)
-    }
-
-    /* "moleculekit/interactions/pipi/pipi.pyx":119
- *     for f in range(n_frames):
- *         results.push_back(vector[int]())
- *         distangles.push_back(vector[float]())             # <<<<<<<<<<<<<<
  *         for i in range(3):
  *             half_box[i] = box[i, f] / 2
  */
     try {
-      __pyx_t_9 = std::vector<float> ();
+      __pyx_t_9 = std::vector<int> ();
     } catch(...) {
       __Pyx_CppExn2PyErr();
-      __PYX_ERR(0, 119, __pyx_L1_error)
+      __PYX_ERR(0, 52, __pyx_L1_error)
     }
     try {
-      __pyx_v_distangles.push_back(__pyx_t_9);
+      __pyx_v_results.push_back(__pyx_t_9);
     } catch(...) {
       __Pyx_CppExn2PyErr();
-      __PYX_ERR(0, 119, __pyx_L1_error)
+      __PYX_ERR(0, 52, __pyx_L1_error)
     }
 
-    /* "moleculekit/interactions/pipi/pipi.pyx":120
+    /* "moleculekit/interactions/hbonds/hbonds.pyx":53
+ *     for f in range(n_frames):
  *         results.push_back(vector[int]())
- *         distangles.push_back(vector[float]())
  *         for i in range(3):             # <<<<<<<<<<<<<<
  *             half_box[i] = box[i, f] / 2
  * 
  */
     for (__pyx_t_10 = 0; __pyx_t_10 < 3; __pyx_t_10+=1) {
       __pyx_v_i = __pyx_t_10;
 
-      /* "moleculekit/interactions/pipi/pipi.pyx":121
- *         distangles.push_back(vector[float]())
+      /* "moleculekit/interactions/hbonds/hbonds.pyx":54
+ *         results.push_back(vector[int]())
  *         for i in range(3):
  *             half_box[i] = box[i, f] / 2             # <<<<<<<<<<<<<<
  * 
- *         for r1 in range(n_rings1):
+ *         for d in range(n_donors):
  */
       __pyx_t_11 = __pyx_v_i;
       __pyx_t_12 = __pyx_v_f;
       __pyx_t_13 = __pyx_v_i;
-      *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_half_box.data + __pyx_t_13 * __pyx_v_half_box.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_11 * __pyx_v_box.strides[0]) ) + __pyx_t_12 * __pyx_v_box.strides[1]) ))) / 2.0);
+      *((__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_half_box.data + __pyx_t_13 * __pyx_v_half_box.strides[0]) )) = ((*__Pyx_BufPtrStrided2d(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_box.diminfo[1].strides)) / 2.0);
     }
 
-    /* "moleculekit/interactions/pipi/pipi.pyx":123
+    /* "moleculekit/interactions/hbonds/hbonds.pyx":56
  *             half_box[i] = box[i, f] / 2
  * 
- *         for r1 in range(n_rings1):             # <<<<<<<<<<<<<<
- *             for r2 in range(n_rings2):
- *                 r1_start_idx = rings1_start_indexes[r1]
+ *         for d in range(n_donors):             # <<<<<<<<<<<<<<
+ *             for a in range(n_acceptors):
+ *                 a_idx = acceptors[a]
  */
-    __pyx_t_10 = __pyx_v_n_rings1;
+    __pyx_t_10 = __pyx_v_n_donors;
     __pyx_t_14 = __pyx_t_10;
     for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
-      __pyx_v_r1 = __pyx_t_15;
+      __pyx_v_d = __pyx_t_15;
 
-      /* "moleculekit/interactions/pipi/pipi.pyx":124
+      /* "moleculekit/interactions/hbonds/hbonds.pyx":57
  * 
- *         for r1 in range(n_rings1):
- *             for r2 in range(n_rings2):             # <<<<<<<<<<<<<<
- *                 r1_start_idx = rings1_start_indexes[r1]
- *                 r1_end_idx = rings1_start_indexes[r1+1]
+ *         for d in range(n_donors):
+ *             for a in range(n_acceptors):             # <<<<<<<<<<<<<<
+ *                 a_idx = acceptors[a]
+ *                 d_idx_d = donors[d, 0]
  */
-      __pyx_t_16 = __pyx_v_n_rings2;
+      __pyx_t_16 = __pyx_v_n_acceptors;
       __pyx_t_17 = __pyx_t_16;
       for (__pyx_t_18 = 0; __pyx_t_18 < __pyx_t_17; __pyx_t_18+=1) {
-        __pyx_v_r2 = __pyx_t_18;
-
-        /* "moleculekit/interactions/pipi/pipi.pyx":125
- *         for r1 in range(n_rings1):
- *             for r2 in range(n_rings2):
- *                 r1_start_idx = rings1_start_indexes[r1]             # <<<<<<<<<<<<<<
- *                 r1_end_idx = rings1_start_indexes[r1+1]
- *                 r2_start_idx = rings2_start_indexes[r2]
- */
-        __pyx_t_12 = __pyx_v_r1;
-        __pyx_v_r1_start_idx = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings1_start_indexes.data + __pyx_t_12 * __pyx_v_rings1_start_indexes.strides[0]) )));
+        __pyx_v_a = __pyx_t_18;
 
-        /* "moleculekit/interactions/pipi/pipi.pyx":126
- *             for r2 in range(n_rings2):
- *                 r1_start_idx = rings1_start_indexes[r1]
- *                 r1_end_idx = rings1_start_indexes[r1+1]             # <<<<<<<<<<<<<<
- *                 r2_start_idx = rings2_start_indexes[r2]
- *                 r2_end_idx = rings2_start_indexes[r2+1]
+        /* "moleculekit/interactions/hbonds/hbonds.pyx":58
+ *         for d in range(n_donors):
+ *             for a in range(n_acceptors):
+ *                 a_idx = acceptors[a]             # <<<<<<<<<<<<<<
+ *                 d_idx_d = donors[d, 0]
+ *                 d_idx_h = donors[d, 1]
  */
-        __pyx_t_12 = (__pyx_v_r1 + 1);
-        __pyx_v_r1_end_idx = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings1_start_indexes.data + __pyx_t_12 * __pyx_v_rings1_start_indexes.strides[0]) )));
+        __pyx_t_12 = __pyx_v_a;
+        __pyx_v_a_idx = (*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t *, __pyx_pybuffernd_acceptors.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_acceptors.diminfo[0].strides));
 
-        /* "moleculekit/interactions/pipi/pipi.pyx":127
- *                 r1_start_idx = rings1_start_indexes[r1]
- *                 r1_end_idx = rings1_start_indexes[r1+1]
- *                 r2_start_idx = rings2_start_indexes[r2]             # <<<<<<<<<<<<<<
- *                 r2_end_idx = rings2_start_indexes[r2+1]
+        /* "moleculekit/interactions/hbonds/hbonds.pyx":59
+ *             for a in range(n_acceptors):
+ *                 a_idx = acceptors[a]
+ *                 d_idx_d = donors[d, 0]             # <<<<<<<<<<<<<<
+ *                 d_idx_h = donors[d, 1]
  * 
  */
-        __pyx_t_12 = __pyx_v_r2;
-        __pyx_v_r2_start_idx = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings2_start_indexes.data + __pyx_t_12 * __pyx_v_rings2_start_indexes.strides[0]) )));
+        __pyx_t_12 = __pyx_v_d;
+        __pyx_t_11 = 0;
+        __pyx_v_d_idx_d = (*__Pyx_BufPtrStrided2d(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t *, __pyx_pybuffernd_donors.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_donors.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_donors.diminfo[1].strides));
 
-        /* "moleculekit/interactions/pipi/pipi.pyx":128
- *                 r1_end_idx = rings1_start_indexes[r1+1]
- *                 r2_start_idx = rings2_start_indexes[r2]
- *                 r2_end_idx = rings2_start_indexes[r2+1]             # <<<<<<<<<<<<<<
+        /* "moleculekit/interactions/hbonds/hbonds.pyx":60
+ *                 a_idx = acceptors[a]
+ *                 d_idx_d = donors[d, 0]
+ *                 d_idx_h = donors[d, 1]             # <<<<<<<<<<<<<<
  * 
- *                 if r1_start_idx == r2_start_idx and r1_end_idx == r2_end_idx:
+ *                 # Don't calculate h-bonds with identical donor-acceptor atom
  */
-        __pyx_t_12 = (__pyx_v_r2 + 1);
-        __pyx_v_r2_end_idx = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings2_start_indexes.data + __pyx_t_12 * __pyx_v_rings2_start_indexes.strides[0]) )));
+        __pyx_t_11 = __pyx_v_d;
+        __pyx_t_12 = 1;
+        __pyx_v_d_idx_h = (*__Pyx_BufPtrStrided2d(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t *, __pyx_pybuffernd_donors.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_donors.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_donors.diminfo[1].strides));
 
-        /* "moleculekit/interactions/pipi/pipi.pyx":130
- *                 r2_end_idx = rings2_start_indexes[r2+1]
+        /* "moleculekit/interactions/hbonds/hbonds.pyx":63
  * 
- *                 if r1_start_idx == r2_start_idx and r1_end_idx == r2_end_idx:             # <<<<<<<<<<<<<<
- *                     # Skip self-interactions of identical rings
+ *                 # Don't calculate h-bonds with identical donor-acceptor atom
+ *                 if a_idx == d_idx_d:             # <<<<<<<<<<<<<<
  *                     continue
+ * 
  */
-        __pyx_t_20 = (__pyx_v_r1_start_idx == __pyx_v_r2_start_idx);
-        if (__pyx_t_20) {
-        } else {
-          __pyx_t_19 = __pyx_t_20;
-          goto __pyx_L12_bool_binop_done;
-        }
-        __pyx_t_20 = (__pyx_v_r1_end_idx == __pyx_v_r2_end_idx);
-        __pyx_t_19 = __pyx_t_20;
-        __pyx_L12_bool_binop_done:;
+        __pyx_t_19 = (__pyx_v_a_idx == __pyx_v_d_idx_d);
         if (__pyx_t_19) {
 
-          /* "moleculekit/interactions/pipi/pipi.pyx":132
- *                 if r1_start_idx == r2_start_idx and r1_end_idx == r2_end_idx:
- *                     # Skip self-interactions of identical rings
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":64
+ *                 # Don't calculate h-bonds with identical donor-acceptor atom
+ *                 if a_idx == d_idx_d:
  *                     continue             # <<<<<<<<<<<<<<
  * 
- *                 # Exit early if any of the two ring's atoms are too far
+ *                 if intra:
  */
           goto __pyx_L9_continue;
 
-          /* "moleculekit/interactions/pipi/pipi.pyx":130
- *                 r2_end_idx = rings2_start_indexes[r2+1]
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":63
  * 
- *                 if r1_start_idx == r2_start_idx and r1_end_idx == r2_end_idx:             # <<<<<<<<<<<<<<
- *                     # Skip self-interactions of identical rings
+ *                 # Don't calculate h-bonds with identical donor-acceptor atom
+ *                 if a_idx == d_idx_d:             # <<<<<<<<<<<<<<
  *                     continue
+ * 
  */
         }
 
-        /* "moleculekit/interactions/pipi/pipi.pyx":135
+        /* "moleculekit/interactions/hbonds/hbonds.pyx":66
+ *                     continue
  * 
- *                 # Exit early if any of the two ring's atoms are too far
- *                 for i in range(3):             # <<<<<<<<<<<<<<
- *                     tmp1[i] = coords[rings_atoms[r1_start_idx], i, f]
- *                     tmp2[i] = coords[rings_atoms[r2_start_idx], i, f]
+ *                 if intra:             # <<<<<<<<<<<<<<
+ *                     # Both donor and acceptors must be selected
+ *                     if sel1[a_idx] == 0 or sel1[d_idx_d] == 0:
+ */
+        __pyx_t_19 = (__pyx_v_intra != 0);
+        if (__pyx_t_19) {
+
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":68
+ *                 if intra:
+ *                     # Both donor and acceptors must be selected
+ *                     if sel1[a_idx] == 0 or sel1[d_idx_d] == 0:             # <<<<<<<<<<<<<<
+ *                         continue
+ *                 else:
+ */
+          __pyx_t_20 = __pyx_v_a_idx;
+          __pyx_t_21 = ((*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t *, __pyx_pybuffernd_sel1.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_sel1.diminfo[0].strides)) == 0);
+          if (!__pyx_t_21) {
+          } else {
+            __pyx_t_19 = __pyx_t_21;
+            goto __pyx_L14_bool_binop_done;
+          }
+          __pyx_t_20 = __pyx_v_d_idx_d;
+          __pyx_t_21 = ((*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t *, __pyx_pybuffernd_sel1.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_sel1.diminfo[0].strides)) == 0);
+          __pyx_t_19 = __pyx_t_21;
+          __pyx_L14_bool_binop_done:;
+          if (__pyx_t_19) {
+
+            /* "moleculekit/interactions/hbonds/hbonds.pyx":69
+ *                     # Both donor and acceptors must be selected
+ *                     if sel1[a_idx] == 0 or sel1[d_idx_d] == 0:
+ *                         continue             # <<<<<<<<<<<<<<
+ *                 else:
+ *                     # Donor and acceptor must belong to different selections
+ */
+            goto __pyx_L9_continue;
+
+            /* "moleculekit/interactions/hbonds/hbonds.pyx":68
+ *                 if intra:
+ *                     # Both donor and acceptors must be selected
+ *                     if sel1[a_idx] == 0 or sel1[d_idx_d] == 0:             # <<<<<<<<<<<<<<
+ *                         continue
+ *                 else:
+ */
+          }
+
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":66
+ *                     continue
+ * 
+ *                 if intra:             # <<<<<<<<<<<<<<
+ *                     # Both donor and acceptors must be selected
+ *                     if sel1[a_idx] == 0 or sel1[d_idx_d] == 0:
+ */
+          goto __pyx_L12;
+        }
+
+        /* "moleculekit/interactions/hbonds/hbonds.pyx":72
+ *                 else:
+ *                     # Donor and acceptor must belong to different selections
+ *                     if not ((sel1[a_idx] == 1 and sel2[d_idx_d] == 1) or (sel2[a_idx] == 1 and sel1[d_idx_d] == 1)):             # <<<<<<<<<<<<<<
+ *                         continue
+ * 
+ */
+        /*else*/ {
+          __pyx_t_20 = __pyx_v_a_idx;
+          __pyx_t_21 = ((*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t *, __pyx_pybuffernd_sel1.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_sel1.diminfo[0].strides)) == 1);
+          if (!__pyx_t_21) {
+            goto __pyx_L18_next_or;
+          } else {
+          }
+          __pyx_t_20 = __pyx_v_d_idx_d;
+          __pyx_t_21 = ((*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t *, __pyx_pybuffernd_sel2.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_sel2.diminfo[0].strides)) == 1);
+          if (!__pyx_t_21) {
+          } else {
+            __pyx_t_19 = __pyx_t_21;
+            goto __pyx_L17_bool_binop_done;
+          }
+          __pyx_L18_next_or:;
+          __pyx_t_20 = __pyx_v_a_idx;
+          __pyx_t_21 = ((*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t *, __pyx_pybuffernd_sel2.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_sel2.diminfo[0].strides)) == 1);
+          if (__pyx_t_21) {
+          } else {
+            __pyx_t_19 = __pyx_t_21;
+            goto __pyx_L17_bool_binop_done;
+          }
+          __pyx_t_20 = __pyx_v_d_idx_d;
+          __pyx_t_21 = ((*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_12interactions_6hbonds_UINT32_t *, __pyx_pybuffernd_sel1.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_sel1.diminfo[0].strides)) == 1);
+          __pyx_t_19 = __pyx_t_21;
+          __pyx_L17_bool_binop_done:;
+          __pyx_t_21 = (!__pyx_t_19);
+          if (__pyx_t_21) {
+
+            /* "moleculekit/interactions/hbonds/hbonds.pyx":73
+ *                     # Donor and acceptor must belong to different selections
+ *                     if not ((sel1[a_idx] == 1 and sel2[d_idx_d] == 1) or (sel2[a_idx] == 1 and sel1[d_idx_d] == 1)):
+ *                         continue             # <<<<<<<<<<<<<<
+ * 
+ *                 dist2_a = 0
  */
-        for (__pyx_t_21 = 0; __pyx_t_21 < 3; __pyx_t_21+=1) {
-          __pyx_v_i = __pyx_t_21;
+            goto __pyx_L9_continue;
 
-          /* "moleculekit/interactions/pipi/pipi.pyx":136
- *                 # Exit early if any of the two ring's atoms are too far
+            /* "moleculekit/interactions/hbonds/hbonds.pyx":72
+ *                 else:
+ *                     # Donor and acceptor must belong to different selections
+ *                     if not ((sel1[a_idx] == 1 and sel2[d_idx_d] == 1) or (sel2[a_idx] == 1 and sel1[d_idx_d] == 1)):             # <<<<<<<<<<<<<<
+ *                         continue
+ * 
+ */
+          }
+        }
+        __pyx_L12:;
+
+        /* "moleculekit/interactions/hbonds/hbonds.pyx":75
+ *                         continue
+ * 
+ *                 dist2_a = 0             # <<<<<<<<<<<<<<
+ *                 dist2_b = 0
+ *                 d_idx = d_idx_h
+ */
+        __pyx_v_dist2_a = 0.0;
+
+        /* "moleculekit/interactions/hbonds/hbonds.pyx":76
+ * 
+ *                 dist2_a = 0
+ *                 dist2_b = 0             # <<<<<<<<<<<<<<
+ *                 d_idx = d_idx_h
+ *                 if ignore_hs: # If we ignore the hydrogen just calculate heavy to heavy distance
+ */
+        __pyx_v_dist2_b = 0.0;
+
+        /* "moleculekit/interactions/hbonds/hbonds.pyx":77
+ *                 dist2_a = 0
+ *                 dist2_b = 0
+ *                 d_idx = d_idx_h             # <<<<<<<<<<<<<<
+ *                 if ignore_hs: # If we ignore the hydrogen just calculate heavy to heavy distance
+ *                     d_idx = d_idx_d
+ */
+        __pyx_v_d_idx = __pyx_v_d_idx_h;
+
+        /* "moleculekit/interactions/hbonds/hbonds.pyx":78
+ *                 dist2_b = 0
+ *                 d_idx = d_idx_h
+ *                 if ignore_hs: # If we ignore the hydrogen just calculate heavy to heavy distance             # <<<<<<<<<<<<<<
+ *                     d_idx = d_idx_d
+ *                 # Calculate donor hydrogen (or heavy if ignore_hs) to acceptor vector
+ */
+        __pyx_t_21 = (__pyx_v_ignore_hs != 0);
+        if (__pyx_t_21) {
+
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":79
+ *                 d_idx = d_idx_h
+ *                 if ignore_hs: # If we ignore the hydrogen just calculate heavy to heavy distance
+ *                     d_idx = d_idx_d             # <<<<<<<<<<<<<<
+ *                 # Calculate donor hydrogen (or heavy if ignore_hs) to acceptor vector
  *                 for i in range(3):
- *                     tmp1[i] = coords[rings_atoms[r1_start_idx], i, f]             # <<<<<<<<<<<<<<
- *                     tmp2[i] = coords[rings_atoms[r2_start_idx], i, f]
- *                 dist2 = _wrapped_dist(f, tmp1, tmp2, half_box, box)
  */
-          __pyx_t_12 = __pyx_v_r1_start_idx;
-          __pyx_t_22 = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_12 * __pyx_v_rings_atoms.strides[0]) )));
-          __pyx_t_11 = __pyx_v_i;
-          __pyx_t_13 = __pyx_v_f;
-          __pyx_t_23 = __pyx_v_i;
-          *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_tmp1.data + __pyx_t_23 * __pyx_v_tmp1.strides[0]) )) = (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_22 * __pyx_v_coords.strides[0]) ) + __pyx_t_11 * __pyx_v_coords.strides[1]) ) + __pyx_t_13 * __pyx_v_coords.strides[2]) )));
+          __pyx_v_d_idx = __pyx_v_d_idx_d;
 
-          /* "moleculekit/interactions/pipi/pipi.pyx":137
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":78
+ *                 dist2_b = 0
+ *                 d_idx = d_idx_h
+ *                 if ignore_hs: # If we ignore the hydrogen just calculate heavy to heavy distance             # <<<<<<<<<<<<<<
+ *                     d_idx = d_idx_d
+ *                 # Calculate donor hydrogen (or heavy if ignore_hs) to acceptor vector
+ */
+        }
+
+        /* "moleculekit/interactions/hbonds/hbonds.pyx":81
+ *                     d_idx = d_idx_d
+ *                 # Calculate donor hydrogen (or heavy if ignore_hs) to acceptor vector
+ *                 for i in range(3):             # <<<<<<<<<<<<<<
+ *                     val = coords[a_idx, i, f] - coords[d_idx, i, f]
+ *                     # Wrap the distance vector into the periodic box
+ */
+        for (__pyx_t_22 = 0; __pyx_t_22 < 3; __pyx_t_22+=1) {
+          __pyx_v_i = __pyx_t_22;
+
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":82
+ *                 # Calculate donor hydrogen (or heavy if ignore_hs) to acceptor vector
  *                 for i in range(3):
- *                     tmp1[i] = coords[rings_atoms[r1_start_idx], i, f]
- *                     tmp2[i] = coords[rings_atoms[r2_start_idx], i, f]             # <<<<<<<<<<<<<<
- *                 dist2 = _wrapped_dist(f, tmp1, tmp2, half_box, box)
- *                 # Rings too far apart
+ *                     val = coords[a_idx, i, f] - coords[d_idx, i, f]             # <<<<<<<<<<<<<<
+ *                     # Wrap the distance vector into the periodic box
+ *                     if abs(val) > half_box[i] and box[i, f] != 0:
  */
-          __pyx_t_12 = __pyx_v_r2_start_idx;
-          __pyx_t_22 = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_12 * __pyx_v_rings_atoms.strides[0]) )));
-          __pyx_t_13 = __pyx_v_i;
+          __pyx_t_20 = __pyx_v_a_idx;
+          __pyx_t_12 = __pyx_v_i;
           __pyx_t_11 = __pyx_v_f;
-          __pyx_t_23 = __pyx_v_i;
-          *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_tmp2.data + __pyx_t_23 * __pyx_v_tmp2.strides[0]) )) = (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_22 * __pyx_v_coords.strides[0]) ) + __pyx_t_13 * __pyx_v_coords.strides[1]) ) + __pyx_t_11 * __pyx_v_coords.strides[2]) )));
-        }
+          __pyx_t_23 = __pyx_v_d_idx;
+          __pyx_t_13 = __pyx_v_i;
+          __pyx_t_24 = __pyx_v_f;
+          __pyx_v_val = ((*__Pyx_BufPtrStrided3d(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *, __pyx_pybuffernd_coords.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_coords.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_coords.diminfo[1].strides, __pyx_t_11, __pyx_pybuffernd_coords.diminfo[2].strides)) - (*__Pyx_BufPtrStrided3d(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *, __pyx_pybuffernd_coords.rcbuffer->pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_coords.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_coords.diminfo[1].strides, __pyx_t_24, __pyx_pybuffernd_coords.diminfo[2].strides)));
 
-        /* "moleculekit/interactions/pipi/pipi.pyx":138
- *                     tmp1[i] = coords[rings_atoms[r1_start_idx], i, f]
- *                     tmp2[i] = coords[rings_atoms[r2_start_idx], i, f]
- *                 dist2 = _wrapped_dist(f, tmp1, tmp2, half_box, box)             # <<<<<<<<<<<<<<
- *                 # Rings too far apart
- *                 if dist2 > 225: # If two randomly picked atoms are more than 15A apart early-quit
- */
-        __pyx_t_24 = __pyx_f_11moleculekit_12interactions_4pipi__wrapped_dist(__pyx_v_f, __pyx_v_tmp1, __pyx_v_tmp2, __pyx_v_half_box, __pyx_v_box); if (unlikely(__pyx_t_24 == ((float)-1) && PyErr_Occurred())) __PYX_ERR(0, 138, __pyx_L1_error)
-        __pyx_v_dist2 = __pyx_t_24;
-
-        /* "moleculekit/interactions/pipi/pipi.pyx":140
- *                 dist2 = _wrapped_dist(f, tmp1, tmp2, half_box, box)
- *                 # Rings too far apart
- *                 if dist2 > 225: # If two randomly picked atoms are more than 15A apart early-quit             # <<<<<<<<<<<<<<
- *                     continue
- * 
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":84
+ *                     val = coords[a_idx, i, f] - coords[d_idx, i, f]
+ *                     # Wrap the distance vector into the periodic box
+ *                     if abs(val) > half_box[i] and box[i, f] != 0:             # <<<<<<<<<<<<<<
+ *                         val = val - box[i, f] * round(val / box[i, f])
+ *                     dist_vec_a[i] = val
+ */
+          __pyx_t_24 = __pyx_v_i;
+          __pyx_t_19 = (fabsf(__pyx_v_val) > (*((__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_half_box.data + __pyx_t_24 * __pyx_v_half_box.strides[0]) ))));
+          if (__pyx_t_19) {
+          } else {
+            __pyx_t_21 = __pyx_t_19;
+            goto __pyx_L25_bool_binop_done;
+          }
+          __pyx_t_24 = __pyx_v_i;
+          __pyx_t_13 = __pyx_v_f;
+          __pyx_t_19 = ((*__Pyx_BufPtrStrided2d(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_box.diminfo[1].strides)) != 0.0);
+          __pyx_t_21 = __pyx_t_19;
+          __pyx_L25_bool_binop_done:;
+          if (__pyx_t_21) {
+
+            /* "moleculekit/interactions/hbonds/hbonds.pyx":85
+ *                     # Wrap the distance vector into the periodic box
+ *                     if abs(val) > half_box[i] and box[i, f] != 0:
+ *                         val = val - box[i, f] * round(val / box[i, f])             # <<<<<<<<<<<<<<
+ *                     dist_vec_a[i] = val
+ *                     dist2_a = dist2_a + (val * val)
+ */
+            __pyx_t_13 = __pyx_v_i;
+            __pyx_t_24 = __pyx_v_f;
+            __pyx_t_11 = __pyx_v_i;
+            __pyx_t_12 = __pyx_v_f;
+            __pyx_v_val = (__pyx_v_val - ((*__Pyx_BufPtrStrided2d(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_24, __pyx_pybuffernd_box.diminfo[1].strides)) * round((__pyx_v_val / (*__Pyx_BufPtrStrided2d(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_box.diminfo[1].strides))))));
+
+            /* "moleculekit/interactions/hbonds/hbonds.pyx":84
+ *                     val = coords[a_idx, i, f] - coords[d_idx, i, f]
+ *                     # Wrap the distance vector into the periodic box
+ *                     if abs(val) > half_box[i] and box[i, f] != 0:             # <<<<<<<<<<<<<<
+ *                         val = val - box[i, f] * round(val / box[i, f])
+ *                     dist_vec_a[i] = val
  */
-        __pyx_t_19 = (__pyx_v_dist2 > 225.0);
-        if (__pyx_t_19) {
+          }
 
-          /* "moleculekit/interactions/pipi/pipi.pyx":141
- *                 # Rings too far apart
- *                 if dist2 > 225: # If two randomly picked atoms are more than 15A apart early-quit
- *                     continue             # <<<<<<<<<<<<<<
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":86
+ *                     if abs(val) > half_box[i] and box[i, f] != 0:
+ *                         val = val - box[i, f] * round(val / box[i, f])
+ *                     dist_vec_a[i] = val             # <<<<<<<<<<<<<<
+ *                     dist2_a = dist2_a + (val * val)
  * 
- *                 # Calculate the ring centroids
  */
-          goto __pyx_L9_continue;
+          __pyx_t_12 = __pyx_v_i;
+          *((__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_dist_vec_a.data + __pyx_t_12 * __pyx_v_dist_vec_a.strides[0]) )) = __pyx_v_val;
 
-          /* "moleculekit/interactions/pipi/pipi.pyx":140
- *                 dist2 = _wrapped_dist(f, tmp1, tmp2, half_box, box)
- *                 # Rings too far apart
- *                 if dist2 > 225: # If two randomly picked atoms are more than 15A apart early-quit             # <<<<<<<<<<<<<<
- *                     continue
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":87
+ *                         val = val - box[i, f] * round(val / box[i, f])
+ *                     dist_vec_a[i] = val
+ *                     dist2_a = dist2_a + (val * val)             # <<<<<<<<<<<<<<
  * 
+ *                 # Donor hydrogen too far from acceptor
  */
+          __pyx_v_dist2_a = (__pyx_v_dist2_a + (__pyx_v_val * __pyx_v_val));
         }
 
-        /* "moleculekit/interactions/pipi/pipi.pyx":144
+        /* "moleculekit/interactions/hbonds/hbonds.pyx":90
  * 
- *                 # Calculate the ring centroids
- *                 _calculate_ring_mean(f, r1_start_idx, r1_end_idx, rings_atoms, coords, ring1_mean)             # <<<<<<<<<<<<<<
- *                 _calculate_ring_mean(f, r2_start_idx, r2_end_idx, rings_atoms, coords, ring2_mean)
+ *                 # Donor hydrogen too far from acceptor
+ *                 if dist2_a > dist_threshold:             # <<<<<<<<<<<<<<
+ *                     continue
  * 
  */
-        __pyx_f_11moleculekit_12interactions_4pipi__calculate_ring_mean(__pyx_v_f, __pyx_v_r1_start_idx, __pyx_v_r1_end_idx, __pyx_v_rings_atoms, __pyx_v_coords, __pyx_v_ring1_mean); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 144, __pyx_L1_error)
+        __pyx_t_21 = (__pyx_v_dist2_a > __pyx_v_dist_threshold);
+        if (__pyx_t_21) {
 
-        /* "moleculekit/interactions/pipi/pipi.pyx":145
- *                 # Calculate the ring centroids
- *                 _calculate_ring_mean(f, r1_start_idx, r1_end_idx, rings_atoms, coords, ring1_mean)
- *                 _calculate_ring_mean(f, r2_start_idx, r2_end_idx, rings_atoms, coords, ring2_mean)             # <<<<<<<<<<<<<<
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":91
+ *                 # Donor hydrogen too far from acceptor
+ *                 if dist2_a > dist_threshold:
+ *                     continue             # <<<<<<<<<<<<<<
  * 
- *                 # Calculate the wrapped distance between the ring centroids
+ *                 # If we ignore the hydrogens skip the angle part. We have found a match already
  */
-        __pyx_f_11moleculekit_12interactions_4pipi__calculate_ring_mean(__pyx_v_f, __pyx_v_r2_start_idx, __pyx_v_r2_end_idx, __pyx_v_rings_atoms, __pyx_v_coords, __pyx_v_ring2_mean); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 145, __pyx_L1_error)
+          goto __pyx_L9_continue;
 
-        /* "moleculekit/interactions/pipi/pipi.pyx":148
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":90
  * 
- *                 # Calculate the wrapped distance between the ring centroids
- *                 dist2 = _wrapped_dist(f, ring1_mean, ring2_mean, half_box, box)             # <<<<<<<<<<<<<<
+ *                 # Donor hydrogen too far from acceptor
+ *                 if dist2_a > dist_threshold:             # <<<<<<<<<<<<<<
+ *                     continue
  * 
- *                 # Ring centroids too far apart
  */
-        __pyx_t_24 = __pyx_f_11moleculekit_12interactions_4pipi__wrapped_dist(__pyx_v_f, __pyx_v_ring1_mean, __pyx_v_ring2_mean, __pyx_v_half_box, __pyx_v_box); if (unlikely(__pyx_t_24 == ((float)-1) && PyErr_Occurred())) __PYX_ERR(0, 148, __pyx_L1_error)
-        __pyx_v_dist2 = __pyx_t_24;
+        }
 
-        /* "moleculekit/interactions/pipi/pipi.pyx":151
+        /* "moleculekit/interactions/hbonds/hbonds.pyx":94
  * 
- *                 # Ring centroids too far apart
- *                 if dist2 > dist_threshold2:             # <<<<<<<<<<<<<<
- *                     # print(r1, r2, sqrt(dist2))
+ *                 # If we ignore the hydrogens skip the angle part. We have found a match already
+ *                 if ignore_hs:             # <<<<<<<<<<<<<<
+ *                     results[f].push_back(d_idx_d)
+ *                     results[f].push_back(-1)  # No hydrogen to add here
+ */
+        __pyx_t_21 = (__pyx_v_ignore_hs != 0);
+        if (__pyx_t_21) {
+
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":95
+ *                 # If we ignore the hydrogens skip the angle part. We have found a match already
+ *                 if ignore_hs:
+ *                     results[f].push_back(d_idx_d)             # <<<<<<<<<<<<<<
+ *                     results[f].push_back(-1)  # No hydrogen to add here
+ *                     results[f].push_back(a_idx)
+ */
+          try {
+            (__pyx_v_results[__pyx_v_f]).push_back(__pyx_v_d_idx_d);
+          } catch(...) {
+            __Pyx_CppExn2PyErr();
+            __PYX_ERR(0, 95, __pyx_L1_error)
+          }
+
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":96
+ *                 if ignore_hs:
+ *                     results[f].push_back(d_idx_d)
+ *                     results[f].push_back(-1)  # No hydrogen to add here             # <<<<<<<<<<<<<<
+ *                     results[f].push_back(a_idx)
  *                     continue
  */
-        __pyx_t_19 = (__pyx_v_dist2 > __pyx_v_dist_threshold2);
-        if (__pyx_t_19) {
+          try {
+            (__pyx_v_results[__pyx_v_f]).push_back(-1);
+          } catch(...) {
+            __Pyx_CppExn2PyErr();
+            __PYX_ERR(0, 96, __pyx_L1_error)
+          }
 
-          /* "moleculekit/interactions/pipi/pipi.pyx":153
- *                 if dist2 > dist_threshold2:
- *                     # print(r1, r2, sqrt(dist2))
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":97
+ *                     results[f].push_back(d_idx_d)
+ *                     results[f].push_back(-1)  # No hydrogen to add here
+ *                     results[f].push_back(a_idx)             # <<<<<<<<<<<<<<
+ *                     continue
+ * 
+ */
+          try {
+            (__pyx_v_results[__pyx_v_f]).push_back(__pyx_v_a_idx);
+          } catch(...) {
+            __Pyx_CppExn2PyErr();
+            __PYX_ERR(0, 97, __pyx_L1_error)
+          }
+
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":98
+ *                     results[f].push_back(-1)  # No hydrogen to add here
+ *                     results[f].push_back(a_idx)
  *                     continue             # <<<<<<<<<<<<<<
  * 
- *                 # Calculate the plane normals
+ *                 # Calculate donor heavy to donor hydrogen vector for the angle
  */
           goto __pyx_L9_continue;
 
-          /* "moleculekit/interactions/pipi/pipi.pyx":151
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":94
  * 
- *                 # Ring centroids too far apart
- *                 if dist2 > dist_threshold2:             # <<<<<<<<<<<<<<
- *                     # print(r1, r2, sqrt(dist2))
- *                     continue
+ *                 # If we ignore the hydrogens skip the angle part. We have found a match already
+ *                 if ignore_hs:             # <<<<<<<<<<<<<<
+ *                     results[f].push_back(d_idx_d)
+ *                     results[f].push_back(-1)  # No hydrogen to add here
  */
         }
 
-        /* "moleculekit/interactions/pipi/pipi.pyx":156
+        /* "moleculekit/interactions/hbonds/hbonds.pyx":101
  * 
- *                 # Calculate the plane normals
+ *                 # Calculate donor heavy to donor hydrogen vector for the angle
  *                 for i in range(3):             # <<<<<<<<<<<<<<
- *                     tmp1[i] = coords[rings_atoms[r1_start_idx], i, f] - coords[rings_atoms[r1_start_idx+2], i, f]
- *                     tmp2[i] = coords[rings_atoms[r1_start_idx+1], i, f] - coords[rings_atoms[r1_start_idx+2], i, f]
+ *                     val = coords[d_idx_d, i, f] - coords[d_idx_h, i, f]
+ *                     # Wrap the distance vector into the periodic box
  */
-        for (__pyx_t_21 = 0; __pyx_t_21 < 3; __pyx_t_21+=1) {
-          __pyx_v_i = __pyx_t_21;
+        for (__pyx_t_22 = 0; __pyx_t_22 < 3; __pyx_t_22+=1) {
+          __pyx_v_i = __pyx_t_22;
 
-          /* "moleculekit/interactions/pipi/pipi.pyx":157
- *                 # Calculate the plane normals
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":102
+ *                 # Calculate donor heavy to donor hydrogen vector for the angle
  *                 for i in range(3):
- *                     tmp1[i] = coords[rings_atoms[r1_start_idx], i, f] - coords[rings_atoms[r1_start_idx+2], i, f]             # <<<<<<<<<<<<<<
- *                     tmp2[i] = coords[rings_atoms[r1_start_idx+1], i, f] - coords[rings_atoms[r1_start_idx+2], i, f]
- *                 _cross_product(tmp1, tmp2, ring1_normal)
+ *                     val = coords[d_idx_d, i, f] - coords[d_idx_h, i, f]             # <<<<<<<<<<<<<<
+ *                     # Wrap the distance vector into the periodic box
+ *                     if abs(val) > half_box[i] and box[i, f] != 0:
  */
-          __pyx_t_12 = __pyx_v_r1_start_idx;
-          __pyx_t_22 = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_12 * __pyx_v_rings_atoms.strides[0]) )));
-          __pyx_t_11 = __pyx_v_i;
+          __pyx_t_23 = __pyx_v_d_idx_d;
+          __pyx_t_12 = __pyx_v_i;
+          __pyx_t_11 = __pyx_v_f;
+          __pyx_t_20 = __pyx_v_d_idx_h;
+          __pyx_t_24 = __pyx_v_i;
           __pyx_t_13 = __pyx_v_f;
-          __pyx_t_23 = (__pyx_v_r1_start_idx + 2);
-          __pyx_t_25 = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_23 * __pyx_v_rings_atoms.strides[0]) )));
-          __pyx_t_26 = __pyx_v_i;
-          __pyx_t_27 = __pyx_v_f;
-          __pyx_t_28 = __pyx_v_i;
-          *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_tmp1.data + __pyx_t_28 * __pyx_v_tmp1.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_22 * __pyx_v_coords.strides[0]) ) + __pyx_t_11 * __pyx_v_coords.strides[1]) ) + __pyx_t_13 * __pyx_v_coords.strides[2]) ))) - (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_25 * __pyx_v_coords.strides[0]) ) + __pyx_t_26 * __pyx_v_coords.strides[1]) ) + __pyx_t_27 * __pyx_v_coords.strides[2]) ))));
+          __pyx_v_val = ((*__Pyx_BufPtrStrided3d(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *, __pyx_pybuffernd_coords.rcbuffer->pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_coords.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_coords.diminfo[1].strides, __pyx_t_11, __pyx_pybuffernd_coords.diminfo[2].strides)) - (*__Pyx_BufPtrStrided3d(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *, __pyx_pybuffernd_coords.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_coords.diminfo[0].strides, __pyx_t_24, __pyx_pybuffernd_coords.diminfo[1].strides, __pyx_t_13, __pyx_pybuffernd_coords.diminfo[2].strides)));
 
-          /* "moleculekit/interactions/pipi/pipi.pyx":158
- *                 for i in range(3):
- *                     tmp1[i] = coords[rings_atoms[r1_start_idx], i, f] - coords[rings_atoms[r1_start_idx+2], i, f]
- *                     tmp2[i] = coords[rings_atoms[r1_start_idx+1], i, f] - coords[rings_atoms[r1_start_idx+2], i, f]             # <<<<<<<<<<<<<<
- *                 _cross_product(tmp1, tmp2, ring1_normal)
- *                 for i in range(3):
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":104
+ *                     val = coords[d_idx_d, i, f] - coords[d_idx_h, i, f]
+ *                     # Wrap the distance vector into the periodic box
+ *                     if abs(val) > half_box[i] and box[i, f] != 0:             # <<<<<<<<<<<<<<
+ *                         val = val - box[i, f] * round(val / box[i, f])
+ *                     dist_vec_b[i] = val
  */
-          __pyx_t_23 = (__pyx_v_r1_start_idx + 1);
-          __pyx_t_25 = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_23 * __pyx_v_rings_atoms.strides[0]) )));
-          __pyx_t_27 = __pyx_v_i;
-          __pyx_t_26 = __pyx_v_f;
-          __pyx_t_12 = (__pyx_v_r1_start_idx + 2);
-          __pyx_t_22 = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_12 * __pyx_v_rings_atoms.strides[0]) )));
           __pyx_t_13 = __pyx_v_i;
-          __pyx_t_11 = __pyx_v_f;
-          __pyx_t_28 = __pyx_v_i;
-          *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_tmp2.data + __pyx_t_28 * __pyx_v_tmp2.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_25 * __pyx_v_coords.strides[0]) ) + __pyx_t_27 * __pyx_v_coords.strides[1]) ) + __pyx_t_26 * __pyx_v_coords.strides[2]) ))) - (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_22 * __pyx_v_coords.strides[0]) ) + __pyx_t_13 * __pyx_v_coords.strides[1]) ) + __pyx_t_11 * __pyx_v_coords.strides[2]) ))));
-        }
-
-        /* "moleculekit/interactions/pipi/pipi.pyx":159
- *                     tmp1[i] = coords[rings_atoms[r1_start_idx], i, f] - coords[rings_atoms[r1_start_idx+2], i, f]
- *                     tmp2[i] = coords[rings_atoms[r1_start_idx+1], i, f] - coords[rings_atoms[r1_start_idx+2], i, f]
- *                 _cross_product(tmp1, tmp2, ring1_normal)             # <<<<<<<<<<<<<<
- *                 for i in range(3):
- *                     tmp1[i] = coords[rings_atoms[r2_start_idx], i, f] - coords[rings_atoms[r2_start_idx+2], i, f]
+          __pyx_t_19 = (fabsf(__pyx_v_val) > (*((__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_half_box.data + __pyx_t_13 * __pyx_v_half_box.strides[0]) ))));
+          if (__pyx_t_19) {
+          } else {
+            __pyx_t_21 = __pyx_t_19;
+            goto __pyx_L32_bool_binop_done;
+          }
+          __pyx_t_13 = __pyx_v_i;
+          __pyx_t_24 = __pyx_v_f;
+          __pyx_t_19 = ((*__Pyx_BufPtrStrided2d(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_24, __pyx_pybuffernd_box.diminfo[1].strides)) != 0.0);
+          __pyx_t_21 = __pyx_t_19;
+          __pyx_L32_bool_binop_done:;
+          if (__pyx_t_21) {
+
+            /* "moleculekit/interactions/hbonds/hbonds.pyx":105
+ *                     # Wrap the distance vector into the periodic box
+ *                     if abs(val) > half_box[i] and box[i, f] != 0:
+ *                         val = val - box[i, f] * round(val / box[i, f])             # <<<<<<<<<<<<<<
+ *                     dist_vec_b[i] = val
+ *                     dist2_b = dist2_b + (val * val)
+ */
+            __pyx_t_24 = __pyx_v_i;
+            __pyx_t_13 = __pyx_v_f;
+            __pyx_t_11 = __pyx_v_i;
+            __pyx_t_12 = __pyx_v_f;
+            __pyx_v_val = (__pyx_v_val - ((*__Pyx_BufPtrStrided2d(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_box.diminfo[1].strides)) * round((__pyx_v_val / (*__Pyx_BufPtrStrided2d(__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_box.diminfo[1].strides))))));
+
+            /* "moleculekit/interactions/hbonds/hbonds.pyx":104
+ *                     val = coords[d_idx_d, i, f] - coords[d_idx_h, i, f]
+ *                     # Wrap the distance vector into the periodic box
+ *                     if abs(val) > half_box[i] and box[i, f] != 0:             # <<<<<<<<<<<<<<
+ *                         val = val - box[i, f] * round(val / box[i, f])
+ *                     dist_vec_b[i] = val
  */
-        __pyx_f_11moleculekit_12interactions_4pipi__cross_product(__pyx_v_tmp1, __pyx_v_tmp2, __pyx_v_ring1_normal); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 159, __pyx_L1_error)
+          }
 
-        /* "moleculekit/interactions/pipi/pipi.pyx":160
- *                     tmp2[i] = coords[rings_atoms[r1_start_idx+1], i, f] - coords[rings_atoms[r1_start_idx+2], i, f]
- *                 _cross_product(tmp1, tmp2, ring1_normal)
- *                 for i in range(3):             # <<<<<<<<<<<<<<
- *                     tmp1[i] = coords[rings_atoms[r2_start_idx], i, f] - coords[rings_atoms[r2_start_idx+2], i, f]
- *                     tmp2[i] = coords[rings_atoms[r2_start_idx+1], i, f] - coords[rings_atoms[r2_start_idx+2], i, f]
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":106
+ *                     if abs(val) > half_box[i] and box[i, f] != 0:
+ *                         val = val - box[i, f] * round(val / box[i, f])
+ *                     dist_vec_b[i] = val             # <<<<<<<<<<<<<<
+ *                     dist2_b = dist2_b + (val * val)
+ * 
  */
-        for (__pyx_t_21 = 0; __pyx_t_21 < 3; __pyx_t_21+=1) {
-          __pyx_v_i = __pyx_t_21;
+          __pyx_t_12 = __pyx_v_i;
+          *((__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_dist_vec_b.data + __pyx_t_12 * __pyx_v_dist_vec_b.strides[0]) )) = __pyx_v_val;
 
-          /* "moleculekit/interactions/pipi/pipi.pyx":161
- *                 _cross_product(tmp1, tmp2, ring1_normal)
- *                 for i in range(3):
- *                     tmp1[i] = coords[rings_atoms[r2_start_idx], i, f] - coords[rings_atoms[r2_start_idx+2], i, f]             # <<<<<<<<<<<<<<
- *                     tmp2[i] = coords[rings_atoms[r2_start_idx+1], i, f] - coords[rings_atoms[r2_start_idx+2], i, f]
- *                 _cross_product(tmp1, tmp2, ring2_normal)
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":107
+ *                         val = val - box[i, f] * round(val / box[i, f])
+ *                     dist_vec_b[i] = val
+ *                     dist2_b = dist2_b + (val * val)             # <<<<<<<<<<<<<<
+ * 
+ *                 # Overlapping atoms? Weird case but best exit
  */
-          __pyx_t_12 = __pyx_v_r2_start_idx;
-          __pyx_t_22 = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_12 * __pyx_v_rings_atoms.strides[0]) )));
-          __pyx_t_11 = __pyx_v_i;
-          __pyx_t_13 = __pyx_v_f;
-          __pyx_t_23 = (__pyx_v_r2_start_idx + 2);
-          __pyx_t_25 = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_23 * __pyx_v_rings_atoms.strides[0]) )));
-          __pyx_t_26 = __pyx_v_i;
-          __pyx_t_27 = __pyx_v_f;
-          __pyx_t_28 = __pyx_v_i;
-          *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_tmp1.data + __pyx_t_28 * __pyx_v_tmp1.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_22 * __pyx_v_coords.strides[0]) ) + __pyx_t_11 * __pyx_v_coords.strides[1]) ) + __pyx_t_13 * __pyx_v_coords.strides[2]) ))) - (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_25 * __pyx_v_coords.strides[0]) ) + __pyx_t_26 * __pyx_v_coords.strides[1]) ) + __pyx_t_27 * __pyx_v_coords.strides[2]) ))));
+          __pyx_v_dist2_b = (__pyx_v_dist2_b + (__pyx_v_val * __pyx_v_val));
+        }
 
-          /* "moleculekit/interactions/pipi/pipi.pyx":162
- *                 for i in range(3):
- *                     tmp1[i] = coords[rings_atoms[r2_start_idx], i, f] - coords[rings_atoms[r2_start_idx+2], i, f]
- *                     tmp2[i] = coords[rings_atoms[r2_start_idx+1], i, f] - coords[rings_atoms[r2_start_idx+2], i, f]             # <<<<<<<<<<<<<<
- *                 _cross_product(tmp1, tmp2, ring2_normal)
+        /* "moleculekit/interactions/hbonds/hbonds.pyx":110
+ * 
+ *                 # Overlapping atoms? Weird case but best exit
+ *                 if dist2_a == 0 or dist2_b == 0:             # <<<<<<<<<<<<<<
+ *                     continue
  * 
  */
-          __pyx_t_23 = (__pyx_v_r2_start_idx + 1);
-          __pyx_t_25 = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_23 * __pyx_v_rings_atoms.strides[0]) )));
-          __pyx_t_27 = __pyx_v_i;
-          __pyx_t_26 = __pyx_v_f;
-          __pyx_t_12 = (__pyx_v_r2_start_idx + 2);
-          __pyx_t_22 = (*((__pyx_t_11moleculekit_12interactions_4pipi_UINT32_t *) ( /* dim=0 */ (__pyx_v_rings_atoms.data + __pyx_t_12 * __pyx_v_rings_atoms.strides[0]) )));
-          __pyx_t_13 = __pyx_v_i;
-          __pyx_t_11 = __pyx_v_f;
-          __pyx_t_28 = __pyx_v_i;
-          *((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_tmp2.data + __pyx_t_28 * __pyx_v_tmp2.strides[0]) )) = ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_25 * __pyx_v_coords.strides[0]) ) + __pyx_t_27 * __pyx_v_coords.strides[1]) ) + __pyx_t_26 * __pyx_v_coords.strides[2]) ))) - (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_22 * __pyx_v_coords.strides[0]) ) + __pyx_t_13 * __pyx_v_coords.strides[1]) ) + __pyx_t_11 * __pyx_v_coords.strides[2]) ))));
+        __pyx_t_19 = (__pyx_v_dist2_a == 0.0);
+        if (!__pyx_t_19) {
+        } else {
+          __pyx_t_21 = __pyx_t_19;
+          goto __pyx_L35_bool_binop_done;
         }
-
-        /* "moleculekit/interactions/pipi/pipi.pyx":163
- *                     tmp1[i] = coords[rings_atoms[r2_start_idx], i, f] - coords[rings_atoms[r2_start_idx+2], i, f]
- *                     tmp2[i] = coords[rings_atoms[r2_start_idx+1], i, f] - coords[rings_atoms[r2_start_idx+2], i, f]
- *                 _cross_product(tmp1, tmp2, ring2_normal)             # <<<<<<<<<<<<<<
+        __pyx_t_19 = (__pyx_v_dist2_b == 0.0);
+        __pyx_t_21 = __pyx_t_19;
+        __pyx_L35_bool_binop_done:;
+        if (__pyx_t_21) {
+
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":111
+ *                 # Overlapping atoms? Weird case but best exit
+ *                 if dist2_a == 0 or dist2_b == 0:
+ *                     continue             # <<<<<<<<<<<<<<
  * 
- *                 # Calculate angle between normals
+ *                 # Calculate the angle
  */
-        __pyx_f_11moleculekit_12interactions_4pipi__cross_product(__pyx_v_tmp1, __pyx_v_tmp2, __pyx_v_ring2_normal); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 163, __pyx_L1_error)
+          goto __pyx_L9_continue;
 
-        /* "moleculekit/interactions/pipi/pipi.pyx":166
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":110
  * 
- *                 # Calculate angle between normals
- *                 dot_prod = 0             # <<<<<<<<<<<<<<
+ *                 # Overlapping atoms? Weird case but best exit
+ *                 if dist2_a == 0 or dist2_b == 0:             # <<<<<<<<<<<<<<
+ *                     continue
+ * 
+ */
+        }
+
+        /* "moleculekit/interactions/hbonds/hbonds.pyx":115
+ *                 # Calculate the angle
+ *                 # Calculate vector dot product
+ *                 dotprod = 0             # <<<<<<<<<<<<<<
  *                 for i in range(3):
- *                     dot_prod = dot_prod + ring1_normal[i] * ring2_normal[i]
+ *                     dotprod = dotprod + dist_vec_a[i] * dist_vec_b[i]
  */
-        __pyx_v_dot_prod = 0.0;
+        __pyx_v_dotprod = 0.0;
 
-        /* "moleculekit/interactions/pipi/pipi.pyx":167
- *                 # Calculate angle between normals
- *                 dot_prod = 0
+        /* "moleculekit/interactions/hbonds/hbonds.pyx":116
+ *                 # Calculate vector dot product
+ *                 dotprod = 0
  *                 for i in range(3):             # <<<<<<<<<<<<<<
- *                     dot_prod = dot_prod + ring1_normal[i] * ring2_normal[i]
- *                 angle = acos(dot_prod) * 57.29578  # Convert radians to degrees
+ *                     dotprod = dotprod + dist_vec_a[i] * dist_vec_b[i]
+ * 
  */
-        for (__pyx_t_21 = 0; __pyx_t_21 < 3; __pyx_t_21+=1) {
-          __pyx_v_i = __pyx_t_21;
+        for (__pyx_t_22 = 0; __pyx_t_22 < 3; __pyx_t_22+=1) {
+          __pyx_v_i = __pyx_t_22;
 
-          /* "moleculekit/interactions/pipi/pipi.pyx":168
- *                 dot_prod = 0
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":117
+ *                 dotprod = 0
  *                 for i in range(3):
- *                     dot_prod = dot_prod + ring1_normal[i] * ring2_normal[i]             # <<<<<<<<<<<<<<
- *                 angle = acos(dot_prod) * 57.29578  # Convert radians to degrees
- *                 if angle > 90:  # minimal angle to line. necessary as perpendicular can point either way
+ *                     dotprod = dotprod + dist_vec_a[i] * dist_vec_b[i]             # <<<<<<<<<<<<<<
+ * 
+ *                 angle = dotprod / (sqrt(dist2_a) * sqrt(dist2_b))
  */
           __pyx_t_12 = __pyx_v_i;
           __pyx_t_11 = __pyx_v_i;
-          __pyx_v_dot_prod = (__pyx_v_dot_prod + ((*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring1_normal.data + __pyx_t_12 * __pyx_v_ring1_normal.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_ring2_normal.data + __pyx_t_11 * __pyx_v_ring2_normal.strides[0]) )))));
+          __pyx_v_dotprod = (__pyx_v_dotprod + ((*((__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_dist_vec_a.data + __pyx_t_12 * __pyx_v_dist_vec_a.strides[0]) ))) * (*((__pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_dist_vec_b.data + __pyx_t_11 * __pyx_v_dist_vec_b.strides[0]) )))));
         }
 
-        /* "moleculekit/interactions/pipi/pipi.pyx":169
- *                 for i in range(3):
- *                     dot_prod = dot_prod + ring1_normal[i] * ring2_normal[i]
- *                 angle = acos(dot_prod) * 57.29578  # Convert radians to degrees             # <<<<<<<<<<<<<<
- *                 if angle > 90:  # minimal angle to line. necessary as perpendicular can point either way
- *                     angle = 180-angle
+        /* "moleculekit/interactions/hbonds/hbonds.pyx":119
+ *                     dotprod = dotprod + dist_vec_a[i] * dist_vec_b[i]
+ * 
+ *                 angle = dotprod / (sqrt(dist2_a) * sqrt(dist2_b))             # <<<<<<<<<<<<<<
+ *                 # Prevent numerical issues with acos
+ *                 if angle > 1:
  */
-        __pyx_v_angle = (acos(__pyx_v_dot_prod) * 57.29578);
+        __pyx_v_angle = (((double)__pyx_v_dotprod) / (sqrt(__pyx_v_dist2_a) * sqrt(__pyx_v_dist2_b)));
 
-        /* "moleculekit/interactions/pipi/pipi.pyx":170
- *                     dot_prod = dot_prod + ring1_normal[i] * ring2_normal[i]
- *                 angle = acos(dot_prod) * 57.29578  # Convert radians to degrees
- *                 if angle > 90:  # minimal angle to line. necessary as perpendicular can point either way             # <<<<<<<<<<<<<<
- *                     angle = 180-angle
- * 
+        /* "moleculekit/interactions/hbonds/hbonds.pyx":121
+ *                 angle = dotprod / (sqrt(dist2_a) * sqrt(dist2_b))
+ *                 # Prevent numerical issues with acos
+ *                 if angle > 1:             # <<<<<<<<<<<<<<
+ *                     angle = 1
+ *                 if angle < -1:
  */
-        __pyx_t_19 = (__pyx_v_angle > 90.0);
-        if (__pyx_t_19) {
+        __pyx_t_21 = (__pyx_v_angle > 1.0);
+        if (__pyx_t_21) {
 
-          /* "moleculekit/interactions/pipi/pipi.pyx":171
- *                 angle = acos(dot_prod) * 57.29578  # Convert radians to degrees
- *                 if angle > 90:  # minimal angle to line. necessary as perpendicular can point either way
- *                     angle = 180-angle             # <<<<<<<<<<<<<<
- * 
- *                 # If dist < 4.4 and angle <= 30 deg
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":122
+ *                 # Prevent numerical issues with acos
+ *                 if angle > 1:
+ *                     angle = 1             # <<<<<<<<<<<<<<
+ *                 if angle < -1:
+ *                     angle = -1
  */
-          __pyx_v_angle = (180.0 - __pyx_v_angle);
+          __pyx_v_angle = 1.0;
 
-          /* "moleculekit/interactions/pipi/pipi.pyx":170
- *                     dot_prod = dot_prod + ring1_normal[i] * ring2_normal[i]
- *                 angle = acos(dot_prod) * 57.29578  # Convert radians to degrees
- *                 if angle > 90:  # minimal angle to line. necessary as perpendicular can point either way             # <<<<<<<<<<<<<<
- *                     angle = 180-angle
- * 
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":121
+ *                 angle = dotprod / (sqrt(dist2_a) * sqrt(dist2_b))
+ *                 # Prevent numerical issues with acos
+ *                 if angle > 1:             # <<<<<<<<<<<<<<
+ *                     angle = 1
+ *                 if angle < -1:
  */
         }
 
-        /* "moleculekit/interactions/pipi/pipi.pyx":176
- *                 # If dist < 5.5 and angle in range [60, 120]
- *                 # print(r1, r2, sqrt(dist2), angle)
- *                 if ((dist2 < dist_threshold1 and angle <= angle_threshold1_max) or             # <<<<<<<<<<<<<<
- *                     (dist2 < dist_threshold2 and angle >= angle_threshold2_min)):
- *                     results[f].push_back(r1)
+        /* "moleculekit/interactions/hbonds/hbonds.pyx":123
+ *                 if angle > 1:
+ *                     angle = 1
+ *                 if angle < -1:             # <<<<<<<<<<<<<<
+ *                     angle = -1
+ *                 angle = acos(angle)
  */
-        __pyx_t_20 = (__pyx_v_dist2 < __pyx_v_dist_threshold1);
-        if (!__pyx_t_20) {
-          goto __pyx_L27_next_or;
-        } else {
-        }
-        __pyx_t_20 = (__pyx_v_angle <= __pyx_v_angle_threshold1_max);
-        if (!__pyx_t_20) {
-        } else {
-          __pyx_t_19 = __pyx_t_20;
-          goto __pyx_L26_bool_binop_done;
-        }
-        __pyx_L27_next_or:;
+        __pyx_t_21 = (__pyx_v_angle < -1.0);
+        if (__pyx_t_21) {
 
-        /* "moleculekit/interactions/pipi/pipi.pyx":177
- *                 # print(r1, r2, sqrt(dist2), angle)
- *                 if ((dist2 < dist_threshold1 and angle <= angle_threshold1_max) or
- *                     (dist2 < dist_threshold2 and angle >= angle_threshold2_min)):             # <<<<<<<<<<<<<<
- *                     results[f].push_back(r1)
- *                     results[f].push_back(r2)
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":124
+ *                     angle = 1
+ *                 if angle < -1:
+ *                     angle = -1             # <<<<<<<<<<<<<<
+ *                 angle = acos(angle)
+ * 
+ */
+          __pyx_v_angle = -1.0;
+
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":123
+ *                 if angle > 1:
+ *                     angle = 1
+ *                 if angle < -1:             # <<<<<<<<<<<<<<
+ *                     angle = -1
+ *                 angle = acos(angle)
  */
-        __pyx_t_20 = (__pyx_v_dist2 < __pyx_v_dist_threshold2);
-        if (__pyx_t_20) {
-        } else {
-          __pyx_t_19 = __pyx_t_20;
-          goto __pyx_L26_bool_binop_done;
         }
-        __pyx_t_20 = (__pyx_v_angle >= __pyx_v_angle_threshold2_min);
-        __pyx_t_19 = __pyx_t_20;
-        __pyx_L26_bool_binop_done:;
-
-        /* "moleculekit/interactions/pipi/pipi.pyx":176
- *                 # If dist < 5.5 and angle in range [60, 120]
- *                 # print(r1, r2, sqrt(dist2), angle)
- *                 if ((dist2 < dist_threshold1 and angle <= angle_threshold1_max) or             # <<<<<<<<<<<<<<
- *                     (dist2 < dist_threshold2 and angle >= angle_threshold2_min)):
- *                     results[f].push_back(r1)
+
+        /* "moleculekit/interactions/hbonds/hbonds.pyx":125
+ *                 if angle < -1:
+ *                     angle = -1
+ *                 angle = acos(angle)             # <<<<<<<<<<<<<<
+ * 
+ *                 if angle > angle_threshold:
  */
-        if (__pyx_t_19) {
+        __pyx_v_angle = acos(__pyx_v_angle);
 
-          /* "moleculekit/interactions/pipi/pipi.pyx":178
- *                 if ((dist2 < dist_threshold1 and angle <= angle_threshold1_max) or
- *                     (dist2 < dist_threshold2 and angle >= angle_threshold2_min)):
- *                     results[f].push_back(r1)             # <<<<<<<<<<<<<<
- *                     results[f].push_back(r2)
- *                     distangles[f].push_back(sqrt(dist2))
+        /* "moleculekit/interactions/hbonds/hbonds.pyx":127
+ *                 angle = acos(angle)
+ * 
+ *                 if angle > angle_threshold:             # <<<<<<<<<<<<<<
+ *                     results[f].push_back(d_idx_d)
+ *                     results[f].push_back(d_idx_h)
  */
-          try {
-            (__pyx_v_results[__pyx_v_f]).push_back(__pyx_v_r1);
-          } catch(...) {
-            __Pyx_CppExn2PyErr();
-            __PYX_ERR(0, 178, __pyx_L1_error)
-          }
+        __pyx_t_21 = (__pyx_v_angle > __pyx_v_angle_threshold);
+        if (__pyx_t_21) {
 
-          /* "moleculekit/interactions/pipi/pipi.pyx":179
- *                     (dist2 < dist_threshold2 and angle >= angle_threshold2_min)):
- *                     results[f].push_back(r1)
- *                     results[f].push_back(r2)             # <<<<<<<<<<<<<<
- *                     distangles[f].push_back(sqrt(dist2))
- *                     distangles[f].push_back(angle)
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":128
+ * 
+ *                 if angle > angle_threshold:
+ *                     results[f].push_back(d_idx_d)             # <<<<<<<<<<<<<<
+ *                     results[f].push_back(d_idx_h)
+ *                     results[f].push_back(a_idx)
  */
           try {
-            (__pyx_v_results[__pyx_v_f]).push_back(__pyx_v_r2);
+            (__pyx_v_results[__pyx_v_f]).push_back(__pyx_v_d_idx_d);
           } catch(...) {
             __Pyx_CppExn2PyErr();
-            __PYX_ERR(0, 179, __pyx_L1_error)
+            __PYX_ERR(0, 128, __pyx_L1_error)
           }
 
-          /* "moleculekit/interactions/pipi/pipi.pyx":180
- *                     results[f].push_back(r1)
- *                     results[f].push_back(r2)
- *                     distangles[f].push_back(sqrt(dist2))             # <<<<<<<<<<<<<<
- *                     distangles[f].push_back(angle)
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":129
+ *                 if angle > angle_threshold:
+ *                     results[f].push_back(d_idx_d)
+ *                     results[f].push_back(d_idx_h)             # <<<<<<<<<<<<<<
+ *                     results[f].push_back(a_idx)
  * 
  */
           try {
-            (__pyx_v_distangles[__pyx_v_f]).push_back(sqrt(__pyx_v_dist2));
+            (__pyx_v_results[__pyx_v_f]).push_back(__pyx_v_d_idx_h);
           } catch(...) {
             __Pyx_CppExn2PyErr();
-            __PYX_ERR(0, 180, __pyx_L1_error)
+            __PYX_ERR(0, 129, __pyx_L1_error)
           }
 
-          /* "moleculekit/interactions/pipi/pipi.pyx":181
- *                     results[f].push_back(r2)
- *                     distangles[f].push_back(sqrt(dist2))
- *                     distangles[f].push_back(angle)             # <<<<<<<<<<<<<<
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":130
+ *                     results[f].push_back(d_idx_d)
+ *                     results[f].push_back(d_idx_h)
+ *                     results[f].push_back(a_idx)             # <<<<<<<<<<<<<<
  * 
- *     return results, distangles
+ *     return results
  */
           try {
-            (__pyx_v_distangles[__pyx_v_f]).push_back(__pyx_v_angle);
+            (__pyx_v_results[__pyx_v_f]).push_back(__pyx_v_a_idx);
           } catch(...) {
             __Pyx_CppExn2PyErr();
-            __PYX_ERR(0, 181, __pyx_L1_error)
+            __PYX_ERR(0, 130, __pyx_L1_error)
           }
 
-          /* "moleculekit/interactions/pipi/pipi.pyx":176
- *                 # If dist < 5.5 and angle in range [60, 120]
- *                 # print(r1, r2, sqrt(dist2), angle)
- *                 if ((dist2 < dist_threshold1 and angle <= angle_threshold1_max) or             # <<<<<<<<<<<<<<
- *                     (dist2 < dist_threshold2 and angle >= angle_threshold2_min)):
- *                     results[f].push_back(r1)
+          /* "moleculekit/interactions/hbonds/hbonds.pyx":127
+ *                 angle = acos(angle)
+ * 
+ *                 if angle > angle_threshold:             # <<<<<<<<<<<<<<
+ *                     results[f].push_back(d_idx_d)
+ *                     results[f].push_back(d_idx_h)
  */
         }
         __pyx_L9_continue:;
       }
     }
   }
 
-  /* "moleculekit/interactions/pipi/pipi.pyx":183
- *                     distangles[f].push_back(angle)
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":132
+ *                     results[f].push_back(a_idx)
  * 
- *     return results, distangles             # <<<<<<<<<<<<<<
+ *     return results             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = __pyx_convert_vector_to_py_std_3a__3a_vector_3c_int_3e___(__pyx_v_results); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 183, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __pyx_convert_vector_to_py_std_3a__3a_vector_3c_float_3e___(__pyx_v_distangles); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 183, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 183, __pyx_L1_error)
+  __pyx_t_2 = __pyx_convert_vector_to_py_std_3a__3a_vector_3c_int_3e___(__pyx_v_results); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 132, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_3);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3)) __PYX_ERR(0, 183, __pyx_L1_error);
-  __Pyx_GIVEREF(__pyx_t_1);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_1)) __PYX_ERR(0, 183, __pyx_L1_error);
-  __pyx_t_3 = 0;
-  __pyx_t_1 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "moleculekit/interactions/pipi/pipi.pyx":84
- * 
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":23
  * 
+ * import cython
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def calculate(
  */
 
   /* function exit code */
   __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_4, 1);
-  __Pyx_AddTraceback("moleculekit.interactions.pipi.calculate", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_XDECREF(__pyx_t_4);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_t_5, 1);
+  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
+    __Pyx_PyThreadState_declare
+    __Pyx_PyThreadState_assign
+    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_acceptors.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_coords.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_donors.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_sel1.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_sel2.rcbuffer->pybuffer);
+  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
+  __Pyx_AddTraceback("moleculekit.interactions.hbonds.calculate", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
+  goto __pyx_L2;
   __pyx_L0:;
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_ring1_mean, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_ring2_mean, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_ring1_normal, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_ring2_normal, 1);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_acceptors.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_coords.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_donors.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_sel1.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_sel2.rcbuffer->pybuffer);
+  __pyx_L2:;
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_dist_vec_a, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_dist_vec_b, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_half_box, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_tmp1, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_tmp2, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 static struct __pyx_vtabstruct_array __pyx_vtable_array;
 
 static PyObject *__pyx_tp_new_array(PyTypeObject *t, PyObject *a, PyObject *k) {
@@ -21700,15 +21221,15 @@
   #endif
   {Py_tp_methods, (void *)__pyx_methods_array},
   {Py_tp_getset, (void *)__pyx_getsets_array},
   {Py_tp_new, (void *)__pyx_tp_new_array},
   {0, 0},
 };
 static PyType_Spec __pyx_type___pyx_array_spec = {
-  "moleculekit.interactions.pipi.array",
+  "moleculekit.interactions.hbonds.array",
   sizeof(struct __pyx_array_obj),
   0,
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_SEQUENCE,
   __pyx_type___pyx_array_slots,
 };
 #else
 
@@ -21746,15 +21267,15 @@
   #endif
   __pyx_array_getbuffer, /*bf_getbuffer*/
   0, /*bf_releasebuffer*/
 };
 
 static PyTypeObject __pyx_type___pyx_array = {
   PyVarObject_HEAD_INIT(0, 0)
-  "moleculekit.interactions.pipi.""array", /*tp_name*/
+  "moleculekit.interactions.hbonds.""array", /*tp_name*/
   sizeof(struct __pyx_array_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc_array, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -21906,25 +21427,25 @@
   {Py_tp_clear, (void *)__pyx_tp_clear_Enum},
   {Py_tp_methods, (void *)__pyx_methods_Enum},
   {Py_tp_init, (void *)__pyx_MemviewEnum___init__},
   {Py_tp_new, (void *)__pyx_tp_new_Enum},
   {0, 0},
 };
 static PyType_Spec __pyx_type___pyx_MemviewEnum_spec = {
-  "moleculekit.interactions.pipi.Enum",
+  "moleculekit.interactions.hbonds.Enum",
   sizeof(struct __pyx_MemviewEnum_obj),
   0,
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC,
   __pyx_type___pyx_MemviewEnum_slots,
 };
 #else
 
 static PyTypeObject __pyx_type___pyx_MemviewEnum = {
   PyVarObject_HEAD_INIT(0, 0)
-  "moleculekit.interactions.pipi.""Enum", /*tp_name*/
+  "moleculekit.interactions.hbonds.""Enum", /*tp_name*/
   sizeof(struct __pyx_MemviewEnum_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc_Enum, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -22213,15 +21734,15 @@
   {Py_tp_clear, (void *)__pyx_tp_clear_memoryview},
   {Py_tp_methods, (void *)__pyx_methods_memoryview},
   {Py_tp_getset, (void *)__pyx_getsets_memoryview},
   {Py_tp_new, (void *)__pyx_tp_new_memoryview},
   {0, 0},
 };
 static PyType_Spec __pyx_type___pyx_memoryview_spec = {
-  "moleculekit.interactions.pipi.memoryview",
+  "moleculekit.interactions.hbonds.memoryview",
   sizeof(struct __pyx_memoryview_obj),
   0,
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC,
   __pyx_type___pyx_memoryview_slots,
 };
 #else
 
@@ -22259,15 +21780,15 @@
   #endif
   __pyx_memoryview_getbuffer, /*bf_getbuffer*/
   0, /*bf_releasebuffer*/
 };
 
 static PyTypeObject __pyx_type___pyx_memoryview = {
   PyVarObject_HEAD_INIT(0, 0)
-  "moleculekit.interactions.pipi.""memoryview", /*tp_name*/
+  "moleculekit.interactions.hbonds.""memoryview", /*tp_name*/
   sizeof(struct __pyx_memoryview_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc_memoryview, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -22413,25 +21934,25 @@
   {Py_tp_traverse, (void *)__pyx_tp_traverse__memoryviewslice},
   {Py_tp_clear, (void *)__pyx_tp_clear__memoryviewslice},
   {Py_tp_methods, (void *)__pyx_methods__memoryviewslice},
   {Py_tp_new, (void *)__pyx_tp_new__memoryviewslice},
   {0, 0},
 };
 static PyType_Spec __pyx_type___pyx_memoryviewslice_spec = {
-  "moleculekit.interactions.pipi._memoryviewslice",
+  "moleculekit.interactions.hbonds._memoryviewslice",
   sizeof(struct __pyx_memoryviewslice_obj),
   0,
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC|Py_TPFLAGS_SEQUENCE,
   __pyx_type___pyx_memoryviewslice_slots,
 };
 #else
 
 static PyTypeObject __pyx_type___pyx_memoryviewslice = {
   PyVarObject_HEAD_INIT(0, 0)
-  "moleculekit.interactions.pipi.""_memoryviewslice", /*tp_name*/
+  "moleculekit.interactions.hbonds.""_memoryviewslice", /*tp_name*/
   sizeof(struct __pyx_memoryviewslice_obj), /*tp_basicsize*/
   0, /*tp_itemsize*/
   __pyx_tp_dealloc__memoryviewslice, /*tp_dealloc*/
   #if PY_VERSION_HEX < 0x030800b4
   0, /*tp_print*/
   #endif
   #if PY_VERSION_HEX >= 0x030800b4
@@ -22566,20 +22087,22 @@
     {&__pyx_n_s_ValueError, __pyx_k_ValueError, sizeof(__pyx_k_ValueError), 0, 0, 1, 1},
     {&__pyx_n_s_View_MemoryView, __pyx_k_View_MemoryView, sizeof(__pyx_k_View_MemoryView), 0, 0, 1, 1},
     {&__pyx_kp_u__2, __pyx_k__2, sizeof(__pyx_k__2), 0, 1, 0, 0},
     {&__pyx_n_s__25, __pyx_k__25, sizeof(__pyx_k__25), 0, 0, 1, 1},
     {&__pyx_n_s__3, __pyx_k__3, sizeof(__pyx_k__3), 0, 0, 1, 1},
     {&__pyx_kp_u__6, __pyx_k__6, sizeof(__pyx_k__6), 0, 1, 0, 0},
     {&__pyx_kp_u__7, __pyx_k__7, sizeof(__pyx_k__7), 0, 1, 0, 0},
+    {&__pyx_n_s_a, __pyx_k_a, sizeof(__pyx_k_a), 0, 0, 1, 1},
+    {&__pyx_n_s_a_idx, __pyx_k_a_idx, sizeof(__pyx_k_a_idx), 0, 0, 1, 1},
     {&__pyx_n_s_abc, __pyx_k_abc, sizeof(__pyx_k_abc), 0, 0, 1, 1},
+    {&__pyx_n_s_acceptors, __pyx_k_acceptors, sizeof(__pyx_k_acceptors), 0, 0, 1, 1},
     {&__pyx_n_s_allocate_buffer, __pyx_k_allocate_buffer, sizeof(__pyx_k_allocate_buffer), 0, 0, 1, 1},
     {&__pyx_kp_u_and, __pyx_k_and, sizeof(__pyx_k_and), 0, 1, 0, 0},
     {&__pyx_n_s_angle, __pyx_k_angle, sizeof(__pyx_k_angle), 0, 0, 1, 1},
-    {&__pyx_n_s_angle_threshold1_max, __pyx_k_angle_threshold1_max, sizeof(__pyx_k_angle_threshold1_max), 0, 0, 1, 1},
-    {&__pyx_n_s_angle_threshold2_min, __pyx_k_angle_threshold2_min, sizeof(__pyx_k_angle_threshold2_min), 0, 0, 1, 1},
+    {&__pyx_n_s_angle_threshold, __pyx_k_angle_threshold, sizeof(__pyx_k_angle_threshold), 0, 0, 1, 1},
     {&__pyx_n_s_asyncio_coroutines, __pyx_k_asyncio_coroutines, sizeof(__pyx_k_asyncio_coroutines), 0, 0, 1, 1},
     {&__pyx_n_s_base, __pyx_k_base, sizeof(__pyx_k_base), 0, 0, 1, 1},
     {&__pyx_n_s_box, __pyx_k_box, sizeof(__pyx_k_box), 0, 0, 1, 1},
     {&__pyx_n_s_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 0, 1, 1},
     {&__pyx_n_u_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 1, 0, 1},
     {&__pyx_n_s_calculate, __pyx_k_calculate, sizeof(__pyx_k_calculate), 0, 0, 1, 1},
     {&__pyx_n_s_class, __pyx_k_class, sizeof(__pyx_k_class), 0, 0, 1, 1},
@@ -22587,21 +22110,27 @@
     {&__pyx_n_s_cline_in_traceback, __pyx_k_cline_in_traceback, sizeof(__pyx_k_cline_in_traceback), 0, 0, 1, 1},
     {&__pyx_n_s_collections, __pyx_k_collections, sizeof(__pyx_k_collections), 0, 0, 1, 1},
     {&__pyx_kp_s_collections_abc, __pyx_k_collections_abc, sizeof(__pyx_k_collections_abc), 0, 0, 1, 0},
     {&__pyx_kp_s_contiguous_and_direct, __pyx_k_contiguous_and_direct, sizeof(__pyx_k_contiguous_and_direct), 0, 0, 1, 0},
     {&__pyx_kp_s_contiguous_and_indirect, __pyx_k_contiguous_and_indirect, sizeof(__pyx_k_contiguous_and_indirect), 0, 0, 1, 0},
     {&__pyx_n_s_coords, __pyx_k_coords, sizeof(__pyx_k_coords), 0, 0, 1, 1},
     {&__pyx_n_s_count, __pyx_k_count, sizeof(__pyx_k_count), 0, 0, 1, 1},
+    {&__pyx_n_s_d, __pyx_k_d, sizeof(__pyx_k_d), 0, 0, 1, 1},
+    {&__pyx_n_s_d_idx, __pyx_k_d_idx, sizeof(__pyx_k_d_idx), 0, 0, 1, 1},
+    {&__pyx_n_s_d_idx_d, __pyx_k_d_idx_d, sizeof(__pyx_k_d_idx_d), 0, 0, 1, 1},
+    {&__pyx_n_s_d_idx_h, __pyx_k_d_idx_h, sizeof(__pyx_k_d_idx_h), 0, 0, 1, 1},
     {&__pyx_n_s_dict, __pyx_k_dict, sizeof(__pyx_k_dict), 0, 0, 1, 1},
     {&__pyx_kp_u_disable, __pyx_k_disable, sizeof(__pyx_k_disable), 0, 1, 0, 0},
-    {&__pyx_n_s_dist2, __pyx_k_dist2, sizeof(__pyx_k_dist2), 0, 0, 1, 1},
-    {&__pyx_n_s_dist_threshold1, __pyx_k_dist_threshold1, sizeof(__pyx_k_dist_threshold1), 0, 0, 1, 1},
-    {&__pyx_n_s_dist_threshold2, __pyx_k_dist_threshold2, sizeof(__pyx_k_dist_threshold2), 0, 0, 1, 1},
-    {&__pyx_n_s_distangles, __pyx_k_distangles, sizeof(__pyx_k_distangles), 0, 0, 1, 1},
-    {&__pyx_n_s_dot_prod, __pyx_k_dot_prod, sizeof(__pyx_k_dot_prod), 0, 0, 1, 1},
+    {&__pyx_n_s_dist2_a, __pyx_k_dist2_a, sizeof(__pyx_k_dist2_a), 0, 0, 1, 1},
+    {&__pyx_n_s_dist2_b, __pyx_k_dist2_b, sizeof(__pyx_k_dist2_b), 0, 0, 1, 1},
+    {&__pyx_n_s_dist_threshold, __pyx_k_dist_threshold, sizeof(__pyx_k_dist_threshold), 0, 0, 1, 1},
+    {&__pyx_n_s_dist_vec_a, __pyx_k_dist_vec_a, sizeof(__pyx_k_dist_vec_a), 0, 0, 1, 1},
+    {&__pyx_n_s_dist_vec_b, __pyx_k_dist_vec_b, sizeof(__pyx_k_dist_vec_b), 0, 0, 1, 1},
+    {&__pyx_n_s_donors, __pyx_k_donors, sizeof(__pyx_k_donors), 0, 0, 1, 1},
+    {&__pyx_n_s_dotprod, __pyx_k_dotprod, sizeof(__pyx_k_dotprod), 0, 0, 1, 1},
     {&__pyx_n_s_dtype, __pyx_k_dtype, sizeof(__pyx_k_dtype), 0, 0, 1, 1},
     {&__pyx_n_s_dtype_is_object, __pyx_k_dtype_is_object, sizeof(__pyx_k_dtype_is_object), 0, 0, 1, 1},
     {&__pyx_kp_u_enable, __pyx_k_enable, sizeof(__pyx_k_enable), 0, 1, 0, 0},
     {&__pyx_n_s_encode, __pyx_k_encode, sizeof(__pyx_k_encode), 0, 0, 1, 1},
     {&__pyx_n_s_enumerate, __pyx_k_enumerate, sizeof(__pyx_k_enumerate), 0, 0, 1, 1},
     {&__pyx_n_s_error, __pyx_k_error, sizeof(__pyx_k_error), 0, 0, 1, 1},
     {&__pyx_n_s_f, __pyx_k_f, sizeof(__pyx_k_f), 0, 0, 1, 1},
@@ -22613,29 +22142,32 @@
     {&__pyx_kp_u_gc, __pyx_k_gc, sizeof(__pyx_k_gc), 0, 1, 0, 0},
     {&__pyx_n_s_getstate, __pyx_k_getstate, sizeof(__pyx_k_getstate), 0, 0, 1, 1},
     {&__pyx_kp_u_got, __pyx_k_got, sizeof(__pyx_k_got), 0, 1, 0, 0},
     {&__pyx_kp_u_got_differing_extents_in_dimensi, __pyx_k_got_differing_extents_in_dimensi, sizeof(__pyx_k_got_differing_extents_in_dimensi), 0, 1, 0, 0},
     {&__pyx_n_s_half_box, __pyx_k_half_box, sizeof(__pyx_k_half_box), 0, 0, 1, 1},
     {&__pyx_n_s_i, __pyx_k_i, sizeof(__pyx_k_i), 0, 0, 1, 1},
     {&__pyx_n_s_id, __pyx_k_id, sizeof(__pyx_k_id), 0, 0, 1, 1},
+    {&__pyx_n_s_ignore_hs, __pyx_k_ignore_hs, sizeof(__pyx_k_ignore_hs), 0, 0, 1, 1},
     {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
     {&__pyx_n_s_index, __pyx_k_index, sizeof(__pyx_k_index), 0, 0, 1, 1},
     {&__pyx_n_s_initializing, __pyx_k_initializing, sizeof(__pyx_k_initializing), 0, 0, 1, 1},
+    {&__pyx_n_s_intra, __pyx_k_intra, sizeof(__pyx_k_intra), 0, 0, 1, 1},
     {&__pyx_n_s_is_coroutine, __pyx_k_is_coroutine, sizeof(__pyx_k_is_coroutine), 0, 0, 1, 1},
     {&__pyx_kp_u_isenabled, __pyx_k_isenabled, sizeof(__pyx_k_isenabled), 0, 1, 0, 0},
     {&__pyx_n_s_itemsize, __pyx_k_itemsize, sizeof(__pyx_k_itemsize), 0, 0, 1, 1},
     {&__pyx_kp_s_itemsize_0_for_cython_array, __pyx_k_itemsize_0_for_cython_array, sizeof(__pyx_k_itemsize_0_for_cython_array), 0, 0, 1, 0},
     {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
+    {&__pyx_n_s_math, __pyx_k_math, sizeof(__pyx_k_math), 0, 0, 1, 1},
     {&__pyx_n_s_memview, __pyx_k_memview, sizeof(__pyx_k_memview), 0, 0, 1, 1},
     {&__pyx_n_s_mode, __pyx_k_mode, sizeof(__pyx_k_mode), 0, 0, 1, 1},
-    {&__pyx_n_s_moleculekit_interactions_pipi, __pyx_k_moleculekit_interactions_pipi, sizeof(__pyx_k_moleculekit_interactions_pipi), 0, 0, 1, 1},
-    {&__pyx_kp_s_moleculekit_interactions_pipi_pi, __pyx_k_moleculekit_interactions_pipi_pi, sizeof(__pyx_k_moleculekit_interactions_pipi_pi), 0, 0, 1, 0},
+    {&__pyx_kp_s_moleculekit_interactions_hbonds, __pyx_k_moleculekit_interactions_hbonds, sizeof(__pyx_k_moleculekit_interactions_hbonds), 0, 0, 1, 0},
+    {&__pyx_n_s_moleculekit_interactions_hbonds_2, __pyx_k_moleculekit_interactions_hbonds_2, sizeof(__pyx_k_moleculekit_interactions_hbonds_2), 0, 0, 1, 1},
+    {&__pyx_n_s_n_acceptors, __pyx_k_n_acceptors, sizeof(__pyx_k_n_acceptors), 0, 0, 1, 1},
+    {&__pyx_n_s_n_donors, __pyx_k_n_donors, sizeof(__pyx_k_n_donors), 0, 0, 1, 1},
     {&__pyx_n_s_n_frames, __pyx_k_n_frames, sizeof(__pyx_k_n_frames), 0, 0, 1, 1},
-    {&__pyx_n_s_n_rings1, __pyx_k_n_rings1, sizeof(__pyx_k_n_rings1), 0, 0, 1, 1},
-    {&__pyx_n_s_n_rings2, __pyx_k_n_rings2, sizeof(__pyx_k_n_rings2), 0, 0, 1, 1},
     {&__pyx_n_s_name, __pyx_k_name, sizeof(__pyx_k_name), 0, 0, 1, 1},
     {&__pyx_n_s_name_2, __pyx_k_name_2, sizeof(__pyx_k_name_2), 0, 0, 1, 1},
     {&__pyx_n_s_ndim, __pyx_k_ndim, sizeof(__pyx_k_ndim), 0, 0, 1, 1},
     {&__pyx_n_s_new, __pyx_k_new, sizeof(__pyx_k_new), 0, 0, 1, 1},
     {&__pyx_kp_s_no_default___reduce___due_to_non, __pyx_k_no_default___reduce___due_to_non, sizeof(__pyx_k_no_default___reduce___due_to_non), 0, 0, 1, 0},
     {&__pyx_n_s_np, __pyx_k_np, sizeof(__pyx_k_np), 0, 0, 1, 1},
     {&__pyx_n_s_numpy, __pyx_k_numpy, sizeof(__pyx_k_numpy), 0, 0, 1, 1},
@@ -22647,64 +22179,53 @@
     {&__pyx_n_s_pyx_PickleError, __pyx_k_pyx_PickleError, sizeof(__pyx_k_pyx_PickleError), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_checksum, __pyx_k_pyx_checksum, sizeof(__pyx_k_pyx_checksum), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_result, __pyx_k_pyx_result, sizeof(__pyx_k_pyx_result), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_state, __pyx_k_pyx_state, sizeof(__pyx_k_pyx_state), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_type, __pyx_k_pyx_type, sizeof(__pyx_k_pyx_type), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_unpickle_Enum, __pyx_k_pyx_unpickle_Enum, sizeof(__pyx_k_pyx_unpickle_Enum), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_vtable, __pyx_k_pyx_vtable, sizeof(__pyx_k_pyx_vtable), 0, 0, 1, 1},
-    {&__pyx_n_s_r1, __pyx_k_r1, sizeof(__pyx_k_r1), 0, 0, 1, 1},
-    {&__pyx_n_s_r1_end_idx, __pyx_k_r1_end_idx, sizeof(__pyx_k_r1_end_idx), 0, 0, 1, 1},
-    {&__pyx_n_s_r1_start_idx, __pyx_k_r1_start_idx, sizeof(__pyx_k_r1_start_idx), 0, 0, 1, 1},
-    {&__pyx_n_s_r2, __pyx_k_r2, sizeof(__pyx_k_r2), 0, 0, 1, 1},
-    {&__pyx_n_s_r2_end_idx, __pyx_k_r2_end_idx, sizeof(__pyx_k_r2_end_idx), 0, 0, 1, 1},
-    {&__pyx_n_s_r2_start_idx, __pyx_k_r2_start_idx, sizeof(__pyx_k_r2_start_idx), 0, 0, 1, 1},
     {&__pyx_n_s_range, __pyx_k_range, sizeof(__pyx_k_range), 0, 0, 1, 1},
     {&__pyx_n_s_reduce, __pyx_k_reduce, sizeof(__pyx_k_reduce), 0, 0, 1, 1},
     {&__pyx_n_s_reduce_cython, __pyx_k_reduce_cython, sizeof(__pyx_k_reduce_cython), 0, 0, 1, 1},
     {&__pyx_n_s_reduce_ex, __pyx_k_reduce_ex, sizeof(__pyx_k_reduce_ex), 0, 0, 1, 1},
     {&__pyx_n_s_register, __pyx_k_register, sizeof(__pyx_k_register), 0, 0, 1, 1},
     {&__pyx_n_s_results, __pyx_k_results, sizeof(__pyx_k_results), 0, 0, 1, 1},
-    {&__pyx_n_s_ring1_mean, __pyx_k_ring1_mean, sizeof(__pyx_k_ring1_mean), 0, 0, 1, 1},
-    {&__pyx_n_s_ring1_normal, __pyx_k_ring1_normal, sizeof(__pyx_k_ring1_normal), 0, 0, 1, 1},
-    {&__pyx_n_s_ring2_mean, __pyx_k_ring2_mean, sizeof(__pyx_k_ring2_mean), 0, 0, 1, 1},
-    {&__pyx_n_s_ring2_normal, __pyx_k_ring2_normal, sizeof(__pyx_k_ring2_normal), 0, 0, 1, 1},
-    {&__pyx_n_s_rings1_start_indexes, __pyx_k_rings1_start_indexes, sizeof(__pyx_k_rings1_start_indexes), 0, 0, 1, 1},
-    {&__pyx_n_s_rings2_start_indexes, __pyx_k_rings2_start_indexes, sizeof(__pyx_k_rings2_start_indexes), 0, 0, 1, 1},
-    {&__pyx_n_s_rings_atoms, __pyx_k_rings_atoms, sizeof(__pyx_k_rings_atoms), 0, 0, 1, 1},
+    {&__pyx_n_s_sel1, __pyx_k_sel1, sizeof(__pyx_k_sel1), 0, 0, 1, 1},
+    {&__pyx_n_s_sel2, __pyx_k_sel2, sizeof(__pyx_k_sel2), 0, 0, 1, 1},
     {&__pyx_n_s_setstate, __pyx_k_setstate, sizeof(__pyx_k_setstate), 0, 0, 1, 1},
     {&__pyx_n_s_setstate_cython, __pyx_k_setstate_cython, sizeof(__pyx_k_setstate_cython), 0, 0, 1, 1},
     {&__pyx_n_s_shape, __pyx_k_shape, sizeof(__pyx_k_shape), 0, 0, 1, 1},
     {&__pyx_n_s_size, __pyx_k_size, sizeof(__pyx_k_size), 0, 0, 1, 1},
     {&__pyx_n_s_spec, __pyx_k_spec, sizeof(__pyx_k_spec), 0, 0, 1, 1},
+    {&__pyx_n_s_sqrt, __pyx_k_sqrt, sizeof(__pyx_k_sqrt), 0, 0, 1, 1},
     {&__pyx_n_s_start, __pyx_k_start, sizeof(__pyx_k_start), 0, 0, 1, 1},
     {&__pyx_n_s_step, __pyx_k_step, sizeof(__pyx_k_step), 0, 0, 1, 1},
     {&__pyx_n_s_stop, __pyx_k_stop, sizeof(__pyx_k_stop), 0, 0, 1, 1},
     {&__pyx_kp_s_strided_and_direct, __pyx_k_strided_and_direct, sizeof(__pyx_k_strided_and_direct), 0, 0, 1, 0},
     {&__pyx_kp_s_strided_and_direct_or_indirect, __pyx_k_strided_and_direct_or_indirect, sizeof(__pyx_k_strided_and_direct_or_indirect), 0, 0, 1, 0},
     {&__pyx_kp_s_strided_and_indirect, __pyx_k_strided_and_indirect, sizeof(__pyx_k_strided_and_indirect), 0, 0, 1, 0},
     {&__pyx_kp_s_stringsource, __pyx_k_stringsource, sizeof(__pyx_k_stringsource), 0, 0, 1, 0},
     {&__pyx_n_s_struct, __pyx_k_struct, sizeof(__pyx_k_struct), 0, 0, 1, 1},
     {&__pyx_n_s_sys, __pyx_k_sys, sizeof(__pyx_k_sys), 0, 0, 1, 1},
     {&__pyx_n_s_test, __pyx_k_test, sizeof(__pyx_k_test), 0, 0, 1, 1},
-    {&__pyx_n_s_tmp1, __pyx_k_tmp1, sizeof(__pyx_k_tmp1), 0, 0, 1, 1},
-    {&__pyx_n_s_tmp2, __pyx_k_tmp2, sizeof(__pyx_k_tmp2), 0, 0, 1, 1},
     {&__pyx_n_s_uint32, __pyx_k_uint32, sizeof(__pyx_k_uint32), 0, 0, 1, 1},
     {&__pyx_kp_s_unable_to_allocate_array_data, __pyx_k_unable_to_allocate_array_data, sizeof(__pyx_k_unable_to_allocate_array_data), 0, 0, 1, 0},
     {&__pyx_kp_s_unable_to_allocate_shape_and_str, __pyx_k_unable_to_allocate_shape_and_str, sizeof(__pyx_k_unable_to_allocate_shape_and_str), 0, 0, 1, 0},
     {&__pyx_n_s_unpack, __pyx_k_unpack, sizeof(__pyx_k_unpack), 0, 0, 1, 1},
     {&__pyx_n_s_update, __pyx_k_update, sizeof(__pyx_k_update), 0, 0, 1, 1},
+    {&__pyx_n_s_val, __pyx_k_val, sizeof(__pyx_k_val), 0, 0, 1, 1},
     {&__pyx_n_s_version_info, __pyx_k_version_info, sizeof(__pyx_k_version_info), 0, 0, 1, 1},
     {&__pyx_n_s_zeros, __pyx_k_zeros, sizeof(__pyx_k_zeros), 0, 0, 1, 1},
     {0, 0, 0, 0, 0, 0, 0}
   };
   return __Pyx_InitStrings(__pyx_string_tab);
 }
 /* #### Code section: cached_builtins ### */
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 32, __pyx_L1_error)
+  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 51, __pyx_L1_error)
   __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(1, 68, __pyx_L1_error)
   __pyx_builtin___import__ = __Pyx_GetBuiltinName(__pyx_n_s_import); if (!__pyx_builtin___import__) __PYX_ERR(1, 100, __pyx_L1_error)
   __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(1, 141, __pyx_L1_error)
   __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(1, 159, __pyx_L1_error)
   __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(1, 2, __pyx_L1_error)
   __pyx_builtin_AssertionError = __Pyx_GetBuiltinName(__pyx_n_s_AssertionError); if (!__pyx_builtin_AssertionError) __PYX_ERR(1, 373, __pyx_L1_error)
   __pyx_builtin_Ellipsis = __Pyx_GetBuiltinName(__pyx_n_s_Ellipsis); if (!__pyx_builtin_Ellipsis) __PYX_ERR(1, 408, __pyx_L1_error)
@@ -22753,44 +22274,44 @@
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError, "Incompatible checksums (0x%x vs (0x82a3537, 0x6ae9995, 0xb068931) = (name))" % __pyx_checksum
  */
   __pyx_tuple__8 = PyTuple_Pack(3, __pyx_int_136983863, __pyx_int_112105877, __pyx_int_184977713); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__8);
   __Pyx_GIVEREF(__pyx_tuple__8);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(2, 983, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__9);
   __Pyx_GIVEREF(__pyx_tuple__9);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(2, 989, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__10);
   __Pyx_GIVEREF(__pyx_tuple__10);
 
-  /* "moleculekit/interactions/pipi/pipi.pyx":104
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":42
+ *     cdef int n_frames = coords.shape[2]
  *     cdef vector[vector[int]] results
- *     cdef vector[vector[float]] distangles
- *     cdef FLOAT32_t[:] ring1_mean = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
- *     cdef FLOAT32_t[:] ring2_mean = np.zeros(3, dtype=FLOAT32)
- *     cdef FLOAT32_t[:] ring1_normal = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] dist_vec_a = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
+ *     cdef FLOAT32_t[:] dist_vec_b = np.zeros(3, dtype=FLOAT32)
+ *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)
  */
-  __pyx_tuple__11 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 104, __pyx_L1_error)
+  __pyx_tuple__11 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 42, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__11);
   __Pyx_GIVEREF(__pyx_tuple__11);
 
   /* "View.MemoryView":100
  * cdef object __pyx_collections_abc_Sequence "__pyx_collections_abc_Sequence"
  * try:
  *     if __import__("sys").version_info >= (3, 3):             # <<<<<<<<<<<<<<
@@ -22887,25 +22408,25 @@
  *     cdef object __pyx_result
  */
   __pyx_tuple__21 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__21);
   __Pyx_GIVEREF(__pyx_tuple__21);
   __pyx_codeobj__22 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__21, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__22)) __PYX_ERR(1, 1, __pyx_L1_error)
 
-  /* "moleculekit/interactions/pipi/pipi.pyx":84
- * 
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":23
  * 
+ * import cython
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def calculate(
  */
-  __pyx_tuple__23 = PyTuple_Pack(32, __pyx_n_s_rings_atoms, __pyx_n_s_rings1_start_indexes, __pyx_n_s_rings2_start_indexes, __pyx_n_s_coords, __pyx_n_s_box, __pyx_n_s_dist_threshold1, __pyx_n_s_angle_threshold1_max, __pyx_n_s_dist_threshold2, __pyx_n_s_angle_threshold2_min, __pyx_n_s_r1, __pyx_n_s_r2, __pyx_n_s_f, __pyx_n_s_i, __pyx_n_s_n_rings1, __pyx_n_s_n_rings2, __pyx_n_s_n_frames, __pyx_n_s_results, __pyx_n_s_distangles, __pyx_n_s_ring1_mean, __pyx_n_s_ring2_mean, __pyx_n_s_ring1_normal, __pyx_n_s_ring2_normal, __pyx_n_s_half_box, __pyx_n_s_tmp1, __pyx_n_s_tmp2, __pyx_n_s_dist2, __pyx_n_s_dot_prod, __pyx_n_s_r1_start_idx, __pyx_n_s_r2_start_idx, __pyx_n_s_r1_end_idx, __pyx_n_s_r2_end_idx, __pyx_n_s_angle); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 84, __pyx_L1_error)
+  __pyx_tuple__23 = PyTuple_Pack(30, __pyx_n_s_donors, __pyx_n_s_acceptors, __pyx_n_s_coords, __pyx_n_s_box, __pyx_n_s_sel1, __pyx_n_s_sel2, __pyx_n_s_dist_threshold, __pyx_n_s_angle_threshold, __pyx_n_s_intra, __pyx_n_s_ignore_hs, __pyx_n_s_d, __pyx_n_s_a, __pyx_n_s_f, __pyx_n_s_i, __pyx_n_s_n_donors, __pyx_n_s_n_acceptors, __pyx_n_s_n_frames, __pyx_n_s_results, __pyx_n_s_dist_vec_a, __pyx_n_s_dist_vec_b, __pyx_n_s_half_box, __pyx_n_s_dist2_a, __pyx_n_s_dist2_b, __pyx_n_s_dotprod, __pyx_n_s_val, __pyx_n_s_angle, __pyx_n_s_d_idx_d, __pyx_n_s_d_idx_h, __pyx_n_s_d_idx, __pyx_n_s_a_idx); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 23, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__23);
   __Pyx_GIVEREF(__pyx_tuple__23);
-  __pyx_codeobj__24 = (PyObject*)__Pyx_PyCode_New(9, 0, 0, 32, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__23, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_moleculekit_interactions_pipi_pi, __pyx_n_s_calculate, 84, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__24)) __PYX_ERR(0, 84, __pyx_L1_error)
+  __pyx_codeobj__24 = (PyObject*)__Pyx_PyCode_New(10, 0, 0, 30, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__23, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_moleculekit_interactions_hbonds, __pyx_n_s_calculate, 23, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__24)) __PYX_ERR(0, 23, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 /* #### Code section: init_constants ### */
@@ -23212,31 +22733,31 @@
   return 0;
 }
 
 
 #if PY_MAJOR_VERSION >= 3
 #if CYTHON_PEP489_MULTI_PHASE_INIT
 static PyObject* __pyx_pymod_create(PyObject *spec, PyModuleDef *def); /*proto*/
-static int __pyx_pymod_exec_pipi(PyObject* module); /*proto*/
+static int __pyx_pymod_exec_hbonds(PyObject* module); /*proto*/
 static PyModuleDef_Slot __pyx_moduledef_slots[] = {
   {Py_mod_create, (void*)__pyx_pymod_create},
-  {Py_mod_exec, (void*)__pyx_pymod_exec_pipi},
+  {Py_mod_exec, (void*)__pyx_pymod_exec_hbonds},
   {0, NULL}
 };
 #endif
 
 #ifdef __cplusplus
 namespace {
   struct PyModuleDef __pyx_moduledef =
   #else
   static struct PyModuleDef __pyx_moduledef =
   #endif
   {
       PyModuleDef_HEAD_INIT,
-      "pipi",
+      "hbonds",
       0, /* m_doc */
     #if CYTHON_PEP489_MULTI_PHASE_INIT
       0, /* m_size */
     #elif CYTHON_USE_MODULE_STATE
       sizeof(__pyx_mstate), /* m_size */
     #else
       -1, /* m_size */
@@ -23276,19 +22797,19 @@
 #else
 #define __Pyx_PyMODINIT_FUNC PyObject *
 #endif
 #endif
 
 
 #if PY_MAJOR_VERSION < 3
-__Pyx_PyMODINIT_FUNC initpipi(void) CYTHON_SMALL_CODE; /*proto*/
-__Pyx_PyMODINIT_FUNC initpipi(void)
+__Pyx_PyMODINIT_FUNC inithbonds(void) CYTHON_SMALL_CODE; /*proto*/
+__Pyx_PyMODINIT_FUNC inithbonds(void)
 #else
-__Pyx_PyMODINIT_FUNC PyInit_pipi(void) CYTHON_SMALL_CODE; /*proto*/
-__Pyx_PyMODINIT_FUNC PyInit_pipi(void)
+__Pyx_PyMODINIT_FUNC PyInit_hbonds(void) CYTHON_SMALL_CODE; /*proto*/
+__Pyx_PyMODINIT_FUNC PyInit_hbonds(void)
 #if CYTHON_PEP489_MULTI_PHASE_INIT
 {
   return PyModuleDef_Init(&__pyx_moduledef);
 }
 static CYTHON_SMALL_CODE int __Pyx_check_single_interpreter(void) {
     #if PY_VERSION_HEX >= 0x030700A1
     static PY_INT64_T main_interpreter_id = -1;
@@ -23361,15 +22882,15 @@
     return module;
 bad:
     Py_XDECREF(module);
     return NULL;
 }
 
 
-static CYTHON_SMALL_CODE int __pyx_pymod_exec_pipi(PyObject *__pyx_pyinit_module)
+static CYTHON_SMALL_CODE int __pyx_pymod_exec_hbonds(PyObject *__pyx_pyinit_module)
 #endif
 #endif
 {
   int stringtab_initialized = 0;
   #if CYTHON_USE_MODULE_STATE
   int pystate_addmodule_run = 0;
   #endif
@@ -23386,33 +22907,33 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannyDeclarations
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   if (__pyx_m) {
     if (__pyx_m == __pyx_pyinit_module) return 0;
-    PyErr_SetString(PyExc_RuntimeError, "Module 'pipi' has already been imported. Re-initialisation is not supported.");
+    PyErr_SetString(PyExc_RuntimeError, "Module 'hbonds' has already been imported. Re-initialisation is not supported.");
     return -1;
   }
   #elif PY_MAJOR_VERSION >= 3
   if (__pyx_m) return __Pyx_NewRef(__pyx_m);
   #endif
   /*--- Module creation code ---*/
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   __pyx_m = __pyx_pyinit_module;
   Py_INCREF(__pyx_m);
   #else
   #if PY_MAJOR_VERSION < 3
-  __pyx_m = Py_InitModule4("pipi", __pyx_methods, 0, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
+  __pyx_m = Py_InitModule4("hbonds", __pyx_methods, 0, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
   if (unlikely(!__pyx_m)) __PYX_ERR(0, 1, __pyx_L1_error)
   #elif CYTHON_USE_MODULE_STATE
   __pyx_t_1 = PyModule_Create(&__pyx_moduledef); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)
   {
     int add_module_result = PyState_AddModule(__pyx_t_1, &__pyx_moduledef);
-    __pyx_t_1 = 0; /* transfer ownership from __pyx_t_1 to pipi pseudovariable */
+    __pyx_t_1 = 0; /* transfer ownership from __pyx_t_1 to hbonds pseudovariable */
     if (unlikely((add_module_result < 0))) __PYX_ERR(0, 1, __pyx_L1_error)
     pystate_addmodule_run = 1;
   }
   #else
   __pyx_m = PyModule_Create(&__pyx_moduledef);
   if (unlikely(!__pyx_m)) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
@@ -23428,15 +22949,15 @@
 if (!__Pyx_RefNanny) {
   PyErr_Clear();
   __Pyx_RefNanny = __Pyx_RefNannyImportAPI("Cython.Runtime.refnanny");
   if (!__Pyx_RefNanny)
       Py_FatalError("failed to import 'refnanny' module");
 }
 #endif
-  __Pyx_RefNannySetupContext("__Pyx_PyMODINIT_FUNC PyInit_pipi(void)", 0);
+  __Pyx_RefNannySetupContext("__Pyx_PyMODINIT_FUNC PyInit_hbonds(void)", 0);
   if (__Pyx_check_binary_version(__PYX_LIMITED_VERSION_HEX, __Pyx_get_runtime_version(), CYTHON_COMPILING_IN_LIMITED_API) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #ifdef __Pxy_PyFrame_Initialize_Offsets
   __Pxy_PyFrame_Initialize_Offsets();
   #endif
   __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_empty_bytes = PyBytes_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_empty_unicode = PyUnicode_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_unicode)) __PYX_ERR(0, 1, __pyx_L1_error)
@@ -23466,22 +22987,22 @@
   /*--- Initialize various global constants etc. ---*/
   if (__Pyx_InitConstants() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   stringtab_initialized = 1;
   if (__Pyx_InitGlobals() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #if PY_MAJOR_VERSION < 3 && (__PYX_DEFAULT_STRING_ENCODING_IS_ASCII || __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT)
   if (__Pyx_init_sys_getdefaultencoding_params() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
-  if (__pyx_module_is_main_moleculekit__interactions__pipi) {
+  if (__pyx_module_is_main_moleculekit__interactions__hbonds) {
     if (PyObject_SetAttr(__pyx_m, __pyx_n_s_name_2, __pyx_n_s_main) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   }
   #if PY_MAJOR_VERSION >= 3
   {
     PyObject *modules = PyImport_GetModuleDict(); if (unlikely(!modules)) __PYX_ERR(0, 1, __pyx_L1_error)
-    if (!PyDict_GetItemString(modules, "moleculekit.interactions.pipi")) {
-      if (unlikely((PyDict_SetItemString(modules, "moleculekit.interactions.pipi", __pyx_m) < 0))) __PYX_ERR(0, 1, __pyx_L1_error)
+    if (!PyDict_GetItemString(modules, "moleculekit.interactions.hbonds")) {
+      if (unlikely((PyDict_SetItemString(modules, "moleculekit.interactions.hbonds", __pyx_m) < 0))) __PYX_ERR(0, 1, __pyx_L1_error)
     }
   }
   #endif
   /*--- Builtin init code ---*/
   if (__Pyx_InitCachedBuiltins() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   /*--- Constants init code ---*/
   if (__Pyx_InitCachedConstants() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
@@ -24007,125 +23528,146 @@
  *     cdef object __pyx_result
  */
   __pyx_t_7 = PyCFunction_NewEx(&__pyx_mdef_15View_dot_MemoryView_1__pyx_unpickle_Enum, NULL, __pyx_n_s_View_MemoryView); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_pyx_unpickle_Enum, __pyx_t_7) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "moleculekit/interactions/pipi/pipi.pyx":3
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":3
  * # cython: cdivision=True
  * 
  * import numpy as np             # <<<<<<<<<<<<<<
+ * from math import sqrt
  * cimport numpy as np
- * from libcpp.vector cimport vector
  */
   __pyx_t_7 = __Pyx_ImportDottedModule(__pyx_n_s_numpy, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_7) < 0) __PYX_ERR(0, 3, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "moleculekit/interactions/pipi/pipi.pyx":11
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":4
+ * 
+ * import numpy as np
+ * from math import sqrt             # <<<<<<<<<<<<<<
+ * cimport numpy as np
+ * from libcpp.vector cimport vector
+ */
+  __pyx_t_7 = PyList_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_INCREF(__pyx_n_s_sqrt);
+  __Pyx_GIVEREF(__pyx_n_s_sqrt);
+  if (__Pyx_PyList_SET_ITEM(__pyx_t_7, 0, __pyx_n_s_sqrt)) __PYX_ERR(0, 4, __pyx_L1_error);
+  __pyx_t_4 = __Pyx_Import(__pyx_n_s_math, __pyx_t_7, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __pyx_t_7 = __Pyx_ImportFrom(__pyx_t_4, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_sqrt, __pyx_t_7) < 0) __PYX_ERR(0, 4, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":13
  * # DTYPE for this, which is assigned to the usual NumPy runtime
  * # type info object.
  * UINT32 = np.uint32             # <<<<<<<<<<<<<<
  * FLOAT32 = np.float32
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 11, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_uint32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 11, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 13, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_UINT32, __pyx_t_4) < 0) __PYX_ERR(0, 11, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_uint32); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 13, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_UINT32, __pyx_t_7) < 0) __PYX_ERR(0, 13, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "moleculekit/interactions/pipi/pipi.pyx":12
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":14
  * # type info object.
  * UINT32 = np.uint32
  * FLOAT32 = np.float32             # <<<<<<<<<<<<<<
  * 
  * # "ctypedef" assigns a corresponding compile-time type to DTYPE_t. For
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 12, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float32); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 12, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 14, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_FLOAT32, __pyx_t_7) < 0) __PYX_ERR(0, 12, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_float32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 14, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_FLOAT32, __pyx_t_4) < 0) __PYX_ERR(0, 14, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "moleculekit/interactions/pipi/pipi.pyx":92
- *         FLOAT32_t[:,:,:] coords,
- *         FLOAT32_t[:,:] box,
- *         float dist_threshold1=4.4,             # <<<<<<<<<<<<<<
- *         float angle_threshold1_max=30,
- *         float dist_threshold2=5.5,
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":32
+ *         np.ndarray[UINT32_t, ndim=1] sel1,
+ *         np.ndarray[UINT32_t, ndim=1] sel2,
+ *         float dist_threshold=2.5,             # <<<<<<<<<<<<<<
+ *         float angle_threshold=120,
+ *         bool intra=False,
  */
-  __pyx_t_7 = PyFloat_FromDouble(((double)4.4)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 92, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
+  __pyx_t_4 = PyFloat_FromDouble(((double)2.5)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 32, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
 
-  /* "moleculekit/interactions/pipi/pipi.pyx":93
- *         FLOAT32_t[:,:] box,
- *         float dist_threshold1=4.4,
- *         float angle_threshold1_max=30,             # <<<<<<<<<<<<<<
- *         float dist_threshold2=5.5,
- *         float angle_threshold2_min=60,
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":33
+ *         np.ndarray[UINT32_t, ndim=1] sel2,
+ *         float dist_threshold=2.5,
+ *         float angle_threshold=120,             # <<<<<<<<<<<<<<
+ *         bool intra=False,
+ *         bool ignore_hs=False,
  */
-  __pyx_t_4 = PyFloat_FromDouble(((float)30.0)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 93, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_7 = PyFloat_FromDouble(((float)120.0)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 33, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
 
-  /* "moleculekit/interactions/pipi/pipi.pyx":94
- *         float dist_threshold1=4.4,
- *         float angle_threshold1_max=30,
- *         float dist_threshold2=5.5,             # <<<<<<<<<<<<<<
- *         float angle_threshold2_min=60,
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":34
+ *         float dist_threshold=2.5,
+ *         float angle_threshold=120,
+ *         bool intra=False,             # <<<<<<<<<<<<<<
+ *         bool ignore_hs=False,
  *     ):
  */
-  __pyx_t_5 = PyFloat_FromDouble(((double)5.5)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 94, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyBool_FromLong(((int)0)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 34, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
 
-  /* "moleculekit/interactions/pipi/pipi.pyx":95
- *         float angle_threshold1_max=30,
- *         float dist_threshold2=5.5,
- *         float angle_threshold2_min=60,             # <<<<<<<<<<<<<<
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":35
+ *         float angle_threshold=120,
+ *         bool intra=False,
+ *         bool ignore_hs=False,             # <<<<<<<<<<<<<<
  *     ):
- *     cdef int r1, r2, f, i
+ *     cdef int d, a, f, i
  */
-  __pyx_t_9 = PyFloat_FromDouble(((float)60.0)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 95, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyBool_FromLong(((int)0)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 35, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
 
-  /* "moleculekit/interactions/pipi/pipi.pyx":84
- * 
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":23
  * 
+ * import cython
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def calculate(
  */
-  __pyx_t_10 = PyTuple_New(4); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 84, __pyx_L1_error)
+  __pyx_t_10 = PyTuple_New(4); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 23, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  __Pyx_GIVEREF(__pyx_t_7);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_7)) __PYX_ERR(0, 84, __pyx_L1_error);
   __Pyx_GIVEREF(__pyx_t_4);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_10, 1, __pyx_t_4)) __PYX_ERR(0, 84, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_4)) __PYX_ERR(0, 23, __pyx_L1_error);
+  __Pyx_GIVEREF(__pyx_t_7);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_10, 1, __pyx_t_7)) __PYX_ERR(0, 23, __pyx_L1_error);
   __Pyx_GIVEREF(__pyx_t_5);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_10, 2, __pyx_t_5)) __PYX_ERR(0, 84, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_10, 2, __pyx_t_5)) __PYX_ERR(0, 23, __pyx_L1_error);
   __Pyx_GIVEREF(__pyx_t_9);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_10, 3, __pyx_t_9)) __PYX_ERR(0, 84, __pyx_L1_error);
-  __pyx_t_7 = 0;
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_10, 3, __pyx_t_9)) __PYX_ERR(0, 23, __pyx_L1_error);
   __pyx_t_4 = 0;
+  __pyx_t_7 = 0;
   __pyx_t_5 = 0;
   __pyx_t_9 = 0;
-  __pyx_t_9 = __Pyx_CyFunction_New(&__pyx_mdef_11moleculekit_12interactions_4pipi_1calculate, 0, __pyx_n_s_calculate, NULL, __pyx_n_s_moleculekit_interactions_pipi, __pyx_d, ((PyObject *)__pyx_codeobj__24)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 84, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_CyFunction_New(&__pyx_mdef_11moleculekit_12interactions_6hbonds_1calculate, 0, __pyx_n_s_calculate, NULL, __pyx_n_s_moleculekit_interactions_hbonds_2, __pyx_d, ((PyObject *)__pyx_codeobj__24)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 23, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_9, __pyx_t_10);
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_calculate, __pyx_t_9) < 0) __PYX_ERR(0, 84, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_calculate, __pyx_t_9) < 0) __PYX_ERR(0, 23, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-  /* "moleculekit/interactions/pipi/pipi.pyx":1
+  /* "moleculekit/interactions/hbonds/hbonds.pyx":1
  * # cython: cdivision=True             # <<<<<<<<<<<<<<
  * 
  * import numpy as np
  */
   __pyx_t_9 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_9) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
@@ -24138,29 +23680,29 @@
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_7);
   __Pyx_XDECREF(__pyx_t_9);
   __Pyx_XDECREF(__pyx_t_10);
   if (__pyx_m) {
     if (__pyx_d && stringtab_initialized) {
-      __Pyx_AddTraceback("init moleculekit.interactions.pipi", __pyx_clineno, __pyx_lineno, __pyx_filename);
+      __Pyx_AddTraceback("init moleculekit.interactions.hbonds", __pyx_clineno, __pyx_lineno, __pyx_filename);
     }
     #if !CYTHON_USE_MODULE_STATE
     Py_CLEAR(__pyx_m);
     #else
     Py_DECREF(__pyx_m);
     if (pystate_addmodule_run) {
       PyObject *tp, *value, *tb;
       PyErr_Fetch(&tp, &value, &tb);
       PyState_RemoveModule(&__pyx_moduledef);
       PyErr_Restore(tp, value, tb);
     }
     #endif
   } else if (!PyErr_Occurred()) {
-    PyErr_SetString(PyExc_ImportError, "init moleculekit.interactions.pipi");
+    PyErr_SetString(PyExc_ImportError, "init moleculekit.interactions.hbonds");
   }
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   return (__pyx_m != NULL) ? 0 : -1;
   #elif PY_MAJOR_VERSION >= 3
   return __pyx_m;
@@ -26619,16 +26161,584 @@
     } else {
         Py_DECREF(r);
         return 1;
     }
 }
 #endif
 
+/* IsLittleEndian */
+static CYTHON_INLINE int __Pyx_Is_Little_Endian(void)
+{
+  union {
+    uint32_t u32;
+    uint8_t u8[4];
+  } S;
+  S.u32 = 0x01020304;
+  return S.u8[0] == 4;
+}
+
+/* BufferFormatCheck */
+static void __Pyx_BufFmt_Init(__Pyx_BufFmt_Context* ctx,
+                              __Pyx_BufFmt_StackElem* stack,
+                              __Pyx_TypeInfo* type) {
+  stack[0].field = &ctx->root;
+  stack[0].parent_offset = 0;
+  ctx->root.type = type;
+  ctx->root.name = "buffer dtype";
+  ctx->root.offset = 0;
+  ctx->head = stack;
+  ctx->head->field = &ctx->root;
+  ctx->fmt_offset = 0;
+  ctx->head->parent_offset = 0;
+  ctx->new_packmode = '@';
+  ctx->enc_packmode = '@';
+  ctx->new_count = 1;
+  ctx->enc_count = 0;
+  ctx->enc_type = 0;
+  ctx->is_complex = 0;
+  ctx->is_valid_array = 0;
+  ctx->struct_alignment = 0;
+  while (type->typegroup == 'S') {
+    ++ctx->head;
+    ctx->head->field = type->fields;
+    ctx->head->parent_offset = 0;
+    type = type->fields->type;
+  }
+}
+static int __Pyx_BufFmt_ParseNumber(const char** ts) {
+    int count;
+    const char* t = *ts;
+    if (*t < '0' || *t > '9') {
+      return -1;
+    } else {
+        count = *t++ - '0';
+        while (*t >= '0' && *t <= '9') {
+            count *= 10;
+            count += *t++ - '0';
+        }
+    }
+    *ts = t;
+    return count;
+}
+static int __Pyx_BufFmt_ExpectNumber(const char **ts) {
+    int number = __Pyx_BufFmt_ParseNumber(ts);
+    if (number == -1)
+        PyErr_Format(PyExc_ValueError,\
+                     "Does not understand character buffer dtype format string ('%c')", **ts);
+    return number;
+}
+static void __Pyx_BufFmt_RaiseUnexpectedChar(char ch) {
+  PyErr_Format(PyExc_ValueError,
+               "Unexpected format string character: '%c'", ch);
+}
+static const char* __Pyx_BufFmt_DescribeTypeChar(char ch, int is_complex) {
+  switch (ch) {
+    case '?': return "'bool'";
+    case 'c': return "'char'";
+    case 'b': return "'signed char'";
+    case 'B': return "'unsigned char'";
+    case 'h': return "'short'";
+    case 'H': return "'unsigned short'";
+    case 'i': return "'int'";
+    case 'I': return "'unsigned int'";
+    case 'l': return "'long'";
+    case 'L': return "'unsigned long'";
+    case 'q': return "'long long'";
+    case 'Q': return "'unsigned long long'";
+    case 'f': return (is_complex ? "'complex float'" : "'float'");
+    case 'd': return (is_complex ? "'complex double'" : "'double'");
+    case 'g': return (is_complex ? "'complex long double'" : "'long double'");
+    case 'T': return "a struct";
+    case 'O': return "Python object";
+    case 'P': return "a pointer";
+    case 's': case 'p': return "a string";
+    case 0: return "end";
+    default: return "unparsable format string";
+  }
+}
+static size_t __Pyx_BufFmt_TypeCharToStandardSize(char ch, int is_complex) {
+  switch (ch) {
+    case '?': case 'c': case 'b': case 'B': case 's': case 'p': return 1;
+    case 'h': case 'H': return 2;
+    case 'i': case 'I': case 'l': case 'L': return 4;
+    case 'q': case 'Q': return 8;
+    case 'f': return (is_complex ? 8 : 4);
+    case 'd': return (is_complex ? 16 : 8);
+    case 'g': {
+      PyErr_SetString(PyExc_ValueError, "Python does not define a standard format string size for long double ('g')..");
+      return 0;
+    }
+    case 'O': case 'P': return sizeof(void*);
+    default:
+      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
+      return 0;
+    }
+}
+static size_t __Pyx_BufFmt_TypeCharToNativeSize(char ch, int is_complex) {
+  switch (ch) {
+    case '?': case 'c': case 'b': case 'B': case 's': case 'p': return 1;
+    case 'h': case 'H': return sizeof(short);
+    case 'i': case 'I': return sizeof(int);
+    case 'l': case 'L': return sizeof(long);
+    #ifdef HAVE_LONG_LONG
+    case 'q': case 'Q': return sizeof(PY_LONG_LONG);
+    #endif
+    case 'f': return sizeof(float) * (is_complex ? 2 : 1);
+    case 'd': return sizeof(double) * (is_complex ? 2 : 1);
+    case 'g': return sizeof(long double) * (is_complex ? 2 : 1);
+    case 'O': case 'P': return sizeof(void*);
+    default: {
+      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
+      return 0;
+    }
+  }
+}
+typedef struct { char c; short x; } __Pyx_st_short;
+typedef struct { char c; int x; } __Pyx_st_int;
+typedef struct { char c; long x; } __Pyx_st_long;
+typedef struct { char c; float x; } __Pyx_st_float;
+typedef struct { char c; double x; } __Pyx_st_double;
+typedef struct { char c; long double x; } __Pyx_st_longdouble;
+typedef struct { char c; void *x; } __Pyx_st_void_p;
+#ifdef HAVE_LONG_LONG
+typedef struct { char c; PY_LONG_LONG x; } __Pyx_st_longlong;
+#endif
+static size_t __Pyx_BufFmt_TypeCharToAlignment(char ch, int is_complex) {
+  CYTHON_UNUSED_VAR(is_complex);
+  switch (ch) {
+    case '?': case 'c': case 'b': case 'B': case 's': case 'p': return 1;
+    case 'h': case 'H': return sizeof(__Pyx_st_short) - sizeof(short);
+    case 'i': case 'I': return sizeof(__Pyx_st_int) - sizeof(int);
+    case 'l': case 'L': return sizeof(__Pyx_st_long) - sizeof(long);
+#ifdef HAVE_LONG_LONG
+    case 'q': case 'Q': return sizeof(__Pyx_st_longlong) - sizeof(PY_LONG_LONG);
+#endif
+    case 'f': return sizeof(__Pyx_st_float) - sizeof(float);
+    case 'd': return sizeof(__Pyx_st_double) - sizeof(double);
+    case 'g': return sizeof(__Pyx_st_longdouble) - sizeof(long double);
+    case 'P': case 'O': return sizeof(__Pyx_st_void_p) - sizeof(void*);
+    default:
+      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
+      return 0;
+    }
+}
+/* These are for computing the padding at the end of the struct to align
+   on the first member of the struct. This will probably the same as above,
+   but we don't have any guarantees.
+ */
+typedef struct { short x; char c; } __Pyx_pad_short;
+typedef struct { int x; char c; } __Pyx_pad_int;
+typedef struct { long x; char c; } __Pyx_pad_long;
+typedef struct { float x; char c; } __Pyx_pad_float;
+typedef struct { double x; char c; } __Pyx_pad_double;
+typedef struct { long double x; char c; } __Pyx_pad_longdouble;
+typedef struct { void *x; char c; } __Pyx_pad_void_p;
+#ifdef HAVE_LONG_LONG
+typedef struct { PY_LONG_LONG x; char c; } __Pyx_pad_longlong;
+#endif
+static size_t __Pyx_BufFmt_TypeCharToPadding(char ch, int is_complex) {
+  CYTHON_UNUSED_VAR(is_complex);
+  switch (ch) {
+    case '?': case 'c': case 'b': case 'B': case 's': case 'p': return 1;
+    case 'h': case 'H': return sizeof(__Pyx_pad_short) - sizeof(short);
+    case 'i': case 'I': return sizeof(__Pyx_pad_int) - sizeof(int);
+    case 'l': case 'L': return sizeof(__Pyx_pad_long) - sizeof(long);
+#ifdef HAVE_LONG_LONG
+    case 'q': case 'Q': return sizeof(__Pyx_pad_longlong) - sizeof(PY_LONG_LONG);
+#endif
+    case 'f': return sizeof(__Pyx_pad_float) - sizeof(float);
+    case 'd': return sizeof(__Pyx_pad_double) - sizeof(double);
+    case 'g': return sizeof(__Pyx_pad_longdouble) - sizeof(long double);
+    case 'P': case 'O': return sizeof(__Pyx_pad_void_p) - sizeof(void*);
+    default:
+      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
+      return 0;
+    }
+}
+static char __Pyx_BufFmt_TypeCharToGroup(char ch, int is_complex) {
+  switch (ch) {
+    case 'c':
+        return 'H';
+    case 'b': case 'h': case 'i':
+    case 'l': case 'q': case 's': case 'p':
+        return 'I';
+    case '?': case 'B': case 'H': case 'I': case 'L': case 'Q':
+        return 'U';
+    case 'f': case 'd': case 'g':
+        return (is_complex ? 'C' : 'R');
+    case 'O':
+        return 'O';
+    case 'P':
+        return 'P';
+    default: {
+      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
+      return 0;
+    }
+  }
+}
+static void __Pyx_BufFmt_RaiseExpected(__Pyx_BufFmt_Context* ctx) {
+  if (ctx->head == NULL || ctx->head->field == &ctx->root) {
+    const char* expected;
+    const char* quote;
+    if (ctx->head == NULL) {
+      expected = "end";
+      quote = "";
+    } else {
+      expected = ctx->head->field->type->name;
+      quote = "'";
+    }
+    PyErr_Format(PyExc_ValueError,
+                 "Buffer dtype mismatch, expected %s%s%s but got %s",
+                 quote, expected, quote,
+                 __Pyx_BufFmt_DescribeTypeChar(ctx->enc_type, ctx->is_complex));
+  } else {
+    __Pyx_StructField* field = ctx->head->field;
+    __Pyx_StructField* parent = (ctx->head - 1)->field;
+    PyErr_Format(PyExc_ValueError,
+                 "Buffer dtype mismatch, expected '%s' but got %s in '%s.%s'",
+                 field->type->name, __Pyx_BufFmt_DescribeTypeChar(ctx->enc_type, ctx->is_complex),
+                 parent->type->name, field->name);
+  }
+}
+static int __Pyx_BufFmt_ProcessTypeChunk(__Pyx_BufFmt_Context* ctx) {
+  char group;
+  size_t size, offset, arraysize = 1;
+  if (ctx->enc_type == 0) return 0;
+  if (ctx->head->field->type->arraysize[0]) {
+    int i, ndim = 0;
+    if (ctx->enc_type == 's' || ctx->enc_type == 'p') {
+        ctx->is_valid_array = ctx->head->field->type->ndim == 1;
+        ndim = 1;
+        if (ctx->enc_count != ctx->head->field->type->arraysize[0]) {
+            PyErr_Format(PyExc_ValueError,
+                         "Expected a dimension of size %zu, got %zu",
+                         ctx->head->field->type->arraysize[0], ctx->enc_count);
+            return -1;
+        }
+    }
+    if (!ctx->is_valid_array) {
+      PyErr_Format(PyExc_ValueError, "Expected %d dimensions, got %d",
+                   ctx->head->field->type->ndim, ndim);
+      return -1;
+    }
+    for (i = 0; i < ctx->head->field->type->ndim; i++) {
+      arraysize *= ctx->head->field->type->arraysize[i];
+    }
+    ctx->is_valid_array = 0;
+    ctx->enc_count = 1;
+  }
+  group = __Pyx_BufFmt_TypeCharToGroup(ctx->enc_type, ctx->is_complex);
+  do {
+    __Pyx_StructField* field = ctx->head->field;
+    __Pyx_TypeInfo* type = field->type;
+    if (ctx->enc_packmode == '@' || ctx->enc_packmode == '^') {
+      size = __Pyx_BufFmt_TypeCharToNativeSize(ctx->enc_type, ctx->is_complex);
+    } else {
+      size = __Pyx_BufFmt_TypeCharToStandardSize(ctx->enc_type, ctx->is_complex);
+    }
+    if (ctx->enc_packmode == '@') {
+      size_t align_at = __Pyx_BufFmt_TypeCharToAlignment(ctx->enc_type, ctx->is_complex);
+      size_t align_mod_offset;
+      if (align_at == 0) return -1;
+      align_mod_offset = ctx->fmt_offset % align_at;
+      if (align_mod_offset > 0) ctx->fmt_offset += align_at - align_mod_offset;
+      if (ctx->struct_alignment == 0)
+          ctx->struct_alignment = __Pyx_BufFmt_TypeCharToPadding(ctx->enc_type,
+                                                                 ctx->is_complex);
+    }
+    if (type->size != size || type->typegroup != group) {
+      if (type->typegroup == 'C' && type->fields != NULL) {
+        size_t parent_offset = ctx->head->parent_offset + field->offset;
+        ++ctx->head;
+        ctx->head->field = type->fields;
+        ctx->head->parent_offset = parent_offset;
+        continue;
+      }
+      if ((type->typegroup == 'H' || group == 'H') && type->size == size) {
+      } else {
+          __Pyx_BufFmt_RaiseExpected(ctx);
+          return -1;
+      }
+    }
+    offset = ctx->head->parent_offset + field->offset;
+    if (ctx->fmt_offset != offset) {
+      PyErr_Format(PyExc_ValueError,
+                   "Buffer dtype mismatch; next field is at offset %" CYTHON_FORMAT_SSIZE_T "d but %" CYTHON_FORMAT_SSIZE_T "d expected",
+                   (Py_ssize_t)ctx->fmt_offset, (Py_ssize_t)offset);
+      return -1;
+    }
+    ctx->fmt_offset += size;
+    if (arraysize)
+      ctx->fmt_offset += (arraysize - 1) * size;
+    --ctx->enc_count;
+    while (1) {
+      if (field == &ctx->root) {
+        ctx->head = NULL;
+        if (ctx->enc_count != 0) {
+          __Pyx_BufFmt_RaiseExpected(ctx);
+          return -1;
+        }
+        break;
+      }
+      ctx->head->field = ++field;
+      if (field->type == NULL) {
+        --ctx->head;
+        field = ctx->head->field;
+        continue;
+      } else if (field->type->typegroup == 'S') {
+        size_t parent_offset = ctx->head->parent_offset + field->offset;
+        if (field->type->fields->type == NULL) continue;
+        field = field->type->fields;
+        ++ctx->head;
+        ctx->head->field = field;
+        ctx->head->parent_offset = parent_offset;
+        break;
+      } else {
+        break;
+      }
+    }
+  } while (ctx->enc_count);
+  ctx->enc_type = 0;
+  ctx->is_complex = 0;
+  return 0;
+}
+static int
+__pyx_buffmt_parse_array(__Pyx_BufFmt_Context* ctx, const char** tsp)
+{
+    const char *ts = *tsp;
+    int i = 0, number, ndim;
+    ++ts;
+    if (ctx->new_count != 1) {
+        PyErr_SetString(PyExc_ValueError,
+                        "Cannot handle repeated arrays in format string");
+        return -1;
+    }
+    if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return -1;
+    ndim = ctx->head->field->type->ndim;
+    while (*ts && *ts != ')') {
+        switch (*ts) {
+            case ' ': case '\f': case '\r': case '\n': case '\t': case '\v':  continue;
+            default:  break;
+        }
+        number = __Pyx_BufFmt_ExpectNumber(&ts);
+        if (number == -1) return -1;
+        if (i < ndim && (size_t) number != ctx->head->field->type->arraysize[i]) {
+            PyErr_Format(PyExc_ValueError,
+                        "Expected a dimension of size %zu, got %d",
+                        ctx->head->field->type->arraysize[i], number);
+            return -1;
+        }
+        if (*ts != ',' && *ts != ')') {
+            PyErr_Format(PyExc_ValueError,
+                                "Expected a comma in format string, got '%c'", *ts);
+            return -1;
+        }
+        if (*ts == ',') ts++;
+        i++;
+    }
+    if (i != ndim) {
+        PyErr_Format(PyExc_ValueError, "Expected %d dimension(s), got %d",
+                            ctx->head->field->type->ndim, i);
+        return -1;
+    }
+    if (!*ts) {
+        PyErr_SetString(PyExc_ValueError,
+                        "Unexpected end of format string, expected ')'");
+        return -1;
+    }
+    ctx->is_valid_array = 1;
+    ctx->new_count = 1;
+    *tsp = ++ts;
+    return 0;
+}
+static const char* __Pyx_BufFmt_CheckString(__Pyx_BufFmt_Context* ctx, const char* ts) {
+  int got_Z = 0;
+  while (1) {
+    switch(*ts) {
+      case 0:
+        if (ctx->enc_type != 0 && ctx->head == NULL) {
+          __Pyx_BufFmt_RaiseExpected(ctx);
+          return NULL;
+        }
+        if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
+        if (ctx->head != NULL) {
+          __Pyx_BufFmt_RaiseExpected(ctx);
+          return NULL;
+        }
+        return ts;
+      case ' ':
+      case '\r':
+      case '\n':
+        ++ts;
+        break;
+      case '<':
+        if (!__Pyx_Is_Little_Endian()) {
+          PyErr_SetString(PyExc_ValueError, "Little-endian buffer not supported on big-endian compiler");
+          return NULL;
+        }
+        ctx->new_packmode = '=';
+        ++ts;
+        break;
+      case '>':
+      case '!':
+        if (__Pyx_Is_Little_Endian()) {
+          PyErr_SetString(PyExc_ValueError, "Big-endian buffer not supported on little-endian compiler");
+          return NULL;
+        }
+        ctx->new_packmode = '=';
+        ++ts;
+        break;
+      case '=':
+      case '@':
+      case '^':
+        ctx->new_packmode = *ts++;
+        break;
+      case 'T':
+        {
+          const char* ts_after_sub;
+          size_t i, struct_count = ctx->new_count;
+          size_t struct_alignment = ctx->struct_alignment;
+          ctx->new_count = 1;
+          ++ts;
+          if (*ts != '{') {
+            PyErr_SetString(PyExc_ValueError, "Buffer acquisition: Expected '{' after 'T'");
+            return NULL;
+          }
+          if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
+          ctx->enc_type = 0;
+          ctx->enc_count = 0;
+          ctx->struct_alignment = 0;
+          ++ts;
+          ts_after_sub = ts;
+          for (i = 0; i != struct_count; ++i) {
+            ts_after_sub = __Pyx_BufFmt_CheckString(ctx, ts);
+            if (!ts_after_sub) return NULL;
+          }
+          ts = ts_after_sub;
+          if (struct_alignment) ctx->struct_alignment = struct_alignment;
+        }
+        break;
+      case '}':
+        {
+          size_t alignment = ctx->struct_alignment;
+          ++ts;
+          if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
+          ctx->enc_type = 0;
+          if (alignment && ctx->fmt_offset % alignment) {
+            ctx->fmt_offset += alignment - (ctx->fmt_offset % alignment);
+          }
+        }
+        return ts;
+      case 'x':
+        if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
+        ctx->fmt_offset += ctx->new_count;
+        ctx->new_count = 1;
+        ctx->enc_count = 0;
+        ctx->enc_type = 0;
+        ctx->enc_packmode = ctx->new_packmode;
+        ++ts;
+        break;
+      case 'Z':
+        got_Z = 1;
+        ++ts;
+        if (*ts != 'f' && *ts != 'd' && *ts != 'g') {
+          __Pyx_BufFmt_RaiseUnexpectedChar('Z');
+          return NULL;
+        }
+        CYTHON_FALLTHROUGH;
+      case '?': case 'c': case 'b': case 'B': case 'h': case 'H': case 'i': case 'I':
+      case 'l': case 'L': case 'q': case 'Q':
+      case 'f': case 'd': case 'g':
+      case 'O': case 'p':
+        if ((ctx->enc_type == *ts) && (got_Z == ctx->is_complex) &&
+            (ctx->enc_packmode == ctx->new_packmode) && (!ctx->is_valid_array)) {
+          ctx->enc_count += ctx->new_count;
+          ctx->new_count = 1;
+          got_Z = 0;
+          ++ts;
+          break;
+        }
+        CYTHON_FALLTHROUGH;
+      case 's':
+        if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
+        ctx->enc_count = ctx->new_count;
+        ctx->enc_packmode = ctx->new_packmode;
+        ctx->enc_type = *ts;
+        ctx->is_complex = got_Z;
+        ++ts;
+        ctx->new_count = 1;
+        got_Z = 0;
+        break;
+      case ':':
+        ++ts;
+        while(*ts != ':') ++ts;
+        ++ts;
+        break;
+      case '(':
+        if (__pyx_buffmt_parse_array(ctx, &ts) < 0) return NULL;
+        break;
+      default:
+        {
+          int number = __Pyx_BufFmt_ExpectNumber(&ts);
+          if (number == -1) return NULL;
+          ctx->new_count = (size_t)number;
+        }
+    }
+  }
+}
+
+/* BufferGetAndValidate */
+  static CYTHON_INLINE void __Pyx_SafeReleaseBuffer(Py_buffer* info) {
+  if (unlikely(info->buf == NULL)) return;
+  if (info->suboffsets == __Pyx_minusones) info->suboffsets = NULL;
+  __Pyx_ReleaseBuffer(info);
+}
+static void __Pyx_ZeroBuffer(Py_buffer* buf) {
+  buf->buf = NULL;
+  buf->obj = NULL;
+  buf->strides = __Pyx_zeros;
+  buf->shape = __Pyx_zeros;
+  buf->suboffsets = __Pyx_minusones;
+}
+static int __Pyx__GetBufferAndValidate(
+        Py_buffer* buf, PyObject* obj,  __Pyx_TypeInfo* dtype, int flags,
+        int nd, int cast, __Pyx_BufFmt_StackElem* stack)
+{
+  buf->buf = NULL;
+  if (unlikely(__Pyx_GetBuffer(obj, buf, flags) == -1)) {
+    __Pyx_ZeroBuffer(buf);
+    return -1;
+  }
+  if (unlikely(buf->ndim != nd)) {
+    PyErr_Format(PyExc_ValueError,
+                 "Buffer has wrong number of dimensions (expected %d, got %d)",
+                 nd, buf->ndim);
+    goto fail;
+  }
+  if (!cast) {
+    __Pyx_BufFmt_Context ctx;
+    __Pyx_BufFmt_Init(&ctx, stack, dtype);
+    if (!__Pyx_BufFmt_CheckString(&ctx, buf->format)) goto fail;
+  }
+  if (unlikely((size_t)buf->itemsize != dtype->size)) {
+    PyErr_Format(PyExc_ValueError,
+      "Item size of buffer (%" CYTHON_FORMAT_SSIZE_T "d byte%s) does not match size of '%s' (%" CYTHON_FORMAT_SSIZE_T "d byte%s)",
+      buf->itemsize, (buf->itemsize > 1) ? "s" : "",
+      dtype->name, (Py_ssize_t)dtype->size, (dtype->size > 1) ? "s" : "");
+    goto fail;
+  }
+  if (buf->suboffsets == NULL) buf->suboffsets = __Pyx_minusones;
+  return 0;
+fail:;
+  __Pyx_SafeReleaseBuffer(buf);
+  return -1;
+}
+
 /* PyObject_GenericGetAttrNoDict */
-#if CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP && PY_VERSION_HEX < 0x03070000
+  #if CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP && PY_VERSION_HEX < 0x03070000
 static PyObject *__Pyx_RaiseGenericGetAttributeError(PyTypeObject *tp, PyObject *attr_name) {
     __Pyx_TypeName type_name = __Pyx_PyType_GetName(tp);
     PyErr_Format(PyExc_AttributeError,
 #if PY_MAJOR_VERSION >= 3
                  "'" __Pyx_FMT_TYPENAME "' object has no attribute '%U'",
                  type_name, attr_name);
 #else
@@ -26662,25 +26772,25 @@
         }
     }
     return descr;
 }
 #endif
 
 /* PyObject_GenericGetAttr */
-#if CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP && PY_VERSION_HEX < 0x03070000
+  #if CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP && PY_VERSION_HEX < 0x03070000
 static PyObject* __Pyx_PyObject_GenericGetAttr(PyObject* obj, PyObject* attr_name) {
     if (unlikely(Py_TYPE(obj)->tp_dictoffset)) {
         return PyObject_GenericGetAttr(obj, attr_name);
     }
     return __Pyx_PyObject_GenericGetAttrNoDict(obj, attr_name);
 }
 #endif
 
 /* FixUpExtensionType */
-#if CYTHON_USE_TYPE_SPECS
+  #if CYTHON_USE_TYPE_SPECS
 static int __Pyx_fix_up_extension_type_from_spec(PyType_Spec *spec, PyTypeObject *type) {
 #if PY_VERSION_HEX > 0x030900B1 || CYTHON_COMPILING_IN_LIMITED_API
     CYTHON_UNUSED_VAR(spec);
     CYTHON_UNUSED_VAR(type);
 #else
     const PyType_Slot *slot = spec->slots;
     while (slot && slot->slot && slot->slot != Py_tp_members)
@@ -26745,21 +26855,21 @@
     }
 #endif
     return 0;
 }
 #endif
 
 /* PyObjectCallNoArg */
-static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func) {
+  static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func) {
     PyObject *arg[2] = {NULL, NULL};
     return __Pyx_PyObject_FastCall(func, arg + 1, 0 | __Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET);
 }
 
 /* PyObjectGetMethod */
-static int __Pyx_PyObject_GetMethod(PyObject *obj, PyObject *name, PyObject **method) {
+  static int __Pyx_PyObject_GetMethod(PyObject *obj, PyObject *name, PyObject **method) {
     PyObject *attr;
 #if CYTHON_UNPACK_METHODS && CYTHON_COMPILING_IN_CPYTHON && CYTHON_USE_PYTYPE_LOOKUP
     __Pyx_TypeName type_name;
     PyTypeObject *tp = Py_TYPE(obj);
     PyObject *descr;
     descrgetfunc f = NULL;
     PyObject **dictptr, *dict;
@@ -26852,15 +26962,15 @@
     }
 #endif
     *method = attr;
     return 0;
 }
 
 /* PyObjectCallMethod0 */
-static PyObject* __Pyx_PyObject_CallMethod0(PyObject* obj, PyObject* method_name) {
+  static PyObject* __Pyx_PyObject_CallMethod0(PyObject* obj, PyObject* method_name) {
     PyObject *method = NULL, *result = NULL;
     int is_method = __Pyx_PyObject_GetMethod(obj, method_name, &method);
     if (likely(is_method)) {
         result = __Pyx_PyObject_CallOneArg(method, obj);
         Py_DECREF(method);
         return result;
     }
@@ -26868,15 +26978,15 @@
     result = __Pyx_PyObject_CallNoArg(method);
     Py_DECREF(method);
 bad:
     return result;
 }
 
 /* ValidateBasesTuple */
-#if CYTHON_COMPILING_IN_CPYTHON || CYTHON_COMPILING_IN_LIMITED_API || CYTHON_USE_TYPE_SPECS
+  #if CYTHON_COMPILING_IN_CPYTHON || CYTHON_COMPILING_IN_LIMITED_API || CYTHON_USE_TYPE_SPECS
 static int __Pyx_validate_bases_tuple(const char *type_name, Py_ssize_t dictoffset, PyObject *bases) {
     Py_ssize_t i, n;
 #if CYTHON_ASSUME_SAFE_MACROS
     n = PyTuple_GET_SIZE(bases);
 #else
     n = PyTuple_Size(bases);
     if (n < 0) return -1;
@@ -26953,15 +27063,15 @@
 #endif
     }
     return 0;
 }
 #endif
 
 /* PyType_Ready */
-static int __Pyx_PyType_Ready(PyTypeObject *t) {
+  static int __Pyx_PyType_Ready(PyTypeObject *t) {
 #if CYTHON_USE_TYPE_SPECS || !(CYTHON_COMPILING_IN_CPYTHON || CYTHON_COMPILING_IN_LIMITED_API) || defined(PYSTON_MAJOR_VERSION)
     (void)__Pyx_PyObject_CallMethod0;
 #if CYTHON_USE_TYPE_SPECS
     (void)__Pyx_validate_bases_tuple;
 #endif
     return PyType_Ready(t);
 #else
@@ -27035,15 +27145,15 @@
     }
 #endif
     return r;
 #endif
 }
 
 /* SetVTable */
-static int __Pyx_SetVtable(PyTypeObject *type, void *vtable) {
+  static int __Pyx_SetVtable(PyTypeObject *type, void *vtable) {
     PyObject *ob = PyCapsule_New(vtable, 0, 0);
     if (unlikely(!ob))
         goto bad;
 #if CYTHON_COMPILING_IN_LIMITED_API
     if (unlikely(PyObject_SetAttr((PyObject *) type, __pyx_n_s_pyx_vtable, ob) < 0))
 #else
     if (unlikely(PyDict_SetItem(type->tp_dict, __pyx_n_s_pyx_vtable, ob) < 0))
@@ -27053,15 +27163,15 @@
     return 0;
 bad:
     Py_XDECREF(ob);
     return -1;
 }
 
 /* GetVTable */
-static void* __Pyx_GetVtable(PyTypeObject *type) {
+  static void* __Pyx_GetVtable(PyTypeObject *type) {
     void* ptr;
 #if CYTHON_COMPILING_IN_LIMITED_API
     PyObject *ob = PyObject_GetAttr((PyObject *)type, __pyx_n_s_pyx_vtable);
 #else
     PyObject *ob = PyObject_GetItem(type->tp_dict, __pyx_n_s_pyx_vtable);
 #endif
     if (!ob)
@@ -27073,15 +27183,15 @@
     return ptr;
 bad:
     Py_XDECREF(ob);
     return NULL;
 }
 
 /* MergeVTables */
-#if !CYTHON_COMPILING_IN_LIMITED_API
+  #if !CYTHON_COMPILING_IN_LIMITED_API
 static int __Pyx_MergeVtables(PyTypeObject *type) {
     int i;
     void** base_vtables;
     __Pyx_TypeName tp_base_name;
     __Pyx_TypeName base_name;
     void* unknown = (void*)-1;
     PyObject* bases = type->tp_bases;
@@ -27126,15 +27236,15 @@
     __Pyx_DECREF_TypeName(base_name);
     free(base_vtables);
     return -1;
 }
 #endif
 
 /* SetupReduce */
-#if !CYTHON_COMPILING_IN_LIMITED_API
+  #if !CYTHON_COMPILING_IN_LIMITED_API
 static int __Pyx_setup_reduce_is_named(PyObject* meth, PyObject* name) {
   int ret;
   PyObject *name_attr;
   name_attr = __Pyx_PyObject_GetAttrStrNoError(meth, __pyx_n_s_name_2);
   if (likely(name_attr)) {
       ret = PyObject_RichCompareBool(name_attr, name, Py_EQ);
   } else {
@@ -27237,15 +27347,15 @@
     Py_XDECREF(setstate);
     Py_XDECREF(setstate_cython);
     return ret;
 }
 #endif
 
 /* TypeImport */
-#ifndef __PYX_HAVE_RT_ImportType_3_0_5
+  #ifndef __PYX_HAVE_RT_ImportType_3_0_5
 #define __PYX_HAVE_RT_ImportType_3_0_5
 static PyTypeObject *__Pyx_ImportType_3_0_5(PyObject *module, const char *module_name, const char *class_name,
     size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_5 check_size)
 {
     PyObject *result = 0;
     char warning[200];
     Py_ssize_t basicsize;
@@ -27317,20 +27427,20 @@
 bad:
     Py_XDECREF(result);
     return NULL;
 }
 #endif
 
 /* FetchSharedCythonModule */
-static PyObject *__Pyx_FetchSharedCythonABIModule(void) {
+  static PyObject *__Pyx_FetchSharedCythonABIModule(void) {
     return __Pyx_PyImport_AddModuleRef((char*) __PYX_ABI_MODULE_NAME);
 }
 
 /* FetchCommonType */
-static int __Pyx_VerifyCachedType(PyObject *cached_type,
+  static int __Pyx_VerifyCachedType(PyObject *cached_type,
                                const char *name,
                                Py_ssize_t basicsize,
                                Py_ssize_t expected_basicsize) {
     if (!PyType_Check(cached_type)) {
         PyErr_Format(PyExc_TypeError,
             "Shared Cython type %.200s is not a type object", name);
         return -1;
@@ -27423,15 +27533,15 @@
     Py_XDECREF(cached_type);
     cached_type = NULL;
     goto done;
 }
 #endif
 
 /* PyVectorcallFastCallDict */
-#if CYTHON_METH_FASTCALL
+  #if CYTHON_METH_FASTCALL
 static PyObject *__Pyx_PyVectorcall_FastCallDict_kw(PyObject *func, __pyx_vectorcallfunc vc, PyObject *const *args, size_t nargs, PyObject *kw)
 {
     PyObject *res = NULL;
     PyObject *kwnames;
     PyObject **newargs;
     PyObject **kwvalues;
     Py_ssize_t i, pos;
@@ -27479,15 +27589,15 @@
         return vc(func, args, nargs, NULL);
     }
     return __Pyx_PyVectorcall_FastCallDict_kw(func, vc, args, nargs, kw);
 }
 #endif
 
 /* CythonFunctionShared */
-#if CYTHON_COMPILING_IN_LIMITED_API
+  #if CYTHON_COMPILING_IN_LIMITED_API
 static CYTHON_INLINE int __Pyx__IsSameCyOrCFunction(PyObject *func, void *cfunc) {
     if (__Pyx_CyFunction_Check(func)) {
         return PyCFunction_GetFunction(((__pyx_CyFunctionObject*)func)->func) == (PyCFunction) cfunc;
     } else if (PyCFunction_Check(func)) {
         return PyCFunction_GetFunction(func) == (PyCFunction) cfunc;
     }
     return 0;
@@ -28481,28 +28591,28 @@
 static CYTHON_INLINE void __Pyx_CyFunction_SetAnnotationsDict(PyObject *func, PyObject *dict) {
     __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
     m->func_annotations = dict;
     Py_INCREF(dict);
 }
 
 /* CythonFunction */
-static PyObject *__Pyx_CyFunction_New(PyMethodDef *ml, int flags, PyObject* qualname,
+  static PyObject *__Pyx_CyFunction_New(PyMethodDef *ml, int flags, PyObject* qualname,
                                       PyObject *closure, PyObject *module, PyObject* globals, PyObject* code) {
     PyObject *op = __Pyx_CyFunction_Init(
         PyObject_GC_New(__pyx_CyFunctionObject, __pyx_CyFunctionType),
         ml, flags, qualname, closure, module, globals, code
     );
     if (likely(op)) {
         PyObject_GC_Track(op);
     }
     return op;
 }
 
 /* CLineInTraceback */
-#ifndef CYTHON_CLINE_IN_TRACEBACK
+  #ifndef CYTHON_CLINE_IN_TRACEBACK
 static int __Pyx_CLineForTraceback(PyThreadState *tstate, int c_line) {
     PyObject *use_cline;
     PyObject *ptype, *pvalue, *ptraceback;
 #if CYTHON_COMPILING_IN_CPYTHON
     PyObject **cython_runtime_dict;
 #endif
     CYTHON_MAYBE_UNUSED_VAR(tstate);
@@ -28537,15 +28647,15 @@
     }
     __Pyx_ErrRestoreInState(tstate, ptype, pvalue, ptraceback);
     return c_line;
 }
 #endif
 
 /* CodeObjectCache */
-#if !CYTHON_COMPILING_IN_LIMITED_API
+  #if !CYTHON_COMPILING_IN_LIMITED_API
 static int __pyx_bisect_code_objects(__Pyx_CodeObjectCacheEntry* entries, int count, int code_line) {
     int start = 0, mid = 0, end = count - 1;
     if (end >= 0 && code_line > entries[end].code_line) {
         return count;
     }
     while (start < end) {
         mid = start + (end - start) / 2;
@@ -28619,15 +28729,15 @@
     entries[pos].code_object = code_object;
     __pyx_code_cache.count++;
     Py_INCREF(code_object);
 }
 #endif
 
 /* AddTraceback */
-#include "compile.h"
+  #include "compile.h"
 #include "frameobject.h"
 #include "traceback.h"
 #if PY_VERSION_HEX >= 0x030b00a6 && !CYTHON_COMPILING_IN_LIMITED_API
   #ifndef Py_BUILD_CORE
     #define Py_BUILD_CORE 1
   #endif
   #include "internal/pycore_frame.h"
@@ -28837,16 +28947,16 @@
     if ((0)) {}
     view->obj = NULL;
     Py_DECREF(obj);
 }
 #endif
 
 
-/* MemviewSliceIsContig */
-static int
+  /* MemviewSliceIsContig */
+  static int
 __pyx_memviewslice_is_contig(const __Pyx_memviewslice mvs, char order, int ndim)
 {
     int i, index, step, start;
     Py_ssize_t itemsize = mvs.memview->view.itemsize;
     if (order == 'F') {
         step = 1;
         start = 0;
@@ -28860,15 +28970,15 @@
             return 0;
         itemsize *= mvs.shape[index];
     }
     return 1;
 }
 
 /* OverlappingSlices */
-static void
+  static void
 __pyx_get_array_memory_extents(__Pyx_memviewslice *slice,
                                void **out_start, void **out_end,
                                int ndim, size_t itemsize)
 {
     char *start, *end;
     int i;
     start = end = slice->data;
@@ -28895,535 +29005,14 @@
 {
     void *start1, *end1, *start2, *end2;
     __pyx_get_array_memory_extents(slice1, &start1, &end1, ndim, itemsize);
     __pyx_get_array_memory_extents(slice2, &start2, &end2, ndim, itemsize);
     return (start1 < end2) && (start2 < end1);
 }
 
-/* IsLittleEndian */
-static CYTHON_INLINE int __Pyx_Is_Little_Endian(void)
-{
-  union {
-    uint32_t u32;
-    uint8_t u8[4];
-  } S;
-  S.u32 = 0x01020304;
-  return S.u8[0] == 4;
-}
-
-/* BufferFormatCheck */
-static void __Pyx_BufFmt_Init(__Pyx_BufFmt_Context* ctx,
-                              __Pyx_BufFmt_StackElem* stack,
-                              __Pyx_TypeInfo* type) {
-  stack[0].field = &ctx->root;
-  stack[0].parent_offset = 0;
-  ctx->root.type = type;
-  ctx->root.name = "buffer dtype";
-  ctx->root.offset = 0;
-  ctx->head = stack;
-  ctx->head->field = &ctx->root;
-  ctx->fmt_offset = 0;
-  ctx->head->parent_offset = 0;
-  ctx->new_packmode = '@';
-  ctx->enc_packmode = '@';
-  ctx->new_count = 1;
-  ctx->enc_count = 0;
-  ctx->enc_type = 0;
-  ctx->is_complex = 0;
-  ctx->is_valid_array = 0;
-  ctx->struct_alignment = 0;
-  while (type->typegroup == 'S') {
-    ++ctx->head;
-    ctx->head->field = type->fields;
-    ctx->head->parent_offset = 0;
-    type = type->fields->type;
-  }
-}
-static int __Pyx_BufFmt_ParseNumber(const char** ts) {
-    int count;
-    const char* t = *ts;
-    if (*t < '0' || *t > '9') {
-      return -1;
-    } else {
-        count = *t++ - '0';
-        while (*t >= '0' && *t <= '9') {
-            count *= 10;
-            count += *t++ - '0';
-        }
-    }
-    *ts = t;
-    return count;
-}
-static int __Pyx_BufFmt_ExpectNumber(const char **ts) {
-    int number = __Pyx_BufFmt_ParseNumber(ts);
-    if (number == -1)
-        PyErr_Format(PyExc_ValueError,\
-                     "Does not understand character buffer dtype format string ('%c')", **ts);
-    return number;
-}
-static void __Pyx_BufFmt_RaiseUnexpectedChar(char ch) {
-  PyErr_Format(PyExc_ValueError,
-               "Unexpected format string character: '%c'", ch);
-}
-static const char* __Pyx_BufFmt_DescribeTypeChar(char ch, int is_complex) {
-  switch (ch) {
-    case '?': return "'bool'";
-    case 'c': return "'char'";
-    case 'b': return "'signed char'";
-    case 'B': return "'unsigned char'";
-    case 'h': return "'short'";
-    case 'H': return "'unsigned short'";
-    case 'i': return "'int'";
-    case 'I': return "'unsigned int'";
-    case 'l': return "'long'";
-    case 'L': return "'unsigned long'";
-    case 'q': return "'long long'";
-    case 'Q': return "'unsigned long long'";
-    case 'f': return (is_complex ? "'complex float'" : "'float'");
-    case 'd': return (is_complex ? "'complex double'" : "'double'");
-    case 'g': return (is_complex ? "'complex long double'" : "'long double'");
-    case 'T': return "a struct";
-    case 'O': return "Python object";
-    case 'P': return "a pointer";
-    case 's': case 'p': return "a string";
-    case 0: return "end";
-    default: return "unparsable format string";
-  }
-}
-static size_t __Pyx_BufFmt_TypeCharToStandardSize(char ch, int is_complex) {
-  switch (ch) {
-    case '?': case 'c': case 'b': case 'B': case 's': case 'p': return 1;
-    case 'h': case 'H': return 2;
-    case 'i': case 'I': case 'l': case 'L': return 4;
-    case 'q': case 'Q': return 8;
-    case 'f': return (is_complex ? 8 : 4);
-    case 'd': return (is_complex ? 16 : 8);
-    case 'g': {
-      PyErr_SetString(PyExc_ValueError, "Python does not define a standard format string size for long double ('g')..");
-      return 0;
-    }
-    case 'O': case 'P': return sizeof(void*);
-    default:
-      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
-      return 0;
-    }
-}
-static size_t __Pyx_BufFmt_TypeCharToNativeSize(char ch, int is_complex) {
-  switch (ch) {
-    case '?': case 'c': case 'b': case 'B': case 's': case 'p': return 1;
-    case 'h': case 'H': return sizeof(short);
-    case 'i': case 'I': return sizeof(int);
-    case 'l': case 'L': return sizeof(long);
-    #ifdef HAVE_LONG_LONG
-    case 'q': case 'Q': return sizeof(PY_LONG_LONG);
-    #endif
-    case 'f': return sizeof(float) * (is_complex ? 2 : 1);
-    case 'd': return sizeof(double) * (is_complex ? 2 : 1);
-    case 'g': return sizeof(long double) * (is_complex ? 2 : 1);
-    case 'O': case 'P': return sizeof(void*);
-    default: {
-      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
-      return 0;
-    }
-  }
-}
-typedef struct { char c; short x; } __Pyx_st_short;
-typedef struct { char c; int x; } __Pyx_st_int;
-typedef struct { char c; long x; } __Pyx_st_long;
-typedef struct { char c; float x; } __Pyx_st_float;
-typedef struct { char c; double x; } __Pyx_st_double;
-typedef struct { char c; long double x; } __Pyx_st_longdouble;
-typedef struct { char c; void *x; } __Pyx_st_void_p;
-#ifdef HAVE_LONG_LONG
-typedef struct { char c; PY_LONG_LONG x; } __Pyx_st_longlong;
-#endif
-static size_t __Pyx_BufFmt_TypeCharToAlignment(char ch, int is_complex) {
-  CYTHON_UNUSED_VAR(is_complex);
-  switch (ch) {
-    case '?': case 'c': case 'b': case 'B': case 's': case 'p': return 1;
-    case 'h': case 'H': return sizeof(__Pyx_st_short) - sizeof(short);
-    case 'i': case 'I': return sizeof(__Pyx_st_int) - sizeof(int);
-    case 'l': case 'L': return sizeof(__Pyx_st_long) - sizeof(long);
-#ifdef HAVE_LONG_LONG
-    case 'q': case 'Q': return sizeof(__Pyx_st_longlong) - sizeof(PY_LONG_LONG);
-#endif
-    case 'f': return sizeof(__Pyx_st_float) - sizeof(float);
-    case 'd': return sizeof(__Pyx_st_double) - sizeof(double);
-    case 'g': return sizeof(__Pyx_st_longdouble) - sizeof(long double);
-    case 'P': case 'O': return sizeof(__Pyx_st_void_p) - sizeof(void*);
-    default:
-      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
-      return 0;
-    }
-}
-/* These are for computing the padding at the end of the struct to align
-   on the first member of the struct. This will probably the same as above,
-   but we don't have any guarantees.
- */
-typedef struct { short x; char c; } __Pyx_pad_short;
-typedef struct { int x; char c; } __Pyx_pad_int;
-typedef struct { long x; char c; } __Pyx_pad_long;
-typedef struct { float x; char c; } __Pyx_pad_float;
-typedef struct { double x; char c; } __Pyx_pad_double;
-typedef struct { long double x; char c; } __Pyx_pad_longdouble;
-typedef struct { void *x; char c; } __Pyx_pad_void_p;
-#ifdef HAVE_LONG_LONG
-typedef struct { PY_LONG_LONG x; char c; } __Pyx_pad_longlong;
-#endif
-static size_t __Pyx_BufFmt_TypeCharToPadding(char ch, int is_complex) {
-  CYTHON_UNUSED_VAR(is_complex);
-  switch (ch) {
-    case '?': case 'c': case 'b': case 'B': case 's': case 'p': return 1;
-    case 'h': case 'H': return sizeof(__Pyx_pad_short) - sizeof(short);
-    case 'i': case 'I': return sizeof(__Pyx_pad_int) - sizeof(int);
-    case 'l': case 'L': return sizeof(__Pyx_pad_long) - sizeof(long);
-#ifdef HAVE_LONG_LONG
-    case 'q': case 'Q': return sizeof(__Pyx_pad_longlong) - sizeof(PY_LONG_LONG);
-#endif
-    case 'f': return sizeof(__Pyx_pad_float) - sizeof(float);
-    case 'd': return sizeof(__Pyx_pad_double) - sizeof(double);
-    case 'g': return sizeof(__Pyx_pad_longdouble) - sizeof(long double);
-    case 'P': case 'O': return sizeof(__Pyx_pad_void_p) - sizeof(void*);
-    default:
-      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
-      return 0;
-    }
-}
-static char __Pyx_BufFmt_TypeCharToGroup(char ch, int is_complex) {
-  switch (ch) {
-    case 'c':
-        return 'H';
-    case 'b': case 'h': case 'i':
-    case 'l': case 'q': case 's': case 'p':
-        return 'I';
-    case '?': case 'B': case 'H': case 'I': case 'L': case 'Q':
-        return 'U';
-    case 'f': case 'd': case 'g':
-        return (is_complex ? 'C' : 'R');
-    case 'O':
-        return 'O';
-    case 'P':
-        return 'P';
-    default: {
-      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
-      return 0;
-    }
-  }
-}
-static void __Pyx_BufFmt_RaiseExpected(__Pyx_BufFmt_Context* ctx) {
-  if (ctx->head == NULL || ctx->head->field == &ctx->root) {
-    const char* expected;
-    const char* quote;
-    if (ctx->head == NULL) {
-      expected = "end";
-      quote = "";
-    } else {
-      expected = ctx->head->field->type->name;
-      quote = "'";
-    }
-    PyErr_Format(PyExc_ValueError,
-                 "Buffer dtype mismatch, expected %s%s%s but got %s",
-                 quote, expected, quote,
-                 __Pyx_BufFmt_DescribeTypeChar(ctx->enc_type, ctx->is_complex));
-  } else {
-    __Pyx_StructField* field = ctx->head->field;
-    __Pyx_StructField* parent = (ctx->head - 1)->field;
-    PyErr_Format(PyExc_ValueError,
-                 "Buffer dtype mismatch, expected '%s' but got %s in '%s.%s'",
-                 field->type->name, __Pyx_BufFmt_DescribeTypeChar(ctx->enc_type, ctx->is_complex),
-                 parent->type->name, field->name);
-  }
-}
-static int __Pyx_BufFmt_ProcessTypeChunk(__Pyx_BufFmt_Context* ctx) {
-  char group;
-  size_t size, offset, arraysize = 1;
-  if (ctx->enc_type == 0) return 0;
-  if (ctx->head->field->type->arraysize[0]) {
-    int i, ndim = 0;
-    if (ctx->enc_type == 's' || ctx->enc_type == 'p') {
-        ctx->is_valid_array = ctx->head->field->type->ndim == 1;
-        ndim = 1;
-        if (ctx->enc_count != ctx->head->field->type->arraysize[0]) {
-            PyErr_Format(PyExc_ValueError,
-                         "Expected a dimension of size %zu, got %zu",
-                         ctx->head->field->type->arraysize[0], ctx->enc_count);
-            return -1;
-        }
-    }
-    if (!ctx->is_valid_array) {
-      PyErr_Format(PyExc_ValueError, "Expected %d dimensions, got %d",
-                   ctx->head->field->type->ndim, ndim);
-      return -1;
-    }
-    for (i = 0; i < ctx->head->field->type->ndim; i++) {
-      arraysize *= ctx->head->field->type->arraysize[i];
-    }
-    ctx->is_valid_array = 0;
-    ctx->enc_count = 1;
-  }
-  group = __Pyx_BufFmt_TypeCharToGroup(ctx->enc_type, ctx->is_complex);
-  do {
-    __Pyx_StructField* field = ctx->head->field;
-    __Pyx_TypeInfo* type = field->type;
-    if (ctx->enc_packmode == '@' || ctx->enc_packmode == '^') {
-      size = __Pyx_BufFmt_TypeCharToNativeSize(ctx->enc_type, ctx->is_complex);
-    } else {
-      size = __Pyx_BufFmt_TypeCharToStandardSize(ctx->enc_type, ctx->is_complex);
-    }
-    if (ctx->enc_packmode == '@') {
-      size_t align_at = __Pyx_BufFmt_TypeCharToAlignment(ctx->enc_type, ctx->is_complex);
-      size_t align_mod_offset;
-      if (align_at == 0) return -1;
-      align_mod_offset = ctx->fmt_offset % align_at;
-      if (align_mod_offset > 0) ctx->fmt_offset += align_at - align_mod_offset;
-      if (ctx->struct_alignment == 0)
-          ctx->struct_alignment = __Pyx_BufFmt_TypeCharToPadding(ctx->enc_type,
-                                                                 ctx->is_complex);
-    }
-    if (type->size != size || type->typegroup != group) {
-      if (type->typegroup == 'C' && type->fields != NULL) {
-        size_t parent_offset = ctx->head->parent_offset + field->offset;
-        ++ctx->head;
-        ctx->head->field = type->fields;
-        ctx->head->parent_offset = parent_offset;
-        continue;
-      }
-      if ((type->typegroup == 'H' || group == 'H') && type->size == size) {
-      } else {
-          __Pyx_BufFmt_RaiseExpected(ctx);
-          return -1;
-      }
-    }
-    offset = ctx->head->parent_offset + field->offset;
-    if (ctx->fmt_offset != offset) {
-      PyErr_Format(PyExc_ValueError,
-                   "Buffer dtype mismatch; next field is at offset %" CYTHON_FORMAT_SSIZE_T "d but %" CYTHON_FORMAT_SSIZE_T "d expected",
-                   (Py_ssize_t)ctx->fmt_offset, (Py_ssize_t)offset);
-      return -1;
-    }
-    ctx->fmt_offset += size;
-    if (arraysize)
-      ctx->fmt_offset += (arraysize - 1) * size;
-    --ctx->enc_count;
-    while (1) {
-      if (field == &ctx->root) {
-        ctx->head = NULL;
-        if (ctx->enc_count != 0) {
-          __Pyx_BufFmt_RaiseExpected(ctx);
-          return -1;
-        }
-        break;
-      }
-      ctx->head->field = ++field;
-      if (field->type == NULL) {
-        --ctx->head;
-        field = ctx->head->field;
-        continue;
-      } else if (field->type->typegroup == 'S') {
-        size_t parent_offset = ctx->head->parent_offset + field->offset;
-        if (field->type->fields->type == NULL) continue;
-        field = field->type->fields;
-        ++ctx->head;
-        ctx->head->field = field;
-        ctx->head->parent_offset = parent_offset;
-        break;
-      } else {
-        break;
-      }
-    }
-  } while (ctx->enc_count);
-  ctx->enc_type = 0;
-  ctx->is_complex = 0;
-  return 0;
-}
-static int
-__pyx_buffmt_parse_array(__Pyx_BufFmt_Context* ctx, const char** tsp)
-{
-    const char *ts = *tsp;
-    int i = 0, number, ndim;
-    ++ts;
-    if (ctx->new_count != 1) {
-        PyErr_SetString(PyExc_ValueError,
-                        "Cannot handle repeated arrays in format string");
-        return -1;
-    }
-    if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return -1;
-    ndim = ctx->head->field->type->ndim;
-    while (*ts && *ts != ')') {
-        switch (*ts) {
-            case ' ': case '\f': case '\r': case '\n': case '\t': case '\v':  continue;
-            default:  break;
-        }
-        number = __Pyx_BufFmt_ExpectNumber(&ts);
-        if (number == -1) return -1;
-        if (i < ndim && (size_t) number != ctx->head->field->type->arraysize[i]) {
-            PyErr_Format(PyExc_ValueError,
-                        "Expected a dimension of size %zu, got %d",
-                        ctx->head->field->type->arraysize[i], number);
-            return -1;
-        }
-        if (*ts != ',' && *ts != ')') {
-            PyErr_Format(PyExc_ValueError,
-                                "Expected a comma in format string, got '%c'", *ts);
-            return -1;
-        }
-        if (*ts == ',') ts++;
-        i++;
-    }
-    if (i != ndim) {
-        PyErr_Format(PyExc_ValueError, "Expected %d dimension(s), got %d",
-                            ctx->head->field->type->ndim, i);
-        return -1;
-    }
-    if (!*ts) {
-        PyErr_SetString(PyExc_ValueError,
-                        "Unexpected end of format string, expected ')'");
-        return -1;
-    }
-    ctx->is_valid_array = 1;
-    ctx->new_count = 1;
-    *tsp = ++ts;
-    return 0;
-}
-static const char* __Pyx_BufFmt_CheckString(__Pyx_BufFmt_Context* ctx, const char* ts) {
-  int got_Z = 0;
-  while (1) {
-    switch(*ts) {
-      case 0:
-        if (ctx->enc_type != 0 && ctx->head == NULL) {
-          __Pyx_BufFmt_RaiseExpected(ctx);
-          return NULL;
-        }
-        if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
-        if (ctx->head != NULL) {
-          __Pyx_BufFmt_RaiseExpected(ctx);
-          return NULL;
-        }
-        return ts;
-      case ' ':
-      case '\r':
-      case '\n':
-        ++ts;
-        break;
-      case '<':
-        if (!__Pyx_Is_Little_Endian()) {
-          PyErr_SetString(PyExc_ValueError, "Little-endian buffer not supported on big-endian compiler");
-          return NULL;
-        }
-        ctx->new_packmode = '=';
-        ++ts;
-        break;
-      case '>':
-      case '!':
-        if (__Pyx_Is_Little_Endian()) {
-          PyErr_SetString(PyExc_ValueError, "Big-endian buffer not supported on little-endian compiler");
-          return NULL;
-        }
-        ctx->new_packmode = '=';
-        ++ts;
-        break;
-      case '=':
-      case '@':
-      case '^':
-        ctx->new_packmode = *ts++;
-        break;
-      case 'T':
-        {
-          const char* ts_after_sub;
-          size_t i, struct_count = ctx->new_count;
-          size_t struct_alignment = ctx->struct_alignment;
-          ctx->new_count = 1;
-          ++ts;
-          if (*ts != '{') {
-            PyErr_SetString(PyExc_ValueError, "Buffer acquisition: Expected '{' after 'T'");
-            return NULL;
-          }
-          if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
-          ctx->enc_type = 0;
-          ctx->enc_count = 0;
-          ctx->struct_alignment = 0;
-          ++ts;
-          ts_after_sub = ts;
-          for (i = 0; i != struct_count; ++i) {
-            ts_after_sub = __Pyx_BufFmt_CheckString(ctx, ts);
-            if (!ts_after_sub) return NULL;
-          }
-          ts = ts_after_sub;
-          if (struct_alignment) ctx->struct_alignment = struct_alignment;
-        }
-        break;
-      case '}':
-        {
-          size_t alignment = ctx->struct_alignment;
-          ++ts;
-          if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
-          ctx->enc_type = 0;
-          if (alignment && ctx->fmt_offset % alignment) {
-            ctx->fmt_offset += alignment - (ctx->fmt_offset % alignment);
-          }
-        }
-        return ts;
-      case 'x':
-        if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
-        ctx->fmt_offset += ctx->new_count;
-        ctx->new_count = 1;
-        ctx->enc_count = 0;
-        ctx->enc_type = 0;
-        ctx->enc_packmode = ctx->new_packmode;
-        ++ts;
-        break;
-      case 'Z':
-        got_Z = 1;
-        ++ts;
-        if (*ts != 'f' && *ts != 'd' && *ts != 'g') {
-          __Pyx_BufFmt_RaiseUnexpectedChar('Z');
-          return NULL;
-        }
-        CYTHON_FALLTHROUGH;
-      case '?': case 'c': case 'b': case 'B': case 'h': case 'H': case 'i': case 'I':
-      case 'l': case 'L': case 'q': case 'Q':
-      case 'f': case 'd': case 'g':
-      case 'O': case 'p':
-        if ((ctx->enc_type == *ts) && (got_Z == ctx->is_complex) &&
-            (ctx->enc_packmode == ctx->new_packmode) && (!ctx->is_valid_array)) {
-          ctx->enc_count += ctx->new_count;
-          ctx->new_count = 1;
-          got_Z = 0;
-          ++ts;
-          break;
-        }
-        CYTHON_FALLTHROUGH;
-      case 's':
-        if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
-        ctx->enc_count = ctx->new_count;
-        ctx->enc_packmode = ctx->new_packmode;
-        ctx->enc_type = *ts;
-        ctx->is_complex = got_Z;
-        ++ts;
-        ctx->new_count = 1;
-        got_Z = 0;
-        break;
-      case ':':
-        ++ts;
-        while(*ts != ':') ++ts;
-        ++ts;
-        break;
-      case '(':
-        if (__pyx_buffmt_parse_array(ctx, &ts) < 0) return NULL;
-        break;
-      default:
-        {
-          int number = __Pyx_BufFmt_ExpectNumber(&ts);
-          if (number == -1) return NULL;
-          ctx->new_count = (size_t)number;
-        }
-    }
-  }
-}
-
 /* TypeInfoCompare */
   static int
 __pyx_typeinfo_cmp(__Pyx_TypeInfo *a, __Pyx_TypeInfo *b)
 {
     int i;
     if (!a || !b)
         return 0;
@@ -29640,72 +29229,26 @@
     retval = -1;
 no_fail:
     __Pyx_RefNannyFinishContext();
     return retval;
 }
 
 /* ObjectToMemviewSlice */
-  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_UINT32_t(PyObject *obj, int writable_flag) {
+  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t(PyObject *obj, int writable_flag) {
     __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
     __Pyx_BufFmt_StackElem stack[1];
     int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
     int retcode;
     if (obj == Py_None) {
         result.memview = (struct __pyx_memoryview_obj *) Py_None;
         return result;
     }
     retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
                                                  PyBUF_RECORDS_RO | writable_flag, 1,
-                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_4pipi_UINT32_t, stack,
-                                                 &result, obj);
-    if (unlikely(retcode == -1))
-        goto __pyx_fail;
-    return result;
-__pyx_fail:
-    result.memview = NULL;
-    result.data = NULL;
-    return result;
-}
-
-/* ObjectToMemviewSlice */
-  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(PyObject *obj, int writable_flag) {
-    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
-    __Pyx_BufFmt_StackElem stack[1];
-    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
-    int retcode;
-    if (obj == Py_None) {
-        result.memview = (struct __pyx_memoryview_obj *) Py_None;
-        return result;
-    }
-    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
-                                                 PyBUF_RECORDS_RO | writable_flag, 3,
-                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t, stack,
-                                                 &result, obj);
-    if (unlikely(retcode == -1))
-        goto __pyx_fail;
-    return result;
-__pyx_fail:
-    result.memview = NULL;
-    result.data = NULL;
-    return result;
-}
-
-/* ObjectToMemviewSlice */
-  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(PyObject *obj, int writable_flag) {
-    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
-    __Pyx_BufFmt_StackElem stack[1];
-    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
-    int retcode;
-    if (obj == Py_None) {
-        result.memview = (struct __pyx_memoryview_obj *) Py_None;
-        return result;
-    }
-    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
-                                                 PyBUF_RECORDS_RO | writable_flag, 2,
-                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t, stack,
+                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_6hbonds_FLOAT32_t, stack,
                                                  &result, obj);
     if (unlikely(retcode == -1))
         goto __pyx_fail;
     return result;
 __pyx_fail:
     result.memview = NULL;
     result.data = NULL;
@@ -29730,37 +29273,14 @@
                 else\
                     goto raise_overflow;\
             }\
         }\
         return (target_type) value;\
     }
 
-/* ObjectToMemviewSlice */
-  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t(PyObject *obj, int writable_flag) {
-    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
-    __Pyx_BufFmt_StackElem stack[1];
-    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
-    int retcode;
-    if (obj == Py_None) {
-        result.memview = (struct __pyx_memoryview_obj *) Py_None;
-        return result;
-    }
-    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
-                                                 PyBUF_RECORDS_RO | writable_flag, 1,
-                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_12interactions_4pipi_FLOAT32_t, stack,
-                                                 &result, obj);
-    if (unlikely(retcode == -1))
-        goto __pyx_fail;
-    return result;
-__pyx_fail:
-    result.memview = NULL;
-    result.data = NULL;
-    return result;
-}
-
 /* Declarations */
   #if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
   #ifdef __cplusplus
     static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float x, float y) {
       return ::std::complex< float >(x, y);
     }
   #else
@@ -30263,174 +29783,238 @@
         }
     } else {
         __pyx_fatalerror("Acquisition count is %d (line %d)",
                          old_acquisition_count-1, lineno);
     }
 }
 
+/* CIntToPy */
+  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wconversion"
+#endif
+    const int neg_one = (int) -1, const_zero = (int) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic pop
+#endif
+    const int is_unsigned = neg_one > const_zero;
+    if (is_unsigned) {
+        if (sizeof(int) < sizeof(long)) {
+            return PyInt_FromLong((long) value);
+        } else if (sizeof(int) <= sizeof(unsigned long)) {
+            return PyLong_FromUnsignedLong((unsigned long) value);
+#ifdef HAVE_LONG_LONG
+        } else if (sizeof(int) <= sizeof(unsigned PY_LONG_LONG)) {
+            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
+#endif
+        }
+    } else {
+        if (sizeof(int) <= sizeof(long)) {
+            return PyInt_FromLong((long) value);
+#ifdef HAVE_LONG_LONG
+        } else if (sizeof(int) <= sizeof(PY_LONG_LONG)) {
+            return PyLong_FromLongLong((PY_LONG_LONG) value);
+#endif
+        }
+    }
+    {
+        int one = 1; int little = (int)*(unsigned char *)&one;
+        unsigned char *bytes = (unsigned char *)&value;
+#if !CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030d0000
+        return _PyLong_FromByteArray(bytes, sizeof(int),
+                                     little, !is_unsigned);
+#else
+        PyObject *from_bytes, *result = NULL;
+        PyObject *py_bytes = NULL, *arg_tuple = NULL, *kwds = NULL, *order_str = NULL;
+        from_bytes = PyObject_GetAttrString((PyObject*)&PyLong_Type, "from_bytes");
+        if (!from_bytes) return NULL;
+        py_bytes = PyBytes_FromStringAndSize((char*)bytes, sizeof(int));
+        if (!py_bytes) goto limited_bad;
+        order_str = PyUnicode_FromString(little ? "little" : "big");
+        if (!order_str) goto limited_bad;
+        arg_tuple = PyTuple_Pack(2, py_bytes, order_str);
+        if (!arg_tuple) goto limited_bad;
+        if (!is_unsigned) {
+            kwds = PyDict_New();
+            if (!kwds) goto limited_bad;
+            if (PyDict_SetItemString(kwds, "signed", __Pyx_NewRef(Py_True))) goto limited_bad;
+        }
+        result = PyObject_Call(from_bytes, arg_tuple, kwds);
+        limited_bad:
+        Py_XDECREF(kwds);
+        Py_XDECREF(arg_tuple);
+        Py_XDECREF(order_str);
+        Py_XDECREF(py_bytes);
+        Py_XDECREF(from_bytes);
+        return result;
+#endif
+    }
+}
+
 /* CIntFromPy */
-  static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *x) {
+  static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *x) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
 #endif
-    const long neg_one = (long) -1, const_zero = (long) 0;
+    const int neg_one = (int) -1, const_zero = (int) 0;
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic pop
 #endif
     const int is_unsigned = neg_one > const_zero;
 #if PY_MAJOR_VERSION < 3
     if (likely(PyInt_Check(x))) {
-        if ((sizeof(long) < sizeof(long))) {
-            __PYX_VERIFY_RETURN_INT(long, long, PyInt_AS_LONG(x))
+        if ((sizeof(int) < sizeof(long))) {
+            __PYX_VERIFY_RETURN_INT(int, long, PyInt_AS_LONG(x))
         } else {
             long val = PyInt_AS_LONG(x);
             if (is_unsigned && unlikely(val < 0)) {
                 goto raise_neg_overflow;
             }
-            return (long) val;
+            return (int) val;
         }
     } else
 #endif
     if (likely(PyLong_Check(x))) {
         if (is_unsigned) {
 #if CYTHON_USE_PYLONG_INTERNALS
             if (unlikely(__Pyx_PyLong_IsNeg(x))) {
                 goto raise_neg_overflow;
             } else if (__Pyx_PyLong_IsCompact(x)) {
-                __PYX_VERIFY_RETURN_INT(long, __Pyx_compact_upylong, __Pyx_PyLong_CompactValueUnsigned(x))
+                __PYX_VERIFY_RETURN_INT(int, __Pyx_compact_upylong, __Pyx_PyLong_CompactValueUnsigned(x))
             } else {
                 const digit* digits = __Pyx_PyLong_Digits(x);
                 assert(__Pyx_PyLong_DigitCount(x) > 1);
                 switch (__Pyx_PyLong_DigitCount(x)) {
                     case 2:
-                        if ((8 * sizeof(long) > 1 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(int) > 1 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(long) >= 2 * PyLong_SHIFT)) {
-                                return (long) (((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
+                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(int) >= 2 * PyLong_SHIFT)) {
+                                return (int) (((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
                             }
                         }
                         break;
                     case 3:
-                        if ((8 * sizeof(long) > 2 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(int) > 2 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(long) >= 3 * PyLong_SHIFT)) {
-                                return (long) (((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
+                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(int) >= 3 * PyLong_SHIFT)) {
+                                return (int) (((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
                             }
                         }
                         break;
                     case 4:
-                        if ((8 * sizeof(long) > 3 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(int) > 3 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(long) >= 4 * PyLong_SHIFT)) {
-                                return (long) (((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
+                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(int) >= 4 * PyLong_SHIFT)) {
+                                return (int) (((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
                             }
                         }
                         break;
                 }
             }
 #endif
 #if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX < 0x030C00A7
             if (unlikely(Py_SIZE(x) < 0)) {
                 goto raise_neg_overflow;
             }
 #else
             {
                 int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
                 if (unlikely(result < 0))
-                    return (long) -1;
+                    return (int) -1;
                 if (unlikely(result == 1))
                     goto raise_neg_overflow;
             }
 #endif
-            if ((sizeof(long) <= sizeof(unsigned long))) {
-                __PYX_VERIFY_RETURN_INT_EXC(long, unsigned long, PyLong_AsUnsignedLong(x))
+            if ((sizeof(int) <= sizeof(unsigned long))) {
+                __PYX_VERIFY_RETURN_INT_EXC(int, unsigned long, PyLong_AsUnsignedLong(x))
 #ifdef HAVE_LONG_LONG
-            } else if ((sizeof(long) <= sizeof(unsigned PY_LONG_LONG))) {
-                __PYX_VERIFY_RETURN_INT_EXC(long, unsigned PY_LONG_LONG, PyLong_AsUnsignedLongLong(x))
+            } else if ((sizeof(int) <= sizeof(unsigned PY_LONG_LONG))) {
+                __PYX_VERIFY_RETURN_INT_EXC(int, unsigned PY_LONG_LONG, PyLong_AsUnsignedLongLong(x))
 #endif
             }
         } else {
 #if CYTHON_USE_PYLONG_INTERNALS
             if (__Pyx_PyLong_IsCompact(x)) {
-                __PYX_VERIFY_RETURN_INT(long, __Pyx_compact_pylong, __Pyx_PyLong_CompactValue(x))
+                __PYX_VERIFY_RETURN_INT(int, __Pyx_compact_pylong, __Pyx_PyLong_CompactValue(x))
             } else {
                 const digit* digits = __Pyx_PyLong_Digits(x);
                 assert(__Pyx_PyLong_DigitCount(x) > 1);
                 switch (__Pyx_PyLong_SignedDigitCount(x)) {
                     case -2:
-                        if ((8 * sizeof(long) - 1 > 1 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(int) - 1 > 1 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(long) - 1 > 2 * PyLong_SHIFT)) {
-                                return (long) (((long)-1)*(((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(int) - 1 > 2 * PyLong_SHIFT)) {
+                                return (int) (((int)-1)*(((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                             }
                         }
                         break;
                     case 2:
-                        if ((8 * sizeof(long) > 1 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(int) > 1 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(long) - 1 > 2 * PyLong_SHIFT)) {
-                                return (long) ((((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(int) - 1 > 2 * PyLong_SHIFT)) {
+                                return (int) ((((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                             }
                         }
                         break;
                     case -3:
-                        if ((8 * sizeof(long) - 1 > 2 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(int) - 1 > 2 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(long) - 1 > 3 * PyLong_SHIFT)) {
-                                return (long) (((long)-1)*(((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(int) - 1 > 3 * PyLong_SHIFT)) {
+                                return (int) (((int)-1)*(((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                             }
                         }
                         break;
                     case 3:
-                        if ((8 * sizeof(long) > 2 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(int) > 2 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(long) - 1 > 3 * PyLong_SHIFT)) {
-                                return (long) ((((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(int) - 1 > 3 * PyLong_SHIFT)) {
+                                return (int) ((((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                             }
                         }
                         break;
                     case -4:
-                        if ((8 * sizeof(long) - 1 > 3 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(int) - 1 > 3 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(long) - 1 > 4 * PyLong_SHIFT)) {
-                                return (long) (((long)-1)*(((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(int) - 1 > 4 * PyLong_SHIFT)) {
+                                return (int) (((int)-1)*(((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                             }
                         }
                         break;
                     case 4:
-                        if ((8 * sizeof(long) > 3 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(int) > 3 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(long) - 1 > 4 * PyLong_SHIFT)) {
-                                return (long) ((((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(int) - 1 > 4 * PyLong_SHIFT)) {
+                                return (int) ((((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                             }
                         }
                         break;
                 }
             }
 #endif
-            if ((sizeof(long) <= sizeof(long))) {
-                __PYX_VERIFY_RETURN_INT_EXC(long, long, PyLong_AsLong(x))
+            if ((sizeof(int) <= sizeof(long))) {
+                __PYX_VERIFY_RETURN_INT_EXC(int, long, PyLong_AsLong(x))
 #ifdef HAVE_LONG_LONG
-            } else if ((sizeof(long) <= sizeof(PY_LONG_LONG))) {
-                __PYX_VERIFY_RETURN_INT_EXC(long, PY_LONG_LONG, PyLong_AsLongLong(x))
+            } else if ((sizeof(int) <= sizeof(PY_LONG_LONG))) {
+                __PYX_VERIFY_RETURN_INT_EXC(int, PY_LONG_LONG, PyLong_AsLongLong(x))
 #endif
             }
         }
         {
-            long val;
+            int val;
             PyObject *v = __Pyx_PyNumber_IntOrLong(x);
 #if PY_MAJOR_VERSION < 3
             if (likely(v) && !PyLong_Check(v)) {
                 PyObject *tmp = v;
                 v = PyNumber_Long(tmp);
                 Py_DECREF(tmp);
             }
@@ -30449,325 +30033,261 @@
                 long idigit;
                 int chunk_size = (sizeof(long) < 8) ? 30 : 62;
                 if (unlikely(!PyLong_CheckExact(v))) {
                     PyObject *tmp = v;
                     v = PyNumber_Long(v);
                     assert(PyLong_CheckExact(v));
                     Py_DECREF(tmp);
-                    if (unlikely(!v)) return (long) -1;
+                    if (unlikely(!v)) return (int) -1;
                 }
 #if CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030B0000
                 if (Py_SIZE(x) == 0)
-                    return (long) 0;
+                    return (int) 0;
                 is_negative = Py_SIZE(x) < 0;
 #else
                 {
                     int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
                     if (unlikely(result < 0))
-                        return (long) -1;
+                        return (int) -1;
                     is_negative = result == 1;
                 }
 #endif
                 if (is_unsigned && unlikely(is_negative)) {
                     goto raise_neg_overflow;
                 } else if (is_negative) {
                     stepval = PyNumber_Invert(v);
                     if (unlikely(!stepval))
-                        return (long) -1;
+                        return (int) -1;
                 } else {
                     stepval = __Pyx_NewRef(v);
                 }
-                val = (long) 0;
+                val = (int) 0;
                 mask = PyLong_FromLong((1L << chunk_size) - 1); if (unlikely(!mask)) goto done;
                 shift = PyLong_FromLong(chunk_size); if (unlikely(!shift)) goto done;
-                for (bits = 0; bits < (int) sizeof(long) * 8 - chunk_size; bits += chunk_size) {
+                for (bits = 0; bits < (int) sizeof(int) * 8 - chunk_size; bits += chunk_size) {
                     PyObject *tmp, *digit;
                     digit = PyNumber_And(stepval, mask);
                     if (unlikely(!digit)) goto done;
                     idigit = PyLong_AsLong(digit);
                     Py_DECREF(digit);
                     if (unlikely(idigit < 0)) goto done;
                     tmp = PyNumber_Rshift(stepval, shift);
                     if (unlikely(!tmp)) goto done;
                     Py_DECREF(stepval); stepval = tmp;
-                    val |= ((long) idigit) << bits;
+                    val |= ((int) idigit) << bits;
                     #if CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030B0000
                     if (Py_SIZE(stepval) == 0)
                         goto unpacking_done;
                     #endif
                 }
                 idigit = PyLong_AsLong(stepval);
                 if (unlikely(idigit < 0)) goto done;
-                remaining_bits = ((int) sizeof(long) * 8) - bits - (is_unsigned ? 0 : 1);
+                remaining_bits = ((int) sizeof(int) * 8) - bits - (is_unsigned ? 0 : 1);
                 if (unlikely(idigit >= (1L << remaining_bits)))
                     goto raise_overflow;
-                val |= ((long) idigit) << bits;
+                val |= ((int) idigit) << bits;
             #if CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030B0000
             unpacking_done:
             #endif
                 if (!is_unsigned) {
-                    if (unlikely(val & (((long) 1) << (sizeof(long) * 8 - 1))))
+                    if (unlikely(val & (((int) 1) << (sizeof(int) * 8 - 1))))
                         goto raise_overflow;
                     if (is_negative)
                         val = ~val;
                 }
                 ret = 0;
             done:
                 Py_XDECREF(shift);
                 Py_XDECREF(mask);
                 Py_XDECREF(stepval);
 #endif
                 Py_DECREF(v);
                 if (likely(!ret))
                     return val;
             }
-            return (long) -1;
+            return (int) -1;
         }
     } else {
-        long val;
+        int val;
         PyObject *tmp = __Pyx_PyNumber_IntOrLong(x);
-        if (!tmp) return (long) -1;
-        val = __Pyx_PyInt_As_long(tmp);
+        if (!tmp) return (int) -1;
+        val = __Pyx_PyInt_As_int(tmp);
         Py_DECREF(tmp);
         return val;
     }
 raise_overflow:
     PyErr_SetString(PyExc_OverflowError,
-        "value too large to convert to long");
-    return (long) -1;
+        "value too large to convert to int");
+    return (int) -1;
 raise_neg_overflow:
     PyErr_SetString(PyExc_OverflowError,
-        "can't convert negative value to long");
-    return (long) -1;
-}
-
-/* CIntToPy */
-  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
-#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
-#pragma GCC diagnostic push
-#pragma GCC diagnostic ignored "-Wconversion"
-#endif
-    const int neg_one = (int) -1, const_zero = (int) 0;
-#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
-#pragma GCC diagnostic pop
-#endif
-    const int is_unsigned = neg_one > const_zero;
-    if (is_unsigned) {
-        if (sizeof(int) < sizeof(long)) {
-            return PyInt_FromLong((long) value);
-        } else if (sizeof(int) <= sizeof(unsigned long)) {
-            return PyLong_FromUnsignedLong((unsigned long) value);
-#ifdef HAVE_LONG_LONG
-        } else if (sizeof(int) <= sizeof(unsigned PY_LONG_LONG)) {
-            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
-#endif
-        }
-    } else {
-        if (sizeof(int) <= sizeof(long)) {
-            return PyInt_FromLong((long) value);
-#ifdef HAVE_LONG_LONG
-        } else if (sizeof(int) <= sizeof(PY_LONG_LONG)) {
-            return PyLong_FromLongLong((PY_LONG_LONG) value);
-#endif
-        }
-    }
-    {
-        int one = 1; int little = (int)*(unsigned char *)&one;
-        unsigned char *bytes = (unsigned char *)&value;
-#if !CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030d0000
-        return _PyLong_FromByteArray(bytes, sizeof(int),
-                                     little, !is_unsigned);
-#else
-        PyObject *from_bytes, *result = NULL;
-        PyObject *py_bytes = NULL, *arg_tuple = NULL, *kwds = NULL, *order_str = NULL;
-        from_bytes = PyObject_GetAttrString((PyObject*)&PyLong_Type, "from_bytes");
-        if (!from_bytes) return NULL;
-        py_bytes = PyBytes_FromStringAndSize((char*)bytes, sizeof(int));
-        if (!py_bytes) goto limited_bad;
-        order_str = PyUnicode_FromString(little ? "little" : "big");
-        if (!order_str) goto limited_bad;
-        arg_tuple = PyTuple_Pack(2, py_bytes, order_str);
-        if (!arg_tuple) goto limited_bad;
-        if (!is_unsigned) {
-            kwds = PyDict_New();
-            if (!kwds) goto limited_bad;
-            if (PyDict_SetItemString(kwds, "signed", __Pyx_NewRef(Py_True))) goto limited_bad;
-        }
-        result = PyObject_Call(from_bytes, arg_tuple, kwds);
-        limited_bad:
-        Py_XDECREF(kwds);
-        Py_XDECREF(arg_tuple);
-        Py_XDECREF(order_str);
-        Py_XDECREF(py_bytes);
-        Py_XDECREF(from_bytes);
-        return result;
-#endif
-    }
+        "can't convert negative value to int");
+    return (int) -1;
 }
 
 /* CIntFromPy */
-  static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *x) {
+  static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *x) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
 #endif
-    const int neg_one = (int) -1, const_zero = (int) 0;
+    const long neg_one = (long) -1, const_zero = (long) 0;
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic pop
 #endif
     const int is_unsigned = neg_one > const_zero;
 #if PY_MAJOR_VERSION < 3
     if (likely(PyInt_Check(x))) {
-        if ((sizeof(int) < sizeof(long))) {
-            __PYX_VERIFY_RETURN_INT(int, long, PyInt_AS_LONG(x))
+        if ((sizeof(long) < sizeof(long))) {
+            __PYX_VERIFY_RETURN_INT(long, long, PyInt_AS_LONG(x))
         } else {
             long val = PyInt_AS_LONG(x);
             if (is_unsigned && unlikely(val < 0)) {
                 goto raise_neg_overflow;
             }
-            return (int) val;
+            return (long) val;
         }
     } else
 #endif
     if (likely(PyLong_Check(x))) {
         if (is_unsigned) {
 #if CYTHON_USE_PYLONG_INTERNALS
             if (unlikely(__Pyx_PyLong_IsNeg(x))) {
                 goto raise_neg_overflow;
             } else if (__Pyx_PyLong_IsCompact(x)) {
-                __PYX_VERIFY_RETURN_INT(int, __Pyx_compact_upylong, __Pyx_PyLong_CompactValueUnsigned(x))
+                __PYX_VERIFY_RETURN_INT(long, __Pyx_compact_upylong, __Pyx_PyLong_CompactValueUnsigned(x))
             } else {
                 const digit* digits = __Pyx_PyLong_Digits(x);
                 assert(__Pyx_PyLong_DigitCount(x) > 1);
                 switch (__Pyx_PyLong_DigitCount(x)) {
                     case 2:
-                        if ((8 * sizeof(int) > 1 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(long) > 1 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(int) >= 2 * PyLong_SHIFT)) {
-                                return (int) (((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
+                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(long) >= 2 * PyLong_SHIFT)) {
+                                return (long) (((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
                             }
                         }
                         break;
                     case 3:
-                        if ((8 * sizeof(int) > 2 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(long) > 2 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(int) >= 3 * PyLong_SHIFT)) {
-                                return (int) (((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
+                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(long) >= 3 * PyLong_SHIFT)) {
+                                return (long) (((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
                             }
                         }
                         break;
                     case 4:
-                        if ((8 * sizeof(int) > 3 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(long) > 3 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(int) >= 4 * PyLong_SHIFT)) {
-                                return (int) (((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
+                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(long) >= 4 * PyLong_SHIFT)) {
+                                return (long) (((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
                             }
                         }
                         break;
                 }
             }
 #endif
 #if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX < 0x030C00A7
             if (unlikely(Py_SIZE(x) < 0)) {
                 goto raise_neg_overflow;
             }
 #else
             {
                 int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
                 if (unlikely(result < 0))
-                    return (int) -1;
+                    return (long) -1;
                 if (unlikely(result == 1))
                     goto raise_neg_overflow;
             }
 #endif
-            if ((sizeof(int) <= sizeof(unsigned long))) {
-                __PYX_VERIFY_RETURN_INT_EXC(int, unsigned long, PyLong_AsUnsignedLong(x))
+            if ((sizeof(long) <= sizeof(unsigned long))) {
+                __PYX_VERIFY_RETURN_INT_EXC(long, unsigned long, PyLong_AsUnsignedLong(x))
 #ifdef HAVE_LONG_LONG
-            } else if ((sizeof(int) <= sizeof(unsigned PY_LONG_LONG))) {
-                __PYX_VERIFY_RETURN_INT_EXC(int, unsigned PY_LONG_LONG, PyLong_AsUnsignedLongLong(x))
+            } else if ((sizeof(long) <= sizeof(unsigned PY_LONG_LONG))) {
+                __PYX_VERIFY_RETURN_INT_EXC(long, unsigned PY_LONG_LONG, PyLong_AsUnsignedLongLong(x))
 #endif
             }
         } else {
 #if CYTHON_USE_PYLONG_INTERNALS
             if (__Pyx_PyLong_IsCompact(x)) {
-                __PYX_VERIFY_RETURN_INT(int, __Pyx_compact_pylong, __Pyx_PyLong_CompactValue(x))
+                __PYX_VERIFY_RETURN_INT(long, __Pyx_compact_pylong, __Pyx_PyLong_CompactValue(x))
             } else {
                 const digit* digits = __Pyx_PyLong_Digits(x);
                 assert(__Pyx_PyLong_DigitCount(x) > 1);
                 switch (__Pyx_PyLong_SignedDigitCount(x)) {
                     case -2:
-                        if ((8 * sizeof(int) - 1 > 1 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(long) - 1 > 1 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(int) - 1 > 2 * PyLong_SHIFT)) {
-                                return (int) (((int)-1)*(((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(long) - 1 > 2 * PyLong_SHIFT)) {
+                                return (long) (((long)-1)*(((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                             }
                         }
                         break;
                     case 2:
-                        if ((8 * sizeof(int) > 1 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(long) > 1 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(int) - 1 > 2 * PyLong_SHIFT)) {
-                                return (int) ((((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(long) - 1 > 2 * PyLong_SHIFT)) {
+                                return (long) ((((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                             }
                         }
                         break;
                     case -3:
-                        if ((8 * sizeof(int) - 1 > 2 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(long) - 1 > 2 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(int) - 1 > 3 * PyLong_SHIFT)) {
-                                return (int) (((int)-1)*(((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(long) - 1 > 3 * PyLong_SHIFT)) {
+                                return (long) (((long)-1)*(((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                             }
                         }
                         break;
                     case 3:
-                        if ((8 * sizeof(int) > 2 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(long) > 2 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(int) - 1 > 3 * PyLong_SHIFT)) {
-                                return (int) ((((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(long) - 1 > 3 * PyLong_SHIFT)) {
+                                return (long) ((((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                             }
                         }
                         break;
                     case -4:
-                        if ((8 * sizeof(int) - 1 > 3 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(long) - 1 > 3 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(int) - 1 > 4 * PyLong_SHIFT)) {
-                                return (int) (((int)-1)*(((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(long) - 1 > 4 * PyLong_SHIFT)) {
+                                return (long) (((long)-1)*(((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                             }
                         }
                         break;
                     case 4:
-                        if ((8 * sizeof(int) > 3 * PyLong_SHIFT)) {
+                        if ((8 * sizeof(long) > 3 * PyLong_SHIFT)) {
                             if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
-                                __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
-                            } else if ((8 * sizeof(int) - 1 > 4 * PyLong_SHIFT)) {
-                                return (int) ((((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
+                                __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(long) - 1 > 4 * PyLong_SHIFT)) {
+                                return (long) ((((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                             }
                         }
                         break;
                 }
             }
 #endif
-            if ((sizeof(int) <= sizeof(long))) {
-                __PYX_VERIFY_RETURN_INT_EXC(int, long, PyLong_AsLong(x))
+            if ((sizeof(long) <= sizeof(long))) {
+                __PYX_VERIFY_RETURN_INT_EXC(long, long, PyLong_AsLong(x))
 #ifdef HAVE_LONG_LONG
-            } else if ((sizeof(int) <= sizeof(PY_LONG_LONG))) {
-                __PYX_VERIFY_RETURN_INT_EXC(int, PY_LONG_LONG, PyLong_AsLongLong(x))
+            } else if ((sizeof(long) <= sizeof(PY_LONG_LONG))) {
+                __PYX_VERIFY_RETURN_INT_EXC(long, PY_LONG_LONG, PyLong_AsLongLong(x))
 #endif
             }
         }
         {
-            int val;
+            long val;
             PyObject *v = __Pyx_PyNumber_IntOrLong(x);
 #if PY_MAJOR_VERSION < 3
             if (likely(v) && !PyLong_Check(v)) {
                 PyObject *tmp = v;
                 v = PyNumber_Long(tmp);
                 Py_DECREF(tmp);
             }
@@ -30786,99 +30306,99 @@
                 long idigit;
                 int chunk_size = (sizeof(long) < 8) ? 30 : 62;
                 if (unlikely(!PyLong_CheckExact(v))) {
                     PyObject *tmp = v;
                     v = PyNumber_Long(v);
                     assert(PyLong_CheckExact(v));
                     Py_DECREF(tmp);
-                    if (unlikely(!v)) return (int) -1;
+                    if (unlikely(!v)) return (long) -1;
                 }
 #if CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030B0000
                 if (Py_SIZE(x) == 0)
-                    return (int) 0;
+                    return (long) 0;
                 is_negative = Py_SIZE(x) < 0;
 #else
                 {
                     int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
                     if (unlikely(result < 0))
-                        return (int) -1;
+                        return (long) -1;
                     is_negative = result == 1;
                 }
 #endif
                 if (is_unsigned && unlikely(is_negative)) {
                     goto raise_neg_overflow;
                 } else if (is_negative) {
                     stepval = PyNumber_Invert(v);
                     if (unlikely(!stepval))
-                        return (int) -1;
+                        return (long) -1;
                 } else {
                     stepval = __Pyx_NewRef(v);
                 }
-                val = (int) 0;
+                val = (long) 0;
                 mask = PyLong_FromLong((1L << chunk_size) - 1); if (unlikely(!mask)) goto done;
                 shift = PyLong_FromLong(chunk_size); if (unlikely(!shift)) goto done;
-                for (bits = 0; bits < (int) sizeof(int) * 8 - chunk_size; bits += chunk_size) {
+                for (bits = 0; bits < (int) sizeof(long) * 8 - chunk_size; bits += chunk_size) {
                     PyObject *tmp, *digit;
                     digit = PyNumber_And(stepval, mask);
                     if (unlikely(!digit)) goto done;
                     idigit = PyLong_AsLong(digit);
                     Py_DECREF(digit);
                     if (unlikely(idigit < 0)) goto done;
                     tmp = PyNumber_Rshift(stepval, shift);
                     if (unlikely(!tmp)) goto done;
                     Py_DECREF(stepval); stepval = tmp;
-                    val |= ((int) idigit) << bits;
+                    val |= ((long) idigit) << bits;
                     #if CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030B0000
                     if (Py_SIZE(stepval) == 0)
                         goto unpacking_done;
                     #endif
                 }
                 idigit = PyLong_AsLong(stepval);
                 if (unlikely(idigit < 0)) goto done;
-                remaining_bits = ((int) sizeof(int) * 8) - bits - (is_unsigned ? 0 : 1);
+                remaining_bits = ((int) sizeof(long) * 8) - bits - (is_unsigned ? 0 : 1);
                 if (unlikely(idigit >= (1L << remaining_bits)))
                     goto raise_overflow;
-                val |= ((int) idigit) << bits;
+                val |= ((long) idigit) << bits;
             #if CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030B0000
             unpacking_done:
             #endif
                 if (!is_unsigned) {
-                    if (unlikely(val & (((int) 1) << (sizeof(int) * 8 - 1))))
+                    if (unlikely(val & (((long) 1) << (sizeof(long) * 8 - 1))))
                         goto raise_overflow;
                     if (is_negative)
                         val = ~val;
                 }
                 ret = 0;
             done:
                 Py_XDECREF(shift);
                 Py_XDECREF(mask);
                 Py_XDECREF(stepval);
 #endif
                 Py_DECREF(v);
                 if (likely(!ret))
                     return val;
             }
-            return (int) -1;
+            return (long) -1;
         }
     } else {
-        int val;
+        long val;
         PyObject *tmp = __Pyx_PyNumber_IntOrLong(x);
-        if (!tmp) return (int) -1;
-        val = __Pyx_PyInt_As_int(tmp);
+        if (!tmp) return (long) -1;
+        val = __Pyx_PyInt_As_long(tmp);
         Py_DECREF(tmp);
         return val;
     }
 raise_overflow:
     PyErr_SetString(PyExc_OverflowError,
-        "value too large to convert to int");
-    return (int) -1;
+        "value too large to convert to long");
+    return (long) -1;
 raise_neg_overflow:
     PyErr_SetString(PyExc_OverflowError,
-        "can't convert negative value to int");
-    return (int) -1;
+        "can't convert negative value to long");
+    return (long) -1;
 }
 
 /* CIntToPy */
   static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
```

### Comparing `moleculekit-1.8.6/moleculekit/interactions/pipi/pipi.pyx` & `moleculekit-1.8.7/moleculekit/interactions/pipi/pipi.pyx`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/interactions/sigmahole/sigmahole.cpp` & `moleculekit-1.8.7/moleculekit/interactions/sigmahole/sigmahole.cpp`

 * *Files 0% similar despite different names*

```diff
@@ -1,24 +1,24 @@
 /* Generated by Cython 3.0.5 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h"
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include"
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include"
         ],
         "language": "c++",
         "name": "moleculekit.interactions.sigmahole",
         "sources": [
             "moleculekit/interactions/sigmahole/sigmahole.pyx"
         ]
     },
@@ -1672,177 +1672,177 @@
   Py_ssize_t strides[8];
   Py_ssize_t suboffsets[8];
 } __Pyx_memviewslice;
 #define __Pyx_MemoryView_Len(m)  (m.shape[0])
 
 /* #### Code section: numeric_typedefs ### */
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":730
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":730
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":731
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":731
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":732
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":732
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":733
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":733
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":737
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":737
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":738
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":738
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":739
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":739
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":740
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":740
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":744
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":744
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":745
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":745
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":754
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":754
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":755
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":755
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":757
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":757
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":758
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":758
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":760
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":760
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":761
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":761
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":763
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":763
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":764
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":764
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":765
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":765
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
@@ -1893,42 +1893,42 @@
 
 /*--- Type declarations ---*/
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
 struct __pyx_memoryviewslice_obj;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":767
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":767
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":768
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":768
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":769
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":769
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":771
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":771
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -18707,261 +18707,261 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_7ndarray_4base_base(PyArrayObject *__pyx_v_self) {
   PyObject *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":248
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":248
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  *             return PyArray_BASE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_BASE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
 static CYTHON_INLINE PyArray_Descr *__pyx_f_5numpy_7ndarray_5descr_descr(PyArrayObject *__pyx_v_self) {
   PyArray_Descr *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyArray_Descr *__pyx_t_1;
   __Pyx_RefNannySetupContext("descr", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":254
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":254
  *             """Returns an owned reference to the dtype of the array.
  *             """
  *             return <dtype>PyArray_DESCR(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __pyx_t_1 = PyArray_DESCR(__pyx_v_self);
   __Pyx_INCREF((PyObject *)((PyArray_Descr *)__pyx_t_1));
   __pyx_r = ((PyArray_Descr *)__pyx_t_1);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_7ndarray_4ndim_ndim(PyArrayObject *__pyx_v_self) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":260
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":260
  *             """Returns the number of dimensions in the array.
  *             """
  *             return PyArray_NDIM(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_NDIM(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_5shape_shape(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":268
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":268
  *             Can return NULL for 0-dimensional arrays.
  *             """
  *             return PyArray_DIMS(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_DIMS(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_7strides_strides(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":275
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":275
  *             The number of elements matches the number of dimensions of the array (ndim).
  *             """
  *             return PyArray_STRIDES(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_STRIDES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
 static CYTHON_INLINE npy_intp __pyx_f_5numpy_7ndarray_4size_size(PyArrayObject *__pyx_v_self) {
   npy_intp __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":281
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":281
  *             """Returns the total size (in number of elements) of the array.
  *             """
  *             return PyArray_SIZE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_SIZE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
 static CYTHON_INLINE char *__pyx_f_5numpy_7ndarray_4data_data(PyArrayObject *__pyx_v_self) {
   char *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":290
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":290
  *             of `PyArray_DATA()` instead, which returns a 'void*'.
  *             """
  *             return PyArray_BYTES(self)             # <<<<<<<<<<<<<<
  * 
  *     ctypedef unsigned char      npy_bool
  */
   __pyx_r = PyArray_BYTES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -18970,29 +18970,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":774
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":774
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 774, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -19003,15 +19003,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -19020,29 +19020,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":777
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":777
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -19053,15 +19053,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -19070,29 +19070,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":780
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":780
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 780, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -19103,15 +19103,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -19120,29 +19120,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":783
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":783
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -19153,15 +19153,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -19170,29 +19170,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":786
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":786
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -19203,217 +19203,217 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = PyDataType_HASSUBARRAY(__pyx_v_d);
   if (__pyx_t_1) {
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":790
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":790
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":792
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":792
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":968
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":968
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":969
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":969
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   __pyx_t_1 = PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(2, 969, __pyx_L1_error)
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_AddTraceback("numpy.set_array_base", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":972
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":972
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = (__pyx_v_base == NULL);
   if (__pyx_t_1) {
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":974
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":974
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":975
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":975
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19429,15 +19429,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -19445,68 +19445,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":981
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":981
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 981, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":982
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":982
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 982, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 983, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 983, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19514,15 +19514,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19537,15 +19537,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19561,15 +19561,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19577,68 +19577,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":987
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":987
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 987, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":988
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":988
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 988, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 989, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 989, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19646,15 +19646,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19669,15 +19669,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19693,15 +19693,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19709,68 +19709,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":993
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":993
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 993, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":994
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":994
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 994, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":995
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":995
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 995, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 995, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19778,15 +19778,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19801,170 +19801,170 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1010
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1010
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1025
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1025
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
 static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
   npy_datetime __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1035
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1035
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
 static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
   npy_timedelta __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1042
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1042
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
 static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
   NPY_DATETIMEUNIT __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1049
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1049
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -22561,26 +22561,26 @@
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError, "Incompatible checksums (0x%x vs (0x82a3537, 0x6ae9995, 0xb068931) = (name))" % __pyx_checksum
  */
   __pyx_tuple__8 = PyTuple_Pack(3, __pyx_int_136983863, __pyx_int_112105877, __pyx_int_184977713); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__8);
   __Pyx_GIVEREF(__pyx_tuple__8);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(2, 983, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__9);
   __Pyx_GIVEREF(__pyx_tuple__9);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(2, 989, __pyx_L1_error)
```

### Comparing `moleculekit-1.8.6/moleculekit/interactions/sigmahole/sigmahole.pyx` & `moleculekit-1.8.7/moleculekit/interactions/sigmahole/sigmahole.pyx`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/molecule.py` & `moleculekit-1.8.7/moleculekit/molecule.py`

 * *Files 0% similar despite different names*

```diff
@@ -759,15 +759,15 @@
                 self.coords,
                 refmol.coords,
                 np.array(sel, dtype=np.int64),
                 np.array(refsel, dtype=np.int64),
                 frames,
                 refmol.frame,
                 matchingframes,
-                inplace=True
+                inplace=True,
             )
         elif mode == "structure":
             TM1, rmsd, nali, coords, trans = molTMalign(
                 self,
                 refmol,
                 sel,
                 refsel,
@@ -1418,14 +1418,19 @@
                 mol.dropFrames(keep=frame)
 
             newmols.append(mol)
 
         self._mergeTopologies(newmols, overwrite=overwrite, _logger=_logger)
         self._mergeTrajectories(newmols, append=append, skip=skip)
 
+        # Remove references to numpy arrays reassigned above to self
+        for mm in newmols:
+            # Using `del mm` does not force the GC to run immediately, hence force it
+            mm.__del__()
+
         self._dropAltLoc(keepaltloc=keepaltloc, _logger=_logger)
 
         if guess is not None or guessNE is not None:
             if guess is not None:
                 guess = ensurelist(guess)
             if guessNE is not None:
                 guessNE = ensurelist(guessNE)
@@ -1696,14 +1701,20 @@
                 self.step = self.step[::skip]
             if self.time is not None:
                 self.time = self.time[::skip]
             self.fileloc = self.fileloc[::skip]
 
         self.coords = np.atleast_3d(self.coords)
 
+    def __del__(self):
+        # Explicit deletion of references to all fields to assist a bit the GC
+        for field in Molecule._all_fields:
+            if hasattr(self, field):
+                delattr(self, field)
+
     def mutateResidue(self, sel, newres):
         """Mutates a residue by deleting its sidechain and renaming it
 
         Parameters
         ----------
         sel : str
             Atom selection string for the residue we want to mutate. The selection needs to include all atoms of the
@@ -1724,14 +1735,18 @@
         self.remove(remidx, _logger=False)
         s = np.delete(s, remidx)
         self.set("resname", newres, sel=s)
 
     def wrap(self, wrapsel="all", fileBonds=True, guessBonds=False):
         """Wraps the coordinates of the molecule into the simulation box
 
+        It assumes that all bonded groups are sequential in Molecule. I.e. you don't have a molecule B
+        in between the atoms of molecule A.
+        It also requires correct bonding (ideally read from a topology file).
+
         Parameters
         ----------
         wrapsel : str
             Atom selection string of atoms on which to center the wrapping box.
             See more `here <http://www.ks.uiuc.edu/Research/vmd/vmd-1.9.2/ug/node89.html>`__
 
         Examples
@@ -2743,18 +2758,14 @@
             else np.array([bondtype[0]] * bonds.shape[0], dtype=object),
         )
 
 
 def getBondedGroups(mol, bonds=None):
     """Calculates all bonded groups in a Molecule
 
-    It assumes that all bonded groups are sequential in Molecule. I.e. you don't have a molecule B
-    in between the atoms of molecule A.
-    It also requires correct bonds (ideally read from a topology file).
-
     Parameters
     ----------
     mol : Molecule
         A Molecule object
     bonds : np.ndarray
         Optionally pass a different array of bonds. If None it will take the bonds from mol.bonds.
 
@@ -2769,23 +2780,24 @@
     --------
     >>> mol = Molecule("structure.prmtop")
     >>> mol.read("output.xtc")
     >>> groups, _ = getBondedGroups(mol)
     >>> for i in range(len(groups)-1):
     ...     print(f"Group {i} starts at index {groups[i]} and ends at index {groups[i+1]-1}")
     """
-    from moleculekit.atomselect_utils import get_bonded_groups
+    from moleculekit.wrapping import get_bonded_groups
 
     if bonds is None:
         bonds = mol.bonds
 
-    has_lower_bond = np.zeros(mol.numAtoms, dtype=np.uint32)
-    grouparray = np.zeros(mol.numAtoms, dtype=np.uint32)
-    grouplist = get_bonded_groups(bonds, has_lower_bond, mol.numAtoms, grouparray)
-    return np.array(grouplist, dtype=np.uint32), grouparray
+    parent = np.arange(mol.numAtoms).astype(np.uint32)
+    size = np.ones(mol.numAtoms, dtype=np.uint32)
+    get_bonded_groups(mol.bonds, mol.numAtoms, parent, size)
+    _, grouplist, grouparray = np.unique(parent, return_index=True, return_inverse=True)
+    return np.hstack((grouplist, [mol.numAtoms])).astype(np.uint32), grouparray
 
 
 class Representations:
     """Class that stores representations for Molecule.
 
     Examples
     --------
@@ -3314,14 +3326,38 @@
         assert mol_equal(traj2, traj3, checkFields=Molecule._all_fields)
 
         traj2 = self.trajmol.copy(sel="resname MOL")
         traj3 = self.trajmol.copy()
         traj3.filter("resname MOL")
         assert mol_equal(traj2, traj3, checkFields=Molecule._all_fields)
 
+    def test_connected_components(self):
+        from moleculekit.home import home
+        import networkx as nx
+
+        homedir = home(dataDir="test-wrapping")
+        mol = Molecule(os.path.join(homedir, "6X18.psf"))
+
+        g = mol.toGraph()
+        conn_comp = list(nx.connected_components(g))
+
+        _, group_mask = getBondedGroups(mol)
+        groups = [
+            set(np.where(group_mask == x)[0]) for x in range(group_mask.max() + 1)
+        ]
+        assert len(groups) == len(conn_comp)
+
+        for cc in conn_comp:
+            assert cc in groups
+
+        mol.read(os.path.join(homedir, "6X18.xtc"))
+        mol.wrap("protein and segid P3")
+        dims = mol.coords.max(axis=0) - mol.coords.min(axis=0)
+        assert np.all(np.abs(dims - mol.box) < 17.5)  # 17.5 A because lipids stick out
+
 
 if __name__ == "__main__":
     import doctest
     import unittest
 
     # m = Molecule("3PTB")
     # doctest.testmod(extraglobs={"tryp": m.copy()})
```

### Comparing `moleculekit-1.8.6/moleculekit/occupancy_utils/occupancy_utils.cpp` & `moleculekit-1.8.7/moleculekit/occupancy_utils/occupancy_utils.cpp`

 * *Files 0% similar despite different names*

```diff
@@ -1,24 +1,24 @@
 /* Generated by Cython 3.0.5 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h"
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include"
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include"
         ],
         "language": "c++",
         "name": "moleculekit.occupancy_utils",
         "sources": [
             "moleculekit/occupancy_utils/occupancy_utils.pyx"
         ]
     },
@@ -1672,177 +1672,177 @@
   Py_ssize_t strides[8];
   Py_ssize_t suboffsets[8];
 } __Pyx_memviewslice;
 #define __Pyx_MemoryView_Len(m)  (m.shape[0])
 
 /* #### Code section: numeric_typedefs ### */
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":730
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":730
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":731
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":731
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":732
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":732
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":733
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":733
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":737
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":737
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":738
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":738
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":739
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":739
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":740
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":740
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":744
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":744
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":745
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":745
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":754
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":754
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":755
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":755
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":757
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":757
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":758
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":758
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":760
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":760
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":761
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":761
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":763
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":763
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":764
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":764
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":765
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":765
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
@@ -1920,42 +1920,42 @@
 
 /*--- Type declarations ---*/
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
 struct __pyx_memoryviewslice_obj;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":767
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":767
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":768
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":768
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":769
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":769
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":771
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":771
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -18080,261 +18080,261 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_7ndarray_4base_base(PyArrayObject *__pyx_v_self) {
   PyObject *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":248
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":248
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  *             return PyArray_BASE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_BASE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
 static CYTHON_INLINE PyArray_Descr *__pyx_f_5numpy_7ndarray_5descr_descr(PyArrayObject *__pyx_v_self) {
   PyArray_Descr *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyArray_Descr *__pyx_t_1;
   __Pyx_RefNannySetupContext("descr", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":254
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":254
  *             """Returns an owned reference to the dtype of the array.
  *             """
  *             return <dtype>PyArray_DESCR(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __pyx_t_1 = PyArray_DESCR(__pyx_v_self);
   __Pyx_INCREF((PyObject *)((PyArray_Descr *)__pyx_t_1));
   __pyx_r = ((PyArray_Descr *)__pyx_t_1);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_7ndarray_4ndim_ndim(PyArrayObject *__pyx_v_self) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":260
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":260
  *             """Returns the number of dimensions in the array.
  *             """
  *             return PyArray_NDIM(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_NDIM(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_5shape_shape(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":268
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":268
  *             Can return NULL for 0-dimensional arrays.
  *             """
  *             return PyArray_DIMS(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_DIMS(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_7strides_strides(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":275
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":275
  *             The number of elements matches the number of dimensions of the array (ndim).
  *             """
  *             return PyArray_STRIDES(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_STRIDES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
 static CYTHON_INLINE npy_intp __pyx_f_5numpy_7ndarray_4size_size(PyArrayObject *__pyx_v_self) {
   npy_intp __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":281
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":281
  *             """Returns the total size (in number of elements) of the array.
  *             """
  *             return PyArray_SIZE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_SIZE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
 static CYTHON_INLINE char *__pyx_f_5numpy_7ndarray_4data_data(PyArrayObject *__pyx_v_self) {
   char *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":290
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":290
  *             of `PyArray_DATA()` instead, which returns a 'void*'.
  *             """
  *             return PyArray_BYTES(self)             # <<<<<<<<<<<<<<
  * 
  *     ctypedef unsigned char      npy_bool
  */
   __pyx_r = PyArray_BYTES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -18343,29 +18343,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":774
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":774
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 774, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -18376,15 +18376,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -18393,29 +18393,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":777
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":777
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -18426,15 +18426,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -18443,29 +18443,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":780
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":780
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 780, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -18476,15 +18476,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -18493,29 +18493,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":783
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":783
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -18526,15 +18526,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -18543,29 +18543,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":786
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":786
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -18576,217 +18576,217 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = PyDataType_HASSUBARRAY(__pyx_v_d);
   if (__pyx_t_1) {
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":790
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":790
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":792
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":792
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":968
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":968
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":969
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":969
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   __pyx_t_1 = PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(2, 969, __pyx_L1_error)
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_AddTraceback("numpy.set_array_base", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":972
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":972
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = (__pyx_v_base == NULL);
   if (__pyx_t_1) {
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":974
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":974
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":975
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":975
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -18802,15 +18802,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -18818,68 +18818,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":981
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":981
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 981, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":982
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":982
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 982, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 983, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 983, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -18887,15 +18887,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -18910,15 +18910,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -18934,15 +18934,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -18950,68 +18950,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":987
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":987
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 987, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":988
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":988
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 988, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 989, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 989, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19019,15 +19019,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19042,15 +19042,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19066,15 +19066,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19082,68 +19082,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":993
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":993
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 993, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":994
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":994
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 994, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":995
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":995
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 995, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 995, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19151,15 +19151,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19174,170 +19174,170 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1010
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1010
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1025
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1025
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
 static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
   npy_datetime __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1035
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1035
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
 static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
   npy_timedelta __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1042
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1042
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
 static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
   NPY_DATETIMEUNIT __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1049
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1049
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -20955,26 +20955,26 @@
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError, "Incompatible checksums (0x%x vs (0x82a3537, 0x6ae9995, 0xb068931) = (name))" % __pyx_checksum
  */
   __pyx_tuple__8 = PyTuple_Pack(3, __pyx_int_136983863, __pyx_int_112105877, __pyx_int_184977713); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__8);
   __Pyx_GIVEREF(__pyx_tuple__8);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(2, 983, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__9);
   __Pyx_GIVEREF(__pyx_tuple__9);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(2, 989, __pyx_L1_error)
```

### Comparing `moleculekit-1.8.6/moleculekit/occupancy_utils/occupancy_utils.pyx` & `moleculekit-1.8.7/moleculekit/occupancy_utils/occupancy_utils.pyx`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/opm.py` & `moleculekit-1.8.7/moleculekit/opm.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/pdbx/reader/PdbxContainers.py` & `moleculekit-1.8.7/moleculekit/pdbx/reader/PdbxContainers.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/pdbx/reader/PdbxParser.py` & `moleculekit-1.8.7/moleculekit/pdbx/reader/PdbxParser.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/pdbx/reader/PdbxReader.py` & `moleculekit-1.8.7/moleculekit/pdbx/reader/PdbxReader.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/pdbx/tests/PdbxReadWriteTests.py` & `moleculekit-1.8.7/moleculekit/pdbx/tests/PdbxReadWriteTests.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/pdbx/tests/PdbxReaderTests.py` & `moleculekit-1.8.7/moleculekit/pdbx/tests/PdbxReaderTests.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/pdbx/tests/PdbxWriterTests.py` & `moleculekit-1.8.7/moleculekit/pdbx/tests/PdbxWriterTests.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/pdbx/writer/PdbxWriter.py` & `moleculekit-1.8.7/moleculekit/pdbx/writer/PdbxWriter.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/periodictable.py` & `moleculekit-1.8.7/moleculekit/periodictable.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/ply/lex.py` & `moleculekit-1.8.7/moleculekit/ply/lex.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/ply/yacc.py` & `moleculekit-1.8.7/moleculekit/ply/yacc.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/projections/metriccoordinate.py` & `moleculekit-1.8.7/moleculekit/projections/metriccoordinate.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/projections/metricdihedral.py` & `moleculekit-1.8.7/moleculekit/projections/metricdihedral.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/projections/metricdistance.py` & `moleculekit-1.8.7/moleculekit/projections/metricdistance.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/projections/metricfluctuation.py` & `moleculekit-1.8.7/moleculekit/projections/metricfluctuation.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/projections/metricgyration.py` & `moleculekit-1.8.7/moleculekit/projections/metricgyration.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/projections/metricplumed2.py` & `moleculekit-1.8.7/moleculekit/projections/metricplumed2.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/projections/metricrmsd.py` & `moleculekit-1.8.7/moleculekit/projections/metricrmsd.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/projections/metricsasa.py` & `moleculekit-1.8.7/moleculekit/projections/metricsasa.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/projections/metricsecondarystructure.py` & `moleculekit-1.8.7/moleculekit/projections/metricsecondarystructure.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/projections/metricshell.py` & `moleculekit-1.8.7/moleculekit/projections/metricshell.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/projections/metricsphericalcoordinate.py` & `moleculekit-1.8.7/moleculekit/projections/metricsphericalcoordinate.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/projections/metrictmscore.py` & `moleculekit-1.8.7/moleculekit/projections/metrictmscore.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/projections/projection.py` & `moleculekit-1.8.7/moleculekit/projections/projection.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/projections/util.py` & `moleculekit-1.8.7/moleculekit/projections/util.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/pymolgraphics.py` & `moleculekit-1.8.7/moleculekit/pymolgraphics.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/rcsb.py` & `moleculekit-1.8.7/moleculekit/rcsb.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/rdkitintegration.py` & `moleculekit-1.8.7/moleculekit/rdkitintegration.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/readers.py` & `moleculekit-1.8.7/moleculekit/readers.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/ALA.cif` & `moleculekit-1.8.7/moleculekit/share/ALA.cif`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/atomselect/atomselect.json` & `moleculekit-1.8.7/moleculekit/share/atomselect/atomselect.json`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/backbone.cif` & `moleculekit-1.8.7/moleculekit/share/backbone.cif`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/opm_sequences.json` & `moleculekit-1.8.7/moleculekit/share/opm_sequences.json`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/004.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/004.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/03Y.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/03Y.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/0A1.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/0A1.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/0AF.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/0AF.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/0BN.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/0BN.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/1MH.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/1MH.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/2AS.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/2AS.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/2GX.dat` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/2GX.dat`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/2GX.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/2GX.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/2ML.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/2ML.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/2MR.dat` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/2MR.dat`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/2MR.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/2MR.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/4IN.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/4IN.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/4PH.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/4PH.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/4PQ.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/4PQ.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/5JP.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/5JP.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/AA4.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/AA4.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ABA.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ABA.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/AHP.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/AHP.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ALC.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ALC.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ALN.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ALN.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ALY.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ALY.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/APD.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/APD.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/BB8.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/BB8.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/BCS.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/BCS.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/BTK.dat` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/BTK.dat`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/BTK.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/BTK.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/CCS.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/CCS.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/CGU.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/CGU.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/CSA.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/CSA.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/CSO.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/CSO.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/CSP.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/CSP.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/CSS.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/CSS.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/D4P.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/D4P.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/DA2.dat` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/DA2.dat`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/DA2.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/DA2.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/DAB.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/DAB.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/DAH.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/DAH.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/DPP.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/DPP.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ESC.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ESC.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/FGL.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/FGL.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/GHG.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/GHG.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/GME.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/GME.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/GNC.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/GNC.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HHK.dat` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HHK.dat`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HHK.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HHK.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HLU.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HLU.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HLX.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HLX.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HOX.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HOX.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HPE.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HPE.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HQA.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HQA.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HTR.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HTR.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/HYP.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/HYP.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/I2M.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/I2M.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/IGL.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/IGL.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/IIL.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/IIL.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/IML.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/IML.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/KYN.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/KYN.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/LME.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/LME.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/LMQ.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/LMQ.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/LYZ.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/LYZ.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/M3L.dat` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/M3L.dat`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/M3L.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/M3L.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ME0.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ME0.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MEA.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MEA.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MEN.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MEN.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MEQ.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MEQ.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MLE.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MLE.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MLY.dat` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MLY.dat`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MLY.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MLY.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MLZ.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MLZ.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MME.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MME.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MMO.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MMO.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/MVA.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/MVA.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/NAL.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/NAL.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/NCY.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/NCY.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/NLE.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/NLE.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/NVA.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/NVA.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/NZC.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/NZC.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/OCY.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/OCY.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/OMX.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/OMX.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ONL.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ONL.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/ORM.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/ORM.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/P1L.dat` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/P1L.dat`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/P1L.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/P1L.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/PCA.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/PCA.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/PRK.dat` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/PRK.dat`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/PRK.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/PRK.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/PTR.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/PTR.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/SEP.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/SEP.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/TPO.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/TPO.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/TRO.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/TRO.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/TY2.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/TY2.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/TYQ.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/TYQ.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/YCM.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/YCM.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/share/pdb2pqr/residues/YNM.xml` & `moleculekit-1.8.7/moleculekit/share/pdb2pqr/residues/YNM.xml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/smallmol/smallmol.py` & `moleculekit-1.8.7/moleculekit/smallmol/smallmol.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/smallmol/smallmollib.py` & `moleculekit-1.8.7/moleculekit/smallmol/smallmollib.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/smallmol/test_smallmol.py` & `moleculekit-1.8.7/moleculekit/smallmol/test_smallmol.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/smallmol/test_smallmollib.py` & `moleculekit-1.8.7/moleculekit/smallmol/test_smallmollib.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/smallmol/tools/clustering.py` & `moleculekit-1.8.7/moleculekit/smallmol/tools/clustering.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/smallmol/tools/restrainedembed.py` & `moleculekit-1.8.7/moleculekit/smallmol/tools/restrainedembed.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/smallmol/tools/test_tools.py` & `moleculekit-1.8.7/moleculekit/smallmol/tools/test_tools.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/smallmol/util.py` & `moleculekit-1.8.7/moleculekit/smallmol/util.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/tmalign/include/TMAlign.h` & `moleculekit-1.8.7/moleculekit/tmalign/include/TMAlign.h`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/tmalign/src/TMAlign.cpp` & `moleculekit-1.8.7/moleculekit/tmalign/src/TMAlign.cpp`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/tmalign/tmalign_util.cpp` & `moleculekit-1.8.7/moleculekit/tmalign/tmalign_util.cpp`

 * *Files 0% similar despite different names*

```diff
@@ -1,28 +1,28 @@
 /* Generated by Cython 3.0.5 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h",
             "moleculekit/tmalign/include/TMAlign.h"
         ],
         "extra_compile_args": [
             "-w"
         ],
         "include_dirs": [
             "moleculekit/tmalign",
             "moleculekit/tmalign/include/",
             "moleculekit/tmalign/",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include"
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include"
         ],
         "language": "c++",
         "name": "moleculekit.tmalign",
         "sources": [
             "moleculekit/tmalign/tmalign_util.pyx",
             "moleculekit/tmalign/src/TMAlign.cpp"
         ]
@@ -1679,177 +1679,177 @@
   Py_ssize_t strides[8];
   Py_ssize_t suboffsets[8];
 } __Pyx_memviewslice;
 #define __Pyx_MemoryView_Len(m)  (m.shape[0])
 
 /* #### Code section: numeric_typedefs ### */
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":730
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":730
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":731
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":731
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":732
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":732
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":733
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":733
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":737
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":737
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":738
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":738
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":739
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":739
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":740
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":740
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":744
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":744
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":745
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":745
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":754
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":754
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":755
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":755
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":757
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":757
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":758
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":758
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":760
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":760
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":761
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":761
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":763
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":763
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":764
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":764
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":765
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":765
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
@@ -1962,42 +1962,42 @@
 
 /*--- Type declarations ---*/
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
 struct __pyx_memoryviewslice_obj;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":767
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":767
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":768
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":768
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":769
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":769
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":771
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":771
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -18838,261 +18838,261 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_7ndarray_4base_base(PyArrayObject *__pyx_v_self) {
   PyObject *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":248
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":248
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  *             return PyArray_BASE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_BASE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
 static CYTHON_INLINE PyArray_Descr *__pyx_f_5numpy_7ndarray_5descr_descr(PyArrayObject *__pyx_v_self) {
   PyArray_Descr *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyArray_Descr *__pyx_t_1;
   __Pyx_RefNannySetupContext("descr", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":254
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":254
  *             """Returns an owned reference to the dtype of the array.
  *             """
  *             return <dtype>PyArray_DESCR(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __pyx_t_1 = PyArray_DESCR(__pyx_v_self);
   __Pyx_INCREF((PyObject *)((PyArray_Descr *)__pyx_t_1));
   __pyx_r = ((PyArray_Descr *)__pyx_t_1);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_7ndarray_4ndim_ndim(PyArrayObject *__pyx_v_self) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":260
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":260
  *             """Returns the number of dimensions in the array.
  *             """
  *             return PyArray_NDIM(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_NDIM(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_5shape_shape(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":268
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":268
  *             Can return NULL for 0-dimensional arrays.
  *             """
  *             return PyArray_DIMS(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_DIMS(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_7strides_strides(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":275
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":275
  *             The number of elements matches the number of dimensions of the array (ndim).
  *             """
  *             return PyArray_STRIDES(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_STRIDES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
 static CYTHON_INLINE npy_intp __pyx_f_5numpy_7ndarray_4size_size(PyArrayObject *__pyx_v_self) {
   npy_intp __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":281
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":281
  *             """Returns the total size (in number of elements) of the array.
  *             """
  *             return PyArray_SIZE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_SIZE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
 static CYTHON_INLINE char *__pyx_f_5numpy_7ndarray_4data_data(PyArrayObject *__pyx_v_self) {
   char *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":290
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":290
  *             of `PyArray_DATA()` instead, which returns a 'void*'.
  *             """
  *             return PyArray_BYTES(self)             # <<<<<<<<<<<<<<
  * 
  *     ctypedef unsigned char      npy_bool
  */
   __pyx_r = PyArray_BYTES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -19101,29 +19101,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":774
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":774
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 774, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -19134,15 +19134,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -19151,29 +19151,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":777
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":777
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -19184,15 +19184,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -19201,29 +19201,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":780
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":780
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 780, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -19234,15 +19234,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -19251,29 +19251,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":783
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":783
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -19284,15 +19284,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -19301,29 +19301,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":786
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":786
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -19334,217 +19334,217 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = PyDataType_HASSUBARRAY(__pyx_v_d);
   if (__pyx_t_1) {
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":790
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":790
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":792
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":792
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":968
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":968
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":969
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":969
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   __pyx_t_1 = PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(2, 969, __pyx_L1_error)
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_AddTraceback("numpy.set_array_base", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":972
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":972
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = (__pyx_v_base == NULL);
   if (__pyx_t_1) {
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":974
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":974
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":975
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":975
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19560,15 +19560,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -19576,68 +19576,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":981
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":981
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 981, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":982
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":982
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 982, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 983, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 983, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19645,15 +19645,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19668,15 +19668,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19692,15 +19692,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19708,68 +19708,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":987
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":987
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 987, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":988
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":988
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 988, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 989, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 989, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19777,15 +19777,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19800,15 +19800,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19824,15 +19824,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19840,68 +19840,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":993
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":993
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 993, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":994
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":994
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 994, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":995
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":995
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 995, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 995, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19909,15 +19909,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19932,170 +19932,170 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1010
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1010
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1025
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1025
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
 static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
   npy_datetime __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1035
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1035
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
 static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
   npy_timedelta __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1042
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1042
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
 static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
   NPY_DATETIMEUNIT __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1049
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1049
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -22219,26 +22219,26 @@
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError, "Incompatible checksums (0x%x vs (0x82a3537, 0x6ae9995, 0xb068931) = (name))" % __pyx_checksum
  */
   __pyx_tuple__8 = PyTuple_Pack(3, __pyx_int_136983863, __pyx_int_112105877, __pyx_int_184977713); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__8);
   __Pyx_GIVEREF(__pyx_tuple__8);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(2, 983, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__9);
   __Pyx_GIVEREF(__pyx_tuple__9);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(2, 989, __pyx_L1_error)
```

### Comparing `moleculekit-1.8.6/moleculekit/tmalign/tmalign_util.pyx` & `moleculekit-1.8.7/moleculekit/tmalign/tmalign_util.pyx`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/tmalign/tmalignlib.pxd` & `moleculekit-1.8.7/moleculekit/tmalign/tmalignlib.pxd`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/tools/atomtyper.py` & `moleculekit-1.8.7/moleculekit/tools/atomtyper.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/tools/autosegment.py` & `moleculekit-1.8.7/moleculekit/tools/autosegment.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/tools/crystalpacking.py` & `moleculekit-1.8.7/moleculekit/tools/crystalpacking.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/tools/detect.py` & `moleculekit-1.8.7/moleculekit/tools/detect.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/tools/docking.py` & `moleculekit-1.8.7/moleculekit/tools/docking.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/tools/graphalignment.py` & `moleculekit-1.8.7/moleculekit/tools/graphalignment.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/tools/hhblitsprofile.py` & `moleculekit-1.8.7/moleculekit/tools/hhblitsprofile.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/tools/moleculechecks.py` & `moleculekit-1.8.7/moleculekit/tools/moleculechecks.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/tools/obabel_tools/__init__.py` & `moleculekit-1.8.7/moleculekit/tools/obabel_tools/__init__.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/tools/obabel_tools/obabel_cli.py` & `moleculekit-1.8.7/moleculekit/tools/obabel_tools/obabel_cli.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/tools/preparation.py` & `moleculekit-1.8.7/moleculekit/tools/preparation.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/tools/preparation_customres.py` & `moleculekit-1.8.7/moleculekit/tools/preparation_customres.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/tools/sequencestructuralalignment.py` & `moleculekit-1.8.7/moleculekit/tools/sequencestructuralalignment.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/tools/voxeldescriptors.py` & `moleculekit-1.8.7/moleculekit/tools/voxeldescriptors.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/util.py` & `moleculekit-1.8.7/moleculekit/util.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/viewer.py` & `moleculekit-1.8.7/moleculekit/viewer.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/vmd_wrapper` & `moleculekit-1.8.7/moleculekit/vmd_wrapper`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/vmdgraphics.py` & `moleculekit-1.8.7/moleculekit/vmdgraphics.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/vmdviewer.py` & `moleculekit-1.8.7/moleculekit/vmdviewer.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/wrapping/wrapping.cpp` & `moleculekit-1.8.7/moleculekit/wrapping/wrapping.cpp`

 * *Files 2% similar despite different names*

```diff
@@ -1,24 +1,24 @@
 /* Generated by Cython 3.0.5 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h"
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include"
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include"
         ],
         "language": "c++",
         "name": "moleculekit.wrapping",
         "sources": [
             "moleculekit/wrapping/wrapping.pyx"
         ]
     },
@@ -1672,177 +1672,177 @@
   Py_ssize_t strides[8];
   Py_ssize_t suboffsets[8];
 } __Pyx_memviewslice;
 #define __Pyx_MemoryView_Len(m)  (m.shape[0])
 
 /* #### Code section: numeric_typedefs ### */
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":730
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":730
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":731
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":731
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":732
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":732
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":733
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":733
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":737
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":737
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":738
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":738
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":739
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":739
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":740
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":740
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":744
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":744
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":745
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":745
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":754
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":754
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":755
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":755
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":757
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":757
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":758
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":758
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":760
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":760
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":761
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":761
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":763
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":763
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":764
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":764
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":765
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":765
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
@@ -1902,42 +1902,42 @@
 
 /*--- Type declarations ---*/
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
 struct __pyx_memoryviewslice_obj;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":767
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":767
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":768
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":768
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":769
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":769
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":771
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":771
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -2963,14 +2963,24 @@
                 int ndim,
                 __Pyx_TypeInfo *dtype,
                 __Pyx_BufFmt_StackElem stack[],
                 __Pyx_memviewslice *memviewslice,
                 PyObject *original_obj);
 
 /* ObjectToMemviewSlice.proto */
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_8wrapping_UINT32_t(PyObject *, int writable_flag);
+
+/* ObjectToMemviewSlice.proto */
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_11moleculekit_8wrapping_UINT32_t(PyObject *, int writable_flag);
+
+/* MemviewDtypeToObject.proto */
+static CYTHON_INLINE PyObject *__pyx_memview_get_nn___pyx_t_11moleculekit_8wrapping_UINT32_t(const char *itemp);
+static CYTHON_INLINE int __pyx_memview_set_nn___pyx_t_11moleculekit_8wrapping_UINT32_t(const char *itemp, PyObject *obj);
+
+/* ObjectToMemviewSlice.proto */
 static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_8wrapping_FLOAT32_t(PyObject *, int writable_flag);
 
 /* RealImag.proto */
 #if CYTHON_CCOMPLEX
   #ifdef __cplusplus
     #define __Pyx_CREAL(z) ((z).real())
     #define __Pyx_CIMAG(z) ((z).imag())
@@ -3095,21 +3105,27 @@
     __pyx_atomic_int_type *acquisition_count, PyThread_type_lock lock);
 #define __pyx_get_slice_count_pointer(memview) (&memview->acquisition_count)
 #define __PYX_INC_MEMVIEW(slice, have_gil) __Pyx_INC_MEMVIEW(slice, have_gil, __LINE__)
 #define __PYX_XCLEAR_MEMVIEW(slice, have_gil) __Pyx_XCLEAR_MEMVIEW(slice, have_gil, __LINE__)
 static CYTHON_INLINE void __Pyx_INC_MEMVIEW(__Pyx_memviewslice *, int, int);
 static CYTHON_INLINE void __Pyx_XCLEAR_MEMVIEW(__Pyx_memviewslice *, int, int);
 
-/* CIntToPy.proto */
-static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value);
+/* CIntFromPy.proto */
+static CYTHON_INLINE npy_uint32 __Pyx_PyInt_As_npy_uint32(PyObject *);
 
 /* CIntFromPy.proto */
 static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *);
 
 /* CIntToPy.proto */
+static CYTHON_INLINE PyObject* __Pyx_PyInt_From_npy_uint32(npy_uint32 value);
+
+/* CIntToPy.proto */
+static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value);
+
+/* CIntToPy.proto */
 static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value);
 
 /* None.proto */
 #include <new>
 
 /* CIntFromPy.proto */
 static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *);
@@ -3256,24 +3272,27 @@
 static const char __pyx_k_[] = ": ";
 static const char __pyx_k_O[] = "O";
 static const char __pyx_k_a[] = "a";
 static const char __pyx_k_c[] = "c";
 static const char __pyx_k_f[] = "f";
 static const char __pyx_k_g[] = "g";
 static const char __pyx_k_i[] = "i";
+static const char __pyx_k_j[] = "j";
 static const char __pyx_k_k[] = "k";
 static const char __pyx_k_n[] = "n";
+static const char __pyx_k_x[] = "x";
+static const char __pyx_k_y[] = "y";
 static const char __pyx_k__2[] = ".";
 static const char __pyx_k__3[] = "*";
 static const char __pyx_k__6[] = "'";
 static const char __pyx_k__7[] = ")";
 static const char __pyx_k_gc[] = "gc";
 static const char __pyx_k_id[] = "id";
 static const char __pyx_k_np[] = "np";
-static const char __pyx_k__25[] = "?";
+static const char __pyx_k__31[] = "?";
 static const char __pyx_k_abc[] = "abc";
 static const char __pyx_k_and[] = " and ";
 static const char __pyx_k_box[] = "box";
 static const char __pyx_k_got[] = " (got ";
 static const char __pyx_k_new[] = "__new__";
 static const char __pyx_k_obj[] = "obj";
 static const char __pyx_k_sys[] = "sys";
@@ -3289,14 +3308,15 @@
 static const char __pyx_k_size[] = "size";
 static const char __pyx_k_spec[] = "__spec__";
 static const char __pyx_k_sqrt[] = "sqrt";
 static const char __pyx_k_step[] = "step";
 static const char __pyx_k_stop[] = "stop";
 static const char __pyx_k_test[] = "__test__";
 static const char __pyx_k_ASCII[] = "ASCII";
+static const char __pyx_k_bonds[] = "bonds";
 static const char __pyx_k_class[] = "__class__";
 static const char __pyx_k_count[] = "count";
 static const char __pyx_k_dtype[] = "dtype";
 static const char __pyx_k_error[] = "error";
 static const char __pyx_k_flags[] = "flags";
 static const char __pyx_k_index[] = "index";
 static const char __pyx_k_numpy[] = "numpy";
@@ -3308,14 +3328,15 @@
 static const char __pyx_k_coords[] = "coords";
 static const char __pyx_k_enable[] = "enable";
 static const char __pyx_k_encode[] = "encode";
 static const char __pyx_k_format[] = "format";
 static const char __pyx_k_groups[] = "groups";
 static const char __pyx_k_import[] = "__import__";
 static const char __pyx_k_name_2[] = "__name__";
+static const char __pyx_k_parent[] = "parent";
 static const char __pyx_k_pickle[] = "pickle";
 static const char __pyx_k_reduce[] = "__reduce__";
 static const char __pyx_k_struct[] = "struct";
 static const char __pyx_k_uint32[] = "uint32";
 static const char __pyx_k_unpack[] = "unpack";
 static const char __pyx_k_update[] = "update";
 static const char __pyx_k_FLOAT32[] = "FLOAT32";
@@ -3323,14 +3344,15 @@
 static const char __pyx_k_disable[] = "disable";
 static const char __pyx_k_end_idx[] = "end_idx";
 static const char __pyx_k_float32[] = "float32";
 static const char __pyx_k_float64[] = "float64";
 static const char __pyx_k_fortran[] = "fortran";
 static const char __pyx_k_memview[] = "memview";
 static const char __pyx_k_n_atoms[] = "n_atoms";
+static const char __pyx_k_n_bonds[] = "n_bonds";
 static const char __pyx_k_Ellipsis[] = "Ellipsis";
 static const char __pyx_k_Sequence[] = "Sequence";
 static const char __pyx_k_getstate[] = "__getstate__";
 static const char __pyx_k_half_box[] = "half_box";
 static const char __pyx_k_itemsize[] = "itemsize";
 static const char __pyx_k_n_frames[] = "n_frames";
 static const char __pyx_k_n_groups[] = "n_groups";
@@ -3367,17 +3389,20 @@
 static const char __pyx_k_AssertionError[] = "AssertionError";
 static const char __pyx_k_View_MemoryView[] = "View.MemoryView";
 static const char __pyx_k_allocate_buffer[] = "allocate_buffer";
 static const char __pyx_k_collections_abc[] = "collections.abc";
 static const char __pyx_k_dtype_is_object[] = "dtype_is_object";
 static const char __pyx_k_pyx_PickleError[] = "__pyx_PickleError";
 static const char __pyx_k_setstate_cython[] = "__setstate_cython__";
+static const char __pyx_k_disjoint_set_find[] = "disjoint_set_find";
+static const char __pyx_k_get_bonded_groups[] = "get_bonded_groups";
 static const char __pyx_k_pyx_unpickle_Enum[] = "__pyx_unpickle_Enum";
 static const char __pyx_k_asyncio_coroutines[] = "asyncio.coroutines";
 static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
+static const char __pyx_k_disjoint_set_merge[] = "disjoint_set_merge";
 static const char __pyx_k_strided_and_direct[] = "<strided and direct>";
 static const char __pyx_k_moleculekit_wrapping[] = "moleculekit.wrapping";
 static const char __pyx_k_strided_and_indirect[] = "<strided and indirect>";
 static const char __pyx_k_Invalid_shape_in_axis[] = "Invalid shape in axis ";
 static const char __pyx_k_contiguous_and_direct[] = "<contiguous and direct>";
 static const char __pyx_k_Cannot_index_with_type[] = "Cannot index with type '";
 static const char __pyx_k_MemoryView_of_r_object[] = "<MemoryView of %r object>";
@@ -3445,15 +3470,18 @@
 static PyObject *__pyx_memoryview___pyx_pf_15View_dot_MemoryView_10memoryview_22copy_fortran(struct __pyx_memoryview_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryview___reduce_cython__(CYTHON_UNUSED struct __pyx_memoryview_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryview_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryview_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static void __pyx_memoryviewslice___pyx_pf_15View_dot_MemoryView_16_memoryviewslice___dealloc__(struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryviewslice___reduce_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryviewslice_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView___pyx_unpickle_Enum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v___pyx_type, long __pyx_v___pyx_checksum, PyObject *__pyx_v___pyx_state); /* proto */
-static PyObject *__pyx_pf_11moleculekit_8wrapping_calculate(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_groups, PyArrayObject *__pyx_v_coords, PyArrayObject *__pyx_v_box, PyArrayObject *__pyx_v_centersel); /* proto */
+static PyObject *__pyx_pf_11moleculekit_8wrapping_disjoint_set_find(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_11moleculekit_8wrapping_UINT32_t __pyx_v_x, __Pyx_memviewslice __pyx_v_parent); /* proto */
+static PyObject *__pyx_pf_11moleculekit_8wrapping_2disjoint_set_merge(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_11moleculekit_8wrapping_UINT32_t __pyx_v_x, __pyx_t_11moleculekit_8wrapping_UINT32_t __pyx_v_y, __Pyx_memviewslice __pyx_v_parent, __Pyx_memviewslice __pyx_v_size); /* proto */
+static PyObject *__pyx_pf_11moleculekit_8wrapping_4get_bonded_groups(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_bonds, int __pyx_v_n_atoms, __Pyx_memviewslice __pyx_v_parent, __Pyx_memviewslice __pyx_v_size); /* proto */
+static PyObject *__pyx_pf_11moleculekit_8wrapping_6calculate(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_groups, PyArrayObject *__pyx_v_coords, PyArrayObject *__pyx_v_box, PyArrayObject *__pyx_v_centersel); /* proto */
 static PyObject *__pyx_tp_new_array(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_Enum(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_memoryview(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new__memoryviewslice(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 /* #### Code section: late_includes ### */
 /* #### Code section: module_state ### */
 typedef struct {
@@ -3569,24 +3597,25 @@
   PyObject *__pyx_kp_s_Step_may_not_be_zero_axis_d;
   PyObject *__pyx_n_s_TypeError;
   PyObject *__pyx_n_s_UINT32;
   PyObject *__pyx_kp_s_Unable_to_convert_item_to_object;
   PyObject *__pyx_n_s_ValueError;
   PyObject *__pyx_n_s_View_MemoryView;
   PyObject *__pyx_kp_u__2;
-  PyObject *__pyx_n_s__25;
   PyObject *__pyx_n_s__3;
+  PyObject *__pyx_n_s__31;
   PyObject *__pyx_kp_u__6;
   PyObject *__pyx_kp_u__7;
   PyObject *__pyx_n_s_a;
   PyObject *__pyx_n_s_abc;
   PyObject *__pyx_n_s_allocate_buffer;
   PyObject *__pyx_kp_u_and;
   PyObject *__pyx_n_s_asyncio_coroutines;
   PyObject *__pyx_n_s_base;
+  PyObject *__pyx_n_s_bonds;
   PyObject *__pyx_n_s_box;
   PyObject *__pyx_n_s_box_center;
   PyObject *__pyx_n_s_c;
   PyObject *__pyx_n_u_c;
   PyObject *__pyx_n_s_calculate;
   PyObject *__pyx_n_s_centersel;
   PyObject *__pyx_n_s_class;
@@ -3597,14 +3626,16 @@
   PyObject *__pyx_kp_s_contiguous_and_direct;
   PyObject *__pyx_kp_s_contiguous_and_indirect;
   PyObject *__pyx_n_s_coords;
   PyObject *__pyx_n_s_count;
   PyObject *__pyx_n_s_dict;
   PyObject *__pyx_n_s_diff;
   PyObject *__pyx_kp_u_disable;
+  PyObject *__pyx_n_s_disjoint_set_find;
+  PyObject *__pyx_n_s_disjoint_set_merge;
   PyObject *__pyx_n_s_dtype;
   PyObject *__pyx_n_s_dtype_is_object;
   PyObject *__pyx_kp_u_enable;
   PyObject *__pyx_n_s_encode;
   PyObject *__pyx_n_s_end_idx;
   PyObject *__pyx_n_s_enumerate;
   PyObject *__pyx_n_s_error;
@@ -3613,14 +3644,15 @@
   PyObject *__pyx_n_s_float32;
   PyObject *__pyx_n_s_float64;
   PyObject *__pyx_n_s_format;
   PyObject *__pyx_n_s_fortran;
   PyObject *__pyx_n_u_fortran;
   PyObject *__pyx_n_s_g;
   PyObject *__pyx_kp_u_gc;
+  PyObject *__pyx_n_s_get_bonded_groups;
   PyObject *__pyx_n_s_getstate;
   PyObject *__pyx_kp_u_got;
   PyObject *__pyx_kp_u_got_differing_extents_in_dimensi;
   PyObject *__pyx_n_s_groups;
   PyObject *__pyx_n_s_grp_center;
   PyObject *__pyx_n_s_half_box;
   PyObject *__pyx_n_s_i;
@@ -3628,37 +3660,40 @@
   PyObject *__pyx_n_s_import;
   PyObject *__pyx_n_s_index;
   PyObject *__pyx_n_s_initializing;
   PyObject *__pyx_n_s_is_coroutine;
   PyObject *__pyx_kp_u_isenabled;
   PyObject *__pyx_n_s_itemsize;
   PyObject *__pyx_kp_s_itemsize_0_for_cython_array;
+  PyObject *__pyx_n_s_j;
   PyObject *__pyx_n_s_k;
   PyObject *__pyx_n_s_main;
   PyObject *__pyx_n_s_math;
   PyObject *__pyx_n_s_memview;
   PyObject *__pyx_n_s_mode;
   PyObject *__pyx_n_s_moleculekit_wrapping;
   PyObject *__pyx_kp_s_moleculekit_wrapping_wrapping_py;
   PyObject *__pyx_n_s_n;
   PyObject *__pyx_n_s_n_atoms;
+  PyObject *__pyx_n_s_n_bonds;
   PyObject *__pyx_n_s_n_centersel;
   PyObject *__pyx_n_s_n_frames;
   PyObject *__pyx_n_s_n_groups;
   PyObject *__pyx_n_s_name;
   PyObject *__pyx_n_s_name_2;
   PyObject *__pyx_n_s_ndim;
   PyObject *__pyx_n_s_new;
   PyObject *__pyx_kp_s_no_default___reduce___due_to_non;
   PyObject *__pyx_n_s_np;
   PyObject *__pyx_n_s_numpy;
   PyObject *__pyx_kp_u_numpy_core_multiarray_failed_to;
   PyObject *__pyx_kp_u_numpy_core_umath_failed_to_impor;
   PyObject *__pyx_n_s_obj;
   PyObject *__pyx_n_s_pack;
+  PyObject *__pyx_n_s_parent;
   PyObject *__pyx_n_s_pickle;
   PyObject *__pyx_n_s_pyx_PickleError;
   PyObject *__pyx_n_s_pyx_checksum;
   PyObject *__pyx_n_s_pyx_result;
   PyObject *__pyx_n_s_pyx_state;
   PyObject *__pyx_n_s_pyx_type;
   PyObject *__pyx_n_s_pyx_unpickle_Enum;
@@ -3688,14 +3723,16 @@
   PyObject *__pyx_n_s_translation;
   PyObject *__pyx_n_s_uint32;
   PyObject *__pyx_kp_s_unable_to_allocate_array_data;
   PyObject *__pyx_kp_s_unable_to_allocate_shape_and_str;
   PyObject *__pyx_n_s_unpack;
   PyObject *__pyx_n_s_update;
   PyObject *__pyx_n_s_version_info;
+  PyObject *__pyx_n_s_x;
+  PyObject *__pyx_n_s_y;
   PyObject *__pyx_n_s_zeros;
   PyObject *__pyx_int_0;
   PyObject *__pyx_int_1;
   PyObject *__pyx_int_3;
   PyObject *__pyx_int_112105877;
   PyObject *__pyx_int_136983863;
   PyObject *__pyx_int_184977713;
@@ -3713,16 +3750,22 @@
   PyObject *__pyx_tuple__16;
   PyObject *__pyx_tuple__17;
   PyObject *__pyx_tuple__18;
   PyObject *__pyx_tuple__19;
   PyObject *__pyx_tuple__20;
   PyObject *__pyx_tuple__21;
   PyObject *__pyx_tuple__23;
+  PyObject *__pyx_tuple__25;
+  PyObject *__pyx_tuple__27;
+  PyObject *__pyx_tuple__29;
   PyObject *__pyx_codeobj__22;
   PyObject *__pyx_codeobj__24;
+  PyObject *__pyx_codeobj__26;
+  PyObject *__pyx_codeobj__28;
+  PyObject *__pyx_codeobj__30;
 } __pyx_mstate;
 
 #if CYTHON_USE_MODULE_STATE
 #ifdef __cplusplus
 namespace {
   extern struct PyModuleDef __pyx_moduledef;
 } /* anonymous namespace */
@@ -3817,24 +3860,25 @@
   Py_CLEAR(clear_module_state->__pyx_kp_s_Step_may_not_be_zero_axis_d);
   Py_CLEAR(clear_module_state->__pyx_n_s_TypeError);
   Py_CLEAR(clear_module_state->__pyx_n_s_UINT32);
   Py_CLEAR(clear_module_state->__pyx_kp_s_Unable_to_convert_item_to_object);
   Py_CLEAR(clear_module_state->__pyx_n_s_ValueError);
   Py_CLEAR(clear_module_state->__pyx_n_s_View_MemoryView);
   Py_CLEAR(clear_module_state->__pyx_kp_u__2);
-  Py_CLEAR(clear_module_state->__pyx_n_s__25);
   Py_CLEAR(clear_module_state->__pyx_n_s__3);
+  Py_CLEAR(clear_module_state->__pyx_n_s__31);
   Py_CLEAR(clear_module_state->__pyx_kp_u__6);
   Py_CLEAR(clear_module_state->__pyx_kp_u__7);
   Py_CLEAR(clear_module_state->__pyx_n_s_a);
   Py_CLEAR(clear_module_state->__pyx_n_s_abc);
   Py_CLEAR(clear_module_state->__pyx_n_s_allocate_buffer);
   Py_CLEAR(clear_module_state->__pyx_kp_u_and);
   Py_CLEAR(clear_module_state->__pyx_n_s_asyncio_coroutines);
   Py_CLEAR(clear_module_state->__pyx_n_s_base);
+  Py_CLEAR(clear_module_state->__pyx_n_s_bonds);
   Py_CLEAR(clear_module_state->__pyx_n_s_box);
   Py_CLEAR(clear_module_state->__pyx_n_s_box_center);
   Py_CLEAR(clear_module_state->__pyx_n_s_c);
   Py_CLEAR(clear_module_state->__pyx_n_u_c);
   Py_CLEAR(clear_module_state->__pyx_n_s_calculate);
   Py_CLEAR(clear_module_state->__pyx_n_s_centersel);
   Py_CLEAR(clear_module_state->__pyx_n_s_class);
@@ -3845,14 +3889,16 @@
   Py_CLEAR(clear_module_state->__pyx_kp_s_contiguous_and_direct);
   Py_CLEAR(clear_module_state->__pyx_kp_s_contiguous_and_indirect);
   Py_CLEAR(clear_module_state->__pyx_n_s_coords);
   Py_CLEAR(clear_module_state->__pyx_n_s_count);
   Py_CLEAR(clear_module_state->__pyx_n_s_dict);
   Py_CLEAR(clear_module_state->__pyx_n_s_diff);
   Py_CLEAR(clear_module_state->__pyx_kp_u_disable);
+  Py_CLEAR(clear_module_state->__pyx_n_s_disjoint_set_find);
+  Py_CLEAR(clear_module_state->__pyx_n_s_disjoint_set_merge);
   Py_CLEAR(clear_module_state->__pyx_n_s_dtype);
   Py_CLEAR(clear_module_state->__pyx_n_s_dtype_is_object);
   Py_CLEAR(clear_module_state->__pyx_kp_u_enable);
   Py_CLEAR(clear_module_state->__pyx_n_s_encode);
   Py_CLEAR(clear_module_state->__pyx_n_s_end_idx);
   Py_CLEAR(clear_module_state->__pyx_n_s_enumerate);
   Py_CLEAR(clear_module_state->__pyx_n_s_error);
@@ -3861,14 +3907,15 @@
   Py_CLEAR(clear_module_state->__pyx_n_s_float32);
   Py_CLEAR(clear_module_state->__pyx_n_s_float64);
   Py_CLEAR(clear_module_state->__pyx_n_s_format);
   Py_CLEAR(clear_module_state->__pyx_n_s_fortran);
   Py_CLEAR(clear_module_state->__pyx_n_u_fortran);
   Py_CLEAR(clear_module_state->__pyx_n_s_g);
   Py_CLEAR(clear_module_state->__pyx_kp_u_gc);
+  Py_CLEAR(clear_module_state->__pyx_n_s_get_bonded_groups);
   Py_CLEAR(clear_module_state->__pyx_n_s_getstate);
   Py_CLEAR(clear_module_state->__pyx_kp_u_got);
   Py_CLEAR(clear_module_state->__pyx_kp_u_got_differing_extents_in_dimensi);
   Py_CLEAR(clear_module_state->__pyx_n_s_groups);
   Py_CLEAR(clear_module_state->__pyx_n_s_grp_center);
   Py_CLEAR(clear_module_state->__pyx_n_s_half_box);
   Py_CLEAR(clear_module_state->__pyx_n_s_i);
@@ -3876,37 +3923,40 @@
   Py_CLEAR(clear_module_state->__pyx_n_s_import);
   Py_CLEAR(clear_module_state->__pyx_n_s_index);
   Py_CLEAR(clear_module_state->__pyx_n_s_initializing);
   Py_CLEAR(clear_module_state->__pyx_n_s_is_coroutine);
   Py_CLEAR(clear_module_state->__pyx_kp_u_isenabled);
   Py_CLEAR(clear_module_state->__pyx_n_s_itemsize);
   Py_CLEAR(clear_module_state->__pyx_kp_s_itemsize_0_for_cython_array);
+  Py_CLEAR(clear_module_state->__pyx_n_s_j);
   Py_CLEAR(clear_module_state->__pyx_n_s_k);
   Py_CLEAR(clear_module_state->__pyx_n_s_main);
   Py_CLEAR(clear_module_state->__pyx_n_s_math);
   Py_CLEAR(clear_module_state->__pyx_n_s_memview);
   Py_CLEAR(clear_module_state->__pyx_n_s_mode);
   Py_CLEAR(clear_module_state->__pyx_n_s_moleculekit_wrapping);
   Py_CLEAR(clear_module_state->__pyx_kp_s_moleculekit_wrapping_wrapping_py);
   Py_CLEAR(clear_module_state->__pyx_n_s_n);
   Py_CLEAR(clear_module_state->__pyx_n_s_n_atoms);
+  Py_CLEAR(clear_module_state->__pyx_n_s_n_bonds);
   Py_CLEAR(clear_module_state->__pyx_n_s_n_centersel);
   Py_CLEAR(clear_module_state->__pyx_n_s_n_frames);
   Py_CLEAR(clear_module_state->__pyx_n_s_n_groups);
   Py_CLEAR(clear_module_state->__pyx_n_s_name);
   Py_CLEAR(clear_module_state->__pyx_n_s_name_2);
   Py_CLEAR(clear_module_state->__pyx_n_s_ndim);
   Py_CLEAR(clear_module_state->__pyx_n_s_new);
   Py_CLEAR(clear_module_state->__pyx_kp_s_no_default___reduce___due_to_non);
   Py_CLEAR(clear_module_state->__pyx_n_s_np);
   Py_CLEAR(clear_module_state->__pyx_n_s_numpy);
   Py_CLEAR(clear_module_state->__pyx_kp_u_numpy_core_multiarray_failed_to);
   Py_CLEAR(clear_module_state->__pyx_kp_u_numpy_core_umath_failed_to_impor);
   Py_CLEAR(clear_module_state->__pyx_n_s_obj);
   Py_CLEAR(clear_module_state->__pyx_n_s_pack);
+  Py_CLEAR(clear_module_state->__pyx_n_s_parent);
   Py_CLEAR(clear_module_state->__pyx_n_s_pickle);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_PickleError);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_checksum);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_result);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_state);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_type);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_unpickle_Enum);
@@ -3936,14 +3986,16 @@
   Py_CLEAR(clear_module_state->__pyx_n_s_translation);
   Py_CLEAR(clear_module_state->__pyx_n_s_uint32);
   Py_CLEAR(clear_module_state->__pyx_kp_s_unable_to_allocate_array_data);
   Py_CLEAR(clear_module_state->__pyx_kp_s_unable_to_allocate_shape_and_str);
   Py_CLEAR(clear_module_state->__pyx_n_s_unpack);
   Py_CLEAR(clear_module_state->__pyx_n_s_update);
   Py_CLEAR(clear_module_state->__pyx_n_s_version_info);
+  Py_CLEAR(clear_module_state->__pyx_n_s_x);
+  Py_CLEAR(clear_module_state->__pyx_n_s_y);
   Py_CLEAR(clear_module_state->__pyx_n_s_zeros);
   Py_CLEAR(clear_module_state->__pyx_int_0);
   Py_CLEAR(clear_module_state->__pyx_int_1);
   Py_CLEAR(clear_module_state->__pyx_int_3);
   Py_CLEAR(clear_module_state->__pyx_int_112105877);
   Py_CLEAR(clear_module_state->__pyx_int_136983863);
   Py_CLEAR(clear_module_state->__pyx_int_184977713);
@@ -3961,16 +4013,22 @@
   Py_CLEAR(clear_module_state->__pyx_tuple__16);
   Py_CLEAR(clear_module_state->__pyx_tuple__17);
   Py_CLEAR(clear_module_state->__pyx_tuple__18);
   Py_CLEAR(clear_module_state->__pyx_tuple__19);
   Py_CLEAR(clear_module_state->__pyx_tuple__20);
   Py_CLEAR(clear_module_state->__pyx_tuple__21);
   Py_CLEAR(clear_module_state->__pyx_tuple__23);
+  Py_CLEAR(clear_module_state->__pyx_tuple__25);
+  Py_CLEAR(clear_module_state->__pyx_tuple__27);
+  Py_CLEAR(clear_module_state->__pyx_tuple__29);
   Py_CLEAR(clear_module_state->__pyx_codeobj__22);
   Py_CLEAR(clear_module_state->__pyx_codeobj__24);
+  Py_CLEAR(clear_module_state->__pyx_codeobj__26);
+  Py_CLEAR(clear_module_state->__pyx_codeobj__28);
+  Py_CLEAR(clear_module_state->__pyx_codeobj__30);
   return 0;
 }
 #endif
 /* #### Code section: module_state_traverse ### */
 #if CYTHON_USE_MODULE_STATE
 static int __pyx_m_traverse(PyObject *m, visitproc visit, void *arg) {
   __pyx_mstate *traverse_module_state = __pyx_mstate(m);
@@ -4043,24 +4101,25 @@
   Py_VISIT(traverse_module_state->__pyx_kp_s_Step_may_not_be_zero_axis_d);
   Py_VISIT(traverse_module_state->__pyx_n_s_TypeError);
   Py_VISIT(traverse_module_state->__pyx_n_s_UINT32);
   Py_VISIT(traverse_module_state->__pyx_kp_s_Unable_to_convert_item_to_object);
   Py_VISIT(traverse_module_state->__pyx_n_s_ValueError);
   Py_VISIT(traverse_module_state->__pyx_n_s_View_MemoryView);
   Py_VISIT(traverse_module_state->__pyx_kp_u__2);
-  Py_VISIT(traverse_module_state->__pyx_n_s__25);
   Py_VISIT(traverse_module_state->__pyx_n_s__3);
+  Py_VISIT(traverse_module_state->__pyx_n_s__31);
   Py_VISIT(traverse_module_state->__pyx_kp_u__6);
   Py_VISIT(traverse_module_state->__pyx_kp_u__7);
   Py_VISIT(traverse_module_state->__pyx_n_s_a);
   Py_VISIT(traverse_module_state->__pyx_n_s_abc);
   Py_VISIT(traverse_module_state->__pyx_n_s_allocate_buffer);
   Py_VISIT(traverse_module_state->__pyx_kp_u_and);
   Py_VISIT(traverse_module_state->__pyx_n_s_asyncio_coroutines);
   Py_VISIT(traverse_module_state->__pyx_n_s_base);
+  Py_VISIT(traverse_module_state->__pyx_n_s_bonds);
   Py_VISIT(traverse_module_state->__pyx_n_s_box);
   Py_VISIT(traverse_module_state->__pyx_n_s_box_center);
   Py_VISIT(traverse_module_state->__pyx_n_s_c);
   Py_VISIT(traverse_module_state->__pyx_n_u_c);
   Py_VISIT(traverse_module_state->__pyx_n_s_calculate);
   Py_VISIT(traverse_module_state->__pyx_n_s_centersel);
   Py_VISIT(traverse_module_state->__pyx_n_s_class);
@@ -4071,14 +4130,16 @@
   Py_VISIT(traverse_module_state->__pyx_kp_s_contiguous_and_direct);
   Py_VISIT(traverse_module_state->__pyx_kp_s_contiguous_and_indirect);
   Py_VISIT(traverse_module_state->__pyx_n_s_coords);
   Py_VISIT(traverse_module_state->__pyx_n_s_count);
   Py_VISIT(traverse_module_state->__pyx_n_s_dict);
   Py_VISIT(traverse_module_state->__pyx_n_s_diff);
   Py_VISIT(traverse_module_state->__pyx_kp_u_disable);
+  Py_VISIT(traverse_module_state->__pyx_n_s_disjoint_set_find);
+  Py_VISIT(traverse_module_state->__pyx_n_s_disjoint_set_merge);
   Py_VISIT(traverse_module_state->__pyx_n_s_dtype);
   Py_VISIT(traverse_module_state->__pyx_n_s_dtype_is_object);
   Py_VISIT(traverse_module_state->__pyx_kp_u_enable);
   Py_VISIT(traverse_module_state->__pyx_n_s_encode);
   Py_VISIT(traverse_module_state->__pyx_n_s_end_idx);
   Py_VISIT(traverse_module_state->__pyx_n_s_enumerate);
   Py_VISIT(traverse_module_state->__pyx_n_s_error);
@@ -4087,14 +4148,15 @@
   Py_VISIT(traverse_module_state->__pyx_n_s_float32);
   Py_VISIT(traverse_module_state->__pyx_n_s_float64);
   Py_VISIT(traverse_module_state->__pyx_n_s_format);
   Py_VISIT(traverse_module_state->__pyx_n_s_fortran);
   Py_VISIT(traverse_module_state->__pyx_n_u_fortran);
   Py_VISIT(traverse_module_state->__pyx_n_s_g);
   Py_VISIT(traverse_module_state->__pyx_kp_u_gc);
+  Py_VISIT(traverse_module_state->__pyx_n_s_get_bonded_groups);
   Py_VISIT(traverse_module_state->__pyx_n_s_getstate);
   Py_VISIT(traverse_module_state->__pyx_kp_u_got);
   Py_VISIT(traverse_module_state->__pyx_kp_u_got_differing_extents_in_dimensi);
   Py_VISIT(traverse_module_state->__pyx_n_s_groups);
   Py_VISIT(traverse_module_state->__pyx_n_s_grp_center);
   Py_VISIT(traverse_module_state->__pyx_n_s_half_box);
   Py_VISIT(traverse_module_state->__pyx_n_s_i);
@@ -4102,37 +4164,40 @@
   Py_VISIT(traverse_module_state->__pyx_n_s_import);
   Py_VISIT(traverse_module_state->__pyx_n_s_index);
   Py_VISIT(traverse_module_state->__pyx_n_s_initializing);
   Py_VISIT(traverse_module_state->__pyx_n_s_is_coroutine);
   Py_VISIT(traverse_module_state->__pyx_kp_u_isenabled);
   Py_VISIT(traverse_module_state->__pyx_n_s_itemsize);
   Py_VISIT(traverse_module_state->__pyx_kp_s_itemsize_0_for_cython_array);
+  Py_VISIT(traverse_module_state->__pyx_n_s_j);
   Py_VISIT(traverse_module_state->__pyx_n_s_k);
   Py_VISIT(traverse_module_state->__pyx_n_s_main);
   Py_VISIT(traverse_module_state->__pyx_n_s_math);
   Py_VISIT(traverse_module_state->__pyx_n_s_memview);
   Py_VISIT(traverse_module_state->__pyx_n_s_mode);
   Py_VISIT(traverse_module_state->__pyx_n_s_moleculekit_wrapping);
   Py_VISIT(traverse_module_state->__pyx_kp_s_moleculekit_wrapping_wrapping_py);
   Py_VISIT(traverse_module_state->__pyx_n_s_n);
   Py_VISIT(traverse_module_state->__pyx_n_s_n_atoms);
+  Py_VISIT(traverse_module_state->__pyx_n_s_n_bonds);
   Py_VISIT(traverse_module_state->__pyx_n_s_n_centersel);
   Py_VISIT(traverse_module_state->__pyx_n_s_n_frames);
   Py_VISIT(traverse_module_state->__pyx_n_s_n_groups);
   Py_VISIT(traverse_module_state->__pyx_n_s_name);
   Py_VISIT(traverse_module_state->__pyx_n_s_name_2);
   Py_VISIT(traverse_module_state->__pyx_n_s_ndim);
   Py_VISIT(traverse_module_state->__pyx_n_s_new);
   Py_VISIT(traverse_module_state->__pyx_kp_s_no_default___reduce___due_to_non);
   Py_VISIT(traverse_module_state->__pyx_n_s_np);
   Py_VISIT(traverse_module_state->__pyx_n_s_numpy);
   Py_VISIT(traverse_module_state->__pyx_kp_u_numpy_core_multiarray_failed_to);
   Py_VISIT(traverse_module_state->__pyx_kp_u_numpy_core_umath_failed_to_impor);
   Py_VISIT(traverse_module_state->__pyx_n_s_obj);
   Py_VISIT(traverse_module_state->__pyx_n_s_pack);
+  Py_VISIT(traverse_module_state->__pyx_n_s_parent);
   Py_VISIT(traverse_module_state->__pyx_n_s_pickle);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_PickleError);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_checksum);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_result);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_state);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_type);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_unpickle_Enum);
@@ -4162,14 +4227,16 @@
   Py_VISIT(traverse_module_state->__pyx_n_s_translation);
   Py_VISIT(traverse_module_state->__pyx_n_s_uint32);
   Py_VISIT(traverse_module_state->__pyx_kp_s_unable_to_allocate_array_data);
   Py_VISIT(traverse_module_state->__pyx_kp_s_unable_to_allocate_shape_and_str);
   Py_VISIT(traverse_module_state->__pyx_n_s_unpack);
   Py_VISIT(traverse_module_state->__pyx_n_s_update);
   Py_VISIT(traverse_module_state->__pyx_n_s_version_info);
+  Py_VISIT(traverse_module_state->__pyx_n_s_x);
+  Py_VISIT(traverse_module_state->__pyx_n_s_y);
   Py_VISIT(traverse_module_state->__pyx_n_s_zeros);
   Py_VISIT(traverse_module_state->__pyx_int_0);
   Py_VISIT(traverse_module_state->__pyx_int_1);
   Py_VISIT(traverse_module_state->__pyx_int_3);
   Py_VISIT(traverse_module_state->__pyx_int_112105877);
   Py_VISIT(traverse_module_state->__pyx_int_136983863);
   Py_VISIT(traverse_module_state->__pyx_int_184977713);
@@ -4187,16 +4254,22 @@
   Py_VISIT(traverse_module_state->__pyx_tuple__16);
   Py_VISIT(traverse_module_state->__pyx_tuple__17);
   Py_VISIT(traverse_module_state->__pyx_tuple__18);
   Py_VISIT(traverse_module_state->__pyx_tuple__19);
   Py_VISIT(traverse_module_state->__pyx_tuple__20);
   Py_VISIT(traverse_module_state->__pyx_tuple__21);
   Py_VISIT(traverse_module_state->__pyx_tuple__23);
+  Py_VISIT(traverse_module_state->__pyx_tuple__25);
+  Py_VISIT(traverse_module_state->__pyx_tuple__27);
+  Py_VISIT(traverse_module_state->__pyx_tuple__29);
   Py_VISIT(traverse_module_state->__pyx_codeobj__22);
   Py_VISIT(traverse_module_state->__pyx_codeobj__24);
+  Py_VISIT(traverse_module_state->__pyx_codeobj__26);
+  Py_VISIT(traverse_module_state->__pyx_codeobj__28);
+  Py_VISIT(traverse_module_state->__pyx_codeobj__30);
   return 0;
 }
 #endif
 /* #### Code section: module_state_defines ### */
 #define __pyx_d __pyx_mstate_global->__pyx_d
 #define __pyx_b __pyx_mstate_global->__pyx_b
 #define __pyx_cython_runtime __pyx_mstate_global->__pyx_cython_runtime
@@ -4309,24 +4382,25 @@
 #define __pyx_kp_s_Step_may_not_be_zero_axis_d __pyx_mstate_global->__pyx_kp_s_Step_may_not_be_zero_axis_d
 #define __pyx_n_s_TypeError __pyx_mstate_global->__pyx_n_s_TypeError
 #define __pyx_n_s_UINT32 __pyx_mstate_global->__pyx_n_s_UINT32
 #define __pyx_kp_s_Unable_to_convert_item_to_object __pyx_mstate_global->__pyx_kp_s_Unable_to_convert_item_to_object
 #define __pyx_n_s_ValueError __pyx_mstate_global->__pyx_n_s_ValueError
 #define __pyx_n_s_View_MemoryView __pyx_mstate_global->__pyx_n_s_View_MemoryView
 #define __pyx_kp_u__2 __pyx_mstate_global->__pyx_kp_u__2
-#define __pyx_n_s__25 __pyx_mstate_global->__pyx_n_s__25
 #define __pyx_n_s__3 __pyx_mstate_global->__pyx_n_s__3
+#define __pyx_n_s__31 __pyx_mstate_global->__pyx_n_s__31
 #define __pyx_kp_u__6 __pyx_mstate_global->__pyx_kp_u__6
 #define __pyx_kp_u__7 __pyx_mstate_global->__pyx_kp_u__7
 #define __pyx_n_s_a __pyx_mstate_global->__pyx_n_s_a
 #define __pyx_n_s_abc __pyx_mstate_global->__pyx_n_s_abc
 #define __pyx_n_s_allocate_buffer __pyx_mstate_global->__pyx_n_s_allocate_buffer
 #define __pyx_kp_u_and __pyx_mstate_global->__pyx_kp_u_and
 #define __pyx_n_s_asyncio_coroutines __pyx_mstate_global->__pyx_n_s_asyncio_coroutines
 #define __pyx_n_s_base __pyx_mstate_global->__pyx_n_s_base
+#define __pyx_n_s_bonds __pyx_mstate_global->__pyx_n_s_bonds
 #define __pyx_n_s_box __pyx_mstate_global->__pyx_n_s_box
 #define __pyx_n_s_box_center __pyx_mstate_global->__pyx_n_s_box_center
 #define __pyx_n_s_c __pyx_mstate_global->__pyx_n_s_c
 #define __pyx_n_u_c __pyx_mstate_global->__pyx_n_u_c
 #define __pyx_n_s_calculate __pyx_mstate_global->__pyx_n_s_calculate
 #define __pyx_n_s_centersel __pyx_mstate_global->__pyx_n_s_centersel
 #define __pyx_n_s_class __pyx_mstate_global->__pyx_n_s_class
@@ -4337,14 +4411,16 @@
 #define __pyx_kp_s_contiguous_and_direct __pyx_mstate_global->__pyx_kp_s_contiguous_and_direct
 #define __pyx_kp_s_contiguous_and_indirect __pyx_mstate_global->__pyx_kp_s_contiguous_and_indirect
 #define __pyx_n_s_coords __pyx_mstate_global->__pyx_n_s_coords
 #define __pyx_n_s_count __pyx_mstate_global->__pyx_n_s_count
 #define __pyx_n_s_dict __pyx_mstate_global->__pyx_n_s_dict
 #define __pyx_n_s_diff __pyx_mstate_global->__pyx_n_s_diff
 #define __pyx_kp_u_disable __pyx_mstate_global->__pyx_kp_u_disable
+#define __pyx_n_s_disjoint_set_find __pyx_mstate_global->__pyx_n_s_disjoint_set_find
+#define __pyx_n_s_disjoint_set_merge __pyx_mstate_global->__pyx_n_s_disjoint_set_merge
 #define __pyx_n_s_dtype __pyx_mstate_global->__pyx_n_s_dtype
 #define __pyx_n_s_dtype_is_object __pyx_mstate_global->__pyx_n_s_dtype_is_object
 #define __pyx_kp_u_enable __pyx_mstate_global->__pyx_kp_u_enable
 #define __pyx_n_s_encode __pyx_mstate_global->__pyx_n_s_encode
 #define __pyx_n_s_end_idx __pyx_mstate_global->__pyx_n_s_end_idx
 #define __pyx_n_s_enumerate __pyx_mstate_global->__pyx_n_s_enumerate
 #define __pyx_n_s_error __pyx_mstate_global->__pyx_n_s_error
@@ -4353,14 +4429,15 @@
 #define __pyx_n_s_float32 __pyx_mstate_global->__pyx_n_s_float32
 #define __pyx_n_s_float64 __pyx_mstate_global->__pyx_n_s_float64
 #define __pyx_n_s_format __pyx_mstate_global->__pyx_n_s_format
 #define __pyx_n_s_fortran __pyx_mstate_global->__pyx_n_s_fortran
 #define __pyx_n_u_fortran __pyx_mstate_global->__pyx_n_u_fortran
 #define __pyx_n_s_g __pyx_mstate_global->__pyx_n_s_g
 #define __pyx_kp_u_gc __pyx_mstate_global->__pyx_kp_u_gc
+#define __pyx_n_s_get_bonded_groups __pyx_mstate_global->__pyx_n_s_get_bonded_groups
 #define __pyx_n_s_getstate __pyx_mstate_global->__pyx_n_s_getstate
 #define __pyx_kp_u_got __pyx_mstate_global->__pyx_kp_u_got
 #define __pyx_kp_u_got_differing_extents_in_dimensi __pyx_mstate_global->__pyx_kp_u_got_differing_extents_in_dimensi
 #define __pyx_n_s_groups __pyx_mstate_global->__pyx_n_s_groups
 #define __pyx_n_s_grp_center __pyx_mstate_global->__pyx_n_s_grp_center
 #define __pyx_n_s_half_box __pyx_mstate_global->__pyx_n_s_half_box
 #define __pyx_n_s_i __pyx_mstate_global->__pyx_n_s_i
@@ -4368,37 +4445,40 @@
 #define __pyx_n_s_import __pyx_mstate_global->__pyx_n_s_import
 #define __pyx_n_s_index __pyx_mstate_global->__pyx_n_s_index
 #define __pyx_n_s_initializing __pyx_mstate_global->__pyx_n_s_initializing
 #define __pyx_n_s_is_coroutine __pyx_mstate_global->__pyx_n_s_is_coroutine
 #define __pyx_kp_u_isenabled __pyx_mstate_global->__pyx_kp_u_isenabled
 #define __pyx_n_s_itemsize __pyx_mstate_global->__pyx_n_s_itemsize
 #define __pyx_kp_s_itemsize_0_for_cython_array __pyx_mstate_global->__pyx_kp_s_itemsize_0_for_cython_array
+#define __pyx_n_s_j __pyx_mstate_global->__pyx_n_s_j
 #define __pyx_n_s_k __pyx_mstate_global->__pyx_n_s_k
 #define __pyx_n_s_main __pyx_mstate_global->__pyx_n_s_main
 #define __pyx_n_s_math __pyx_mstate_global->__pyx_n_s_math
 #define __pyx_n_s_memview __pyx_mstate_global->__pyx_n_s_memview
 #define __pyx_n_s_mode __pyx_mstate_global->__pyx_n_s_mode
 #define __pyx_n_s_moleculekit_wrapping __pyx_mstate_global->__pyx_n_s_moleculekit_wrapping
 #define __pyx_kp_s_moleculekit_wrapping_wrapping_py __pyx_mstate_global->__pyx_kp_s_moleculekit_wrapping_wrapping_py
 #define __pyx_n_s_n __pyx_mstate_global->__pyx_n_s_n
 #define __pyx_n_s_n_atoms __pyx_mstate_global->__pyx_n_s_n_atoms
+#define __pyx_n_s_n_bonds __pyx_mstate_global->__pyx_n_s_n_bonds
 #define __pyx_n_s_n_centersel __pyx_mstate_global->__pyx_n_s_n_centersel
 #define __pyx_n_s_n_frames __pyx_mstate_global->__pyx_n_s_n_frames
 #define __pyx_n_s_n_groups __pyx_mstate_global->__pyx_n_s_n_groups
 #define __pyx_n_s_name __pyx_mstate_global->__pyx_n_s_name
 #define __pyx_n_s_name_2 __pyx_mstate_global->__pyx_n_s_name_2
 #define __pyx_n_s_ndim __pyx_mstate_global->__pyx_n_s_ndim
 #define __pyx_n_s_new __pyx_mstate_global->__pyx_n_s_new
 #define __pyx_kp_s_no_default___reduce___due_to_non __pyx_mstate_global->__pyx_kp_s_no_default___reduce___due_to_non
 #define __pyx_n_s_np __pyx_mstate_global->__pyx_n_s_np
 #define __pyx_n_s_numpy __pyx_mstate_global->__pyx_n_s_numpy
 #define __pyx_kp_u_numpy_core_multiarray_failed_to __pyx_mstate_global->__pyx_kp_u_numpy_core_multiarray_failed_to
 #define __pyx_kp_u_numpy_core_umath_failed_to_impor __pyx_mstate_global->__pyx_kp_u_numpy_core_umath_failed_to_impor
 #define __pyx_n_s_obj __pyx_mstate_global->__pyx_n_s_obj
 #define __pyx_n_s_pack __pyx_mstate_global->__pyx_n_s_pack
+#define __pyx_n_s_parent __pyx_mstate_global->__pyx_n_s_parent
 #define __pyx_n_s_pickle __pyx_mstate_global->__pyx_n_s_pickle
 #define __pyx_n_s_pyx_PickleError __pyx_mstate_global->__pyx_n_s_pyx_PickleError
 #define __pyx_n_s_pyx_checksum __pyx_mstate_global->__pyx_n_s_pyx_checksum
 #define __pyx_n_s_pyx_result __pyx_mstate_global->__pyx_n_s_pyx_result
 #define __pyx_n_s_pyx_state __pyx_mstate_global->__pyx_n_s_pyx_state
 #define __pyx_n_s_pyx_type __pyx_mstate_global->__pyx_n_s_pyx_type
 #define __pyx_n_s_pyx_unpickle_Enum __pyx_mstate_global->__pyx_n_s_pyx_unpickle_Enum
@@ -4428,14 +4508,16 @@
 #define __pyx_n_s_translation __pyx_mstate_global->__pyx_n_s_translation
 #define __pyx_n_s_uint32 __pyx_mstate_global->__pyx_n_s_uint32
 #define __pyx_kp_s_unable_to_allocate_array_data __pyx_mstate_global->__pyx_kp_s_unable_to_allocate_array_data
 #define __pyx_kp_s_unable_to_allocate_shape_and_str __pyx_mstate_global->__pyx_kp_s_unable_to_allocate_shape_and_str
 #define __pyx_n_s_unpack __pyx_mstate_global->__pyx_n_s_unpack
 #define __pyx_n_s_update __pyx_mstate_global->__pyx_n_s_update
 #define __pyx_n_s_version_info __pyx_mstate_global->__pyx_n_s_version_info
+#define __pyx_n_s_x __pyx_mstate_global->__pyx_n_s_x
+#define __pyx_n_s_y __pyx_mstate_global->__pyx_n_s_y
 #define __pyx_n_s_zeros __pyx_mstate_global->__pyx_n_s_zeros
 #define __pyx_int_0 __pyx_mstate_global->__pyx_int_0
 #define __pyx_int_1 __pyx_mstate_global->__pyx_int_1
 #define __pyx_int_3 __pyx_mstate_global->__pyx_int_3
 #define __pyx_int_112105877 __pyx_mstate_global->__pyx_int_112105877
 #define __pyx_int_136983863 __pyx_mstate_global->__pyx_int_136983863
 #define __pyx_int_184977713 __pyx_mstate_global->__pyx_int_184977713
@@ -4453,16 +4535,22 @@
 #define __pyx_tuple__16 __pyx_mstate_global->__pyx_tuple__16
 #define __pyx_tuple__17 __pyx_mstate_global->__pyx_tuple__17
 #define __pyx_tuple__18 __pyx_mstate_global->__pyx_tuple__18
 #define __pyx_tuple__19 __pyx_mstate_global->__pyx_tuple__19
 #define __pyx_tuple__20 __pyx_mstate_global->__pyx_tuple__20
 #define __pyx_tuple__21 __pyx_mstate_global->__pyx_tuple__21
 #define __pyx_tuple__23 __pyx_mstate_global->__pyx_tuple__23
+#define __pyx_tuple__25 __pyx_mstate_global->__pyx_tuple__25
+#define __pyx_tuple__27 __pyx_mstate_global->__pyx_tuple__27
+#define __pyx_tuple__29 __pyx_mstate_global->__pyx_tuple__29
 #define __pyx_codeobj__22 __pyx_mstate_global->__pyx_codeobj__22
 #define __pyx_codeobj__24 __pyx_mstate_global->__pyx_codeobj__24
+#define __pyx_codeobj__26 __pyx_mstate_global->__pyx_codeobj__26
+#define __pyx_codeobj__28 __pyx_mstate_global->__pyx_codeobj__28
+#define __pyx_codeobj__30 __pyx_mstate_global->__pyx_codeobj__30
 /* #### Code section: module_code ### */
 
 /* "View.MemoryView":131
  *         cdef bint dtype_is_object
  * 
  *     def __cinit__(array self, tuple shape, Py_ssize_t itemsize, format not None,             # <<<<<<<<<<<<<<
  *                   mode="c", bint allocate_buffer=True):
@@ -18083,261 +18171,261 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_7ndarray_4base_base(PyArrayObject *__pyx_v_self) {
   PyObject *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":248
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":248
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  *             return PyArray_BASE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_BASE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
 static CYTHON_INLINE PyArray_Descr *__pyx_f_5numpy_7ndarray_5descr_descr(PyArrayObject *__pyx_v_self) {
   PyArray_Descr *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyArray_Descr *__pyx_t_1;
   __Pyx_RefNannySetupContext("descr", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":254
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":254
  *             """Returns an owned reference to the dtype of the array.
  *             """
  *             return <dtype>PyArray_DESCR(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __pyx_t_1 = PyArray_DESCR(__pyx_v_self);
   __Pyx_INCREF((PyObject *)((PyArray_Descr *)__pyx_t_1));
   __pyx_r = ((PyArray_Descr *)__pyx_t_1);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_7ndarray_4ndim_ndim(PyArrayObject *__pyx_v_self) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":260
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":260
  *             """Returns the number of dimensions in the array.
  *             """
  *             return PyArray_NDIM(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_NDIM(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_5shape_shape(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":268
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":268
  *             Can return NULL for 0-dimensional arrays.
  *             """
  *             return PyArray_DIMS(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_DIMS(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_7strides_strides(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":275
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":275
  *             The number of elements matches the number of dimensions of the array (ndim).
  *             """
  *             return PyArray_STRIDES(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_STRIDES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
 static CYTHON_INLINE npy_intp __pyx_f_5numpy_7ndarray_4size_size(PyArrayObject *__pyx_v_self) {
   npy_intp __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":281
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":281
  *             """Returns the total size (in number of elements) of the array.
  *             """
  *             return PyArray_SIZE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_SIZE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
 static CYTHON_INLINE char *__pyx_f_5numpy_7ndarray_4data_data(PyArrayObject *__pyx_v_self) {
   char *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":290
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":290
  *             of `PyArray_DATA()` instead, which returns a 'void*'.
  *             """
  *             return PyArray_BYTES(self)             # <<<<<<<<<<<<<<
  * 
  *     ctypedef unsigned char      npy_bool
  */
   __pyx_r = PyArray_BYTES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -18346,29 +18434,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":774
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":774
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 774, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -18379,15 +18467,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -18396,29 +18484,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":777
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":777
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -18429,15 +18517,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -18446,29 +18534,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":780
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":780
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 780, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -18479,15 +18567,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -18496,29 +18584,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":783
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":783
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -18529,15 +18617,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -18546,29 +18634,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":786
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":786
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -18579,217 +18667,217 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = PyDataType_HASSUBARRAY(__pyx_v_d);
   if (__pyx_t_1) {
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":790
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":790
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":792
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":792
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":968
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":968
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":969
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":969
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   __pyx_t_1 = PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(2, 969, __pyx_L1_error)
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_AddTraceback("numpy.set_array_base", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":972
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":972
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = (__pyx_v_base == NULL);
   if (__pyx_t_1) {
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":974
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":974
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":975
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":975
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -18805,15 +18893,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -18821,68 +18909,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":981
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":981
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 981, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":982
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":982
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 982, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 983, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 983, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -18890,15 +18978,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -18913,15 +19001,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -18937,15 +19025,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -18953,68 +19041,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":987
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":987
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 987, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":988
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":988
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 988, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 989, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 989, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19022,15 +19110,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19045,15 +19133,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19069,15 +19157,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19085,68 +19173,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":993
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":993
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 993, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":994
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":994
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 994, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":995
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":995
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 995, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 995, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19154,15 +19242,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19177,200 +19265,1158 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1010
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1010
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1025
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1025
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
 static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
   npy_datetime __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1035
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1035
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
 static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
   npy_timedelta __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1042
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1042
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
 static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
   NPY_DATETIMEUNIT __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1049
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1049
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "moleculekit/wrapping/wrapping.pyx":28
+/* "moleculekit/wrapping/wrapping.pyx":30
+ * # https://en.wikipedia.org/wiki/Disjoint-set_data_structure
+ * # Disjoint set implementation for finding the connected components of our molecule
+ * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
+ * @cython.wraparound(False)  # turn off negative index wrapping for entire function
+ * def disjoint_set_find(
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_11moleculekit_8wrapping_1disjoint_set_find(PyObject *__pyx_self, 
+#if CYTHON_METH_FASTCALL
+PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
+#else
+PyObject *__pyx_args, PyObject *__pyx_kwds
+#endif
+); /*proto*/
+static PyMethodDef __pyx_mdef_11moleculekit_8wrapping_1disjoint_set_find = {"disjoint_set_find", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11moleculekit_8wrapping_1disjoint_set_find, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11moleculekit_8wrapping_1disjoint_set_find(PyObject *__pyx_self, 
+#if CYTHON_METH_FASTCALL
+PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
+#else
+PyObject *__pyx_args, PyObject *__pyx_kwds
+#endif
+) {
+  __pyx_t_11moleculekit_8wrapping_UINT32_t __pyx_v_x;
+  __Pyx_memviewslice __pyx_v_parent = { 0, 0, { 0 }, { 0 }, { 0 } };
+  #if !CYTHON_METH_FASTCALL
+  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
+  #endif
+  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
+  PyObject* values[2] = {0,0};
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("disjoint_set_find (wrapper)", 0);
+  #if !CYTHON_METH_FASTCALL
+  #if CYTHON_ASSUME_SAFE_MACROS
+  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
+  #else
+  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
+  #endif
+  #endif
+  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
+  {
+    PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_parent,0};
+    if (__pyx_kwds) {
+      Py_ssize_t kw_args;
+      switch (__pyx_nargs) {
+        case  2: values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
+        CYTHON_FALLTHROUGH;
+        case  1: values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
+        CYTHON_FALLTHROUGH;
+        case  0: break;
+        default: goto __pyx_L5_argtuple_error;
+      }
+      kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
+      switch (__pyx_nargs) {
+        case  0:
+        if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_x)) != 0)) {
+          (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
+          kw_args--;
+        }
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 30, __pyx_L3_error)
+        else goto __pyx_L5_argtuple_error;
+        CYTHON_FALLTHROUGH;
+        case  1:
+        if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_parent)) != 0)) {
+          (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
+          kw_args--;
+        }
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 30, __pyx_L3_error)
+        else {
+          __Pyx_RaiseArgtupleInvalid("disjoint_set_find", 1, 2, 2, 1); __PYX_ERR(0, 30, __pyx_L3_error)
+        }
+      }
+      if (unlikely(kw_args > 0)) {
+        const Py_ssize_t kwd_pos_args = __pyx_nargs;
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "disjoint_set_find") < 0)) __PYX_ERR(0, 30, __pyx_L3_error)
+      }
+    } else if (unlikely(__pyx_nargs != 2)) {
+      goto __pyx_L5_argtuple_error;
+    } else {
+      values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
+      values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
+    }
+    __pyx_v_x = __Pyx_PyInt_As_npy_uint32(values[0]); if (unlikely((__pyx_v_x == ((npy_uint32)-1)) && PyErr_Occurred())) __PYX_ERR(0, 33, __pyx_L3_error)
+    __pyx_v_parent = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_8wrapping_UINT32_t(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_parent.memview)) __PYX_ERR(0, 34, __pyx_L3_error)
+  }
+  goto __pyx_L6_skip;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("disjoint_set_find", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 30, __pyx_L3_error)
+  __pyx_L6_skip:;
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L3_error:;
+  {
+    Py_ssize_t __pyx_temp;
+    for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
+      __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
+    }
+  }
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_parent, 1);
+  __Pyx_AddTraceback("moleculekit.wrapping.disjoint_set_find", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannyFinishContext();
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __pyx_r = __pyx_pf_11moleculekit_8wrapping_disjoint_set_find(__pyx_self, __pyx_v_x, __pyx_v_parent);
+
+  /* function exit code */
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_parent, 1);
+  {
+    Py_ssize_t __pyx_temp;
+    for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
+      __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
+    }
+  }
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_11moleculekit_8wrapping_disjoint_set_find(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_11moleculekit_8wrapping_UINT32_t __pyx_v_x, __Pyx_memviewslice __pyx_v_parent) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  size_t __pyx_t_1;
+  int __pyx_t_2;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
+  PyObject *__pyx_t_6 = NULL;
+  PyObject *__pyx_t_7 = NULL;
+  int __pyx_t_8;
+  __pyx_t_11moleculekit_8wrapping_UINT32_t __pyx_t_9;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("disjoint_set_find", 1);
+
+  /* "moleculekit/wrapping/wrapping.pyx":42
+ * 
+ *     # Path compression implementation
+ *     if parent[x] != x:             # <<<<<<<<<<<<<<
+ *         parent[x] = disjoint_set_find(parent[x], parent)
+ *         return parent[x]
+ */
+  __pyx_t_1 = __pyx_v_x;
+  __pyx_t_2 = ((*((__pyx_t_11moleculekit_8wrapping_UINT32_t *) ( /* dim=0 */ (__pyx_v_parent.data + __pyx_t_1 * __pyx_v_parent.strides[0]) ))) != __pyx_v_x);
+  if (__pyx_t_2) {
+
+    /* "moleculekit/wrapping/wrapping.pyx":43
+ *     # Path compression implementation
+ *     if parent[x] != x:
+ *         parent[x] = disjoint_set_find(parent[x], parent)             # <<<<<<<<<<<<<<
+ *         return parent[x]
+ *     else:
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_disjoint_set_find); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 43, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_1 = __pyx_v_x;
+    __pyx_t_5 = __Pyx_PyInt_From_npy_uint32((*((__pyx_t_11moleculekit_8wrapping_UINT32_t *) ( /* dim=0 */ (__pyx_v_parent.data + __pyx_t_1 * __pyx_v_parent.strides[0]) )))); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 43, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_parent, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_11moleculekit_8wrapping_UINT32_t, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_11moleculekit_8wrapping_UINT32_t, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 43, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_7 = NULL;
+    __pyx_t_8 = 0;
+    #if CYTHON_UNPACK_METHODS
+    if (unlikely(PyMethod_Check(__pyx_t_4))) {
+      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_4);
+      if (likely(__pyx_t_7)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
+        __Pyx_INCREF(__pyx_t_7);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_4, function);
+        __pyx_t_8 = 1;
+      }
+    }
+    #endif
+    {
+      PyObject *__pyx_callargs[3] = {__pyx_t_7, __pyx_t_5, __pyx_t_6};
+      __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_8, 2+__pyx_t_8);
+      __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 43, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    }
+    __pyx_t_9 = __Pyx_PyInt_As_npy_uint32(__pyx_t_3); if (unlikely((__pyx_t_9 == ((npy_uint32)-1)) && PyErr_Occurred())) __PYX_ERR(0, 43, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_1 = __pyx_v_x;
+    *((__pyx_t_11moleculekit_8wrapping_UINT32_t *) ( /* dim=0 */ (__pyx_v_parent.data + __pyx_t_1 * __pyx_v_parent.strides[0]) )) = __pyx_t_9;
+
+    /* "moleculekit/wrapping/wrapping.pyx":44
+ *     if parent[x] != x:
+ *         parent[x] = disjoint_set_find(parent[x], parent)
+ *         return parent[x]             # <<<<<<<<<<<<<<
+ *     else:
+ *         return x
+ */
+    __Pyx_XDECREF(__pyx_r);
+    __pyx_t_1 = __pyx_v_x;
+    __pyx_t_3 = __Pyx_PyInt_From_npy_uint32((*((__pyx_t_11moleculekit_8wrapping_UINT32_t *) ( /* dim=0 */ (__pyx_v_parent.data + __pyx_t_1 * __pyx_v_parent.strides[0]) )))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 44, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_r = __pyx_t_3;
+    __pyx_t_3 = 0;
+    goto __pyx_L0;
+
+    /* "moleculekit/wrapping/wrapping.pyx":42
+ * 
+ *     # Path compression implementation
+ *     if parent[x] != x:             # <<<<<<<<<<<<<<
+ *         parent[x] = disjoint_set_find(parent[x], parent)
+ *         return parent[x]
+ */
+  }
+
+  /* "moleculekit/wrapping/wrapping.pyx":46
+ *         return parent[x]
+ *     else:
+ *         return x             # <<<<<<<<<<<<<<
+ *     return x
+ * 
+ */
+  /*else*/ {
+    __Pyx_XDECREF(__pyx_r);
+    __pyx_t_3 = __Pyx_PyInt_From_npy_uint32(__pyx_v_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 46, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_r = __pyx_t_3;
+    __pyx_t_3 = 0;
+    goto __pyx_L0;
+  }
+
+  /* "moleculekit/wrapping/wrapping.pyx":30
+ * # https://en.wikipedia.org/wiki/Disjoint-set_data_structure
+ * # Disjoint set implementation for finding the connected components of our molecule
+ * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
+ * @cython.wraparound(False)  # turn off negative index wrapping for entire function
+ * def disjoint_set_find(
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_AddTraceback("moleculekit.wrapping.disjoint_set_find", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "moleculekit/wrapping/wrapping.pyx":49
+ *     return x
+ * 
+ * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
+ * @cython.wraparound(False)  # turn off negative index wrapping for entire function
+ * def disjoint_set_merge(
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_11moleculekit_8wrapping_3disjoint_set_merge(PyObject *__pyx_self, 
+#if CYTHON_METH_FASTCALL
+PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
+#else
+PyObject *__pyx_args, PyObject *__pyx_kwds
+#endif
+); /*proto*/
+static PyMethodDef __pyx_mdef_11moleculekit_8wrapping_3disjoint_set_merge = {"disjoint_set_merge", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11moleculekit_8wrapping_3disjoint_set_merge, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11moleculekit_8wrapping_3disjoint_set_merge(PyObject *__pyx_self, 
+#if CYTHON_METH_FASTCALL
+PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
+#else
+PyObject *__pyx_args, PyObject *__pyx_kwds
+#endif
+) {
+  __pyx_t_11moleculekit_8wrapping_UINT32_t __pyx_v_x;
+  __pyx_t_11moleculekit_8wrapping_UINT32_t __pyx_v_y;
+  __Pyx_memviewslice __pyx_v_parent = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_size = { 0, 0, { 0 }, { 0 }, { 0 } };
+  #if !CYTHON_METH_FASTCALL
+  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
+  #endif
+  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
+  PyObject* values[4] = {0,0,0,0};
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("disjoint_set_merge (wrapper)", 0);
+  #if !CYTHON_METH_FASTCALL
+  #if CYTHON_ASSUME_SAFE_MACROS
+  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
+  #else
+  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
+  #endif
+  #endif
+  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
+  {
+    PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_y,&__pyx_n_s_parent,&__pyx_n_s_size,0};
+    if (__pyx_kwds) {
+      Py_ssize_t kw_args;
+      switch (__pyx_nargs) {
+        case  4: values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
+        CYTHON_FALLTHROUGH;
+        case  3: values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
+        CYTHON_FALLTHROUGH;
+        case  2: values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
+        CYTHON_FALLTHROUGH;
+        case  1: values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
+        CYTHON_FALLTHROUGH;
+        case  0: break;
+        default: goto __pyx_L5_argtuple_error;
+      }
+      kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
+      switch (__pyx_nargs) {
+        case  0:
+        if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_x)) != 0)) {
+          (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
+          kw_args--;
+        }
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 49, __pyx_L3_error)
+        else goto __pyx_L5_argtuple_error;
+        CYTHON_FALLTHROUGH;
+        case  1:
+        if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y)) != 0)) {
+          (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
+          kw_args--;
+        }
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 49, __pyx_L3_error)
+        else {
+          __Pyx_RaiseArgtupleInvalid("disjoint_set_merge", 1, 4, 4, 1); __PYX_ERR(0, 49, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  2:
+        if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_parent)) != 0)) {
+          (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
+          kw_args--;
+        }
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 49, __pyx_L3_error)
+        else {
+          __Pyx_RaiseArgtupleInvalid("disjoint_set_merge", 1, 4, 4, 2); __PYX_ERR(0, 49, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  3:
+        if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_size)) != 0)) {
+          (void)__Pyx_Arg_NewRef_FASTCALL(values[3]);
+          kw_args--;
+        }
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 49, __pyx_L3_error)
+        else {
+          __Pyx_RaiseArgtupleInvalid("disjoint_set_merge", 1, 4, 4, 3); __PYX_ERR(0, 49, __pyx_L3_error)
+        }
+      }
+      if (unlikely(kw_args > 0)) {
+        const Py_ssize_t kwd_pos_args = __pyx_nargs;
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "disjoint_set_merge") < 0)) __PYX_ERR(0, 49, __pyx_L3_error)
+      }
+    } else if (unlikely(__pyx_nargs != 4)) {
+      goto __pyx_L5_argtuple_error;
+    } else {
+      values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
+      values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
+      values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
+      values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
+    }
+    __pyx_v_x = __Pyx_PyInt_As_npy_uint32(values[0]); if (unlikely((__pyx_v_x == ((npy_uint32)-1)) && PyErr_Occurred())) __PYX_ERR(0, 52, __pyx_L3_error)
+    __pyx_v_y = __Pyx_PyInt_As_npy_uint32(values[1]); if (unlikely((__pyx_v_y == ((npy_uint32)-1)) && PyErr_Occurred())) __PYX_ERR(0, 53, __pyx_L3_error)
+    __pyx_v_parent = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_8wrapping_UINT32_t(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_parent.memview)) __PYX_ERR(0, 54, __pyx_L3_error)
+    __pyx_v_size = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_8wrapping_UINT32_t(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_size.memview)) __PYX_ERR(0, 55, __pyx_L3_error)
+  }
+  goto __pyx_L6_skip;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("disjoint_set_merge", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 49, __pyx_L3_error)
+  __pyx_L6_skip:;
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L3_error:;
+  {
+    Py_ssize_t __pyx_temp;
+    for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
+      __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
+    }
+  }
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_parent, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_size, 1);
+  __Pyx_AddTraceback("moleculekit.wrapping.disjoint_set_merge", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannyFinishContext();
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __pyx_r = __pyx_pf_11moleculekit_8wrapping_2disjoint_set_merge(__pyx_self, __pyx_v_x, __pyx_v_y, __pyx_v_parent, __pyx_v_size);
+
+  /* function exit code */
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_parent, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_size, 1);
+  {
+    Py_ssize_t __pyx_temp;
+    for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
+      __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
+    }
+  }
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_11moleculekit_8wrapping_2disjoint_set_merge(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_11moleculekit_8wrapping_UINT32_t __pyx_v_x, __pyx_t_11moleculekit_8wrapping_UINT32_t __pyx_v_y, __Pyx_memviewslice __pyx_v_parent, __Pyx_memviewslice __pyx_v_size) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
+  int __pyx_t_6;
+  __pyx_t_11moleculekit_8wrapping_UINT32_t __pyx_t_7;
+  int __pyx_t_8;
+  size_t __pyx_t_9;
+  size_t __pyx_t_10;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("disjoint_set_merge", 1);
+
+  /* "moleculekit/wrapping/wrapping.pyx":58
+ *     ):
+ *     # Replace nodes by roots
+ *     x = disjoint_set_find(x, parent)             # <<<<<<<<<<<<<<
+ *     y = disjoint_set_find(y, parent)
+ * 
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_disjoint_set_find); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 58, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = __Pyx_PyInt_From_npy_uint32(__pyx_v_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 58, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_parent, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_11moleculekit_8wrapping_UINT32_t, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_11moleculekit_8wrapping_UINT32_t, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 58, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_5 = NULL;
+  __pyx_t_6 = 0;
+  #if CYTHON_UNPACK_METHODS
+  if (unlikely(PyMethod_Check(__pyx_t_2))) {
+    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
+    if (likely(__pyx_t_5)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
+      __Pyx_INCREF(__pyx_t_5);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_2, function);
+      __pyx_t_6 = 1;
+    }
+  }
+  #endif
+  {
+    PyObject *__pyx_callargs[3] = {__pyx_t_5, __pyx_t_3, __pyx_t_4};
+    __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
+    __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 58, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  }
+  __pyx_t_7 = __Pyx_PyInt_As_npy_uint32(__pyx_t_1); if (unlikely((__pyx_t_7 == ((npy_uint32)-1)) && PyErr_Occurred())) __PYX_ERR(0, 58, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_x = __pyx_t_7;
+
+  /* "moleculekit/wrapping/wrapping.pyx":59
+ *     # Replace nodes by roots
+ *     x = disjoint_set_find(x, parent)
+ *     y = disjoint_set_find(y, parent)             # <<<<<<<<<<<<<<
+ * 
+ *     if x == y:
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_disjoint_set_find); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 59, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_4 = __Pyx_PyInt_From_npy_uint32(__pyx_v_y); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 59, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_parent, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_11moleculekit_8wrapping_UINT32_t, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_11moleculekit_8wrapping_UINT32_t, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 59, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_5 = NULL;
+  __pyx_t_6 = 0;
+  #if CYTHON_UNPACK_METHODS
+  if (unlikely(PyMethod_Check(__pyx_t_2))) {
+    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
+    if (likely(__pyx_t_5)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
+      __Pyx_INCREF(__pyx_t_5);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_2, function);
+      __pyx_t_6 = 1;
+    }
+  }
+  #endif
+  {
+    PyObject *__pyx_callargs[3] = {__pyx_t_5, __pyx_t_4, __pyx_t_3};
+    __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
+    __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 59, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  }
+  __pyx_t_7 = __Pyx_PyInt_As_npy_uint32(__pyx_t_1); if (unlikely((__pyx_t_7 == ((npy_uint32)-1)) && PyErr_Occurred())) __PYX_ERR(0, 59, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_y = __pyx_t_7;
+
+  /* "moleculekit/wrapping/wrapping.pyx":61
+ *     y = disjoint_set_find(y, parent)
+ * 
+ *     if x == y:             # <<<<<<<<<<<<<<
+ *         return # x and y are already in the same set
+ * 
+ */
+  __pyx_t_8 = (__pyx_v_x == __pyx_v_y);
+  if (__pyx_t_8) {
+
+    /* "moleculekit/wrapping/wrapping.pyx":62
+ * 
+ *     if x == y:
+ *         return # x and y are already in the same set             # <<<<<<<<<<<<<<
+ * 
+ *     if size[x] < size[y]:
+ */
+    __Pyx_XDECREF(__pyx_r);
+    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+    goto __pyx_L0;
+
+    /* "moleculekit/wrapping/wrapping.pyx":61
+ *     y = disjoint_set_find(y, parent)
+ * 
+ *     if x == y:             # <<<<<<<<<<<<<<
+ *         return # x and y are already in the same set
+ * 
+ */
+  }
+
+  /* "moleculekit/wrapping/wrapping.pyx":64
+ *         return # x and y are already in the same set
+ * 
+ *     if size[x] < size[y]:             # <<<<<<<<<<<<<<
+ *         parent[x] = y
+ *         size[y] += size[x]
+ */
+  __pyx_t_9 = __pyx_v_x;
+  __pyx_t_10 = __pyx_v_y;
+  __pyx_t_8 = ((*((__pyx_t_11moleculekit_8wrapping_UINT32_t *) ( /* dim=0 */ (__pyx_v_size.data + __pyx_t_9 * __pyx_v_size.strides[0]) ))) < (*((__pyx_t_11moleculekit_8wrapping_UINT32_t *) ( /* dim=0 */ (__pyx_v_size.data + __pyx_t_10 * __pyx_v_size.strides[0]) ))));
+  if (__pyx_t_8) {
+
+    /* "moleculekit/wrapping/wrapping.pyx":65
+ * 
+ *     if size[x] < size[y]:
+ *         parent[x] = y             # <<<<<<<<<<<<<<
+ *         size[y] += size[x]
+ *     else:
+ */
+    __pyx_t_10 = __pyx_v_x;
+    *((__pyx_t_11moleculekit_8wrapping_UINT32_t *) ( /* dim=0 */ (__pyx_v_parent.data + __pyx_t_10 * __pyx_v_parent.strides[0]) )) = __pyx_v_y;
+
+    /* "moleculekit/wrapping/wrapping.pyx":66
+ *     if size[x] < size[y]:
+ *         parent[x] = y
+ *         size[y] += size[x]             # <<<<<<<<<<<<<<
+ *     else:
+ *         parent[y] = x
+ */
+    __pyx_t_10 = __pyx_v_x;
+    __pyx_t_9 = __pyx_v_y;
+    *((__pyx_t_11moleculekit_8wrapping_UINT32_t *) ( /* dim=0 */ (__pyx_v_size.data + __pyx_t_9 * __pyx_v_size.strides[0]) )) += (*((__pyx_t_11moleculekit_8wrapping_UINT32_t *) ( /* dim=0 */ (__pyx_v_size.data + __pyx_t_10 * __pyx_v_size.strides[0]) )));
+
+    /* "moleculekit/wrapping/wrapping.pyx":64
+ *         return # x and y are already in the same set
+ * 
+ *     if size[x] < size[y]:             # <<<<<<<<<<<<<<
+ *         parent[x] = y
+ *         size[y] += size[x]
+ */
+    goto __pyx_L4;
+  }
+
+  /* "moleculekit/wrapping/wrapping.pyx":68
+ *         size[y] += size[x]
+ *     else:
+ *         parent[y] = x             # <<<<<<<<<<<<<<
+ *         size[x] += size[y]
+ * 
+ */
+  /*else*/ {
+    __pyx_t_10 = __pyx_v_y;
+    *((__pyx_t_11moleculekit_8wrapping_UINT32_t *) ( /* dim=0 */ (__pyx_v_parent.data + __pyx_t_10 * __pyx_v_parent.strides[0]) )) = __pyx_v_x;
+
+    /* "moleculekit/wrapping/wrapping.pyx":69
+ *     else:
+ *         parent[y] = x
+ *         size[x] += size[y]             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+    __pyx_t_10 = __pyx_v_y;
+    __pyx_t_9 = __pyx_v_x;
+    *((__pyx_t_11moleculekit_8wrapping_UINT32_t *) ( /* dim=0 */ (__pyx_v_size.data + __pyx_t_9 * __pyx_v_size.strides[0]) )) += (*((__pyx_t_11moleculekit_8wrapping_UINT32_t *) ( /* dim=0 */ (__pyx_v_size.data + __pyx_t_10 * __pyx_v_size.strides[0]) )));
+  }
+  __pyx_L4:;
+
+  /* "moleculekit/wrapping/wrapping.pyx":49
+ *     return x
+ * 
+ * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
+ * @cython.wraparound(False)  # turn off negative index wrapping for entire function
+ * def disjoint_set_merge(
+ */
+
+  /* function exit code */
+  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_AddTraceback("moleculekit.wrapping.disjoint_set_merge", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "moleculekit/wrapping/wrapping.pyx":72
+ * 
+ * 
+ * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
+ * @cython.wraparound(False)  # turn off negative index wrapping for entire function
+ * def get_bonded_groups(
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_11moleculekit_8wrapping_5get_bonded_groups(PyObject *__pyx_self, 
+#if CYTHON_METH_FASTCALL
+PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
+#else
+PyObject *__pyx_args, PyObject *__pyx_kwds
+#endif
+); /*proto*/
+static PyMethodDef __pyx_mdef_11moleculekit_8wrapping_5get_bonded_groups = {"get_bonded_groups", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11moleculekit_8wrapping_5get_bonded_groups, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11moleculekit_8wrapping_5get_bonded_groups(PyObject *__pyx_self, 
+#if CYTHON_METH_FASTCALL
+PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
+#else
+PyObject *__pyx_args, PyObject *__pyx_kwds
+#endif
+) {
+  __Pyx_memviewslice __pyx_v_bonds = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_v_n_atoms;
+  __Pyx_memviewslice __pyx_v_parent = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_size = { 0, 0, { 0 }, { 0 }, { 0 } };
+  #if !CYTHON_METH_FASTCALL
+  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
+  #endif
+  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
+  PyObject* values[4] = {0,0,0,0};
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("get_bonded_groups (wrapper)", 0);
+  #if !CYTHON_METH_FASTCALL
+  #if CYTHON_ASSUME_SAFE_MACROS
+  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
+  #else
+  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
+  #endif
+  #endif
+  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
+  {
+    PyObject **__pyx_pyargnames[] = {&__pyx_n_s_bonds,&__pyx_n_s_n_atoms,&__pyx_n_s_parent,&__pyx_n_s_size,0};
+    if (__pyx_kwds) {
+      Py_ssize_t kw_args;
+      switch (__pyx_nargs) {
+        case  4: values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
+        CYTHON_FALLTHROUGH;
+        case  3: values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
+        CYTHON_FALLTHROUGH;
+        case  2: values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
+        CYTHON_FALLTHROUGH;
+        case  1: values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
+        CYTHON_FALLTHROUGH;
+        case  0: break;
+        default: goto __pyx_L5_argtuple_error;
+      }
+      kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
+      switch (__pyx_nargs) {
+        case  0:
+        if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_bonds)) != 0)) {
+          (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
+          kw_args--;
+        }
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 72, __pyx_L3_error)
+        else goto __pyx_L5_argtuple_error;
+        CYTHON_FALLTHROUGH;
+        case  1:
+        if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_atoms)) != 0)) {
+          (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
+          kw_args--;
+        }
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 72, __pyx_L3_error)
+        else {
+          __Pyx_RaiseArgtupleInvalid("get_bonded_groups", 1, 4, 4, 1); __PYX_ERR(0, 72, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  2:
+        if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_parent)) != 0)) {
+          (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
+          kw_args--;
+        }
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 72, __pyx_L3_error)
+        else {
+          __Pyx_RaiseArgtupleInvalid("get_bonded_groups", 1, 4, 4, 2); __PYX_ERR(0, 72, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  3:
+        if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_size)) != 0)) {
+          (void)__Pyx_Arg_NewRef_FASTCALL(values[3]);
+          kw_args--;
+        }
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 72, __pyx_L3_error)
+        else {
+          __Pyx_RaiseArgtupleInvalid("get_bonded_groups", 1, 4, 4, 3); __PYX_ERR(0, 72, __pyx_L3_error)
+        }
+      }
+      if (unlikely(kw_args > 0)) {
+        const Py_ssize_t kwd_pos_args = __pyx_nargs;
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "get_bonded_groups") < 0)) __PYX_ERR(0, 72, __pyx_L3_error)
+      }
+    } else if (unlikely(__pyx_nargs != 4)) {
+      goto __pyx_L5_argtuple_error;
+    } else {
+      values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
+      values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
+      values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
+      values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
+    }
+    __pyx_v_bonds = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_11moleculekit_8wrapping_UINT32_t(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_bonds.memview)) __PYX_ERR(0, 75, __pyx_L3_error)
+    __pyx_v_n_atoms = __Pyx_PyInt_As_int(values[1]); if (unlikely((__pyx_v_n_atoms == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 76, __pyx_L3_error)
+    __pyx_v_parent = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_8wrapping_UINT32_t(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_parent.memview)) __PYX_ERR(0, 77, __pyx_L3_error)
+    __pyx_v_size = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_8wrapping_UINT32_t(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_size.memview)) __PYX_ERR(0, 78, __pyx_L3_error)
+  }
+  goto __pyx_L6_skip;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("get_bonded_groups", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 72, __pyx_L3_error)
+  __pyx_L6_skip:;
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L3_error:;
+  {
+    Py_ssize_t __pyx_temp;
+    for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
+      __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
+    }
+  }
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_bonds, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_parent, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_size, 1);
+  __Pyx_AddTraceback("moleculekit.wrapping.get_bonded_groups", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannyFinishContext();
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __pyx_r = __pyx_pf_11moleculekit_8wrapping_4get_bonded_groups(__pyx_self, __pyx_v_bonds, __pyx_v_n_atoms, __pyx_v_parent, __pyx_v_size);
+
+  /* function exit code */
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_bonds, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_parent, 1);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_size, 1);
+  {
+    Py_ssize_t __pyx_temp;
+    for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
+      __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
+    }
+  }
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_11moleculekit_8wrapping_4get_bonded_groups(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_bonds, int __pyx_v_n_atoms, __Pyx_memviewslice __pyx_v_parent, __Pyx_memviewslice __pyx_v_size) {
+  int __pyx_v_i;
+  int __pyx_v_n_bonds;
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  int __pyx_t_1;
+  int __pyx_t_2;
+  int __pyx_t_3;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
+  Py_ssize_t __pyx_t_6;
+  Py_ssize_t __pyx_t_7;
+  PyObject *__pyx_t_8 = NULL;
+  PyObject *__pyx_t_9 = NULL;
+  PyObject *__pyx_t_10 = NULL;
+  PyObject *__pyx_t_11 = NULL;
+  PyObject *__pyx_t_12 = NULL;
+  int __pyx_t_13;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("get_bonded_groups", 1);
+
+  /* "moleculekit/wrapping/wrapping.pyx":81
+ *     ):
+ *     cdef int i, j, k
+ *     cdef int n_bonds = bonds.shape[0]             # <<<<<<<<<<<<<<
+ * 
+ *     # Iterate over the bonds
+ */
+  __pyx_v_n_bonds = (__pyx_v_bonds.shape[0]);
+
+  /* "moleculekit/wrapping/wrapping.pyx":84
+ * 
+ *     # Iterate over the bonds
+ *     for i in range(n_bonds):             # <<<<<<<<<<<<<<
+ *         disjoint_set_merge(bonds[i, 0], bonds[i, 1], parent, size)
+ * 
+ */
+  __pyx_t_1 = __pyx_v_n_bonds;
+  __pyx_t_2 = __pyx_t_1;
+  for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
+    __pyx_v_i = __pyx_t_3;
+
+    /* "moleculekit/wrapping/wrapping.pyx":85
+ *     # Iterate over the bonds
+ *     for i in range(n_bonds):
+ *         disjoint_set_merge(bonds[i, 0], bonds[i, 1], parent, size)             # <<<<<<<<<<<<<<
+ * 
+ *     # Now everything is connected but not every node has the right parent marked
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_disjoint_set_merge); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 85, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_6 = __pyx_v_i;
+    __pyx_t_7 = 0;
+    __pyx_t_8 = __Pyx_PyInt_From_npy_uint32((*((__pyx_t_11moleculekit_8wrapping_UINT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_bonds.data + __pyx_t_6 * __pyx_v_bonds.strides[0]) ) + __pyx_t_7 * __pyx_v_bonds.strides[1]) )))); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 85, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_8);
+    __pyx_t_7 = __pyx_v_i;
+    __pyx_t_6 = 1;
+    __pyx_t_9 = __Pyx_PyInt_From_npy_uint32((*((__pyx_t_11moleculekit_8wrapping_UINT32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_bonds.data + __pyx_t_7 * __pyx_v_bonds.strides[0]) ) + __pyx_t_6 * __pyx_v_bonds.strides[1]) )))); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 85, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_9);
+    __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_parent, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_11moleculekit_8wrapping_UINT32_t, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_11moleculekit_8wrapping_UINT32_t, 0);; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 85, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_10);
+    __pyx_t_11 = __pyx_memoryview_fromslice(__pyx_v_size, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_11moleculekit_8wrapping_UINT32_t, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_11moleculekit_8wrapping_UINT32_t, 0);; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 85, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_11);
+    __pyx_t_12 = NULL;
+    __pyx_t_13 = 0;
+    #if CYTHON_UNPACK_METHODS
+    if (unlikely(PyMethod_Check(__pyx_t_5))) {
+      __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_5);
+      if (likely(__pyx_t_12)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
+        __Pyx_INCREF(__pyx_t_12);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_5, function);
+        __pyx_t_13 = 1;
+      }
+    }
+    #endif
+    {
+      PyObject *__pyx_callargs[5] = {__pyx_t_12, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11};
+      __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_13, 4+__pyx_t_13);
+      __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
+      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 85, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    }
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  }
+
+  /* "moleculekit/wrapping/wrapping.pyx":90
+ * 
+ *     # Iterate over the atoms to fix the final parent
+ *     for i in range(n_atoms):             # <<<<<<<<<<<<<<
+ *         disjoint_set_find(i, parent)
+ * 
+ */
+  __pyx_t_1 = __pyx_v_n_atoms;
+  __pyx_t_2 = __pyx_t_1;
+  for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
+    __pyx_v_i = __pyx_t_3;
+
+    /* "moleculekit/wrapping/wrapping.pyx":91
+ *     # Iterate over the atoms to fix the final parent
+ *     for i in range(n_atoms):
+ *         disjoint_set_find(i, parent)             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_disjoint_set_find); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 91, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_11 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 91, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_11);
+    __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_parent, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_11moleculekit_8wrapping_UINT32_t, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_11moleculekit_8wrapping_UINT32_t, 0);; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 91, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_10);
+    __pyx_t_9 = NULL;
+    __pyx_t_13 = 0;
+    #if CYTHON_UNPACK_METHODS
+    if (unlikely(PyMethod_Check(__pyx_t_5))) {
+      __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_5);
+      if (likely(__pyx_t_9)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
+        __Pyx_INCREF(__pyx_t_9);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_5, function);
+        __pyx_t_13 = 1;
+      }
+    }
+    #endif
+    {
+      PyObject *__pyx_callargs[3] = {__pyx_t_9, __pyx_t_11, __pyx_t_10};
+      __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_13, 2+__pyx_t_13);
+      __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
+      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 91, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    }
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  }
+
+  /* "moleculekit/wrapping/wrapping.pyx":72
+ * 
+ * 
+ * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
+ * @cython.wraparound(False)  # turn off negative index wrapping for entire function
+ * def get_bonded_groups(
+ */
+
+  /* function exit code */
+  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_XDECREF(__pyx_t_9);
+  __Pyx_XDECREF(__pyx_t_10);
+  __Pyx_XDECREF(__pyx_t_11);
+  __Pyx_XDECREF(__pyx_t_12);
+  __Pyx_AddTraceback("moleculekit.wrapping.get_bonded_groups", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "moleculekit/wrapping/wrapping.pyx":94
  * 
  * 
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def calculate(
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11moleculekit_8wrapping_1calculate(PyObject *__pyx_self, 
+static PyObject *__pyx_pw_11moleculekit_8wrapping_7calculate(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ); /*proto*/
-static PyMethodDef __pyx_mdef_11moleculekit_8wrapping_1calculate = {"calculate", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11moleculekit_8wrapping_1calculate, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_11moleculekit_8wrapping_1calculate(PyObject *__pyx_self, 
+static PyMethodDef __pyx_mdef_11moleculekit_8wrapping_7calculate = {"calculate", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11moleculekit_8wrapping_7calculate, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11moleculekit_8wrapping_7calculate(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ) {
   PyArrayObject *__pyx_v_groups = 0;
@@ -19415,50 +20461,50 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_groups)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 28, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 94, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_coords)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 28, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 94, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("calculate", 1, 4, 4, 1); __PYX_ERR(0, 28, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calculate", 1, 4, 4, 1); __PYX_ERR(0, 94, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_box)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 28, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 94, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("calculate", 1, 4, 4, 2); __PYX_ERR(0, 28, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calculate", 1, 4, 4, 2); __PYX_ERR(0, 94, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_centersel)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[3]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 28, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 94, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("calculate", 1, 4, 4, 3); __PYX_ERR(0, 28, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calculate", 1, 4, 4, 3); __PYX_ERR(0, 94, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "calculate") < 0)) __PYX_ERR(0, 28, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "calculate") < 0)) __PYX_ERR(0, 94, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 4)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
       values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
@@ -19467,33 +20513,33 @@
     __pyx_v_groups = ((PyArrayObject *)values[0]);
     __pyx_v_coords = ((PyArrayObject *)values[1]);
     __pyx_v_box = ((PyArrayObject *)values[2]);
     __pyx_v_centersel = ((PyArrayObject *)values[3]);
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("calculate", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 28, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("calculate", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 94, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_AddTraceback("moleculekit.wrapping.calculate", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_groups), __pyx_ptype_5numpy_ndarray, 1, "groups", 0))) __PYX_ERR(0, 31, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_coords), __pyx_ptype_5numpy_ndarray, 1, "coords", 0))) __PYX_ERR(0, 32, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_box), __pyx_ptype_5numpy_ndarray, 1, "box", 0))) __PYX_ERR(0, 33, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_centersel), __pyx_ptype_5numpy_ndarray, 1, "centersel", 0))) __PYX_ERR(0, 34, __pyx_L1_error)
-  __pyx_r = __pyx_pf_11moleculekit_8wrapping_calculate(__pyx_self, __pyx_v_groups, __pyx_v_coords, __pyx_v_box, __pyx_v_centersel);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_groups), __pyx_ptype_5numpy_ndarray, 1, "groups", 0))) __PYX_ERR(0, 97, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_coords), __pyx_ptype_5numpy_ndarray, 1, "coords", 0))) __PYX_ERR(0, 98, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_box), __pyx_ptype_5numpy_ndarray, 1, "box", 0))) __PYX_ERR(0, 99, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_centersel), __pyx_ptype_5numpy_ndarray, 1, "centersel", 0))) __PYX_ERR(0, 100, __pyx_L1_error)
+  __pyx_r = __pyx_pf_11moleculekit_8wrapping_6calculate(__pyx_self, __pyx_v_groups, __pyx_v_coords, __pyx_v_box, __pyx_v_centersel);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
   {
@@ -19502,15 +20548,15 @@
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11moleculekit_8wrapping_calculate(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_groups, PyArrayObject *__pyx_v_coords, PyArrayObject *__pyx_v_box, PyArrayObject *__pyx_v_centersel) {
+static PyObject *__pyx_pf_11moleculekit_8wrapping_6calculate(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_groups, PyArrayObject *__pyx_v_coords, PyArrayObject *__pyx_v_box, PyArrayObject *__pyx_v_centersel) {
   int __pyx_v_f;
   int __pyx_v_i;
   int __pyx_v_g;
   int __pyx_v_a;
   int __pyx_v_start_idx;
   int __pyx_v_end_idx;
   int __pyx_v_k;
@@ -19575,213 +20621,213 @@
   __pyx_pybuffernd_box.rcbuffer = &__pyx_pybuffer_box;
   __pyx_pybuffer_centersel.pybuffer.buf = NULL;
   __pyx_pybuffer_centersel.refcount = 0;
   __pyx_pybuffernd_centersel.data = NULL;
   __pyx_pybuffernd_centersel.rcbuffer = &__pyx_pybuffer_centersel;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_groups.rcbuffer->pybuffer, (PyObject*)__pyx_v_groups, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_8wrapping_UINT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 28, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_groups.rcbuffer->pybuffer, (PyObject*)__pyx_v_groups, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_8wrapping_UINT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 94, __pyx_L1_error)
   }
   __pyx_pybuffernd_groups.diminfo[0].strides = __pyx_pybuffernd_groups.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_groups.diminfo[0].shape = __pyx_pybuffernd_groups.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_coords.rcbuffer->pybuffer, (PyObject*)__pyx_v_coords, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_8wrapping_FLOAT32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 3, 0, __pyx_stack) == -1)) __PYX_ERR(0, 28, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_coords.rcbuffer->pybuffer, (PyObject*)__pyx_v_coords, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_8wrapping_FLOAT32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 3, 0, __pyx_stack) == -1)) __PYX_ERR(0, 94, __pyx_L1_error)
   }
   __pyx_pybuffernd_coords.diminfo[0].strides = __pyx_pybuffernd_coords.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_coords.diminfo[0].shape = __pyx_pybuffernd_coords.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_coords.diminfo[1].strides = __pyx_pybuffernd_coords.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_coords.diminfo[1].shape = __pyx_pybuffernd_coords.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_coords.diminfo[2].strides = __pyx_pybuffernd_coords.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_coords.diminfo[2].shape = __pyx_pybuffernd_coords.rcbuffer->pybuffer.shape[2];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_box.rcbuffer->pybuffer, (PyObject*)__pyx_v_box, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_8wrapping_FLOAT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 28, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_box.rcbuffer->pybuffer, (PyObject*)__pyx_v_box, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_8wrapping_FLOAT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 94, __pyx_L1_error)
   }
   __pyx_pybuffernd_box.diminfo[0].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box.diminfo[0].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_box.diminfo[1].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_box.diminfo[1].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_centersel.rcbuffer->pybuffer, (PyObject*)__pyx_v_centersel, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_8wrapping_UINT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 28, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_centersel.rcbuffer->pybuffer, (PyObject*)__pyx_v_centersel, &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_8wrapping_UINT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 94, __pyx_L1_error)
   }
   __pyx_pybuffernd_centersel.diminfo[0].strides = __pyx_pybuffernd_centersel.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_centersel.diminfo[0].shape = __pyx_pybuffernd_centersel.rcbuffer->pybuffer.shape[0];
 
-  /* "moleculekit/wrapping/wrapping.pyx":37
+  /* "moleculekit/wrapping/wrapping.pyx":103
  *     ):
  *     cdef int f, i, g, a, start_idx, end_idx, k, n
  *     cdef int n_atoms = coords.shape[0]             # <<<<<<<<<<<<<<
  *     cdef int n_frames = coords.shape[2]
  *     cdef int n_groups = groups.shape[0]
  */
-  __pyx_t_1 = __pyx_f_5numpy_7ndarray_5shape_shape(((PyArrayObject *)__pyx_v_coords)); if (unlikely(__pyx_t_1 == ((npy_intp *)NULL) && PyErr_Occurred())) __PYX_ERR(0, 37, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_5numpy_7ndarray_5shape_shape(((PyArrayObject *)__pyx_v_coords)); if (unlikely(__pyx_t_1 == ((npy_intp *)NULL) && PyErr_Occurred())) __PYX_ERR(0, 103, __pyx_L1_error)
   __pyx_v_n_atoms = (__pyx_t_1[0]);
 
-  /* "moleculekit/wrapping/wrapping.pyx":38
+  /* "moleculekit/wrapping/wrapping.pyx":104
  *     cdef int f, i, g, a, start_idx, end_idx, k, n
  *     cdef int n_atoms = coords.shape[0]
  *     cdef int n_frames = coords.shape[2]             # <<<<<<<<<<<<<<
  *     cdef int n_groups = groups.shape[0]
  *     cdef int n_centersel = centersel.shape[0]
  */
-  __pyx_t_1 = __pyx_f_5numpy_7ndarray_5shape_shape(((PyArrayObject *)__pyx_v_coords)); if (unlikely(__pyx_t_1 == ((npy_intp *)NULL) && PyErr_Occurred())) __PYX_ERR(0, 38, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_5numpy_7ndarray_5shape_shape(((PyArrayObject *)__pyx_v_coords)); if (unlikely(__pyx_t_1 == ((npy_intp *)NULL) && PyErr_Occurred())) __PYX_ERR(0, 104, __pyx_L1_error)
   __pyx_v_n_frames = (__pyx_t_1[2]);
 
-  /* "moleculekit/wrapping/wrapping.pyx":39
+  /* "moleculekit/wrapping/wrapping.pyx":105
  *     cdef int n_atoms = coords.shape[0]
  *     cdef int n_frames = coords.shape[2]
  *     cdef int n_groups = groups.shape[0]             # <<<<<<<<<<<<<<
  *     cdef int n_centersel = centersel.shape[0]
  *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)
  */
-  __pyx_t_1 = __pyx_f_5numpy_7ndarray_5shape_shape(((PyArrayObject *)__pyx_v_groups)); if (unlikely(__pyx_t_1 == ((npy_intp *)NULL) && PyErr_Occurred())) __PYX_ERR(0, 39, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_5numpy_7ndarray_5shape_shape(((PyArrayObject *)__pyx_v_groups)); if (unlikely(__pyx_t_1 == ((npy_intp *)NULL) && PyErr_Occurred())) __PYX_ERR(0, 105, __pyx_L1_error)
   __pyx_v_n_groups = (__pyx_t_1[0]);
 
-  /* "moleculekit/wrapping/wrapping.pyx":40
+  /* "moleculekit/wrapping/wrapping.pyx":106
  *     cdef int n_frames = coords.shape[2]
  *     cdef int n_groups = groups.shape[0]
  *     cdef int n_centersel = centersel.shape[0]             # <<<<<<<<<<<<<<
  *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)
  *     cdef FLOAT32_t[:] box_center = np.zeros(3, dtype=FLOAT32)
  */
-  __pyx_t_1 = __pyx_f_5numpy_7ndarray_5shape_shape(((PyArrayObject *)__pyx_v_centersel)); if (unlikely(__pyx_t_1 == ((npy_intp *)NULL) && PyErr_Occurred())) __PYX_ERR(0, 40, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_5numpy_7ndarray_5shape_shape(((PyArrayObject *)__pyx_v_centersel)); if (unlikely(__pyx_t_1 == ((npy_intp *)NULL) && PyErr_Occurred())) __PYX_ERR(0, 106, __pyx_L1_error)
   __pyx_v_n_centersel = (__pyx_t_1[0]);
 
-  /* "moleculekit/wrapping/wrapping.pyx":41
+  /* "moleculekit/wrapping/wrapping.pyx":107
  *     cdef int n_groups = groups.shape[0]
  *     cdef int n_centersel = centersel.shape[0]
  *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
  *     cdef FLOAT32_t[:] box_center = np.zeros(3, dtype=FLOAT32)
  *     cdef FLOAT32_t[:] grp_center = np.zeros(3, dtype=FLOAT32)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 41, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 107, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 41, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 107, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 41, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 107, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 41, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 107, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 41, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 107, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__11, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 41, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__11, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 107, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_8wrapping_FLOAT32_t(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 41, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_8wrapping_FLOAT32_t(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 107, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_half_box = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "moleculekit/wrapping/wrapping.pyx":42
+  /* "moleculekit/wrapping/wrapping.pyx":108
  *     cdef int n_centersel = centersel.shape[0]
  *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)
  *     cdef FLOAT32_t[:] box_center = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
  *     cdef FLOAT32_t[:] grp_center = np.zeros(3, dtype=FLOAT32)
  *     cdef FLOAT32_t translation, diff
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 42, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 42, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 42, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 42, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 42, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 108, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__11, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 42, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__11, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_8wrapping_FLOAT32_t(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 42, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_8wrapping_FLOAT32_t(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 108, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_box_center = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "moleculekit/wrapping/wrapping.pyx":43
+  /* "moleculekit/wrapping/wrapping.pyx":109
  *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)
  *     cdef FLOAT32_t[:] box_center = np.zeros(3, dtype=FLOAT32)
  *     cdef FLOAT32_t[:] grp_center = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
  *     cdef FLOAT32_t translation, diff
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 43, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 109, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 43, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 109, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 43, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 109, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 43, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_FLOAT32); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 109, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 43, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 109, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__11, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 43, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__11, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 109, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_8wrapping_FLOAT32_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 43, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_8wrapping_FLOAT32_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 109, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_grp_center = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "moleculekit/wrapping/wrapping.pyx":47
+  /* "moleculekit/wrapping/wrapping.pyx":113
  * 
  *     # Wrap the coordinates
  *     for f in range(n_frames):             # <<<<<<<<<<<<<<
  *         # Calculate the geometric box center as the average of the selection atoms. Numerically stable average
  *         for i in range(3):
  */
   __pyx_t_6 = __pyx_v_n_frames;
   __pyx_t_7 = __pyx_t_6;
   for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
     __pyx_v_f = __pyx_t_8;
 
-    /* "moleculekit/wrapping/wrapping.pyx":49
+    /* "moleculekit/wrapping/wrapping.pyx":115
  *     for f in range(n_frames):
  *         # Calculate the geometric box center as the average of the selection atoms. Numerically stable average
  *         for i in range(3):             # <<<<<<<<<<<<<<
  *             box_center[i] = 0
  *         for n in range(n_centersel):
  */
     for (__pyx_t_9 = 0; __pyx_t_9 < 3; __pyx_t_9+=1) {
       __pyx_v_i = __pyx_t_9;
 
-      /* "moleculekit/wrapping/wrapping.pyx":50
+      /* "moleculekit/wrapping/wrapping.pyx":116
  *         # Calculate the geometric box center as the average of the selection atoms. Numerically stable average
  *         for i in range(3):
  *             box_center[i] = 0             # <<<<<<<<<<<<<<
  *         for n in range(n_centersel):
  *             for i in range(3):
  */
       __pyx_t_10 = __pyx_v_i;
       *((__pyx_t_11moleculekit_8wrapping_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_box_center.data + __pyx_t_10 * __pyx_v_box_center.strides[0]) )) = 0.0;
     }
 
-    /* "moleculekit/wrapping/wrapping.pyx":51
+    /* "moleculekit/wrapping/wrapping.pyx":117
  *         for i in range(3):
  *             box_center[i] = 0
  *         for n in range(n_centersel):             # <<<<<<<<<<<<<<
  *             for i in range(3):
  *                 box_center[i] = box_center[i] + (coords[centersel[n], i, f] - box_center[i]) / (n + 1)
  */
     __pyx_t_9 = __pyx_v_n_centersel;
     __pyx_t_11 = __pyx_t_9;
     for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
       __pyx_v_n = __pyx_t_12;
 
-      /* "moleculekit/wrapping/wrapping.pyx":52
+      /* "moleculekit/wrapping/wrapping.pyx":118
  *             box_center[i] = 0
  *         for n in range(n_centersel):
  *             for i in range(3):             # <<<<<<<<<<<<<<
  *                 box_center[i] = box_center[i] + (coords[centersel[n], i, f] - box_center[i]) / (n + 1)
  * 
  */
       for (__pyx_t_13 = 0; __pyx_t_13 < 3; __pyx_t_13+=1) {
         __pyx_v_i = __pyx_t_13;
 
-        /* "moleculekit/wrapping/wrapping.pyx":53
+        /* "moleculekit/wrapping/wrapping.pyx":119
  *         for n in range(n_centersel):
  *             for i in range(3):
  *                 box_center[i] = box_center[i] + (coords[centersel[n], i, f] - box_center[i]) / (n + 1)             # <<<<<<<<<<<<<<
  * 
  *         for i in range(3):
  */
         __pyx_t_10 = __pyx_v_i;
@@ -19791,122 +20837,122 @@
         __pyx_t_17 = __pyx_v_f;
         __pyx_t_18 = __pyx_v_i;
         __pyx_t_19 = __pyx_v_i;
         *((__pyx_t_11moleculekit_8wrapping_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_box_center.data + __pyx_t_19 * __pyx_v_box_center.strides[0]) )) = ((*((__pyx_t_11moleculekit_8wrapping_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_box_center.data + __pyx_t_10 * __pyx_v_box_center.strides[0]) ))) + (((*__Pyx_BufPtrStrided3d(__pyx_t_11moleculekit_8wrapping_FLOAT32_t *, __pyx_pybuffernd_coords.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_coords.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_coords.diminfo[1].strides, __pyx_t_17, __pyx_pybuffernd_coords.diminfo[2].strides)) - (*((__pyx_t_11moleculekit_8wrapping_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_box_center.data + __pyx_t_18 * __pyx_v_box_center.strides[0]) )))) / ((__pyx_t_11moleculekit_8wrapping_FLOAT32_t)(__pyx_v_n + 1))));
       }
     }
 
-    /* "moleculekit/wrapping/wrapping.pyx":55
+    /* "moleculekit/wrapping/wrapping.pyx":121
  *                 box_center[i] = box_center[i] + (coords[centersel[n], i, f] - box_center[i]) / (n + 1)
  * 
  *         for i in range(3):             # <<<<<<<<<<<<<<
  *             half_box[i] = box[i, f] / 2
  * 
  */
     for (__pyx_t_9 = 0; __pyx_t_9 < 3; __pyx_t_9+=1) {
       __pyx_v_i = __pyx_t_9;
 
-      /* "moleculekit/wrapping/wrapping.pyx":56
+      /* "moleculekit/wrapping/wrapping.pyx":122
  * 
  *         for i in range(3):
  *             half_box[i] = box[i, f] / 2             # <<<<<<<<<<<<<<
  * 
  *         for g in range(n_groups-1):
  */
       __pyx_t_18 = __pyx_v_i;
       __pyx_t_14 = __pyx_v_f;
       __pyx_t_17 = __pyx_v_i;
       *((__pyx_t_11moleculekit_8wrapping_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_half_box.data + __pyx_t_17 * __pyx_v_half_box.strides[0]) )) = ((*__Pyx_BufPtrStrided2d(__pyx_t_11moleculekit_8wrapping_FLOAT32_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_box.diminfo[1].strides)) / 2.0);
     }
 
-    /* "moleculekit/wrapping/wrapping.pyx":58
+    /* "moleculekit/wrapping/wrapping.pyx":124
  *             half_box[i] = box[i, f] / 2
  * 
  *         for g in range(n_groups-1):             # <<<<<<<<<<<<<<
  *             start_idx = groups[g]
  *             end_idx = groups[g+1]
  */
     __pyx_t_20 = (__pyx_v_n_groups - 1);
     __pyx_t_21 = __pyx_t_20;
     for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_21; __pyx_t_9+=1) {
       __pyx_v_g = __pyx_t_9;
 
-      /* "moleculekit/wrapping/wrapping.pyx":59
+      /* "moleculekit/wrapping/wrapping.pyx":125
  * 
  *         for g in range(n_groups-1):
  *             start_idx = groups[g]             # <<<<<<<<<<<<<<
  *             end_idx = groups[g+1]
  * 
  */
       __pyx_t_14 = __pyx_v_g;
       __pyx_v_start_idx = (*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_8wrapping_UINT32_t *, __pyx_pybuffernd_groups.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_groups.diminfo[0].strides));
 
-      /* "moleculekit/wrapping/wrapping.pyx":60
+      /* "moleculekit/wrapping/wrapping.pyx":126
  *         for g in range(n_groups-1):
  *             start_idx = groups[g]
  *             end_idx = groups[g+1]             # <<<<<<<<<<<<<<
  * 
  *             # Calculate the geometric center of the group. Numerically stable average
  */
       __pyx_t_14 = (__pyx_v_g + 1);
       __pyx_v_end_idx = (*__Pyx_BufPtrStrided1d(__pyx_t_11moleculekit_8wrapping_UINT32_t *, __pyx_pybuffernd_groups.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_groups.diminfo[0].strides));
 
-      /* "moleculekit/wrapping/wrapping.pyx":63
+      /* "moleculekit/wrapping/wrapping.pyx":129
  * 
  *             # Calculate the geometric center of the group. Numerically stable average
  *             for i in range(3):             # <<<<<<<<<<<<<<
  *                 grp_center[i] = 0
  *             n = 0
  */
       for (__pyx_t_11 = 0; __pyx_t_11 < 3; __pyx_t_11+=1) {
         __pyx_v_i = __pyx_t_11;
 
-        /* "moleculekit/wrapping/wrapping.pyx":64
+        /* "moleculekit/wrapping/wrapping.pyx":130
  *             # Calculate the geometric center of the group. Numerically stable average
  *             for i in range(3):
  *                 grp_center[i] = 0             # <<<<<<<<<<<<<<
  *             n = 0
  *             for k in range(start_idx, end_idx):
  */
         __pyx_t_14 = __pyx_v_i;
         *((__pyx_t_11moleculekit_8wrapping_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_grp_center.data + __pyx_t_14 * __pyx_v_grp_center.strides[0]) )) = 0.0;
       }
 
-      /* "moleculekit/wrapping/wrapping.pyx":65
+      /* "moleculekit/wrapping/wrapping.pyx":131
  *             for i in range(3):
  *                 grp_center[i] = 0
  *             n = 0             # <<<<<<<<<<<<<<
  *             for k in range(start_idx, end_idx):
  *                 for i in range(3):
  */
       __pyx_v_n = 0;
 
-      /* "moleculekit/wrapping/wrapping.pyx":66
+      /* "moleculekit/wrapping/wrapping.pyx":132
  *                 grp_center[i] = 0
  *             n = 0
  *             for k in range(start_idx, end_idx):             # <<<<<<<<<<<<<<
  *                 for i in range(3):
  *                     grp_center[i] = grp_center[i] + (coords[k, i, f] - grp_center[i]) / (n + 1)
  */
       __pyx_t_11 = __pyx_v_end_idx;
       __pyx_t_12 = __pyx_t_11;
       for (__pyx_t_13 = __pyx_v_start_idx; __pyx_t_13 < __pyx_t_12; __pyx_t_13+=1) {
         __pyx_v_k = __pyx_t_13;
 
-        /* "moleculekit/wrapping/wrapping.pyx":67
+        /* "moleculekit/wrapping/wrapping.pyx":133
  *             n = 0
  *             for k in range(start_idx, end_idx):
  *                 for i in range(3):             # <<<<<<<<<<<<<<
  *                     grp_center[i] = grp_center[i] + (coords[k, i, f] - grp_center[i]) / (n + 1)
  *                 n = n + 1
  */
         for (__pyx_t_22 = 0; __pyx_t_22 < 3; __pyx_t_22+=1) {
           __pyx_v_i = __pyx_t_22;
 
-          /* "moleculekit/wrapping/wrapping.pyx":68
+          /* "moleculekit/wrapping/wrapping.pyx":134
  *             for k in range(start_idx, end_idx):
  *                 for i in range(3):
  *                     grp_center[i] = grp_center[i] + (coords[k, i, f] - grp_center[i]) / (n + 1)             # <<<<<<<<<<<<<<
  *                 n = n + 1
  * 
  */
           __pyx_t_14 = __pyx_v_i;
@@ -19914,109 +20960,109 @@
           __pyx_t_17 = __pyx_v_i;
           __pyx_t_16 = __pyx_v_f;
           __pyx_t_10 = __pyx_v_i;
           __pyx_t_19 = __pyx_v_i;
           *((__pyx_t_11moleculekit_8wrapping_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_grp_center.data + __pyx_t_19 * __pyx_v_grp_center.strides[0]) )) = ((*((__pyx_t_11moleculekit_8wrapping_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_grp_center.data + __pyx_t_14 * __pyx_v_grp_center.strides[0]) ))) + (((*__Pyx_BufPtrStrided3d(__pyx_t_11moleculekit_8wrapping_FLOAT32_t *, __pyx_pybuffernd_coords.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_coords.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_coords.diminfo[1].strides, __pyx_t_16, __pyx_pybuffernd_coords.diminfo[2].strides)) - (*((__pyx_t_11moleculekit_8wrapping_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_grp_center.data + __pyx_t_10 * __pyx_v_grp_center.strides[0]) )))) / ((__pyx_t_11moleculekit_8wrapping_FLOAT32_t)(__pyx_v_n + 1))));
         }
 
-        /* "moleculekit/wrapping/wrapping.pyx":69
+        /* "moleculekit/wrapping/wrapping.pyx":135
  *                 for i in range(3):
  *                     grp_center[i] = grp_center[i] + (coords[k, i, f] - grp_center[i]) / (n + 1)
  *                 n = n + 1             # <<<<<<<<<<<<<<
  * 
  *             for i in range(3):
  */
         __pyx_v_n = (__pyx_v_n + 1);
       }
 
-      /* "moleculekit/wrapping/wrapping.pyx":71
+      /* "moleculekit/wrapping/wrapping.pyx":137
  *                 n = n + 1
  * 
  *             for i in range(3):             # <<<<<<<<<<<<<<
  *                 diff = grp_center[i] - box_center[i]
  *                 if fabs(diff) > half_box[i]:
  */
       for (__pyx_t_11 = 0; __pyx_t_11 < 3; __pyx_t_11+=1) {
         __pyx_v_i = __pyx_t_11;
 
-        /* "moleculekit/wrapping/wrapping.pyx":72
+        /* "moleculekit/wrapping/wrapping.pyx":138
  * 
  *             for i in range(3):
  *                 diff = grp_center[i] - box_center[i]             # <<<<<<<<<<<<<<
  *                 if fabs(diff) > half_box[i]:
  *                     translation = box[i, f] * round(diff / box[i, f])
  */
         __pyx_t_10 = __pyx_v_i;
         __pyx_t_16 = __pyx_v_i;
         __pyx_v_diff = ((*((__pyx_t_11moleculekit_8wrapping_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_grp_center.data + __pyx_t_10 * __pyx_v_grp_center.strides[0]) ))) - (*((__pyx_t_11moleculekit_8wrapping_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_box_center.data + __pyx_t_16 * __pyx_v_box_center.strides[0]) ))));
 
-        /* "moleculekit/wrapping/wrapping.pyx":73
+        /* "moleculekit/wrapping/wrapping.pyx":139
  *             for i in range(3):
  *                 diff = grp_center[i] - box_center[i]
  *                 if fabs(diff) > half_box[i]:             # <<<<<<<<<<<<<<
  *                     translation = box[i, f] * round(diff / box[i, f])
  *                     for a in range(start_idx, end_idx):
  */
         __pyx_t_16 = __pyx_v_i;
         __pyx_t_23 = (fabs(__pyx_v_diff) > (*((__pyx_t_11moleculekit_8wrapping_FLOAT32_t *) ( /* dim=0 */ (__pyx_v_half_box.data + __pyx_t_16 * __pyx_v_half_box.strides[0]) ))));
         if (__pyx_t_23) {
 
-          /* "moleculekit/wrapping/wrapping.pyx":74
+          /* "moleculekit/wrapping/wrapping.pyx":140
  *                 diff = grp_center[i] - box_center[i]
  *                 if fabs(diff) > half_box[i]:
  *                     translation = box[i, f] * round(diff / box[i, f])             # <<<<<<<<<<<<<<
  *                     for a in range(start_idx, end_idx):
  *                         coords[a, i, f] = coords[a, i, f] - translation
  */
           __pyx_t_16 = __pyx_v_i;
           __pyx_t_10 = __pyx_v_f;
           __pyx_t_17 = __pyx_v_i;
           __pyx_t_18 = __pyx_v_f;
           __pyx_v_translation = ((*__Pyx_BufPtrStrided2d(__pyx_t_11moleculekit_8wrapping_FLOAT32_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_box.diminfo[1].strides)) * round((__pyx_v_diff / (*__Pyx_BufPtrStrided2d(__pyx_t_11moleculekit_8wrapping_FLOAT32_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_box.diminfo[1].strides)))));
 
-          /* "moleculekit/wrapping/wrapping.pyx":75
+          /* "moleculekit/wrapping/wrapping.pyx":141
  *                 if fabs(diff) > half_box[i]:
  *                     translation = box[i, f] * round(diff / box[i, f])
  *                     for a in range(start_idx, end_idx):             # <<<<<<<<<<<<<<
  *                         coords[a, i, f] = coords[a, i, f] - translation
  * 
  */
           __pyx_t_12 = __pyx_v_end_idx;
           __pyx_t_13 = __pyx_t_12;
           for (__pyx_t_22 = __pyx_v_start_idx; __pyx_t_22 < __pyx_t_13; __pyx_t_22+=1) {
             __pyx_v_a = __pyx_t_22;
 
-            /* "moleculekit/wrapping/wrapping.pyx":76
+            /* "moleculekit/wrapping/wrapping.pyx":142
  *                     translation = box[i, f] * round(diff / box[i, f])
  *                     for a in range(start_idx, end_idx):
  *                         coords[a, i, f] = coords[a, i, f] - translation             # <<<<<<<<<<<<<<
  * 
  */
             __pyx_t_18 = __pyx_v_a;
             __pyx_t_17 = __pyx_v_i;
             __pyx_t_10 = __pyx_v_f;
             __pyx_t_16 = __pyx_v_a;
             __pyx_t_14 = __pyx_v_i;
             __pyx_t_19 = __pyx_v_f;
             *__Pyx_BufPtrStrided3d(__pyx_t_11moleculekit_8wrapping_FLOAT32_t *, __pyx_pybuffernd_coords.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_coords.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_coords.diminfo[1].strides, __pyx_t_19, __pyx_pybuffernd_coords.diminfo[2].strides) = ((*__Pyx_BufPtrStrided3d(__pyx_t_11moleculekit_8wrapping_FLOAT32_t *, __pyx_pybuffernd_coords.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_coords.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_coords.diminfo[1].strides, __pyx_t_10, __pyx_pybuffernd_coords.diminfo[2].strides)) - __pyx_v_translation);
           }
 
-          /* "moleculekit/wrapping/wrapping.pyx":73
+          /* "moleculekit/wrapping/wrapping.pyx":139
  *             for i in range(3):
  *                 diff = grp_center[i] - box_center[i]
  *                 if fabs(diff) > half_box[i]:             # <<<<<<<<<<<<<<
  *                     translation = box[i, f] * round(diff / box[i, f])
  *                     for a in range(start_idx, end_idx):
  */
         }
       }
     }
   }
 
-  /* "moleculekit/wrapping/wrapping.pyx":28
+  /* "moleculekit/wrapping/wrapping.pyx":94
  * 
  * 
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def calculate(
  */
 
@@ -21050,24 +22096,25 @@
     {&__pyx_kp_s_Step_may_not_be_zero_axis_d, __pyx_k_Step_may_not_be_zero_axis_d, sizeof(__pyx_k_Step_may_not_be_zero_axis_d), 0, 0, 1, 0},
     {&__pyx_n_s_TypeError, __pyx_k_TypeError, sizeof(__pyx_k_TypeError), 0, 0, 1, 1},
     {&__pyx_n_s_UINT32, __pyx_k_UINT32, sizeof(__pyx_k_UINT32), 0, 0, 1, 1},
     {&__pyx_kp_s_Unable_to_convert_item_to_object, __pyx_k_Unable_to_convert_item_to_object, sizeof(__pyx_k_Unable_to_convert_item_to_object), 0, 0, 1, 0},
     {&__pyx_n_s_ValueError, __pyx_k_ValueError, sizeof(__pyx_k_ValueError), 0, 0, 1, 1},
     {&__pyx_n_s_View_MemoryView, __pyx_k_View_MemoryView, sizeof(__pyx_k_View_MemoryView), 0, 0, 1, 1},
     {&__pyx_kp_u__2, __pyx_k__2, sizeof(__pyx_k__2), 0, 1, 0, 0},
-    {&__pyx_n_s__25, __pyx_k__25, sizeof(__pyx_k__25), 0, 0, 1, 1},
     {&__pyx_n_s__3, __pyx_k__3, sizeof(__pyx_k__3), 0, 0, 1, 1},
+    {&__pyx_n_s__31, __pyx_k__31, sizeof(__pyx_k__31), 0, 0, 1, 1},
     {&__pyx_kp_u__6, __pyx_k__6, sizeof(__pyx_k__6), 0, 1, 0, 0},
     {&__pyx_kp_u__7, __pyx_k__7, sizeof(__pyx_k__7), 0, 1, 0, 0},
     {&__pyx_n_s_a, __pyx_k_a, sizeof(__pyx_k_a), 0, 0, 1, 1},
     {&__pyx_n_s_abc, __pyx_k_abc, sizeof(__pyx_k_abc), 0, 0, 1, 1},
     {&__pyx_n_s_allocate_buffer, __pyx_k_allocate_buffer, sizeof(__pyx_k_allocate_buffer), 0, 0, 1, 1},
     {&__pyx_kp_u_and, __pyx_k_and, sizeof(__pyx_k_and), 0, 1, 0, 0},
     {&__pyx_n_s_asyncio_coroutines, __pyx_k_asyncio_coroutines, sizeof(__pyx_k_asyncio_coroutines), 0, 0, 1, 1},
     {&__pyx_n_s_base, __pyx_k_base, sizeof(__pyx_k_base), 0, 0, 1, 1},
+    {&__pyx_n_s_bonds, __pyx_k_bonds, sizeof(__pyx_k_bonds), 0, 0, 1, 1},
     {&__pyx_n_s_box, __pyx_k_box, sizeof(__pyx_k_box), 0, 0, 1, 1},
     {&__pyx_n_s_box_center, __pyx_k_box_center, sizeof(__pyx_k_box_center), 0, 0, 1, 1},
     {&__pyx_n_s_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 0, 1, 1},
     {&__pyx_n_u_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 1, 0, 1},
     {&__pyx_n_s_calculate, __pyx_k_calculate, sizeof(__pyx_k_calculate), 0, 0, 1, 1},
     {&__pyx_n_s_centersel, __pyx_k_centersel, sizeof(__pyx_k_centersel), 0, 0, 1, 1},
     {&__pyx_n_s_class, __pyx_k_class, sizeof(__pyx_k_class), 0, 0, 1, 1},
@@ -21078,14 +22125,16 @@
     {&__pyx_kp_s_contiguous_and_direct, __pyx_k_contiguous_and_direct, sizeof(__pyx_k_contiguous_and_direct), 0, 0, 1, 0},
     {&__pyx_kp_s_contiguous_and_indirect, __pyx_k_contiguous_and_indirect, sizeof(__pyx_k_contiguous_and_indirect), 0, 0, 1, 0},
     {&__pyx_n_s_coords, __pyx_k_coords, sizeof(__pyx_k_coords), 0, 0, 1, 1},
     {&__pyx_n_s_count, __pyx_k_count, sizeof(__pyx_k_count), 0, 0, 1, 1},
     {&__pyx_n_s_dict, __pyx_k_dict, sizeof(__pyx_k_dict), 0, 0, 1, 1},
     {&__pyx_n_s_diff, __pyx_k_diff, sizeof(__pyx_k_diff), 0, 0, 1, 1},
     {&__pyx_kp_u_disable, __pyx_k_disable, sizeof(__pyx_k_disable), 0, 1, 0, 0},
+    {&__pyx_n_s_disjoint_set_find, __pyx_k_disjoint_set_find, sizeof(__pyx_k_disjoint_set_find), 0, 0, 1, 1},
+    {&__pyx_n_s_disjoint_set_merge, __pyx_k_disjoint_set_merge, sizeof(__pyx_k_disjoint_set_merge), 0, 0, 1, 1},
     {&__pyx_n_s_dtype, __pyx_k_dtype, sizeof(__pyx_k_dtype), 0, 0, 1, 1},
     {&__pyx_n_s_dtype_is_object, __pyx_k_dtype_is_object, sizeof(__pyx_k_dtype_is_object), 0, 0, 1, 1},
     {&__pyx_kp_u_enable, __pyx_k_enable, sizeof(__pyx_k_enable), 0, 1, 0, 0},
     {&__pyx_n_s_encode, __pyx_k_encode, sizeof(__pyx_k_encode), 0, 0, 1, 1},
     {&__pyx_n_s_end_idx, __pyx_k_end_idx, sizeof(__pyx_k_end_idx), 0, 0, 1, 1},
     {&__pyx_n_s_enumerate, __pyx_k_enumerate, sizeof(__pyx_k_enumerate), 0, 0, 1, 1},
     {&__pyx_n_s_error, __pyx_k_error, sizeof(__pyx_k_error), 0, 0, 1, 1},
@@ -21094,14 +22143,15 @@
     {&__pyx_n_s_float32, __pyx_k_float32, sizeof(__pyx_k_float32), 0, 0, 1, 1},
     {&__pyx_n_s_float64, __pyx_k_float64, sizeof(__pyx_k_float64), 0, 0, 1, 1},
     {&__pyx_n_s_format, __pyx_k_format, sizeof(__pyx_k_format), 0, 0, 1, 1},
     {&__pyx_n_s_fortran, __pyx_k_fortran, sizeof(__pyx_k_fortran), 0, 0, 1, 1},
     {&__pyx_n_u_fortran, __pyx_k_fortran, sizeof(__pyx_k_fortran), 0, 1, 0, 1},
     {&__pyx_n_s_g, __pyx_k_g, sizeof(__pyx_k_g), 0, 0, 1, 1},
     {&__pyx_kp_u_gc, __pyx_k_gc, sizeof(__pyx_k_gc), 0, 1, 0, 0},
+    {&__pyx_n_s_get_bonded_groups, __pyx_k_get_bonded_groups, sizeof(__pyx_k_get_bonded_groups), 0, 0, 1, 1},
     {&__pyx_n_s_getstate, __pyx_k_getstate, sizeof(__pyx_k_getstate), 0, 0, 1, 1},
     {&__pyx_kp_u_got, __pyx_k_got, sizeof(__pyx_k_got), 0, 1, 0, 0},
     {&__pyx_kp_u_got_differing_extents_in_dimensi, __pyx_k_got_differing_extents_in_dimensi, sizeof(__pyx_k_got_differing_extents_in_dimensi), 0, 1, 0, 0},
     {&__pyx_n_s_groups, __pyx_k_groups, sizeof(__pyx_k_groups), 0, 0, 1, 1},
     {&__pyx_n_s_grp_center, __pyx_k_grp_center, sizeof(__pyx_k_grp_center), 0, 0, 1, 1},
     {&__pyx_n_s_half_box, __pyx_k_half_box, sizeof(__pyx_k_half_box), 0, 0, 1, 1},
     {&__pyx_n_s_i, __pyx_k_i, sizeof(__pyx_k_i), 0, 0, 1, 1},
@@ -21109,37 +22159,40 @@
     {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
     {&__pyx_n_s_index, __pyx_k_index, sizeof(__pyx_k_index), 0, 0, 1, 1},
     {&__pyx_n_s_initializing, __pyx_k_initializing, sizeof(__pyx_k_initializing), 0, 0, 1, 1},
     {&__pyx_n_s_is_coroutine, __pyx_k_is_coroutine, sizeof(__pyx_k_is_coroutine), 0, 0, 1, 1},
     {&__pyx_kp_u_isenabled, __pyx_k_isenabled, sizeof(__pyx_k_isenabled), 0, 1, 0, 0},
     {&__pyx_n_s_itemsize, __pyx_k_itemsize, sizeof(__pyx_k_itemsize), 0, 0, 1, 1},
     {&__pyx_kp_s_itemsize_0_for_cython_array, __pyx_k_itemsize_0_for_cython_array, sizeof(__pyx_k_itemsize_0_for_cython_array), 0, 0, 1, 0},
+    {&__pyx_n_s_j, __pyx_k_j, sizeof(__pyx_k_j), 0, 0, 1, 1},
     {&__pyx_n_s_k, __pyx_k_k, sizeof(__pyx_k_k), 0, 0, 1, 1},
     {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
     {&__pyx_n_s_math, __pyx_k_math, sizeof(__pyx_k_math), 0, 0, 1, 1},
     {&__pyx_n_s_memview, __pyx_k_memview, sizeof(__pyx_k_memview), 0, 0, 1, 1},
     {&__pyx_n_s_mode, __pyx_k_mode, sizeof(__pyx_k_mode), 0, 0, 1, 1},
     {&__pyx_n_s_moleculekit_wrapping, __pyx_k_moleculekit_wrapping, sizeof(__pyx_k_moleculekit_wrapping), 0, 0, 1, 1},
     {&__pyx_kp_s_moleculekit_wrapping_wrapping_py, __pyx_k_moleculekit_wrapping_wrapping_py, sizeof(__pyx_k_moleculekit_wrapping_wrapping_py), 0, 0, 1, 0},
     {&__pyx_n_s_n, __pyx_k_n, sizeof(__pyx_k_n), 0, 0, 1, 1},
     {&__pyx_n_s_n_atoms, __pyx_k_n_atoms, sizeof(__pyx_k_n_atoms), 0, 0, 1, 1},
+    {&__pyx_n_s_n_bonds, __pyx_k_n_bonds, sizeof(__pyx_k_n_bonds), 0, 0, 1, 1},
     {&__pyx_n_s_n_centersel, __pyx_k_n_centersel, sizeof(__pyx_k_n_centersel), 0, 0, 1, 1},
     {&__pyx_n_s_n_frames, __pyx_k_n_frames, sizeof(__pyx_k_n_frames), 0, 0, 1, 1},
     {&__pyx_n_s_n_groups, __pyx_k_n_groups, sizeof(__pyx_k_n_groups), 0, 0, 1, 1},
     {&__pyx_n_s_name, __pyx_k_name, sizeof(__pyx_k_name), 0, 0, 1, 1},
     {&__pyx_n_s_name_2, __pyx_k_name_2, sizeof(__pyx_k_name_2), 0, 0, 1, 1},
     {&__pyx_n_s_ndim, __pyx_k_ndim, sizeof(__pyx_k_ndim), 0, 0, 1, 1},
     {&__pyx_n_s_new, __pyx_k_new, sizeof(__pyx_k_new), 0, 0, 1, 1},
     {&__pyx_kp_s_no_default___reduce___due_to_non, __pyx_k_no_default___reduce___due_to_non, sizeof(__pyx_k_no_default___reduce___due_to_non), 0, 0, 1, 0},
     {&__pyx_n_s_np, __pyx_k_np, sizeof(__pyx_k_np), 0, 0, 1, 1},
     {&__pyx_n_s_numpy, __pyx_k_numpy, sizeof(__pyx_k_numpy), 0, 0, 1, 1},
     {&__pyx_kp_u_numpy_core_multiarray_failed_to, __pyx_k_numpy_core_multiarray_failed_to, sizeof(__pyx_k_numpy_core_multiarray_failed_to), 0, 1, 0, 0},
     {&__pyx_kp_u_numpy_core_umath_failed_to_impor, __pyx_k_numpy_core_umath_failed_to_impor, sizeof(__pyx_k_numpy_core_umath_failed_to_impor), 0, 1, 0, 0},
     {&__pyx_n_s_obj, __pyx_k_obj, sizeof(__pyx_k_obj), 0, 0, 1, 1},
     {&__pyx_n_s_pack, __pyx_k_pack, sizeof(__pyx_k_pack), 0, 0, 1, 1},
+    {&__pyx_n_s_parent, __pyx_k_parent, sizeof(__pyx_k_parent), 0, 0, 1, 1},
     {&__pyx_n_s_pickle, __pyx_k_pickle, sizeof(__pyx_k_pickle), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_PickleError, __pyx_k_pyx_PickleError, sizeof(__pyx_k_pyx_PickleError), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_checksum, __pyx_k_pyx_checksum, sizeof(__pyx_k_pyx_checksum), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_result, __pyx_k_pyx_result, sizeof(__pyx_k_pyx_result), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_state, __pyx_k_pyx_state, sizeof(__pyx_k_pyx_state), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_type, __pyx_k_pyx_type, sizeof(__pyx_k_pyx_type), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_unpickle_Enum, __pyx_k_pyx_unpickle_Enum, sizeof(__pyx_k_pyx_unpickle_Enum), 0, 0, 1, 1},
@@ -21169,22 +22222,24 @@
     {&__pyx_n_s_translation, __pyx_k_translation, sizeof(__pyx_k_translation), 0, 0, 1, 1},
     {&__pyx_n_s_uint32, __pyx_k_uint32, sizeof(__pyx_k_uint32), 0, 0, 1, 1},
     {&__pyx_kp_s_unable_to_allocate_array_data, __pyx_k_unable_to_allocate_array_data, sizeof(__pyx_k_unable_to_allocate_array_data), 0, 0, 1, 0},
     {&__pyx_kp_s_unable_to_allocate_shape_and_str, __pyx_k_unable_to_allocate_shape_and_str, sizeof(__pyx_k_unable_to_allocate_shape_and_str), 0, 0, 1, 0},
     {&__pyx_n_s_unpack, __pyx_k_unpack, sizeof(__pyx_k_unpack), 0, 0, 1, 1},
     {&__pyx_n_s_update, __pyx_k_update, sizeof(__pyx_k_update), 0, 0, 1, 1},
     {&__pyx_n_s_version_info, __pyx_k_version_info, sizeof(__pyx_k_version_info), 0, 0, 1, 1},
+    {&__pyx_n_s_x, __pyx_k_x, sizeof(__pyx_k_x), 0, 0, 1, 1},
+    {&__pyx_n_s_y, __pyx_k_y, sizeof(__pyx_k_y), 0, 0, 1, 1},
     {&__pyx_n_s_zeros, __pyx_k_zeros, sizeof(__pyx_k_zeros), 0, 0, 1, 1},
     {0, 0, 0, 0, 0, 0, 0}
   };
   return __Pyx_InitStrings(__pyx_string_tab);
 }
 /* #### Code section: cached_builtins ### */
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 47, __pyx_L1_error)
+  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 84, __pyx_L1_error)
   __pyx_builtin___import__ = __Pyx_GetBuiltinName(__pyx_n_s_import); if (!__pyx_builtin___import__) __PYX_ERR(1, 100, __pyx_L1_error)
   __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(1, 141, __pyx_L1_error)
   __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(1, 156, __pyx_L1_error)
   __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(1, 159, __pyx_L1_error)
   __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(1, 2, __pyx_L1_error)
   __pyx_builtin_AssertionError = __Pyx_GetBuiltinName(__pyx_n_s_AssertionError); if (!__pyx_builtin_AssertionError) __PYX_ERR(1, 373, __pyx_L1_error)
   __pyx_builtin_Ellipsis = __Pyx_GetBuiltinName(__pyx_n_s_Ellipsis); if (!__pyx_builtin_Ellipsis) __PYX_ERR(1, 408, __pyx_L1_error)
@@ -21233,44 +22288,44 @@
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError, "Incompatible checksums (0x%x vs (0x82a3537, 0x6ae9995, 0xb068931) = (name))" % __pyx_checksum
  */
   __pyx_tuple__8 = PyTuple_Pack(3, __pyx_int_136983863, __pyx_int_112105877, __pyx_int_184977713); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__8);
   __Pyx_GIVEREF(__pyx_tuple__8);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(2, 983, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__9);
   __Pyx_GIVEREF(__pyx_tuple__9);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(2, 989, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__10);
   __Pyx_GIVEREF(__pyx_tuple__10);
 
-  /* "moleculekit/wrapping/wrapping.pyx":41
+  /* "moleculekit/wrapping/wrapping.pyx":107
  *     cdef int n_groups = groups.shape[0]
  *     cdef int n_centersel = centersel.shape[0]
  *     cdef FLOAT32_t[:] half_box = np.zeros(3, dtype=FLOAT32)             # <<<<<<<<<<<<<<
  *     cdef FLOAT32_t[:] box_center = np.zeros(3, dtype=FLOAT32)
  *     cdef FLOAT32_t[:] grp_center = np.zeros(3, dtype=FLOAT32)
  */
-  __pyx_tuple__11 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 41, __pyx_L1_error)
+  __pyx_tuple__11 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 107, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__11);
   __Pyx_GIVEREF(__pyx_tuple__11);
 
   /* "View.MemoryView":100
  * cdef object __pyx_collections_abc_Sequence "__pyx_collections_abc_Sequence"
  * try:
  *     if __import__("sys").version_info >= (3, 3):             # <<<<<<<<<<<<<<
@@ -21367,25 +22422,61 @@
  *     cdef object __pyx_result
  */
   __pyx_tuple__21 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__21);
   __Pyx_GIVEREF(__pyx_tuple__21);
   __pyx_codeobj__22 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__21, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__22)) __PYX_ERR(1, 1, __pyx_L1_error)
 
-  /* "moleculekit/wrapping/wrapping.pyx":28
+  /* "moleculekit/wrapping/wrapping.pyx":30
+ * # https://en.wikipedia.org/wiki/Disjoint-set_data_structure
+ * # Disjoint set implementation for finding the connected components of our molecule
+ * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
+ * @cython.wraparound(False)  # turn off negative index wrapping for entire function
+ * def disjoint_set_find(
+ */
+  __pyx_tuple__23 = PyTuple_Pack(2, __pyx_n_s_x, __pyx_n_s_parent); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 30, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__23);
+  __Pyx_GIVEREF(__pyx_tuple__23);
+  __pyx_codeobj__24 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__23, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_moleculekit_wrapping_wrapping_py, __pyx_n_s_disjoint_set_find, 30, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__24)) __PYX_ERR(0, 30, __pyx_L1_error)
+
+  /* "moleculekit/wrapping/wrapping.pyx":49
+ *     return x
+ * 
+ * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
+ * @cython.wraparound(False)  # turn off negative index wrapping for entire function
+ * def disjoint_set_merge(
+ */
+  __pyx_tuple__25 = PyTuple_Pack(4, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_parent, __pyx_n_s_size); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 49, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__25);
+  __Pyx_GIVEREF(__pyx_tuple__25);
+  __pyx_codeobj__26 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__25, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_moleculekit_wrapping_wrapping_py, __pyx_n_s_disjoint_set_merge, 49, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__26)) __PYX_ERR(0, 49, __pyx_L1_error)
+
+  /* "moleculekit/wrapping/wrapping.pyx":72
+ * 
+ * 
+ * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
+ * @cython.wraparound(False)  # turn off negative index wrapping for entire function
+ * def get_bonded_groups(
+ */
+  __pyx_tuple__27 = PyTuple_Pack(8, __pyx_n_s_bonds, __pyx_n_s_n_atoms, __pyx_n_s_parent, __pyx_n_s_size, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_n_bonds); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 72, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__27);
+  __Pyx_GIVEREF(__pyx_tuple__27);
+  __pyx_codeobj__28 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__27, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_moleculekit_wrapping_wrapping_py, __pyx_n_s_get_bonded_groups, 72, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__28)) __PYX_ERR(0, 72, __pyx_L1_error)
+
+  /* "moleculekit/wrapping/wrapping.pyx":94
  * 
  * 
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def calculate(
  */
-  __pyx_tuple__23 = PyTuple_Pack(21, __pyx_n_s_groups, __pyx_n_s_coords, __pyx_n_s_box, __pyx_n_s_centersel, __pyx_n_s_f, __pyx_n_s_i, __pyx_n_s_g, __pyx_n_s_a, __pyx_n_s_start_idx, __pyx_n_s_end_idx, __pyx_n_s_k, __pyx_n_s_n, __pyx_n_s_n_atoms, __pyx_n_s_n_frames, __pyx_n_s_n_groups, __pyx_n_s_n_centersel, __pyx_n_s_half_box, __pyx_n_s_box_center, __pyx_n_s_grp_center, __pyx_n_s_translation, __pyx_n_s_diff); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 28, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__23);
-  __Pyx_GIVEREF(__pyx_tuple__23);
-  __pyx_codeobj__24 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 21, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__23, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_moleculekit_wrapping_wrapping_py, __pyx_n_s_calculate, 28, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__24)) __PYX_ERR(0, 28, __pyx_L1_error)
+  __pyx_tuple__29 = PyTuple_Pack(21, __pyx_n_s_groups, __pyx_n_s_coords, __pyx_n_s_box, __pyx_n_s_centersel, __pyx_n_s_f, __pyx_n_s_i, __pyx_n_s_g, __pyx_n_s_a, __pyx_n_s_start_idx, __pyx_n_s_end_idx, __pyx_n_s_k, __pyx_n_s_n, __pyx_n_s_n_atoms, __pyx_n_s_n_frames, __pyx_n_s_n_groups, __pyx_n_s_n_centersel, __pyx_n_s_half_box, __pyx_n_s_box_center, __pyx_n_s_grp_center, __pyx_n_s_translation, __pyx_n_s_diff); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 94, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__29);
+  __Pyx_GIVEREF(__pyx_tuple__29);
+  __pyx_codeobj__30 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 21, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__29, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_moleculekit_wrapping_wrapping_py, __pyx_n_s_calculate, 94, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__30)) __PYX_ERR(0, 94, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 /* #### Code section: init_constants ### */
@@ -22563,24 +23654,60 @@
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 16, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_FLOAT64, __pyx_t_7) < 0) __PYX_ERR(0, 16, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "moleculekit/wrapping/wrapping.pyx":28
+  /* "moleculekit/wrapping/wrapping.pyx":30
+ * # https://en.wikipedia.org/wiki/Disjoint-set_data_structure
+ * # Disjoint set implementation for finding the connected components of our molecule
+ * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
+ * @cython.wraparound(False)  # turn off negative index wrapping for entire function
+ * def disjoint_set_find(
+ */
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11moleculekit_8wrapping_1disjoint_set_find, 0, __pyx_n_s_disjoint_set_find, NULL, __pyx_n_s_moleculekit_wrapping, __pyx_d, ((PyObject *)__pyx_codeobj__24)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 30, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_disjoint_set_find, __pyx_t_7) < 0) __PYX_ERR(0, 30, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+
+  /* "moleculekit/wrapping/wrapping.pyx":49
+ *     return x
+ * 
+ * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
+ * @cython.wraparound(False)  # turn off negative index wrapping for entire function
+ * def disjoint_set_merge(
+ */
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11moleculekit_8wrapping_3disjoint_set_merge, 0, __pyx_n_s_disjoint_set_merge, NULL, __pyx_n_s_moleculekit_wrapping, __pyx_d, ((PyObject *)__pyx_codeobj__26)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 49, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_disjoint_set_merge, __pyx_t_7) < 0) __PYX_ERR(0, 49, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+
+  /* "moleculekit/wrapping/wrapping.pyx":72
+ * 
+ * 
+ * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
+ * @cython.wraparound(False)  # turn off negative index wrapping for entire function
+ * def get_bonded_groups(
+ */
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11moleculekit_8wrapping_5get_bonded_groups, 0, __pyx_n_s_get_bonded_groups, NULL, __pyx_n_s_moleculekit_wrapping, __pyx_d, ((PyObject *)__pyx_codeobj__28)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 72, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_bonded_groups, __pyx_t_7) < 0) __PYX_ERR(0, 72, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+
+  /* "moleculekit/wrapping/wrapping.pyx":94
  * 
  * 
  * @cython.boundscheck(False) # turn off bounds-checking for entire function             # <<<<<<<<<<<<<<
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * def calculate(
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11moleculekit_8wrapping_1calculate, 0, __pyx_n_s_calculate, NULL, __pyx_n_s_moleculekit_wrapping, __pyx_d, ((PyObject *)__pyx_codeobj__24)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 28, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11moleculekit_8wrapping_7calculate, 0, __pyx_n_s_calculate, NULL, __pyx_n_s_moleculekit_wrapping, __pyx_d, ((PyObject *)__pyx_codeobj__30)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 94, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_calculate, __pyx_t_7) < 0) __PYX_ERR(0, 28, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_calculate, __pyx_t_7) < 0) __PYX_ERR(0, 94, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
   /* "moleculekit/wrapping/wrapping.pyx":1
  * # cython: cdivision=True             # <<<<<<<<<<<<<<
  * 
  * import numpy as np
  */
@@ -27919,14 +29046,36 @@
 {
     void *start1, *end1, *start2, *end2;
     __pyx_get_array_memory_extents(slice1, &start1, &end1, ndim, itemsize);
     __pyx_get_array_memory_extents(slice2, &start2, &end2, ndim, itemsize);
     return (start1 < end2) && (start2 < end1);
 }
 
+/* CIntFromPyVerify */
+  #define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)\
+    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 0)
+#define __PYX_VERIFY_RETURN_INT_EXC(target_type, func_type, func_value)\
+    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 1)
+#define __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, exc)\
+    {\
+        func_type value = func_value;\
+        if (sizeof(target_type) < sizeof(func_type)) {\
+            if (unlikely(value != (func_type) (target_type) value)) {\
+                func_type zero = 0;\
+                if (exc && unlikely(value == (func_type)-1 && PyErr_Occurred()))\
+                    return (target_type) -1;\
+                if (is_unsigned && unlikely(value < zero))\
+                    goto raise_neg_overflow;\
+                else\
+                    goto raise_overflow;\
+            }\
+        }\
+        return (target_type) value;\
+    }
+
 /* TypeInfoCompare */
   static int
 __pyx_typeinfo_cmp(__Pyx_TypeInfo *a, __Pyx_TypeInfo *b)
 {
     int i;
     if (!a || !b)
         return 0;
@@ -28143,57 +29292,93 @@
     retval = -1;
 no_fail:
     __Pyx_RefNannyFinishContext();
     return retval;
 }
 
 /* ObjectToMemviewSlice */
-  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_8wrapping_FLOAT32_t(PyObject *obj, int writable_flag) {
+  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_8wrapping_UINT32_t(PyObject *obj, int writable_flag) {
     __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
     __Pyx_BufFmt_StackElem stack[1];
     int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
     int retcode;
     if (obj == Py_None) {
         result.memview = (struct __pyx_memoryview_obj *) Py_None;
         return result;
     }
     retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
                                                  PyBUF_RECORDS_RO | writable_flag, 1,
-                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_8wrapping_FLOAT32_t, stack,
+                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_8wrapping_UINT32_t, stack,
                                                  &result, obj);
     if (unlikely(retcode == -1))
         goto __pyx_fail;
     return result;
 __pyx_fail:
     result.memview = NULL;
     result.data = NULL;
     return result;
 }
 
-/* CIntFromPyVerify */
-  #define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)\
-    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 0)
-#define __PYX_VERIFY_RETURN_INT_EXC(target_type, func_type, func_value)\
-    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 1)
-#define __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, exc)\
-    {\
-        func_type value = func_value;\
-        if (sizeof(target_type) < sizeof(func_type)) {\
-            if (unlikely(value != (func_type) (target_type) value)) {\
-                func_type zero = 0;\
-                if (exc && unlikely(value == (func_type)-1 && PyErr_Occurred()))\
-                    return (target_type) -1;\
-                if (is_unsigned && unlikely(value < zero))\
-                    goto raise_neg_overflow;\
-                else\
-                    goto raise_overflow;\
-            }\
-        }\
-        return (target_type) value;\
+/* ObjectToMemviewSlice */
+  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_11moleculekit_8wrapping_UINT32_t(PyObject *obj, int writable_flag) {
+    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
+    __Pyx_BufFmt_StackElem stack[1];
+    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
+    int retcode;
+    if (obj == Py_None) {
+        result.memview = (struct __pyx_memoryview_obj *) Py_None;
+        return result;
+    }
+    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
+                                                 PyBUF_RECORDS_RO | writable_flag, 2,
+                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_8wrapping_UINT32_t, stack,
+                                                 &result, obj);
+    if (unlikely(retcode == -1))
+        goto __pyx_fail;
+    return result;
+__pyx_fail:
+    result.memview = NULL;
+    result.data = NULL;
+    return result;
+}
+
+/* MemviewDtypeToObject */
+  static CYTHON_INLINE PyObject *__pyx_memview_get_nn___pyx_t_11moleculekit_8wrapping_UINT32_t(const char *itemp) {
+    return (PyObject *) __Pyx_PyInt_From_npy_uint32(*(__pyx_t_11moleculekit_8wrapping_UINT32_t *) itemp);
+}
+static CYTHON_INLINE int __pyx_memview_set_nn___pyx_t_11moleculekit_8wrapping_UINT32_t(const char *itemp, PyObject *obj) {
+    __pyx_t_11moleculekit_8wrapping_UINT32_t value = __Pyx_PyInt_As_npy_uint32(obj);
+    if (unlikely((value == ((npy_uint32)-1)) && PyErr_Occurred()))
+        return 0;
+    *(__pyx_t_11moleculekit_8wrapping_UINT32_t *) itemp = value;
+    return 1;
+}
+
+/* ObjectToMemviewSlice */
+  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11moleculekit_8wrapping_FLOAT32_t(PyObject *obj, int writable_flag) {
+    __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
+    __Pyx_BufFmt_StackElem stack[1];
+    int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
+    int retcode;
+    if (obj == Py_None) {
+        result.memview = (struct __pyx_memoryview_obj *) Py_None;
+        return result;
     }
+    retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
+                                                 PyBUF_RECORDS_RO | writable_flag, 1,
+                                                 &__Pyx_TypeInfo_nn___pyx_t_11moleculekit_8wrapping_FLOAT32_t, stack,
+                                                 &result, obj);
+    if (unlikely(retcode == -1))
+        goto __pyx_fail;
+    return result;
+__pyx_fail:
+    result.memview = NULL;
+    result.data = NULL;
+    return result;
+}
 
 /* Declarations */
   #if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
   #ifdef __cplusplus
     static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float x, float y) {
       return ::std::complex< float >(x, y);
     }
@@ -28697,76 +29882,285 @@
         }
     } else {
         __pyx_fatalerror("Acquisition count is %d (line %d)",
                          old_acquisition_count-1, lineno);
     }
 }
 
-/* CIntToPy */
-  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
+/* CIntFromPy */
+  static CYTHON_INLINE npy_uint32 __Pyx_PyInt_As_npy_uint32(PyObject *x) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
 #endif
-    const int neg_one = (int) -1, const_zero = (int) 0;
+    const npy_uint32 neg_one = (npy_uint32) -1, const_zero = (npy_uint32) 0;
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic pop
 #endif
     const int is_unsigned = neg_one > const_zero;
-    if (is_unsigned) {
-        if (sizeof(int) < sizeof(long)) {
-            return PyInt_FromLong((long) value);
-        } else if (sizeof(int) <= sizeof(unsigned long)) {
-            return PyLong_FromUnsignedLong((unsigned long) value);
+#if PY_MAJOR_VERSION < 3
+    if (likely(PyInt_Check(x))) {
+        if ((sizeof(npy_uint32) < sizeof(long))) {
+            __PYX_VERIFY_RETURN_INT(npy_uint32, long, PyInt_AS_LONG(x))
+        } else {
+            long val = PyInt_AS_LONG(x);
+            if (is_unsigned && unlikely(val < 0)) {
+                goto raise_neg_overflow;
+            }
+            return (npy_uint32) val;
+        }
+    } else
+#endif
+    if (likely(PyLong_Check(x))) {
+        if (is_unsigned) {
+#if CYTHON_USE_PYLONG_INTERNALS
+            if (unlikely(__Pyx_PyLong_IsNeg(x))) {
+                goto raise_neg_overflow;
+            } else if (__Pyx_PyLong_IsCompact(x)) {
+                __PYX_VERIFY_RETURN_INT(npy_uint32, __Pyx_compact_upylong, __Pyx_PyLong_CompactValueUnsigned(x))
+            } else {
+                const digit* digits = __Pyx_PyLong_Digits(x);
+                assert(__Pyx_PyLong_DigitCount(x) > 1);
+                switch (__Pyx_PyLong_DigitCount(x)) {
+                    case 2:
+                        if ((8 * sizeof(npy_uint32) > 1 * PyLong_SHIFT)) {
+                            if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
+                                __PYX_VERIFY_RETURN_INT(npy_uint32, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(npy_uint32) >= 2 * PyLong_SHIFT)) {
+                                return (npy_uint32) (((((npy_uint32)digits[1]) << PyLong_SHIFT) | (npy_uint32)digits[0]));
+                            }
+                        }
+                        break;
+                    case 3:
+                        if ((8 * sizeof(npy_uint32) > 2 * PyLong_SHIFT)) {
+                            if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
+                                __PYX_VERIFY_RETURN_INT(npy_uint32, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(npy_uint32) >= 3 * PyLong_SHIFT)) {
+                                return (npy_uint32) (((((((npy_uint32)digits[2]) << PyLong_SHIFT) | (npy_uint32)digits[1]) << PyLong_SHIFT) | (npy_uint32)digits[0]));
+                            }
+                        }
+                        break;
+                    case 4:
+                        if ((8 * sizeof(npy_uint32) > 3 * PyLong_SHIFT)) {
+                            if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
+                                __PYX_VERIFY_RETURN_INT(npy_uint32, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(npy_uint32) >= 4 * PyLong_SHIFT)) {
+                                return (npy_uint32) (((((((((npy_uint32)digits[3]) << PyLong_SHIFT) | (npy_uint32)digits[2]) << PyLong_SHIFT) | (npy_uint32)digits[1]) << PyLong_SHIFT) | (npy_uint32)digits[0]));
+                            }
+                        }
+                        break;
+                }
+            }
+#endif
+#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX < 0x030C00A7
+            if (unlikely(Py_SIZE(x) < 0)) {
+                goto raise_neg_overflow;
+            }
+#else
+            {
+                int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
+                if (unlikely(result < 0))
+                    return (npy_uint32) -1;
+                if (unlikely(result == 1))
+                    goto raise_neg_overflow;
+            }
+#endif
+            if ((sizeof(npy_uint32) <= sizeof(unsigned long))) {
+                __PYX_VERIFY_RETURN_INT_EXC(npy_uint32, unsigned long, PyLong_AsUnsignedLong(x))
 #ifdef HAVE_LONG_LONG
-        } else if (sizeof(int) <= sizeof(unsigned PY_LONG_LONG)) {
-            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
+            } else if ((sizeof(npy_uint32) <= sizeof(unsigned PY_LONG_LONG))) {
+                __PYX_VERIFY_RETURN_INT_EXC(npy_uint32, unsigned PY_LONG_LONG, PyLong_AsUnsignedLongLong(x))
 #endif
-        }
-    } else {
-        if (sizeof(int) <= sizeof(long)) {
-            return PyInt_FromLong((long) value);
+            }
+        } else {
+#if CYTHON_USE_PYLONG_INTERNALS
+            if (__Pyx_PyLong_IsCompact(x)) {
+                __PYX_VERIFY_RETURN_INT(npy_uint32, __Pyx_compact_pylong, __Pyx_PyLong_CompactValue(x))
+            } else {
+                const digit* digits = __Pyx_PyLong_Digits(x);
+                assert(__Pyx_PyLong_DigitCount(x) > 1);
+                switch (__Pyx_PyLong_SignedDigitCount(x)) {
+                    case -2:
+                        if ((8 * sizeof(npy_uint32) - 1 > 1 * PyLong_SHIFT)) {
+                            if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
+                                __PYX_VERIFY_RETURN_INT(npy_uint32, long, -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(npy_uint32) - 1 > 2 * PyLong_SHIFT)) {
+                                return (npy_uint32) (((npy_uint32)-1)*(((((npy_uint32)digits[1]) << PyLong_SHIFT) | (npy_uint32)digits[0])));
+                            }
+                        }
+                        break;
+                    case 2:
+                        if ((8 * sizeof(npy_uint32) > 1 * PyLong_SHIFT)) {
+                            if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
+                                __PYX_VERIFY_RETURN_INT(npy_uint32, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(npy_uint32) - 1 > 2 * PyLong_SHIFT)) {
+                                return (npy_uint32) ((((((npy_uint32)digits[1]) << PyLong_SHIFT) | (npy_uint32)digits[0])));
+                            }
+                        }
+                        break;
+                    case -3:
+                        if ((8 * sizeof(npy_uint32) - 1 > 2 * PyLong_SHIFT)) {
+                            if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
+                                __PYX_VERIFY_RETURN_INT(npy_uint32, long, -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(npy_uint32) - 1 > 3 * PyLong_SHIFT)) {
+                                return (npy_uint32) (((npy_uint32)-1)*(((((((npy_uint32)digits[2]) << PyLong_SHIFT) | (npy_uint32)digits[1]) << PyLong_SHIFT) | (npy_uint32)digits[0])));
+                            }
+                        }
+                        break;
+                    case 3:
+                        if ((8 * sizeof(npy_uint32) > 2 * PyLong_SHIFT)) {
+                            if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
+                                __PYX_VERIFY_RETURN_INT(npy_uint32, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(npy_uint32) - 1 > 3 * PyLong_SHIFT)) {
+                                return (npy_uint32) ((((((((npy_uint32)digits[2]) << PyLong_SHIFT) | (npy_uint32)digits[1]) << PyLong_SHIFT) | (npy_uint32)digits[0])));
+                            }
+                        }
+                        break;
+                    case -4:
+                        if ((8 * sizeof(npy_uint32) - 1 > 3 * PyLong_SHIFT)) {
+                            if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
+                                __PYX_VERIFY_RETURN_INT(npy_uint32, long, -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(npy_uint32) - 1 > 4 * PyLong_SHIFT)) {
+                                return (npy_uint32) (((npy_uint32)-1)*(((((((((npy_uint32)digits[3]) << PyLong_SHIFT) | (npy_uint32)digits[2]) << PyLong_SHIFT) | (npy_uint32)digits[1]) << PyLong_SHIFT) | (npy_uint32)digits[0])));
+                            }
+                        }
+                        break;
+                    case 4:
+                        if ((8 * sizeof(npy_uint32) > 3 * PyLong_SHIFT)) {
+                            if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
+                                __PYX_VERIFY_RETURN_INT(npy_uint32, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
+                            } else if ((8 * sizeof(npy_uint32) - 1 > 4 * PyLong_SHIFT)) {
+                                return (npy_uint32) ((((((((((npy_uint32)digits[3]) << PyLong_SHIFT) | (npy_uint32)digits[2]) << PyLong_SHIFT) | (npy_uint32)digits[1]) << PyLong_SHIFT) | (npy_uint32)digits[0])));
+                            }
+                        }
+                        break;
+                }
+            }
+#endif
+            if ((sizeof(npy_uint32) <= sizeof(long))) {
+                __PYX_VERIFY_RETURN_INT_EXC(npy_uint32, long, PyLong_AsLong(x))
 #ifdef HAVE_LONG_LONG
-        } else if (sizeof(int) <= sizeof(PY_LONG_LONG)) {
-            return PyLong_FromLongLong((PY_LONG_LONG) value);
+            } else if ((sizeof(npy_uint32) <= sizeof(PY_LONG_LONG))) {
+                __PYX_VERIFY_RETURN_INT_EXC(npy_uint32, PY_LONG_LONG, PyLong_AsLongLong(x))
 #endif
+            }
         }
-    }
-    {
-        int one = 1; int little = (int)*(unsigned char *)&one;
-        unsigned char *bytes = (unsigned char *)&value;
-#if !CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030d0000
-        return _PyLong_FromByteArray(bytes, sizeof(int),
-                                     little, !is_unsigned);
+        {
+            npy_uint32 val;
+            PyObject *v = __Pyx_PyNumber_IntOrLong(x);
+#if PY_MAJOR_VERSION < 3
+            if (likely(v) && !PyLong_Check(v)) {
+                PyObject *tmp = v;
+                v = PyNumber_Long(tmp);
+                Py_DECREF(tmp);
+            }
+#endif
+            if (likely(v)) {
+                int ret = -1;
+#if PY_VERSION_HEX < 0x030d0000 && !(CYTHON_COMPILING_IN_PYPY || CYTHON_COMPILING_IN_LIMITED_API) || defined(_PyLong_AsByteArray)
+                int one = 1; int is_little = (int)*(unsigned char *)&one;
+                unsigned char *bytes = (unsigned char *)&val;
+                ret = _PyLong_AsByteArray((PyLongObject *)v,
+                                           bytes, sizeof(val),
+                                           is_little, !is_unsigned);
 #else
-        PyObject *from_bytes, *result = NULL;
-        PyObject *py_bytes = NULL, *arg_tuple = NULL, *kwds = NULL, *order_str = NULL;
-        from_bytes = PyObject_GetAttrString((PyObject*)&PyLong_Type, "from_bytes");
-        if (!from_bytes) return NULL;
-        py_bytes = PyBytes_FromStringAndSize((char*)bytes, sizeof(int));
-        if (!py_bytes) goto limited_bad;
-        order_str = PyUnicode_FromString(little ? "little" : "big");
-        if (!order_str) goto limited_bad;
-        arg_tuple = PyTuple_Pack(2, py_bytes, order_str);
-        if (!arg_tuple) goto limited_bad;
-        if (!is_unsigned) {
-            kwds = PyDict_New();
-            if (!kwds) goto limited_bad;
-            if (PyDict_SetItemString(kwds, "signed", __Pyx_NewRef(Py_True))) goto limited_bad;
-        }
-        result = PyObject_Call(from_bytes, arg_tuple, kwds);
-        limited_bad:
-        Py_XDECREF(kwds);
-        Py_XDECREF(arg_tuple);
-        Py_XDECREF(order_str);
-        Py_XDECREF(py_bytes);
-        Py_XDECREF(from_bytes);
-        return result;
+                PyObject *stepval = NULL, *mask = NULL, *shift = NULL;
+                int bits, remaining_bits, is_negative = 0;
+                long idigit;
+                int chunk_size = (sizeof(long) < 8) ? 30 : 62;
+                if (unlikely(!PyLong_CheckExact(v))) {
+                    PyObject *tmp = v;
+                    v = PyNumber_Long(v);
+                    assert(PyLong_CheckExact(v));
+                    Py_DECREF(tmp);
+                    if (unlikely(!v)) return (npy_uint32) -1;
+                }
+#if CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030B0000
+                if (Py_SIZE(x) == 0)
+                    return (npy_uint32) 0;
+                is_negative = Py_SIZE(x) < 0;
+#else
+                {
+                    int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
+                    if (unlikely(result < 0))
+                        return (npy_uint32) -1;
+                    is_negative = result == 1;
+                }
 #endif
+                if (is_unsigned && unlikely(is_negative)) {
+                    goto raise_neg_overflow;
+                } else if (is_negative) {
+                    stepval = PyNumber_Invert(v);
+                    if (unlikely(!stepval))
+                        return (npy_uint32) -1;
+                } else {
+                    stepval = __Pyx_NewRef(v);
+                }
+                val = (npy_uint32) 0;
+                mask = PyLong_FromLong((1L << chunk_size) - 1); if (unlikely(!mask)) goto done;
+                shift = PyLong_FromLong(chunk_size); if (unlikely(!shift)) goto done;
+                for (bits = 0; bits < (int) sizeof(npy_uint32) * 8 - chunk_size; bits += chunk_size) {
+                    PyObject *tmp, *digit;
+                    digit = PyNumber_And(stepval, mask);
+                    if (unlikely(!digit)) goto done;
+                    idigit = PyLong_AsLong(digit);
+                    Py_DECREF(digit);
+                    if (unlikely(idigit < 0)) goto done;
+                    tmp = PyNumber_Rshift(stepval, shift);
+                    if (unlikely(!tmp)) goto done;
+                    Py_DECREF(stepval); stepval = tmp;
+                    val |= ((npy_uint32) idigit) << bits;
+                    #if CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030B0000
+                    if (Py_SIZE(stepval) == 0)
+                        goto unpacking_done;
+                    #endif
+                }
+                idigit = PyLong_AsLong(stepval);
+                if (unlikely(idigit < 0)) goto done;
+                remaining_bits = ((int) sizeof(npy_uint32) * 8) - bits - (is_unsigned ? 0 : 1);
+                if (unlikely(idigit >= (1L << remaining_bits)))
+                    goto raise_overflow;
+                val |= ((npy_uint32) idigit) << bits;
+            #if CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030B0000
+            unpacking_done:
+            #endif
+                if (!is_unsigned) {
+                    if (unlikely(val & (((npy_uint32) 1) << (sizeof(npy_uint32) * 8 - 1))))
+                        goto raise_overflow;
+                    if (is_negative)
+                        val = ~val;
+                }
+                ret = 0;
+            done:
+                Py_XDECREF(shift);
+                Py_XDECREF(mask);
+                Py_XDECREF(stepval);
+#endif
+                Py_DECREF(v);
+                if (likely(!ret))
+                    return val;
+            }
+            return (npy_uint32) -1;
+        }
+    } else {
+        npy_uint32 val;
+        PyObject *tmp = __Pyx_PyNumber_IntOrLong(x);
+        if (!tmp) return (npy_uint32) -1;
+        val = __Pyx_PyInt_As_npy_uint32(tmp);
+        Py_DECREF(tmp);
+        return val;
     }
+raise_overflow:
+    PyErr_SetString(PyExc_OverflowError,
+        "value too large to convert to npy_uint32");
+    return (npy_uint32) -1;
+raise_neg_overflow:
+    PyErr_SetString(PyExc_OverflowError,
+        "can't convert negative value to npy_uint32");
+    return (npy_uint32) -1;
 }
 
 /* CIntFromPy */
   static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *x) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
@@ -29035,14 +30429,142 @@
 raise_neg_overflow:
     PyErr_SetString(PyExc_OverflowError,
         "can't convert negative value to int");
     return (int) -1;
 }
 
 /* CIntToPy */
+  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_npy_uint32(npy_uint32 value) {
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wconversion"
+#endif
+    const npy_uint32 neg_one = (npy_uint32) -1, const_zero = (npy_uint32) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic pop
+#endif
+    const int is_unsigned = neg_one > const_zero;
+    if (is_unsigned) {
+        if (sizeof(npy_uint32) < sizeof(long)) {
+            return PyInt_FromLong((long) value);
+        } else if (sizeof(npy_uint32) <= sizeof(unsigned long)) {
+            return PyLong_FromUnsignedLong((unsigned long) value);
+#ifdef HAVE_LONG_LONG
+        } else if (sizeof(npy_uint32) <= sizeof(unsigned PY_LONG_LONG)) {
+            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
+#endif
+        }
+    } else {
+        if (sizeof(npy_uint32) <= sizeof(long)) {
+            return PyInt_FromLong((long) value);
+#ifdef HAVE_LONG_LONG
+        } else if (sizeof(npy_uint32) <= sizeof(PY_LONG_LONG)) {
+            return PyLong_FromLongLong((PY_LONG_LONG) value);
+#endif
+        }
+    }
+    {
+        int one = 1; int little = (int)*(unsigned char *)&one;
+        unsigned char *bytes = (unsigned char *)&value;
+#if !CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030d0000
+        return _PyLong_FromByteArray(bytes, sizeof(npy_uint32),
+                                     little, !is_unsigned);
+#else
+        PyObject *from_bytes, *result = NULL;
+        PyObject *py_bytes = NULL, *arg_tuple = NULL, *kwds = NULL, *order_str = NULL;
+        from_bytes = PyObject_GetAttrString((PyObject*)&PyLong_Type, "from_bytes");
+        if (!from_bytes) return NULL;
+        py_bytes = PyBytes_FromStringAndSize((char*)bytes, sizeof(npy_uint32));
+        if (!py_bytes) goto limited_bad;
+        order_str = PyUnicode_FromString(little ? "little" : "big");
+        if (!order_str) goto limited_bad;
+        arg_tuple = PyTuple_Pack(2, py_bytes, order_str);
+        if (!arg_tuple) goto limited_bad;
+        if (!is_unsigned) {
+            kwds = PyDict_New();
+            if (!kwds) goto limited_bad;
+            if (PyDict_SetItemString(kwds, "signed", __Pyx_NewRef(Py_True))) goto limited_bad;
+        }
+        result = PyObject_Call(from_bytes, arg_tuple, kwds);
+        limited_bad:
+        Py_XDECREF(kwds);
+        Py_XDECREF(arg_tuple);
+        Py_XDECREF(order_str);
+        Py_XDECREF(py_bytes);
+        Py_XDECREF(from_bytes);
+        return result;
+#endif
+    }
+}
+
+/* CIntToPy */
+  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wconversion"
+#endif
+    const int neg_one = (int) -1, const_zero = (int) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic pop
+#endif
+    const int is_unsigned = neg_one > const_zero;
+    if (is_unsigned) {
+        if (sizeof(int) < sizeof(long)) {
+            return PyInt_FromLong((long) value);
+        } else if (sizeof(int) <= sizeof(unsigned long)) {
+            return PyLong_FromUnsignedLong((unsigned long) value);
+#ifdef HAVE_LONG_LONG
+        } else if (sizeof(int) <= sizeof(unsigned PY_LONG_LONG)) {
+            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
+#endif
+        }
+    } else {
+        if (sizeof(int) <= sizeof(long)) {
+            return PyInt_FromLong((long) value);
+#ifdef HAVE_LONG_LONG
+        } else if (sizeof(int) <= sizeof(PY_LONG_LONG)) {
+            return PyLong_FromLongLong((PY_LONG_LONG) value);
+#endif
+        }
+    }
+    {
+        int one = 1; int little = (int)*(unsigned char *)&one;
+        unsigned char *bytes = (unsigned char *)&value;
+#if !CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030d0000
+        return _PyLong_FromByteArray(bytes, sizeof(int),
+                                     little, !is_unsigned);
+#else
+        PyObject *from_bytes, *result = NULL;
+        PyObject *py_bytes = NULL, *arg_tuple = NULL, *kwds = NULL, *order_str = NULL;
+        from_bytes = PyObject_GetAttrString((PyObject*)&PyLong_Type, "from_bytes");
+        if (!from_bytes) return NULL;
+        py_bytes = PyBytes_FromStringAndSize((char*)bytes, sizeof(int));
+        if (!py_bytes) goto limited_bad;
+        order_str = PyUnicode_FromString(little ? "little" : "big");
+        if (!order_str) goto limited_bad;
+        arg_tuple = PyTuple_Pack(2, py_bytes, order_str);
+        if (!arg_tuple) goto limited_bad;
+        if (!is_unsigned) {
+            kwds = PyDict_New();
+            if (!kwds) goto limited_bad;
+            if (PyDict_SetItemString(kwds, "signed", __Pyx_NewRef(Py_True))) goto limited_bad;
+        }
+        result = PyObject_Call(from_bytes, arg_tuple, kwds);
+        limited_bad:
+        Py_XDECREF(kwds);
+        Py_XDECREF(arg_tuple);
+        Py_XDECREF(order_str);
+        Py_XDECREF(py_bytes);
+        Py_XDECREF(from_bytes);
+        return result;
+#endif
+    }
+}
+
+/* CIntToPy */
   static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
 #endif
     const long neg_one = (long) -1, const_zero = (long) 0;
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
@@ -29654,15 +31176,15 @@
 __Pyx_PyType_GetName(PyTypeObject* tp)
 {
     PyObject *name = __Pyx_PyObject_GetAttrStr((PyObject *)tp,
                                                __pyx_n_s_name_2);
     if (unlikely(name == NULL) || unlikely(!PyUnicode_Check(name))) {
         PyErr_Clear();
         Py_XDECREF(name);
-        name = __Pyx_NewRef(__pyx_n_s__25);
+        name = __Pyx_NewRef(__pyx_n_s__31);
     }
     return name;
 }
 #endif
 
 /* CheckBinaryVersion */
   static unsigned long __Pyx_get_runtime_version(void) {
```

### Comparing `moleculekit-1.8.6/moleculekit/writers.py` & `moleculekit-1.8.7/moleculekit/writers.py`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/xtc_utils/include/xdrfile.h` & `moleculekit-1.8.7/moleculekit/xtc_utils/include/xdrfile.h`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/xtc_utils/include/xdrfile_xtc.h` & `moleculekit-1.8.7/moleculekit/xtc_utils/include/xdrfile_xtc.h`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/xtc_utils/include/xtc.h` & `moleculekit-1.8.7/moleculekit/xtc_utils/include/xtc.h`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/xtc_utils/src/xdrfile.cpp` & `moleculekit-1.8.7/moleculekit/xtc_utils/src/xdrfile.cpp`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/xtc_utils/src/xdrfile_xtc.cpp` & `moleculekit-1.8.7/moleculekit/xtc_utils/src/xdrfile_xtc.cpp`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/xtc_utils/src/xtc.cpp` & `moleculekit-1.8.7/moleculekit/xtc_utils/src/xtc.cpp`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/xtc_utils/xtc.cpp` & `moleculekit-1.8.7/moleculekit/xtc_utils/xtc.cpp`

 * *Files 1% similar despite different names*

```diff
@@ -1,25 +1,25 @@
 /* Generated by Cython 3.0.5 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h",
             "moleculekit/xtc_utils/include/xtc.h"
         ],
         "include_dirs": [
             "moleculekit/xtc_utils",
             "moleculekit/xtc_utils/include/",
             "moleculekit/xtc_utils/",
-            "/tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/core/include"
+            "/tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/core/include"
         ],
         "language": "c++",
         "name": "moleculekit.xtc",
         "sources": [
             "moleculekit/xtc_utils/xtc.pyx",
             "moleculekit/xtc_utils/src/xdrfile_xtc.cpp",
             "moleculekit/xtc_utils/src/xdrfile.cpp",
@@ -1672,177 +1672,177 @@
   Py_ssize_t strides[8];
   Py_ssize_t suboffsets[8];
 } __Pyx_memviewslice;
 #define __Pyx_MemoryView_Len(m)  (m.shape[0])
 
 /* #### Code section: numeric_typedefs ### */
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":730
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":730
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":731
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":731
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":732
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":732
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":733
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":733
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":737
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":737
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":738
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":738
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":739
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":739
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":740
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":740
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":744
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":744
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":745
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":745
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":754
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":754
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":755
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":755
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":757
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":757
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":758
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":758
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":760
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":760
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":761
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":761
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":763
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":763
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":764
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":764
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":765
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":765
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
@@ -1955,42 +1955,42 @@
 
 /*--- Type declarations ---*/
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
 struct __pyx_memoryviewslice_obj;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":767
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":767
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":768
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":768
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":769
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":769
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":771
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":771
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -18101,261 +18101,261 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_7ndarray_4base_base(PyArrayObject *__pyx_v_self) {
   PyObject *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":248
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":248
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  *             return PyArray_BASE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_BASE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
 static CYTHON_INLINE PyArray_Descr *__pyx_f_5numpy_7ndarray_5descr_descr(PyArrayObject *__pyx_v_self) {
   PyArray_Descr *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyArray_Descr *__pyx_t_1;
   __Pyx_RefNannySetupContext("descr", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":254
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":254
  *             """Returns an owned reference to the dtype of the array.
  *             """
  *             return <dtype>PyArray_DESCR(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __pyx_t_1 = PyArray_DESCR(__pyx_v_self);
   __Pyx_INCREF((PyObject *)((PyArray_Descr *)__pyx_t_1));
   __pyx_r = ((PyArray_Descr *)__pyx_t_1);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_7ndarray_4ndim_ndim(PyArrayObject *__pyx_v_self) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":260
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":260
  *             """Returns the number of dimensions in the array.
  *             """
  *             return PyArray_NDIM(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_NDIM(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_5shape_shape(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":268
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":268
  *             Can return NULL for 0-dimensional arrays.
  *             """
  *             return PyArray_DIMS(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_DIMS(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_7strides_strides(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":275
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":275
  *             The number of elements matches the number of dimensions of the array (ndim).
  *             """
  *             return PyArray_STRIDES(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_STRIDES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
 static CYTHON_INLINE npy_intp __pyx_f_5numpy_7ndarray_4size_size(PyArrayObject *__pyx_v_self) {
   npy_intp __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":281
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":281
  *             """Returns the total size (in number of elements) of the array.
  *             """
  *             return PyArray_SIZE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_SIZE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
 static CYTHON_INLINE char *__pyx_f_5numpy_7ndarray_4data_data(PyArrayObject *__pyx_v_self) {
   char *__pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":290
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":290
  *             of `PyArray_DATA()` instead, which returns a 'void*'.
  *             """
  *             return PyArray_BYTES(self)             # <<<<<<<<<<<<<<
  * 
  *     ctypedef unsigned char      npy_bool
  */
   __pyx_r = PyArray_BYTES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -18364,29 +18364,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":774
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":774
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 774, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -18397,15 +18397,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -18414,29 +18414,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":777
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":777
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -18447,15 +18447,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -18464,29 +18464,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":780
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":780
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 780, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -18497,15 +18497,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -18514,29 +18514,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":783
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":783
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -18547,15 +18547,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -18564,29 +18564,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":786
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":786
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -18597,217 +18597,217 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = PyDataType_HASSUBARRAY(__pyx_v_d);
   if (__pyx_t_1) {
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":790
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":790
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":792
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":792
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":968
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":968
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":969
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":969
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   __pyx_t_1 = PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(2, 969, __pyx_L1_error)
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":967
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_AddTraceback("numpy.set_array_base", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":972
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":972
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = (__pyx_v_base == NULL);
   if (__pyx_t_1) {
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":974
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":974
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":973
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":975
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":975
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":971
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -18823,15 +18823,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -18839,68 +18839,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":981
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":981
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 981, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":982
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":982
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 982, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 983, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 983, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":980
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -18908,15 +18908,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":979
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -18931,15 +18931,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -18955,15 +18955,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -18971,68 +18971,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":987
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":987
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 987, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":988
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":988
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 988, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 989, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 989, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":986
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19040,15 +19040,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":985
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19063,15 +19063,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19087,15 +19087,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 1);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19103,68 +19103,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":993
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":993
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 993, __pyx_L3_error)
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":994
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":994
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 994, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":995
+      /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":995
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 995, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 995, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
+    /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":992
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19172,15 +19172,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":991
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19195,170 +19195,170 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1010
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1010
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":998
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1025
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1025
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1013
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
 static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
   npy_datetime __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1035
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1035
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1028
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
 static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
   npy_timedelta __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1042
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1042
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1038
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
+/* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
 static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
   NPY_DATETIMEUNIT __pyx_r;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1049
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1049
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":1045
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -22054,26 +22054,26 @@
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError, "Incompatible checksums (0x%x vs (0x82a3537, 0x6ae9995, 0xb068931) = (name))" % __pyx_checksum
  */
   __pyx_tuple__8 = PyTuple_Pack(3, __pyx_int_136983863, __pyx_int_112105877, __pyx_int_184977713); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__8);
   __Pyx_GIVEREF(__pyx_tuple__8);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":983
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(2, 983, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__9);
   __Pyx_GIVEREF(__pyx_tuple__9);
 
-  /* "../../../../../tmp/build-env-1eqse1le/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
+  /* "../../../../../tmp/build-env-9yxh7pgk/lib/python3.10/site-packages/numpy/__init__.cython-30.pxd":989
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(2, 989, __pyx_L1_error)
```

### Comparing `moleculekit-1.8.6/moleculekit/xtc_utils/xtc.pyx` & `moleculekit-1.8.7/moleculekit/xtc_utils/xtc.pyx`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit/xtc_utils/xtclib.pxd` & `moleculekit-1.8.7/moleculekit/xtc_utils/xtclib.pxd`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/moleculekit.egg-info/PKG-INFO` & `moleculekit-1.8.7/moleculekit.egg-info/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: moleculekit
-Version: 1.8.6
+Version: 1.8.7
 Summary: A molecule reading/writing and manipulation package.
 Author-email: Stefan Doerr <s.doerr@acellera.com>
 Project-URL: Homepage, https://github.com/Acellera/moleculekit
 Project-URL: Bug Tracker, https://github.com/Acellera/moleculekit/issues
 Classifier: Programming Language :: Python :: 3
 Classifier: Operating System :: POSIX :: Linux
 Requires-Python: >=3.8
```

### Comparing `moleculekit-1.8.6/moleculekit.egg-info/SOURCES.txt` & `moleculekit-1.8.7/moleculekit.egg-info/SOURCES.txt`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/pyproject.toml` & `moleculekit-1.8.7/pyproject.toml`

 * *Files identical despite different names*

### Comparing `moleculekit-1.8.6/setup.py` & `moleculekit-1.8.7/setup.py`

 * *Files identical despite different names*

