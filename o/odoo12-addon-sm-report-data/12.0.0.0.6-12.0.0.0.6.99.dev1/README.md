# Comparing `tmp/odoo12_addon_sm_report_data-12.0.0.0.6-py2.py3-none-any.whl.zip` & `tmp/odoo12_addon_sm_report_data-12.0.0.0.6.99.dev1-py2.py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,18 +1,18 @@
-Zip file size: 11494 bytes, number of entries: 16
--rw-r--r--  2.0 unx       68 b- defN 22-May-09 14:05 odoo/addons/sm_report_data/__init__.py
--rw-r--r--  2.0 unx      910 b- defN 22-May-26 15:13 odoo/addons/sm_report_data/__manifest__.py
--rw-r--r--  2.0 unx       99 b- defN 22-May-09 14:05 odoo/addons/sm_report_data/models/__init__.py
--rw-r--r--  2.0 unx      372 b- defN 22-May-09 14:05 odoo/addons/sm_report_data/models/model_reports_cron.py
--rw-r--r--  2.0 unx     6379 b- defN 22-May-26 15:06 odoo/addons/sm_report_data/models/models_report_configuration.py
--rw-r--r--  2.0 unx    14444 b- defN 22-May-26 15:02 odoo/addons/sm_report_data/models/report_helper.py
--rw-r--r--  2.0 unx       28 b- defN 22-May-09 14:05 odoo/addons/sm_report_data/reports/__init__.py
--rw-r--r--  2.0 unx     1740 b- defN 22-May-26 14:43 odoo/addons/sm_report_data/reports/mossos_report.py
--rw-r--r--  2.0 unx      188 b- defN 22-May-09 14:05 odoo/addons/sm_report_data/security/ir.model.access.csv
--rw-r--r--  2.0 unx      872 b- defN 22-May-09 14:05 odoo/addons/sm_report_data/views/templates.xml
--rw-r--r--  2.0 unx      168 b- defN 22-May-09 14:05 odoo/addons/sm_report_data/views/views.xml
--rw-r--r--  2.0 unx     2822 b- defN 22-May-09 14:05 odoo/addons/sm_report_data/views/views_report_configuration.xml
--rw-r--r--  2.0 unx      606 b- defN 22-May-26 15:16 odoo12_addon_sm_report_data-12.0.0.0.6.dist-info/METADATA
--rw-r--r--  2.0 unx      110 b- defN 22-May-26 15:16 odoo12_addon_sm_report_data-12.0.0.0.6.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 22-May-26 15:16 odoo12_addon_sm_report_data-12.0.0.0.6.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     1668 b- defN 22-May-26 15:16 odoo12_addon_sm_report_data-12.0.0.0.6.dist-info/RECORD
-16 files, 30479 bytes uncompressed, 8606 bytes compressed:  71.8%
+Zip file size: 11654 bytes, number of entries: 16
+-rw-rw-r--  2.0 unx       68 b- defN 23-Dec-19 17:24 odoo/addons/sm_report_data/__init__.py
+-rw-rw-r--  2.0 unx      781 b- defN 23-Dec-19 17:24 odoo/addons/sm_report_data/__manifest__.py
+-rw-rw-r--  2.0 unx       99 b- defN 23-Dec-19 17:24 odoo/addons/sm_report_data/models/__init__.py
+-rw-rw-r--  2.0 unx      405 b- defN 23-Dec-19 17:24 odoo/addons/sm_report_data/models/model_reports_cron.py
+-rw-rw-r--  2.0 unx     7161 b- defN 23-Dec-19 17:24 odoo/addons/sm_report_data/models/models_report_configuration.py
+-rw-rw-r--  2.0 unx    16987 b- defN 23-Dec-19 17:24 odoo/addons/sm_report_data/models/report_helper.py
+-rw-rw-r--  2.0 unx       28 b- defN 23-Dec-19 17:24 odoo/addons/sm_report_data/reports/__init__.py
+-rw-rw-r--  2.0 unx     1740 b- defN 23-Dec-19 17:24 odoo/addons/sm_report_data/reports/mossos_report.py
+-rw-rw-r--  2.0 unx      188 b- defN 23-Dec-19 17:24 odoo/addons/sm_report_data/security/ir.model.access.csv
+-rw-rw-r--  2.0 unx      872 b- defN 23-Dec-19 17:24 odoo/addons/sm_report_data/views/templates.xml
+-rw-rw-r--  2.0 unx      168 b- defN 23-Dec-19 17:24 odoo/addons/sm_report_data/views/views.xml
+-rw-rw-r--  2.0 unx     2822 b- defN 23-Dec-19 17:24 odoo/addons/sm_report_data/views/views_report_configuration.xml
+-rw-rw-r--  2.0 unx      608 b- defN 24-May-10 10:52 odoo12_addon_sm_report_data-12.0.0.0.6.99.dev1.dist-info/METADATA
+-rw-rw-r--  2.0 unx      110 b- defN 24-May-10 10:52 odoo12_addon_sm_report_data-12.0.0.0.6.99.dev1.dist-info/WHEEL
+-rw-rw-r--  2.0 unx        5 b- defN 24-May-10 10:52 odoo12_addon_sm_report_data-12.0.0.0.6.99.dev1.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     1700 b- defN 24-May-10 10:52 odoo12_addon_sm_report_data-12.0.0.0.6.99.dev1.dist-info/RECORD
+16 files, 33742 bytes uncompressed, 8702 bytes compressed:  74.2%
```

## zipnote {}

```diff
@@ -30,20 +30,20 @@
 
 Filename: odoo/addons/sm_report_data/views/views.xml
 Comment: 
 
 Filename: odoo/addons/sm_report_data/views/views_report_configuration.xml
 Comment: 
 
-Filename: odoo12_addon_sm_report_data-12.0.0.0.6.dist-info/METADATA
+Filename: odoo12_addon_sm_report_data-12.0.0.0.6.99.dev1.dist-info/METADATA
 Comment: 
 
-Filename: odoo12_addon_sm_report_data-12.0.0.0.6.dist-info/WHEEL
+Filename: odoo12_addon_sm_report_data-12.0.0.0.6.99.dev1.dist-info/WHEEL
 Comment: 
 
-Filename: odoo12_addon_sm_report_data-12.0.0.0.6.dist-info/top_level.txt
+Filename: odoo12_addon_sm_report_data-12.0.0.0.6.99.dev1.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo12_addon_sm_report_data-12.0.0.0.6.dist-info/RECORD
+Filename: odoo12_addon_sm_report_data-12.0.0.0.6.99.dev1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/sm_report_data/__manifest__.py

```diff
@@ -1,34 +1,31 @@
 # -*- coding: utf-8 -*-
 {
-  'name': "sm_report_data",
+    'name': "sm_report_data",
 
-  'summary': """
+    'summary': """
      Module to generate reports xlsx and be able to send it via mail. 
   """,
 
-  'description': """
+    'description': """
   The module allows establishing a periodicity to generate and send a report automatically.
   """,
 
-  'author': "Som Mobilitat",
-  'website': "http://www.sommobilitat.coop",
+    'author': "Som Mobilitat",
+    'website': "http://www.sommobilitat.coop",
 
-  # Categories can be used to filter modules in modules listing
-  # Check https://github.com/odoo/odoo/blob/11.0/odoo/addons/base/module/module_data.xml
-  # for the full list
-  'category': 'Reports',
-  'version': '12.0.0.0.6',
-
-  # any module necessary for this one to work correctly
-  'depends': ['base','vertical_carsharing','report_xlsx'],
-
-  # always loaded
-  'data': [
-    'security/ir.model.access.csv',
-    'views/views.xml',
-    'views/templates.xml',
-    'views/views_report_configuration.xml',
-  ],
-  # only loaded in demonstration mode
-  'demo': [],
+    'category': 'Reports',
+    'version': '12.0.0.0.6',
+
+    # any module necessary for this one to work correctly
+    'depends': ['base', 'vertical_carsharing', 'report_xlsx'],
+
+    # always loaded
+    'data': [
+        'security/ir.model.access.csv',
+        'views/views.xml',
+        'views/templates.xml',
+        'views/views_report_configuration.xml',
+    ],
+    # only loaded in demonstration mode
+    'demo': [],
 }
```

## odoo/addons/sm_report_data/models/model_reports_cron.py

```diff
@@ -1,14 +1,15 @@
 # -*- coding: utf-8 -*-
 
 from odoo import models, fields, api
 from odoo.tools.translate import _
 
 
 class reports_cron(models.Model):
-  _name = 'sm_report_data.reports_cron'
+    _name = 'sm_report_data.reports_cron'
 
-  @api.model
-  def reports_cron_action(self):
-    reports = self.env['sm_report_data.sm_report_data'].search([('active', '=', True)])
-    for report in reports:
-      report.send_report_via_email()
+    @api.model
+    def reports_cron_action(self):
+        reports = self.env['sm_report_data.sm_report_data'].search(
+            [('active', '=', True)])
+        for report in reports:
+            report.send_report_via_email()
```

## odoo/addons/sm_report_data/models/models_report_configuration.py

```diff
@@ -1,191 +1,191 @@
 # -*- coding: utf-8 -*-
 import pytz
 import xlsxwriter
 from odoo import models, fields, api
 from odoo.tools.translate import _
 
 try:
-  from StringIO import StringIO
+    from StringIO import StringIO
 except ImportError:
-  from io import StringIO
+    from io import StringIO
 import base64
 
 from io import BytesIO
 from odoo.addons.sm_report_data.models.report_helper import report_helper
 import time
 from datetime import timedelta, datetime
 
 
 class sm_report_data(models.Model):
-  _name = 'sm_report_data.sm_report_data'
+    _name = 'sm_report_data.sm_report_data'
 
-  name = fields.Char(string=_("Name"), required=True)
-  report_model = fields.Many2one('ir.model', string=_("Report model"), required=True)
-  recipient = fields.Many2one('res.partner', string="Destinataris", required=True)
-
-  description = fields.Text()
-
-  last_execution = fields.Date(string=_("Last execution"), default=time.strftime('%Y-%m-%d'))
-  next_execution = fields.Date(string=_("Next execution"))
-  final_date = fields.Date(string=_("Final date"))
-
-  specific_search = fields.Boolean(string=_("Specific range (Days)"))
-  general_range = fields.Selection([
-    ('day', 'Days'),
-    ('week', 'Weeks'),
-    ('month', 'Months'),
-    ('year', 'Years'),
-  ], string='Range', default='day')
-
-  daily_range = fields.Selection(
-    [(num, str(num)) for num in range(1, 32)]
-    , string=_("Number"), default=1)
-
-  email_template = fields.Many2one('mail.template', string=_("Mail template"))
-  email_subject = fields.Char(string=_("Email subject"))
-  email_body = fields.Char(string=_("Email body"))
-
-  active = fields.Boolean(string=_("Active"))
-
-  report_helper = report_helper.get_instance()
-
-  @api.model
-  def send_email(self):
-    if self.env.context:
-      if 'active_ids' in self.env.context:
-        models = self.env['sm_report_data.sm_report_data'].browse(self.env.context['active_ids'])
-        if models.exists():
-          for rec in models:
-            rec.send_report_via_email()
-
-  def send_report_via_email(self):
-    try:
-      self.send_report_via_email_inside()
-    except:
-      print("ERROR SENDING");
-
-  def send_report_via_email_inside(self):
-    if not self.next_execution:
-      self.calculate_next_execute()
-
-    next_exe = datetime.strptime(str(self.next_execution), '%Y-%m-%d')
-
-    timezone = pytz.timezone('Europe/Madrid')
-    date_time = datetime.now(tz=timezone)
-    sys_date = datetime.date(date_time)
-
-    if sys_date == next_exe.date():
-      fp = BytesIO()
-      workbook = xlsxwriter.Workbook(fp)
-      worksheet = self.report_helper.generate_header(workbook)
-
-      objects_to_iterate = self.get_objects_to_iterates()
-
-      self.report_helper.fill_document(objects_to_iterate, worksheet)
-
-      workbook.close()
-      fp.seek(0)
-      datas = base64.b64encode(fp.read())
-
-      file_name = "Report-" + str(sys_date) + ".xlsx"
-
-      attachment = []
-
-      attachment_data = {
-        'name': file_name,
-        'datas_fname': file_name,
-        'datas': datas,
-        'res_model': "modelname",
-      }
-
-      id_new_attachment = self.env['ir.attachment'].create(attachment_data).id
-      attachment.append(id_new_attachment)
-      mail_template_name = "mail_template_reports_" + str(self.id)
-      mail_template_name = mail_template_name.lower()
-      mail_model = self.env['mail.template'].search(
-        [("name", "=", mail_template_name)], limit=1)
-      # Delete previously created attachments
-      for attachment in mail_model.attachment_ids:
-        attachment.unlink()
-      mail_model.attachment_ids = [(4, id_new_attachment)]
-      email_values = {'send_from_code': True}
-      mail_model.with_context(email_values).send_mail(self.id, raise_exception=False, force_send=True)
-      # self.env['ir.attachment'].search([('id', '=', id_new_attachment)]).unlink()
-      self.last_execution = sys_date
-      self.calculate_next_execute()
-
-  def calculate_next_execute(self):
-    range_execution = self.general_range
-    initial_date = self.last_execution
-    initial_date = datetime.strptime(str(initial_date), '%Y-%m-%d')
-    days = self.daily_range
-    if range_execution == "day":
-      final_date = initial_date + timedelta(days=days)
-    elif range_execution == "week":
-      final_date = initial_date + timedelta(weeks=days)
-    elif range_execution == "month":
-      final_date = initial_date + timedelta(days * 365 / 12)
-    elif range_execution == "year":
-      final_date = initial_date + timedelta(days * 365)
-    self.next_execution = final_date.strftime('%Y-%m-%d')
-
-  def get_objects_to_iterates(self):
-    initial_date = datetime.strptime(str(self.last_execution), '%Y-%m-%d')
-
-    model = self.report_model.model
-
-    days = self.daily_range
-    range_execution = self.general_range
-
-    if range_execution == "day":
-      final_date = initial_date + timedelta(days=days)
-    elif range_execution == "week":
-      final_date = initial_date + timedelta(weeks=days)
-    elif range_execution == "month":
-      final_date = initial_date + timedelta(days * 365 / 12)
-    elif range_execution == "year":
-      final_date = initial_date + timedelta(days * 365)
-
-    print('REPORT: filtering creating report!!!')
-    print(str(initial_date))
-    print(str(final_date))
-
-    affected_objects = self.env[model].search(
-      [
-        ('effectiveStartTime', '>=', str(initial_date)),
-        ('effectiveStartTime', '<', str(final_date)),
-      ], order="id")
-
-    print(str(affected_objects))
-
-    # filtered_list = affected_objects.filtered(lambda r:
-    #   r.related_current_car.vehicle_type == "van" or
-    #   r.related_current_car.vehicle_type == "car")
-
-    results = affected_objects.sorted(key=lambda r: r.id)
-
-    return results
-
-  @api.constrains('name', 'report_model', 'recipient')
-  def _create_and_assign_template(self):
-    for record in self:
-      record.create_new_template()
-
-  def create_new_template(self):
-    if not self.email_template:
-      if self.name and self.recipient and self.id:
-        model_id = self.env['ir.model'].search(
-          [("name", "=", "sm_report_data.sm_report_data")])
-
-        data = {
-          'model_id': model_id.id,
-          'name': "mail_template_reports_" + str(self.id),
-          'email_from': "info@sommobilitat.coop",
-          'subject': "${object.email_subject}",
-          'partner_to': self.recipient.id,
-          'auto_delete': True,
-          'body_html': "${object.email_body}"
-        }
+    name = fields.Char(string=_("Name"), required=True)
+    report_model = fields.Many2one(
+        'ir.model', string=_("Report model"), required=True)
+    recipient = fields.Many2one(
+        'res.partner', string="Destinataris", required=True)
+    description = fields.Text()
+    last_execution = fields.Date(
+        string=_("Last execution"), default=time.strftime('%Y-%m-%d'))
+    next_execution = fields.Date(string=_("Next execution"))
+    final_date = fields.Date(string=_("Final date"))
+    specific_search = fields.Boolean(string=_("Specific range (Days)"))
+    general_range = fields.Selection([
+        ('day', 'Days'),
+        ('week', 'Weeks'),
+        ('month', 'Months'),
+        ('year', 'Years'),
+    ], string='Range', default='day')
+    daily_range = fields.Selection(
+        [(num, str(num)) for num in range(1, 32)],
+        string=_("Number"), default=1)
+    email_template = fields.Many2one(
+        'mail.template', string=_("Mail template"))
+    email_subject = fields.Char(string=_("Email subject"))
+    email_body = fields.Char(string=_("Email body"))
+    active = fields.Boolean(string=_("Active"))
+    report_helper = report_helper.get_instance()
+
+    @api.model
+    def send_email(self):
+        if self.env.context:
+            if 'active_ids' in self.env.context:
+                models = self.env['sm_report_data.sm_report_data'].browse(
+                    self.env.context['active_ids'])
+                if models.exists():
+                    for rec in models:
+                        rec.send_report_via_email()
+
+    def send_report_via_email(self):
+        try:
+            self.send_report_via_email_inside()
+        except:
+            print("ERROR SENDING")
+
+    def send_report_via_email_inside(self):
+        if not self.next_execution:
+            self.calculate_next_execute()
+
+        next_exe = datetime.strptime(str(self.next_execution), '%Y-%m-%d')
+
+        timezone = pytz.timezone('Europe/Madrid')
+        date_time = datetime.now(tz=timezone)
+        sys_date = datetime.date(date_time)
+
+        if sys_date == next_exe.date():
+            fp = BytesIO()
+            workbook = xlsxwriter.Workbook(fp)
+            worksheet = self.report_helper.generate_header(workbook)
+
+            objects_to_iterate = self.get_objects_to_iterates()
+
+            self.report_helper.fill_document(objects_to_iterate, worksheet)
+
+            workbook.close()
+            fp.seek(0)
+            datas = base64.b64encode(fp.read())
+
+            file_name = "Report-" + str(sys_date) + ".xlsx"
+
+            attachment = []
+
+            attachment_data = {
+                'name': file_name,
+                'datas_fname': file_name,
+                'datas': datas,
+                'res_model': "modelname",
+            }
+
+            id_new_attachment = self.env['ir.attachment'].create(
+                attachment_data).id
+            attachment.append(id_new_attachment)
+            mail_template_name = "mail_template_reports_" + str(self.id)
+            mail_template_name = mail_template_name.lower()
+            mail_model = self.env['mail.template'].search(
+                [("name", "=", mail_template_name)], limit=1)
+            # Delete previously created attachments
+            for attachment in mail_model.attachment_ids:
+                attachment.unlink()
+            mail_model.attachment_ids = [(4, id_new_attachment)]
+            email_values = {'send_from_code': True}
+            mail_model.with_context(email_values).send_mail(
+                self.id, raise_exception=False, force_send=True)
+            # self.env['ir.attachment'].search([('id', '=', id_new_attachment)]).unlink()
+            self.last_execution = sys_date
+            self.calculate_next_execute()
+
+    def calculate_next_execute(self):
+        range_execution = self.general_range
+        initial_date = self.last_execution
+        initial_date = datetime.strptime(str(initial_date), '%Y-%m-%d')
+        days = self.daily_range
+        if range_execution == "day":
+            final_date = initial_date + timedelta(days=days)
+        elif range_execution == "week":
+            final_date = initial_date + timedelta(weeks=days)
+        elif range_execution == "month":
+            final_date = initial_date + timedelta(days * 365 / 12)
+        elif range_execution == "year":
+            final_date = initial_date + timedelta(days * 365)
+        self.next_execution = final_date.strftime('%Y-%m-%d')
+
+    def get_objects_to_iterates(self):
+        initial_date = datetime.strptime(str(self.last_execution), '%Y-%m-%d')
+
+        model = self.report_model.model
+
+        days = self.daily_range
+        range_execution = self.general_range
+
+        if range_execution == "day":
+            final_date = initial_date + timedelta(days=days)
+        elif range_execution == "week":
+            final_date = initial_date + timedelta(weeks=days)
+        elif range_execution == "month":
+            final_date = initial_date + timedelta(days * 365 / 12)
+        elif range_execution == "year":
+            final_date = initial_date + timedelta(days * 365)
+
+        print('REPORT: filtering creating report!!!')
+        print(str(initial_date))
+        print(str(final_date))
+
+        affected_objects = self.env[model].search(
+            [
+                ('effectiveStartTime', '>=', str(initial_date)),
+                ('effectiveStartTime', '<', str(final_date)),
+            ], order="id")
+
+        print(str(affected_objects))
+
+        # filtered_list = affected_objects.filtered(lambda r:
+        #   r.related_current_car.vehicle_type == "van" or
+        #   r.related_current_car.vehicle_type == "car")
+
+        results = affected_objects.sorted(key=lambda r: r.id)
+
+        return results
+
+    @api.constrains('name', 'report_model', 'recipient')
+    def _create_and_assign_template(self):
+        for record in self:
+            record.create_new_template()
+
+    def create_new_template(self):
+        if not self.email_template:
+            if self.name and self.recipient and self.id:
+                model_id = self.env['ir.model'].search(
+                    [("name", "=", "sm_report_data.sm_report_data")])
+
+                data = {
+                    'model_id': model_id.id,
+                    'name': "mail_template_reports_" + str(self.id),
+                    'email_from': "info@sommobilitat.coop",
+                    'subject': "${object.email_subject}",
+                    'partner_to': self.recipient.id,
+                    'auto_delete': True,
+                    'body_html': "${object.email_body}"
+                }
 
-        new_template = self.env['mail.template'].create(data)
-        self.email_template = new_template.id
+                new_template = self.env['mail.template'].create(data)
+                self.email_template = new_template.id
```

## odoo/addons/sm_report_data/models/report_helper.py

```diff
@@ -1,334 +1,367 @@
 from datetime import datetime
 from odoo.addons.sm_maintenance.models.models_sm_utils import sm_utils
 
-class report_helper(object):
-  _name = 'report_helper'
-
-  __instance = None
 
-  @staticmethod
-  def get_instance():
-    if report_helper.__instance is None:
-      report_helper()
-    return report_helper.__instance
-
-  def __init__(self):
-    if report_helper.__instance is not None:
-      raise Exception("This class is a singleton!")
-    else:
-      report_helper.__instance = self
-
-  def get_without_false(self, field):
-    if not field:
-      return ""
-    return str(field)
-
-  def fill_document(self, objects_to_iterate, worksheet):
-
-    row = 1
-    col = 0
-
-    day_format = "%d/%m/%Y"
-    hour_format = "%H:%M"
-    for object in objects_to_iterate:
-      # DADES DE L’ESTABLIMENT
-      if object.member_id.cs_user_type == 'maintenance':
-        pagador = object.env.user.company_id.partner_id
-      else:
+class report_helper(object):
+    _name = 'report_helper'
 
-        if object.related_company_object:
-          pagador = object.related_company_object
-        else:
-          pagador = object.member_id
+    __instance = None
 
-      worksheet.write_string(row, col + 0, "SOM MOBILITAT SCCL")
-      worksheet.write_string(row, col + 1, "F66835125".upper())
-      worksheet.write_string(row, col + 2, "Carrer Tolón 26".upper())
-      worksheet.write_string(row, col + 3, "Mataró".upper())
-      worksheet.write_string(row, col + 4, "Barcelona".upper())
-
-      # DADES DEL PAGADOR
-
-      is_company = False
-      if pagador.company_type == 'company':
-        is_company = True
-
-      if not is_company:
-        worksheet.write_string(row, col + 5, self.get_without_false(pagador.firstname).upper())
-      else:
-        worksheet.write_string(row, col + 5, self.get_without_false(pagador.name).upper())
-
-      if not is_company:
-        worksheet.write_string(row, col + 6, self.get_without_false(pagador.lastname).upper())
-        worksheet.write_string(row, col + 7, "")  # SEGON COGNOM
-        #worksheet.write_string(row, col + 7,
-        #  self.get_without_false(pagador.second_surname).upper())  # SEGON COGNOM
-
-      else:
-        worksheet.write_string(row, col + 6, "")
-        worksheet.write_string(row, col + 7, "")  # SEGON COGNOM
-      if not is_company:
-        if pagador.birthdate_date:
-          birthdate = datetime.strptime(str(pagador.birthdate_date), "%Y-%m-%d")
-          worksheet.write_string(row, col + 8,
-            self.get_without_false(birthdate.strftime(day_format)).upper())
+    @staticmethod
+    def get_instance():
+        if report_helper.__instance is None:
+            report_helper()
+        return report_helper.__instance
+
+    def __init__(self):
+        if report_helper.__instance is not None:
+            raise Exception("This class is a singleton!")
         else:
-          worksheet.write_string(row, col + 8, "")
+            report_helper.__instance = self
 
-      else:
-        worksheet.write_string(row, col + 8, "")
-
-      if str(pagador.id_document_type).upper() == "DNI" or is_company:
-        worksheet.write_string(row, col + 9, "ESPANYA")  # NACIONALITAT
-      else:
-        worksheet.write_string(row, col + 9, "")  # NACIONALITAT
-
-      type_doc = ""
-      if is_company:
-        worksheet.write_string(row, col + 10, "CIF")  # TIPUS DOC
-        worksheet.write_string(row, col + 11, self.get_without_false(pagador.vat).upper())
-      else:
-        if pagador.id_document_type:
-          type_doc = pagador.id_document_type
-
-        worksheet.write_string(row, col + 10, type_doc.upper())  # TIPUS DOC
-        worksheet.write_string(row, col + 11, self.get_without_false(pagador.vat).upper())
-      if str(type_doc).upper() == "DNI" or is_company:
-        worksheet.write_string(row, col + 12, "ESPANYA")  # PAIS DOCUMENT
-      else:
-        worksheet.write_string(row, col + 12, "")  # PAIS DOCUMENT
-      street = pagador.street
-      zip = pagador.zip
-      city = pagador.computed_city
-      state = pagador.computed_state
-
-      address = ""
-      if street:
-        address += street
-      if zip:
-        address += ", " + zip
-      if city:
-        address += ", " + city
-      if state:
-        address += ", " + state
-      worksheet.write_string(row, col + 13, address.upper())
-      worksheet.write_string(row, col + 14, self.get_without_false(pagador.phone).upper())
-      worksheet.write_string(row, col + 15, self.get_without_false(pagador.email).upper())
-      if object.member_id.cs_user_type == 'maintenance':
-        worksheet.write_string(row, col + 16, "")
-      else:
-        worksheet.write_string(row, col + 16, "D")
-
-      worksheet.write_string(row, col + 17, "")  # TARGETA BANCARIA
-
-      # CONDUCTOR HABITUAL -------------------
-
-      if object.member_id.reporting_related_member_id:
-        conductor = object.member_id.reporting_related_member_id
-      else:
-        conductor = object.member_id
-
-      worksheet.write_string(row, col + 18, self.get_without_false(conductor.firstname).upper())
-      worksheet.write_string(row, col + 19, self.get_without_false(conductor.lastname).upper())
-      worksheet.write_string(row, col + 20, "")  # SEGON COGNOM
-      #worksheet.write_string(row, col + 20,
-      #  self.get_without_false(conductor.second_surname).upper())  # SEGON COGNOM
-
-      if conductor.birthdate_date:
-        birthdate_date = datetime.strptime(str(conductor.birthdate_date), "%Y-%m-%d")
-        worksheet.write_string(row, col + 21,
-          self.get_without_false(birthdate_date.strftime(day_format)).upper())
-      else:
-        worksheet.write_string(row, col + 21, self.get_without_false("").upper())
-      type_doc = ""
-      if conductor.id_document_type:
-        type_doc = conductor.id_document_type
-
-      if str(type_doc).upper() == "DNI":
-        worksheet.write_string(row, col + 22, "ESPANYA")  # NACIONALITAT
-      else:
-        worksheet.write_string(row, col + 22, "")  # NACIONALITAT
-
-      worksheet.write_string(row, col + 23, type_doc.upper())  # TIPUS DOC
-      worksheet.write_string(row, col + 24,
-        self.get_without_false(conductor.vat).upper())
-      worksheet.write_string(row, col + 25,
-        self.get_without_false(conductor.vat).upper())  # NUM PERMIS CONDUCCIO
-      if str(conductor.id_document_type).upper() == "DNI":
-        if conductor.vat:
-          worksheet.write_string(row, col + 26, "ESPANYA")
-        else:
-          worksheet.write_string(row, col + 26, "")
-      # PAIS PERMIS CONDUCCIO
-      else:
-        worksheet.write_string(row, col + 26, "")
-
-      street = conductor.street
-      zip = conductor.zip
-      city = conductor.computed_city
-      state = conductor.computed_state
-
-      address = ""
-      if street:
-        address += street
-      if zip:
-        address += ", " + zip
-      if city:
-        address += ", " + city
-      if state:
-        address += ", " + state
-
-      worksheet.write_string(row, col + 27, address.upper())
-      worksheet.write_string(row, col + 28, "")  # DOMICILI ACCIDENTAL
-      worksheet.write_string(row, col + 29, self.get_without_false(conductor.phone).upper())
-      worksheet.write_string(row, col + 30, self.get_without_false(conductor.email).upper())
-      # SEGON CONDUCOTR-----------------------------------------------------------------------
-
-      worksheet.write_string(row, col + 31, "")
-      worksheet.write_string(row, col + 32, "")
-      worksheet.write_string(row, col + 33, "")
-      worksheet.write_string(row, col + 34, "")
-      worksheet.write_string(row, col + 35, "")
-      worksheet.write_string(row, col + 36, "")
-      worksheet.write_string(row, col + 37, "")
-      worksheet.write_string(row, col + 38, "")
-      worksheet.write_string(row, col + 39, "")
-      worksheet.write_string(row, col + 40, "")
-      worksheet.write_string(row, col + 41, "")
-      worksheet.write_string(row, col + 42, "")
-      worksheet.write_string(row, col + 43, "")
-
-      # DADS OPERACIO-------------------------------------------------------------------
-      worksheet.write_string(row, col + 44, str(object.id))  # NUMERO ORDRE
-      worksheet.write_string(row, col + 45, "")  # LLIURAMENT RETORN
-      worksheet.write_string(row, col + 46,
-        self.get_without_false(object.name).upper())  # REFERENCIA DEL CONTRACTE
-
-      startTime = sm_utils.utc_to_local_datetime(str(object.startTime))
-
-      effectiveStartTime = sm_utils.utc_to_local_datetime(str(object.effectiveStartTime))
-
-      worksheet.write_string(row, col + 47, self.get_without_false(startTime.strftime(day_format)).upper())
-      worksheet.write_string(row, col + 48,
-                   self.get_without_false(effectiveStartTime.strftime(hour_format)).upper())  # DAY
-
-      endTime = sm_utils.utc_to_local_datetime(str(object.endTime))
-
-      effectiveEndTime = sm_utils.utc_to_local_datetime(str(object.effectiveEndTime))
-
-      worksheet.write_string(row,
-        col + 49, self.get_without_false(endTime.strftime(day_format)).upper())  # DAY
-      worksheet.write_string(row,
-        col + 50, self.get_without_false(effectiveEndTime.strftime(day_format)).upper())  # DAY
-      worksheet.write_string(row,
-        col + 51, self.get_without_false(effectiveEndTime.strftime(hour_format)).upper())  # HORA
-
-      # TODO: change db car into fleet vehicle!
-      car = object.related_current_car
-      if car:
-        worksheet.write_string(row, col + 52, self.get_without_false(car.vehicle_type).upper())
-        worksheet.write_string(row, col + 53, self.get_without_false(car.model_id.brand_id.name).upper())
-        worksheet.write_string(row, col + 54, self.get_without_false(car.model_id.name).upper())
-        worksheet.write_string(row, col + 55, self.get_without_false(car.license_plate).upper())
-        worksheet.write_string(row, col + 56, self.get_without_false(car.vin_sn).upper())
-        worksheet.write_string(row, col + 57, "")  # QUILOMETRTEGATGE
-        worksheet.write_string(row, col + 58, self.get_without_false(car.color).upper())
-      else:
-        worksheet.write_string(row, col + 52, "")
-        worksheet.write_string(row, col + 53, "")
-        worksheet.write_string(row, col + 54, "")
-        worksheet.write_string(row, col + 55, "")
-        worksheet.write_string(row, col + 56, "")
-        worksheet.write_string(row, col + 57, "")  # QUILOMETRTEGATGE
-        worksheet.write_string(row, col + 58, "")
-
-      if car.has_gps:
-        worksheet.write_string(row, col + 59, "S")
-      else:
-        worksheet.write_string(row, col + 59, "N")
-
-      row += 1
-
-  def generate_header(self, workbook):
-    worksheet = workbook.add_worksheet()
-    bold = workbook.add_format({'bold': 1})
-    worksheet.write('A1', 'RAÓ SOCIAL', bold)
-    worksheet.write('B1', 'CIF/NIF/NIE', bold)
-    worksheet.write('C1', "ADREÇA DE L'ESTABLIMENT (tipus de via, nom de la via, núm., pis, porta", bold)
-    worksheet.write('D1', 'MUNICIPI', bold)
-    worksheet.write('E1', 'PROVÍNCIA', bold)
-
-    # PAGADOR
-    worksheet.write('F1', 'NOM  (PAGADOR)', bold)
-    worksheet.write('G1', 'PRIMER COGNOM', bold)
-    worksheet.write('H1', 'SEGON COGNOM (si en té)', bold)
-    worksheet.write('I1', 'DATA DE NAIXEMENT (dd/mm/aaaa)', bold)
-    worksheet.write('J1', 'NACIONALITAT', bold)
-    worksheet.write('K1', 'TIPUS DE DOCUMENT', bold)
-    worksheet.write('L1', 'NÚMERO DEL DOCUMENT', bold)
-    worksheet.write('M1', 'PAÍS DEL DOCUMENT', bold)
-    worksheet.write('N1',
-            'DOMICILI HABITUAL (tipus de via, nom de la via, núm., pis, porta, municipi, codi postal, província, país)',
+    def get_without_false(self, field):
+        if not field:
+            return ""
+        return str(field)
+
+    def fill_document(self, objects_to_iterate, worksheet):
+
+        row = 1
+        col = 0
+
+        day_format = "%d/%m/%Y"
+        hour_format = "%H:%M"
+        for object in objects_to_iterate:
+            # DADES DE L’ESTABLIMENT
+            if object.member_id.cs_user_type == 'maintenance':
+                pagador = object.env.user.company_id.partner_id
+            else:
+
+                if object.related_company_object:
+                    pagador = object.related_company_object
+                else:
+                    pagador = object.member_id
+
+            worksheet.write_string(row, col + 0, "SOM MOBILITAT SCCL")
+            worksheet.write_string(row, col + 1, "F66835125".upper())
+            worksheet.write_string(row, col + 2, "Carrer Tolón 26".upper())
+            worksheet.write_string(row, col + 3, "Mataró".upper())
+            worksheet.write_string(row, col + 4, "Barcelona".upper())
+
+            # DADES DEL PAGADOR
+
+            is_company = False
+            if pagador.company_type == 'company':
+                is_company = True
+
+            if not is_company:
+                worksheet.write_string(
+                    row, col + 5, self.get_without_false(pagador.firstname).upper())
+            else:
+                worksheet.write_string(
+                    row, col + 5, self.get_without_false(pagador.name).upper())
+
+            if not is_company:
+                worksheet.write_string(
+                    row, col + 6, self.get_without_false(pagador.lastname).upper())
+                worksheet.write_string(row, col + 7, "")  # SEGON COGNOM
+                # worksheet.write_string(row, col + 7,
+                #  self.get_without_false(pagador.second_surname).upper())  # SEGON COGNOM
+
+            else:
+                worksheet.write_string(row, col + 6, "")
+                worksheet.write_string(row, col + 7, "")  # SEGON COGNOM
+            if not is_company:
+                if pagador.birthdate_date:
+                    birthdate = datetime.strptime(
+                        str(pagador.birthdate_date), "%Y-%m-%d")
+                    worksheet.write_string(row, col + 8,
+                                           self.get_without_false(birthdate.strftime(day_format)).upper())
+                else:
+                    worksheet.write_string(row, col + 8, "")
+
+            else:
+                worksheet.write_string(row, col + 8, "")
+
+            if str(pagador.id_document_type).upper() == "DNI" or is_company:
+                worksheet.write_string(row, col + 9, "ESPANYA")  # NACIONALITAT
+            else:
+                worksheet.write_string(row, col + 9, "")  # NACIONALITAT
+
+            type_doc = ""
+            if is_company:
+                worksheet.write_string(row, col + 10, "CIF")  # TIPUS DOC
+                worksheet.write_string(
+                    row, col + 11, self.get_without_false(pagador.vat).upper())
+            else:
+                if pagador.id_document_type:
+                    type_doc = pagador.id_document_type
+
+                worksheet.write_string(
+                    row, col + 10, type_doc.upper())  # TIPUS DOC
+                worksheet.write_string(
+                    row, col + 11, self.get_without_false(pagador.vat).upper())
+            if str(type_doc).upper() == "DNI" or is_company:
+                worksheet.write_string(
+                    row, col + 12, "ESPANYA")  # PAIS DOCUMENT
+            else:
+                worksheet.write_string(row, col + 12, "")  # PAIS DOCUMENT
+            street = pagador.street
+            zip = pagador.zip
+            city = pagador.computed_city
+            state = pagador.computed_state
+
+            address = ""
+            if street:
+                address += street
+            if zip:
+                address += ", " + zip
+            if city:
+                address += ", " + city
+            if state:
+                address += ", " + state
+            worksheet.write_string(row, col + 13, address.upper())
+            worksheet.write_string(
+                row, col + 14, self.get_without_false(pagador.phone).upper())
+            worksheet.write_string(
+                row, col + 15, self.get_without_false(pagador.email).upper())
+            if object.member_id.cs_user_type == 'maintenance':
+                worksheet.write_string(row, col + 16, "")
+            else:
+                worksheet.write_string(row, col + 16, "D")
+
+            worksheet.write_string(row, col + 17, "")  # TARGETA BANCARIA
+
+            # CONDUCTOR HABITUAL -------------------
+
+            if object.member_id.reporting_related_member_id:
+                conductor = object.member_id.reporting_related_member_id
+            else:
+                conductor = object.member_id
+
+            worksheet.write_string(
+                row, col + 18, self.get_without_false(conductor.firstname).upper())
+            worksheet.write_string(
+                row, col + 19, self.get_without_false(conductor.lastname).upper())
+            worksheet.write_string(row, col + 20, "")  # SEGON COGNOM
+            # worksheet.write_string(row, col + 20,
+            #  self.get_without_false(conductor.second_surname).upper())  # SEGON COGNOM
+
+            if conductor.birthdate_date:
+                birthdate_date = datetime.strptime(
+                    str(conductor.birthdate_date), "%Y-%m-%d")
+                worksheet.write_string(row, col + 21,
+                                       self.get_without_false(birthdate_date.strftime(day_format)).upper())
+            else:
+                worksheet.write_string(
+                    row, col + 21, self.get_without_false("").upper())
+            type_doc = ""
+            if conductor.id_document_type:
+                type_doc = conductor.id_document_type
+
+            if str(type_doc).upper() == "DNI":
+                worksheet.write_string(
+                    row, col + 22, "ESPANYA")  # NACIONALITAT
+            else:
+                worksheet.write_string(row, col + 22, "")  # NACIONALITAT
+
+            worksheet.write_string(
+                row, col + 23, type_doc.upper())  # TIPUS DOC
+            worksheet.write_string(row, col + 24,
+                                   self.get_without_false(conductor.vat).upper())
+            worksheet.write_string(row, col + 25,
+                                   self.get_without_false(conductor.vat).upper())  # NUM PERMIS CONDUCCIO
+            if str(conductor.id_document_type).upper() == "DNI":
+                if conductor.vat:
+                    worksheet.write_string(row, col + 26, "ESPANYA")
+                else:
+                    worksheet.write_string(row, col + 26, "")
+            # PAIS PERMIS CONDUCCIO
+            else:
+                worksheet.write_string(row, col + 26, "")
+
+            street = conductor.street
+            zip = conductor.zip
+            city = conductor.computed_city
+            state = conductor.computed_state
+
+            address = ""
+            if street:
+                address += street
+            if zip:
+                address += ", " + zip
+            if city:
+                address += ", " + city
+            if state:
+                address += ", " + state
+
+            worksheet.write_string(row, col + 27, address.upper())
+            worksheet.write_string(row, col + 28, "")  # DOMICILI ACCIDENTAL
+            worksheet.write_string(
+                row, col + 29, self.get_without_false(conductor.phone).upper())
+            worksheet.write_string(
+                row, col + 30, self.get_without_false(conductor.email).upper())
+            # SEGON CONDUCOTR-----------------------------------------------------------------------
+
+            worksheet.write_string(row, col + 31, "")
+            worksheet.write_string(row, col + 32, "")
+            worksheet.write_string(row, col + 33, "")
+            worksheet.write_string(row, col + 34, "")
+            worksheet.write_string(row, col + 35, "")
+            worksheet.write_string(row, col + 36, "")
+            worksheet.write_string(row, col + 37, "")
+            worksheet.write_string(row, col + 38, "")
+            worksheet.write_string(row, col + 39, "")
+            worksheet.write_string(row, col + 40, "")
+            worksheet.write_string(row, col + 41, "")
+            worksheet.write_string(row, col + 42, "")
+            worksheet.write_string(row, col + 43, "")
+
+            # DADS OPERACIO-------------------------------------------------------------------
+            worksheet.write_string(
+                row, col + 44, str(object.id))  # NUMERO ORDRE
+            worksheet.write_string(row, col + 45, "")  # LLIURAMENT RETORN
+            worksheet.write_string(row, col + 46,
+                                   self.get_without_false(object.name).upper())  # REFERENCIA DEL CONTRACTE
+
+            startTime = sm_utils.utc_to_local_datetime(str(object.startTime))
+
+            effectiveStartTime = sm_utils.utc_to_local_datetime(
+                str(object.effectiveStartTime))
+
+            worksheet.write_string(
+                row, col + 47, self.get_without_false(startTime.strftime(day_format)).upper())
+            worksheet.write_string(row, col + 48,
+                                   self.get_without_false(effectiveStartTime.strftime(hour_format)).upper())  # DAY
+
+            endTime = sm_utils.utc_to_local_datetime(str(object.endTime))
+
+            effectiveEndTime = sm_utils.utc_to_local_datetime(
+                str(object.effectiveEndTime))
+
+            worksheet.write_string(row,
+                                   col + 49, self.get_without_false(endTime.strftime(day_format)).upper())  # DAY
+            worksheet.write_string(row,
+                                   col + 50, self.get_without_false(effectiveEndTime.strftime(day_format)).upper())  # DAY
+            worksheet.write_string(row,
+                                   col + 51, self.get_without_false(effectiveEndTime.strftime(hour_format)).upper())  # HORA
+
+            # TODO: change db car into fleet vehicle!
+            car = object.related_current_car
+            if car:
+                worksheet.write_string(
+                    row, col + 52, self.get_without_false(car.vehicle_type).upper())
+                worksheet.write_string(
+                    row, col + 53, self.get_without_false(car.model_id.brand_id.name).upper())
+                worksheet.write_string(
+                    row, col + 54, self.get_without_false(car.model_id.name).upper())
+                worksheet.write_string(
+                    row, col + 55, self.get_without_false(car.license_plate).upper())
+                worksheet.write_string(
+                    row, col + 56, self.get_without_false(car.vin_sn).upper())
+                worksheet.write_string(row, col + 57, "")  # QUILOMETRTEGATGE
+                worksheet.write_string(
+                    row, col + 58, self.get_without_false(car.color).upper())
+            else:
+                worksheet.write_string(row, col + 52, "")
+                worksheet.write_string(row, col + 53, "")
+                worksheet.write_string(row, col + 54, "")
+                worksheet.write_string(row, col + 55, "")
+                worksheet.write_string(row, col + 56, "")
+                worksheet.write_string(row, col + 57, "")  # QUILOMETRTEGATGE
+                worksheet.write_string(row, col + 58, "")
+
+            if car.has_gps:
+                worksheet.write_string(row, col + 59, "S")
+            else:
+                worksheet.write_string(row, col + 59, "N")
+
+            row += 1
+
+    def generate_header(self, workbook):
+        worksheet = workbook.add_worksheet()
+        bold = workbook.add_format({'bold': 1})
+        worksheet.write('A1', 'RAÓ SOCIAL', bold)
+        worksheet.write('B1', 'CIF/NIF/NIE', bold)
+        worksheet.write(
+            'C1', "ADREÇA DE L'ESTABLIMENT (tipus de via, nom de la via, núm., pis, porta", bold)
+        worksheet.write('D1', 'MUNICIPI', bold)
+        worksheet.write('E1', 'PROVÍNCIA', bold)
+
+        # PAGADOR
+        worksheet.write('F1', 'NOM  (PAGADOR)', bold)
+        worksheet.write('G1', 'PRIMER COGNOM', bold)
+        worksheet.write('H1', 'SEGON COGNOM (si en té)', bold)
+        worksheet.write('I1', 'DATA DE NAIXEMENT (dd/mm/aaaa)', bold)
+        worksheet.write('J1', 'NACIONALITAT', bold)
+        worksheet.write('K1', 'TIPUS DE DOCUMENT', bold)
+        worksheet.write('L1', 'NÚMERO DEL DOCUMENT', bold)
+        worksheet.write('M1', 'PAÍS DEL DOCUMENT', bold)
+        worksheet.write('N1',
+                        'DOMICILI HABITUAL (tipus de via, nom de la via, núm., pis, porta, municipi, codi postal, província, país)',
+                        bold)
+        worksheet.write('O1', 'TELÈFON DE CONTACTE', bold)
+        worksheet.write('P1', 'CORREU ELECTRÒNIC', bold)
+        worksheet.write(
+            'Q1', 'FORMA DE PAGAMENT (M: metàl·lic; D: domiciliació bancària; T: targeta de crèdit)', bold)
+        worksheet.write(
+            'R1', 'NÚMERO DE LA TARGETA BANCÀRIA (quan sigui el cas)', bold)
+
+        # PRIMER CONDUCTOR
+        worksheet.write('S1', 'NOM (CONDUCTOR HABITUAL)', bold)
+        worksheet.write('T1', 'PRIMER COGNOM', bold)
+        worksheet.write('U1', 'SEGON COGNOM (si en té)', bold)
+        worksheet.write('V1', 'DATA DE NAIXEMENT (dd/mm/aaaa)', bold)
+        worksheet.write('W1', 'NACIONALITAT', bold)
+        worksheet.write('X1', 'TIPUS DE DOCUMENT', bold)
+        worksheet.write('Y1', 'NÚMERO DEL DOCUMENT', bold)
+        worksheet.write('Z1', 'NÚMERO DEL PERMÍS DE CONDUCCIÓ', bold)
+        worksheet.write('AA1', 'PAÍS DEL PERMÍS DE CONDUCCIÓ', bold)
+        worksheet.write('AB1',
+                        'DOMICILI HABITUAL (tipus de via, nom de la via, núm., pis, porta, municipi, codi postal, província, país)',
+                        bold)
+        worksheet.write(
+            'AC1',
+            'DOMICILI ACCIDENTAL (tipus de via, nom de la via, núm., pis, porta, municipi, codi postal, província, país)',
             bold)
-    worksheet.write('O1', 'TELÈFON DE CONTACTE', bold)
-    worksheet.write('P1', 'CORREU ELECTRÒNIC', bold)
-    worksheet.write('Q1', 'FORMA DE PAGAMENT (M: metàl·lic; D: domiciliació bancària; T: targeta de crèdit)', bold)
-    worksheet.write('R1', 'NÚMERO DE LA TARGETA BANCÀRIA (quan sigui el cas)', bold)
-
-    # PRIMER CONDUCTOR
-    worksheet.write('S1', 'NOM (CONDUCTOR HABITUAL)', bold)
-    worksheet.write('T1', 'PRIMER COGNOM', bold)
-    worksheet.write('U1', 'SEGON COGNOM (si en té)', bold)
-    worksheet.write('V1', 'DATA DE NAIXEMENT (dd/mm/aaaa)', bold)
-    worksheet.write('W1', 'NACIONALITAT', bold)
-    worksheet.write('X1', 'TIPUS DE DOCUMENT', bold)
-    worksheet.write('Y1', 'NÚMERO DEL DOCUMENT', bold)
-    worksheet.write('Z1', 'NÚMERO DEL PERMÍS DE CONDUCCIÓ', bold)
-    worksheet.write('AA1', 'PAÍS DEL PERMÍS DE CONDUCCIÓ', bold)
-    worksheet.write('AB1',
-      'DOMICILI HABITUAL (tipus de via, nom de la via, núm., pis, porta, municipi, codi postal, província, país)',
-      bold)
-    worksheet.write(
-      'AC1',
-      'DOMICILI ACCIDENTAL (tipus de via, nom de la via, núm., pis, porta, municipi, codi postal, província, país)',
-      bold)
-    worksheet.write('AD1', 'TELÈFON DE CONTACTE', bold)
-    worksheet.write('AE1', 'CORREU ELECTRÒNIC', bold)
-
-    # SEGON CONDUCTOR
-    worksheet.write('AF1', 'NOM (SEGON CONDUCTOR)', bold)
-    worksheet.write('AG1', 'PRIMER COGNOM', bold)
-    worksheet.write('AH1', 'SEGON COGNOM (si en té)', bold)
-    worksheet.write('AI1', 'DATA DE NAIXEMENT (dd/mm/aaaa)', bold)
-    worksheet.write('AJ1', 'NACIONALITAT', bold)
-    worksheet.write('AK1', 'TIPUS DE DOCUMENT', bold)
-    worksheet.write('AL1', 'NÚMERO DEL DOCUMENT', bold)
-    worksheet.write('AM1', 'NÚMERO DEL PERMÍS DE CONDUCCIÓ', bold)
-    worksheet.write('AN1', 'PAÍS DEL PERMÍS DE CONDUCCIÓ', bold)
-    worksheet.write('AO1',
-      'DOMICILI HABITUAL (tipus de via, nom de la via, núm., pis, porta, municipi, codi postal, província, país)',
-      bold)
-    worksheet.write('AP1',
-      'DOMICILI ACCIDENTAL (tipus de via, nom de la via, núm., pis, porta, municipi, codi postal, província, país)',
-      bold)
-    worksheet.write('AQ1', 'TELÈFON DE CONTACTE', bold)
-    worksheet.write('AR1', 'CORREU ELECTRÒNIC', bold)
-
-    worksheet.write('AS1', "NÚMERO D'ORDRE DEL REGISTRE", bold)
-    worksheet.write('AT1', 'TIPUS D’OPERACIÓ (L: lliurament; R: retorn)', bold)
-    worksheet.write('AU1', 'REFERÈNCIA DEL CONTRACTE', bold)
-    worksheet.write('AV1', 'DATA DE LLOGUER (dd/m/aaaa)', bold)
-    worksheet.write('AW1', 'HORA DE LLIURAMENT DEL VEHICLE (hh:mm)', bold)
-    worksheet.write('AX1', 'DATA PREVISTA DE RETORN (dd/mm/aaaa)', bold)
-    worksheet.write('AY1', 'DATA DE RETORN (dd/mm/aaaa)', bold)
-    worksheet.write('AZ1', 'HORA DE RETORN DEL VEHICLE (hh:mm)', bold)
-    worksheet.write('BA1', 'TIPUS DE VEHICLE', bold)
-    worksheet.write('BB1', 'MARCA DEL VEHICLE', bold)
-    worksheet.write('BC1', 'MODEL DEL VEHICLE', bold)
-    worksheet.write('BD1', 'MATRÍCULA DEL VEHICLE', bold)
-    worksheet.write('BE1', 'NÚMERO DE BASTIDOR', bold)
-    worksheet.write('BF1', 'QUILOMETRATGE', bold)
-    worksheet.write('BG1', 'COLOR DEL VEHICLE', bold)
-    worksheet.write('BH1', 'GPS INTEGRAT AL VEHICLE (S: si; N: no)', bold)
+        worksheet.write('AD1', 'TELÈFON DE CONTACTE', bold)
+        worksheet.write('AE1', 'CORREU ELECTRÒNIC', bold)
+
+        # SEGON CONDUCTOR
+        worksheet.write('AF1', 'NOM (SEGON CONDUCTOR)', bold)
+        worksheet.write('AG1', 'PRIMER COGNOM', bold)
+        worksheet.write('AH1', 'SEGON COGNOM (si en té)', bold)
+        worksheet.write('AI1', 'DATA DE NAIXEMENT (dd/mm/aaaa)', bold)
+        worksheet.write('AJ1', 'NACIONALITAT', bold)
+        worksheet.write('AK1', 'TIPUS DE DOCUMENT', bold)
+        worksheet.write('AL1', 'NÚMERO DEL DOCUMENT', bold)
+        worksheet.write('AM1', 'NÚMERO DEL PERMÍS DE CONDUCCIÓ', bold)
+        worksheet.write('AN1', 'PAÍS DEL PERMÍS DE CONDUCCIÓ', bold)
+        worksheet.write('AO1',
+                        'DOMICILI HABITUAL (tipus de via, nom de la via, núm., pis, porta, municipi, codi postal, província, país)',
+                        bold)
+        worksheet.write('AP1',
+                        'DOMICILI ACCIDENTAL (tipus de via, nom de la via, núm., pis, porta, municipi, codi postal, província, país)',
+                        bold)
+        worksheet.write('AQ1', 'TELÈFON DE CONTACTE', bold)
+        worksheet.write('AR1', 'CORREU ELECTRÒNIC', bold)
+
+        worksheet.write('AS1', "NÚMERO D'ORDRE DEL REGISTRE", bold)
+        worksheet.write(
+            'AT1', 'TIPUS D’OPERACIÓ (L: lliurament; R: retorn)', bold)
+        worksheet.write('AU1', 'REFERÈNCIA DEL CONTRACTE', bold)
+        worksheet.write('AV1', 'DATA DE LLOGUER (dd/m/aaaa)', bold)
+        worksheet.write('AW1', 'HORA DE LLIURAMENT DEL VEHICLE (hh:mm)', bold)
+        worksheet.write('AX1', 'DATA PREVISTA DE RETORN (dd/mm/aaaa)', bold)
+        worksheet.write('AY1', 'DATA DE RETORN (dd/mm/aaaa)', bold)
+        worksheet.write('AZ1', 'HORA DE RETORN DEL VEHICLE (hh:mm)', bold)
+        worksheet.write('BA1', 'TIPUS DE VEHICLE', bold)
+        worksheet.write('BB1', 'MARCA DEL VEHICLE', bold)
+        worksheet.write('BC1', 'MODEL DEL VEHICLE', bold)
+        worksheet.write('BD1', 'MATRÍCULA DEL VEHICLE', bold)
+        worksheet.write('BE1', 'NÚMERO DE BASTIDOR', bold)
+        worksheet.write('BF1', 'QUILOMETRATGE', bold)
+        worksheet.write('BG1', 'COLOR DEL VEHICLE', bold)
+        worksheet.write('BH1', 'GPS INTEGRAT AL VEHICLE (S: si; N: no)', bold)
 
-    return worksheet
+        return worksheet
```

## Comparing `odoo12_addon_sm_report_data-12.0.0.0.6.dist-info/METADATA` & `odoo12_addon_sm_report_data-12.0.0.0.6.99.dev1.dist-info/METADATA`

 * *Files 26% similar despite different names*

```diff
@@ -1,20 +1,20 @@
 Metadata-Version: 2.1
 Name: odoo12-addon-sm-report-data
-Version: 12.0.0.0.6
+Version: 12.0.0.0.6.99.dev1
 Summary: Module to generate reports xlsx and be able to send it via mail.
 Home-page: http://www.sommobilitat.coop
 Author: Som Mobilitat
 License: UNKNOWN
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
 Classifier: Framework :: Odoo
 Classifier: Framework :: Odoo :: 12.0
 Requires-Python: >=3.5
 Requires-Dist: odoo12-addon-report-xlsx
 Requires-Dist: odoo12-addon-vertical-carsharing
-Requires-Dist: odoo (<12.1dev,>=12.0a)
+Requires-Dist: odoo <12.1dev,>=12.0a
 
 
-  The module allows establishing a periodicity to generate and send a report automatically.
-  
+The module allows establishing a periodicity to generate and send a report automatically.
+
```

## Comparing `odoo12_addon_sm_report_data-12.0.0.0.6.dist-info/RECORD` & `odoo12_addon_sm_report_data-12.0.0.0.6.99.dev1.dist-info/RECORD`

 * *Files 8% similar despite different names*

```diff
@@ -1,16 +1,16 @@
 odoo/addons/sm_report_data/__init__.py,sha256=JgvapLUmwcvZBKWFjSAe4Z7cme_F5oqLR-Vsh5bh428,68
-odoo/addons/sm_report_data/__manifest__.py,sha256=T5-QFrIYiPsVEP5tDc-hAP1Tca-yM7mAzGsuBL4HD60,910
+odoo/addons/sm_report_data/__manifest__.py,sha256=Up1qQT0MR1x63bMKE53fdnxqBP6uGrKSD5BwsRnbVxs,781
 odoo/addons/sm_report_data/models/__init__.py,sha256=ZK65Cv45RfTIMFb44XiU3l6dvmTahHWlpnso-otV1Ak,99
-odoo/addons/sm_report_data/models/model_reports_cron.py,sha256=SBHIrCC41XCXs6pqVb7IvquSbIZxi07hKH6oDGWk4Js,372
-odoo/addons/sm_report_data/models/models_report_configuration.py,sha256=ME9Mkf9Nwa9gEp6dlJmVrAgdpF9KdtOZZLRxtIFYz7Y,6379
-odoo/addons/sm_report_data/models/report_helper.py,sha256=0o45wDhVd-JMKXD8rqzXnq1ArEQNiii1UiKgyMrr9Wg,14444
+odoo/addons/sm_report_data/models/model_reports_cron.py,sha256=X8Gke3HCOILT-36fnyPqJFHsVn0F61GhoU_eXVkBlf8,405
+odoo/addons/sm_report_data/models/models_report_configuration.py,sha256=29Og_3isWMqmvLhJrA0sjW4sAsjJ8B8f0S2c1jccVKs,7161
+odoo/addons/sm_report_data/models/report_helper.py,sha256=9iyJLr_CeY9BjhEZW6THRrLnqbS-c9UuqjbZtNeoQiI,16987
 odoo/addons/sm_report_data/reports/__init__.py,sha256=C9DaLQyP6LWYSA4pmI616XPwQnuIMaC1uyFNrJ95If8,28
 odoo/addons/sm_report_data/reports/mossos_report.py,sha256=pg-4yLye34BMIIguEhtjXFPcYZCANBGMaxPEE-_FQ7Q,1740
 odoo/addons/sm_report_data/security/ir.model.access.csv,sha256=keyqqN1yYgmLHcBwfy2TY1_CyW_1PZwBqU5ycNUxlP8,188
 odoo/addons/sm_report_data/views/templates.xml,sha256=r2w5WhgPRLATLe_zxCs8qEeqM3nNJbJp__3hXKXm5TI,872
 odoo/addons/sm_report_data/views/views.xml,sha256=cDFc-YbktP3zuDSeL10qyBXrkCP55rZVyKCvi4aTbb4,168
 odoo/addons/sm_report_data/views/views_report_configuration.xml,sha256=IEdfIP0J9B-yfMeZdL3dNmFVVJvLgjDJHaUymwWfo5A,2822
-odoo12_addon_sm_report_data-12.0.0.0.6.dist-info/METADATA,sha256=goD3lpLoPP_6Jj9kQpLgGQSccbrHOUkt8x3uQ1HWI18,606
-odoo12_addon_sm_report_data-12.0.0.0.6.dist-info/WHEEL,sha256=z9j0xAa_JmUKMpmz72K0ZGALSM_n-wQVmGbleXx2VHg,110
-odoo12_addon_sm_report_data-12.0.0.0.6.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo12_addon_sm_report_data-12.0.0.0.6.dist-info/RECORD,,
+odoo12_addon_sm_report_data-12.0.0.0.6.99.dev1.dist-info/METADATA,sha256=4R0sUweyd4dpxwKAjar5T9hcPARuuf7pB92sUjbsAMc,608
+odoo12_addon_sm_report_data-12.0.0.0.6.99.dev1.dist-info/WHEEL,sha256=-G_t0oGuE7UD0DrSpVZnq1hHMBV9DD2XkS5v7XpmTnk,110
+odoo12_addon_sm_report_data-12.0.0.0.6.99.dev1.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo12_addon_sm_report_data-12.0.0.0.6.99.dev1.dist-info/RECORD,,
```

