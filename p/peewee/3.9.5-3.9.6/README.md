# Comparing `tmp/peewee-3.9.5.tar.gz` & `tmp/peewee-3.9.6.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dist/peewee-3.9.5.tar", last modified: Fri Apr 26 19:29:15 2019, max compression
+gzip compressed data, was "dist/peewee-3.9.6.tar", last modified: Thu Jun  6 16:27:06 2019, max compression
```

## Comparing `peewee-3.9.5.tar` & `peewee-3.9.6.tar`

### file list

```diff
@@ -1,257 +1,156 @@
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/
--rw-rw-r--   0 charles   (1000) charles   (1000)   245200 2019-04-26 19:28:41.000000 peewee-3.9.5/peewee.py
--rw-rw-r--   0 charles   (1000) charles   (1000)      333 2018-08-16 18:40:47.000000 peewee-3.9.5/MANIFEST.in
--rw-rw-r--   0 charles   (1000) charles   (1000)       38 2019-04-26 19:29:15.000000 peewee-3.9.5/setup.cfg
--rw-rw-r--   0 charles   (1000) charles   (1000)     5954 2019-03-06 04:33:01.000000 peewee-3.9.5/README.rst
--rw-rw-r--   0 charles   (1000) charles   (1000)     7918 2019-04-26 19:29:15.000000 peewee-3.9.5/PKG-INFO
--rw-rw-r--   0 charles   (1000) charles   (1000)     1058 2018-08-16 18:40:47.000000 peewee-3.9.5/LICENSE
--rw-rw-r--   0 charles   (1000) charles   (1000)    97537 2019-04-26 19:28:31.000000 peewee-3.9.5/CHANGELOG.md
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/peewee.egg-info/
--rw-rw-r--   0 charles   (1000) charles   (1000)        1 2019-01-07 16:32:32.000000 peewee-3.9.5/peewee.egg-info/not-zip-safe
--rw-rw-r--   0 charles   (1000) charles   (1000)        1 2019-04-26 19:29:15.000000 peewee-3.9.5/peewee.egg-info/dependency_links.txt
--rw-rw-r--   0 charles   (1000) charles   (1000)     7918 2019-04-26 19:29:15.000000 peewee-3.9.5/peewee.egg-info/PKG-INFO
--rw-rw-r--   0 charles   (1000) charles   (1000)     7644 2019-04-26 19:29:15.000000 peewee-3.9.5/peewee.egg-info/SOURCES.txt
--rw-rw-r--   0 charles   (1000) charles   (1000)       22 2019-04-26 19:29:15.000000 peewee-3.9.5/peewee.egg-info/top_level.txt
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/docs/
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/docs/_static/
--rw-rw-r--   0 charles   (1000) charles   (1000)    16537 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/_static/peewee-white.png
--rw-rw-r--   0 charles   (1000) charles   (1000)     4590 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/Makefile
--rw-rw-r--   0 charles   (1000) charles   (1000)     4106 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/make.bat
--rw-rw-r--   0 charles   (1000) charles   (1000)     1655 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/peewee3-logo.png
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/docs/_themes/
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/docs/_themes/flask/
--rw-rw-r--   0 charles   (1000) charles   (1000)      164 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/_themes/flask/theme.conf
--rw-rw-r--   0 charles   (1000) charles   (1000)      590 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/_themes/flask/relations.html
--rw-rw-r--   0 charles   (1000) charles   (1000)      750 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/_themes/flask/layout.html
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/docs/_themes/flask/static/
--rw-rw-r--   0 charles   (1000) charles   (1000)     6436 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/_themes/flask/static/flasky.css_t
--rw-rw-r--   0 charles   (1000) charles   (1000)      976 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/_themes/flask/static/small_flask.css
--rw-rw-r--   0 charles   (1000) charles   (1000)     1345 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/mysql.png
--rw-rw-r--   0 charles   (1000) charles   (1000)     1900 2019-03-06 04:33:00.000000 peewee-3.9.5/docs/index.rst
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/docs/_build/
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/docs/_build/doctrees/
--rw-rw-r--   0 charles   (1000) charles   (1000)   218968 2019-04-14 15:39:36.000000 peewee-3.9.5/docs/_build/doctrees/environment.pickle
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/docs/_build/doctrees/peewee/
--rw-rw-r--   0 charles   (1000) charles   (1000)   235175 2019-04-14 15:39:35.000000 peewee-3.9.5/docs/_build/doctrees/peewee/database.doctree
--rw-rw-r--   0 charles   (1000) charles   (1000)   264347 2019-04-06 03:50:27.000000 peewee-3.9.5/docs/_build/doctrees/peewee/querying.doctree
--rw-rw-r--   0 charles   (1000) charles   (1000)   394099 2019-03-28 04:54:55.000000 peewee-3.9.5/docs/_build/doctrees/peewee/sqlite_ext.doctree
--rw-rw-r--   0 charles   (1000) charles   (1000)   115612 2019-03-28 04:54:54.000000 peewee-3.9.5/docs/_build/doctrees/peewee/query_examples.doctree
--rw-rw-r--   0 charles   (1000) charles   (1000)    62441 2019-04-06 03:50:27.000000 peewee-3.9.5/docs/_build/doctrees/peewee/quickstart.doctree
--rw-rw-r--   0 charles   (1000) charles   (1000)    67093 2019-03-28 04:54:53.000000 peewee-3.9.5/docs/_build/doctrees/peewee/example.doctree
--rw-rw-r--   0 charles   (1000) charles   (1000)    56983 2019-04-14 15:39:35.000000 peewee-3.9.5/docs/_build/doctrees/peewee/hacks.doctree
--rw-rw-r--   0 charles   (1000) charles   (1000)   125770 2019-03-28 04:54:55.000000 peewee-3.9.5/docs/_build/doctrees/peewee/relationships.doctree
--rw-rw-r--   0 charles   (1000) charles   (1000)    21553 2019-03-28 04:54:53.000000 peewee-3.9.5/docs/_build/doctrees/peewee/installation.doctree
--rw-rw-r--   0 charles   (1000) charles   (1000)    21686 2019-03-28 04:54:53.000000 peewee-3.9.5/docs/_build/doctrees/peewee/interactive.doctree
--rw-rw-r--   0 charles   (1000) charles   (1000)    13220 2019-03-28 04:54:53.000000 peewee-3.9.5/docs/_build/doctrees/peewee/contributing.doctree
--rw-rw-r--   0 charles   (1000) charles   (1000)  1153663 2019-04-14 15:39:35.000000 peewee-3.9.5/docs/_build/doctrees/peewee/api.doctree
--rw-rw-r--   0 charles   (1000) charles   (1000)    45307 2019-03-28 04:54:54.000000 peewee-3.9.5/docs/_build/doctrees/peewee/query_builder.doctree
--rw-rw-r--   0 charles   (1000) charles   (1000)    51650 2019-03-28 04:54:53.000000 peewee-3.9.5/docs/_build/doctrees/peewee/changes.doctree
--rw-rw-r--   0 charles   (1000) charles   (1000)   229189 2019-04-14 15:39:36.000000 peewee-3.9.5/docs/_build/doctrees/peewee/models.doctree
--rw-rw-r--   0 charles   (1000) charles   (1000)    76087 2019-03-28 04:54:55.000000 peewee-3.9.5/docs/_build/doctrees/peewee/query_operators.doctree
--rw-rw-r--   0 charles   (1000) charles   (1000)   728956 2019-03-28 14:38:41.000000 peewee-3.9.5/docs/_build/doctrees/peewee/playhouse.doctree
--rw-rw-r--   0 charles   (1000) charles   (1000)    13207 2019-03-28 04:54:51.000000 peewee-3.9.5/docs/_build/doctrees/index.doctree
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/docs/_build/html/
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/docs/_build/html/_static/
--rw-rw-r--   0 charles   (1000) charles   (1000)       90 2018-10-06 04:18:24.000000 peewee-3.9.5/docs/_build/html/_static/minus.png
--rw-rw-r--   0 charles   (1000) charles   (1000)     4146 2019-04-14 15:39:37.000000 peewee-3.9.5/docs/_build/html/_static/classic.css
--rw-rw-r--   0 charles   (1000) charles   (1000)       28 2018-10-06 04:18:24.000000 peewee-3.9.5/docs/_build/html/_static/default.css
--rw-rw-r--   0 charles   (1000) charles   (1000)    15129 2018-10-06 04:18:24.000000 peewee-3.9.5/docs/_build/html/_static/searchtools.js
--rw-rw-r--   0 charles   (1000) charles   (1000)    12140 2018-10-06 04:18:24.000000 peewee-3.9.5/docs/_build/html/_static/underscore.js
--rw-rw-r--   0 charles   (1000) charles   (1000)       90 2018-10-06 04:18:24.000000 peewee-3.9.5/docs/_build/html/_static/plus.png
--rw-rw-r--   0 charles   (1000) charles   (1000)      203 2018-10-06 04:18:24.000000 peewee-3.9.5/docs/_build/html/_static/up.png
--rw-rw-r--   0 charles   (1000) charles   (1000)      756 2018-10-06 04:18:24.000000 peewee-3.9.5/docs/_build/html/_static/comment-bright.png
--rw-rw-r--   0 charles   (1000) charles   (1000)   268039 2018-10-06 04:18:24.000000 peewee-3.9.5/docs/_build/html/_static/jquery-3.2.1.js
--rw-rw-r--   0 charles   (1000) charles   (1000)     9313 2018-10-06 04:18:24.000000 peewee-3.9.5/docs/_build/html/_static/doctools.js
--rw-rw-r--   0 charles   (1000) charles   (1000)    86659 2018-10-06 04:18:24.000000 peewee-3.9.5/docs/_build/html/_static/jquery.js
--rw-rw-r--   0 charles   (1000) charles   (1000)      286 2018-10-06 04:18:24.000000 peewee-3.9.5/docs/_build/html/_static/file.png
--rw-rw-r--   0 charles   (1000) charles   (1000)      673 2018-10-06 04:18:24.000000 peewee-3.9.5/docs/_build/html/_static/ajax-loader.gif
--rw-rw-r--   0 charles   (1000) charles   (1000)     4803 2019-04-14 15:39:37.000000 peewee-3.9.5/docs/_build/html/_static/sidebar.js
--rw-rw-r--   0 charles   (1000) charles   (1000)     4395 2019-04-14 15:39:37.000000 peewee-3.9.5/docs/_build/html/_static/pygments.css
--rw-rw-r--   0 charles   (1000) charles   (1000)    35168 2018-10-06 04:18:24.000000 peewee-3.9.5/docs/_build/html/_static/underscore-1.3.1.js
--rw-rw-r--   0 charles   (1000) charles   (1000)    10912 2019-04-14 15:39:37.000000 peewee-3.9.5/docs/_build/html/_static/basic.css
--rw-rw-r--   0 charles   (1000) charles   (1000)    10867 2019-04-14 15:39:37.000000 peewee-3.9.5/docs/_build/html/_static/documentation_options.js
--rw-rw-r--   0 charles   (1000) charles   (1000)      641 2018-10-06 04:18:24.000000 peewee-3.9.5/docs/_build/html/_static/comment.png
--rw-rw-r--   0 charles   (1000) charles   (1000)      829 2018-10-06 04:18:24.000000 peewee-3.9.5/docs/_build/html/_static/comment-close.png
--rw-rw-r--   0 charles   (1000) charles   (1000)    16537 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/_build/html/_static/peewee-white.png
--rw-rw-r--   0 charles   (1000) charles   (1000)      214 2018-10-06 04:18:24.000000 peewee-3.9.5/docs/_build/html/_static/up-pressed.png
--rw-rw-r--   0 charles   (1000) charles   (1000)      222 2018-10-06 04:18:24.000000 peewee-3.9.5/docs/_build/html/_static/down-pressed.png
--rw-rw-r--   0 charles   (1000) charles   (1000)    25355 2018-10-06 04:18:24.000000 peewee-3.9.5/docs/_build/html/_static/websupport.js
--rw-rw-r--   0 charles   (1000) charles   (1000)      202 2018-10-06 04:18:24.000000 peewee-3.9.5/docs/_build/html/_static/down.png
--rw-rw-r--   0 charles   (1000) charles   (1000)      230 2019-04-14 15:39:37.000000 peewee-3.9.5/docs/_build/html/.buildinfo
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/docs/_build/html/_sources/
--rw-rw-r--   0 charles   (1000) charles   (1000)     1900 2019-03-06 04:33:00.000000 peewee-3.9.5/docs/_build/html/_sources/index.rst.txt
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/docs/_build/html/_sources/peewee/
--rw-rw-r--   0 charles   (1000) charles   (1000)    12924 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/_build/html/_sources/peewee/query_builder.rst.txt
--rw-rw-r--   0 charles   (1000) charles   (1000)    49163 2019-04-14 15:39:24.000000 peewee-3.9.5/docs/_build/html/_sources/peewee/models.rst.txt
--rw-rw-r--   0 charles   (1000) charles   (1000)    16159 2019-02-04 02:29:18.000000 peewee-3.9.5/docs/_build/html/_sources/peewee/query_operators.rst.txt
--rw-rw-r--   0 charles   (1000) charles   (1000)    65189 2019-04-02 16:58:12.000000 peewee-3.9.5/docs/_build/html/_sources/peewee/querying.rst.txt
--rw-rw-r--   0 charles   (1000) charles   (1000)   121795 2019-03-28 04:55:41.000000 peewee-3.9.5/docs/_build/html/_sources/peewee/playhouse.rst.txt
--rw-rw-r--   0 charles   (1000) charles   (1000)    34234 2019-02-27 00:53:09.000000 peewee-3.9.5/docs/_build/html/_sources/peewee/relationships.rst.txt
--rw-rw-r--   0 charles   (1000) charles   (1000)     6758 2018-09-28 21:39:07.000000 peewee-3.9.5/docs/_build/html/_sources/peewee/changes.rst.txt
--rw-rw-r--   0 charles   (1000) charles   (1000)   168958 2019-04-14 15:29:53.000000 peewee-3.9.5/docs/_build/html/_sources/peewee/api.rst.txt
--rw-rw-r--   0 charles   (1000) charles   (1000)    73085 2019-02-05 21:19:07.000000 peewee-3.9.5/docs/_build/html/_sources/peewee/sqlite_ext.rst.txt
--rw-rw-r--   0 charles   (1000) charles   (1000)    15250 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/_build/html/_sources/peewee/example.rst.txt
--rw-rw-r--   0 charles   (1000) charles   (1000)     2097 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/_build/html/_sources/peewee/contributing.rst.txt
--rw-rw-r--   0 charles   (1000) charles   (1000)     4102 2019-02-12 17:23:06.000000 peewee-3.9.5/docs/_build/html/_sources/peewee/installation.rst.txt
--rw-rw-r--   0 charles   (1000) charles   (1000)    55143 2019-04-06 04:05:08.000000 peewee-3.9.5/docs/_build/html/_sources/peewee/database.rst.txt
--rw-rw-r--   0 charles   (1000) charles   (1000)     4234 2019-03-06 04:12:17.000000 peewee-3.9.5/docs/_build/html/_sources/peewee/interactive.rst.txt
--rw-rw-r--   0 charles   (1000) charles   (1000)    14241 2019-04-06 03:30:31.000000 peewee-3.9.5/docs/_build/html/_sources/peewee/quickstart.rst.txt
--rw-rw-r--   0 charles   (1000) charles   (1000)    43741 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/_build/html/_sources/peewee/query_examples.rst.txt
--rw-rw-r--   0 charles   (1000) charles   (1000)    17968 2019-04-12 19:13:55.000000 peewee-3.9.5/docs/_build/html/_sources/peewee/hacks.rst.txt
--rw-rw-r--   0 charles   (1000) charles   (1000)     5770 2019-04-14 15:39:37.000000 peewee-3.9.5/docs/_build/html/objects.inv
--rw-rw-r--   0 charles   (1000) charles   (1000)     3538 2019-04-14 15:39:37.000000 peewee-3.9.5/docs/_build/html/search.html
--rw-rw-r--   0 charles   (1000) charles   (1000)    68665 2019-04-14 15:39:37.000000 peewee-3.9.5/docs/_build/html/genindex.html
--rw-rw-r--   0 charles   (1000) charles   (1000)    25703 2019-04-14 15:39:36.000000 peewee-3.9.5/docs/_build/html/index.html
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/docs/_build/html/_images/
--rw-rw-r--   0 charles   (1000) charles   (1000)     1655 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/_build/html/_images/peewee3-logo.png
--rw-rw-r--   0 charles   (1000) charles   (1000)    59016 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/_build/html/_images/schema-horizontal.png
--rw-rw-r--   0 charles   (1000) charles   (1000)     1345 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/_build/html/_images/mysql.png
--rw-rw-r--   0 charles   (1000) charles   (1000)    30722 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/_build/html/_images/tweepee.jpg
--rw-rw-r--   0 charles   (1000) charles   (1000)    11640 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/_build/html/_images/schema.jpg
--rw-rw-r--   0 charles   (1000) charles   (1000)     2471 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/_build/html/_images/sqlite.png
--rw-rw-r--   0 charles   (1000) charles   (1000)     4181 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/_build/html/_images/postgresql.png
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/docs/_build/html/peewee/
--rw-rw-r--   0 charles   (1000) charles   (1000)     7876 2019-03-28 04:54:56.000000 peewee-3.9.5/docs/_build/html/peewee/contributing.html
--rw-rw-r--   0 charles   (1000) charles   (1000)    23717 2019-03-28 04:54:56.000000 peewee-3.9.5/docs/_build/html/peewee/changes.html
--rw-rw-r--   0 charles   (1000) charles   (1000)    16569 2019-03-28 04:54:57.000000 peewee-3.9.5/docs/_build/html/peewee/interactive.html
--rw-rw-r--   0 charles   (1000) charles   (1000)    56514 2019-03-28 04:54:58.000000 peewee-3.9.5/docs/_build/html/peewee/query_builder.html
--rw-rw-r--   0 charles   (1000) charles   (1000)    11913 2019-03-28 04:54:57.000000 peewee-3.9.5/docs/_build/html/peewee/installation.html
--rw-rw-r--   0 charles   (1000) charles   (1000)    55741 2019-03-28 04:54:58.000000 peewee-3.9.5/docs/_build/html/peewee/query_operators.html
--rw-rw-r--   0 charles   (1000) charles   (1000)   142254 2019-04-14 15:39:37.000000 peewee-3.9.5/docs/_build/html/peewee/models.html
--rw-rw-r--   0 charles   (1000) charles   (1000)    48167 2019-04-06 03:50:29.000000 peewee-3.9.5/docs/_build/html/peewee/quickstart.html
--rw-rw-r--   0 charles   (1000) charles   (1000)    42886 2019-03-28 04:54:57.000000 peewee-3.9.5/docs/_build/html/peewee/example.html
--rw-rw-r--   0 charles   (1000) charles   (1000)   227711 2019-04-06 03:50:29.000000 peewee-3.9.5/docs/_build/html/peewee/querying.html
--rw-rw-r--   0 charles   (1000) charles   (1000)    58566 2019-04-14 15:39:37.000000 peewee-3.9.5/docs/_build/html/peewee/hacks.html
--rw-rw-r--   0 charles   (1000) charles   (1000)   554475 2019-04-14 15:39:36.000000 peewee-3.9.5/docs/_build/html/peewee/api.html
--rw-rw-r--   0 charles   (1000) charles   (1000)   111565 2019-03-28 04:54:58.000000 peewee-3.9.5/docs/_build/html/peewee/relationships.html
--rw-rw-r--   0 charles   (1000) charles   (1000)   160734 2019-04-14 15:39:37.000000 peewee-3.9.5/docs/_build/html/peewee/database.html
--rw-rw-r--   0 charles   (1000) charles   (1000)   212615 2019-03-28 04:54:58.000000 peewee-3.9.5/docs/_build/html/peewee/sqlite_ext.html
--rw-rw-r--   0 charles   (1000) charles   (1000)   186194 2019-03-28 04:54:58.000000 peewee-3.9.5/docs/_build/html/peewee/query_examples.html
--rw-rw-r--   0 charles   (1000) charles   (1000)   393850 2019-03-28 14:38:43.000000 peewee-3.9.5/docs/_build/html/peewee/playhouse.html
--rw-rw-r--   0 charles   (1000) charles   (1000)    73755 2019-04-14 15:39:37.000000 peewee-3.9.5/docs/_build/html/searchindex.js
--rw-rw-r--   0 charles   (1000) charles   (1000)     1629 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/peewee-logo.png
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/docs/peewee/
--rw-rw-r--   0 charles   (1000) charles   (1000)     6758 2018-09-28 21:39:07.000000 peewee-3.9.5/docs/peewee/changes.rst
--rw-rw-r--   0 charles   (1000) charles   (1000)     2097 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/peewee/contributing.rst
--rw-rw-r--   0 charles   (1000) charles   (1000)    59016 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/peewee/schema-horizontal.png
--rw-rw-r--   0 charles   (1000) charles   (1000)    34234 2019-02-27 00:53:09.000000 peewee-3.9.5/docs/peewee/relationships.rst
--rw-rw-r--   0 charles   (1000) charles   (1000)    55143 2019-04-06 04:05:08.000000 peewee-3.9.5/docs/peewee/database.rst
--rw-rw-r--   0 charles   (1000) charles   (1000)     4234 2019-03-06 04:12:17.000000 peewee-3.9.5/docs/peewee/interactive.rst
--rw-rw-r--   0 charles   (1000) charles   (1000)   169213 2019-04-16 16:51:35.000000 peewee-3.9.5/docs/peewee/api.rst
--rw-rw-r--   0 charles   (1000) charles   (1000)    12924 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/peewee/query_builder.rst
--rw-rw-r--   0 charles   (1000) charles   (1000)    14241 2019-04-06 03:30:31.000000 peewee-3.9.5/docs/peewee/quickstart.rst
--rw-rw-r--   0 charles   (1000) charles   (1000)    65189 2019-04-02 16:58:12.000000 peewee-3.9.5/docs/peewee/querying.rst
--rw-rw-r--   0 charles   (1000) charles   (1000)    30722 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/peewee/tweepee.jpg
--rw-rw-r--   0 charles   (1000) charles   (1000)    18007 2019-04-14 15:40:19.000000 peewee-3.9.5/docs/peewee/hacks.rst
--rw-rw-r--   0 charles   (1000) charles   (1000)    16159 2019-02-04 02:29:18.000000 peewee-3.9.5/docs/peewee/query_operators.rst
--rw-rw-r--   0 charles   (1000) charles   (1000)    43741 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/peewee/query_examples.rst
--rw-rw-r--   0 charles   (1000) charles   (1000)    15250 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/peewee/example.rst
--rw-rw-r--   0 charles   (1000) charles   (1000)     4102 2019-02-12 17:23:06.000000 peewee-3.9.5/docs/peewee/installation.rst
--rw-rw-r--   0 charles   (1000) charles   (1000)    49163 2019-04-14 15:39:24.000000 peewee-3.9.5/docs/peewee/models.rst
--rw-rw-r--   0 charles   (1000) charles   (1000)    11640 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/peewee/schema.jpg
--rw-rw-r--   0 charles   (1000) charles   (1000)   121795 2019-03-28 05:01:44.000000 peewee-3.9.5/docs/peewee/playhouse.rst
--rw-rw-r--   0 charles   (1000) charles   (1000)    73085 2019-04-26 19:11:01.000000 peewee-3.9.5/docs/peewee/sqlite_ext.rst
--rw-rw-r--   0 charles   (1000) charles   (1000)    16537 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/peewee-white.png
--rw-rw-r--   0 charles   (1000) charles   (1000)     7292 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/conf.py
--rw-rw-r--   0 charles   (1000) charles   (1000)     2471 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/sqlite.png
--rw-rw-r--   0 charles   (1000) charles   (1000)     4181 2018-08-16 18:40:47.000000 peewee-3.9.5/docs/postgresql.png
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/examples/
--rwxrwxr-x   0 charles   (1000) charles   (1000)     2475 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/diary.py
--rw-rw-r--   0 charles   (1000) charles   (1000)     2131 2019-03-04 20:33:58.000000 peewee-3.9.5/examples/graph.py
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/examples/analytics/
--rw-rw-r--   0 charles   (1000) charles   (1000)       13 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/analytics/requirements.txt
--rw-rw-r--   0 charles   (1000) charles   (1000)     4443 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/analytics/app.py
--rwxrwxr-x   0 charles   (1000) charles   (1000)      103 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/analytics/run_example.py
--rw-rw-r--   0 charles   (1000) charles   (1000)     4400 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/analytics/reports.py
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/examples/blog/
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/examples/blog/templates/
--rw-rw-r--   0 charles   (1000) charles   (1000)      250 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/blog/templates/edit.html
--rw-rw-r--   0 charles   (1000) charles   (1000)     2825 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/blog/templates/base.html
--rw-rw-r--   0 charles   (1000) charles   (1000)     1408 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/blog/templates/create.html
--rw-rw-r--   0 charles   (1000) charles   (1000)      636 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/blog/templates/index.html
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/examples/blog/templates/includes/
--rw-rw-r--   0 charles   (1000) charles   (1000)      778 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/blog/templates/includes/pagination.html
--rw-rw-r--   0 charles   (1000) charles   (1000)      663 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/blog/templates/login.html
--rw-rw-r--   0 charles   (1000) charles   (1000)      363 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/blog/templates/logout.html
--rw-rw-r--   0 charles   (1000) charles   (1000)      429 2018-09-14 00:40:44.000000 peewee-3.9.5/examples/blog/templates/detail.html
--rw-rw-r--   0 charles   (1000) charles   (1000)       55 2018-12-13 12:36:45.000000 peewee-3.9.5/examples/blog/requirements.txt
--rw-rw-r--   0 charles   (1000) charles   (1000)     9478 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/blog/app.py
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/examples/blog/static/
--rw-rw-r--   0 charles   (1000) charles   (1000)       14 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/blog/static/robots.txt
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/examples/blog/static/css/
--rw-rw-r--   0 charles   (1000) charles   (1000)     1713 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/blog/static/css/hilite.css
--rw-rw-r--   0 charles   (1000) charles   (1000)   103508 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/blog/static/css/blog.min.css
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/examples/blog/static/js/
--rw-rw-r--   0 charles   (1000) charles   (1000)    96381 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/blog/static/js/jquery-1.11.0.min.js
--rw-rw-r--   0 charles   (1000) charles   (1000)    29110 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/blog/static/js/bootstrap.min.js
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/examples/blog/static/fonts/
--rw-rw-r--   0 charles   (1000) charles   (1000)    20335 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/blog/static/fonts/glyphicons-halflings-regular.eot
--rw-rw-r--   0 charles   (1000) charles   (1000)    41280 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/blog/static/fonts/glyphicons-halflings-regular.ttf
--rw-rw-r--   0 charles   (1000) charles   (1000)    62927 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/blog/static/fonts/glyphicons-halflings-regular.svg
--rw-rw-r--   0 charles   (1000) charles   (1000)    23320 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/blog/static/fonts/glyphicons-halflings-regular.woff
--rw-rw-r--   0 charles   (1000) charles   (1000)     5022 2019-03-07 04:05:18.000000 peewee-3.9.5/examples/hexastore.py
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/examples/twitter/
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/examples/twitter/templates/
--rw-rw-r--   0 charles   (1000) charles   (1000)      780 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/twitter/templates/user_detail.html
--rw-rw-r--   0 charles   (1000) charles   (1000)      253 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/twitter/templates/public_messages.html
--rw-rw-r--   0 charles   (1000) charles   (1000)      487 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/twitter/templates/join.html
--rw-rw-r--   0 charles   (1000) charles   (1000)      305 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/twitter/templates/user_followers.html
--rw-rw-r--   0 charles   (1000) charles   (1000)      106 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/twitter/templates/homepage.html
--rw-rw-r--   0 charles   (1000) charles   (1000)      696 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/twitter/templates/layout.html
--rw-rw-r--   0 charles   (1000) charles   (1000)      291 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/twitter/templates/create.html
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/examples/twitter/templates/includes/
--rw-rw-r--   0 charles   (1000) charles   (1000)      198 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/twitter/templates/includes/message.html
--rw-rw-r--   0 charles   (1000) charles   (1000)      178 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/twitter/templates/includes/pagination.html
--rw-rw-r--   0 charles   (1000) charles   (1000)      286 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/twitter/templates/user_list.html
--rw-rw-r--   0 charles   (1000) charles   (1000)      407 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/twitter/templates/login.html
--rw-rw-r--   0 charles   (1000) charles   (1000)      305 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/twitter/templates/user_following.html
--rw-rw-r--   0 charles   (1000) charles   (1000)      254 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/twitter/templates/private_messages.html
--rw-rw-r--   0 charles   (1000) charles   (1000)       13 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/twitter/requirements.txt
--rw-rw-r--   0 charles   (1000) charles   (1000)    11438 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/twitter/app.py
--rwxrwxr-x   0 charles   (1000) charles   (1000)      124 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/twitter/run_example.py
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/examples/twitter/static/
--rw-rw-r--   0 charles   (1000) charles   (1000)      797 2018-08-16 18:40:47.000000 peewee-3.9.5/examples/twitter/static/style.css
--rw-rw-r--   0 charles   (1000) charles   (1000)     1489 2019-03-04 13:56:40.000000 peewee-3.9.5/examples/adjacency_list.py
--rw-rw-r--   0 charles   (1000) charles   (1000)      107 2019-03-04 20:49:26.000000 peewee-3.9.5/TODO.rst
--rw-rw-r--   0 charles   (1000) charles   (1000)     5451 2019-02-12 17:23:06.000000 peewee-3.9.5/setup.py
--rwxrwxr-x   0 charles   (1000) charles   (1000)     3692 2018-08-16 18:40:47.000000 peewee-3.9.5/runtests.py
--rwxrwxr-x   0 charles   (1000) charles   (1000)     7963 2019-03-31 17:30:27.000000 peewee-3.9.5/pwiz.py
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/playhouse/
--rw-rw-r--   0 charles   (1000) charles   (1000)     1743 2019-03-07 04:53:08.000000 peewee-3.9.5/playhouse/fields.py
--rw-rw-r--   0 charles   (1000) charles   (1000)    43137 2019-04-26 19:11:01.000000 peewee-3.9.5/playhouse/sqlite_ext.py
--rw-rw-r--   0 charles   (1000) charles   (1000)   290684 2018-08-16 18:40:48.000000 peewee-3.9.5/playhouse/_sqlite_udf.c
--rw-rw-r--   0 charles   (1000) charles   (1000)    13291 2018-08-16 18:40:48.000000 peewee-3.9.5/playhouse/sqlite_udf.py
--rw-rw-r--   0 charles   (1000) charles   (1000)   126913 2018-08-16 20:01:36.000000 peewee-3.9.5/playhouse/_speedups.c
--rw-rw-r--   0 charles   (1000) charles   (1000)        0 2018-08-16 18:40:47.000000 peewee-3.9.5/playhouse/__init__.py
--rw-rw-r--   0 charles   (1000) charles   (1000)     3479 2018-08-16 18:40:47.000000 peewee-3.9.5/playhouse/_sqlite_udf.pyx
--rw-rw-r--   0 charles   (1000) charles   (1000)     3383 2018-08-16 18:40:47.000000 peewee-3.9.5/playhouse/README.md
--rw-rw-r--   0 charles   (1000) charles   (1000)     3976 2018-09-30 12:17:35.000000 peewee-3.9.5/playhouse/db_url.py
--rw-rw-r--   0 charles   (1000) charles   (1000)     6034 2018-08-16 18:40:47.000000 peewee-3.9.5/playhouse/flask_utils.py
--rw-rw-r--   0 charles   (1000) charles   (1000)     2487 2018-08-16 18:40:48.000000 peewee-3.9.5/playhouse/signals.py
--rw-rw-r--   0 charles   (1000) charles   (1000)    28793 2019-03-31 17:30:32.000000 peewee-3.9.5/playhouse/reflection.py
--rw-rw-r--   0 charles   (1000) charles   (1000)    11437 2019-03-14 03:20:33.000000 peewee-3.9.5/playhouse/pool.py
--rw-rw-r--   0 charles   (1000) charles   (1000)     1737 2018-08-16 18:40:48.000000 peewee-3.9.5/playhouse/test_utils.py
--rw-rw-r--   0 charles   (1000) charles   (1000)     3460 2018-12-19 22:40:39.000000 peewee-3.9.5/playhouse/sqlcipher_ext.py
--rw-rw-r--   0 charles   (1000) charles   (1000)    28612 2019-03-28 02:52:08.000000 peewee-3.9.5/playhouse/migrate.py
--rw-rw-r--   0 charles   (1000) charles   (1000)      876 2019-04-09 00:40:54.000000 peewee-3.9.5/playhouse/mysql_ext.py
--rw-rw-r--   0 charles   (1000) charles   (1000)    13645 2019-03-25 21:17:28.000000 peewee-3.9.5/playhouse/postgres_ext.py
--rw-rw-r--   0 charles   (1000) charles   (1000)    50128 2019-04-26 19:11:01.000000 peewee-3.9.5/playhouse/_sqlite_ext.pyx
--rw-rw-r--   0 charles   (1000) charles   (1000)  1055566 2019-04-26 19:11:30.000000 peewee-3.9.5/playhouse/_sqlite_ext.c
--rw-rw-r--   0 charles   (1000) charles   (1000)     5375 2019-03-04 20:48:26.000000 peewee-3.9.5/playhouse/kv.py
--rw-rw-r--   0 charles   (1000) charles   (1000)    10075 2018-08-16 18:40:48.000000 peewee-3.9.5/playhouse/sqliteq.py
--rw-rw-r--   0 charles   (1000) charles   (1000)     8215 2019-02-28 05:07:22.000000 peewee-3.9.5/playhouse/shortcuts.py
-drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-04-26 19:29:15.000000 peewee-3.9.5/playhouse/_pysqlite/
--rw-rw-r--   0 charles   (1000) charles   (1000)     1499 2018-08-16 18:40:47.000000 peewee-3.9.5/playhouse/_pysqlite/prepare_protocol.h
--rw-rw-r--   0 charles   (1000) charles   (1000)     2388 2018-08-16 18:40:47.000000 peewee-3.9.5/playhouse/_pysqlite/cursor.h
--rw-rw-r--   0 charles   (1000) charles   (1000)     4826 2018-08-16 18:40:47.000000 peewee-3.9.5/playhouse/_pysqlite/connection.h
--rw-rw-r--   0 charles   (1000) charles   (1000)     1537 2018-08-16 18:40:47.000000 peewee-3.9.5/playhouse/_pysqlite/util.h
--rw-rw-r--   0 charles   (1000) charles   (1000)     1270 2018-08-16 18:40:47.000000 peewee-3.9.5/playhouse/_pysqlite/row.h
--rw-rw-r--   0 charles   (1000) charles   (1000)     1378 2018-08-16 18:40:47.000000 peewee-3.9.5/playhouse/_pysqlite/backup.h
--rw-rw-r--   0 charles   (1000) charles   (1000)     2331 2018-08-16 18:40:47.000000 peewee-3.9.5/playhouse/_pysqlite/cache.h
--rw-rw-r--   0 charles   (1000) charles   (1000)    28892 2018-08-16 18:40:47.000000 peewee-3.9.5/playhouse/_pysqlite/sqlite_constants.h
--rw-rw-r--   0 charles   (1000) charles   (1000)     2118 2018-08-16 18:40:47.000000 peewee-3.9.5/playhouse/_pysqlite/microprotocols.h
--rw-rw-r--   0 charles   (1000) charles   (1000)     2018 2018-08-16 18:40:47.000000 peewee-3.9.5/playhouse/_pysqlite/module.h
--rw-rw-r--   0 charles   (1000) charles   (1000)     2098 2018-08-16 18:40:47.000000 peewee-3.9.5/playhouse/_pysqlite/statement.h
--rw-rw-r--   0 charles   (1000) charles   (1000)     4223 2019-03-06 12:55:19.000000 peewee-3.9.5/playhouse/apsw_ext.py
--rw-rw-r--   0 charles   (1000) charles   (1000)     1473 2018-08-16 18:40:47.000000 peewee-3.9.5/playhouse/hybrid.py
--rw-rw-r--   0 charles   (1000) charles   (1000)    12767 2019-03-23 02:23:31.000000 peewee-3.9.5/playhouse/dataset.py
+drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-06-06 16:27:06.000000 peewee-3.9.6/
+drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-06-06 16:27:06.000000 peewee-3.9.6/examples/
+-rw-rw-r--   0 charles   (1000) charles   (1000)     2131 2019-03-06 13:25:56.000000 peewee-3.9.6/examples/graph.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)     1413 2019-05-06 13:51:56.000000 peewee-3.9.6/examples/reddit_ranking.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)     1489 2019-03-06 13:25:56.000000 peewee-3.9.6/examples/adjacency_list.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)     5022 2019-03-11 13:52:18.000000 peewee-3.9.6/examples/hexastore.py
+drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-06-06 16:27:06.000000 peewee-3.9.6/examples/twitter/
+drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-06-06 16:27:06.000000 peewee-3.9.6/examples/twitter/templates/
+-rw-rw-r--   0 charles   (1000) charles   (1000)      291 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/twitter/templates/create.html
+-rw-rw-r--   0 charles   (1000) charles   (1000)      407 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/twitter/templates/login.html
+-rw-rw-r--   0 charles   (1000) charles   (1000)      780 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/twitter/templates/user_detail.html
+-rw-rw-r--   0 charles   (1000) charles   (1000)      286 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/twitter/templates/user_list.html
+-rw-rw-r--   0 charles   (1000) charles   (1000)      305 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/twitter/templates/user_following.html
+drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-06-06 16:27:06.000000 peewee-3.9.6/examples/twitter/templates/includes/
+-rw-rw-r--   0 charles   (1000) charles   (1000)      178 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/twitter/templates/includes/pagination.html
+-rw-rw-r--   0 charles   (1000) charles   (1000)      198 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/twitter/templates/includes/message.html
+-rw-rw-r--   0 charles   (1000) charles   (1000)      487 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/twitter/templates/join.html
+-rw-rw-r--   0 charles   (1000) charles   (1000)      106 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/twitter/templates/homepage.html
+-rw-rw-r--   0 charles   (1000) charles   (1000)      254 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/twitter/templates/private_messages.html
+-rw-rw-r--   0 charles   (1000) charles   (1000)      305 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/twitter/templates/user_followers.html
+-rw-rw-r--   0 charles   (1000) charles   (1000)      253 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/twitter/templates/public_messages.html
+-rw-rw-r--   0 charles   (1000) charles   (1000)      696 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/twitter/templates/layout.html
+-rwxrwxr-x   0 charles   (1000) charles   (1000)      124 2018-01-29 17:08:29.000000 peewee-3.9.6/examples/twitter/run_example.py
+drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-06-06 16:27:06.000000 peewee-3.9.6/examples/twitter/static/
+-rw-rw-r--   0 charles   (1000) charles   (1000)      797 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/twitter/static/style.css
+-rw-rw-r--   0 charles   (1000) charles   (1000)       13 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/twitter/requirements.txt
+-rw-rw-r--   0 charles   (1000) charles   (1000)    11438 2018-01-29 17:08:29.000000 peewee-3.9.6/examples/twitter/app.py
+drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-06-06 16:27:06.000000 peewee-3.9.6/examples/analytics/
+-rw-rw-r--   0 charles   (1000) charles   (1000)     4400 2018-01-29 17:08:29.000000 peewee-3.9.6/examples/analytics/reports.py
+-rwxrwxr-x   0 charles   (1000) charles   (1000)      103 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/analytics/run_example.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)       13 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/analytics/requirements.txt
+-rw-rw-r--   0 charles   (1000) charles   (1000)     4443 2018-02-22 20:27:30.000000 peewee-3.9.6/examples/analytics/app.py
+-rwxrwxr-x   0 charles   (1000) charles   (1000)     2475 2018-07-10 21:16:09.000000 peewee-3.9.6/examples/diary.py
+drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-06-06 16:27:06.000000 peewee-3.9.6/examples/blog/
+drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-06-06 16:27:06.000000 peewee-3.9.6/examples/blog/templates/
+-rw-rw-r--   0 charles   (1000) charles   (1000)     1408 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/blog/templates/create.html
+-rw-rw-r--   0 charles   (1000) charles   (1000)      636 2018-03-16 19:41:18.000000 peewee-3.9.6/examples/blog/templates/index.html
+-rw-rw-r--   0 charles   (1000) charles   (1000)     2825 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/blog/templates/base.html
+-rw-rw-r--   0 charles   (1000) charles   (1000)      429 2018-09-13 15:55:27.000000 peewee-3.9.6/examples/blog/templates/detail.html
+-rw-rw-r--   0 charles   (1000) charles   (1000)      663 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/blog/templates/login.html
+drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-06-06 16:27:06.000000 peewee-3.9.6/examples/blog/templates/includes/
+-rw-rw-r--   0 charles   (1000) charles   (1000)      778 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/blog/templates/includes/pagination.html
+-rw-rw-r--   0 charles   (1000) charles   (1000)      363 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/blog/templates/logout.html
+-rw-rw-r--   0 charles   (1000) charles   (1000)      250 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/blog/templates/edit.html
+drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-06-06 16:27:06.000000 peewee-3.9.6/examples/blog/static/
+drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-06-06 16:27:06.000000 peewee-3.9.6/examples/blog/static/js/
+-rw-rw-r--   0 charles   (1000) charles   (1000)    96381 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/blog/static/js/jquery-1.11.0.min.js
+-rw-rw-r--   0 charles   (1000) charles   (1000)    29110 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/blog/static/js/bootstrap.min.js
+drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-06-06 16:27:06.000000 peewee-3.9.6/examples/blog/static/fonts/
+-rw-rw-r--   0 charles   (1000) charles   (1000)    23320 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/blog/static/fonts/glyphicons-halflings-regular.woff
+-rw-rw-r--   0 charles   (1000) charles   (1000)    62927 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/blog/static/fonts/glyphicons-halflings-regular.svg
+-rw-rw-r--   0 charles   (1000) charles   (1000)    20335 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/blog/static/fonts/glyphicons-halflings-regular.eot
+-rw-rw-r--   0 charles   (1000) charles   (1000)    41280 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/blog/static/fonts/glyphicons-halflings-regular.ttf
+drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-06-06 16:27:06.000000 peewee-3.9.6/examples/blog/static/css/
+-rw-rw-r--   0 charles   (1000) charles   (1000)     1713 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/blog/static/css/hilite.css
+-rw-rw-r--   0 charles   (1000) charles   (1000)   103508 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/blog/static/css/blog.min.css
+-rw-rw-r--   0 charles   (1000) charles   (1000)       14 2018-01-17 16:36:19.000000 peewee-3.9.6/examples/blog/static/robots.txt
+-rw-rw-r--   0 charles   (1000) charles   (1000)       55 2018-12-17 14:44:27.000000 peewee-3.9.6/examples/blog/requirements.txt
+-rw-rw-r--   0 charles   (1000) charles   (1000)     9478 2018-06-14 13:43:06.000000 peewee-3.9.6/examples/blog/app.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)     7918 2019-06-06 16:27:06.000000 peewee-3.9.6/PKG-INFO
+-rw-rw-r--   0 charles   (1000) charles   (1000)       38 2019-06-06 16:27:06.000000 peewee-3.9.6/setup.cfg
+-rw-rw-r--   0 charles   (1000) charles   (1000)    98446 2019-06-03 14:55:46.000000 peewee-3.9.6/CHANGELOG.md
+drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-06-06 16:27:06.000000 peewee-3.9.6/peewee.egg-info/
+-rw-rw-r--   0 charles   (1000) charles   (1000)     7918 2019-06-06 16:27:06.000000 peewee-3.9.6/peewee.egg-info/PKG-INFO
+-rw-rw-r--   0 charles   (1000) charles   (1000)       22 2019-06-06 16:27:06.000000 peewee-3.9.6/peewee.egg-info/top_level.txt
+-rw-rw-r--   0 charles   (1000) charles   (1000)     3775 2019-06-06 16:27:06.000000 peewee-3.9.6/peewee.egg-info/SOURCES.txt
+-rw-rw-r--   0 charles   (1000) charles   (1000)        1 2019-06-06 16:27:06.000000 peewee-3.9.6/peewee.egg-info/dependency_links.txt
+-rw-rw-r--   0 charles   (1000) charles   (1000)        1 2018-09-06 20:17:31.000000 peewee-3.9.6/peewee.egg-info/not-zip-safe
+drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-06-06 16:27:06.000000 peewee-3.9.6/playhouse/
+-rw-rw-r--   0 charles   (1000) charles   (1000)    50422 2019-05-17 14:22:34.000000 peewee-3.9.6/playhouse/_sqlite_ext.pyx
+-rw-rw-r--   0 charles   (1000) charles   (1000)     2487 2018-03-16 18:47:05.000000 peewee-3.9.6/playhouse/signals.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)    12767 2019-03-25 13:55:00.000000 peewee-3.9.6/playhouse/dataset.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)    10075 2018-01-29 17:08:29.000000 peewee-3.9.6/playhouse/sqliteq.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)     4223 2019-03-06 13:25:56.000000 peewee-3.9.6/playhouse/apsw_ext.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)    28793 2019-04-01 13:45:40.000000 peewee-3.9.6/playhouse/reflection.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)     6034 2018-08-01 21:20:24.000000 peewee-3.9.6/playhouse/flask_utils.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)      876 2019-04-09 13:46:24.000000 peewee-3.9.6/playhouse/mysql_ext.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)    11437 2019-02-19 20:51:17.000000 peewee-3.9.6/playhouse/pool.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)    13291 2018-01-29 17:08:29.000000 peewee-3.9.6/playhouse/sqlite_udf.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)     3479 2018-01-17 16:36:19.000000 peewee-3.9.6/playhouse/_sqlite_udf.pyx
+-rw-rw-r--   0 charles   (1000) charles   (1000)   290684 2018-01-20 19:25:41.000000 peewee-3.9.6/playhouse/_sqlite_udf.c
+-rw-rw-r--   0 charles   (1000) charles   (1000)     8215 2019-02-05 20:35:36.000000 peewee-3.9.6/playhouse/shortcuts.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)     5375 2019-03-06 13:25:56.000000 peewee-3.9.6/playhouse/kv.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)    28612 2019-03-27 19:31:07.000000 peewee-3.9.6/playhouse/migrate.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)  1054103 2019-05-17 14:22:38.000000 peewee-3.9.6/playhouse/_sqlite_ext.c
+-rw-rw-r--   0 charles   (1000) charles   (1000)     3383 2018-07-23 15:32:30.000000 peewee-3.9.6/playhouse/README.md
+-rw-rw-r--   0 charles   (1000) charles   (1000)     3976 2018-10-01 13:39:57.000000 peewee-3.9.6/playhouse/db_url.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)        0 2018-01-17 16:36:19.000000 peewee-3.9.6/playhouse/__init__.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)    43137 2019-04-29 15:37:07.000000 peewee-3.9.6/playhouse/sqlite_ext.py
+drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-06-06 16:27:06.000000 peewee-3.9.6/playhouse/_pysqlite/
+-rw-rw-r--   0 charles   (1000) charles   (1000)     1270 2018-05-09 16:27:33.000000 peewee-3.9.6/playhouse/_pysqlite/row.h
+-rw-rw-r--   0 charles   (1000) charles   (1000)     2118 2018-05-09 16:27:33.000000 peewee-3.9.6/playhouse/_pysqlite/microprotocols.h
+-rw-rw-r--   0 charles   (1000) charles   (1000)     4826 2018-05-09 16:27:33.000000 peewee-3.9.6/playhouse/_pysqlite/connection.h
+-rw-rw-r--   0 charles   (1000) charles   (1000)     2098 2018-05-09 16:27:33.000000 peewee-3.9.6/playhouse/_pysqlite/statement.h
+-rw-rw-r--   0 charles   (1000) charles   (1000)     1537 2018-05-09 16:27:33.000000 peewee-3.9.6/playhouse/_pysqlite/util.h
+-rw-rw-r--   0 charles   (1000) charles   (1000)     1499 2018-05-09 16:27:33.000000 peewee-3.9.6/playhouse/_pysqlite/prepare_protocol.h
+-rw-rw-r--   0 charles   (1000) charles   (1000)     2388 2018-05-09 16:27:33.000000 peewee-3.9.6/playhouse/_pysqlite/cursor.h
+-rw-rw-r--   0 charles   (1000) charles   (1000)    28892 2018-01-29 17:08:29.000000 peewee-3.9.6/playhouse/_pysqlite/sqlite_constants.h
+-rw-rw-r--   0 charles   (1000) charles   (1000)     2018 2018-05-09 16:27:33.000000 peewee-3.9.6/playhouse/_pysqlite/module.h
+-rw-rw-r--   0 charles   (1000) charles   (1000)     1378 2018-01-29 17:08:29.000000 peewee-3.9.6/playhouse/_pysqlite/backup.h
+-rw-rw-r--   0 charles   (1000) charles   (1000)     2331 2018-05-09 16:27:33.000000 peewee-3.9.6/playhouse/_pysqlite/cache.h
+-rw-rw-r--   0 charles   (1000) charles   (1000)     1743 2019-05-09 19:12:18.000000 peewee-3.9.6/playhouse/fields.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)     1737 2018-01-29 17:08:29.000000 peewee-3.9.6/playhouse/test_utils.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)     3534 2019-06-03 16:12:28.000000 peewee-3.9.6/playhouse/sqlcipher_ext.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)     1473 2018-01-17 16:36:19.000000 peewee-3.9.6/playhouse/hybrid.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)    13645 2019-05-29 15:15:01.000000 peewee-3.9.6/playhouse/postgres_ext.py
+-rwxrwxr-x   0 charles   (1000) charles   (1000)     3692 2018-05-01 20:02:04.000000 peewee-3.9.6/runtests.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)     5954 2019-03-06 13:25:56.000000 peewee-3.9.6/README.rst
+-rwxrwxr-x   0 charles   (1000) charles   (1000)     7963 2019-04-01 13:45:40.000000 peewee-3.9.6/pwiz.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)      178 2019-06-04 13:35:08.000000 peewee-3.9.6/TODO.rst
+-rw-rw-r--   0 charles   (1000) charles   (1000)     1058 2018-01-17 16:36:19.000000 peewee-3.9.6/LICENSE
+-rw-rw-r--   0 charles   (1000) charles   (1000)     5451 2019-02-12 16:22:10.000000 peewee-3.9.6/setup.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)      333 2018-07-09 14:00:12.000000 peewee-3.9.6/MANIFEST.in
+-rw-rw-r--   0 charles   (1000) charles   (1000)   247929 2019-06-04 13:35:08.000000 peewee-3.9.6/peewee.py
+drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-06-06 16:27:06.000000 peewee-3.9.6/docs/
+drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-06-06 16:27:06.000000 peewee-3.9.6/docs/_themes/
+drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-06-06 16:27:06.000000 peewee-3.9.6/docs/_themes/flask/
+-rw-rw-r--   0 charles   (1000) charles   (1000)      164 2018-01-17 16:36:19.000000 peewee-3.9.6/docs/_themes/flask/theme.conf
+drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-06-06 16:27:06.000000 peewee-3.9.6/docs/_themes/flask/static/
+-rw-rw-r--   0 charles   (1000) charles   (1000)      976 2018-01-17 16:36:19.000000 peewee-3.9.6/docs/_themes/flask/static/small_flask.css
+-rw-rw-r--   0 charles   (1000) charles   (1000)     6436 2018-01-17 16:36:19.000000 peewee-3.9.6/docs/_themes/flask/static/flasky.css_t
+-rw-rw-r--   0 charles   (1000) charles   (1000)      750 2018-01-17 16:36:19.000000 peewee-3.9.6/docs/_themes/flask/layout.html
+-rw-rw-r--   0 charles   (1000) charles   (1000)      590 2018-01-17 16:36:19.000000 peewee-3.9.6/docs/_themes/flask/relations.html
+drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-06-06 16:27:06.000000 peewee-3.9.6/docs/peewee/
+-rw-rw-r--   0 charles   (1000) charles   (1000)    15250 2018-06-13 13:32:44.000000 peewee-3.9.6/docs/peewee/example.rst
+-rw-rw-r--   0 charles   (1000) charles   (1000)    73085 2019-04-29 13:24:48.000000 peewee-3.9.6/docs/peewee/sqlite_ext.rst
+-rw-rw-r--   0 charles   (1000) charles   (1000)    18007 2019-04-15 16:05:20.000000 peewee-3.9.6/docs/peewee/hacks.rst
+-rw-rw-r--   0 charles   (1000) charles   (1000)    65189 2019-04-02 15:04:53.000000 peewee-3.9.6/docs/peewee/querying.rst
+-rw-rw-r--   0 charles   (1000) charles   (1000)     4102 2019-02-12 16:21:39.000000 peewee-3.9.6/docs/peewee/installation.rst
+-rw-rw-r--   0 charles   (1000) charles   (1000)    16159 2019-02-04 14:46:47.000000 peewee-3.9.6/docs/peewee/query_operators.rst
+-rw-rw-r--   0 charles   (1000) charles   (1000)    14241 2019-04-09 13:46:24.000000 peewee-3.9.6/docs/peewee/quickstart.rst
+-rw-rw-r--   0 charles   (1000) charles   (1000)     6758 2018-09-27 19:43:34.000000 peewee-3.9.6/docs/peewee/changes.rst
+-rw-rw-r--   0 charles   (1000) charles   (1000)    43741 2018-07-26 21:13:38.000000 peewee-3.9.6/docs/peewee/query_examples.rst
+-rw-rw-r--   0 charles   (1000) charles   (1000)     2097 2018-01-29 17:08:29.000000 peewee-3.9.6/docs/peewee/contributing.rst
+-rw-rw-r--   0 charles   (1000) charles   (1000)    55143 2019-04-09 13:46:24.000000 peewee-3.9.6/docs/peewee/database.rst
+-rw-rw-r--   0 charles   (1000) charles   (1000)    30722 2018-01-17 16:36:19.000000 peewee-3.9.6/docs/peewee/tweepee.jpg
+-rw-rw-r--   0 charles   (1000) charles   (1000)   170600 2019-05-06 15:21:54.000000 peewee-3.9.6/docs/peewee/api.rst
+-rw-rw-r--   0 charles   (1000) charles   (1000)    34234 2019-03-06 13:25:56.000000 peewee-3.9.6/docs/peewee/relationships.rst
+-rw-rw-r--   0 charles   (1000) charles   (1000)    12924 2018-04-25 16:15:09.000000 peewee-3.9.6/docs/peewee/query_builder.rst
+-rw-rw-r--   0 charles   (1000) charles   (1000)    11640 2018-01-17 16:36:19.000000 peewee-3.9.6/docs/peewee/schema.jpg
+-rw-rw-r--   0 charles   (1000) charles   (1000)    59016 2018-01-29 17:08:29.000000 peewee-3.9.6/docs/peewee/schema-horizontal.png
+-rw-rw-r--   0 charles   (1000) charles   (1000)    49145 2019-05-06 13:53:12.000000 peewee-3.9.6/docs/peewee/models.rst
+-rw-rw-r--   0 charles   (1000) charles   (1000)   121795 2019-03-28 13:51:40.000000 peewee-3.9.6/docs/peewee/playhouse.rst
+-rw-rw-r--   0 charles   (1000) charles   (1000)     4234 2019-03-06 13:25:56.000000 peewee-3.9.6/docs/peewee/interactive.rst
+-rw-rw-r--   0 charles   (1000) charles   (1000)     2471 2018-01-17 16:36:19.000000 peewee-3.9.6/docs/sqlite.png
+-rw-rw-r--   0 charles   (1000) charles   (1000)     1655 2018-01-30 01:10:41.000000 peewee-3.9.6/docs/peewee3-logo.png
+-rw-rw-r--   0 charles   (1000) charles   (1000)     1629 2018-01-17 16:36:19.000000 peewee-3.9.6/docs/peewee-logo.png
+-rw-rw-r--   0 charles   (1000) charles   (1000)     7292 2018-06-21 20:37:35.000000 peewee-3.9.6/docs/conf.py
+-rw-rw-r--   0 charles   (1000) charles   (1000)     1900 2019-03-06 13:25:56.000000 peewee-3.9.6/docs/index.rst
+-rw-rw-r--   0 charles   (1000) charles   (1000)     4590 2018-01-17 16:36:19.000000 peewee-3.9.6/docs/Makefile
+-rw-rw-r--   0 charles   (1000) charles   (1000)     4106 2018-01-17 16:36:19.000000 peewee-3.9.6/docs/make.bat
+-rw-rw-r--   0 charles   (1000) charles   (1000)    16537 2018-01-17 16:36:19.000000 peewee-3.9.6/docs/peewee-white.png
+drwxrwxr-x   0 charles   (1000) charles   (1000)        0 2019-06-06 16:27:06.000000 peewee-3.9.6/docs/_static/
+-rw-rw-r--   0 charles   (1000) charles   (1000)    16537 2018-01-17 16:36:19.000000 peewee-3.9.6/docs/_static/peewee-white.png
+-rw-rw-r--   0 charles   (1000) charles   (1000)     1345 2018-01-17 16:36:19.000000 peewee-3.9.6/docs/mysql.png
+-rw-rw-r--   0 charles   (1000) charles   (1000)     4181 2018-01-17 16:36:19.000000 peewee-3.9.6/docs/postgresql.png
```

### Comparing `peewee-3.9.5/peewee.py` & `peewee-3.9.6/peewee.py`

 * *Files 1% similar despite different names*

```diff
@@ -61,15 +61,15 @@
     try:
         import MySQLdb as mysql
         mysql_passwd = True
     except ImportError:
         mysql = None
 
 
-__version__ = '3.9.5'
+__version__ = '3.9.6'
 __all__ = [
     'AsIs',
     'AutoField',
     'BareField',
     'BigAutoField',
     'BigBitField',
     'BigIntegerField',
@@ -2510,14 +2510,17 @@
 
                 if not isinstance(val, Node):
                     val = Value(val, converter=converter, unpack=False)
                 values.append(val)
 
             all_values.append(EnclosedNodeList(values))
 
+        if not all_values:
+            raise self.DefaultValuesException('Error: no data to insert.')
+
         with ctx.scope_values(subquery=True):
             return ctx.sql(CommaNodeList(all_values))
 
     def _query_insert(self, ctx):
         return (ctx
                 .sql(EnclosedNodeList(self._columns))
                 .literal(' ')
@@ -2547,32 +2550,32 @@
                 except self.DefaultValuesException:
                     self._default_values(ctx)
                 self._query_type = Insert.SIMPLE
             elif isinstance(self._insert, (SelectQuery, SQL)):
                 self._query_insert(ctx)
                 self._query_type = Insert.QUERY
             else:
-                try:
-                    self._generate_insert(self._insert, ctx)
-                except self.DefaultValuesException:
-                    return
+                self._generate_insert(self._insert, ctx)
                 self._query_type = Insert.MULTI
 
             if self._on_conflict is not None:
                 update = self._on_conflict.get_conflict_update(ctx, self)
                 if update is not None:
                     ctx.literal(' ').sql(update)
 
             return self.apply_returning(ctx)
 
     def _execute(self, database):
         if self._returning is None and database.returning_clause \
            and self.table._primary_key:
             self._returning = (self.table._primary_key,)
-        return super(Insert, self)._execute(database)
+        try:
+            return super(Insert, self)._execute(database)
+        except self.DefaultValuesException:
+            pass
 
     def handle_result(self, database, cursor):
         if self._return_cursor:
             return cursor
         return database.last_insert_id(cursor, self._query_type)
 
 
@@ -2762,19 +2765,22 @@
     def __init__(self, **kwargs):
         super(_ConnectionState, self).__init__(**kwargs)
         self.reset()
 
     def reset(self):
         self.closed = True
         self.conn = None
+        self.ctx = []
         self.transactions = []
 
     def set_connection(self, conn):
         self.conn = conn
         self.closed = False
+        self.ctx = []
+        self.transactions = []
 
 
 class _ConnectionLocal(_ConnectionState, threading.local): pass
 class _NoopLock(object):
     __slots__ = ()
     def __enter__(self): return self
     def __exit__(self, exc_type, exc_val, exc_tb): pass
@@ -2847,23 +2853,26 @@
         self.database = database
         self.connect_params.update(kwargs)
         self.deferred = not bool(database)
 
     def __enter__(self):
         if self.is_closed():
             self.connect()
-        self.transaction().__enter__()
+        ctx = self.atomic()
+        self._state.ctx.append(ctx)
+        ctx.__enter__()
         return self
 
     def __exit__(self, exc_type, exc_val, exc_tb):
-        top = self._state.transactions[-1]
+        ctx = self._state.ctx.pop()
         try:
-            top.__exit__(exc_type, exc_val, exc_tb)
+            ctx.__exit__(exc_type, exc_val, exc_tb)
         finally:
-            self.close()
+            if not self._state.ctx:
+                self.close()
 
     def connection_context(self):
         return ConnectionContext(self)
 
     def _connect(self):
         raise NotImplementedError
 
@@ -3027,14 +3036,36 @@
 
     def rows_affected(self, cursor):
         return cursor.rowcount
 
     def default_values_insert(self, ctx):
         return ctx.literal('DEFAULT VALUES')
 
+    def session_start(self):
+        with self._lock:
+            return self.transaction().__enter__()
+
+    def session_commit(self):
+        with self._lock:
+            try:
+                txn = self.pop_transaction()
+            except IndexError:
+                return False
+            txn.commit(begin=self.in_transaction())
+            return True
+
+    def session_rollback(self):
+        with self._lock:
+            try:
+                txn = self.pop_transaction()
+            except IndexError:
+                return False
+            txn.rollback(begin=self.in_transaction())
+            return True
+
     def in_transaction(self):
         return bool(self._state.transactions)
 
     def push_transaction(self, transaction):
         self._state.transactions.append(transaction)
 
     def pop_transaction(self):
@@ -3169,16 +3200,15 @@
     def _set_server_version(self, conn):
         pass
 
     def _connect(self):
         if sqlite3 is None:
             raise ImproperlyConfigured('SQLite driver not installed!')
         conn = sqlite3.connect(self.database, timeout=self._timeout,
-                               **self.connect_params)
-        conn.isolation_level = None
+                               isolation_level=None, **self.connect_params)
         try:
             self._add_conn_hooks(conn)
         except:
             conn.close()
             raise
         return conn
 
@@ -3877,19 +3907,19 @@
         self.db = db
         self._lock_type = lock_type
         self._transaction_args = (lock_type,) if lock_type is not None else ()
 
     def __enter__(self):
         if self.db.transaction_depth() == 0:
             self._helper = self.db.transaction(*self._transaction_args)
+        elif isinstance(self.db.top_transaction(), _manual):
+            raise ValueError('Cannot enter atomic commit block while in '
+                             'manual commit mode.')
         else:
             self._helper = self.db.savepoint()
-            if isinstance(self.db.top_transaction(), _manual):
-                raise ValueError('Cannot enter atomic commit block while in '
-                                 'manual commit mode.')
         return self._helper.__enter__()
 
     def __exit__(self, exc_type, exc_val, exc_tb):
         return self._helper.__exit__(exc_type, exc_val, exc_tb)
 
 
 class _transaction(_callable_context_manager):
@@ -5147,16 +5177,20 @@
     def __ne__(self, other):
         return ~(self == other)
 
     def __hash__(self):
         return hash((self.model.__name__, self.field_names))
 
     def __sql__(self, ctx):
-        return ctx.sql(EnclosedNodeList([self.model._meta.fields[field]
-                                         for field in self.field_names]))
+        # If the composite PK is being selected, do not use parens. Elsewhere,
+        # such as in an expression, we want to use parentheses and treat it as
+        # a row value.
+        parens = ctx.scope != SCOPE_SOURCE
+        return ctx.sql(NodeList([self.model._meta.fields[field]
+                                 for field in self.field_names], ', ', parens))
 
     def bind(self, model, name, set_attribute=True):
         self.model = model
         self.column_name = self.name = name
         setattr(model, self.name, self)
 
 
@@ -5272,14 +5306,29 @@
                     value = SQL(str(value))
             accum.append(NodeList((SQL(key), value), glue='='))
         return accum
 
     def create_table(self, safe=True, **options):
         self.database.execute(self._create_table(safe=safe, **options))
 
+    def _create_table_as(self, table_name, query, safe=True, **meta):
+        ctx = (self._create_context()
+               .literal('CREATE TEMPORARY TABLE '
+                        if meta.get('temporary') else 'CREATE TABLE '))
+        if safe:
+            ctx.literal('IF NOT EXISTS ')
+        return (ctx
+                .sql(Entity(table_name))
+                .literal(' AS ')
+                .sql(query))
+
+    def create_table_as(self, table_name, query, safe=True, **meta):
+        ctx = self._create_table_as(table_name, query, safe=safe, **meta)
+        self.database.execute(ctx)
+
     def _drop_table(self, safe=True, **options):
         ctx = (self._create_context()
                .literal('DROP TABLE IF EXISTS ' if safe else 'DROP TABLE ')
                .sql(self.model))
         if options.get('cascade'):
             ctx = ctx.literal(' CASCADE')
         elif options.get('restrict'):
@@ -5979,15 +6028,15 @@
             ids_returned = False
 
         fields = [cls._meta.fields[field_name] for field_name in field_names]
         for batch in batches:
             accum = ([getattr(model, f) for f in field_names]
                      for model in batch)
             res = cls.insert_many(accum, fields=fields).execute()
-            if ids_returned:
+            if ids_returned and res is not None:
                 for (obj_id,), model in zip(res, batch):
                     setattr(model, pk_name, obj_id)
 
     @classmethod
     def bulk_update(cls, model_list, fields, batch_size=None):
         if isinstance(cls._meta.primary_key, CompositeKey):
             raise ValueError('bulk_update() is not supported for models with '
@@ -6141,14 +6190,16 @@
 
         if pk_value is not None and not force_insert:
             if self._meta.composite_key:
                 for pk_part_name in pk_field.field_names:
                     field_dict.pop(pk_part_name, None)
             else:
                 field_dict.pop(pk_field.name, None)
+            if not field_dict:
+                raise ValueError('no data to save!')
             rows = self.update(**field_dict).where(self._pk_expr()).execute()
         elif pk_field is not None:
             pk = self.insert(**field_dict).execute()
             if pk is not None and (self._meta.auto_increment or
                                    pk_value is None):
                 self._pk = pk
         else:
@@ -6190,15 +6241,15 @@
             dependencies = self.dependencies(delete_nullable)
             for query, fk in reversed(list(dependencies)):
                 model = fk.model
                 if fk.null and not delete_nullable:
                     model.update(**{fk.name: None}).where(query).execute()
                 else:
                     model.delete().where(query).execute()
-        return self.delete().where(self._pk_expr()).execute()
+        return type(self).delete().where(self._pk_expr()).execute()
 
     def __hash__(self):
         return hash((self.__class__, self._pk))
 
     def __eq__(self, other):
         return (
             other.__class__ == self.__class__ and
@@ -6472,39 +6523,46 @@
         self.model = model
         super(ModelCompoundSelectQuery, self).__init__(*args, **kwargs)
 
     def _get_model_cursor_wrapper(self, cursor):
         return self.lhs._get_model_cursor_wrapper(cursor)
 
 
+def _normalize_model_select(fields_or_models):
+    fields = []
+    for fm in fields_or_models:
+        if is_model(fm):
+            fields.extend(fm._meta.sorted_fields)
+        elif isinstance(fm, ModelAlias):
+            fields.extend(fm.get_field_aliases())
+        elif isinstance(fm, Table) and fm._columns:
+            fields.extend([getattr(fm, col) for col in fm._columns])
+        else:
+            fields.append(fm)
+    return fields
+
+
 class ModelSelect(BaseModelSelect, Select):
     def __init__(self, model, fields_or_models, is_default=False):
         self.model = self._join_ctx = model
         self._joins = {}
         self._is_default = is_default
-        fields = []
-        for fm in fields_or_models:
-            if is_model(fm):
-                fields.extend(fm._meta.sorted_fields)
-            elif isinstance(fm, ModelAlias):
-                fields.extend(fm.get_field_aliases())
-            elif isinstance(fm, Table) and fm._columns:
-                fields.extend([getattr(fm, col) for col in fm._columns])
-            else:
-                fields.append(fm)
+        fields = _normalize_model_select(fields_or_models)
         super(ModelSelect, self).__init__([model], fields)
 
     def clone(self):
         clone = super(ModelSelect, self).clone()
         if clone._joins:
             clone._joins = dict(clone._joins)
         return clone
 
-    def select(self, *fields):
-        if fields or not self._is_default:
+    def select(self, *fields_or_models):
+        if fields_or_models or not self._is_default:
+            self._is_default = False
+            fields = _normalize_model_select(fields_or_models)
             return super(ModelSelect, self).select(*fields)
         return self
 
     def switch(self, ctx=None):
         self._join_ctx = self.model if ctx is None else ctx
         return self
 
@@ -6609,37 +6667,44 @@
             # other foreign-key fields from the list.
             target = (to_field.field if isinstance(to_field, FieldAlias)
                       else to_field)
             fk_fields = [f for f in fk_fields if (
                          (f is target) or
                          (is_backref and f.rel_field is to_field))]
 
-        if len(fk_fields) > 1:
-            if on is None:
-                raise ValueError('More than one foreign key between %s and %s.'
-                                 ' Please specify which you are joining on.' %
-                                 (src, dest))
-
-            # If there are multiple foreign-keys to choose from and the join
-            # predicate is an expression, we'll try to figure out which
-            # foreign-key field we're joining on so that we can assign to the
-            # correct attribute when resolving the model graph.
-            to_field = None
-            if isinstance(on, Expression):
-                lhs, rhs = on.lhs, on.rhs
+        if len(fk_fields) == 1:
+            return fk_fields[0], is_backref
+
+        if on is None:
+            raise ValueError('More than one foreign key between %s and %s.'
+                             ' Please specify which you are joining on.' %
+                             (src, dest))
+
+        # If there are multiple foreign-keys to choose from and the join
+        # predicate is an expression, we'll try to figure out which
+        # foreign-key field we're joining on so that we can assign to the
+        # correct attribute when resolving the model graph.
+        to_field = None
+        if isinstance(on, Expression):
+            lhs, rhs = on.lhs, on.rhs
+            # Coerce to set() so that we force Python to compare using the
+            # object's hash rather than equality test, which returns a
+            # false-positive due to overriding __eq__.
+            fk_set = set(fk_fields)
+
+            if isinstance(lhs, Field):
                 lhs_f = lhs.field if isinstance(lhs, FieldAlias) else lhs
-                rhs_f = rhs.field if isinstance(rhs, FieldAlias) else rhs
-                if lhs_f in fk_fields:
+                if lhs_f in fk_set:
                     to_field = lhs_f
-                elif rhs_f in fk_fields:
+            elif isinstance(rhs, Field):
+                rhs_f = rhs.field if isinstance(rhs, FieldAlias) else rhs
+                if rhs_f in fk_set:
                     to_field = rhs_f
 
-            return to_field, False
-        else:
-            return fk_fields[0], is_backref
+        return to_field, False
 
     @Node.copy
     def join(self, dest, join_type='INNER', on=None, src=None, attr=None):
         src = self._join_ctx if src is None else src
 
         if join_type != JOIN.CROSS:
             on, attr, constructor = self._normalize_join(src, dest, on, attr)
@@ -6742,14 +6807,17 @@
                 field_obj = field
             elif isinstance(field, BackrefAccessor):
                 lm, rm = field.model, field.rel_model
                 field_obj = field.field
             query = query.ensure_join(lm, rm, field_obj)
         return query.where(dq_node)
 
+    def create_table(self, name, safe=True, **meta):
+        return self.model._schema.create_table_as(name, self, safe, **meta)
+
     def __sql_selection__(self, ctx, is_subquery=False):
         if self._is_default and is_subquery and len(self._returning) > 1 and \
            self.model._meta.primary_key is not False:
             return ctx.sql(self.model._meta.primary_key)
 
         return ctx.sql(CommaNodeList(self._returning))
 
@@ -7046,14 +7114,23 @@
                 if key not in self.key_to_constructor:
                     self.key_to_constructor[key] = constructor
                     self.src_to_dest.append((curr, attr, key,
                                              isinstance(curr, dict)))
                     dests.add(key)
                     accum.append(key)
 
+        # Ensure that we accommodate everything selected.
+        for src in selected_src:
+            if src not in self.key_to_constructor:
+                if is_model(src):
+                    self.key_to_constructor[src] = src
+                elif isinstance(src, ModelAlias):
+                    self.key_to_constructor[src] = src.model
+
+        # Indicate which sources are also dests.
         for src, _, dest, _ in self.src_to_dest:
             self.src_is_dest[src] = src in dests and (dest in selected_src
                                                       or src in selected_src)
 
         self.column_keys = []
         for idx, node in enumerate(select):
             key = self.model
```

### Comparing `peewee-3.9.5/README.rst` & `peewee-3.9.6/README.rst`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/PKG-INFO` & `peewee-3.9.6/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 1.1
 Name: peewee
-Version: 3.9.5
+Version: 3.9.6
 Summary: a little orm
 Home-page: https://github.com/coleifer/peewee/
 Author: Charles Leifer
 Author-email: coleifer@gmail.com
 License: MIT License
 Description: .. image:: http://media.charlesleifer.com/blog/photos/peewee3-logo.png
```

### Comparing `peewee-3.9.5/LICENSE` & `peewee-3.9.6/LICENSE`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/CHANGELOG.md` & `peewee-3.9.6/CHANGELOG.md`

 * *Files 0% similar despite different names*

```diff
@@ -3,15 +3,32 @@
 Tracking changes in peewee between versions.  For a complete view of all the
 releases, visit GitHub:
 
 https://github.com/coleifer/peewee/releases
 
 ## master
 
-[View commits](https://github.com/coleifer/peewee/compare/3.9.5...master)
+[View commits](https://github.com/coleifer/peewee/compare/3.9.6...master)
+
+## 3.9.6
+
+* Support nesting the `Database` instance as a context-manager. The outermost
+  block will handle opening and closing the connection along with wrapping
+  everything in a transaction. Nested blocks will use savepoints.
+* Add new `session_start()`, `session_commit()` and `session_rollback()`
+  interfaces to the Database object to support using transactional controls in
+  situations where a context-manager or decorator is awkward.
+* Fix error that would arise when attempting to do an empty bulk-insert.
+* Set `isolation_level=None` in SQLite connection constructor rather than
+  afterwards using the setter.
+* Add `create_table()` method to `Select` query to implement `CREATE TABLE AS`.
+* Cleanup some declarations in the Sqlite C extension.
+* Add new example showing how to implement Reddit's ranking algorithm in SQL.
+
+[View commits](https://github.com/coleifer/peewee/compare/3.9.5...3.9.6)
 
 ## 3.9.5
 
 * Added small helper for setting timezone when using Postgres.
 * Improved SQL generation for `VALUES` clause.
 * Support passing resolution to `TimestampField` as a power-of-10.
 * Small improvements to `INSERT` queries when the primary-key is not an
```

### Comparing `peewee-3.9.5/peewee.egg-info/PKG-INFO` & `peewee-3.9.6/peewee.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 1.1
 Name: peewee
-Version: 3.9.5
+Version: 3.9.6
 Summary: a little orm
 Home-page: https://github.com/coleifer/peewee/
 Author: Charles Leifer
 Author-email: coleifer@gmail.com
 License: MIT License
 Description: .. image:: http://media.charlesleifer.com/blog/photos/peewee3-logo.png
```

### Comparing `peewee-3.9.5/docs/_static/peewee-white.png` & `peewee-3.9.6/docs/peewee-white.png`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/Makefile` & `peewee-3.9.6/docs/Makefile`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/make.bat` & `peewee-3.9.6/docs/make.bat`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/peewee3-logo.png` & `peewee-3.9.6/docs/peewee3-logo.png`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_themes/flask/relations.html` & `peewee-3.9.6/docs/_themes/flask/relations.html`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_themes/flask/layout.html` & `peewee-3.9.6/docs/_themes/flask/layout.html`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_themes/flask/static/flasky.css_t` & `peewee-3.9.6/docs/_themes/flask/static/flasky.css_t`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_themes/flask/static/small_flask.css` & `peewee-3.9.6/docs/_themes/flask/static/small_flask.css`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/mysql.png` & `peewee-3.9.6/docs/mysql.png`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/index.rst` & `peewee-3.9.6/docs/index.rst`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_build/html/_static/jquery.js` & `peewee-3.9.6/examples/blog/static/js/jquery-1.11.0.min.js`

 * *Files 8% similar despite different names*

#### js-beautify {}

```diff
@@ -1,502 +1,510 @@
-/*! jQuery v3.2.1 | (c) JS Foundation and other contributors | jquery.org/license */ ! function(a, b) {
-    "use strict";
+/*! jQuery v1.11.0 | (c) 2005, 2014 jQuery Foundation, Inc. | jquery.org/license */ ! function(a, b) {
     "object" == typeof module && "object" == typeof module.exports ? module.exports = a.document ? b(a, !0) : function(a) {
         if (!a.document) throw new Error("jQuery requires a window with a document");
         return b(a)
     } : b(a)
 }("undefined" != typeof window ? window : this, function(a, b) {
-    "use strict";
     var c = [],
-        d = a.document,
-        e = Object.getPrototypeOf,
-        f = c.slice,
-        g = c.concat,
-        h = c.push,
-        i = c.indexOf,
-        j = {},
-        k = j.toString,
-        l = j.hasOwnProperty,
-        m = l.toString,
-        n = m.call(Object),
-        o = {};
-
-    function p(a, b) {
-        b = b || d;
-        var c = b.createElement("script");
-        c.text = a, b.head.appendChild(c).parentNode.removeChild(c)
-    }
-    var q = "3.2.1",
+        d = c.slice,
+        e = c.concat,
+        f = c.push,
+        g = c.indexOf,
+        h = {},
+        i = h.toString,
+        j = h.hasOwnProperty,
+        k = "".trim,
+        l = {},
+        m = "1.11.0",
+        n = function(a, b) {
+            return new n.fn.init(a, b)
+        },
+        o = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
+        p = /^-ms-/,
+        q = /-([\da-z])/gi,
         r = function(a, b) {
-            return new r.fn.init(a, b)
-        },
-        s = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
-        t = /^-ms-/,
-        u = /-([a-z])/g,
-        v = function(a, b) {
             return b.toUpperCase()
         };
-    r.fn = r.prototype = {
-        jquery: q,
-        constructor: r,
+    n.fn = n.prototype = {
+        jquery: m,
+        constructor: n,
+        selector: "",
         length: 0,
         toArray: function() {
-            return f.call(this)
+            return d.call(this)
         },
         get: function(a) {
-            return null == a ? f.call(this) : a < 0 ? this[a + this.length] : this[a]
+            return null != a ? 0 > a ? this[a + this.length] : this[a] : d.call(this)
         },
         pushStack: function(a) {
-            var b = r.merge(this.constructor(), a);
-            return b.prevObject = this, b
+            var b = n.merge(this.constructor(), a);
+            return b.prevObject = this, b.context = this.context, b
         },
-        each: function(a) {
-            return r.each(this, a)
+        each: function(a, b) {
+            return n.each(this, a, b)
         },
         map: function(a) {
-            return this.pushStack(r.map(this, function(b, c) {
+            return this.pushStack(n.map(this, function(b, c) {
                 return a.call(b, c, b)
             }))
         },
         slice: function() {
-            return this.pushStack(f.apply(this, arguments))
+            return this.pushStack(d.apply(this, arguments))
         },
         first: function() {
             return this.eq(0)
         },
         last: function() {
             return this.eq(-1)
         },
         eq: function(a) {
             var b = this.length,
-                c = +a + (a < 0 ? b : 0);
-            return this.pushStack(c >= 0 && c < b ? [this[c]] : [])
+                c = +a + (0 > a ? b : 0);
+            return this.pushStack(c >= 0 && b > c ? [this[c]] : [])
         },
         end: function() {
-            return this.prevObject || this.constructor()
+            return this.prevObject || this.constructor(null)
         },
-        push: h,
+        push: f,
         sort: c.sort,
         splice: c.splice
-    }, r.extend = r.fn.extend = function() {
+    }, n.extend = n.fn.extend = function() {
         var a, b, c, d, e, f, g = arguments[0] || {},
             h = 1,
             i = arguments.length,
             j = !1;
-        for ("boolean" == typeof g && (j = g, g = arguments[h] || {}, h++), "object" == typeof g || r.isFunction(g) || (g = {}), h === i && (g = this, h--); h < i; h++)
-            if (null != (a = arguments[h]))
-                for (b in a) c = g[b], d = a[b], g !== d && (j && d && (r.isPlainObject(d) || (e = Array.isArray(d))) ? (e ? (e = !1, f = c && Array.isArray(c) ? c : []) : f = c && r.isPlainObject(c) ? c : {}, g[b] = r.extend(j, f, d)) : void 0 !== d && (g[b] = d));
+        for ("boolean" == typeof g && (j = g, g = arguments[h] || {}, h++), "object" == typeof g || n.isFunction(g) || (g = {}), h === i && (g = this, h--); i > h; h++)
+            if (null != (e = arguments[h]))
+                for (d in e) a = g[d], c = e[d], g !== c && (j && c && (n.isPlainObject(c) || (b = n.isArray(c))) ? (b ? (b = !1, f = a && n.isArray(a) ? a : []) : f = a && n.isPlainObject(a) ? a : {}, g[d] = n.extend(j, f, c)) : void 0 !== c && (g[d] = c));
         return g
-    }, r.extend({
-        expando: "jQuery" + (q + Math.random()).replace(/\D/g, ""),
+    }, n.extend({
+        expando: "jQuery" + (m + Math.random()).replace(/\D/g, ""),
         isReady: !0,
         error: function(a) {
             throw new Error(a)
         },
         noop: function() {},
         isFunction: function(a) {
-            return "function" === r.type(a)
+            return "function" === n.type(a)
+        },
+        isArray: Array.isArray || function(a) {
+            return "array" === n.type(a)
         },
         isWindow: function(a) {
-            return null != a && a === a.window
+            return null != a && a == a.window
         },
         isNumeric: function(a) {
-            var b = r.type(a);
-            return ("number" === b || "string" === b) && !isNaN(a - parseFloat(a))
-        },
-        isPlainObject: function(a) {
-            var b, c;
-            return !(!a || "[object Object]" !== k.call(a)) && (!(b = e(a)) || (c = l.call(b, "constructor") && b.constructor, "function" == typeof c && m.call(c) === n))
+            return a - parseFloat(a) >= 0
         },
         isEmptyObject: function(a) {
             var b;
             for (b in a) return !1;
             return !0
         },
+        isPlainObject: function(a) {
+            var b;
+            if (!a || "object" !== n.type(a) || a.nodeType || n.isWindow(a)) return !1;
+            try {
+                if (a.constructor && !j.call(a, "constructor") && !j.call(a.constructor.prototype, "isPrototypeOf")) return !1
+            } catch (c) {
+                return !1
+            }
+            if (l.ownLast)
+                for (b in a) return j.call(a, b);
+            for (b in a);
+            return void 0 === b || j.call(a, b)
+        },
         type: function(a) {
-            return null == a ? a + "" : "object" == typeof a || "function" == typeof a ? j[k.call(a)] || "object" : typeof a
+            return null == a ? a + "" : "object" == typeof a || "function" == typeof a ? h[i.call(a)] || "object" : typeof a
         },
-        globalEval: function(a) {
-            p(a)
+        globalEval: function(b) {
+            b && n.trim(b) && (a.execScript || function(b) {
+                a.eval.call(a, b)
+            })(b)
         },
         camelCase: function(a) {
-            return a.replace(t, "ms-").replace(u, v)
+            return a.replace(p, "ms-").replace(q, r)
         },
-        each: function(a, b) {
-            var c, d = 0;
-            if (w(a)) {
-                for (c = a.length; d < c; d++)
-                    if (b.call(a[d], d, a[d]) === !1) break
+        nodeName: function(a, b) {
+            return a.nodeName && a.nodeName.toLowerCase() === b.toLowerCase()
+        },
+        each: function(a, b, c) {
+            var d, e = 0,
+                f = a.length,
+                g = s(a);
+            if (c) {
+                if (g) {
+                    for (; f > e; e++)
+                        if (d = b.apply(a[e], c), d === !1) break
+                } else
+                    for (e in a)
+                        if (d = b.apply(a[e], c), d === !1) break
+            } else if (g) {
+                for (; f > e; e++)
+                    if (d = b.call(a[e], e, a[e]), d === !1) break
             } else
-                for (d in a)
-                    if (b.call(a[d], d, a[d]) === !1) break;
+                for (e in a)
+                    if (d = b.call(a[e], e, a[e]), d === !1) break;
             return a
         },
-        trim: function(a) {
-            return null == a ? "" : (a + "").replace(s, "")
+        trim: k && !k.call("\ufeff\xa0") ? function(a) {
+            return null == a ? "" : k.call(a)
+        } : function(a) {
+            return null == a ? "" : (a + "").replace(o, "")
         },
         makeArray: function(a, b) {
             var c = b || [];
-            return null != a && (w(Object(a)) ? r.merge(c, "string" == typeof a ? [a] : a) : h.call(c, a)), c
+            return null != a && (s(Object(a)) ? n.merge(c, "string" == typeof a ? [a] : a) : f.call(c, a)), c
         },
         inArray: function(a, b, c) {
-            return null == b ? -1 : i.call(b, a, c)
+            var d;
+            if (b) {
+                if (g) return g.call(b, a, c);
+                for (d = b.length, c = c ? 0 > c ? Math.max(0, d + c) : c : 0; d > c; c++)
+                    if (c in b && b[c] === a) return c
+            }
+            return -1
         },
         merge: function(a, b) {
-            for (var c = +b.length, d = 0, e = a.length; d < c; d++) a[e++] = b[d];
+            var c = +b.length,
+                d = 0,
+                e = a.length;
+            while (c > d) a[e++] = b[d++];
+            if (c !== c)
+                while (void 0 !== b[d]) a[e++] = b[d++];
             return a.length = e, a
         },
         grep: function(a, b, c) {
-            for (var d, e = [], f = 0, g = a.length, h = !c; f < g; f++) d = !b(a[f], f), d !== h && e.push(a[f]);
+            for (var d, e = [], f = 0, g = a.length, h = !c; g > f; f++) d = !b(a[f], f), d !== h && e.push(a[f]);
             return e
         },
         map: function(a, b, c) {
-            var d, e, f = 0,
-                h = [];
-            if (w(a))
-                for (d = a.length; f < d; f++) e = b(a[f], f, c), null != e && h.push(e);
+            var d, f = 0,
+                g = a.length,
+                h = s(a),
+                i = [];
+            if (h)
+                for (; g > f; f++) d = b(a[f], f, c), null != d && i.push(d);
             else
-                for (f in a) e = b(a[f], f, c), null != e && h.push(e);
-            return g.apply([], h)
+                for (f in a) d = b(a[f], f, c), null != d && i.push(d);
+            return e.apply([], i)
         },
         guid: 1,
         proxy: function(a, b) {
-            var c, d, e;
-            if ("string" == typeof b && (c = a[b], b = a, a = c), r.isFunction(a)) return d = f.call(arguments, 2), e = function() {
-                return a.apply(b || this, d.concat(f.call(arguments)))
-            }, e.guid = a.guid = a.guid || r.guid++, e
-        },
-        now: Date.now,
-        support: o
-    }), "function" == typeof Symbol && (r.fn[Symbol.iterator] = c[Symbol.iterator]), r.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "), function(a, b) {
-        j["[object " + b + "]"] = b.toLowerCase()
+            var c, e, f;
+            return "string" == typeof b && (f = a[b], b = a, a = f), n.isFunction(a) ? (c = d.call(arguments, 2), e = function() {
+                return a.apply(b || this, c.concat(d.call(arguments)))
+            }, e.guid = a.guid = a.guid || n.guid++, e) : void 0
+        },
+        now: function() {
+            return +new Date
+        },
+        support: l
+    }), n.each("Boolean Number String Function Array Date RegExp Object Error".split(" "), function(a, b) {
+        h["[object " + b + "]"] = b.toLowerCase()
     });
 
-    function w(a) {
-        var b = !!a && "length" in a && a.length,
-            c = r.type(a);
-        return "function" !== c && !r.isWindow(a) && ("array" === c || 0 === b || "number" == typeof b && b > 0 && b - 1 in a)
-    }
-    var x = function(a) {
-        var b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u = "sizzle" + 1 * new Date,
-            v = a.document,
-            w = 0,
-            x = 0,
-            y = ha(),
-            z = ha(),
-            A = ha(),
-            B = function(a, b) {
-                return a === b && (l = !0), 0
+    function s(a) {
+        var b = a.length,
+            c = n.type(a);
+        return "function" === c || n.isWindow(a) ? !1 : 1 === a.nodeType && b ? !0 : "array" === c || 0 === b || "number" == typeof b && b > 0 && b - 1 in a
+    }
+    var t = function(a) {
+        var b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s = "sizzle" + -new Date,
+            t = a.document,
+            u = 0,
+            v = 0,
+            w = eb(),
+            x = eb(),
+            y = eb(),
+            z = function(a, b) {
+                return a === b && (j = !0), 0
             },
+            A = "undefined",
+            B = 1 << 31,
             C = {}.hasOwnProperty,
             D = [],
             E = D.pop,
             F = D.push,
             G = D.push,
             H = D.slice,
-            I = function(a, b) {
-                for (var c = 0, d = a.length; c < d; c++)
-                    if (a[c] === b) return c;
+            I = D.indexOf || function(a) {
+                for (var b = 0, c = this.length; c > b; b++)
+                    if (this[b] === a) return b;
                 return -1
             },
             J = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",
             K = "[\\x20\\t\\r\\n\\f]",
-            L = "(?:\\\\.|[\\w-]|[^\0-\\xa0])+",
-            M = "\\[" + K + "*(" + L + ")(?:" + K + "*([*^$|!~]?=)" + K + "*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + L + "))|)" + K + "*\\]",
-            N = ":(" + L + ")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|" + M + ")*)|.*)\\)|)",
-            O = new RegExp(K + "+", "g"),
+            L = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",
+            M = L.replace("w", "w#"),
+            N = "\\[" + K + "*(" + L + ")" + K + "*(?:([*^$|!~]?=)" + K + "*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|(" + M + ")|)|)" + K + "*\\]",
+            O = ":(" + L + ")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|" + N.replace(3, 8) + ")*)|.*)\\)|)",
             P = new RegExp("^" + K + "+|((?:^|[^\\\\])(?:\\\\.)*)" + K + "+$", "g"),
             Q = new RegExp("^" + K + "*," + K + "*"),
             R = new RegExp("^" + K + "*([>+~]|" + K + ")" + K + "*"),
             S = new RegExp("=" + K + "*([^\\]'\"]*?)" + K + "*\\]", "g"),
-            T = new RegExp(N),
-            U = new RegExp("^" + L + "$"),
+            T = new RegExp(O),
+            U = new RegExp("^" + M + "$"),
             V = {
                 ID: new RegExp("^#(" + L + ")"),
                 CLASS: new RegExp("^\\.(" + L + ")"),
-                TAG: new RegExp("^(" + L + "|[*])"),
-                ATTR: new RegExp("^" + M),
-                PSEUDO: new RegExp("^" + N),
+                TAG: new RegExp("^(" + L.replace("w", "w*") + ")"),
+                ATTR: new RegExp("^" + N),
+                PSEUDO: new RegExp("^" + O),
                 CHILD: new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + K + "*(even|odd|(([+-]|)(\\d*)n|)" + K + "*(?:([+-]|)" + K + "*(\\d+)|))" + K + "*\\)|)", "i"),
                 bool: new RegExp("^(?:" + J + ")$", "i"),
                 needsContext: new RegExp("^" + K + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + K + "*((?:-\\d)?\\d*)" + K + "*\\)|)(?=[^-]|$)", "i")
             },
             W = /^(?:input|select|textarea|button)$/i,
             X = /^h\d$/i,
             Y = /^[^{]+\{\s*\[native \w/,
             Z = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,
             $ = /[+~]/,
-            _ = new RegExp("\\\\([\\da-f]{1,6}" + K + "?|(" + K + ")|.)", "ig"),
-            aa = function(a, b, c) {
+            _ = /'|\\/g,
+            ab = new RegExp("\\\\([\\da-f]{1,6}" + K + "?|(" + K + ")|.)", "ig"),
+            bb = function(a, b, c) {
                 var d = "0x" + b - 65536;
-                return d !== d || c ? b : d < 0 ? String.fromCharCode(d + 65536) : String.fromCharCode(d >> 10 | 55296, 1023 & d | 56320)
-            },
-            ba = /([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,
-            ca = function(a, b) {
-                return b ? "\0" === a ? "\ufffd" : a.slice(0, -1) + "\\" + a.charCodeAt(a.length - 1).toString(16) + " " : "\\" + a
-            },
-            da = function() {
-                m()
-            },
-            ea = ta(function(a) {
-                return a.disabled === !0 && ("form" in a || "label" in a)
-            }, {
-                dir: "parentNode",
-                next: "legend"
-            });
+                return d !== d || c ? b : 0 > d ? String.fromCharCode(d + 65536) : String.fromCharCode(d >> 10 | 55296, 1023 & d | 56320)
+            };
         try {
-            G.apply(D = H.call(v.childNodes), v.childNodes), D[v.childNodes.length].nodeType
-        } catch (fa) {
+            G.apply(D = H.call(t.childNodes), t.childNodes), D[t.childNodes.length].nodeType
+        } catch (cb) {
             G = {
                 apply: D.length ? function(a, b) {
                     F.apply(a, H.call(b))
                 } : function(a, b) {
                     var c = a.length,
                         d = 0;
                     while (a[c++] = b[d++]);
                     a.length = c - 1
                 }
             }
         }
 
-        function ga(a, b, d, e) {
-            var f, h, j, k, l, o, r, s = b && b.ownerDocument,
-                w = b ? b.nodeType : 9;
-            if (d = d || [], "string" != typeof a || !a || 1 !== w && 9 !== w && 11 !== w) return d;
-            if (!e && ((b ? b.ownerDocument || b : v) !== n && m(b), b = b || n, p)) {
-                if (11 !== w && (l = Z.exec(a)))
-                    if (f = l[1]) {
-                        if (9 === w) {
-                            if (!(j = b.getElementById(f))) return d;
-                            if (j.id === f) return d.push(j), d
-                        } else if (s && (j = s.getElementById(f)) && t(b, j) && j.id === f) return d.push(j), d
+        function db(a, b, d, e) {
+            var f, g, h, i, j, m, p, q, u, v;
+            if ((b ? b.ownerDocument || b : t) !== l && k(b), b = b || l, d = d || [], !a || "string" != typeof a) return d;
+            if (1 !== (i = b.nodeType) && 9 !== i) return [];
+            if (n && !e) {
+                if (f = Z.exec(a))
+                    if (h = f[1]) {
+                        if (9 === i) {
+                            if (g = b.getElementById(h), !g || !g.parentNode) return d;
+                            if (g.id === h) return d.push(g), d
+                        } else if (b.ownerDocument && (g = b.ownerDocument.getElementById(h)) && r(b, g) && g.id === h) return d.push(g), d
                     } else {
-                        if (l[2]) return G.apply(d, b.getElementsByTagName(a)), d;
-                        if ((f = l[3]) && c.getElementsByClassName && b.getElementsByClassName) return G.apply(d, b.getElementsByClassName(f)), d
-                    } if (c.qsa && !A[a + " "] && (!q || !q.test(a))) {
-                    if (1 !== w) s = b, r = a;
-                    else if ("object" !== b.nodeName.toLowerCase()) {
-                        (k = b.getAttribute("id")) ? k = k.replace(ba, ca): b.setAttribute("id", k = u), o = g(a), h = o.length;
-                        while (h--) o[h] = "#" + k + " " + sa(o[h]);
-                        r = o.join(","), s = $.test(a) && qa(b.parentNode) || b
+                        if (f[2]) return G.apply(d, b.getElementsByTagName(a)), d;
+                        if ((h = f[3]) && c.getElementsByClassName && b.getElementsByClassName) return G.apply(d, b.getElementsByClassName(h)), d
+                    } if (c.qsa && (!o || !o.test(a))) {
+                    if (q = p = s, u = b, v = 9 === i && a, 1 === i && "object" !== b.nodeName.toLowerCase()) {
+                        m = ob(a), (p = b.getAttribute("id")) ? q = p.replace(_, "\\$&") : b.setAttribute("id", q), q = "[id='" + q + "'] ", j = m.length;
+                        while (j--) m[j] = q + pb(m[j]);
+                        u = $.test(a) && mb(b.parentNode) || b, v = m.join(",")
                     }
-                    if (r) try {
-                        return G.apply(d, s.querySelectorAll(r)), d
-                    } catch (x) {} finally {
-                        k === u && b.removeAttribute("id")
+                    if (v) try {
+                        return G.apply(d, u.querySelectorAll(v)), d
+                    } catch (w) {} finally {
+                        p || b.removeAttribute("id")
                     }
                 }
             }
-            return i(a.replace(P, "$1"), b, d, e)
+            return xb(a.replace(P, "$1"), b, d, e)
         }
 
-        function ha() {
+        function eb() {
             var a = [];
 
             function b(c, e) {
                 return a.push(c + " ") > d.cacheLength && delete b[a.shift()], b[c + " "] = e
             }
             return b
         }
 
-        function ia(a) {
-            return a[u] = !0, a
+        function fb(a) {
+            return a[s] = !0, a
         }
 
-        function ja(a) {
-            var b = n.createElement("fieldset");
+        function gb(a) {
+            var b = l.createElement("div");
             try {
                 return !!a(b)
             } catch (c) {
                 return !1
             } finally {
                 b.parentNode && b.parentNode.removeChild(b), b = null
             }
         }
 
-        function ka(a, b) {
+        function hb(a, b) {
             var c = a.split("|"),
-                e = c.length;
+                e = a.length;
             while (e--) d.attrHandle[c[e]] = b
         }
 
-        function la(a, b) {
+        function ib(a, b) {
             var c = b && a,
-                d = c && 1 === a.nodeType && 1 === b.nodeType && a.sourceIndex - b.sourceIndex;
+                d = c && 1 === a.nodeType && 1 === b.nodeType && (~b.sourceIndex || B) - (~a.sourceIndex || B);
             if (d) return d;
             if (c)
                 while (c = c.nextSibling)
                     if (c === b) return -1;
             return a ? 1 : -1
         }
 
-        function ma(a) {
+        function jb(a) {
             return function(b) {
                 var c = b.nodeName.toLowerCase();
                 return "input" === c && b.type === a
             }
         }
 
-        function na(a) {
+        function kb(a) {
             return function(b) {
                 var c = b.nodeName.toLowerCase();
                 return ("input" === c || "button" === c) && b.type === a
             }
         }
 
-        function oa(a) {
-            return function(b) {
-                return "form" in b ? b.parentNode && b.disabled === !1 ? "label" in b ? "label" in b.parentNode ? b.parentNode.disabled === a : b.disabled === a : b.isDisabled === a || b.isDisabled !== !a && ea(b) === a : b.disabled === a : "label" in b && b.disabled === a
-            }
-        }
-
-        function pa(a) {
-            return ia(function(b) {
-                return b = +b, ia(function(c, d) {
+        function lb(a) {
+            return fb(function(b) {
+                return b = +b, fb(function(c, d) {
                     var e, f = a([], c.length, b),
                         g = f.length;
                     while (g--) c[e = f[g]] && (c[e] = !(d[e] = c[e]))
                 })
             })
         }
 
-        function qa(a) {
-            return a && "undefined" != typeof a.getElementsByTagName && a
+        function mb(a) {
+            return a && typeof a.getElementsByTagName !== A && a
         }
-        c = ga.support = {}, f = ga.isXML = function(a) {
+        c = db.support = {}, f = db.isXML = function(a) {
             var b = a && (a.ownerDocument || a).documentElement;
-            return !!b && "HTML" !== b.nodeName
-        }, m = ga.setDocument = function(a) {
-            var b, e, g = a ? a.ownerDocument || a : v;
-            return g !== n && 9 === g.nodeType && g.documentElement ? (n = g, o = n.documentElement, p = !f(n), v !== n && (e = n.defaultView) && e.top !== e && (e.addEventListener ? e.addEventListener("unload", da, !1) : e.attachEvent && e.attachEvent("onunload", da)), c.attributes = ja(function(a) {
+            return b ? "HTML" !== b.nodeName : !1
+        }, k = db.setDocument = function(a) {
+            var b, e = a ? a.ownerDocument || a : t,
+                g = e.defaultView;
+            return e !== l && 9 === e.nodeType && e.documentElement ? (l = e, m = e.documentElement, n = !f(e), g && g !== g.top && (g.addEventListener ? g.addEventListener("unload", function() {
+                k()
+            }, !1) : g.attachEvent && g.attachEvent("onunload", function() {
+                k()
+            })), c.attributes = gb(function(a) {
                 return a.className = "i", !a.getAttribute("className")
-            }), c.getElementsByTagName = ja(function(a) {
-                return a.appendChild(n.createComment("")), !a.getElementsByTagName("*").length
-            }), c.getElementsByClassName = Y.test(n.getElementsByClassName), c.getById = ja(function(a) {
-                return o.appendChild(a).id = u, !n.getElementsByName || !n.getElementsByName(u).length
-            }), c.getById ? (d.filter.ID = function(a) {
-                var b = a.replace(_, aa);
+            }), c.getElementsByTagName = gb(function(a) {
+                return a.appendChild(e.createComment("")), !a.getElementsByTagName("*").length
+            }), c.getElementsByClassName = Y.test(e.getElementsByClassName) && gb(function(a) {
+                return a.innerHTML = "<div class='a'></div><div class='a i'></div>", a.firstChild.className = "i", 2 === a.getElementsByClassName("i").length
+            }), c.getById = gb(function(a) {
+                return m.appendChild(a).id = s, !e.getElementsByName || !e.getElementsByName(s).length
+            }), c.getById ? (d.find.ID = function(a, b) {
+                if (typeof b.getElementById !== A && n) {
+                    var c = b.getElementById(a);
+                    return c && c.parentNode ? [c] : []
+                }
+            }, d.filter.ID = function(a) {
+                var b = a.replace(ab, bb);
                 return function(a) {
                     return a.getAttribute("id") === b
                 }
-            }, d.find.ID = function(a, b) {
-                if ("undefined" != typeof b.getElementById && p) {
-                    var c = b.getElementById(a);
-                    return c ? [c] : []
-                }
-            }) : (d.filter.ID = function(a) {
-                var b = a.replace(_, aa);
+            }) : (delete d.find.ID, d.filter.ID = function(a) {
+                var b = a.replace(ab, bb);
                 return function(a) {
-                    var c = "undefined" != typeof a.getAttributeNode && a.getAttributeNode("id");
+                    var c = typeof a.getAttributeNode !== A && a.getAttributeNode("id");
                     return c && c.value === b
                 }
-            }, d.find.ID = function(a, b) {
-                if ("undefined" != typeof b.getElementById && p) {
-                    var c, d, e, f = b.getElementById(a);
-                    if (f) {
-                        if (c = f.getAttributeNode("id"), c && c.value === a) return [f];
-                        e = b.getElementsByName(a), d = 0;
-                        while (f = e[d++])
-                            if (c = f.getAttributeNode("id"), c && c.value === a) return [f]
-                    }
-                    return []
-                }
             }), d.find.TAG = c.getElementsByTagName ? function(a, b) {
-                return "undefined" != typeof b.getElementsByTagName ? b.getElementsByTagName(a) : c.qsa ? b.querySelectorAll(a) : void 0
+                return typeof b.getElementsByTagName !== A ? b.getElementsByTagName(a) : void 0
             } : function(a, b) {
                 var c, d = [],
                     e = 0,
                     f = b.getElementsByTagName(a);
                 if ("*" === a) {
                     while (c = f[e++]) 1 === c.nodeType && d.push(c);
                     return d
                 }
                 return f
             }, d.find.CLASS = c.getElementsByClassName && function(a, b) {
-                if ("undefined" != typeof b.getElementsByClassName && p) return b.getElementsByClassName(a)
-            }, r = [], q = [], (c.qsa = Y.test(n.querySelectorAll)) && (ja(function(a) {
-                o.appendChild(a).innerHTML = "<a id='" + u + "'></a><select id='" + u + "-\r\\' msallowcapture=''><option selected=''></option></select>", a.querySelectorAll("[msallowcapture^='']").length && q.push("[*^$]=" + K + "*(?:''|\"\")"), a.querySelectorAll("[selected]").length || q.push("\\[" + K + "*(?:value|" + J + ")"), a.querySelectorAll("[id~=" + u + "-]").length || q.push("~="), a.querySelectorAll(":checked").length || q.push(":checked"), a.querySelectorAll("a#" + u + "+*").length || q.push(".#.+[+~]")
-            }), ja(function(a) {
-                a.innerHTML = "<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";
-                var b = n.createElement("input");
-                b.setAttribute("type", "hidden"), a.appendChild(b).setAttribute("name", "D"), a.querySelectorAll("[name=d]").length && q.push("name" + K + "*[*^$|!~]?="), 2 !== a.querySelectorAll(":enabled").length && q.push(":enabled", ":disabled"), o.appendChild(a).disabled = !0, 2 !== a.querySelectorAll(":disabled").length && q.push(":enabled", ":disabled"), a.querySelectorAll("*,:x"), q.push(",.*:")
-            })), (c.matchesSelector = Y.test(s = o.matches || o.webkitMatchesSelector || o.mozMatchesSelector || o.oMatchesSelector || o.msMatchesSelector)) && ja(function(a) {
-                c.disconnectedMatch = s.call(a, "*"), s.call(a, "[s!='']:x"), r.push("!=", N)
-            }), q = q.length && new RegExp(q.join("|")), r = r.length && new RegExp(r.join("|")), b = Y.test(o.compareDocumentPosition), t = b || Y.test(o.contains) ? function(a, b) {
+                return typeof b.getElementsByClassName !== A && n ? b.getElementsByClassName(a) : void 0
+            }, p = [], o = [], (c.qsa = Y.test(e.querySelectorAll)) && (gb(function(a) {
+                a.innerHTML = "<select t=''><option selected=''></option></select>", a.querySelectorAll("[t^='']").length && o.push("[*^$]=" + K + "*(?:''|\"\")"), a.querySelectorAll("[selected]").length || o.push("\\[" + K + "*(?:value|" + J + ")"), a.querySelectorAll(":checked").length || o.push(":checked")
+            }), gb(function(a) {
+                var b = e.createElement("input");
+                b.setAttribute("type", "hidden"), a.appendChild(b).setAttribute("name", "D"), a.querySelectorAll("[name=d]").length && o.push("name" + K + "*[*^$|!~]?="), a.querySelectorAll(":enabled").length || o.push(":enabled", ":disabled"), a.querySelectorAll("*,:x"), o.push(",.*:")
+            })), (c.matchesSelector = Y.test(q = m.webkitMatchesSelector || m.mozMatchesSelector || m.oMatchesSelector || m.msMatchesSelector)) && gb(function(a) {
+                c.disconnectedMatch = q.call(a, "div"), q.call(a, "[s!='']:x"), p.push("!=", O)
+            }), o = o.length && new RegExp(o.join("|")), p = p.length && new RegExp(p.join("|")), b = Y.test(m.compareDocumentPosition), r = b || Y.test(m.contains) ? function(a, b) {
                 var c = 9 === a.nodeType ? a.documentElement : a,
                     d = b && b.parentNode;
                 return a === d || !(!d || 1 !== d.nodeType || !(c.contains ? c.contains(d) : a.compareDocumentPosition && 16 & a.compareDocumentPosition(d)))
             } : function(a, b) {
                 if (b)
                     while (b = b.parentNode)
                         if (b === a) return !0;
                 return !1
-            }, B = b ? function(a, b) {
-                if (a === b) return l = !0, 0;
+            }, z = b ? function(a, b) {
+                if (a === b) return j = !0, 0;
                 var d = !a.compareDocumentPosition - !b.compareDocumentPosition;
-                return d ? d : (d = (a.ownerDocument || a) === (b.ownerDocument || b) ? a.compareDocumentPosition(b) : 1, 1 & d || !c.sortDetached && b.compareDocumentPosition(a) === d ? a === n || a.ownerDocument === v && t(v, a) ? -1 : b === n || b.ownerDocument === v && t(v, b) ? 1 : k ? I(k, a) - I(k, b) : 0 : 4 & d ? -1 : 1)
+                return d ? d : (d = (a.ownerDocument || a) === (b.ownerDocument || b) ? a.compareDocumentPosition(b) : 1, 1 & d || !c.sortDetached && b.compareDocumentPosition(a) === d ? a === e || a.ownerDocument === t && r(t, a) ? -1 : b === e || b.ownerDocument === t && r(t, b) ? 1 : i ? I.call(i, a) - I.call(i, b) : 0 : 4 & d ? -1 : 1)
             } : function(a, b) {
-                if (a === b) return l = !0, 0;
+                if (a === b) return j = !0, 0;
                 var c, d = 0,
-                    e = a.parentNode,
-                    f = b.parentNode,
-                    g = [a],
-                    h = [b];
-                if (!e || !f) return a === n ? -1 : b === n ? 1 : e ? -1 : f ? 1 : k ? I(k, a) - I(k, b) : 0;
-                if (e === f) return la(a, b);
+                    f = a.parentNode,
+                    g = b.parentNode,
+                    h = [a],
+                    k = [b];
+                if (!f || !g) return a === e ? -1 : b === e ? 1 : f ? -1 : g ? 1 : i ? I.call(i, a) - I.call(i, b) : 0;
+                if (f === g) return ib(a, b);
                 c = a;
-                while (c = c.parentNode) g.unshift(c);
-                c = b;
                 while (c = c.parentNode) h.unshift(c);
-                while (g[d] === h[d]) d++;
-                return d ? la(g[d], h[d]) : g[d] === v ? -1 : h[d] === v ? 1 : 0
-            }, n) : n
-        }, ga.matches = function(a, b) {
-            return ga(a, null, null, b)
-        }, ga.matchesSelector = function(a, b) {
-            if ((a.ownerDocument || a) !== n && m(a), b = b.replace(S, "='$1']"), c.matchesSelector && p && !A[b + " "] && (!r || !r.test(b)) && (!q || !q.test(b))) try {
-                var d = s.call(a, b);
+                c = b;
+                while (c = c.parentNode) k.unshift(c);
+                while (h[d] === k[d]) d++;
+                return d ? ib(h[d], k[d]) : h[d] === t ? -1 : k[d] === t ? 1 : 0
+            }, e) : l
+        }, db.matches = function(a, b) {
+            return db(a, null, null, b)
+        }, db.matchesSelector = function(a, b) {
+            if ((a.ownerDocument || a) !== l && k(a), b = b.replace(S, "='$1']"), !(!c.matchesSelector || !n || p && p.test(b) || o && o.test(b))) try {
+                var d = q.call(a, b);
                 if (d || c.disconnectedMatch || a.document && 11 !== a.document.nodeType) return d
             } catch (e) {}
-            return ga(b, n, null, [a]).length > 0
-        }, ga.contains = function(a, b) {
-            return (a.ownerDocument || a) !== n && m(a), t(a, b)
-        }, ga.attr = function(a, b) {
-            (a.ownerDocument || a) !== n && m(a);
+            return db(b, l, null, [a]).length > 0
+        }, db.contains = function(a, b) {
+            return (a.ownerDocument || a) !== l && k(a), r(a, b)
+        }, db.attr = function(a, b) {
+            (a.ownerDocument || a) !== l && k(a);
             var e = d.attrHandle[b.toLowerCase()],
-                f = e && C.call(d.attrHandle, b.toLowerCase()) ? e(a, b, !p) : void 0;
-            return void 0 !== f ? f : c.attributes || !p ? a.getAttribute(b) : (f = a.getAttributeNode(b)) && f.specified ? f.value : null
-        }, ga.escape = function(a) {
-            return (a + "").replace(ba, ca)
-        }, ga.error = function(a) {
+                f = e && C.call(d.attrHandle, b.toLowerCase()) ? e(a, b, !n) : void 0;
+            return void 0 !== f ? f : c.attributes || !n ? a.getAttribute(b) : (f = a.getAttributeNode(b)) && f.specified ? f.value : null
+        }, db.error = function(a) {
             throw new Error("Syntax error, unrecognized expression: " + a)
-        }, ga.uniqueSort = function(a) {
+        }, db.uniqueSort = function(a) {
             var b, d = [],
                 e = 0,
                 f = 0;
-            if (l = !c.detectDuplicates, k = !c.sortStable && a.slice(0), a.sort(B), l) {
+            if (j = !c.detectDuplicates, i = !c.sortStable && a.slice(0), a.sort(z), j) {
                 while (b = a[f++]) b === a[f] && (e = d.push(f));
                 while (e--) a.splice(d[e], 1)
             }
-            return k = null, a
-        }, e = ga.getText = function(a) {
+            return i = null, a
+        }, e = db.getText = function(a) {
             var b, c = "",
                 d = 0,
                 f = a.nodeType;
             if (f) {
                 if (1 === f || 9 === f || 11 === f) {
                     if ("string" == typeof a.textContent) return a.textContent;
                     for (a = a.firstChild; a; a = a.nextSibling) c += e(a)
                 } else if (3 === f || 4 === f) return a.nodeValue
             } else
                 while (b = a[d++]) c += e(b);
             return c
-        }, d = ga.selectors = {
+        }, d = db.selectors = {
             cacheLength: 50,
-            createPseudo: ia,
+            createPseudo: fb,
             match: V,
             attrHandle: {},
             find: {},
             relative: {
                 ">": {
                     dir: "parentNode",
                     first: !0
@@ -510,137 +518,140 @@
                 },
                 "~": {
                     dir: "previousSibling"
                 }
             },
             preFilter: {
                 ATTR: function(a) {
-                    return a[1] = a[1].replace(_, aa), a[3] = (a[3] || a[4] || a[5] || "").replace(_, aa), "~=" === a[2] && (a[3] = " " + a[3] + " "), a.slice(0, 4)
+                    return a[1] = a[1].replace(ab, bb), a[3] = (a[4] || a[5] || "").replace(ab, bb), "~=" === a[2] && (a[3] = " " + a[3] + " "), a.slice(0, 4)
                 },
                 CHILD: function(a) {
-                    return a[1] = a[1].toLowerCase(), "nth" === a[1].slice(0, 3) ? (a[3] || ga.error(a[0]), a[4] = +(a[4] ? a[5] + (a[6] || 1) : 2 * ("even" === a[3] || "odd" === a[3])), a[5] = +(a[7] + a[8] || "odd" === a[3])) : a[3] && ga.error(a[0]), a
+                    return a[1] = a[1].toLowerCase(), "nth" === a[1].slice(0, 3) ? (a[3] || db.error(a[0]), a[4] = +(a[4] ? a[5] + (a[6] || 1) : 2 * ("even" === a[3] || "odd" === a[3])), a[5] = +(a[7] + a[8] || "odd" === a[3])) : a[3] && db.error(a[0]), a
                 },
                 PSEUDO: function(a) {
-                    var b, c = !a[6] && a[2];
-                    return V.CHILD.test(a[0]) ? null : (a[3] ? a[2] = a[4] || a[5] || "" : c && T.test(c) && (b = g(c, !0)) && (b = c.indexOf(")", c.length - b) - c.length) && (a[0] = a[0].slice(0, b), a[2] = c.slice(0, b)), a.slice(0, 3))
+                    var b, c = !a[5] && a[2];
+                    return V.CHILD.test(a[0]) ? null : (a[3] && void 0 !== a[4] ? a[2] = a[4] : c && T.test(c) && (b = ob(c, !0)) && (b = c.indexOf(")", c.length - b) - c.length) && (a[0] = a[0].slice(0, b), a[2] = c.slice(0, b)), a.slice(0, 3))
                 }
             },
             filter: {
                 TAG: function(a) {
-                    var b = a.replace(_, aa).toLowerCase();
+                    var b = a.replace(ab, bb).toLowerCase();
                     return "*" === a ? function() {
                         return !0
                     } : function(a) {
                         return a.nodeName && a.nodeName.toLowerCase() === b
                     }
                 },
                 CLASS: function(a) {
-                    var b = y[a + " "];
-                    return b || (b = new RegExp("(^|" + K + ")" + a + "(" + K + "|$)")) && y(a, function(a) {
-                        return b.test("string" == typeof a.className && a.className || "undefined" != typeof a.getAttribute && a.getAttribute("class") || "")
+                    var b = w[a + " "];
+                    return b || (b = new RegExp("(^|" + K + ")" + a + "(" + K + "|$)")) && w(a, function(a) {
+                        return b.test("string" == typeof a.className && a.className || typeof a.getAttribute !== A && a.getAttribute("class") || "")
                     })
                 },
                 ATTR: function(a, b, c) {
                     return function(d) {
-                        var e = ga.attr(d, a);
-                        return null == e ? "!=" === b : !b || (e += "", "=" === b ? e === c : "!=" === b ? e !== c : "^=" === b ? c && 0 === e.indexOf(c) : "*=" === b ? c && e.indexOf(c) > -1 : "$=" === b ? c && e.slice(-c.length) === c : "~=" === b ? (" " + e.replace(O, " ") + " ").indexOf(c) > -1 : "|=" === b && (e === c || e.slice(0, c.length + 1) === c + "-"))
+                        var e = db.attr(d, a);
+                        return null == e ? "!=" === b : b ? (e += "", "=" === b ? e === c : "!=" === b ? e !== c : "^=" === b ? c && 0 === e.indexOf(c) : "*=" === b ? c && e.indexOf(c) > -1 : "$=" === b ? c && e.slice(-c.length) === c : "~=" === b ? (" " + e + " ").indexOf(c) > -1 : "|=" === b ? e === c || e.slice(0, c.length + 1) === c + "-" : !1) : !0
                     }
                 },
                 CHILD: function(a, b, c, d, e) {
                     var f = "nth" !== a.slice(0, 3),
                         g = "last" !== a.slice(-4),
                         h = "of-type" === b;
                     return 1 === d && 0 === e ? function(a) {
                         return !!a.parentNode
                     } : function(b, c, i) {
                         var j, k, l, m, n, o, p = f !== g ? "nextSibling" : "previousSibling",
                             q = b.parentNode,
                             r = h && b.nodeName.toLowerCase(),
-                            s = !i && !h,
-                            t = !1;
+                            t = !i && !h;
                         if (q) {
                             if (f) {
                                 while (p) {
-                                    m = b;
-                                    while (m = m[p])
-                                        if (h ? m.nodeName.toLowerCase() === r : 1 === m.nodeType) return !1;
+                                    l = b;
+                                    while (l = l[p])
+                                        if (h ? l.nodeName.toLowerCase() === r : 1 === l.nodeType) return !1;
                                     o = p = "only" === a && !o && "nextSibling"
                                 }
                                 return !0
                             }
-                            if (o = [g ? q.firstChild : q.lastChild], g && s) {
-                                m = q, l = m[u] || (m[u] = {}), k = l[m.uniqueID] || (l[m.uniqueID] = {}), j = k[a] || [], n = j[0] === w && j[1], t = n && j[2], m = n && q.childNodes[n];
-                                while (m = ++n && m && m[p] || (t = n = 0) || o.pop())
-                                    if (1 === m.nodeType && ++t && m === b) {
-                                        k[a] = [w, n, t];
+                            if (o = [g ? q.firstChild : q.lastChild], g && t) {
+                                k = q[s] || (q[s] = {}), j = k[a] || [], n = j[0] === u && j[1], m = j[0] === u && j[2], l = n && q.childNodes[n];
+                                while (l = ++n && l && l[p] || (m = n = 0) || o.pop())
+                                    if (1 === l.nodeType && ++m && l === b) {
+                                        k[a] = [u, n, m];
                                         break
                                     }
-                            } else if (s && (m = b, l = m[u] || (m[u] = {}), k = l[m.uniqueID] || (l[m.uniqueID] = {}), j = k[a] || [], n = j[0] === w && j[1], t = n), t === !1)
-                                while (m = ++n && m && m[p] || (t = n = 0) || o.pop())
-                                    if ((h ? m.nodeName.toLowerCase() === r : 1 === m.nodeType) && ++t && (s && (l = m[u] || (m[u] = {}), k = l[m.uniqueID] || (l[m.uniqueID] = {}), k[a] = [w, t]), m === b)) break;
-                            return t -= e, t === d || t % d === 0 && t / d >= 0
+                            } else if (t && (j = (b[s] || (b[s] = {}))[a]) && j[0] === u) m = j[1];
+                            else
+                                while (l = ++n && l && l[p] || (m = n = 0) || o.pop())
+                                    if ((h ? l.nodeName.toLowerCase() === r : 1 === l.nodeType) && ++m && (t && ((l[s] || (l[s] = {}))[a] = [u, m]), l === b)) break;
+                            return m -= e, m === d || m % d === 0 && m / d >= 0
                         }
                     }
                 },
                 PSEUDO: function(a, b) {
-                    var c, e = d.pseudos[a] || d.setFilters[a.toLowerCase()] || ga.error("unsupported pseudo: " + a);
-                    return e[u] ? e(b) : e.length > 1 ? (c = [a, a, "", b], d.setFilters.hasOwnProperty(a.toLowerCase()) ? ia(function(a, c) {
+                    var c, e = d.pseudos[a] || d.setFilters[a.toLowerCase()] || db.error("unsupported pseudo: " + a);
+                    return e[s] ? e(b) : e.length > 1 ? (c = [a, a, "", b], d.setFilters.hasOwnProperty(a.toLowerCase()) ? fb(function(a, c) {
                         var d, f = e(a, b),
                             g = f.length;
-                        while (g--) d = I(a, f[g]), a[d] = !(c[d] = f[g])
+                        while (g--) d = I.call(a, f[g]), a[d] = !(c[d] = f[g])
                     }) : function(a) {
                         return e(a, 0, c)
                     }) : e
                 }
             },
             pseudos: {
-                not: ia(function(a) {
+                not: fb(function(a) {
                     var b = [],
                         c = [],
-                        d = h(a.replace(P, "$1"));
-                    return d[u] ? ia(function(a, b, c, e) {
+                        d = g(a.replace(P, "$1"));
+                    return d[s] ? fb(function(a, b, c, e) {
                         var f, g = d(a, null, e, []),
                             h = a.length;
                         while (h--)(f = g[h]) && (a[h] = !(b[h] = f))
                     }) : function(a, e, f) {
-                        return b[0] = a, d(b, null, f, c), b[0] = null, !c.pop()
+                        return b[0] = a, d(b, null, f, c), !c.pop()
                     }
                 }),
-                has: ia(function(a) {
+                has: fb(function(a) {
                     return function(b) {
-                        return ga(a, b).length > 0
+                        return db(a, b).length > 0
                     }
                 }),
-                contains: ia(function(a) {
-                    return a = a.replace(_, aa),
-                        function(b) {
-                            return (b.textContent || b.innerText || e(b)).indexOf(a) > -1
-                        }
+                contains: fb(function(a) {
+                    return function(b) {
+                        return (b.textContent || b.innerText || e(b)).indexOf(a) > -1
+                    }
                 }),
-                lang: ia(function(a) {
-                    return U.test(a || "") || ga.error("unsupported lang: " + a), a = a.replace(_, aa).toLowerCase(),
+                lang: fb(function(a) {
+                    return U.test(a || "") || db.error("unsupported lang: " + a), a = a.replace(ab, bb).toLowerCase(),
                         function(b) {
                             var c;
                             do
-                                if (c = p ? b.lang : b.getAttribute("xml:lang") || b.getAttribute("lang")) return c = c.toLowerCase(), c === a || 0 === c.indexOf(a + "-"); while ((b = b.parentNode) && 1 === b.nodeType);
+                                if (c = n ? b.lang : b.getAttribute("xml:lang") || b.getAttribute("lang")) return c = c.toLowerCase(), c === a || 0 === c.indexOf(a + "-"); while ((b = b.parentNode) && 1 === b.nodeType);
                             return !1
                         }
                 }),
                 target: function(b) {
                     var c = a.location && a.location.hash;
                     return c && c.slice(1) === b.id
                 },
                 root: function(a) {
-                    return a === o
+                    return a === m
                 },
                 focus: function(a) {
-                    return a === n.activeElement && (!n.hasFocus || n.hasFocus()) && !!(a.type || a.href || ~a.tabIndex)
+                    return a === l.activeElement && (!l.hasFocus || l.hasFocus()) && !!(a.type || a.href || ~a.tabIndex)
+                },
+                enabled: function(a) {
+                    return a.disabled === !1
+                },
+                disabled: function(a) {
+                    return a.disabled === !0
                 },
-                enabled: oa(!1),
-                disabled: oa(!0),
                 checked: function(a) {
                     var b = a.nodeName.toLowerCase();
                     return "input" === b && !!a.checked || "option" === b && !!a.selected
                 },
                 selected: function(a) {
                     return a.parentNode && a.parentNode.selectedIndex, a.selected === !0
                 },
@@ -662,2141 +673,2207 @@
                     var b = a.nodeName.toLowerCase();
                     return "input" === b && "button" === a.type || "button" === b
                 },
                 text: function(a) {
                     var b;
                     return "input" === a.nodeName.toLowerCase() && "text" === a.type && (null == (b = a.getAttribute("type")) || "text" === b.toLowerCase())
                 },
-                first: pa(function() {
+                first: lb(function() {
                     return [0]
                 }),
-                last: pa(function(a, b) {
+                last: lb(function(a, b) {
                     return [b - 1]
                 }),
-                eq: pa(function(a, b, c) {
-                    return [c < 0 ? c + b : c]
+                eq: lb(function(a, b, c) {
+                    return [0 > c ? c + b : c]
                 }),
-                even: pa(function(a, b) {
-                    for (var c = 0; c < b; c += 2) a.push(c);
+                even: lb(function(a, b) {
+                    for (var c = 0; b > c; c += 2) a.push(c);
                     return a
                 }),
-                odd: pa(function(a, b) {
-                    for (var c = 1; c < b; c += 2) a.push(c);
+                odd: lb(function(a, b) {
+                    for (var c = 1; b > c; c += 2) a.push(c);
                     return a
                 }),
-                lt: pa(function(a, b, c) {
-                    for (var d = c < 0 ? c + b : c; --d >= 0;) a.push(d);
+                lt: lb(function(a, b, c) {
+                    for (var d = 0 > c ? c + b : c; --d >= 0;) a.push(d);
                     return a
                 }),
-                gt: pa(function(a, b, c) {
-                    for (var d = c < 0 ? c + b : c; ++d < b;) a.push(d);
+                gt: lb(function(a, b, c) {
+                    for (var d = 0 > c ? c + b : c; ++d < b;) a.push(d);
                     return a
                 })
             }
         }, d.pseudos.nth = d.pseudos.eq;
         for (b in {
                 radio: !0,
                 checkbox: !0,
                 file: !0,
                 password: !0,
                 image: !0
-            }) d.pseudos[b] = ma(b);
+            }) d.pseudos[b] = jb(b);
         for (b in {
                 submit: !0,
                 reset: !0
-            }) d.pseudos[b] = na(b);
+            }) d.pseudos[b] = kb(b);
 
-        function ra() {}
-        ra.prototype = d.filters = d.pseudos, d.setFilters = new ra, g = ga.tokenize = function(a, b) {
-            var c, e, f, g, h, i, j, k = z[a + " "];
+        function nb() {}
+        nb.prototype = d.filters = d.pseudos, d.setFilters = new nb;
+
+        function ob(a, b) {
+            var c, e, f, g, h, i, j, k = x[a + " "];
             if (k) return b ? 0 : k.slice(0);
             h = a, i = [], j = d.preFilter;
             while (h) {
-                c && !(e = Q.exec(h)) || (e && (h = h.slice(e[0].length) || h), i.push(f = [])), c = !1, (e = R.exec(h)) && (c = e.shift(), f.push({
+                (!c || (e = Q.exec(h))) && (e && (h = h.slice(e[0].length) || h), i.push(f = [])), c = !1, (e = R.exec(h)) && (c = e.shift(), f.push({
                     value: c,
                     type: e[0].replace(P, " ")
                 }), h = h.slice(c.length));
                 for (g in d.filter) !(e = V[g].exec(h)) || j[g] && !(e = j[g](e)) || (c = e.shift(), f.push({
                     value: c,
                     type: g,
                     matches: e
                 }), h = h.slice(c.length));
                 if (!c) break
             }
-            return b ? h.length : h ? ga.error(a) : z(a, i).slice(0)
-        };
+            return b ? h.length : h ? db.error(a) : x(a, i).slice(0)
+        }
 
-        function sa(a) {
-            for (var b = 0, c = a.length, d = ""; b < c; b++) d += a[b].value;
+        function pb(a) {
+            for (var b = 0, c = a.length, d = ""; c > b; b++) d += a[b].value;
             return d
         }
 
-        function ta(a, b, c) {
+        function qb(a, b, c) {
             var d = b.dir,
-                e = b.next,
-                f = e || d,
-                g = c && "parentNode" === f,
-                h = x++;
-            return b.first ? function(b, c, e) {
+                e = c && "parentNode" === d,
+                f = v++;
+            return b.first ? function(b, c, f) {
                 while (b = b[d])
-                    if (1 === b.nodeType || g) return a(b, c, e);
-                return !1
-            } : function(b, c, i) {
-                var j, k, l, m = [w, h];
-                if (i) {
+                    if (1 === b.nodeType || e) return a(b, c, f)
+            } : function(b, c, g) {
+                var h, i, j = [u, f];
+                if (g) {
                     while (b = b[d])
-                        if ((1 === b.nodeType || g) && a(b, c, i)) return !0
+                        if ((1 === b.nodeType || e) && a(b, c, g)) return !0
                 } else
                     while (b = b[d])
-                        if (1 === b.nodeType || g)
-                            if (l = b[u] || (b[u] = {}), k = l[b.uniqueID] || (l[b.uniqueID] = {}), e && e === b.nodeName.toLowerCase()) b = b[d] || b;
-                            else {
-                                if ((j = k[f]) && j[0] === w && j[1] === h) return m[2] = j[2];
-                                if (k[f] = m, m[2] = a(b, c, i)) return !0
-                            } return !1
+                        if (1 === b.nodeType || e) {
+                            if (i = b[s] || (b[s] = {}), (h = i[d]) && h[0] === u && h[1] === f) return j[2] = h[2];
+                            if (i[d] = j, j[2] = a(b, c, g)) return !0
+                        }
             }
         }
 
-        function ua(a) {
+        function rb(a) {
             return a.length > 1 ? function(b, c, d) {
                 var e = a.length;
                 while (e--)
                     if (!a[e](b, c, d)) return !1;
                 return !0
             } : a[0]
         }
 
-        function va(a, b, c) {
-            for (var d = 0, e = b.length; d < e; d++) ga(a, b[d], c);
-            return c
-        }
-
-        function wa(a, b, c, d, e) {
-            for (var f, g = [], h = 0, i = a.length, j = null != b; h < i; h++)(f = a[h]) && (c && !c(f, d, e) || (g.push(f), j && b.push(h)));
+        function sb(a, b, c, d, e) {
+            for (var f, g = [], h = 0, i = a.length, j = null != b; i > h; h++)(f = a[h]) && (!c || c(f, d, e)) && (g.push(f), j && b.push(h));
             return g
         }
 
-        function xa(a, b, c, d, e, f) {
-            return d && !d[u] && (d = xa(d)), e && !e[u] && (e = xa(e, f)), ia(function(f, g, h, i) {
+        function tb(a, b, c, d, e, f) {
+            return d && !d[s] && (d = tb(d)), e && !e[s] && (e = tb(e, f)), fb(function(f, g, h, i) {
                 var j, k, l, m = [],
                     n = [],
                     o = g.length,
-                    p = f || va(b || "*", h.nodeType ? [h] : h, []),
-                    q = !a || !f && b ? p : wa(p, m, a, h, i),
+                    p = f || wb(b || "*", h.nodeType ? [h] : h, []),
+                    q = !a || !f && b ? p : sb(p, m, a, h, i),
                     r = c ? e || (f ? a : o || d) ? [] : g : q;
                 if (c && c(q, r, h, i), d) {
-                    j = wa(r, n), d(j, [], h, i), k = j.length;
+                    j = sb(r, n), d(j, [], h, i), k = j.length;
                     while (k--)(l = j[k]) && (r[n[k]] = !(q[n[k]] = l))
                 }
                 if (f) {
                     if (e || a) {
                         if (e) {
                             j = [], k = r.length;
                             while (k--)(l = r[k]) && j.push(q[k] = l);
                             e(null, r = [], j, i)
                         }
                         k = r.length;
-                        while (k--)(l = r[k]) && (j = e ? I(f, l) : m[k]) > -1 && (f[j] = !(g[j] = l))
+                        while (k--)(l = r[k]) && (j = e ? I.call(f, l) : m[k]) > -1 && (f[j] = !(g[j] = l))
                     }
-                } else r = wa(r === g ? r.splice(o, r.length) : r), e ? e(null, g, r, i) : G.apply(g, r)
+                } else r = sb(r === g ? r.splice(o, r.length) : r), e ? e(null, g, r, i) : G.apply(g, r)
             })
         }
 
-        function ya(a) {
-            for (var b, c, e, f = a.length, g = d.relative[a[0].type], h = g || d.relative[" "], i = g ? 1 : 0, k = ta(function(a) {
+        function ub(a) {
+            for (var b, c, e, f = a.length, g = d.relative[a[0].type], i = g || d.relative[" "], j = g ? 1 : 0, k = qb(function(a) {
                     return a === b
-                }, h, !0), l = ta(function(a) {
-                    return I(b, a) > -1
-                }, h, !0), m = [function(a, c, d) {
-                    var e = !g && (d || c !== j) || ((b = c).nodeType ? k(a, c, d) : l(a, c, d));
-                    return b = null, e
-                }]; i < f; i++)
-                if (c = d.relative[a[i].type]) m = [ta(ua(m), c)];
+                }, i, !0), l = qb(function(a) {
+                    return I.call(b, a) > -1
+                }, i, !0), m = [function(a, c, d) {
+                    return !g && (d || c !== h) || ((b = c).nodeType ? k(a, c, d) : l(a, c, d))
+                }]; f > j; j++)
+                if (c = d.relative[a[j].type]) m = [qb(rb(m), c)];
                 else {
-                    if (c = d.filter[a[i].type].apply(null, a[i].matches), c[u]) {
-                        for (e = ++i; e < f; e++)
+                    if (c = d.filter[a[j].type].apply(null, a[j].matches), c[s]) {
+                        for (e = ++j; f > e; e++)
                             if (d.relative[a[e].type]) break;
-                        return xa(i > 1 && ua(m), i > 1 && sa(a.slice(0, i - 1).concat({
-                            value: " " === a[i - 2].type ? "*" : ""
-                        })).replace(P, "$1"), c, i < e && ya(a.slice(i, e)), e < f && ya(a = a.slice(e)), e < f && sa(a))
+                        return tb(j > 1 && rb(m), j > 1 && pb(a.slice(0, j - 1).concat({
+                            value: " " === a[j - 2].type ? "*" : ""
+                        })).replace(P, "$1"), c, e > j && ub(a.slice(j, e)), f > e && ub(a = a.slice(e)), f > e && pb(a))
                     }
                     m.push(c)
-                } return ua(m)
+                } return rb(m)
         }
 
-        function za(a, b) {
+        function vb(a, b) {
             var c = b.length > 0,
                 e = a.length > 0,
-                f = function(f, g, h, i, k) {
-                    var l, o, q, r = 0,
-                        s = "0",
-                        t = f && [],
-                        u = [],
-                        v = j,
-                        x = f || e && d.find.TAG("*", k),
-                        y = w += null == v ? 1 : Math.random() || .1,
-                        z = x.length;
-                    for (k && (j = g === n || g || k); s !== z && null != (l = x[s]); s++) {
-                        if (e && l) {
-                            o = 0, g || l.ownerDocument === n || (m(l), h = !p);
-                            while (q = a[o++])
-                                if (q(l, g || n, h)) {
-                                    i.push(l);
+                f = function(f, g, i, j, k) {
+                    var m, n, o, p = 0,
+                        q = "0",
+                        r = f && [],
+                        s = [],
+                        t = h,
+                        v = f || e && d.find.TAG("*", k),
+                        w = u += null == t ? 1 : Math.random() || .1,
+                        x = v.length;
+                    for (k && (h = g !== l && g); q !== x && null != (m = v[q]); q++) {
+                        if (e && m) {
+                            n = 0;
+                            while (o = a[n++])
+                                if (o(m, g, i)) {
+                                    j.push(m);
                                     break
-                                } k && (w = y)
+                                } k && (u = w)
                         }
-                        c && ((l = !q && l) && r--, f && t.push(l))
+                        c && ((m = !o && m) && p--, f && r.push(m))
                     }
-                    if (r += s, c && s !== r) {
-                        o = 0;
-                        while (q = b[o++]) q(t, u, g, h);
+                    if (p += q, c && q !== p) {
+                        n = 0;
+                        while (o = b[n++]) o(r, s, g, i);
                         if (f) {
-                            if (r > 0)
-                                while (s--) t[s] || u[s] || (u[s] = E.call(i));
-                            u = wa(u)
+                            if (p > 0)
+                                while (q--) r[q] || s[q] || (s[q] = E.call(j));
+                            s = sb(s)
                         }
-                        G.apply(i, u), k && !f && u.length > 0 && r + b.length > 1 && ga.uniqueSort(i)
+                        G.apply(j, s), k && !f && s.length > 0 && p + b.length > 1 && db.uniqueSort(j)
                     }
-                    return k && (w = y, j = v), t
+                    return k && (u = w, h = t), r
                 };
-            return c ? ia(f) : f
+            return c ? fb(f) : f
         }
-        return h = ga.compile = function(a, b) {
+        g = db.compile = function(a, b) {
             var c, d = [],
                 e = [],
-                f = A[a + " "];
+                f = y[a + " "];
             if (!f) {
-                b || (b = g(a)), c = b.length;
-                while (c--) f = ya(b[c]), f[u] ? d.push(f) : e.push(f);
-                f = A(a, za(e, d)), f.selector = a
+                b || (b = ob(a)), c = b.length;
+                while (c--) f = ub(b[c]), f[s] ? d.push(f) : e.push(f);
+                f = y(a, vb(e, d))
             }
             return f
-        }, i = ga.select = function(a, b, c, e) {
-            var f, i, j, k, l, m = "function" == typeof a && a,
-                n = !e && g(a = m.selector || a);
-            if (c = c || [], 1 === n.length) {
-                if (i = n[0] = n[0].slice(0), i.length > 2 && "ID" === (j = i[0]).type && 9 === b.nodeType && p && d.relative[i[1].type]) {
-                    if (b = (d.find.ID(j.matches[0].replace(_, aa), b) || [])[0], !b) return c;
-                    m && (b = b.parentNode), a = a.slice(i.shift().value.length)
-                }
-                f = V.needsContext.test(a) ? 0 : i.length;
-                while (f--) {
-                    if (j = i[f], d.relative[k = j.type]) break;
-                    if ((l = d.find[k]) && (e = l(j.matches[0].replace(_, aa), $.test(i[0].type) && qa(b.parentNode) || b))) {
-                        if (i.splice(f, 1), a = e.length && sa(i), !a) return G.apply(c, e), c;
+        };
+
+        function wb(a, b, c) {
+            for (var d = 0, e = b.length; e > d; d++) db(a, b[d], c);
+            return c
+        }
+
+        function xb(a, b, e, f) {
+            var h, i, j, k, l, m = ob(a);
+            if (!f && 1 === m.length) {
+                if (i = m[0] = m[0].slice(0), i.length > 2 && "ID" === (j = i[0]).type && c.getById && 9 === b.nodeType && n && d.relative[i[1].type]) {
+                    if (b = (d.find.ID(j.matches[0].replace(ab, bb), b) || [])[0], !b) return e;
+                    a = a.slice(i.shift().value.length)
+                }
+                h = V.needsContext.test(a) ? 0 : i.length;
+                while (h--) {
+                    if (j = i[h], d.relative[k = j.type]) break;
+                    if ((l = d.find[k]) && (f = l(j.matches[0].replace(ab, bb), $.test(i[0].type) && mb(b.parentNode) || b))) {
+                        if (i.splice(h, 1), a = f.length && pb(i), !a) return G.apply(e, f), e;
                         break
                     }
                 }
             }
-            return (m || h(a, n))(e, b, !p, c, !b || $.test(a) && qa(b.parentNode) || b), c
-        }, c.sortStable = u.split("").sort(B).join("") === u, c.detectDuplicates = !!l, m(), c.sortDetached = ja(function(a) {
-            return 1 & a.compareDocumentPosition(n.createElement("fieldset"))
-        }), ja(function(a) {
+            return g(a, m)(f, b, !n, e, $.test(a) && mb(b.parentNode) || b), e
+        }
+        return c.sortStable = s.split("").sort(z).join("") === s, c.detectDuplicates = !!j, k(), c.sortDetached = gb(function(a) {
+            return 1 & a.compareDocumentPosition(l.createElement("div"))
+        }), gb(function(a) {
             return a.innerHTML = "<a href='#'></a>", "#" === a.firstChild.getAttribute("href")
-        }) || ka("type|href|height|width", function(a, b, c) {
-            if (!c) return a.getAttribute(b, "type" === b.toLowerCase() ? 1 : 2)
-        }), c.attributes && ja(function(a) {
+        }) || hb("type|href|height|width", function(a, b, c) {
+            return c ? void 0 : a.getAttribute(b, "type" === b.toLowerCase() ? 1 : 2)
+        }), c.attributes && gb(function(a) {
             return a.innerHTML = "<input/>", a.firstChild.setAttribute("value", ""), "" === a.firstChild.getAttribute("value")
-        }) || ka("value", function(a, b, c) {
-            if (!c && "input" === a.nodeName.toLowerCase()) return a.defaultValue
-        }), ja(function(a) {
+        }) || hb("value", function(a, b, c) {
+            return c || "input" !== a.nodeName.toLowerCase() ? void 0 : a.defaultValue
+        }), gb(function(a) {
             return null == a.getAttribute("disabled")
-        }) || ka(J, function(a, b, c) {
+        }) || hb(J, function(a, b, c) {
             var d;
-            if (!c) return a[b] === !0 ? b.toLowerCase() : (d = a.getAttributeNode(b)) && d.specified ? d.value : null
-        }), ga
+            return c ? void 0 : a[b] === !0 ? b.toLowerCase() : (d = a.getAttributeNode(b)) && d.specified ? d.value : null
+        }), db
     }(a);
-    r.find = x, r.expr = x.selectors, r.expr[":"] = r.expr.pseudos, r.uniqueSort = r.unique = x.uniqueSort, r.text = x.getText, r.isXMLDoc = x.isXML, r.contains = x.contains, r.escapeSelector = x.escape;
-    var y = function(a, b, c) {
-            var d = [],
-                e = void 0 !== c;
-            while ((a = a[b]) && 9 !== a.nodeType)
-                if (1 === a.nodeType) {
-                    if (e && r(a).is(c)) break;
-                    d.push(a)
-                } return d
-        },
-        z = function(a, b) {
-            for (var c = []; a; a = a.nextSibling) 1 === a.nodeType && a !== b && c.push(a);
-            return c
-        },
-        A = r.expr.match.needsContext;
-
-    function B(a, b) {
-        return a.nodeName && a.nodeName.toLowerCase() === b.toLowerCase()
-    }
-    var C = /^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,
-        D = /^.[^:#\[\.,]*$/;
+    n.find = t, n.expr = t.selectors, n.expr[":"] = n.expr.pseudos, n.unique = t.uniqueSort, n.text = t.getText, n.isXMLDoc = t.isXML, n.contains = t.contains;
+    var u = n.expr.match.needsContext,
+        v = /^<(\w+)\s*\/?>(?:<\/\1>|)$/,
+        w = /^.[^:#\[\.,]*$/;
 
-    function E(a, b, c) {
-        return r.isFunction(b) ? r.grep(a, function(a, d) {
+    function x(a, b, c) {
+        if (n.isFunction(b)) return n.grep(a, function(a, d) {
             return !!b.call(a, d, a) !== c
-        }) : b.nodeType ? r.grep(a, function(a) {
+        });
+        if (b.nodeType) return n.grep(a, function(a) {
             return a === b !== c
-        }) : "string" != typeof b ? r.grep(a, function(a) {
-            return i.call(b, a) > -1 !== c
-        }) : D.test(b) ? r.filter(b, a, c) : (b = r.filter(b, a), r.grep(a, function(a) {
-            return i.call(b, a) > -1 !== c && 1 === a.nodeType
-        }))
+        });
+        if ("string" == typeof b) {
+            if (w.test(b)) return n.filter(b, a, c);
+            b = n.filter(b, a)
+        }
+        return n.grep(a, function(a) {
+            return n.inArray(a, b) >= 0 !== c
+        })
     }
-    r.filter = function(a, b, c) {
+    n.filter = function(a, b, c) {
         var d = b[0];
-        return c && (a = ":not(" + a + ")"), 1 === b.length && 1 === d.nodeType ? r.find.matchesSelector(d, a) ? [d] : [] : r.find.matches(a, r.grep(b, function(a) {
+        return c && (a = ":not(" + a + ")"), 1 === b.length && 1 === d.nodeType ? n.find.matchesSelector(d, a) ? [d] : [] : n.find.matches(a, n.grep(b, function(a) {
             return 1 === a.nodeType
         }))
-    }, r.fn.extend({
+    }, n.fn.extend({
         find: function(a) {
-            var b, c, d = this.length,
-                e = this;
-            if ("string" != typeof a) return this.pushStack(r(a).filter(function() {
-                for (b = 0; b < d; b++)
-                    if (r.contains(e[b], this)) return !0
+            var b, c = [],
+                d = this,
+                e = d.length;
+            if ("string" != typeof a) return this.pushStack(n(a).filter(function() {
+                for (b = 0; e > b; b++)
+                    if (n.contains(d[b], this)) return !0
             }));
-            for (c = this.pushStack([]), b = 0; b < d; b++) r.find(a, e[b], c);
-            return d > 1 ? r.uniqueSort(c) : c
+            for (b = 0; e > b; b++) n.find(a, d[b], c);
+            return c = this.pushStack(e > 1 ? n.unique(c) : c), c.selector = this.selector ? this.selector + " " + a : a, c
         },
         filter: function(a) {
-            return this.pushStack(E(this, a || [], !1))
+            return this.pushStack(x(this, a || [], !1))
         },
         not: function(a) {
-            return this.pushStack(E(this, a || [], !0))
+            return this.pushStack(x(this, a || [], !0))
         },
         is: function(a) {
-            return !!E(this, "string" == typeof a && A.test(a) ? r(a) : a || [], !1).length
+            return !!x(this, "string" == typeof a && u.test(a) ? n(a) : a || [], !1).length
         }
     });
-    var F, G = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,
-        H = r.fn.init = function(a, b, c) {
-            var e, f;
+    var y, z = a.document,
+        A = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,
+        B = n.fn.init = function(a, b) {
+            var c, d;
             if (!a) return this;
-            if (c = c || F, "string" == typeof a) {
-                if (e = "<" === a[0] && ">" === a[a.length - 1] && a.length >= 3 ? [null, a, null] : G.exec(a), !e || !e[1] && b) return !b || b.jquery ? (b || c).find(a) : this.constructor(b).find(a);
-                if (e[1]) {
-                    if (b = b instanceof r ? b[0] : b, r.merge(this, r.parseHTML(e[1], b && b.nodeType ? b.ownerDocument || b : d, !0)), C.test(e[1]) && r.isPlainObject(b))
-                        for (e in b) r.isFunction(this[e]) ? this[e](b[e]) : this.attr(e, b[e]);
+            if ("string" == typeof a) {
+                if (c = "<" === a.charAt(0) && ">" === a.charAt(a.length - 1) && a.length >= 3 ? [null, a, null] : A.exec(a), !c || !c[1] && b) return !b || b.jquery ? (b || y).find(a) : this.constructor(b).find(a);
+                if (c[1]) {
+                    if (b = b instanceof n ? b[0] : b, n.merge(this, n.parseHTML(c[1], b && b.nodeType ? b.ownerDocument || b : z, !0)), v.test(c[1]) && n.isPlainObject(b))
+                        for (c in b) n.isFunction(this[c]) ? this[c](b[c]) : this.attr(c, b[c]);
                     return this
                 }
-                return f = d.getElementById(e[2]), f && (this[0] = f, this.length = 1), this
+                if (d = z.getElementById(c[2]), d && d.parentNode) {
+                    if (d.id !== c[2]) return y.find(a);
+                    this.length = 1, this[0] = d
+                }
+                return this.context = z, this.selector = a, this
             }
-            return a.nodeType ? (this[0] = a, this.length = 1, this) : r.isFunction(a) ? void 0 !== c.ready ? c.ready(a) : a(r) : r.makeArray(a, this)
+            return a.nodeType ? (this.context = this[0] = a, this.length = 1, this) : n.isFunction(a) ? "undefined" != typeof y.ready ? y.ready(a) : a(n) : (void 0 !== a.selector && (this.selector = a.selector, this.context = a.context), n.makeArray(a, this))
         };
-    H.prototype = r.fn, F = r(d);
-    var I = /^(?:parents|prev(?:Until|All))/,
-        J = {
+    B.prototype = n.fn, y = n(z);
+    var C = /^(?:parents|prev(?:Until|All))/,
+        D = {
             children: !0,
             contents: !0,
             next: !0,
             prev: !0
         };
-    r.fn.extend({
+    n.extend({
+        dir: function(a, b, c) {
+            var d = [],
+                e = a[b];
+            while (e && 9 !== e.nodeType && (void 0 === c || 1 !== e.nodeType || !n(e).is(c))) 1 === e.nodeType && d.push(e), e = e[b];
+            return d
+        },
+        sibling: function(a, b) {
+            for (var c = []; a; a = a.nextSibling) 1 === a.nodeType && a !== b && c.push(a);
+            return c
+        }
+    }), n.fn.extend({
         has: function(a) {
-            var b = r(a, this),
-                c = b.length;
+            var b, c = n(a, this),
+                d = c.length;
             return this.filter(function() {
-                for (var a = 0; a < c; a++)
-                    if (r.contains(this, b[a])) return !0
+                for (b = 0; d > b; b++)
+                    if (n.contains(this, c[b])) return !0
             })
         },
         closest: function(a, b) {
-            var c, d = 0,
-                e = this.length,
-                f = [],
-                g = "string" != typeof a && r(a);
-            if (!A.test(a))
-                for (; d < e; d++)
-                    for (c = this[d]; c && c !== b; c = c.parentNode)
-                        if (c.nodeType < 11 && (g ? g.index(c) > -1 : 1 === c.nodeType && r.find.matchesSelector(c, a))) {
-                            f.push(c);
-                            break
-                        } return this.pushStack(f.length > 1 ? r.uniqueSort(f) : f)
+            for (var c, d = 0, e = this.length, f = [], g = u.test(a) || "string" != typeof a ? n(a, b || this.context) : 0; e > d; d++)
+                for (c = this[d]; c && c !== b; c = c.parentNode)
+                    if (c.nodeType < 11 && (g ? g.index(c) > -1 : 1 === c.nodeType && n.find.matchesSelector(c, a))) {
+                        f.push(c);
+                        break
+                    } return this.pushStack(f.length > 1 ? n.unique(f) : f)
         },
         index: function(a) {
-            return a ? "string" == typeof a ? i.call(r(a), this[0]) : i.call(this, a.jquery ? a[0] : a) : this[0] && this[0].parentNode ? this.first().prevAll().length : -1
+            return a ? "string" == typeof a ? n.inArray(this[0], n(a)) : n.inArray(a.jquery ? a[0] : a, this) : this[0] && this[0].parentNode ? this.first().prevAll().length : -1
         },
         add: function(a, b) {
-            return this.pushStack(r.uniqueSort(r.merge(this.get(), r(a, b))))
+            return this.pushStack(n.unique(n.merge(this.get(), n(a, b))))
         },
         addBack: function(a) {
             return this.add(null == a ? this.prevObject : this.prevObject.filter(a))
         }
     });
 
-    function K(a, b) {
-        while ((a = a[b]) && 1 !== a.nodeType);
+    function E(a, b) {
+        do a = a[b]; while (a && 1 !== a.nodeType);
         return a
     }
-    r.each({
+    n.each({
         parent: function(a) {
             var b = a.parentNode;
             return b && 11 !== b.nodeType ? b : null
         },
         parents: function(a) {
-            return y(a, "parentNode")
+            return n.dir(a, "parentNode")
         },
         parentsUntil: function(a, b, c) {
-            return y(a, "parentNode", c)
+            return n.dir(a, "parentNode", c)
         },
         next: function(a) {
-            return K(a, "nextSibling")
+            return E(a, "nextSibling")
         },
         prev: function(a) {
-            return K(a, "previousSibling")
+            return E(a, "previousSibling")
         },
         nextAll: function(a) {
-            return y(a, "nextSibling")
+            return n.dir(a, "nextSibling")
         },
         prevAll: function(a) {
-            return y(a, "previousSibling")
+            return n.dir(a, "previousSibling")
         },
         nextUntil: function(a, b, c) {
-            return y(a, "nextSibling", c)
+            return n.dir(a, "nextSibling", c)
         },
         prevUntil: function(a, b, c) {
-            return y(a, "previousSibling", c)
+            return n.dir(a, "previousSibling", c)
         },
         siblings: function(a) {
-            return z((a.parentNode || {}).firstChild, a)
+            return n.sibling((a.parentNode || {}).firstChild, a)
         },
         children: function(a) {
-            return z(a.firstChild)
+            return n.sibling(a.firstChild)
         },
         contents: function(a) {
-            return B(a, "iframe") ? a.contentDocument : (B(a, "template") && (a = a.content || a), r.merge([], a.childNodes))
+            return n.nodeName(a, "iframe") ? a.contentDocument || a.contentWindow.document : n.merge([], a.childNodes)
         }
     }, function(a, b) {
-        r.fn[a] = function(c, d) {
-            var e = r.map(this, b, c);
-            return "Until" !== a.slice(-5) && (d = c), d && "string" == typeof d && (e = r.filter(d, e)), this.length > 1 && (J[a] || r.uniqueSort(e), I.test(a) && e.reverse()), this.pushStack(e)
+        n.fn[a] = function(c, d) {
+            var e = n.map(this, b, c);
+            return "Until" !== a.slice(-5) && (d = c), d && "string" == typeof d && (e = n.filter(d, e)), this.length > 1 && (D[a] || (e = n.unique(e)), C.test(a) && (e = e.reverse())), this.pushStack(e)
         }
     });
-    var L = /[^\x20\t\r\n\f]+/g;
+    var F = /\S+/g,
+        G = {};
 
-    function M(a) {
-        var b = {};
-        return r.each(a.match(L) || [], function(a, c) {
+    function H(a) {
+        var b = G[a] = {};
+        return n.each(a.match(F) || [], function(a, c) {
             b[c] = !0
         }), b
     }
-    r.Callbacks = function(a) {
-        a = "string" == typeof a ? M(a) : r.extend({}, a);
-        var b, c, d, e, f = [],
-            g = [],
-            h = -1,
-            i = function() {
-                for (e = e || a.once, d = b = !0; g.length; h = -1) {
-                    c = g.shift();
-                    while (++h < f.length) f[h].apply(c[0], c[1]) === !1 && a.stopOnFalse && (h = f.length, c = !1)
-                }
-                a.memory || (c = !1), b = !1, e && (f = c ? [] : "")
+    n.Callbacks = function(a) {
+        a = "string" == typeof a ? G[a] || H(a) : n.extend({}, a);
+        var b, c, d, e, f, g, h = [],
+            i = !a.once && [],
+            j = function(l) {
+                for (c = a.memory && l, d = !0, f = g || 0, g = 0, e = h.length, b = !0; h && e > f; f++)
+                    if (h[f].apply(l[0], l[1]) === !1 && a.stopOnFalse) {
+                        c = !1;
+                        break
+                    } b = !1, h && (i ? i.length && j(i.shift()) : c ? h = [] : k.disable())
             },
-            j = {
+            k = {
                 add: function() {
-                    return f && (c && !b && (h = f.length - 1, g.push(c)), function d(b) {
-                        r.each(b, function(b, c) {
-                            r.isFunction(c) ? a.unique && j.has(c) || f.push(c) : c && c.length && "string" !== r.type(c) && d(c)
-                        })
-                    }(arguments), c && !b && i()), this
+                    if (h) {
+                        var d = h.length;
+                        ! function f(b) {
+                            n.each(b, function(b, c) {
+                                var d = n.type(c);
+                                "function" === d ? a.unique && k.has(c) || h.push(c) : c && c.length && "string" !== d && f(c)
+                            })
+                        }(arguments), b ? e = h.length : c && (g = d, j(c))
+                    }
+                    return this
                 },
                 remove: function() {
-                    return r.each(arguments, function(a, b) {
-                        var c;
-                        while ((c = r.inArray(b, f, c)) > -1) f.splice(c, 1), c <= h && h--
+                    return h && n.each(arguments, function(a, c) {
+                        var d;
+                        while ((d = n.inArray(c, h, d)) > -1) h.splice(d, 1), b && (e >= d && e--, f >= d && f--)
                     }), this
                 },
                 has: function(a) {
-                    return a ? r.inArray(a, f) > -1 : f.length > 0
+                    return a ? n.inArray(a, h) > -1 : !(!h || !h.length)
                 },
                 empty: function() {
-                    return f && (f = []), this
+                    return h = [], e = 0, this
                 },
                 disable: function() {
-                    return e = g = [], f = c = "", this
+                    return h = i = c = void 0, this
                 },
                 disabled: function() {
-                    return !f
+                    return !h
                 },
                 lock: function() {
-                    return e = g = [], c || b || (f = c = ""), this
+                    return i = void 0, c || k.disable(), this
                 },
                 locked: function() {
-                    return !!e
+                    return !i
                 },
                 fireWith: function(a, c) {
-                    return e || (c = c || [], c = [a, c.slice ? c.slice() : c], g.push(c), b || i()), this
+                    return !h || d && !i || (c = c || [], c = [a, c.slice ? c.slice() : c], b ? i.push(c) : j(c)), this
                 },
                 fire: function() {
-                    return j.fireWith(this, arguments), this
+                    return k.fireWith(this, arguments), this
                 },
                 fired: function() {
                     return !!d
                 }
             };
-        return j
-    };
-
-    function N(a) {
-        return a
-    }
-
-    function O(a) {
-        throw a
-    }
-
-    function P(a, b, c, d) {
-        var e;
-        try {
-            a && r.isFunction(e = a.promise) ? e.call(a).done(b).fail(c) : a && r.isFunction(e = a.then) ? e.call(a, b, c) : b.apply(void 0, [a].slice(d))
-        } catch (a) {
-            c.apply(void 0, [a])
-        }
-    }
-    r.extend({
-        Deferred: function(b) {
-            var c = [
-                    ["notify", "progress", r.Callbacks("memory"), r.Callbacks("memory"), 2],
-                    ["resolve", "done", r.Callbacks("once memory"), r.Callbacks("once memory"), 0, "resolved"],
-                    ["reject", "fail", r.Callbacks("once memory"), r.Callbacks("once memory"), 1, "rejected"]
+        return k
+    }, n.extend({
+        Deferred: function(a) {
+            var b = [
+                    ["resolve", "done", n.Callbacks("once memory"), "resolved"],
+                    ["reject", "fail", n.Callbacks("once memory"), "rejected"],
+                    ["notify", "progress", n.Callbacks("memory")]
                 ],
-                d = "pending",
-                e = {
+                c = "pending",
+                d = {
                     state: function() {
-                        return d
+                        return c
                     },
                     always: function() {
-                        return f.done(arguments).fail(arguments), this
-                    },
-                    "catch": function(a) {
-                        return e.then(null, a)
+                        return e.done(arguments).fail(arguments), this
                     },
-                    pipe: function() {
+                    then: function() {
                         var a = arguments;
-                        return r.Deferred(function(b) {
-                            r.each(c, function(c, d) {
-                                var e = r.isFunction(a[d[4]]) && a[d[4]];
-                                f[d[1]](function() {
-                                    var a = e && e.apply(this, arguments);
-                                    a && r.isFunction(a.promise) ? a.promise().progress(b.notify).done(b.resolve).fail(b.reject) : b[d[0] + "With"](this, e ? [a] : arguments)
+                        return n.Deferred(function(c) {
+                            n.each(b, function(b, f) {
+                                var g = n.isFunction(a[b]) && a[b];
+                                e[f[1]](function() {
+                                    var a = g && g.apply(this, arguments);
+                                    a && n.isFunction(a.promise) ? a.promise().done(c.resolve).fail(c.reject).progress(c.notify) : c[f[0] + "With"](this === d ? c.promise() : this, g ? [a] : arguments)
                                 })
                             }), a = null
                         }).promise()
                     },
-                    then: function(b, d, e) {
-                        var f = 0;
-
-                        function g(b, c, d, e) {
-                            return function() {
-                                var h = this,
-                                    i = arguments,
-                                    j = function() {
-                                        var a, j;
-                                        if (!(b < f)) {
-                                            if (a = d.apply(h, i), a === c.promise()) throw new TypeError("Thenable self-resolution");
-                                            j = a && ("object" == typeof a || "function" == typeof a) && a.then, r.isFunction(j) ? e ? j.call(a, g(f, c, N, e), g(f, c, O, e)) : (f++, j.call(a, g(f, c, N, e), g(f, c, O, e), g(f, c, N, c.notifyWith))) : (d !== N && (h = void 0, i = [a]), (e || c.resolveWith)(h, i))
-                                        }
-                                    },
-                                    k = e ? j : function() {
-                                        try {
-                                            j()
-                                        } catch (a) {
-                                            r.Deferred.exceptionHook && r.Deferred.exceptionHook(a, k.stackTrace), b + 1 >= f && (d !== O && (h = void 0, i = [a]), c.rejectWith(h, i))
-                                        }
-                                    };
-                                b ? k() : (r.Deferred.getStackHook && (k.stackTrace = r.Deferred.getStackHook()), a.setTimeout(k))
-                            }
-                        }
-                        return r.Deferred(function(a) {
-                            c[0][3].add(g(0, a, r.isFunction(e) ? e : N, a.notifyWith)), c[1][3].add(g(0, a, r.isFunction(b) ? b : N)), c[2][3].add(g(0, a, r.isFunction(d) ? d : O))
-                        }).promise()
-                    },
                     promise: function(a) {
-                        return null != a ? r.extend(a, e) : e
+                        return null != a ? n.extend(a, d) : d
                     }
                 },
-                f = {};
-            return r.each(c, function(a, b) {
-                var g = b[2],
-                    h = b[5];
-                e[b[1]] = g.add, h && g.add(function() {
-                    d = h
-                }, c[3 - a][2].disable, c[0][2].lock), g.add(b[3].fire), f[b[0]] = function() {
-                    return f[b[0] + "With"](this === f ? void 0 : this, arguments), this
-                }, f[b[0] + "With"] = g.fireWith
-            }), e.promise(f), b && b.call(f, f), f
+                e = {};
+            return d.pipe = d.then, n.each(b, function(a, f) {
+                var g = f[2],
+                    h = f[3];
+                d[f[1]] = g.add, h && g.add(function() {
+                    c = h
+                }, b[1 ^ a][2].disable, b[2][2].lock), e[f[0]] = function() {
+                    return e[f[0] + "With"](this === e ? d : this, arguments), this
+                }, e[f[0] + "With"] = g.fireWith
+            }), d.promise(e), a && a.call(e, e), e
         },
         when: function(a) {
-            var b = arguments.length,
-                c = b,
-                d = Array(c),
-                e = f.call(arguments),
-                g = r.Deferred(),
-                h = function(a) {
-                    return function(c) {
-                        d[a] = this, e[a] = arguments.length > 1 ? f.call(arguments) : c, --b || g.resolveWith(d, e)
+            var b = 0,
+                c = d.call(arguments),
+                e = c.length,
+                f = 1 !== e || a && n.isFunction(a.promise) ? e : 0,
+                g = 1 === f ? a : n.Deferred(),
+                h = function(a, b, c) {
+                    return function(e) {
+                        b[a] = this, c[a] = arguments.length > 1 ? d.call(arguments) : e, c === i ? g.notifyWith(b, c) : --f || g.resolveWith(b, c)
                     }
-                };
-            if (b <= 1 && (P(a, g.done(h(c)).resolve, g.reject, !b), "pending" === g.state() || r.isFunction(e[c] && e[c].then))) return g.then();
-            while (c--) P(e[c], h(c), g.reject);
-            return g.promise()
+                },
+                i, j, k;
+            if (e > 1)
+                for (i = new Array(e), j = new Array(e), k = new Array(e); e > b; b++) c[b] && n.isFunction(c[b].promise) ? c[b].promise().done(h(b, k, c)).fail(g.reject).progress(h(b, j, i)) : --f;
+            return f || g.resolveWith(k, c), g.promise()
         }
     });
-    var Q = /^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;
-    r.Deferred.exceptionHook = function(b, c) {
-        a.console && a.console.warn && b && Q.test(b.name) && a.console.warn("jQuery.Deferred exception: " + b.message, b.stack, c)
-    }, r.readyException = function(b) {
-        a.setTimeout(function() {
-            throw b
-        })
-    };
-    var R = r.Deferred();
-    r.fn.ready = function(a) {
-        return R.then(a)["catch"](function(a) {
-            r.readyException(a)
-        }), this
-    }, r.extend({
+    var I;
+    n.fn.ready = function(a) {
+        return n.ready.promise().done(a), this
+    }, n.extend({
         isReady: !1,
         readyWait: 1,
+        holdReady: function(a) {
+            a ? n.readyWait++ : n.ready(!0)
+        },
         ready: function(a) {
-            (a === !0 ? --r.readyWait : r.isReady) || (r.isReady = !0, a !== !0 && --r.readyWait > 0 || R.resolveWith(d, [r]))
+            if (a === !0 ? !--n.readyWait : !n.isReady) {
+                if (!z.body) return setTimeout(n.ready);
+                n.isReady = !0, a !== !0 && --n.readyWait > 0 || (I.resolveWith(z, [n]), n.fn.trigger && n(z).trigger("ready").off("ready"))
+            }
         }
-    }), r.ready.then = R.then;
+    });
 
-    function S() {
-        d.removeEventListener("DOMContentLoaded", S),
-            a.removeEventListener("load", S), r.ready()
+    function J() {
+        z.addEventListener ? (z.removeEventListener("DOMContentLoaded", K, !1), a.removeEventListener("load", K, !1)) : (z.detachEvent("onreadystatechange", K), a.detachEvent("onload", K))
     }
-    "complete" === d.readyState || "loading" !== d.readyState && !d.documentElement.doScroll ? a.setTimeout(r.ready) : (d.addEventListener("DOMContentLoaded", S), a.addEventListener("load", S));
-    var T = function(a, b, c, d, e, f, g) {
-            var h = 0,
-                i = a.length,
-                j = null == c;
-            if ("object" === r.type(c)) {
-                e = !0;
-                for (h in c) T(a, b, h, c[h], !0, f, g)
-            } else if (void 0 !== d && (e = !0, r.isFunction(d) || (g = !0), j && (g ? (b.call(a, d), b = null) : (j = b, b = function(a, b, c) {
-                    return j.call(r(a), c)
-                })), b))
-                for (; h < i; h++) b(a[h], c, g ? d : d.call(a[h], h, b(a[h], c)));
-            return e ? a : j ? b.call(a) : i ? b(a[0], c) : f
-        },
-        U = function(a) {
-            return 1 === a.nodeType || 9 === a.nodeType || !+a.nodeType
-        };
 
-    function V() {
-        this.expando = r.expando + V.uid++
+    function K() {
+        (z.addEventListener || "load" === event.type || "complete" === z.readyState) && (J(), n.ready())
     }
-    V.uid = 1, V.prototype = {
-        cache: function(a) {
-            var b = a[this.expando];
-            return b || (b = {}, U(a) && (a.nodeType ? a[this.expando] = b : Object.defineProperty(a, this.expando, {
-                value: b,
-                configurable: !0
-            }))), b
-        },
-        set: function(a, b, c) {
-            var d, e = this.cache(a);
-            if ("string" == typeof b) e[r.camelCase(b)] = c;
-            else
-                for (d in b) e[r.camelCase(d)] = b[d];
-            return e
-        },
-        get: function(a, b) {
-            return void 0 === b ? this.cache(a) : a[this.expando] && a[this.expando][r.camelCase(b)]
-        },
-        access: function(a, b, c) {
-            return void 0 === b || b && "string" == typeof b && void 0 === c ? this.get(a, b) : (this.set(a, b, c), void 0 !== c ? c : b)
-        },
-        remove: function(a, b) {
-            var c, d = a[this.expando];
-            if (void 0 !== d) {
-                if (void 0 !== b) {
-                    Array.isArray(b) ? b = b.map(r.camelCase) : (b = r.camelCase(b), b = b in d ? [b] : b.match(L) || []), c = b.length;
-                    while (c--) delete d[b[c]]
-                }(void 0 === b || r.isEmptyObject(d)) && (a.nodeType ? a[this.expando] = void 0 : delete a[this.expando])
-            }
-        },
-        hasData: function(a) {
-            var b = a[this.expando];
-            return void 0 !== b && !r.isEmptyObject(b)
+    n.ready.promise = function(b) {
+        if (!I)
+            if (I = n.Deferred(), "complete" === z.readyState) setTimeout(n.ready);
+            else if (z.addEventListener) z.addEventListener("DOMContentLoaded", K, !1), a.addEventListener("load", K, !1);
+        else {
+            z.attachEvent("onreadystatechange", K), a.attachEvent("onload", K);
+            var c = !1;
+            try {
+                c = null == a.frameElement && z.documentElement
+            } catch (d) {}
+            c && c.doScroll && ! function e() {
+                if (!n.isReady) {
+                    try {
+                        c.doScroll("left")
+                    } catch (a) {
+                        return setTimeout(e, 50)
+                    }
+                    J(), n.ready()
+                }
+            }()
         }
+        return I.promise(b)
     };
-    var W = new V,
-        X = new V,
-        Y = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,
-        Z = /[A-Z]/g;
-
-    function $(a) {
-        return "true" === a || "false" !== a && ("null" === a ? null : a === +a + "" ? +a : Y.test(a) ? JSON.parse(a) : a)
-    }
+    var L = "undefined",
+        M;
+    for (M in n(l)) break;
+    l.ownLast = "0" !== M, l.inlineBlockNeedsLayout = !1, n(function() {
+            var a, b, c = z.getElementsByTagName("body")[0];
+            c && (a = z.createElement("div"), a.style.cssText = "border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px", b = z.createElement("div"), c.appendChild(a).appendChild(b), typeof b.style.zoom !== L && (b.style.cssText = "border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1", (l.inlineBlockNeedsLayout = 3 === b.offsetWidth) && (c.style.zoom = 1)), c.removeChild(a), a = b = null)
+        }),
+        function() {
+            var a = z.createElement("div");
+            if (null == l.deleteExpando) {
+                l.deleteExpando = !0;
+                try {
+                    delete a.test
+                } catch (b) {
+                    l.deleteExpando = !1
+                }
+            }
+            a = null
+        }(), n.acceptData = function(a) {
+            var b = n.noData[(a.nodeName + " ").toLowerCase()],
+                c = +a.nodeType || 1;
+            return 1 !== c && 9 !== c ? !1 : !b || b !== !0 && a.getAttribute("classid") === b
+        };
+    var N = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,
+        O = /([A-Z])/g;
 
-    function _(a, b, c) {
-        var d;
-        if (void 0 === c && 1 === a.nodeType)
-            if (d = "data-" + b.replace(Z, "-$&").toLowerCase(), c = a.getAttribute(d), "string" == typeof c) {
+    function P(a, b, c) {
+        if (void 0 === c && 1 === a.nodeType) {
+            var d = "data-" + b.replace(O, "-$1").toLowerCase();
+            if (c = a.getAttribute(d), "string" == typeof c) {
                 try {
-                    c = $(c)
+                    c = "true" === c ? !0 : "false" === c ? !1 : "null" === c ? null : +c + "" === c ? +c : N.test(c) ? n.parseJSON(c) : c
                 } catch (e) {}
-                X.set(a, b, c)
-            } else c = void 0;
+                n.data(a, b, c)
+            } else c = void 0
+        }
         return c
     }
-    r.extend({
+
+    function Q(a) {
+        var b;
+        for (b in a)
+            if (("data" !== b || !n.isEmptyObject(a[b])) && "toJSON" !== b) return !1;
+        return !0
+    }
+
+    function R(a, b, d, e) {
+        if (n.acceptData(a)) {
+            var f, g, h = n.expando,
+                i = a.nodeType,
+                j = i ? n.cache : a,
+                k = i ? a[h] : a[h] && h;
+            if (k && j[k] && (e || j[k].data) || void 0 !== d || "string" != typeof b) return k || (k = i ? a[h] = c.pop() || n.guid++ : h), j[k] || (j[k] = i ? {} : {
+                toJSON: n.noop
+            }), ("object" == typeof b || "function" == typeof b) && (e ? j[k] = n.extend(j[k], b) : j[k].data = n.extend(j[k].data, b)), g = j[k], e || (g.data || (g.data = {}), g = g.data), void 0 !== d && (g[n.camelCase(b)] = d), "string" == typeof b ? (f = g[b], null == f && (f = g[n.camelCase(b)])) : f = g, f
+        }
+    }
+
+    function S(a, b, c) {
+        if (n.acceptData(a)) {
+            var d, e, f = a.nodeType,
+                g = f ? n.cache : a,
+                h = f ? a[n.expando] : n.expando;
+            if (g[h]) {
+                if (b && (d = c ? g[h] : g[h].data)) {
+                    n.isArray(b) ? b = b.concat(n.map(b, n.camelCase)) : b in d ? b = [b] : (b = n.camelCase(b), b = b in d ? [b] : b.split(" ")), e = b.length;
+                    while (e--) delete d[b[e]];
+                    if (c ? !Q(d) : !n.isEmptyObject(d)) return
+                }(c || (delete g[h].data, Q(g[h]))) && (f ? n.cleanData([a], !0) : l.deleteExpando || g != g.window ? delete g[h] : g[h] = null)
+            }
+        }
+    }
+    n.extend({
+        cache: {},
+        noData: {
+            "applet ": !0,
+            "embed ": !0,
+            "object ": "clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"
+        },
         hasData: function(a) {
-            return X.hasData(a) || W.hasData(a)
+            return a = a.nodeType ? n.cache[a[n.expando]] : a[n.expando], !!a && !Q(a)
         },
         data: function(a, b, c) {
-            return X.access(a, b, c)
+            return R(a, b, c)
         },
         removeData: function(a, b) {
-            X.remove(a, b)
+            return S(a, b)
         },
         _data: function(a, b, c) {
-            return W.access(a, b, c)
+            return R(a, b, c, !0)
         },
         _removeData: function(a, b) {
-            W.remove(a, b)
+            return S(a, b, !0)
         }
-    }), r.fn.extend({
+    }), n.fn.extend({
         data: function(a, b) {
             var c, d, e, f = this[0],
                 g = f && f.attributes;
             if (void 0 === a) {
-                if (this.length && (e = X.get(f), 1 === f.nodeType && !W.get(f, "hasDataAttrs"))) {
+                if (this.length && (e = n.data(f), 1 === f.nodeType && !n._data(f, "parsedAttrs"))) {
                     c = g.length;
-                    while (c--) g[c] && (d = g[c].name, 0 === d.indexOf("data-") && (d = r.camelCase(d.slice(5)), _(f, d, e[d])));
-                    W.set(f, "hasDataAttrs", !0)
+                    while (c--) d = g[c].name, 0 === d.indexOf("data-") && (d = n.camelCase(d.slice(5)), P(f, d, e[d]));
+                    n._data(f, "parsedAttrs", !0)
                 }
                 return e
             }
             return "object" == typeof a ? this.each(function() {
-                X.set(this, a)
-            }) : T(this, function(b) {
-                var c;
-                if (f && void 0 === b) {
-                    if (c = X.get(f, a), void 0 !== c) return c;
-                    if (c = _(f, a), void 0 !== c) return c
-                } else this.each(function() {
-                    X.set(this, a, b)
-                })
-            }, null, b, arguments.length > 1, null, !0)
+                n.data(this, a)
+            }) : arguments.length > 1 ? this.each(function() {
+                n.data(this, a, b)
+            }) : f ? P(f, a, n.data(f, a)) : void 0
         },
         removeData: function(a) {
             return this.each(function() {
-                X.remove(this, a)
+                n.removeData(this, a)
             })
         }
-    }), r.extend({
+    }), n.extend({
         queue: function(a, b, c) {
             var d;
-            if (a) return b = (b || "fx") + "queue", d = W.get(a, b), c && (!d || Array.isArray(c) ? d = W.access(a, b, r.makeArray(c)) : d.push(c)), d || []
+            return a ? (b = (b || "fx") + "queue", d = n._data(a, b), c && (!d || n.isArray(c) ? d = n._data(a, b, n.makeArray(c)) : d.push(c)), d || []) : void 0
         },
         dequeue: function(a, b) {
             b = b || "fx";
-            var c = r.queue(a, b),
+            var c = n.queue(a, b),
                 d = c.length,
                 e = c.shift(),
-                f = r._queueHooks(a, b),
+                f = n._queueHooks(a, b),
                 g = function() {
-                    r.dequeue(a, b)
+                    n.dequeue(a, b)
                 };
             "inprogress" === e && (e = c.shift(), d--), e && ("fx" === b && c.unshift("inprogress"), delete f.stop, e.call(a, g, f)), !d && f && f.empty.fire()
         },
         _queueHooks: function(a, b) {
             var c = b + "queueHooks";
-            return W.get(a, c) || W.access(a, c, {
-                empty: r.Callbacks("once memory").add(function() {
-                    W.remove(a, [b + "queue", c])
+            return n._data(a, c) || n._data(a, c, {
+                empty: n.Callbacks("once memory").add(function() {
+                    n._removeData(a, b + "queue"), n._removeData(a, c)
                 })
             })
         }
-    }), r.fn.extend({
+    }), n.fn.extend({
         queue: function(a, b) {
             var c = 2;
-            return "string" != typeof a && (b = a, a = "fx", c--), arguments.length < c ? r.queue(this[0], a) : void 0 === b ? this : this.each(function() {
-                var c = r.queue(this, a, b);
-                r._queueHooks(this, a), "fx" === a && "inprogress" !== c[0] && r.dequeue(this, a)
+            return "string" != typeof a && (b = a, a = "fx", c--), arguments.length < c ? n.queue(this[0], a) : void 0 === b ? this : this.each(function() {
+                var c = n.queue(this, a, b);
+                n._queueHooks(this, a), "fx" === a && "inprogress" !== c[0] && n.dequeue(this, a)
             })
         },
         dequeue: function(a) {
             return this.each(function() {
-                r.dequeue(this, a)
+                n.dequeue(this, a)
             })
         },
         clearQueue: function(a) {
             return this.queue(a || "fx", [])
         },
         promise: function(a, b) {
             var c, d = 1,
-                e = r.Deferred(),
+                e = n.Deferred(),
                 f = this,
                 g = this.length,
                 h = function() {
                     --d || e.resolveWith(f, [f])
                 };
             "string" != typeof a && (b = a, a = void 0), a = a || "fx";
-            while (g--) c = W.get(f[g], a + "queueHooks"), c && c.empty && (d++, c.empty.add(h));
+            while (g--) c = n._data(f[g], a + "queueHooks"), c && c.empty && (d++, c.empty.add(h));
             return h(), e.promise(b)
         }
     });
-    var aa = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,
-        ba = new RegExp("^(?:([+-])=|)(" + aa + ")([a-z%]*)$", "i"),
-        ca = ["Top", "Right", "Bottom", "Left"],
-        da = function(a, b) {
-            return a = b || a, "none" === a.style.display || "" === a.style.display && r.contains(a.ownerDocument, a) && "none" === r.css(a, "display")
-        },
-        ea = function(a, b, c, d) {
-            var e, f, g = {};
-            for (f in b) g[f] = a.style[f], a.style[f] = b[f];
-            e = c.apply(a, d || []);
-            for (f in b) a.style[f] = g[f];
-            return e
-        };
-
-    function fa(a, b, c, d) {
-        var e, f = 1,
-            g = 20,
-            h = d ? function() {
-                return d.cur()
-            } : function() {
-                return r.css(a, b, "")
-            },
-            i = h(),
-            j = c && c[3] || (r.cssNumber[b] ? "" : "px"),
-            k = (r.cssNumber[b] || "px" !== j && +i) && ba.exec(r.css(a, b));
-        if (k && k[3] !== j) {
-            j = j || k[3], c = c || [], k = +i || 1;
-            do f = f || ".5", k /= f, r.style(a, b, k + j); while (f !== (f = h() / i) && 1 !== f && --g)
-        }
-        return c && (k = +k || +i || 0, e = c[1] ? k + (c[1] + 1) * c[2] : +c[2], d && (d.unit = j, d.start = k, d.end = e)), e
-    }
-    var ga = {};
-
-    function ha(a) {
-        var b, c = a.ownerDocument,
-            d = a.nodeName,
-            e = ga[d];
-        return e ? e : (b = c.body.appendChild(c.createElement(d)), e = r.css(b, "display"), b.parentNode.removeChild(b), "none" === e && (e = "block"), ga[d] = e, e)
-    }
-
-    function ia(a, b) {
-        for (var c, d, e = [], f = 0, g = a.length; f < g; f++) d = a[f], d.style && (c = d.style.display, b ? ("none" === c && (e[f] = W.get(d, "display") || null, e[f] || (d.style.display = "")), "" === d.style.display && da(d) && (e[f] = ha(d))) : "none" !== c && (e[f] = "none", W.set(d, "display", c)));
-        for (f = 0; f < g; f++) null != e[f] && (a[f].style.display = e[f]);
-        return a
-    }
-    r.fn.extend({
-        show: function() {
-            return ia(this, !0)
+    var T = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,
+        U = ["Top", "Right", "Bottom", "Left"],
+        V = function(a, b) {
+            return a = b || a, "none" === n.css(a, "display") || !n.contains(a.ownerDocument, a)
         },
-        hide: function() {
-            return ia(this)
+        W = n.access = function(a, b, c, d, e, f, g) {
+            var h = 0,
+                i = a.length,
+                j = null == c;
+            if ("object" === n.type(c)) {
+                e = !0;
+                for (h in c) n.access(a, b, h, c[h], !0, f, g)
+            } else if (void 0 !== d && (e = !0, n.isFunction(d) || (g = !0), j && (g ? (b.call(a, d), b = null) : (j = b, b = function(a, b, c) {
+                    return j.call(n(a), c)
+                })), b))
+                for (; i > h; h++) b(a[h], c, g ? d : d.call(a[h], h, b(a[h], c)));
+            return e ? a : j ? b.call(a) : i ? b(a[0], c) : f
         },
-        toggle: function(a) {
-            return "boolean" == typeof a ? a ? this.show() : this.hide() : this.each(function() {
-                da(this) ? r(this).show() : r(this).hide()
-            })
-        }
-    });
-    var ja = /^(?:checkbox|radio)$/i,
-        ka = /<([a-z][^\/\0>\x20\t\r\n\f]+)/i,
-        la = /^$|\/(?:java|ecma)script/i,
-        ma = {
-            option: [1, "<select multiple='multiple'>", "</select>"],
-            thead: [1, "<table>", "</table>"],
-            col: [2, "<table><colgroup>", "</colgroup></table>"],
-            tr: [2, "<table><tbody>", "</tbody></table>"],
-            td: [3, "<table><tbody><tr>", "</tr></tbody></table>"],
-            _default: [0, "", ""]
-        };
-    ma.optgroup = ma.option, ma.tbody = ma.tfoot = ma.colgroup = ma.caption = ma.thead, ma.th = ma.td;
-
-    function na(a, b) {
-        var c;
-        return c = "undefined" != typeof a.getElementsByTagName ? a.getElementsByTagName(b || "*") : "undefined" != typeof a.querySelectorAll ? a.querySelectorAll(b || "*") : [], void 0 === b || b && B(a, b) ? r.merge([a], c) : c
-    }
-
-    function oa(a, b) {
-        for (var c = 0, d = a.length; c < d; c++) W.set(a[c], "globalEval", !b || W.get(b[c], "globalEval"))
-    }
-    var pa = /<|&#?\w+;/;
-
-    function qa(a, b, c, d, e) {
-        for (var f, g, h, i, j, k, l = b.createDocumentFragment(), m = [], n = 0, o = a.length; n < o; n++)
-            if (f = a[n], f || 0 === f)
-                if ("object" === r.type(f)) r.merge(m, f.nodeType ? [f] : f);
-                else if (pa.test(f)) {
-            g = g || l.appendChild(b.createElement("div")), h = (ka.exec(f) || ["", ""])[1].toLowerCase(), i = ma[h] || ma._default, g.innerHTML = i[1] + r.htmlPrefilter(f) + i[2], k = i[0];
-            while (k--) g = g.lastChild;
-            r.merge(m, g.childNodes), g = l.firstChild, g.textContent = ""
-        } else m.push(b.createTextNode(f));
-        l.textContent = "", n = 0;
-        while (f = m[n++])
-            if (d && r.inArray(f, d) > -1) e && e.push(f);
-            else if (j = r.contains(f.ownerDocument, f), g = na(l.appendChild(f), "script"), j && oa(g), c) {
-            k = 0;
-            while (f = g[k++]) la.test(f.type || "") && c.push(f)
+        X = /^(?:checkbox|radio)$/i;
+    ! function() {
+        var a = z.createDocumentFragment(),
+            b = z.createElement("div"),
+            c = z.createElement("input");
+        if (b.setAttribute("className", "t"), b.innerHTML = "  <link/><table></table><a href='/a'>a</a>", l.leadingWhitespace = 3 === b.firstChild.nodeType, l.tbody = !b.getElementsByTagName("tbody").length, l.htmlSerialize = !!b.getElementsByTagName("link").length, l.html5Clone = "<:nav></:nav>" !== z.createElement("nav").cloneNode(!0).outerHTML, c.type = "checkbox", c.checked = !0, a.appendChild(c), l.appendChecked = c.checked, b.innerHTML = "<textarea>x</textarea>", l.noCloneChecked = !!b.cloneNode(!0).lastChild.defaultValue, a.appendChild(b), b.innerHTML = "<input type='radio' checked='checked' name='t'/>", l.checkClone = b.cloneNode(!0).cloneNode(!0).lastChild.checked, l.noCloneEvent = !0, b.attachEvent && (b.attachEvent("onclick", function() {
+                l.noCloneEvent = !1
+            }), b.cloneNode(!0).click()), null == l.deleteExpando) {
+            l.deleteExpando = !0;
+            try {
+                delete b.test
+            } catch (d) {
+                l.deleteExpando = !1
+            }
         }
-        return l
-    }! function() {
-        var a = d.createDocumentFragment(),
-            b = a.appendChild(d.createElement("div")),
-            c = d.createElement("input");
-        c.setAttribute("type", "radio"), c.setAttribute("checked", "checked"), c.setAttribute("name", "t"), b.appendChild(c), o.checkClone = b.cloneNode(!0).cloneNode(!0).lastChild.checked, b.innerHTML = "<textarea>x</textarea>", o.noCloneChecked = !!b.cloneNode(!0).lastChild.defaultValue
+        a = b = c = null
+    }(),
+    function() {
+        var b, c, d = z.createElement("div");
+        for (b in {
+                submit: !0,
+                change: !0,
+                focusin: !0
+            }) c = "on" + b, (l[b + "Bubbles"] = c in a) || (d.setAttribute(c, "t"), l[b + "Bubbles"] = d.attributes[c].expando === !1);
+        d = null
     }();
-    var ra = d.documentElement,
-        sa = /^key/,
-        ta = /^(?:mouse|pointer|contextmenu|drag|drop)|click/,
-        ua = /^([^.]*)(?:\.(.+)|)/;
+    var Y = /^(?:input|select|textarea)$/i,
+        Z = /^key/,
+        $ = /^(?:mouse|contextmenu)|click/,
+        _ = /^(?:focusinfocus|focusoutblur)$/,
+        ab = /^([^.]*)(?:\.(.+)|)$/;
 
-    function va() {
+    function bb() {
         return !0
     }
 
-    function wa() {
+    function cb() {
         return !1
     }
 
-    function xa() {
+    function db() {
         try {
-            return d.activeElement
+            return z.activeElement
         } catch (a) {}
     }
-
-    function ya(a, b, c, d, e, f) {
-        var g, h;
-        if ("object" == typeof b) {
-            "string" != typeof c && (d = d || c, c = void 0);
-            for (h in b) ya(a, h, c, d, b[h], f);
-            return a
-        }
-        if (null == d && null == e ? (e = c, d = c = void 0) : null == e && ("string" == typeof c ? (e = d, d = void 0) : (e = d, d = c, c = void 0)), e === !1) e = wa;
-        else if (!e) return a;
-        return 1 === f && (g = e, e = function(a) {
-            return r().off(a), g.apply(this, arguments)
-        }, e.guid = g.guid || (g.guid = r.guid++)), a.each(function() {
-            r.event.add(this, b, e, d, c)
-        })
-    }
-    r.event = {
+    n.event = {
         global: {},
         add: function(a, b, c, d, e) {
-            var f, g, h, i, j, k, l, m, n, o, p, q = W.get(a);
-            if (q) {
-                c.handler && (f = c, c = f.handler, e = f.selector), e && r.find.matchesSelector(ra, e), c.guid || (c.guid = r.guid++), (i = q.events) || (i = q.events = {}), (g = q.handle) || (g = q.handle = function(b) {
-                    return "undefined" != typeof r && r.event.triggered !== b.type ? r.event.dispatch.apply(a, arguments) : void 0
-                }), b = (b || "").match(L) || [""], j = b.length;
-                while (j--) h = ua.exec(b[j]) || [], n = p = h[1], o = (h[2] || "").split(".").sort(), n && (l = r.event.special[n] || {}, n = (e ? l.delegateType : l.bindType) || n, l = r.event.special[n] || {}, k = r.extend({
-                    type: n,
-                    origType: p,
+            var f, g, h, i, j, k, l, m, o, p, q, r = n._data(a);
+            if (r) {
+                c.handler && (i = c, c = i.handler, e = i.selector), c.guid || (c.guid = n.guid++), (g = r.events) || (g = r.events = {}), (k = r.handle) || (k = r.handle = function(a) {
+                    return typeof n === L || a && n.event.triggered === a.type ? void 0 : n.event.dispatch.apply(k.elem, arguments)
+                }, k.elem = a), b = (b || "").match(F) || [""], h = b.length;
+                while (h--) f = ab.exec(b[h]) || [], o = q = f[1], p = (f[2] || "").split(".").sort(), o && (j = n.event.special[o] || {}, o = (e ? j.delegateType : j.bindType) || o, j = n.event.special[o] || {}, l = n.extend({
+                    type: o,
+                    origType: q,
                     data: d,
                     handler: c,
                     guid: c.guid,
                     selector: e,
-                    needsContext: e && r.expr.match.needsContext.test(e),
-                    namespace: o.join(".")
-                }, f), (m = i[n]) || (m = i[n] = [], m.delegateCount = 0, l.setup && l.setup.call(a, d, o, g) !== !1 || a.addEventListener && a.addEventListener(n, g)), l.add && (l.add.call(a, k), k.handler.guid || (k.handler.guid = c.guid)), e ? m.splice(m.delegateCount++, 0, k) : m.push(k), r.event.global[n] = !0)
+                    needsContext: e && n.expr.match.needsContext.test(e),
+                    namespace: p.join(".")
+                }, i), (m = g[o]) || (m = g[o] = [], m.delegateCount = 0, j.setup && j.setup.call(a, d, p, k) !== !1 || (a.addEventListener ? a.addEventListener(o, k, !1) : a.attachEvent && a.attachEvent("on" + o, k))), j.add && (j.add.call(a, l), l.handler.guid || (l.handler.guid = c.guid)), e ? m.splice(m.delegateCount++, 0, l) : m.push(l), n.event.global[o] = !0);
+                a = null
             }
         },
         remove: function(a, b, c, d, e) {
-            var f, g, h, i, j, k, l, m, n, o, p, q = W.hasData(a) && W.get(a);
-            if (q && (i = q.events)) {
-                b = (b || "").match(L) || [""], j = b.length;
+            var f, g, h, i, j, k, l, m, o, p, q, r = n.hasData(a) && n._data(a);
+            if (r && (k = r.events)) {
+                b = (b || "").match(F) || [""], j = b.length;
                 while (j--)
-                    if (h = ua.exec(b[j]) || [], n = p = h[1], o = (h[2] || "").split(".").sort(), n) {
-                        l = r.event.special[n] || {}, n = (d ? l.delegateType : l.bindType) || n, m = i[n] || [], h = h[2] && new RegExp("(^|\\.)" + o.join("\\.(?:.*\\.|)") + "(\\.|$)"), g = f = m.length;
-                        while (f--) k = m[f], !e && p !== k.origType || c && c.guid !== k.guid || h && !h.test(k.namespace) || d && d !== k.selector && ("**" !== d || !k.selector) || (m.splice(f, 1), k.selector && m.delegateCount--, l.remove && l.remove.call(a, k));
-                        g && !m.length && (l.teardown && l.teardown.call(a, o, q.handle) !== !1 || r.removeEvent(a, n, q.handle), delete i[n])
+                    if (h = ab.exec(b[j]) || [], o = q = h[1], p = (h[2] || "").split(".").sort(), o) {
+                        l = n.event.special[o] || {}, o = (d ? l.delegateType : l.bindType) || o, m = k[o] || [], h = h[2] && new RegExp("(^|\\.)" + p.join("\\.(?:.*\\.|)") + "(\\.|$)"), i = f = m.length;
+                        while (f--) g = m[f], !e && q !== g.origType || c && c.guid !== g.guid || h && !h.test(g.namespace) || d && d !== g.selector && ("**" !== d || !g.selector) || (m.splice(f, 1), g.selector && m.delegateCount--, l.remove && l.remove.call(a, g));
+                        i && !m.length && (l.teardown && l.teardown.call(a, p, r.handle) !== !1 || n.removeEvent(a, o, r.handle), delete k[o])
                     } else
-                        for (n in i) r.event.remove(a, n + b[j], c, d, !0);
-                r.isEmptyObject(i) && W.remove(a, "handle events")
+                        for (o in k) n.event.remove(a, o + b[j], c, d, !0);
+                n.isEmptyObject(k) && (delete r.handle, n._removeData(a, "events"))
+            }
+        },
+        trigger: function(b, c, d, e) {
+            var f, g, h, i, k, l, m, o = [d || z],
+                p = j.call(b, "type") ? b.type : b,
+                q = j.call(b, "namespace") ? b.namespace.split(".") : [];
+            if (h = l = d = d || z, 3 !== d.nodeType && 8 !== d.nodeType && !_.test(p + n.event.triggered) && (p.indexOf(".") >= 0 && (q = p.split("."), p = q.shift(), q.sort()), g = p.indexOf(":") < 0 && "on" + p, b = b[n.expando] ? b : new n.Event(p, "object" == typeof b && b), b.isTrigger = e ? 2 : 3, b.namespace = q.join("."), b.namespace_re = b.namespace ? new RegExp("(^|\\.)" + q.join("\\.(?:.*\\.|)") + "(\\.|$)") : null, b.result = void 0, b.target || (b.target = d), c = null == c ? [b] : n.makeArray(c, [b]), k = n.event.special[p] || {}, e || !k.trigger || k.trigger.apply(d, c) !== !1)) {
+                if (!e && !k.noBubble && !n.isWindow(d)) {
+                    for (i = k.delegateType || p, _.test(i + p) || (h = h.parentNode); h; h = h.parentNode) o.push(h), l = h;
+                    l === (d.ownerDocument || z) && o.push(l.defaultView || l.parentWindow || a)
+                }
+                m = 0;
+                while ((h = o[m++]) && !b.isPropagationStopped()) b.type = m > 1 ? i : k.bindType || p, f = (n._data(h, "events") || {})[b.type] && n._data(h, "handle"), f && f.apply(h, c), f = g && h[g], f && f.apply && n.acceptData(h) && (b.result = f.apply(h, c), b.result === !1 && b.preventDefault());
+                if (b.type = p, !e && !b.isDefaultPrevented() && (!k._default || k._default.apply(o.pop(), c) === !1) && n.acceptData(d) && g && d[p] && !n.isWindow(d)) {
+                    l = d[g], l && (d[g] = null), n.event.triggered = p;
+                    try {
+                        d[p]()
+                    } catch (r) {}
+                    n.event.triggered = void 0, l && (d[g] = l)
+                }
+                return b.result
             }
         },
         dispatch: function(a) {
-            var b = r.event.fix(a),
-                c, d, e, f, g, h, i = new Array(arguments.length),
-                j = (W.get(this, "events") || {})[b.type] || [],
-                k = r.event.special[b.type] || {};
-            for (i[0] = b, c = 1; c < arguments.length; c++) i[c] = arguments[c];
-            if (b.delegateTarget = this, !k.preDispatch || k.preDispatch.call(this, b) !== !1) {
-                h = r.event.handlers.call(this, b, j), c = 0;
-                while ((f = h[c++]) && !b.isPropagationStopped()) {
-                    b.currentTarget = f.elem, d = 0;
-                    while ((g = f.handlers[d++]) && !b.isImmediatePropagationStopped()) b.rnamespace && !b.rnamespace.test(g.namespace) || (b.handleObj = g, b.data = g.data, e = ((r.event.special[g.origType] || {}).handle || g.handler).apply(f.elem, i), void 0 !== e && (b.result = e) === !1 && (b.preventDefault(), b.stopPropagation()))
+            a = n.event.fix(a);
+            var b, c, e, f, g, h = [],
+                i = d.call(arguments),
+                j = (n._data(this, "events") || {})[a.type] || [],
+                k = n.event.special[a.type] || {};
+            if (i[0] = a, a.delegateTarget = this, !k.preDispatch || k.preDispatch.call(this, a) !== !1) {
+                h = n.event.handlers.call(this, a, j), b = 0;
+                while ((f = h[b++]) && !a.isPropagationStopped()) {
+                    a.currentTarget = f.elem, g = 0;
+                    while ((e = f.handlers[g++]) && !a.isImmediatePropagationStopped())(!a.namespace_re || a.namespace_re.test(e.namespace)) && (a.handleObj = e, a.data = e.data, c = ((n.event.special[e.origType] || {}).handle || e.handler).apply(f.elem, i), void 0 !== c && (a.result = c) === !1 && (a.preventDefault(), a.stopPropagation()))
                 }
-                return k.postDispatch && k.postDispatch.call(this, b), b.result
+                return k.postDispatch && k.postDispatch.call(this, a), a.result
             }
         },
         handlers: function(a, b) {
-            var c, d, e, f, g, h = [],
-                i = b.delegateCount,
-                j = a.target;
-            if (i && j.nodeType && !("click" === a.type && a.button >= 1))
-                for (; j !== this; j = j.parentNode || this)
-                    if (1 === j.nodeType && ("click" !== a.type || j.disabled !== !0)) {
-                        for (f = [], g = {}, c = 0; c < i; c++) d = b[c], e = d.selector + " ", void 0 === g[e] && (g[e] = d.needsContext ? r(e, this).index(j) > -1 : r.find(e, this, null, [j]).length), g[e] && f.push(d);
-                        f.length && h.push({
-                            elem: j,
-                            handlers: f
+            var c, d, e, f, g = [],
+                h = b.delegateCount,
+                i = a.target;
+            if (h && i.nodeType && (!a.button || "click" !== a.type))
+                for (; i != this; i = i.parentNode || this)
+                    if (1 === i.nodeType && (i.disabled !== !0 || "click" !== a.type)) {
+                        for (e = [], f = 0; h > f; f++) d = b[f], c = d.selector + " ", void 0 === e[c] && (e[c] = d.needsContext ? n(c, this).index(i) >= 0 : n.find(c, this, null, [i]).length), e[c] && e.push(d);
+                        e.length && g.push({
+                            elem: i,
+                            handlers: e
                         })
-                    } return j = this, i < b.length && h.push({
-                elem: j,
-                handlers: b.slice(i)
-            }), h
-        },
-        addProp: function(a, b) {
-            Object.defineProperty(r.Event.prototype, a, {
-                enumerable: !0,
-                configurable: !0,
-                get: r.isFunction(b) ? function() {
-                    if (this.originalEvent) return b(this.originalEvent)
-                } : function() {
-                    if (this.originalEvent) return this.originalEvent[a]
-                },
-                set: function(b) {
-                    Object.defineProperty(this, a, {
-                        enumerable: !0,
-                        configurable: !0,
-                        writable: !0,
-                        value: b
-                    })
-                }
-            })
+                    } return h < b.length && g.push({
+                elem: this,
+                handlers: b.slice(h)
+            }), g
         },
         fix: function(a) {
-            return a[r.expando] ? a : new r.Event(a)
+            if (a[n.expando]) return a;
+            var b, c, d, e = a.type,
+                f = a,
+                g = this.fixHooks[e];
+            g || (this.fixHooks[e] = g = $.test(e) ? this.mouseHooks : Z.test(e) ? this.keyHooks : {}), d = g.props ? this.props.concat(g.props) : this.props, a = new n.Event(f), b = d.length;
+            while (b--) c = d[b], a[c] = f[c];
+            return a.target || (a.target = f.srcElement || z), 3 === a.target.nodeType && (a.target = a.target.parentNode), a.metaKey = !!a.metaKey, g.filter ? g.filter(a, f) : a
+        },
+        props: "altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
+        fixHooks: {},
+        keyHooks: {
+            props: "char charCode key keyCode".split(" "),
+            filter: function(a, b) {
+                return null == a.which && (a.which = null != b.charCode ? b.charCode : b.keyCode), a
+            }
+        },
+        mouseHooks: {
+            props: "button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
+            filter: function(a, b) {
+                var c, d, e, f = b.button,
+                    g = b.fromElement;
+                return null == a.pageX && null != b.clientX && (d = a.target.ownerDocument || z, e = d.documentElement, c = d.body, a.pageX = b.clientX + (e && e.scrollLeft || c && c.scrollLeft || 0) - (e && e.clientLeft || c && c.clientLeft || 0), a.pageY = b.clientY + (e && e.scrollTop || c && c.scrollTop || 0) - (e && e.clientTop || c && c.clientTop || 0)), !a.relatedTarget && g && (a.relatedTarget = g === a.target ? b.toElement : g), a.which || void 0 === f || (a.which = 1 & f ? 1 : 2 & f ? 3 : 4 & f ? 2 : 0), a
+            }
         },
         special: {
             load: {
                 noBubble: !0
             },
             focus: {
                 trigger: function() {
-                    if (this !== xa() && this.focus) return this.focus(), !1
+                    if (this !== db() && this.focus) try {
+                        return this.focus(), !1
+                    } catch (a) {}
                 },
                 delegateType: "focusin"
             },
             blur: {
                 trigger: function() {
-                    if (this === xa() && this.blur) return this.blur(), !1
+                    return this === db() && this.blur ? (this.blur(), !1) : void 0
                 },
                 delegateType: "focusout"
             },
             click: {
                 trigger: function() {
-                    if ("checkbox" === this.type && this.click && B(this, "input")) return this.click(), !1
+                    return n.nodeName(this, "input") && "checkbox" === this.type && this.click ? (this.click(), !1) : void 0
                 },
                 _default: function(a) {
-                    return B(a.target, "a")
+                    return n.nodeName(a.target, "a")
                 }
             },
             beforeunload: {
                 postDispatch: function(a) {
-                    void 0 !== a.result && a.originalEvent && (a.originalEvent.returnValue = a.result)
+                    void 0 !== a.result && (a.originalEvent.returnValue = a.result)
                 }
             }
+        },
+        simulate: function(a, b, c, d) {
+            var e = n.extend(new n.Event, c, {
+                type: a,
+                isSimulated: !0,
+                originalEvent: {}
+            });
+            d ? n.event.trigger(e, null, b) : n.event.dispatch.call(b, e), e.isDefaultPrevented() && c.preventDefault()
         }
-    }, r.removeEvent = function(a, b, c) {
-        a.removeEventListener && a.removeEventListener(b, c)
-    }, r.Event = function(a, b) {
-        return this instanceof r.Event ? (a && a.type ? (this.originalEvent = a, this.type = a.type, this.isDefaultPrevented = a.defaultPrevented || void 0 === a.defaultPrevented && a.returnValue === !1 ? va : wa, this.target = a.target && 3 === a.target.nodeType ? a.target.parentNode : a.target, this.currentTarget = a.currentTarget, this.relatedTarget = a.relatedTarget) : this.type = a, b && r.extend(this, b), this.timeStamp = a && a.timeStamp || r.now(), void(this[r.expando] = !0)) : new r.Event(a, b)
-    }, r.Event.prototype = {
-        constructor: r.Event,
-        isDefaultPrevented: wa,
-        isPropagationStopped: wa,
-        isImmediatePropagationStopped: wa,
-        isSimulated: !1,
+    }, n.removeEvent = z.removeEventListener ? function(a, b, c) {
+        a.removeEventListener && a.removeEventListener(b, c, !1)
+    } : function(a, b, c) {
+        var d = "on" + b;
+        a.detachEvent && (typeof a[d] === L && (a[d] = null), a.detachEvent(d, c))
+    }, n.Event = function(a, b) {
+        return this instanceof n.Event ? (a && a.type ? (this.originalEvent = a, this.type = a.type, this.isDefaultPrevented = a.defaultPrevented || void 0 === a.defaultPrevented && (a.returnValue === !1 || a.getPreventDefault && a.getPreventDefault()) ? bb : cb) : this.type = a, b && n.extend(this, b), this.timeStamp = a && a.timeStamp || n.now(), void(this[n.expando] = !0)) : new n.Event(a, b)
+    }, n.Event.prototype = {
+        isDefaultPrevented: cb,
+        isPropagationStopped: cb,
+        isImmediatePropagationStopped: cb,
         preventDefault: function() {
             var a = this.originalEvent;
-            this.isDefaultPrevented = va, a && !this.isSimulated && a.preventDefault()
+            this.isDefaultPrevented = bb, a && (a.preventDefault ? a.preventDefault() : a.returnValue = !1)
         },
         stopPropagation: function() {
             var a = this.originalEvent;
-            this.isPropagationStopped = va, a && !this.isSimulated && a.stopPropagation()
+            this.isPropagationStopped = bb, a && (a.stopPropagation && a.stopPropagation(), a.cancelBubble = !0)
         },
         stopImmediatePropagation: function() {
-            var a = this.originalEvent;
-            this.isImmediatePropagationStopped = va, a && !this.isSimulated && a.stopImmediatePropagation(), this.stopPropagation()
-        }
-    }, r.each({
-        altKey: !0,
-        bubbles: !0,
-        cancelable: !0,
-        changedTouches: !0,
-        ctrlKey: !0,
-        detail: !0,
-        eventPhase: !0,
-        metaKey: !0,
-        pageX: !0,
-        pageY: !0,
-        shiftKey: !0,
-        view: !0,
-        "char": !0,
-        charCode: !0,
-        key: !0,
-        keyCode: !0,
-        button: !0,
-        buttons: !0,
-        clientX: !0,
-        clientY: !0,
-        offsetX: !0,
-        offsetY: !0,
-        pointerId: !0,
-        pointerType: !0,
-        screenX: !0,
-        screenY: !0,
-        targetTouches: !0,
-        toElement: !0,
-        touches: !0,
-        which: function(a) {
-            var b = a.button;
-            return null == a.which && sa.test(a.type) ? null != a.charCode ? a.charCode : a.keyCode : !a.which && void 0 !== b && ta.test(a.type) ? 1 & b ? 1 : 2 & b ? 3 : 4 & b ? 2 : 0 : a.which
+            this.isImmediatePropagationStopped = bb, this.stopPropagation()
         }
-    }, r.event.addProp), r.each({
+    }, n.each({
         mouseenter: "mouseover",
-        mouseleave: "mouseout",
-        pointerenter: "pointerover",
-        pointerleave: "pointerout"
+        mouseleave: "mouseout"
     }, function(a, b) {
-        r.event.special[a] = {
+        n.event.special[a] = {
             delegateType: b,
             bindType: b,
             handle: function(a) {
                 var c, d = this,
                     e = a.relatedTarget,
                     f = a.handleObj;
-                return e && (e === d || r.contains(d, e)) || (a.type = f.origType, c = f.handler.apply(this, arguments), a.type = b), c
+                return (!e || e !== d && !n.contains(d, e)) && (a.type = f.origType, c = f.handler.apply(this, arguments), a.type = b), c
             }
         }
-    }), r.fn.extend({
-        on: function(a, b, c, d) {
-            return ya(this, a, b, c, d)
+    }), l.submitBubbles || (n.event.special.submit = {
+        setup: function() {
+            return n.nodeName(this, "form") ? !1 : void n.event.add(this, "click._submit keypress._submit", function(a) {
+                var b = a.target,
+                    c = n.nodeName(b, "input") || n.nodeName(b, "button") ? b.form : void 0;
+                c && !n._data(c, "submitBubbles") && (n.event.add(c, "submit._submit", function(a) {
+                    a._submit_bubble = !0
+                }), n._data(c, "submitBubbles", !0))
+            })
+        },
+        postDispatch: function(a) {
+            a._submit_bubble && (delete a._submit_bubble, this.parentNode && !a.isTrigger && n.event.simulate("submit", this.parentNode, a, !0))
+        },
+        teardown: function() {
+            return n.nodeName(this, "form") ? !1 : void n.event.remove(this, "._submit")
+        }
+    }), l.changeBubbles || (n.event.special.change = {
+        setup: function() {
+            return Y.test(this.nodeName) ? (("checkbox" === this.type || "radio" === this.type) && (n.event.add(this, "propertychange._change", function(a) {
+                "checked" === a.originalEvent.propertyName && (this._just_changed = !0)
+            }), n.event.add(this, "click._change", function(a) {
+                this._just_changed && !a.isTrigger && (this._just_changed = !1), n.event.simulate("change", this, a, !0)
+            })), !1) : void n.event.add(this, "beforeactivate._change", function(a) {
+                var b = a.target;
+                Y.test(b.nodeName) && !n._data(b, "changeBubbles") && (n.event.add(b, "change._change", function(a) {
+                    !this.parentNode || a.isSimulated || a.isTrigger || n.event.simulate("change", this.parentNode, a, !0)
+                }), n._data(b, "changeBubbles", !0))
+            })
+        },
+        handle: function(a) {
+            var b = a.target;
+            return this !== b || a.isSimulated || a.isTrigger || "radio" !== b.type && "checkbox" !== b.type ? a.handleObj.handler.apply(this, arguments) : void 0
+        },
+        teardown: function() {
+            return n.event.remove(this, "._change"), !Y.test(this.nodeName)
+        }
+    }), l.focusinBubbles || n.each({
+        focus: "focusin",
+        blur: "focusout"
+    }, function(a, b) {
+        var c = function(a) {
+            n.event.simulate(b, a.target, n.event.fix(a), !0)
+        };
+        n.event.special[b] = {
+            setup: function() {
+                var d = this.ownerDocument || this,
+                    e = n._data(d, b);
+                e || d.addEventListener(a, c, !0), n._data(d, b, (e || 0) + 1)
+            },
+            teardown: function() {
+                var d = this.ownerDocument || this,
+                    e = n._data(d, b) - 1;
+                e ? n._data(d, b, e) : (d.removeEventListener(a, c, !0), n._removeData(d, b))
+            }
+        }
+    }), n.fn.extend({
+        on: function(a, b, c, d, e) {
+            var f, g;
+            if ("object" == typeof a) {
+                "string" != typeof b && (c = c || b, b = void 0);
+                for (f in a) this.on(f, b, c, a[f], e);
+                return this
+            }
+            if (null == c && null == d ? (d = b, c = b = void 0) : null == d && ("string" == typeof b ? (d = c, c = void 0) : (d = c, c = b, b = void 0)), d === !1) d = cb;
+            else if (!d) return this;
+            return 1 === e && (g = d, d = function(a) {
+                return n().off(a), g.apply(this, arguments)
+            }, d.guid = g.guid || (g.guid = n.guid++)), this.each(function() {
+                n.event.add(this, a, d, c, b)
+            })
         },
         one: function(a, b, c, d) {
-            return ya(this, a, b, c, d, 1)
+            return this.on(a, b, c, d, 1)
         },
         off: function(a, b, c) {
             var d, e;
-            if (a && a.preventDefault && a.handleObj) return d = a.handleObj, r(a.delegateTarget).off(d.namespace ? d.origType + "." + d.namespace : d.origType, d.selector, d.handler), this;
+            if (a && a.preventDefault && a.handleObj) return d = a.handleObj, n(a.delegateTarget).off(d.namespace ? d.origType + "." + d.namespace : d.origType, d.selector, d.handler), this;
             if ("object" == typeof a) {
                 for (e in a) this.off(e, b, a[e]);
                 return this
             }
-            return b !== !1 && "function" != typeof b || (c = b, b = void 0), c === !1 && (c = wa), this.each(function() {
-                r.event.remove(this, a, c, b)
+            return (b === !1 || "function" == typeof b) && (c = b, b = void 0), c === !1 && (c = cb), this.each(function() {
+                n.event.remove(this, a, c, b)
             })
+        },
+        trigger: function(a, b) {
+            return this.each(function() {
+                n.event.trigger(a, b, this)
+            })
+        },
+        triggerHandler: function(a, b) {
+            var c = this[0];
+            return c ? n.event.trigger(a, b, c, !0) : void 0
         }
     });
-    var za = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,
-        Aa = /<script|<style|<link/i,
-        Ba = /checked\s*(?:[^=]|=\s*.checked.)/i,
-        Ca = /^true\/(.*)/,
-        Da = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;
 
-    function Ea(a, b) {
-        return B(a, "table") && B(11 !== b.nodeType ? b : b.firstChild, "tr") ? r(">tbody", a)[0] || a : a
+    function eb(a) {
+        var b = fb.split("|"),
+            c = a.createDocumentFragment();
+        if (c.createElement)
+            while (b.length) c.createElement(b.pop());
+        return c
     }
+    var fb = "abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",
+        gb = / jQuery\d+="(?:null|\d+)"/g,
+        hb = new RegExp("<(?:" + fb + ")[\\s/>]", "i"),
+        ib = /^\s+/,
+        jb = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,
+        kb = /<([\w:]+)/,
+        lb = /<tbody/i,
+        mb = /<|&#?\w+;/,
+        nb = /<(?:script|style|link)/i,
+        ob = /checked\s*(?:[^=]|=\s*.checked.)/i,
+        pb = /^$|\/(?:java|ecma)script/i,
+        qb = /^true\/(.*)/,
+        rb = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,
+        sb = {
+            option: [1, "<select multiple='multiple'>", "</select>"],
+            legend: [1, "<fieldset>", "</fieldset>"],
+            area: [1, "<map>", "</map>"],
+            param: [1, "<object>", "</object>"],
+            thead: [1, "<table>", "</table>"],
+            tr: [2, "<table><tbody>", "</tbody></table>"],
+            col: [2, "<table><tbody></tbody><colgroup>", "</colgroup></table>"],
+            td: [3, "<table><tbody><tr>", "</tr></tbody></table>"],
+            _default: l.htmlSerialize ? [0, "", ""] : [1, "X<div>", "</div>"]
+        },
+        tb = eb(z),
+        ub = tb.appendChild(z.createElement("div"));
+    sb.optgroup = sb.option, sb.tbody = sb.tfoot = sb.colgroup = sb.caption = sb.thead, sb.th = sb.td;
 
-    function Fa(a) {
-        return a.type = (null !== a.getAttribute("type")) + "/" + a.type, a
+    function vb(a, b) {
+        var c, d, e = 0,
+            f = typeof a.getElementsByTagName !== L ? a.getElementsByTagName(b || "*") : typeof a.querySelectorAll !== L ? a.querySelectorAll(b || "*") : void 0;
+        if (!f)
+            for (f = [], c = a.childNodes || a; null != (d = c[e]); e++) !b || n.nodeName(d, b) ? f.push(d) : n.merge(f, vb(d, b));
+        return void 0 === b || b && n.nodeName(a, b) ? n.merge([a], f) : f
     }
 
-    function Ga(a) {
-        var b = Ca.exec(a.type);
-        return b ? a.type = b[1] : a.removeAttribute("type"), a
+    function wb(a) {
+        X.test(a.type) && (a.defaultChecked = a.checked)
     }
 
-    function Ha(a, b) {
-        var c, d, e, f, g, h, i, j;
-        if (1 === b.nodeType) {
-            if (W.hasData(a) && (f = W.access(a), g = W.set(b, f), j = f.events)) {
-                delete g.handle, g.events = {};
-                for (e in j)
-                    for (c = 0, d = j[e].length; c < d; c++) r.event.add(b, e, j[e][c])
-            }
-            X.hasData(a) && (h = X.access(a), i = r.extend({}, h), X.set(b, i))
-        }
+    function xb(a, b) {
+        return n.nodeName(a, "table") && n.nodeName(11 !== b.nodeType ? b : b.firstChild, "tr") ? a.getElementsByTagName("tbody")[0] || a.appendChild(a.ownerDocument.createElement("tbody")) : a
     }
 
-    function Ia(a, b) {
-        var c = b.nodeName.toLowerCase();
-        "input" === c && ja.test(a.type) ? b.checked = a.checked : "input" !== c && "textarea" !== c || (b.defaultValue = a.defaultValue)
+    function yb(a) {
+        return a.type = (null !== n.find.attr(a, "type")) + "/" + a.type, a
     }
 
-    function Ja(a, b, c, d) {
-        b = g.apply([], b);
-        var e, f, h, i, j, k, l = 0,
-            m = a.length,
-            n = m - 1,
-            q = b[0],
-            s = r.isFunction(q);
-        if (s || m > 1 && "string" == typeof q && !o.checkClone && Ba.test(q)) return a.each(function(e) {
-            var f = a.eq(e);
-            s && (b[0] = q.call(this, e, f.html())), Ja(f, b, c, d)
-        });
-        if (m && (e = qa(b, a[0].ownerDocument, !1, a, d), f = e.firstChild, 1 === e.childNodes.length && (e = f), f || d)) {
-            for (h = r.map(na(e, "script"), Fa), i = h.length; l < m; l++) j = e, l !== n && (j = r.clone(j, !0, !0), i && r.merge(h, na(j, "script"))), c.call(a[l], j, l);
-            if (i)
-                for (k = h[h.length - 1].ownerDocument, r.map(h, Ga), l = 0; l < i; l++) j = h[l], la.test(j.type || "") && !W.access(j, "globalEval") && r.contains(k, j) && (j.src ? r._evalUrl && r._evalUrl(j.src) : p(j.textContent.replace(Da, ""), k))
+    function zb(a) {
+        var b = qb.exec(a.type);
+        return b ? a.type = b[1] : a.removeAttribute("type"), a
+    }
+
+    function Ab(a, b) {
+        for (var c, d = 0; null != (c = a[d]); d++) n._data(c, "globalEval", !b || n._data(b[d], "globalEval"))
+    }
+
+    function Bb(a, b) {
+        if (1 === b.nodeType && n.hasData(a)) {
+            var c, d, e, f = n._data(a),
+                g = n._data(b, f),
+                h = f.events;
+            if (h) {
+                delete g.handle, g.events = {};
+                for (c in h)
+                    for (d = 0, e = h[c].length; e > d; d++) n.event.add(b, c, h[c][d])
+            }
+            g.data && (g.data = n.extend({}, g.data))
         }
-        return a
     }
 
-    function Ka(a, b, c) {
-        for (var d, e = b ? r.filter(b, a) : a, f = 0; null != (d = e[f]); f++) c || 1 !== d.nodeType || r.cleanData(na(d)), d.parentNode && (c && r.contains(d.ownerDocument, d) && oa(na(d, "script")), d.parentNode.removeChild(d));
-        return a
+    function Cb(a, b) {
+        var c, d, e;
+        if (1 === b.nodeType) {
+            if (c = b.nodeName.toLowerCase(), !l.noCloneEvent && b[n.expando]) {
+                e = n._data(b);
+                for (d in e.events) n.removeEvent(b, d, e.handle);
+                b.removeAttribute(n.expando)
+            }
+            "script" === c && b.text !== a.text ? (yb(b).text = a.text, zb(b)) : "object" === c ? (b.parentNode && (b.outerHTML = a.outerHTML), l.html5Clone && a.innerHTML && !n.trim(b.innerHTML) && (b.innerHTML = a.innerHTML)) : "input" === c && X.test(a.type) ? (b.defaultChecked = b.checked = a.checked, b.value !== a.value && (b.value = a.value)) : "option" === c ? b.defaultSelected = b.selected = a.defaultSelected : ("input" === c || "textarea" === c) && (b.defaultValue = a.defaultValue)
+        }
     }
-    r.extend({
-        htmlPrefilter: function(a) {
-            return a.replace(za, "<$1></$2>")
-        },
+    n.extend({
         clone: function(a, b, c) {
-            var d, e, f, g, h = a.cloneNode(!0),
-                i = r.contains(a.ownerDocument, a);
-            if (!(o.noCloneChecked || 1 !== a.nodeType && 11 !== a.nodeType || r.isXMLDoc(a)))
-                for (g = na(h), f = na(a), d = 0, e = f.length; d < e; d++) Ia(f[d], g[d]);
+            var d, e, f, g, h, i = n.contains(a.ownerDocument, a);
+            if (l.html5Clone || n.isXMLDoc(a) || !hb.test("<" + a.nodeName + ">") ? f = a.cloneNode(!0) : (ub.innerHTML = a.outerHTML, ub.removeChild(f = ub.firstChild)), !(l.noCloneEvent && l.noCloneChecked || 1 !== a.nodeType && 11 !== a.nodeType || n.isXMLDoc(a)))
+                for (d = vb(f), h = vb(a), g = 0; null != (e = h[g]); ++g) d[g] && Cb(e, d[g]);
             if (b)
                 if (c)
-                    for (f = f || na(a), g = g || na(h), d = 0, e = f.length; d < e; d++) Ha(f[d], g[d]);
-                else Ha(a, h);
-            return g = na(h, "script"), g.length > 0 && oa(g, !i && na(a, "script")), h
-        },
-        cleanData: function(a) {
-            for (var b, c, d, e = r.event.special, f = 0; void 0 !== (c = a[f]); f++)
-                if (U(c)) {
-                    if (b = c[W.expando]) {
-                        if (b.events)
-                            for (d in b.events) e[d] ? r.event.remove(c, d) : r.removeEvent(c, d, b.handle);
-                        c[W.expando] = void 0
-                    }
-                    c[X.expando] && (c[X.expando] = void 0)
+                    for (h = h || vb(a), d = d || vb(f), g = 0; null != (e = h[g]); g++) Bb(e, d[g]);
+                else Bb(a, f);
+            return d = vb(f, "script"), d.length > 0 && Ab(d, !i && vb(a, "script")), d = h = e = null, f
+        },
+        buildFragment: function(a, b, c, d) {
+            for (var e, f, g, h, i, j, k, m = a.length, o = eb(b), p = [], q = 0; m > q; q++)
+                if (f = a[q], f || 0 === f)
+                    if ("object" === n.type(f)) n.merge(p, f.nodeType ? [f] : f);
+                    else if (mb.test(f)) {
+                h = h || o.appendChild(b.createElement("div")), i = (kb.exec(f) || ["", ""])[1].toLowerCase(), k = sb[i] || sb._default, h.innerHTML = k[1] + f.replace(jb, "<$1></$2>") + k[2], e = k[0];
+                while (e--) h = h.lastChild;
+                if (!l.leadingWhitespace && ib.test(f) && p.push(b.createTextNode(ib.exec(f)[0])), !l.tbody) {
+                    f = "table" !== i || lb.test(f) ? "<table>" !== k[1] || lb.test(f) ? 0 : h : h.firstChild, e = f && f.childNodes.length;
+                    while (e--) n.nodeName(j = f.childNodes[e], "tbody") && !j.childNodes.length && f.removeChild(j)
+                }
+                n.merge(p, h.childNodes), h.textContent = "";
+                while (h.firstChild) h.removeChild(h.firstChild);
+                h = o.lastChild
+            } else p.push(b.createTextNode(f));
+            h && o.removeChild(h), l.appendChecked || n.grep(vb(p, "input"), wb), q = 0;
+            while (f = p[q++])
+                if ((!d || -1 === n.inArray(f, d)) && (g = n.contains(f.ownerDocument, f), h = vb(o.appendChild(f), "script"), g && Ab(h), c)) {
+                    e = 0;
+                    while (f = h[e++]) pb.test(f.type || "") && c.push(f)
+                } return h = null, o
+        },
+        cleanData: function(a, b) {
+            for (var d, e, f, g, h = 0, i = n.expando, j = n.cache, k = l.deleteExpando, m = n.event.special; null != (d = a[h]); h++)
+                if ((b || n.acceptData(d)) && (f = d[i], g = f && j[f])) {
+                    if (g.events)
+                        for (e in g.events) m[e] ? n.event.remove(d, e) : n.removeEvent(d, e, g.handle);
+                    j[f] && (delete j[f], k ? delete d[i] : typeof d.removeAttribute !== L ? d.removeAttribute(i) : d[i] = null, c.push(f))
                 }
         }
-    }), r.fn.extend({
-        detach: function(a) {
-            return Ka(this, a, !0)
-        },
-        remove: function(a) {
-            return Ka(this, a)
-        },
+    }), n.fn.extend({
         text: function(a) {
-            return T(this, function(a) {
-                return void 0 === a ? r.text(this) : this.empty().each(function() {
-                    1 !== this.nodeType && 11 !== this.nodeType && 9 !== this.nodeType || (this.textContent = a)
-                })
+            return W(this, function(a) {
+                return void 0 === a ? n.text(this) : this.empty().append((this[0] && this[0].ownerDocument || z).createTextNode(a))
             }, null, a, arguments.length)
         },
         append: function() {
-            return Ja(this, arguments, function(a) {
+            return this.domManip(arguments, function(a) {
                 if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
-                    var b = Ea(this, a);
+                    var b = xb(this, a);
                     b.appendChild(a)
                 }
             })
         },
         prepend: function() {
-            return Ja(this, arguments, function(a) {
+            return this.domManip(arguments, function(a) {
                 if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
-                    var b = Ea(this, a);
+                    var b = xb(this, a);
                     b.insertBefore(a, b.firstChild)
                 }
             })
         },
         before: function() {
-            return Ja(this, arguments, function(a) {
+            return this.domManip(arguments, function(a) {
                 this.parentNode && this.parentNode.insertBefore(a, this)
             })
         },
         after: function() {
-            return Ja(this, arguments, function(a) {
+            return this.domManip(arguments, function(a) {
                 this.parentNode && this.parentNode.insertBefore(a, this.nextSibling)
             })
         },
+        remove: function(a, b) {
+            for (var c, d = a ? n.filter(a, this) : this, e = 0; null != (c = d[e]); e++) b || 1 !== c.nodeType || n.cleanData(vb(c)), c.parentNode && (b && n.contains(c.ownerDocument, c) && Ab(vb(c, "script")), c.parentNode.removeChild(c));
+            return this
+        },
         empty: function() {
-            for (var a, b = 0; null != (a = this[b]); b++) 1 === a.nodeType && (r.cleanData(na(a, !1)), a.textContent = "");
+            for (var a, b = 0; null != (a = this[b]); b++) {
+                1 === a.nodeType && n.cleanData(vb(a, !1));
+                while (a.firstChild) a.removeChild(a.firstChild);
+                a.options && n.nodeName(a, "select") && (a.options.length = 0)
+            }
             return this
         },
         clone: function(a, b) {
-            return a = null != a && a, b = null == b ? a : b, this.map(function() {
-                return r.clone(this, a, b)
+            return a = null == a ? !1 : a, b = null == b ? a : b, this.map(function() {
+                return n.clone(this, a, b)
             })
         },
         html: function(a) {
-            return T(this, function(a) {
+            return W(this, function(a) {
                 var b = this[0] || {},
                     c = 0,
                     d = this.length;
-                if (void 0 === a && 1 === b.nodeType) return b.innerHTML;
-                if ("string" == typeof a && !Aa.test(a) && !ma[(ka.exec(a) || ["", ""])[1].toLowerCase()]) {
-                    a = r.htmlPrefilter(a);
+                if (void 0 === a) return 1 === b.nodeType ? b.innerHTML.replace(gb, "") : void 0;
+                if (!("string" != typeof a || nb.test(a) || !l.htmlSerialize && hb.test(a) || !l.leadingWhitespace && ib.test(a) || sb[(kb.exec(a) || ["", ""])[1].toLowerCase()])) {
+                    a = a.replace(jb, "<$1></$2>");
                     try {
-                        for (; c < d; c++) b = this[c] || {}, 1 === b.nodeType && (r.cleanData(na(b, !1)), b.innerHTML = a);
+                        for (; d > c; c++) b = this[c] || {}, 1 === b.nodeType && (n.cleanData(vb(b, !1)), b.innerHTML = a);
                         b = 0
                     } catch (e) {}
                 }
                 b && this.empty().append(a)
             }, null, a, arguments.length)
         },
         replaceWith: function() {
-            var a = [];
-            return Ja(this, arguments, function(b) {
-                var c = this.parentNode;
-                r.inArray(this, a) < 0 && (r.cleanData(na(this)), c && c.replaceChild(b, this))
-            }, a)
+            var a = arguments[0];
+            return this.domManip(arguments, function(b) {
+                a = this.parentNode, n.cleanData(vb(this)), a && a.replaceChild(b, this)
+            }), a && (a.length || a.nodeType) ? this : this.remove()
+        },
+        detach: function(a) {
+            return this.remove(a, !0)
+        },
+        domManip: function(a, b) {
+            a = e.apply([], a);
+            var c, d, f, g, h, i, j = 0,
+                k = this.length,
+                m = this,
+                o = k - 1,
+                p = a[0],
+                q = n.isFunction(p);
+            if (q || k > 1 && "string" == typeof p && !l.checkClone && ob.test(p)) return this.each(function(c) {
+                var d = m.eq(c);
+                q && (a[0] = p.call(this, c, d.html())), d.domManip(a, b)
+            });
+            if (k && (i = n.buildFragment(a, this[0].ownerDocument, !1, this), c = i.firstChild, 1 === i.childNodes.length && (i = c), c)) {
+                for (g = n.map(vb(i, "script"), yb), f = g.length; k > j; j++) d = i, j !== o && (d = n.clone(d, !0, !0), f && n.merge(g, vb(d, "script"))), b.call(this[j], d, j);
+                if (f)
+                    for (h = g[g.length - 1].ownerDocument, n.map(g, zb), j = 0; f > j; j++) d = g[j], pb.test(d.type || "") && !n._data(d, "globalEval") && n.contains(h, d) && (d.src ? n._evalUrl && n._evalUrl(d.src) : n.globalEval((d.text || d.textContent || d.innerHTML || "").replace(rb, "")));
+                i = c = null
+            }
+            return this
         }
-    }), r.each({
+    }), n.each({
         appendTo: "append",
         prependTo: "prepend",
         insertBefore: "before",
         insertAfter: "after",
         replaceAll: "replaceWith"
     }, function(a, b) {
-        r.fn[a] = function(a) {
-            for (var c, d = [], e = r(a), f = e.length - 1, g = 0; g <= f; g++) c = g === f ? this : this.clone(!0), r(e[g])[b](c), h.apply(d, c.get());
-            return this.pushStack(d)
+        n.fn[a] = function(a) {
+            for (var c, d = 0, e = [], g = n(a), h = g.length - 1; h >= d; d++) c = d === h ? this : this.clone(!0), n(g[d])[b](c), f.apply(e, c.get());
+            return this.pushStack(e)
         }
     });
-    var La = /^margin/,
-        Ma = new RegExp("^(" + aa + ")(?!px)[a-z%]+$", "i"),
-        Na = function(b) {
-            var c = b.ownerDocument.defaultView;
-            return c && c.opener || (c = a), c.getComputedStyle(b)
-        };
-    ! function() {
-        function b() {
-            if (i) {
-                i.style.cssText = "box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%", i.innerHTML = "", ra.appendChild(h);
-                var b = a.getComputedStyle(i);
-                c = "1%" !== b.top, g = "2px" === b.marginLeft, e = "4px" === b.width, i.style.marginRight = "50%", f = "4px" === b.marginRight, ra.removeChild(h), i = null
+    var Db, Eb = {};
+
+    function Fb(b, c) {
+        var d = n(c.createElement(b)).appendTo(c.body),
+            e = a.getDefaultComputedStyle ? a.getDefaultComputedStyle(d[0]).display : n.css(d[0], "display");
+        return d.detach(), e
+    }
+
+    function Gb(a) {
+        var b = z,
+            c = Eb[a];
+        return c || (c = Fb(a, b), "none" !== c && c || (Db = (Db || n("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement), b = (Db[0].contentWindow || Db[0].contentDocument).document, b.write(), b.close(), c = Fb(a, b), Db.detach()), Eb[a] = c), c
+    }! function() {
+        var a, b, c = z.createElement("div"),
+            d = "-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";
+        c.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>", a = c.getElementsByTagName("a")[0], a.style.cssText = "float:left;opacity:.5", l.opacity = /^0.5/.test(a.style.opacity), l.cssFloat = !!a.style.cssFloat, c.style.backgroundClip = "content-box", c.cloneNode(!0).style.backgroundClip = "", l.clearCloneStyle = "content-box" === c.style.backgroundClip, a = c = null, l.shrinkWrapBlocks = function() {
+            var a, c, e, f;
+            if (null == b) {
+                if (a = z.getElementsByTagName("body")[0], !a) return;
+                f = "border:0;width:0;height:0;position:absolute;top:0;left:-9999px", c = z.createElement("div"), e = z.createElement("div"), a.appendChild(c).appendChild(e), b = !1, typeof e.style.zoom !== L && (e.style.cssText = d + ";width:1px;padding:1px;zoom:1", e.innerHTML = "<div></div>", e.firstChild.style.width = "5px", b = 3 !== e.offsetWidth), a.removeChild(c), a = c = e = null
             }
+            return b
         }
-        var c, e, f, g, h = d.createElement("div"),
-            i = d.createElement("div");
-        i.style && (i.style.backgroundClip = "content-box", i.cloneNode(!0).style.backgroundClip = "", o.clearCloneStyle = "content-box" === i.style.backgroundClip, h.style.cssText = "border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute", h.appendChild(i), r.extend(o, {
-            pixelPosition: function() {
-                return b(), c
-            },
-            boxSizingReliable: function() {
-                return b(), e
-            },
-            pixelMarginRight: function() {
-                return b(), f
-            },
-            reliableMarginLeft: function() {
-                return b(), g
-            }
-        }))
     }();
-
-    function Oa(a, b, c) {
+    var Hb = /^margin/,
+        Ib = new RegExp("^(" + T + ")(?!px)[a-z%]+$", "i"),
+        Jb, Kb, Lb = /^(top|right|bottom|left)$/;
+    a.getComputedStyle ? (Jb = function(a) {
+        return a.ownerDocument.defaultView.getComputedStyle(a, null)
+    }, Kb = function(a, b, c) {
         var d, e, f, g, h = a.style;
-        return c = c || Na(a), c && (g = c.getPropertyValue(b) || c[b], "" !== g || r.contains(a.ownerDocument, a) || (g = r.style(a, b)), !o.pixelMarginRight() && Ma.test(g) && La.test(b) && (d = h.width, e = h.minWidth, f = h.maxWidth, h.minWidth = h.maxWidth = h.width = g, g = c.width, h.width = d, h.minWidth = e, h.maxWidth = f)), void 0 !== g ? g + "" : g
-    }
+        return c = c || Jb(a), g = c ? c.getPropertyValue(b) || c[b] : void 0, c && ("" !== g || n.contains(a.ownerDocument, a) || (g = n.style(a, b)), Ib.test(g) && Hb.test(b) && (d = h.width, e = h.minWidth, f = h.maxWidth, h.minWidth = h.maxWidth = h.width = g, g = c.width, h.width = d, h.minWidth = e, h.maxWidth = f)), void 0 === g ? g : g + ""
+    }) : z.documentElement.currentStyle && (Jb = function(a) {
+        return a.currentStyle
+    }, Kb = function(a, b, c) {
+        var d, e, f, g, h = a.style;
+        return c = c || Jb(a), g = c ? c[b] : void 0, null == g && h && h[b] && (g = h[b]), Ib.test(g) && !Lb.test(b) && (d = h.left, e = a.runtimeStyle, f = e && e.left, f && (e.left = a.currentStyle.left), h.left = "fontSize" === b ? "1em" : g, g = h.pixelLeft + "px", h.left = d, f && (e.left = f)), void 0 === g ? g : g + "" || "auto"
+    });
 
-    function Pa(a, b) {
+    function Mb(a, b) {
         return {
             get: function() {
-                return a() ? void delete this.get : (this.get = b).apply(this, arguments)
+                var c = a();
+                if (null != c) return c ? void delete this.get : (this.get = b).apply(this, arguments)
             }
         }
-    }
-    var Qa = /^(none|table(?!-c[ea]).+)/,
-        Ra = /^--/,
-        Sa = {
+    }! function() {
+        var b, c, d, e, f, g, h = z.createElement("div"),
+            i = "border:0;width:0;height:0;position:absolute;top:0;left:-9999px",
+            j = "-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";
+        h.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>", b = h.getElementsByTagName("a")[0], b.style.cssText = "float:left;opacity:.5", l.opacity = /^0.5/.test(b.style.opacity), l.cssFloat = !!b.style.cssFloat, h.style.backgroundClip = "content-box", h.cloneNode(!0).style.backgroundClip = "", l.clearCloneStyle = "content-box" === h.style.backgroundClip, b = h = null, n.extend(l, {
+            reliableHiddenOffsets: function() {
+                if (null != c) return c;
+                var a, b, d, e = z.createElement("div"),
+                    f = z.getElementsByTagName("body")[0];
+                if (f) return e.setAttribute("className", "t"), e.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>", a = z.createElement("div"), a.style.cssText = i, f.appendChild(a).appendChild(e), e.innerHTML = "<table><tr><td></td><td>t</td></tr></table>", b = e.getElementsByTagName("td"), b[0].style.cssText = "padding:0;margin:0;border:0;display:none", d = 0 === b[0].offsetHeight, b[0].style.display = "", b[1].style.display = "none", c = d && 0 === b[0].offsetHeight, f.removeChild(a), e = f = null, c
+            },
+            boxSizing: function() {
+                return null == d && k(), d
+            },
+            boxSizingReliable: function() {
+                return null == e && k(), e
+            },
+            pixelPosition: function() {
+                return null == f && k(), f
+            },
+            reliableMarginRight: function() {
+                var b, c, d, e;
+                if (null == g && a.getComputedStyle) {
+                    if (b = z.getElementsByTagName("body")[0], !b) return;
+                    c = z.createElement("div"), d = z.createElement("div"), c.style.cssText = i, b.appendChild(c).appendChild(d), e = d.appendChild(z.createElement("div")), e.style.cssText = d.style.cssText = j, e.style.marginRight = e.style.width = "0", d.style.width = "1px", g = !parseFloat((a.getComputedStyle(e, null) || {}).marginRight), b.removeChild(c)
+                }
+                return g
+            }
+        });
+
+        function k() {
+            var b, c, h = z.getElementsByTagName("body")[0];
+            h && (b = z.createElement("div"), c = z.createElement("div"), b.style.cssText = i, h.appendChild(b).appendChild(c), c.style.cssText = "-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%", n.swap(h, null != h.style.zoom ? {
+                zoom: 1
+            } : {}, function() {
+                d = 4 === c.offsetWidth
+            }), e = !0, f = !1, g = !0, a.getComputedStyle && (f = "1%" !== (a.getComputedStyle(c, null) || {}).top, e = "4px" === (a.getComputedStyle(c, null) || {
+                width: "4px"
+            }).width), h.removeChild(b), c = h = null)
+        }
+    }(), n.swap = function(a, b, c, d) {
+        var e, f, g = {};
+        for (f in b) g[f] = a.style[f], a.style[f] = b[f];
+        e = c.apply(a, d || []);
+        for (f in b) a.style[f] = g[f];
+        return e
+    };
+    var Nb = /alpha\([^)]*\)/i,
+        Ob = /opacity\s*=\s*([^)]*)/,
+        Pb = /^(none|table(?!-c[ea]).+)/,
+        Qb = new RegExp("^(" + T + ")(.*)$", "i"),
+        Rb = new RegExp("^([+-])=(" + T + ")", "i"),
+        Sb = {
             position: "absolute",
             visibility: "hidden",
             display: "block"
         },
-        Ta = {
-            letterSpacing: "0",
-            fontWeight: "400"
-        },
-        Ua = ["Webkit", "Moz", "ms"],
-        Va = d.createElement("div").style;
-
-    function Wa(a) {
-        if (a in Va) return a;
-        var b = a[0].toUpperCase() + a.slice(1),
-            c = Ua.length;
-        while (c--)
-            if (a = Ua[c] + b, a in Va) return a
-    }
-
-    function Xa(a) {
-        var b = r.cssProps[a];
-        return b || (b = r.cssProps[a] = Wa(a) || a), b
+        Tb = {
+            letterSpacing: 0,
+            fontWeight: 400
+        },
+        Ub = ["Webkit", "O", "Moz", "ms"];
+
+    function Vb(a, b) {
+        if (b in a) return b;
+        var c = b.charAt(0).toUpperCase() + b.slice(1),
+            d = b,
+            e = Ub.length;
+        while (e--)
+            if (b = Ub[e] + c, b in a) return b;
+        return d
+    }
+
+    function Wb(a, b) {
+        for (var c, d, e, f = [], g = 0, h = a.length; h > g; g++) d = a[g], d.style && (f[g] = n._data(d, "olddisplay"), c = d.style.display, b ? (f[g] || "none" !== c || (d.style.display = ""), "" === d.style.display && V(d) && (f[g] = n._data(d, "olddisplay", Gb(d.nodeName)))) : f[g] || (e = V(d), (c && "none" !== c || !e) && n._data(d, "olddisplay", e ? c : n.css(d, "display"))));
+        for (g = 0; h > g; g++) d = a[g], d.style && (b && "none" !== d.style.display && "" !== d.style.display || (d.style.display = b ? f[g] || "" : "none"));
+        return a
     }
 
-    function Ya(a, b, c) {
-        var d = ba.exec(b);
-        return d ? Math.max(0, d[2] - (c || 0)) + (d[3] || "px") : b
+    function Xb(a, b, c) {
+        var d = Qb.exec(b);
+        return d ? Math.max(0, d[1] - (c || 0)) + (d[2] || "px") : b
     }
 
-    function Za(a, b, c, d, e) {
-        var f, g = 0;
-        for (f = c === (d ? "border" : "content") ? 4 : "width" === b ? 1 : 0; f < 4; f += 2) "margin" === c && (g += r.css(a, c + ca[f], !0, e)), d ? ("content" === c && (g -= r.css(a, "padding" + ca[f], !0, e)), "margin" !== c && (g -= r.css(a, "border" + ca[f] + "Width", !0, e))) : (g += r.css(a, "padding" + ca[f], !0, e), "padding" !== c && (g += r.css(a, "border" + ca[f] + "Width", !0, e)));
+    function Yb(a, b, c, d, e) {
+        for (var f = c === (d ? "border" : "content") ? 4 : "width" === b ? 1 : 0, g = 0; 4 > f; f += 2) "margin" === c && (g += n.css(a, c + U[f], !0, e)), d ? ("content" === c && (g -= n.css(a, "padding" + U[f], !0, e)), "margin" !== c && (g -= n.css(a, "border" + U[f] + "Width", !0, e))) : (g += n.css(a, "padding" + U[f], !0, e), "padding" !== c && (g += n.css(a, "border" + U[f] + "Width", !0, e)));
         return g
     }
 
-    function $a(a, b, c) {
-        var d, e = Na(a),
-            f = Oa(a, b, e),
-            g = "border-box" === r.css(a, "boxSizing", !1, e);
-        return Ma.test(f) ? f : (d = g && (o.boxSizingReliable() || f === a.style[b]), "auto" === f && (f = a["offset" + b[0].toUpperCase() + b.slice(1)]), f = parseFloat(f) || 0, f + Za(a, b, c || (g ? "border" : "content"), d, e) + "px")
+    function Zb(a, b, c) {
+        var d = !0,
+            e = "width" === b ? a.offsetWidth : a.offsetHeight,
+            f = Jb(a),
+            g = l.boxSizing() && "border-box" === n.css(a, "boxSizing", !1, f);
+        if (0 >= e || null == e) {
+            if (e = Kb(a, b, f), (0 > e || null == e) && (e = a.style[b]), Ib.test(e)) return e;
+            d = g && (l.boxSizingReliable() || e === a.style[b]), e = parseFloat(e) || 0
+        }
+        return e + Yb(a, b, c || (g ? "border" : "content"), d, f) + "px"
     }
-    r.extend({
+    n.extend({
         cssHooks: {
             opacity: {
                 get: function(a, b) {
                     if (b) {
-                        var c = Oa(a, "opacity");
+                        var c = Kb(a, "opacity");
                         return "" === c ? "1" : c
                     }
                 }
             }
         },
         cssNumber: {
-            animationIterationCount: !0,
             columnCount: !0,
             fillOpacity: !0,
-            flexGrow: !0,
-            flexShrink: !0,
             fontWeight: !0,
             lineHeight: !0,
             opacity: !0,
             order: !0,
             orphans: !0,
             widows: !0,
             zIndex: !0,
             zoom: !0
         },
         cssProps: {
-            "float": "cssFloat"
+            "float": l.cssFloat ? "cssFloat" : "styleFloat"
         },
         style: function(a, b, c, d) {
             if (a && 3 !== a.nodeType && 8 !== a.nodeType && a.style) {
-                var e, f, g, h = r.camelCase(b),
-                    i = Ra.test(b),
-                    j = a.style;
-                return i || (b = Xa(h)), g = r.cssHooks[b] || r.cssHooks[h], void 0 === c ? g && "get" in g && void 0 !== (e = g.get(a, !1, d)) ? e : j[b] : (f = typeof c, "string" === f && (e = ba.exec(c)) && e[1] && (c = fa(a, b, e), f = "number"), null != c && c === c && ("number" === f && (c += e && e[3] || (r.cssNumber[h] ? "" : "px")), o.clearCloneStyle || "" !== c || 0 !== b.indexOf("background") || (j[b] = "inherit"), g && "set" in g && void 0 === (c = g.set(a, c, d)) || (i ? j.setProperty(b, c) : j[b] = c)), void 0)
+                var e, f, g, h = n.camelCase(b),
+                    i = a.style;
+                if (b = n.cssProps[h] || (n.cssProps[h] = Vb(i, h)), g = n.cssHooks[b] || n.cssHooks[h], void 0 === c) return g && "get" in g && void 0 !== (e = g.get(a, !1, d)) ? e : i[b];
+                if (f = typeof c, "string" === f && (e = Rb.exec(c)) && (c = (e[1] + 1) * e[2] + parseFloat(n.css(a, b)), f = "number"), null != c && c === c && ("number" !== f || n.cssNumber[h] || (c += "px"), l.clearCloneStyle || "" !== c || 0 !== b.indexOf("background") || (i[b] = "inherit"), !(g && "set" in g && void 0 === (c = g.set(a, c, d))))) try {
+                    i[b] = "", i[b] = c
+                } catch (j) {}
             }
         },
         css: function(a, b, c, d) {
-            var e, f, g, h = r.camelCase(b),
-                i = Ra.test(b);
-            return i || (b = Xa(h)), g = r.cssHooks[b] || r.cssHooks[h], g && "get" in g && (e = g.get(a, !0, c)), void 0 === e && (e = Oa(a, b, d)), "normal" === e && b in Ta && (e = Ta[b]), "" === c || c ? (f = parseFloat(e), c === !0 || isFinite(f) ? f || 0 : e) : e
+            var e, f, g, h = n.camelCase(b);
+            return b = n.cssProps[h] || (n.cssProps[h] = Vb(a.style, h)), g = n.cssHooks[b] || n.cssHooks[h], g && "get" in g && (f = g.get(a, !0, c)), void 0 === f && (f = Kb(a, b, d)), "normal" === f && b in Tb && (f = Tb[b]), "" === c || c ? (e = parseFloat(f), c === !0 || n.isNumeric(e) ? e || 0 : f) : f
         }
-    }), r.each(["height", "width"], function(a, b) {
-        r.cssHooks[b] = {
+    }), n.each(["height", "width"], function(a, b) {
+        n.cssHooks[b] = {
             get: function(a, c, d) {
-                if (c) return !Qa.test(r.css(a, "display")) || a.getClientRects().length && a.getBoundingClientRect().width ? $a(a, b, d) : ea(a, Sa, function() {
-                    return $a(a, b, d)
-                })
+                return c ? 0 === a.offsetWidth && Pb.test(n.css(a, "display")) ? n.swap(a, Sb, function() {
+                    return Zb(a, b, d)
+                }) : Zb(a, b, d) : void 0
             },
             set: function(a, c, d) {
-                var e, f = d && Na(a),
-                    g = d && Za(a, b, d, "border-box" === r.css(a, "boxSizing", !1, f), f);
-                return g && (e = ba.exec(c)) && "px" !== (e[3] || "px") && (a.style[b] = c, c = r.css(a, b)), Ya(a, c, g)
+                var e = d && Jb(a);
+                return Xb(a, c, d ? Yb(a, b, d, l.boxSizing() && "border-box" === n.css(a, "boxSizing", !1, e), e) : 0)
             }
         }
-    }), r.cssHooks.marginLeft = Pa(o.reliableMarginLeft, function(a, b) {
-        if (b) return (parseFloat(Oa(a, "marginLeft")) || a.getBoundingClientRect().left - ea(a, {
-            marginLeft: 0
-        }, function() {
-            return a.getBoundingClientRect().left
-        })) + "px"
-    }), r.each({
+    }), l.opacity || (n.cssHooks.opacity = {
+        get: function(a, b) {
+            return Ob.test((b && a.currentStyle ? a.currentStyle.filter : a.style.filter) || "") ? .01 * parseFloat(RegExp.$1) + "" : b ? "1" : ""
+        },
+        set: function(a, b) {
+            var c = a.style,
+                d = a.currentStyle,
+                e = n.isNumeric(b) ? "alpha(opacity=" + 100 * b + ")" : "",
+                f = d && d.filter || c.filter || "";
+            c.zoom = 1, (b >= 1 || "" === b) && "" === n.trim(f.replace(Nb, "")) && c.removeAttribute && (c.removeAttribute("filter"), "" === b || d && !d.filter) || (c.filter = Nb.test(f) ? f.replace(Nb, e) : f + " " + e)
+        }
+    }), n.cssHooks.marginRight = Mb(l.reliableMarginRight, function(a, b) {
+        return b ? n.swap(a, {
+            display: "inline-block"
+        }, Kb, [a, "marginRight"]) : void 0
+    }), n.each({
         margin: "",
         padding: "",
         border: "Width"
     }, function(a, b) {
-        r.cssHooks[a + b] = {
+        n.cssHooks[a + b] = {
             expand: function(c) {
-                for (var d = 0, e = {}, f = "string" == typeof c ? c.split(" ") : [c]; d < 4; d++) e[a + ca[d] + b] = f[d] || f[d - 2] || f[0];
+                for (var d = 0, e = {}, f = "string" == typeof c ? c.split(" ") : [c]; 4 > d; d++) e[a + U[d] + b] = f[d] || f[d - 2] || f[0];
                 return e
             }
-        }, La.test(a) || (r.cssHooks[a + b].set = Ya)
-    }), r.fn.extend({
+        }, Hb.test(a) || (n.cssHooks[a + b].set = Xb)
+    }), n.fn.extend({
         css: function(a, b) {
-            return T(this, function(a, b, c) {
+            return W(this, function(a, b, c) {
                 var d, e, f = {},
                     g = 0;
-                if (Array.isArray(b)) {
-                    for (d = Na(a), e = b.length; g < e; g++) f[b[g]] = r.css(a, b[g], !1, d);
+                if (n.isArray(b)) {
+                    for (d = Jb(a), e = b.length; e > g; g++) f[b[g]] = n.css(a, b[g], !1, d);
                     return f
                 }
-                return void 0 !== c ? r.style(a, b, c) : r.css(a, b)
+                return void 0 !== c ? n.style(a, b, c) : n.css(a, b)
             }, a, b, arguments.length > 1)
+        },
+        show: function() {
+            return Wb(this, !0)
+        },
+        hide: function() {
+            return Wb(this)
+        },
+        toggle: function(a) {
+            return "boolean" == typeof a ? a ? this.show() : this.hide() : this.each(function() {
+                V(this) ? n(this).show() : n(this).hide()
+            })
         }
     });
 
-    function _a(a, b, c, d, e) {
-        return new _a.prototype.init(a, b, c, d, e)
+    function $b(a, b, c, d, e) {
+        return new $b.prototype.init(a, b, c, d, e)
     }
-    r.Tween = _a, _a.prototype = {
-        constructor: _a,
+    n.Tween = $b, $b.prototype = {
+        constructor: $b,
         init: function(a, b, c, d, e, f) {
-            this.elem = a, this.prop = c, this.easing = e || r.easing._default, this.options = b, this.start = this.now = this.cur(), this.end = d, this.unit = f || (r.cssNumber[c] ? "" : "px")
+            this.elem = a, this.prop = c, this.easing = e || "swing", this.options = b, this.start = this.now = this.cur(), this.end = d, this.unit = f || (n.cssNumber[c] ? "" : "px")
         },
         cur: function() {
-            var a = _a.propHooks[this.prop];
-            return a && a.get ? a.get(this) : _a.propHooks._default.get(this)
+            var a = $b.propHooks[this.prop];
+            return a && a.get ? a.get(this) : $b.propHooks._default.get(this)
         },
         run: function(a) {
-            var b, c = _a.propHooks[this.prop];
-            return this.options.duration ? this.pos = b = r.easing[this.easing](a, this.options.duration * a, 0, 1, this.options.duration) : this.pos = b = a, this.now = (this.end - this.start) * b + this.start, this.options.step && this.options.step.call(this.elem, this.now, this), c && c.set ? c.set(this) : _a.propHooks._default.set(this), this
+            var b, c = $b.propHooks[this.prop];
+            return this.pos = b = this.options.duration ? n.easing[this.easing](a, this.options.duration * a, 0, 1, this.options.duration) : a, this.now = (this.end - this.start) * b + this.start, this.options.step && this.options.step.call(this.elem, this.now, this), c && c.set ? c.set(this) : $b.propHooks._default.set(this), this
         }
-    }, _a.prototype.init.prototype = _a.prototype, _a.propHooks = {
+    }, $b.prototype.init.prototype = $b.prototype, $b.propHooks = {
         _default: {
             get: function(a) {
                 var b;
-                return 1 !== a.elem.nodeType || null != a.elem[a.prop] && null == a.elem.style[a.prop] ? a.elem[a.prop] : (b = r.css(a.elem, a.prop, ""), b && "auto" !== b ? b : 0)
+                return null == a.elem[a.prop] || a.elem.style && null != a.elem.style[a.prop] ? (b = n.css(a.elem, a.prop, ""), b && "auto" !== b ? b : 0) : a.elem[a.prop]
             },
             set: function(a) {
-                r.fx.step[a.prop] ? r.fx.step[a.prop](a) : 1 !== a.elem.nodeType || null == a.elem.style[r.cssProps[a.prop]] && !r.cssHooks[a.prop] ? a.elem[a.prop] = a.now : r.style(a.elem, a.prop, a.now + a.unit)
+                n.fx.step[a.prop] ? n.fx.step[a.prop](a) : a.elem.style && (null != a.elem.style[n.cssProps[a.prop]] || n.cssHooks[a.prop]) ? n.style(a.elem, a.prop, a.now + a.unit) : a.elem[a.prop] = a.now
             }
         }
-    }, _a.propHooks.scrollTop = _a.propHooks.scrollLeft = {
+    }, $b.propHooks.scrollTop = $b.propHooks.scrollLeft = {
         set: function(a) {
             a.elem.nodeType && a.elem.parentNode && (a.elem[a.prop] = a.now)
         }
-    }, r.easing = {
+    }, n.easing = {
         linear: function(a) {
             return a
         },
         swing: function(a) {
             return .5 - Math.cos(a * Math.PI) / 2
-        },
-        _default: "swing"
-    }, r.fx = _a.prototype.init, r.fx.step = {};
-    var ab, bb, cb = /^(?:toggle|show|hide)$/,
-        db = /queueHooks$/;
-
-    function eb() {
-        bb && (d.hidden === !1 && a.requestAnimationFrame ? a.requestAnimationFrame(eb) : a.setTimeout(eb, r.fx.interval), r.fx.tick())
-    }
+        }
+    }, n.fx = $b.prototype.init, n.fx.step = {};
+    var _b, ac, bc = /^(?:toggle|show|hide)$/,
+        cc = new RegExp("^(?:([+-])=|)(" + T + ")([a-z%]*)$", "i"),
+        dc = /queueHooks$/,
+        ec = [jc],
+        fc = {
+            "*": [function(a, b) {
+                var c = this.createTween(a, b),
+                    d = c.cur(),
+                    e = cc.exec(b),
+                    f = e && e[3] || (n.cssNumber[a] ? "" : "px"),
+                    g = (n.cssNumber[a] || "px" !== f && +d) && cc.exec(n.css(c.elem, a)),
+                    h = 1,
+                    i = 20;
+                if (g && g[3] !== f) {
+                    f = f || g[3], e = e || [], g = +d || 1;
+                    do h = h || ".5", g /= h, n.style(c.elem, a, g + f); while (h !== (h = c.cur() / d) && 1 !== h && --i)
+                }
+                return e && (g = c.start = +g || +d || 0, c.unit = f, c.end = e[1] ? g + (e[1] + 1) * e[2] : +e[2]), c
+            }]
+        };
 
-    function fb() {
-        return a.setTimeout(function() {
-            ab = void 0
-        }), ab = r.now()
+    function gc() {
+        return setTimeout(function() {
+            _b = void 0
+        }), _b = n.now()
     }
 
-    function gb(a, b) {
-        var c, d = 0,
-            e = {
+    function hc(a, b) {
+        var c, d = {
                 height: a
-            };
-        for (b = b ? 1 : 0; d < 4; d += 2 - b) c = ca[d], e["margin" + c] = e["padding" + c] = a;
-        return b && (e.opacity = e.width = a), e
+            },
+            e = 0;
+        for (b = b ? 1 : 0; 4 > e; e += 2 - b) c = U[e], d["margin" + c] = d["padding" + c] = a;
+        return b && (d.opacity = d.width = a), d
     }
 
-    function hb(a, b, c) {
-        for (var d, e = (kb.tweeners[b] || []).concat(kb.tweeners["*"]), f = 0, g = e.length; f < g; f++)
+    function ic(a, b, c) {
+        for (var d, e = (fc[b] || []).concat(fc["*"]), f = 0, g = e.length; g > f; f++)
             if (d = e[f].call(c, b, a)) return d
     }
 
-    function ib(a, b, c) {
-        var d, e, f, g, h, i, j, k, l = "width" in b || "height" in b,
-            m = this,
-            n = {},
-            o = a.style,
-            p = a.nodeType && da(a),
-            q = W.get(a, "fxshow");
-        c.queue || (g = r._queueHooks(a, "fx"), null == g.unqueued && (g.unqueued = 0, h = g.empty.fire, g.empty.fire = function() {
-            g.unqueued || h()
-        }), g.unqueued++, m.always(function() {
+    function jc(a, b, c) {
+        var d, e, f, g, h, i, j, k, m = this,
+            o = {},
+            p = a.style,
+            q = a.nodeType && V(a),
+            r = n._data(a, "fxshow");
+        c.queue || (h = n._queueHooks(a, "fx"), null == h.unqueued && (h.unqueued = 0, i = h.empty.fire, h.empty.fire = function() {
+            h.unqueued || i()
+        }), h.unqueued++, m.always(function() {
             m.always(function() {
-                g.unqueued--, r.queue(a, "fx").length || g.empty.fire()
+                h.unqueued--, n.queue(a, "fx").length || h.empty.fire()
             })
+        })), 1 === a.nodeType && ("height" in b || "width" in b) && (c.overflow = [p.overflow, p.overflowX, p.overflowY], j = n.css(a, "display"), k = Gb(a.nodeName), "none" === j && (j = k), "inline" === j && "none" === n.css(a, "float") && (l.inlineBlockNeedsLayout && "inline" !== k ? p.zoom = 1 : p.display = "inline-block")), c.overflow && (p.overflow = "hidden", l.shrinkWrapBlocks() || m.always(function() {
+            p.overflow = c.overflow[0], p.overflowX = c.overflow[1], p.overflowY = c.overflow[2]
         }));
         for (d in b)
-            if (e = b[d], cb.test(e)) {
-                if (delete b[d], f = f || "toggle" === e, e === (p ? "hide" : "show")) {
-                    if ("show" !== e || !q || void 0 === q[d]) continue;
-                    p = !0
-                }
-                n[d] = q && q[d] || r.style(a, d)
-            } if (i = !r.isEmptyObject(b), i || !r.isEmptyObject(n)) {
-            l && 1 === a.nodeType && (c.overflow = [o.overflow, o.overflowX, o.overflowY], j = q && q.display, null == j && (j = W.get(a, "display")), k = r.css(a, "display"), "none" === k && (j ? k = j : (ia([a], !0), j = a.style.display || j, k = r.css(a, "display"), ia([a]))), ("inline" === k || "inline-block" === k && null != j) && "none" === r.css(a, "float") && (i || (m.done(function() {
-                o.display = j
-            }), null == j && (k = o.display, j = "none" === k ? "" : k)), o.display = "inline-block")), c.overflow && (o.overflow = "hidden", m.always(function() {
-                o.overflow = c.overflow[0], o.overflowX = c.overflow[1], o.overflowY = c.overflow[2]
-            })), i = !1;
-            for (d in n) i || (q ? "hidden" in q && (p = q.hidden) : q = W.access(a, "fxshow", {
-                display: j
-            }), f && (q.hidden = !p), p && ia([a], !0), m.done(function() {
-                p || ia([a]), W.remove(a, "fxshow");
-                for (d in n) r.style(a, d, n[d])
-            })), i = hb(p ? q[d] : 0, d, m), d in q || (q[d] = i.start, p && (i.end = i.start, i.start = 0))
+            if (e = b[d], bc.exec(e)) {
+                if (delete b[d], f = f || "toggle" === e, e === (q ? "hide" : "show")) {
+                    if ("show" !== e || !r || void 0 === r[d]) continue;
+                    q = !0
+                }
+                o[d] = r && r[d] || n.style(a, d)
+            } if (!n.isEmptyObject(o)) {
+            r ? "hidden" in r && (q = r.hidden) : r = n._data(a, "fxshow", {}), f && (r.hidden = !q), q ? n(a).show() : m.done(function() {
+                n(a).hide()
+            }), m.done(function() {
+                var b;
+                n._removeData(a, "fxshow");
+                for (b in o) n.style(a, b, o[b])
+            });
+            for (d in o) g = ic(q ? r[d] : 0, d, m), d in r || (r[d] = g.start, q && (g.end = g.start, g.start = "width" === d || "height" === d ? 1 : 0))
         }
     }
 
-    function jb(a, b) {
+    function kc(a, b) {
         var c, d, e, f, g;
         for (c in a)
-            if (d = r.camelCase(c), e = b[d], f = a[c], Array.isArray(f) && (e = f[1], f = a[c] = f[0]), c !== d && (a[d] = f, delete a[c]), g = r.cssHooks[d], g && "expand" in g) {
+            if (d = n.camelCase(c), e = b[d], f = a[c], n.isArray(f) && (e = f[1], f = a[c] = f[0]), c !== d && (a[d] = f, delete a[c]), g = n.cssHooks[d], g && "expand" in g) {
                 f = g.expand(f), delete a[d];
                 for (c in f) c in a || (a[c] = f[c], b[c] = e)
             } else b[d] = e
     }
 
-    function kb(a, b, c) {
+    function lc(a, b, c) {
         var d, e, f = 0,
-            g = kb.prefilters.length,
-            h = r.Deferred().always(function() {
+            g = ec.length,
+            h = n.Deferred().always(function() {
                 delete i.elem
             }),
             i = function() {
                 if (e) return !1;
-                for (var b = ab || fb(), c = Math.max(0, j.startTime + j.duration - b), d = c / j.duration || 0, f = 1 - d, g = 0, i = j.tweens.length; g < i; g++) j.tweens[g].run(f);
-                return h.notifyWith(a, [j, f, c]), f < 1 && i ? c : (i || h.notifyWith(a, [j, 1, 0]), h.resolveWith(a, [j]), !1)
+                for (var b = _b || gc(), c = Math.max(0, j.startTime + j.duration - b), d = c / j.duration || 0, f = 1 - d, g = 0, i = j.tweens.length; i > g; g++) j.tweens[g].run(f);
+                return h.notifyWith(a, [j, f, c]), 1 > f && i ? c : (h.resolveWith(a, [j]), !1)
             },
             j = h.promise({
                 elem: a,
-                props: r.extend({}, b),
-                opts: r.extend(!0, {
-                    specialEasing: {},
-                    easing: r.easing._default
+                props: n.extend({}, b),
+                opts: n.extend(!0, {
+                    specialEasing: {}
                 }, c),
                 originalProperties: b,
                 originalOptions: c,
-                startTime: ab || fb(),
+                startTime: _b || gc(),
                 duration: c.duration,
                 tweens: [],
                 createTween: function(b, c) {
-                    var d = r.Tween(a, j.opts, b, c, j.opts.specialEasing[b] || j.opts.easing);
+                    var d = n.Tween(a, j.opts, b, c, j.opts.specialEasing[b] || j.opts.easing);
                     return j.tweens.push(d), d
                 },
                 stop: function(b) {
                     var c = 0,
                         d = b ? j.tweens.length : 0;
                     if (e) return this;
-                    for (e = !0; c < d; c++) j.tweens[c].run(1);
-                    return b ? (h.notifyWith(a, [j, 1, 0]), h.resolveWith(a, [j, b])) : h.rejectWith(a, [j, b]), this
+                    for (e = !0; d > c; c++) j.tweens[c].run(1);
+                    return b ? h.resolveWith(a, [j, b]) : h.rejectWith(a, [j, b]), this
                 }
             }),
             k = j.props;
-        for (jb(k, j.opts.specialEasing); f < g; f++)
-            if (d = kb.prefilters[f].call(j, a, k, j.opts)) return r.isFunction(d.stop) && (r._queueHooks(j.elem, j.opts.queue).stop = r.proxy(d.stop, d)), d;
-        return r.map(k, hb, j), r.isFunction(j.opts.start) && j.opts.start.call(a, j), j.progress(j.opts.progress).done(j.opts.done, j.opts.complete).fail(j.opts.fail).always(j.opts.always), r.fx.timer(r.extend(i, {
+        for (kc(k, j.opts.specialEasing); g > f; f++)
+            if (d = ec[f].call(j, a, k, j.opts)) return d;
+        return n.map(k, ic, j), n.isFunction(j.opts.start) && j.opts.start.call(a, j), n.fx.timer(n.extend(i, {
             elem: a,
             anim: j,
             queue: j.opts.queue
-        })), j
+        })), j.progress(j.opts.progress).done(j.opts.done, j.opts.complete).fail(j.opts.fail).always(j.opts.always)
     }
-    r.Animation = r.extend(kb, {
-            tweeners: {
-                "*": [function(a, b) {
-                    var c = this.createTween(a, b);
-                    return fa(c.elem, a, ba.exec(b), c), c
-                }]
-            },
+    n.Animation = n.extend(lc, {
             tweener: function(a, b) {
-                r.isFunction(a) ? (b = a, a = ["*"]) : a = a.match(L);
-                for (var c, d = 0, e = a.length; d < e; d++) c = a[d], kb.tweeners[c] = kb.tweeners[c] || [], kb.tweeners[c].unshift(b)
+                n.isFunction(a) ? (b = a, a = ["*"]) : a = a.split(" ");
+                for (var c, d = 0, e = a.length; e > d; d++) c = a[d], fc[c] = fc[c] || [], fc[c].unshift(b)
             },
-            prefilters: [ib],
             prefilter: function(a, b) {
-                b ? kb.prefilters.unshift(a) : kb.prefilters.push(a)
+                b ? ec.unshift(a) : ec.push(a)
             }
-        }), r.speed = function(a, b, c) {
-            var d = a && "object" == typeof a ? r.extend({}, a) : {
-                complete: c || !c && b || r.isFunction(a) && a,
+        }), n.speed = function(a, b, c) {
+            var d = a && "object" == typeof a ? n.extend({}, a) : {
+                complete: c || !c && b || n.isFunction(a) && a,
                 duration: a,
-                easing: c && b || b && !r.isFunction(b) && b
+                easing: c && b || b && !n.isFunction(b) && b
             };
-            return r.fx.off ? d.duration = 0 : "number" != typeof d.duration && (d.duration in r.fx.speeds ? d.duration = r.fx.speeds[d.duration] : d.duration = r.fx.speeds._default), null != d.queue && d.queue !== !0 || (d.queue = "fx"), d.old = d.complete, d.complete = function() {
-                r.isFunction(d.old) && d.old.call(this), d.queue && r.dequeue(this, d.queue)
+            return d.duration = n.fx.off ? 0 : "number" == typeof d.duration ? d.duration : d.duration in n.fx.speeds ? n.fx.speeds[d.duration] : n.fx.speeds._default, (null == d.queue || d.queue === !0) && (d.queue = "fx"), d.old = d.complete, d.complete = function() {
+                n.isFunction(d.old) && d.old.call(this), d.queue && n.dequeue(this, d.queue)
             }, d
-        }, r.fn.extend({
+        }, n.fn.extend({
             fadeTo: function(a, b, c, d) {
-                return this.filter(da).css("opacity", 0).show().end().animate({
+                return this.filter(V).css("opacity", 0).show().end().animate({
                     opacity: b
                 }, a, c, d)
             },
             animate: function(a, b, c, d) {
-                var e = r.isEmptyObject(a),
-                    f = r.speed(b, c, d),
+                var e = n.isEmptyObject(a),
+                    f = n.speed(b, c, d),
                     g = function() {
-                        var b = kb(this, r.extend({}, a), f);
-                        (e || W.get(this, "finish")) && b.stop(!0)
+                        var b = lc(this, n.extend({}, a), f);
+                        (e || n._data(this, "finish")) && b.stop(!0)
                     };
                 return g.finish = g, e || f.queue === !1 ? this.each(g) : this.queue(f.queue, g)
             },
             stop: function(a, b, c) {
                 var d = function(a) {
                     var b = a.stop;
                     delete a.stop, b(c)
                 };
                 return "string" != typeof a && (c = b, b = a, a = void 0), b && a !== !1 && this.queue(a || "fx", []), this.each(function() {
                     var b = !0,
                         e = null != a && a + "queueHooks",
-                        f = r.timers,
-                        g = W.get(this);
+                        f = n.timers,
+                        g = n._data(this);
                     if (e) g[e] && g[e].stop && d(g[e]);
                     else
-                        for (e in g) g[e] && g[e].stop && db.test(e) && d(g[e]);
+                        for (e in g) g[e] && g[e].stop && dc.test(e) && d(g[e]);
                     for (e = f.length; e--;) f[e].elem !== this || null != a && f[e].queue !== a || (f[e].anim.stop(c), b = !1, f.splice(e, 1));
-                    !b && c || r.dequeue(this, a)
+                    (b || !c) && n.dequeue(this, a)
                 })
             },
             finish: function(a) {
                 return a !== !1 && (a = a || "fx"), this.each(function() {
-                    var b, c = W.get(this),
+                    var b, c = n._data(this),
                         d = c[a + "queue"],
                         e = c[a + "queueHooks"],
-                        f = r.timers,
+                        f = n.timers,
                         g = d ? d.length : 0;
-                    for (c.finish = !0, r.queue(this, a, []), e && e.stop && e.stop.call(this, !0), b = f.length; b--;) f[b].elem === this && f[b].queue === a && (f[b].anim.stop(!0), f.splice(b, 1));
-                    for (b = 0; b < g; b++) d[b] && d[b].finish && d[b].finish.call(this);
+                    for (c.finish = !0, n.queue(this, a, []), e && e.stop && e.stop.call(this, !0), b = f.length; b--;) f[b].elem === this && f[b].queue === a && (f[b].anim.stop(!0), f.splice(b, 1));
+                    for (b = 0; g > b; b++) d[b] && d[b].finish && d[b].finish.call(this);
                     delete c.finish
                 })
             }
-        }), r.each(["toggle", "show", "hide"], function(a, b) {
-            var c = r.fn[b];
-            r.fn[b] = function(a, d, e) {
-                return null == a || "boolean" == typeof a ? c.apply(this, arguments) : this.animate(gb(b, !0), a, d, e)
-            }
-        }), r.each({
-            slideDown: gb("show"),
-            slideUp: gb("hide"),
-            slideToggle: gb("toggle"),
+        }), n.each(["toggle", "show", "hide"], function(a, b) {
+            var c = n.fn[b];
+            n.fn[b] = function(a, d, e) {
+                return null == a || "boolean" == typeof a ? c.apply(this, arguments) : this.animate(hc(b, !0), a, d, e)
+            }
+        }), n.each({
+            slideDown: hc("show"),
+            slideUp: hc("hide"),
+            slideToggle: hc("toggle"),
             fadeIn: {
                 opacity: "show"
             },
             fadeOut: {
                 opacity: "hide"
             },
             fadeToggle: {
                 opacity: "toggle"
             }
         }, function(a, b) {
-            r.fn[a] = function(a, c, d) {
+            n.fn[a] = function(a, c, d) {
                 return this.animate(b, a, c, d)
             }
-        }), r.timers = [], r.fx.tick = function() {
-            var a, b = 0,
-                c = r.timers;
-            for (ab = r.now(); b < c.length; b++) a = c[b], a() || c[b] !== a || c.splice(b--, 1);
-            c.length || r.fx.stop(), ab = void 0
-        }, r.fx.timer = function(a) {
-            r.timers.push(a), r.fx.start()
-        }, r.fx.interval = 13, r.fx.start = function() {
-            bb || (bb = !0, eb())
-        }, r.fx.stop = function() {
-            bb = null
-        }, r.fx.speeds = {
+        }), n.timers = [], n.fx.tick = function() {
+            var a, b = n.timers,
+                c = 0;
+            for (_b = n.now(); c < b.length; c++) a = b[c], a() || b[c] !== a || b.splice(c--, 1);
+            b.length || n.fx.stop(), _b = void 0
+        }, n.fx.timer = function(a) {
+            n.timers.push(a), a() ? n.fx.start() : n.timers.pop()
+        }, n.fx.interval = 13, n.fx.start = function() {
+            ac || (ac = setInterval(n.fx.tick, n.fx.interval))
+        }, n.fx.stop = function() {
+            clearInterval(ac), ac = null
+        }, n.fx.speeds = {
             slow: 600,
             fast: 200,
             _default: 400
-        }, r.fn.delay = function(b, c) {
-            return b = r.fx ? r.fx.speeds[b] || b : b, c = c || "fx", this.queue(c, function(c, d) {
-                var e = a.setTimeout(c, b);
-                d.stop = function() {
-                    a.clearTimeout(e)
+        }, n.fn.delay = function(a, b) {
+            return a = n.fx ? n.fx.speeds[a] || a : a, b = b || "fx", this.queue(b, function(b, c) {
+                var d = setTimeout(b, a);
+                c.stop = function() {
+                    clearTimeout(d)
                 }
             })
         },
         function() {
-            var a = d.createElement("input"),
-                b = d.createElement("select"),
-                c = b.appendChild(d.createElement("option"));
-            a.type = "checkbox", o.checkOn = "" !== a.value, o.optSelected = c.selected, a = d.createElement("input"), a.value = "t", a.type = "radio", o.radioValue = "t" === a.value
+            var a, b, c, d, e = z.createElement("div");
+            e.setAttribute("className", "t"), e.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>", a = e.getElementsByTagName("a")[0], c = z.createElement("select"), d = c.appendChild(z.createElement("option")), b = e.getElementsByTagName("input")[0], a.style.cssText = "top:1px", l.getSetAttribute = "t" !== e.className, l.style = /top/.test(a.getAttribute("style")), l.hrefNormalized = "/a" === a.getAttribute("href"), l.checkOn = !!b.value, l.optSelected = d.selected, l.enctype = !!z.createElement("form").enctype, c.disabled = !0, l.optDisabled = !d.disabled, b = z.createElement("input"), b.setAttribute("value", ""), l.input = "" === b.getAttribute("value"), b.value = "t", b.setAttribute("type", "radio"), l.radioValue = "t" === b.value, a = b = c = d = e = null
         }();
-    var lb, mb = r.expr.attrHandle;
-    r.fn.extend({
+    var mc = /\r/g;
+    n.fn.extend({
+        val: function(a) {
+            var b, c, d, e = this[0];
+            {
+                if (arguments.length) return d = n.isFunction(a), this.each(function(c) {
+                    var e;
+                    1 === this.nodeType && (e = d ? a.call(this, c, n(this).val()) : a, null == e ? e = "" : "number" == typeof e ? e += "" : n.isArray(e) && (e = n.map(e, function(a) {
+                        return null == a ? "" : a + ""
+                    })), b = n.valHooks[this.type] || n.valHooks[this.nodeName.toLowerCase()], b && "set" in b && void 0 !== b.set(this, e, "value") || (this.value = e))
+                });
+                if (e) return b = n.valHooks[e.type] || n.valHooks[e.nodeName.toLowerCase()], b && "get" in b && void 0 !== (c = b.get(e, "value")) ? c : (c = e.value, "string" == typeof c ? c.replace(mc, "") : null == c ? "" : c)
+            }
+        }
+    }), n.extend({
+        valHooks: {
+            option: {
+                get: function(a) {
+                    var b = n.find.attr(a, "value");
+                    return null != b ? b : n.text(a)
+                }
+            },
+            select: {
+                get: function(a) {
+                    for (var b, c, d = a.options, e = a.selectedIndex, f = "select-one" === a.type || 0 > e, g = f ? null : [], h = f ? e + 1 : d.length, i = 0 > e ? h : f ? e : 0; h > i; i++)
+                        if (c = d[i], !(!c.selected && i !== e || (l.optDisabled ? c.disabled : null !== c.getAttribute("disabled")) || c.parentNode.disabled && n.nodeName(c.parentNode, "optgroup"))) {
+                            if (b = n(c).val(), f) return b;
+                            g.push(b)
+                        } return g
+                },
+                set: function(a, b) {
+                    var c, d, e = a.options,
+                        f = n.makeArray(b),
+                        g = e.length;
+                    while (g--)
+                        if (d = e[g], n.inArray(n.valHooks.option.get(d), f) >= 0) try {
+                            d.selected = c = !0
+                        } catch (h) {
+                            d.scrollHeight
+                        } else d.selected = !1;
+                    return c || (a.selectedIndex = -1), e
+                }
+            }
+        }
+    }), n.each(["radio", "checkbox"], function() {
+        n.valHooks[this] = {
+            set: function(a, b) {
+                return n.isArray(b) ? a.checked = n.inArray(n(a).val(), b) >= 0 : void 0
+            }
+        }, l.checkOn || (n.valHooks[this].get = function(a) {
+            return null === a.getAttribute("value") ? "on" : a.value
+        })
+    });
+    var nc, oc, pc = n.expr.attrHandle,
+        qc = /^(?:checked|selected)$/i,
+        rc = l.getSetAttribute,
+        sc = l.input;
+    n.fn.extend({
         attr: function(a, b) {
-            return T(this, r.attr, a, b, arguments.length > 1)
+            return W(this, n.attr, a, b, arguments.length > 1)
         },
         removeAttr: function(a) {
             return this.each(function() {
-                r.removeAttr(this, a)
+                n.removeAttr(this, a)
             })
         }
-    }), r.extend({
+    }), n.extend({
         attr: function(a, b, c) {
             var d, e, f = a.nodeType;
-            if (3 !== f && 8 !== f && 2 !== f) return "undefined" == typeof a.getAttribute ? r.prop(a, b, c) : (1 === f && r.isXMLDoc(a) || (e = r.attrHooks[b.toLowerCase()] || (r.expr.match.bool.test(b) ? lb : void 0)), void 0 !== c ? null === c ? void r.removeAttr(a, b) : e && "set" in e && void 0 !== (d = e.set(a, c, b)) ? d : (a.setAttribute(b, c + ""), c) : e && "get" in e && null !== (d = e.get(a, b)) ? d : (d = r.find.attr(a, b),
-                null == d ? void 0 : d))
+            if (a && 3 !== f && 8 !== f && 2 !== f) return typeof a.getAttribute === L ? n.prop(a, b, c) : (1 === f && n.isXMLDoc(a) || (b = b.toLowerCase(), d = n.attrHooks[b] || (n.expr.match.bool.test(b) ? oc : nc)), void 0 === c ? d && "get" in d && null !== (e = d.get(a, b)) ? e : (e = n.find.attr(a, b), null == e ? void 0 : e) : null !== c ? d && "set" in d && void 0 !== (e = d.set(a, c, b)) ? e : (a.setAttribute(b, c + ""), c) : void n.removeAttr(a, b))
+        },
+        removeAttr: function(a, b) {
+            var c, d, e = 0,
+                f = b && b.match(F);
+            if (f && 1 === a.nodeType)
+                while (c = f[e++]) d = n.propFix[c] || c, n.expr.match.bool.test(c) ? sc && rc || !qc.test(c) ? a[d] = !1 : a[n.camelCase("default-" + c)] = a[d] = !1 : n.attr(a, c, ""), a.removeAttribute(rc ? c : d)
         },
         attrHooks: {
             type: {
                 set: function(a, b) {
-                    if (!o.radioValue && "radio" === b && B(a, "input")) {
+                    if (!l.radioValue && "radio" === b && n.nodeName(a, "input")) {
                         var c = a.value;
                         return a.setAttribute("type", b), c && (a.value = c), b
                     }
                 }
             }
-        },
-        removeAttr: function(a, b) {
-            var c, d = 0,
-                e = b && b.match(L);
-            if (e && 1 === a.nodeType)
-                while (c = e[d++]) a.removeAttribute(c)
         }
-    }), lb = {
+    }), oc = {
         set: function(a, b, c) {
-            return b === !1 ? r.removeAttr(a, c) : a.setAttribute(c, c), c
+            return b === !1 ? n.removeAttr(a, c) : sc && rc || !qc.test(c) ? a.setAttribute(!rc && n.propFix[c] || c, c) : a[n.camelCase("default-" + c)] = a[c] = !0, c
         }
-    }, r.each(r.expr.match.bool.source.match(/\w+/g), function(a, b) {
-        var c = mb[b] || r.find.attr;
-        mb[b] = function(a, b, d) {
-            var e, f, g = b.toLowerCase();
-            return d || (f = mb[g], mb[g] = e, e = null != c(a, b, d) ? g : null, mb[g] = f), e
+    }, n.each(n.expr.match.bool.source.match(/\w+/g), function(a, b) {
+        var c = pc[b] || n.find.attr;
+        pc[b] = sc && rc || !qc.test(b) ? function(a, b, d) {
+            var e, f;
+            return d || (f = pc[b], pc[b] = e, e = null != c(a, b, d) ? b.toLowerCase() : null, pc[b] = f), e
+        } : function(a, b, c) {
+            return c ? void 0 : a[n.camelCase("default-" + b)] ? b.toLowerCase() : null
+        }
+    }), sc && rc || (n.attrHooks.value = {
+        set: function(a, b, c) {
+            return n.nodeName(a, "input") ? void(a.defaultValue = b) : nc && nc.set(a, b, c)
+        }
+    }), rc || (nc = {
+        set: function(a, b, c) {
+            var d = a.getAttributeNode(c);
+            return d || a.setAttributeNode(d = a.ownerDocument.createAttribute(c)), d.value = b += "", "value" === c || b === a.getAttribute(c) ? b : void 0
+        }
+    }, pc.id = pc.name = pc.coords = function(a, b, c) {
+        var d;
+        return c ? void 0 : (d = a.getAttributeNode(b)) && "" !== d.value ? d.value : null
+    }, n.valHooks.button = {
+        get: function(a, b) {
+            var c = a.getAttributeNode(b);
+            return c && c.specified ? c.value : void 0
+        },
+        set: nc.set
+    }, n.attrHooks.contenteditable = {
+        set: function(a, b, c) {
+            nc.set(a, "" === b ? !1 : b, c)
+        }
+    }, n.each(["width", "height"], function(a, b) {
+        n.attrHooks[b] = {
+            set: function(a, c) {
+                return "" === c ? (a.setAttribute(b, "auto"), c) : void 0
+            }
+        }
+    })), l.style || (n.attrHooks.style = {
+        get: function(a) {
+            return a.style.cssText || void 0
+        },
+        set: function(a, b) {
+            return a.style.cssText = b + ""
         }
     });
-    var nb = /^(?:input|select|textarea|button)$/i,
-        ob = /^(?:a|area)$/i;
-    r.fn.extend({
+    var tc = /^(?:input|select|textarea|button|object)$/i,
+        uc = /^(?:a|area)$/i;
+    n.fn.extend({
         prop: function(a, b) {
-            return T(this, r.prop, a, b, arguments.length > 1)
+            return W(this, n.prop, a, b, arguments.length > 1)
         },
         removeProp: function(a) {
-            return this.each(function() {
-                delete this[r.propFix[a] || a]
+            return a = n.propFix[a] || a, this.each(function() {
+                try {
+                    this[a] = void 0, delete this[a]
+                } catch (b) {}
             })
         }
-    }), r.extend({
+    }), n.extend({
+        propFix: {
+            "for": "htmlFor",
+            "class": "className"
+        },
         prop: function(a, b, c) {
-            var d, e, f = a.nodeType;
-            if (3 !== f && 8 !== f && 2 !== f) return 1 === f && r.isXMLDoc(a) || (b = r.propFix[b] || b, e = r.propHooks[b]), void 0 !== c ? e && "set" in e && void 0 !== (d = e.set(a, c, b)) ? d : a[b] = c : e && "get" in e && null !== (d = e.get(a, b)) ? d : a[b]
+            var d, e, f, g = a.nodeType;
+            if (a && 3 !== g && 8 !== g && 2 !== g) return f = 1 !== g || !n.isXMLDoc(a), f && (b = n.propFix[b] || b, e = n.propHooks[b]), void 0 !== c ? e && "set" in e && void 0 !== (d = e.set(a, c, b)) ? d : a[b] = c : e && "get" in e && null !== (d = e.get(a, b)) ? d : a[b]
         },
         propHooks: {
             tabIndex: {
                 get: function(a) {
-                    var b = r.find.attr(a, "tabindex");
-                    return b ? parseInt(b, 10) : nb.test(a.nodeName) || ob.test(a.nodeName) && a.href ? 0 : -1
+                    var b = n.find.attr(a, "tabindex");
+                    return b ? parseInt(b, 10) : tc.test(a.nodeName) || uc.test(a.nodeName) && a.href ? 0 : -1
                 }
             }
-        },
-        propFix: {
-            "for": "htmlFor",
-            "class": "className"
         }
-    }), o.optSelected || (r.propHooks.selected = {
+    }), l.hrefNormalized || n.each(["href", "src"], function(a, b) {
+        n.propHooks[b] = {
+            get: function(a) {
+                return a.getAttribute(b, 4)
+            }
+        }
+    }), l.optSelected || (n.propHooks.selected = {
         get: function(a) {
             var b = a.parentNode;
-            return b && b.parentNode && b.parentNode.selectedIndex, null
-        },
-        set: function(a) {
-            var b = a.parentNode;
-            b && (b.selectedIndex, b.parentNode && b.parentNode.selectedIndex)
+            return b && (b.selectedIndex, b.parentNode && b.parentNode.selectedIndex), null
         }
-    }), r.each(["tabIndex", "readOnly", "maxLength", "cellSpacing", "cellPadding", "rowSpan", "colSpan", "useMap", "frameBorder", "contentEditable"], function() {
-        r.propFix[this.toLowerCase()] = this
-    });
-
-    function pb(a) {
-        var b = a.match(L) || [];
-        return b.join(" ")
-    }
-
-    function qb(a) {
-        return a.getAttribute && a.getAttribute("class") || ""
-    }
-    r.fn.extend({
+    }), n.each(["tabIndex", "readOnly", "maxLength", "cellSpacing", "cellPadding", "rowSpan", "colSpan", "useMap", "frameBorder", "contentEditable"], function() {
+        n.propFix[this.toLowerCase()] = this
+    }), l.enctype || (n.propFix.enctype = "encoding");
+    var vc = /[\t\r\n\f]/g;
+    n.fn.extend({
         addClass: function(a) {
-            var b, c, d, e, f, g, h, i = 0;
-            if (r.isFunction(a)) return this.each(function(b) {
-                r(this).addClass(a.call(this, b, qb(this)))
+            var b, c, d, e, f, g, h = 0,
+                i = this.length,
+                j = "string" == typeof a && a;
+            if (n.isFunction(a)) return this.each(function(b) {
+                n(this).addClass(a.call(this, b, this.className))
             });
-            if ("string" == typeof a && a) {
-                b = a.match(L) || [];
-                while (c = this[i++])
-                    if (e = qb(c), d = 1 === c.nodeType && " " + pb(e) + " ") {
-                        g = 0;
-                        while (f = b[g++]) d.indexOf(" " + f + " ") < 0 && (d += f + " ");
-                        h = pb(d), e !== h && c.setAttribute("class", h)
-                    }
-            }
-            return this
+            if (j)
+                for (b = (a || "").match(F) || []; i > h; h++)
+                    if (c = this[h], d = 1 === c.nodeType && (c.className ? (" " + c.className + " ").replace(vc, " ") : " ")) {
+                        f = 0;
+                        while (e = b[f++]) d.indexOf(" " + e + " ") < 0 && (d += e + " ");
+                        g = n.trim(d), c.className !== g && (c.className = g)
+                    } return this
         },
         removeClass: function(a) {
-            var b, c, d, e, f, g, h, i = 0;
-            if (r.isFunction(a)) return this.each(function(b) {
-                r(this).removeClass(a.call(this, b, qb(this)))
+            var b, c, d, e, f, g, h = 0,
+                i = this.length,
+                j = 0 === arguments.length || "string" == typeof a && a;
+            if (n.isFunction(a)) return this.each(function(b) {
+                n(this).removeClass(a.call(this, b, this.className))
             });
-            if (!arguments.length) return this.attr("class", "");
-            if ("string" == typeof a && a) {
-                b = a.match(L) || [];
-                while (c = this[i++])
-                    if (e = qb(c), d = 1 === c.nodeType && " " + pb(e) + " ") {
-                        g = 0;
-                        while (f = b[g++])
-                            while (d.indexOf(" " + f + " ") > -1) d = d.replace(" " + f + " ", " ");
-                        h = pb(d), e !== h && c.setAttribute("class", h)
-                    }
-            }
-            return this
+            if (j)
+                for (b = (a || "").match(F) || []; i > h; h++)
+                    if (c = this[h], d = 1 === c.nodeType && (c.className ? (" " + c.className + " ").replace(vc, " ") : "")) {
+                        f = 0;
+                        while (e = b[f++])
+                            while (d.indexOf(" " + e + " ") >= 0) d = d.replace(" " + e + " ", " ");
+                        g = a ? n.trim(d) : "", c.className !== g && (c.className = g)
+                    } return this
         },
         toggleClass: function(a, b) {
             var c = typeof a;
-            return "boolean" == typeof b && "string" === c ? b ? this.addClass(a) : this.removeClass(a) : r.isFunction(a) ? this.each(function(c) {
-                r(this).toggleClass(a.call(this, c, qb(this), b), b)
-            }) : this.each(function() {
-                var b, d, e, f;
+            return "boolean" == typeof b && "string" === c ? b ? this.addClass(a) : this.removeClass(a) : this.each(n.isFunction(a) ? function(c) {
+                n(this).toggleClass(a.call(this, c, this.className, b), b)
+            } : function() {
                 if ("string" === c) {
-                    d = 0, e = r(this), f = a.match(L) || [];
+                    var b, d = 0,
+                        e = n(this),
+                        f = a.match(F) || [];
                     while (b = f[d++]) e.hasClass(b) ? e.removeClass(b) : e.addClass(b)
-                } else void 0 !== a && "boolean" !== c || (b = qb(this), b && W.set(this, "__className__", b), this.setAttribute && this.setAttribute("class", b || a === !1 ? "" : W.get(this, "__className__") || ""))
+                } else(c === L || "boolean" === c) && (this.className && n._data(this, "__className__", this.className), this.className = this.className || a === !1 ? "" : n._data(this, "__className__") || "")
             })
         },
         hasClass: function(a) {
-            var b, c, d = 0;
-            b = " " + a + " ";
-            while (c = this[d++])
-                if (1 === c.nodeType && (" " + pb(qb(c)) + " ").indexOf(b) > -1) return !0;
+            for (var b = " " + a + " ", c = 0, d = this.length; d > c; c++)
+                if (1 === this[c].nodeType && (" " + this[c].className + " ").replace(vc, " ").indexOf(b) >= 0) return !0;
             return !1
         }
-    });
-    var rb = /\r/g;
-    r.fn.extend({
-        val: function(a) {
-            var b, c, d, e = this[0];
-            {
-                if (arguments.length) return d = r.isFunction(a), this.each(function(c) {
-                    var e;
-                    1 === this.nodeType && (e = d ? a.call(this, c, r(this).val()) : a, null == e ? e = "" : "number" == typeof e ? e += "" : Array.isArray(e) && (e = r.map(e, function(a) {
-                        return null == a ? "" : a + ""
-                    })), b = r.valHooks[this.type] || r.valHooks[this.nodeName.toLowerCase()], b && "set" in b && void 0 !== b.set(this, e, "value") || (this.value = e))
-                });
-                if (e) return b = r.valHooks[e.type] || r.valHooks[e.nodeName.toLowerCase()], b && "get" in b && void 0 !== (c = b.get(e, "value")) ? c : (c = e.value, "string" == typeof c ? c.replace(rb, "") : null == c ? "" : c)
-            }
-        }
-    }), r.extend({
-        valHooks: {
-            option: {
-                get: function(a) {
-                    var b = r.find.attr(a, "value");
-                    return null != b ? b : pb(r.text(a))
-                }
-            },
-            select: {
-                get: function(a) {
-                    var b, c, d, e = a.options,
-                        f = a.selectedIndex,
-                        g = "select-one" === a.type,
-                        h = g ? null : [],
-                        i = g ? f + 1 : e.length;
-                    for (d = f < 0 ? i : g ? f : 0; d < i; d++)
-                        if (c = e[d], (c.selected || d === f) && !c.disabled && (!c.parentNode.disabled || !B(c.parentNode, "optgroup"))) {
-                            if (b = r(c).val(), g) return b;
-                            h.push(b)
-                        } return h
-                },
-                set: function(a, b) {
-                    var c, d, e = a.options,
-                        f = r.makeArray(b),
-                        g = e.length;
-                    while (g--) d = e[g], (d.selected = r.inArray(r.valHooks.option.get(d), f) > -1) && (c = !0);
-                    return c || (a.selectedIndex = -1), f
-                }
-            }
-        }
-    }), r.each(["radio", "checkbox"], function() {
-        r.valHooks[this] = {
-            set: function(a, b) {
-                if (Array.isArray(b)) return a.checked = r.inArray(r(a).val(), b) > -1
-            }
-        }, o.checkOn || (r.valHooks[this].get = function(a) {
-            return null === a.getAttribute("value") ? "on" : a.value
-        })
-    });
-    var sb = /^(?:focusinfocus|focusoutblur)$/;
-    r.extend(r.event, {
-        trigger: function(b, c, e, f) {
-            var g, h, i, j, k, m, n, o = [e || d],
-                p = l.call(b, "type") ? b.type : b,
-                q = l.call(b, "namespace") ? b.namespace.split(".") : [];
-            if (h = i = e = e || d, 3 !== e.nodeType && 8 !== e.nodeType && !sb.test(p + r.event.triggered) && (p.indexOf(".") > -1 && (q = p.split("."), p = q.shift(), q.sort()), k = p.indexOf(":") < 0 && "on" + p, b = b[r.expando] ? b : new r.Event(p, "object" == typeof b && b), b.isTrigger = f ? 2 : 3, b.namespace = q.join("."), b.rnamespace = b.namespace ? new RegExp("(^|\\.)" + q.join("\\.(?:.*\\.|)") + "(\\.|$)") : null, b.result = void 0, b.target || (b.target = e), c = null == c ? [b] : r.makeArray(c, [b]), n = r.event.special[p] || {}, f || !n.trigger || n.trigger.apply(e, c) !== !1)) {
-                if (!f && !n.noBubble && !r.isWindow(e)) {
-                    for (j = n.delegateType || p, sb.test(j + p) || (h = h.parentNode); h; h = h.parentNode) o.push(h), i = h;
-                    i === (e.ownerDocument || d) && o.push(i.defaultView || i.parentWindow || a)
-                }
-                g = 0;
-                while ((h = o[g++]) && !b.isPropagationStopped()) b.type = g > 1 ? j : n.bindType || p, m = (W.get(h, "events") || {})[b.type] && W.get(h, "handle"), m && m.apply(h, c), m = k && h[k], m && m.apply && U(h) && (b.result = m.apply(h, c), b.result === !1 && b.preventDefault());
-                return b.type = p, f || b.isDefaultPrevented() || n._default && n._default.apply(o.pop(), c) !== !1 || !U(e) || k && r.isFunction(e[p]) && !r.isWindow(e) && (i = e[k], i && (e[k] = null), r.event.triggered = p, e[p](), r.event.triggered = void 0, i && (e[k] = i)), b.result
-            }
-        },
-        simulate: function(a, b, c) {
-            var d = r.extend(new r.Event, c, {
-                type: a,
-                isSimulated: !0
-            });
-            r.event.trigger(d, null, b)
-        }
-    }), r.fn.extend({
-        trigger: function(a, b) {
-            return this.each(function() {
-                r.event.trigger(a, b, this)
-            })
-        },
-        triggerHandler: function(a, b) {
-            var c = this[0];
-            if (c) return r.event.trigger(a, b, c, !0)
-        }
-    }), r.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "), function(a, b) {
-        r.fn[b] = function(a, c) {
+    }), n.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "), function(a, b) {
+        n.fn[b] = function(a, c) {
             return arguments.length > 0 ? this.on(b, null, a, c) : this.trigger(b)
         }
-    }), r.fn.extend({
+    }), n.fn.extend({
         hover: function(a, b) {
             return this.mouseenter(a).mouseleave(b || a)
-        }
-    }), o.focusin = "onfocusin" in a, o.focusin || r.each({
-        focus: "focusin",
-        blur: "focusout"
-    }, function(a, b) {
-        var c = function(a) {
-            r.event.simulate(b, a.target, r.event.fix(a))
-        };
-        r.event.special[b] = {
-            setup: function() {
-                var d = this.ownerDocument || this,
-                    e = W.access(d, b);
-                e || d.addEventListener(a, c, !0), W.access(d, b, (e || 0) + 1)
-            },
-            teardown: function() {
-                var d = this.ownerDocument || this,
-                    e = W.access(d, b) - 1;
-                e ? W.access(d, b, e) : (d.removeEventListener(a, c, !0), W.remove(d, b))
-            }
+        },
+        bind: function(a, b, c) {
+            return this.on(a, null, b, c)
+        },
+        unbind: function(a, b) {
+            return this.off(a, null, b)
+        },
+        delegate: function(a, b, c, d) {
+            return this.on(b, a, c, d)
+        },
+        undelegate: function(a, b, c) {
+            return 1 === arguments.length ? this.off(a, "**") : this.off(b, a || "**", c)
         }
     });
-    var tb = a.location,
-        ub = r.now(),
-        vb = /\?/;
-    r.parseXML = function(b) {
-        var c;
+    var wc = n.now(),
+        xc = /\?/,
+        yc = /(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;
+    n.parseJSON = function(b) {
+        if (a.JSON && a.JSON.parse) return a.JSON.parse(b + "");
+        var c, d = null,
+            e = n.trim(b + "");
+        return e && !n.trim(e.replace(yc, function(a, b, e, f) {
+            return c && b && (d = 0), 0 === d ? a : (c = e || b, d += !f - !e, "")
+        })) ? Function("return " + e)() : n.error("Invalid JSON: " + b)
+    }, n.parseXML = function(b) {
+        var c, d;
         if (!b || "string" != typeof b) return null;
         try {
-            c = (new a.DOMParser).parseFromString(b, "text/xml")
-        } catch (d) {
+            a.DOMParser ? (d = new DOMParser, c = d.parseFromString(b, "text/xml")) : (c = new ActiveXObject("Microsoft.XMLDOM"), c.async = "false", c.loadXML(b))
+        } catch (e) {
             c = void 0
         }
-        return c && !c.getElementsByTagName("parsererror").length || r.error("Invalid XML: " + b), c
+        return c && c.documentElement && !c.getElementsByTagName("parsererror").length || n.error("Invalid XML: " + b), c
     };
-    var wb = /\[\]$/,
-        xb = /\r?\n/g,
-        yb = /^(?:submit|button|image|reset|file)$/i,
-        zb = /^(?:input|select|textarea|keygen)/i;
-
-    function Ab(a, b, c, d) {
-        var e;
-        if (Array.isArray(b)) r.each(b, function(b, e) {
-            c || wb.test(a) ? d(a, e) : Ab(a + "[" + ("object" == typeof e && null != e ? b : "") + "]", e, c, d)
-        });
-        else if (c || "object" !== r.type(b)) d(a, b);
-        else
-            for (e in b) Ab(a + "[" + e + "]", b[e], c, d)
+    var zc, Ac, Bc = /#.*$/,
+        Cc = /([?&])_=[^&]*/,
+        Dc = /^(.*?):[ \t]*([^\r\n]*)\r?$/gm,
+        Ec = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,
+        Fc = /^(?:GET|HEAD)$/,
+        Gc = /^\/\//,
+        Hc = /^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,
+        Ic = {},
+        Jc = {},
+        Kc = "*/".concat("*");
+    try {
+        Ac = location.href
+    } catch (Lc) {
+        Ac = z.createElement("a"), Ac.href = "", Ac = Ac.href
     }
-    r.param = function(a, b) {
-        var c, d = [],
-            e = function(a, b) {
-                var c = r.isFunction(b) ? b() : b;
-                d[d.length] = encodeURIComponent(a) + "=" + encodeURIComponent(null == c ? "" : c)
-            };
-        if (Array.isArray(a) || a.jquery && !r.isPlainObject(a)) r.each(a, function() {
-            e(this.name, this.value)
-        });
-        else
-            for (c in a) Ab(c, a[c], b, e);
-        return d.join("&")
-    }, r.fn.extend({
-        serialize: function() {
-            return r.param(this.serializeArray())
-        },
-        serializeArray: function() {
-            return this.map(function() {
-                var a = r.prop(this, "elements");
-                return a ? r.makeArray(a) : this
-            }).filter(function() {
-                var a = this.type;
-                return this.name && !r(this).is(":disabled") && zb.test(this.nodeName) && !yb.test(a) && (this.checked || !ja.test(a))
-            }).map(function(a, b) {
-                var c = r(this).val();
-                return null == c ? null : Array.isArray(c) ? r.map(c, function(a) {
-                    return {
-                        name: b.name,
-                        value: a.replace(xb, "\r\n")
-                    }
-                }) : {
-                    name: b.name,
-                    value: c.replace(xb, "\r\n")
-                }
-            }).get()
-        }
-    });
-    var Bb = /%20/g,
-        Cb = /#.*$/,
-        Db = /([?&])_=[^&]*/,
-        Eb = /^(.*?):[ \t]*([^\r\n]*)$/gm,
-        Fb = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,
-        Gb = /^(?:GET|HEAD)$/,
-        Hb = /^\/\//,
-        Ib = {},
-        Jb = {},
-        Kb = "*/".concat("*"),
-        Lb = d.createElement("a");
-    Lb.href = tb.href;
+    zc = Hc.exec(Ac.toLowerCase()) || [];
 
-    function Mb(a) {
+    function Mc(a) {
         return function(b, c) {
             "string" != typeof b && (c = b, b = "*");
             var d, e = 0,
-                f = b.toLowerCase().match(L) || [];
-            if (r.isFunction(c))
-                while (d = f[e++]) "+" === d[0] ? (d = d.slice(1) || "*", (a[d] = a[d] || []).unshift(c)) : (a[d] = a[d] || []).push(c)
+                f = b.toLowerCase().match(F) || [];
+            if (n.isFunction(c))
+                while (d = f[e++]) "+" === d.charAt(0) ? (d = d.slice(1) || "*", (a[d] = a[d] || []).unshift(c)) : (a[d] = a[d] || []).push(c)
         }
     }
 
-    function Nb(a, b, c, d) {
+    function Nc(a, b, c, d) {
         var e = {},
-            f = a === Jb;
+            f = a === Jc;
 
         function g(h) {
             var i;
-            return e[h] = !0, r.each(a[h] || [], function(a, h) {
+            return e[h] = !0, n.each(a[h] || [], function(a, h) {
                 var j = h(b, c, d);
                 return "string" != typeof j || f || e[j] ? f ? !(i = j) : void 0 : (b.dataTypes.unshift(j), g(j), !1)
             }), i
         }
         return g(b.dataTypes[0]) || !e["*"] && g("*")
     }
 
-    function Ob(a, b) {
-        var c, d, e = r.ajaxSettings.flatOptions || {};
-        for (c in b) void 0 !== b[c] && ((e[c] ? a : d || (d = {}))[c] = b[c]);
-        return d && r.extend(!0, a, d), a
+    function Oc(a, b) {
+        var c, d, e = n.ajaxSettings.flatOptions || {};
+        for (d in b) void 0 !== b[d] && ((e[d] ? a : c || (c = {}))[d] = b[d]);
+        return c && n.extend(!0, a, c), a
     }
 
-    function Pb(a, b, c) {
+    function Pc(a, b, c) {
         var d, e, f, g, h = a.contents,
             i = a.dataTypes;
-        while ("*" === i[0]) i.shift(), void 0 === d && (d = a.mimeType || b.getResponseHeader("Content-Type"));
-        if (d)
-            for (e in h)
-                if (h[e] && h[e].test(d)) {
-                    i.unshift(e);
+        while ("*" === i[0]) i.shift(), void 0 === e && (e = a.mimeType || b.getResponseHeader("Content-Type"));
+        if (e)
+            for (g in h)
+                if (h[g] && h[g].test(e)) {
+                    i.unshift(g);
                     break
                 } if (i[0] in c) f = i[0];
         else {
-            for (e in c) {
-                if (!i[0] || a.converters[e + " " + i[0]]) {
-                    f = e;
+            for (g in c) {
+                if (!i[0] || a.converters[g + " " + i[0]]) {
+                    f = g;
                     break
                 }
-                g || (g = e)
+                d || (d = g)
             }
-            f = f || g
+            f = f || d
         }
-        if (f) return f !== i[0] && i.unshift(f), c[f]
+        return f ? (f !== i[0] && i.unshift(f), c[f]) : void 0
     }
 
-    function Qb(a, b, c, d) {
+    function Qc(a, b, c, d) {
         var e, f, g, h, i, j = {},
             k = a.dataTypes.slice();
         if (k[1])
             for (g in a.converters) j[g.toLowerCase()] = a.converters[g];
         f = k.shift();
         while (f)
             if (a.responseFields[f] && (c[a.responseFields[f]] = b), !i && d && a.dataFilter && (b = a.dataFilter(b, a.dataType)), i = f, f = k.shift())
@@ -2819,413 +2896,464 @@
                 }
         }
         return {
             state: "success",
             data: b
         }
     }
-    r.extend({
+    n.extend({
         active: 0,
         lastModified: {},
         etag: {},
         ajaxSettings: {
-            url: tb.href,
+            url: Ac,
             type: "GET",
-            isLocal: Fb.test(tb.protocol),
+            isLocal: Ec.test(zc[1]),
             global: !0,
             processData: !0,
             async: !0,
             contentType: "application/x-www-form-urlencoded; charset=UTF-8",
             accepts: {
-                "*": Kb,
+                "*": Kc,
                 text: "text/plain",
                 html: "text/html",
                 xml: "application/xml, text/xml",
                 json: "application/json, text/javascript"
             },
             contents: {
-                xml: /\bxml\b/,
-                html: /\bhtml/,
-                json: /\bjson\b/
+                xml: /xml/,
+                html: /html/,
+                json: /json/
             },
             responseFields: {
                 xml: "responseXML",
                 text: "responseText",
                 json: "responseJSON"
             },
             converters: {
                 "* text": String,
                 "text html": !0,
-                "text json": JSON.parse,
-                "text xml": r.parseXML
+                "text json": n.parseJSON,
+                "text xml": n.parseXML
             },
             flatOptions: {
                 url: !0,
                 context: !0
             }
         },
         ajaxSetup: function(a, b) {
-            return b ? Ob(Ob(a, r.ajaxSettings), b) : Ob(r.ajaxSettings, a)
+            return b ? Oc(Oc(a, n.ajaxSettings), b) : Oc(n.ajaxSettings, a)
         },
-        ajaxPrefilter: Mb(Ib),
-        ajaxTransport: Mb(Jb),
-        ajax: function(b, c) {
-            "object" == typeof b && (c = b, b = void 0), c = c || {};
-            var e, f, g, h, i, j, k, l, m, n, o = r.ajaxSetup({}, c),
-                p = o.context || o,
-                q = o.context && (p.nodeType || p.jquery) ? r(p) : r.event,
-                s = r.Deferred(),
-                t = r.Callbacks("once memory"),
-                u = o.statusCode || {},
-                v = {},
-                w = {},
-                x = "canceled",
-                y = {
+        ajaxPrefilter: Mc(Ic),
+        ajaxTransport: Mc(Jc),
+        ajax: function(a, b) {
+            "object" == typeof a && (b = a, a = void 0), b = b || {};
+            var c, d, e, f, g, h, i, j, k = n.ajaxSetup({}, b),
+                l = k.context || k,
+                m = k.context && (l.nodeType || l.jquery) ? n(l) : n.event,
+                o = n.Deferred(),
+                p = n.Callbacks("once memory"),
+                q = k.statusCode || {},
+                r = {},
+                s = {},
+                t = 0,
+                u = "canceled",
+                v = {
                     readyState: 0,
                     getResponseHeader: function(a) {
                         var b;
-                        if (k) {
-                            if (!h) {
-                                h = {};
-                                while (b = Eb.exec(g)) h[b[1].toLowerCase()] = b[2]
+                        if (2 === t) {
+                            if (!j) {
+                                j = {};
+                                while (b = Dc.exec(f)) j[b[1].toLowerCase()] = b[2]
                             }
-                            b = h[a.toLowerCase()]
+                            b = j[a.toLowerCase()]
                         }
                         return null == b ? null : b
                     },
                     getAllResponseHeaders: function() {
-                        return k ? g : null
+                        return 2 === t ? f : null
                     },
                     setRequestHeader: function(a, b) {
-                        return null == k && (a = w[a.toLowerCase()] = w[a.toLowerCase()] || a, v[a] = b), this
+                        var c = a.toLowerCase();
+                        return t || (a = s[c] = s[c] || a, r[a] = b), this
                     },
                     overrideMimeType: function(a) {
-                        return null == k && (o.mimeType = a), this
+                        return t || (k.mimeType = a), this
                     },
                     statusCode: function(a) {
                         var b;
                         if (a)
-                            if (k) y.always(a[y.status]);
-                            else
-                                for (b in a) u[b] = [u[b], a[b]];
+                            if (2 > t)
+                                for (b in a) q[b] = [q[b], a[b]];
+                            else v.always(a[v.status]);
                         return this
                     },
                     abort: function(a) {
-                        var b = a || x;
-                        return e && e.abort(b), A(0, b), this
+                        var b = a || u;
+                        return i && i.abort(b), x(0, b), this
                     }
                 };
-            if (s.promise(y), o.url = ((b || o.url || tb.href) + "").replace(Hb, tb.protocol + "//"), o.type = c.method || c.type || o.method || o.type, o.dataTypes = (o.dataType || "*").toLowerCase().match(L) || [""], null == o.crossDomain) {
-                j = d.createElement("a");
-                try {
-                    j.href = o.url, j.href = j.href, o.crossDomain = Lb.protocol + "//" + Lb.host != j.protocol + "//" + j.host
-                } catch (z) {
-                    o.crossDomain = !0
-                }
-            }
-            if (o.data && o.processData && "string" != typeof o.data && (o.data = r.param(o.data, o.traditional)), Nb(Ib, o, c, y), k) return y;
-            l = r.event && o.global, l && 0 === r.active++ && r.event.trigger("ajaxStart"), o.type = o.type.toUpperCase(), o.hasContent = !Gb.test(o.type), f = o.url.replace(Cb, ""), o.hasContent ? o.data && o.processData && 0 === (o.contentType || "").indexOf("application/x-www-form-urlencoded") && (o.data = o.data.replace(Bb, "+")) : (n = o.url.slice(f.length), o.data && (f += (vb.test(f) ? "&" : "?") + o.data, delete o.data), o.cache === !1 && (f = f.replace(Db, "$1"), n = (vb.test(f) ? "&" : "?") + "_=" + ub++ + n), o.url = f + n), o.ifModified && (r.lastModified[f] && y.setRequestHeader("If-Modified-Since", r.lastModified[f]), r.etag[f] && y.setRequestHeader("If-None-Match", r.etag[f])), (o.data && o.hasContent && o.contentType !== !1 || c.contentType) && y.setRequestHeader("Content-Type", o.contentType), y.setRequestHeader("Accept", o.dataTypes[0] && o.accepts[o.dataTypes[0]] ? o.accepts[o.dataTypes[0]] + ("*" !== o.dataTypes[0] ? ", " + Kb + "; q=0.01" : "") : o.accepts["*"]);
-            for (m in o.headers) y.setRequestHeader(m, o.headers[m]);
-            if (o.beforeSend && (o.beforeSend.call(p, y, o) === !1 || k)) return y.abort();
-            if (x = "abort", t.add(o.complete), y.done(o.success), y.fail(o.error), e = Nb(Jb, o, c, y)) {
-                if (y.readyState = 1, l && q.trigger("ajaxSend", [y, o]), k) return y;
-                o.async && o.timeout > 0 && (i = a.setTimeout(function() {
-                    y.abort("timeout")
-                }, o.timeout));
+            if (o.promise(v).complete = p.add, v.success = v.done, v.error = v.fail, k.url = ((a || k.url || Ac) + "").replace(Bc, "").replace(Gc, zc[1] + "//"), k.type = b.method || b.type || k.method || k.type, k.dataTypes = n.trim(k.dataType || "*").toLowerCase().match(F) || [""], null == k.crossDomain && (c = Hc.exec(k.url.toLowerCase()), k.crossDomain = !(!c || c[1] === zc[1] && c[2] === zc[2] && (c[3] || ("http:" === c[1] ? "80" : "443")) === (zc[3] || ("http:" === zc[1] ? "80" : "443")))), k.data && k.processData && "string" != typeof k.data && (k.data = n.param(k.data, k.traditional)), Nc(Ic, k, b, v), 2 === t) return v;
+            h = k.global, h && 0 === n.active++ && n.event.trigger("ajaxStart"), k.type = k.type.toUpperCase(), k.hasContent = !Fc.test(k.type), e = k.url, k.hasContent || (k.data && (e = k.url += (xc.test(e) ? "&" : "?") + k.data, delete k.data), k.cache === !1 && (k.url = Cc.test(e) ? e.replace(Cc, "$1_=" + wc++) : e + (xc.test(e) ? "&" : "?") + "_=" + wc++)), k.ifModified && (n.lastModified[e] && v.setRequestHeader("If-Modified-Since", n.lastModified[e]), n.etag[e] && v.setRequestHeader("If-None-Match", n.etag[e])), (k.data && k.hasContent && k.contentType !== !1 || b.contentType) && v.setRequestHeader("Content-Type", k.contentType), v.setRequestHeader("Accept", k.dataTypes[0] && k.accepts[k.dataTypes[0]] ? k.accepts[k.dataTypes[0]] + ("*" !== k.dataTypes[0] ? ", " + Kc + "; q=0.01" : "") : k.accepts["*"]);
+            for (d in k.headers) v.setRequestHeader(d, k.headers[d]);
+            if (k.beforeSend && (k.beforeSend.call(l, v, k) === !1 || 2 === t)) return v.abort();
+            u = "abort";
+            for (d in {
+                    success: 1,
+                    error: 1,
+                    complete: 1
+                }) v[d](k[d]);
+            if (i = Nc(Jc, k, b, v)) {
+                v.readyState = 1, h && m.trigger("ajaxSend", [v, k]), k.async && k.timeout > 0 && (g = setTimeout(function() {
+                    v.abort("timeout")
+                }, k.timeout));
                 try {
-                    k = !1, e.send(v, A)
-                } catch (z) {
-                    if (k) throw z;
-                    A(-1, z)
-                }
-            } else A(-1, "No Transport");
-
-            function A(b, c, d, h) {
-                var j, m, n, v, w, x = c;
-                k || (k = !0, i && a.clearTimeout(i), e = void 0, g = h || "", y.readyState = b > 0 ? 4 : 0, j = b >= 200 && b < 300 || 304 === b, d && (v = Pb(o, y, d)), v = Qb(o, v, y, j), j ? (o.ifModified && (w = y.getResponseHeader("Last-Modified"), w && (r.lastModified[f] = w), w = y.getResponseHeader("etag"), w && (r.etag[f] = w)), 204 === b || "HEAD" === o.type ? x = "nocontent" : 304 === b ? x = "notmodified" : (x = v.state, m = v.data, n = v.error, j = !n)) : (n = x, !b && x || (x = "error", b < 0 && (b = 0))), y.status = b, y.statusText = (c || x) + "", j ? s.resolveWith(p, [m, x, y]) : s.rejectWith(p, [y, x, n]), y.statusCode(u), u = void 0, l && q.trigger(j ? "ajaxSuccess" : "ajaxError", [y, o, j ? m : n]), t.fireWith(p, [y, x]), l && (q.trigger("ajaxComplete", [y, o]), --r.active || r.event.trigger("ajaxStop")))
+                    t = 1, i.send(r, x)
+                } catch (w) {
+                    if (!(2 > t)) throw w;
+                    x(-1, w)
+                }
+            } else x(-1, "No Transport");
+
+            function x(a, b, c, d) {
+                var j, r, s, u, w, x = b;
+                2 !== t && (t = 2, g && clearTimeout(g), i = void 0, f = d || "", v.readyState = a > 0 ? 4 : 0, j = a >= 200 && 300 > a || 304 === a, c && (u = Pc(k, v, c)), u = Qc(k, u, v, j), j ? (k.ifModified && (w = v.getResponseHeader("Last-Modified"), w && (n.lastModified[e] = w), w = v.getResponseHeader("etag"), w && (n.etag[e] = w)), 204 === a || "HEAD" === k.type ? x = "nocontent" : 304 === a ? x = "notmodified" : (x = u.state, r = u.data, s = u.error, j = !s)) : (s = x, (a || !x) && (x = "error", 0 > a && (a = 0))), v.status = a, v.statusText = (b || x) + "", j ? o.resolveWith(l, [r, x, v]) : o.rejectWith(l, [v, x, s]), v.statusCode(q), q = void 0, h && m.trigger(j ? "ajaxSuccess" : "ajaxError", [v, k, j ? r : s]), p.fireWith(l, [v, x]), h && (m.trigger("ajaxComplete", [v, k]), --n.active || n.event.trigger("ajaxStop")))
             }
-            return y
+            return v
         },
         getJSON: function(a, b, c) {
-            return r.get(a, b, c, "json")
+            return n.get(a, b, c, "json")
         },
         getScript: function(a, b) {
-            return r.get(a, void 0, b, "script")
+            return n.get(a, void 0, b, "script")
         }
-    }), r.each(["get", "post"], function(a, b) {
-        r[b] = function(a, c, d, e) {
-            return r.isFunction(c) && (e = e || d, d = c, c = void 0), r.ajax(r.extend({
+    }), n.each(["get", "post"], function(a, b) {
+        n[b] = function(a, c, d, e) {
+            return n.isFunction(c) && (e = e || d, d = c, c = void 0), n.ajax({
                 url: a,
                 type: b,
                 dataType: e,
                 data: c,
                 success: d
-            }, r.isPlainObject(a) && a))
+            })
         }
-    }), r._evalUrl = function(a) {
-        return r.ajax({
+    }), n.each(["ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend"], function(a, b) {
+        n.fn[b] = function(a) {
+            return this.on(b, a)
+        }
+    }), n._evalUrl = function(a) {
+        return n.ajax({
             url: a,
             type: "GET",
             dataType: "script",
-            cache: !0,
             async: !1,
             global: !1,
             "throws": !0
         })
-    }, r.fn.extend({
+    }, n.fn.extend({
         wrapAll: function(a) {
-            var b;
-            return this[0] && (r.isFunction(a) && (a = a.call(this[0])), b = r(a, this[0].ownerDocument).eq(0).clone(!0), this[0].parentNode && b.insertBefore(this[0]), b.map(function() {
-                var a = this;
-                while (a.firstElementChild) a = a.firstElementChild;
-                return a
-            }).append(this)), this
+            if (n.isFunction(a)) return this.each(function(b) {
+                n(this).wrapAll(a.call(this, b))
+            });
+            if (this[0]) {
+                var b = n(a, this[0].ownerDocument).eq(0).clone(!0);
+                this[0].parentNode && b.insertBefore(this[0]), b.map(function() {
+                    var a = this;
+                    while (a.firstChild && 1 === a.firstChild.nodeType) a = a.firstChild;
+                    return a
+                }).append(this)
+            }
+            return this
         },
         wrapInner: function(a) {
-            return r.isFunction(a) ? this.each(function(b) {
-                r(this).wrapInner(a.call(this, b))
-            }) : this.each(function() {
-                var b = r(this),
+            return this.each(n.isFunction(a) ? function(b) {
+                n(this).wrapInner(a.call(this, b))
+            } : function() {
+                var b = n(this),
                     c = b.contents();
                 c.length ? c.wrapAll(a) : b.append(a)
             })
         },
         wrap: function(a) {
-            var b = r.isFunction(a);
+            var b = n.isFunction(a);
             return this.each(function(c) {
-                r(this).wrapAll(b ? a.call(this, c) : a)
+                n(this).wrapAll(b ? a.call(this, c) : a)
             })
         },
-        unwrap: function(a) {
-            return this.parent(a).not("body").each(function() {
-                r(this).replaceWith(this.childNodes)
-            }), this
-        }
-    }), r.expr.pseudos.hidden = function(a) {
-        return !r.expr.pseudos.visible(a)
-    }, r.expr.pseudos.visible = function(a) {
-        return !!(a.offsetWidth || a.offsetHeight || a.getClientRects().length)
-    }, r.ajaxSettings.xhr = function() {
-        try {
-            return new a.XMLHttpRequest
-        } catch (b) {}
+        unwrap: function() {
+            return this.parent().each(function() {
+                n.nodeName(this, "body") || n(this).replaceWith(this.childNodes)
+            }).end()
+        }
+    }), n.expr.filters.hidden = function(a) {
+        return a.offsetWidth <= 0 && a.offsetHeight <= 0 || !l.reliableHiddenOffsets() && "none" === (a.style && a.style.display || n.css(a, "display"))
+    }, n.expr.filters.visible = function(a) {
+        return !n.expr.filters.hidden(a)
     };
-    var Rb = {
-            0: 200,
-            1223: 204
+    var Rc = /%20/g,
+        Sc = /\[\]$/,
+        Tc = /\r?\n/g,
+        Uc = /^(?:submit|button|image|reset|file)$/i,
+        Vc = /^(?:input|select|textarea|keygen)/i;
+
+    function Wc(a, b, c, d) {
+        var e;
+        if (n.isArray(b)) n.each(b, function(b, e) {
+            c || Sc.test(a) ? d(a, e) : Wc(a + "[" + ("object" == typeof e ? b : "") + "]", e, c, d)
+        });
+        else if (c || "object" !== n.type(b)) d(a, b);
+        else
+            for (e in b) Wc(a + "[" + e + "]", b[e], c, d)
+    }
+    n.param = function(a, b) {
+        var c, d = [],
+            e = function(a, b) {
+                b = n.isFunction(b) ? b() : null == b ? "" : b, d[d.length] = encodeURIComponent(a) + "=" + encodeURIComponent(b)
+            };
+        if (void 0 === b && (b = n.ajaxSettings && n.ajaxSettings.traditional), n.isArray(a) || a.jquery && !n.isPlainObject(a)) n.each(a, function() {
+            e(this.name, this.value)
+        });
+        else
+            for (c in a) Wc(c, a[c], b, e);
+        return d.join("&").replace(Rc, "+")
+    }, n.fn.extend({
+        serialize: function() {
+            return n.param(this.serializeArray())
         },
-        Sb = r.ajaxSettings.xhr();
-    o.cors = !!Sb && "withCredentials" in Sb, o.ajax = Sb = !!Sb, r.ajaxTransport(function(b) {
-        var c, d;
-        if (o.cors || Sb && !b.crossDomain) return {
-            send: function(e, f) {
-                var g, h = b.xhr();
-                if (h.open(b.type, b.url, b.async, b.username, b.password), b.xhrFields)
-                    for (g in b.xhrFields) h[g] = b.xhrFields[g];
-                b.mimeType && h.overrideMimeType && h.overrideMimeType(b.mimeType), b.crossDomain || e["X-Requested-With"] || (e["X-Requested-With"] = "XMLHttpRequest");
-                for (g in e) h.setRequestHeader(g, e[g]);
-                c = function(a) {
-                    return function() {
-                        c && (c = d = h.onload = h.onerror = h.onabort = h.onreadystatechange = null, "abort" === a ? h.abort() : "error" === a ? "number" != typeof h.status ? f(0, "error") : f(h.status, h.statusText) : f(Rb[h.status] || h.status, h.statusText, "text" !== (h.responseType || "text") || "string" != typeof h.responseText ? {
-                            binary: h.response
-                        } : {
-                            text: h.responseText
-                        }, h.getAllResponseHeaders()))
-                    }
-                }, h.onload = c(), d = h.onerror = c("error"), void 0 !== h.onabort ? h.onabort = d : h.onreadystatechange = function() {
-                    4 === h.readyState && a.setTimeout(function() {
-                        c && d()
-                    })
-                }, c = c("abort");
-                try {
-                    h.send(b.hasContent && b.data || null)
-                } catch (i) {
-                    if (c) throw i
+        serializeArray: function() {
+            return this.map(function() {
+                var a = n.prop(this, "elements");
+                return a ? n.makeArray(a) : this
+            }).filter(function() {
+                var a = this.type;
+                return this.name && !n(this).is(":disabled") && Vc.test(this.nodeName) && !Uc.test(a) && (this.checked || !X.test(a))
+            }).map(function(a, b) {
+                var c = n(this).val();
+                return null == c ? null : n.isArray(c) ? n.map(c, function(a) {
+                    return {
+                        name: b.name,
+                        value: a.replace(Tc, "\r\n")
+                    }
+                }) : {
+                    name: b.name,
+                    value: c.replace(Tc, "\r\n")
+                }
+            }).get()
+        }
+    }), n.ajaxSettings.xhr = void 0 !== a.ActiveXObject ? function() {
+        return !this.isLocal && /^(get|post|head|put|delete|options)$/i.test(this.type) && $c() || _c()
+    } : $c;
+    var Xc = 0,
+        Yc = {},
+        Zc = n.ajaxSettings.xhr();
+    a.ActiveXObject && n(a).on("unload", function() {
+        for (var a in Yc) Yc[a](void 0, !0)
+    }), l.cors = !!Zc && "withCredentials" in Zc, Zc = l.ajax = !!Zc, Zc && n.ajaxTransport(function(a) {
+        if (!a.crossDomain || l.cors) {
+            var b;
+            return {
+                send: function(c, d) {
+                    var e, f = a.xhr(),
+                        g = ++Xc;
+                    if (f.open(a.type, a.url, a.async, a.username, a.password), a.xhrFields)
+                        for (e in a.xhrFields) f[e] = a.xhrFields[e];
+                    a.mimeType && f.overrideMimeType && f.overrideMimeType(a.mimeType), a.crossDomain || c["X-Requested-With"] || (c["X-Requested-With"] = "XMLHttpRequest");
+                    for (e in c) void 0 !== c[e] && f.setRequestHeader(e, c[e] + "");
+                    f.send(a.hasContent && a.data || null), b = function(c, e) {
+                        var h, i, j;
+                        if (b && (e || 4 === f.readyState))
+                            if (delete Yc[g], b = void 0, f.onreadystatechange = n.noop, e) 4 !== f.readyState && f.abort();
+                            else {
+                                j = {}, h = f.status, "string" == typeof f.responseText && (j.text = f.responseText);
+                                try {
+                                    i = f.statusText
+                                } catch (k) {
+                                    i = ""
+                                }
+                                h || !a.isLocal || a.crossDomain ? 1223 === h && (h = 204) : h = j.text ? 200 : 404
+                            } j && d(h, i, j, f.getAllResponseHeaders())
+                    }, a.async ? 4 === f.readyState ? setTimeout(b) : f.onreadystatechange = Yc[g] = b : b()
+                },
+                abort: function() {
+                    b && b(void 0, !0)
                 }
-            },
-            abort: function() {
-                c && c()
             }
         }
-    }), r.ajaxPrefilter(function(a) {
-        a.crossDomain && (a.contents.script = !1)
-    }), r.ajaxSetup({
+    });
+
+    function $c() {
+        try {
+            return new a.XMLHttpRequest
+        } catch (b) {}
+    }
+
+    function _c() {
+        try {
+            return new a.ActiveXObject("Microsoft.XMLHTTP")
+        } catch (b) {}
+    }
+    n.ajaxSetup({
         accepts: {
             script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"
         },
         contents: {
-            script: /\b(?:java|ecma)script\b/
+            script: /(?:java|ecma)script/
         },
         converters: {
             "text script": function(a) {
-                return r.globalEval(a), a
+                return n.globalEval(a), a
             }
         }
-    }), r.ajaxPrefilter("script", function(a) {
-        void 0 === a.cache && (a.cache = !1), a.crossDomain && (a.type = "GET")
-    }), r.ajaxTransport("script", function(a) {
+    }), n.ajaxPrefilter("script", function(a) {
+        void 0 === a.cache && (a.cache = !1), a.crossDomain && (a.type = "GET", a.global = !1)
+    }), n.ajaxTransport("script", function(a) {
         if (a.crossDomain) {
-            var b, c;
+            var b, c = z.head || n("head")[0] || z.documentElement;
             return {
-                send: function(e, f) {
-                    b = r("<script>").prop({
-                        charset: a.scriptCharset,
-                        src: a.url
-                    }).on("load error", c = function(a) {
-                        b.remove(), c = null, a && f("error" === a.type ? 404 : 200, a.type)
-                    }), d.head.appendChild(b[0])
+                send: function(d, e) {
+                    b = z.createElement("script"), b.async = !0, a.scriptCharset && (b.charset = a.scriptCharset), b.src = a.url, b.onload = b.onreadystatechange = function(a, c) {
+                        (c || !b.readyState || /loaded|complete/.test(b.readyState)) && (b.onload = b.onreadystatechange = null, b.parentNode && b.parentNode.removeChild(b), b = null, c || e(200, "success"))
+                    }, c.insertBefore(b, c.firstChild)
                 },
                 abort: function() {
-                    c && c()
+                    b && b.onload(void 0, !0)
                 }
             }
         }
     });
-    var Tb = [],
-        Ub = /(=)\?(?=&|$)|\?\?/;
-    r.ajaxSetup({
+    var ad = [],
+        bd = /(=)\?(?=&|$)|\?\?/;
+    n.ajaxSetup({
         jsonp: "callback",
         jsonpCallback: function() {
-            var a = Tb.pop() || r.expando + "_" + ub++;
+            var a = ad.pop() || n.expando + "_" + wc++;
             return this[a] = !0, a
         }
-    }), r.ajaxPrefilter("json jsonp", function(b, c, d) {
-        var e, f, g, h = b.jsonp !== !1 && (Ub.test(b.url) ? "url" : "string" == typeof b.data && 0 === (b.contentType || "").indexOf("application/x-www-form-urlencoded") && Ub.test(b.data) && "data");
-        if (h || "jsonp" === b.dataTypes[0]) return e = b.jsonpCallback = r.isFunction(b.jsonpCallback) ? b.jsonpCallback() : b.jsonpCallback, h ? b[h] = b[h].replace(Ub, "$1" + e) : b.jsonp !== !1 && (b.url += (vb.test(b.url) ? "&" : "?") + b.jsonp + "=" + e), b.converters["script json"] = function() {
-            return g || r.error(e + " was not called"), g[0]
+    }), n.ajaxPrefilter("json jsonp", function(b, c, d) {
+        var e, f, g, h = b.jsonp !== !1 && (bd.test(b.url) ? "url" : "string" == typeof b.data && !(b.contentType || "").indexOf("application/x-www-form-urlencoded") && bd.test(b.data) && "data");
+        return h || "jsonp" === b.dataTypes[0] ? (e = b.jsonpCallback = n.isFunction(b.jsonpCallback) ? b.jsonpCallback() : b.jsonpCallback, h ? b[h] = b[h].replace(bd, "$1" + e) : b.jsonp !== !1 && (b.url += (xc.test(b.url) ? "&" : "?") + b.jsonp + "=" + e), b.converters["script json"] = function() {
+            return g || n.error(e + " was not called"), g[0]
         }, b.dataTypes[0] = "json", f = a[e], a[e] = function() {
             g = arguments
         }, d.always(function() {
-            void 0 === f ? r(a).removeProp(e) : a[e] = f, b[e] && (b.jsonpCallback = c.jsonpCallback, Tb.push(e)), g && r.isFunction(f) && f(g[0]), g = f = void 0
-        }), "script"
-    }), o.createHTMLDocument = function() {
-        var a = d.implementation.createHTMLDocument("").body;
-        return a.innerHTML = "<form></form><form></form>", 2 === a.childNodes.length
-    }(), r.parseHTML = function(a, b, c) {
-        if ("string" != typeof a) return [];
-        "boolean" == typeof b && (c = b, b = !1);
-        var e, f, g;
-        return b || (o.createHTMLDocument ? (b = d.implementation.createHTMLDocument(""), e = b.createElement("base"), e.href = d.location.href, b.head.appendChild(e)) : b = d), f = C.exec(a), g = !c && [], f ? [b.createElement(f[1])] : (f = qa([a], b, g), g && g.length && r(g).remove(), r.merge([], f.childNodes))
-    }, r.fn.load = function(a, b, c) {
+            a[e] = f, b[e] && (b.jsonpCallback = c.jsonpCallback, ad.push(e)), g && n.isFunction(f) && f(g[0]), g = f = void 0
+        }), "script") : void 0
+    }), n.parseHTML = function(a, b, c) {
+        if (!a || "string" != typeof a) return null;
+        "boolean" == typeof b && (c = b, b = !1), b = b || z;
+        var d = v.exec(a),
+            e = !c && [];
+        return d ? [b.createElement(d[1])] : (d = n.buildFragment([a], b, e), e && e.length && n(e).remove(), n.merge([], d.childNodes))
+    };
+    var cd = n.fn.load;
+    n.fn.load = function(a, b, c) {
+        if ("string" != typeof a && cd) return cd.apply(this, arguments);
         var d, e, f, g = this,
             h = a.indexOf(" ");
-        return h > -1 && (d = pb(a.slice(h)), a = a.slice(0, h)), r.isFunction(b) ? (c = b, b = void 0) : b && "object" == typeof b && (e = "POST"), g.length > 0 && r.ajax({
+        return h >= 0 && (d = a.slice(h, a.length), a = a.slice(0, h)), n.isFunction(b) ? (c = b, b = void 0) : b && "object" == typeof b && (f = "POST"), g.length > 0 && n.ajax({
             url: a,
-            type: e || "GET",
+            type: f,
             dataType: "html",
             data: b
         }).done(function(a) {
-            f = arguments, g.html(d ? r("<div>").append(r.parseHTML(a)).find(d) : a)
-        }).always(c && function(a, b) {
-            g.each(function() {
-                c.apply(this, f || [a.responseText, b, a])
-            })
+            e = arguments, g.html(d ? n("<div>").append(n.parseHTML(a)).find(d) : a)
+        }).complete(c && function(a, b) {
+            g.each(c, e || [a.responseText, b, a])
         }), this
-    }, r.each(["ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend"], function(a, b) {
-        r.fn[b] = function(a) {
-            return this.on(b, a)
-        }
-    }), r.expr.pseudos.animated = function(a) {
-        return r.grep(r.timers, function(b) {
+    }, n.expr.filters.animated = function(a) {
+        return n.grep(n.timers, function(b) {
             return a === b.elem
         }).length
-    }, r.offset = {
+    };
+    var dd = a.document.documentElement;
+
+    function ed(a) {
+        return n.isWindow(a) ? a : 9 === a.nodeType ? a.defaultView || a.parentWindow : !1
+    }
+    n.offset = {
         setOffset: function(a, b, c) {
-            var d, e, f, g, h, i, j, k = r.css(a, "position"),
-                l = r(a),
+            var d, e, f, g, h, i, j, k = n.css(a, "position"),
+                l = n(a),
                 m = {};
-            "static" === k && (a.style.position = "relative"), h = l.offset(), f = r.css(a, "top"), i = r.css(a, "left"), j = ("absolute" === k || "fixed" === k) && (f + i).indexOf("auto") > -1, j ? (d = l.position(), g = d.top, e = d.left) : (g = parseFloat(f) || 0, e = parseFloat(i) || 0), r.isFunction(b) && (b = b.call(a, c, r.extend({}, h))), null != b.top && (m.top = b.top - h.top + g), null != b.left && (m.left = b.left - h.left + e), "using" in b ? b.using.call(a, m) : l.css(m)
+            "static" === k && (a.style.position = "relative"), h = l.offset(), f = n.css(a, "top"), i = n.css(a, "left"), j = ("absolute" === k || "fixed" === k) && n.inArray("auto", [f, i]) > -1, j ? (d = l.position(), g = d.top, e = d.left) : (g = parseFloat(f) || 0, e = parseFloat(i) || 0), n.isFunction(b) && (b = b.call(a, c, h)), null != b.top && (m.top = b.top - h.top + g), null != b.left && (m.left = b.left - h.left + e), "using" in b ? b.using.call(a, m) : l.css(m)
         }
-    }, r.fn.extend({
+    }, n.fn.extend({
         offset: function(a) {
             if (arguments.length) return void 0 === a ? this : this.each(function(b) {
-                r.offset.setOffset(this, a, b)
+                n.offset.setOffset(this, a, b)
             });
-            var b, c, d, e, f = this[0];
-            if (f) return f.getClientRects().length ? (d = f.getBoundingClientRect(), b = f.ownerDocument, c = b.documentElement, e = b.defaultView, {
-                top: d.top + e.pageYOffset - c.clientTop,
-                left: d.left + e.pageXOffset - c.clientLeft
-            }) : {
-                top: 0,
-                left: 0
-            }
+            var b, c, d = {
+                    top: 0,
+                    left: 0
+                },
+                e = this[0],
+                f = e && e.ownerDocument;
+            if (f) return b = f.documentElement, n.contains(b, e) ? (typeof e.getBoundingClientRect !== L && (d = e.getBoundingClientRect()), c = ed(f), {
+                top: d.top + (c.pageYOffset || b.scrollTop) - (b.clientTop || 0),
+                left: d.left + (c.pageXOffset || b.scrollLeft) - (b.clientLeft || 0)
+            }) : d
         },
         position: function() {
             if (this[0]) {
-                var a, b, c = this[0],
-                    d = {
+                var a, b, c = {
                         top: 0,
                         left: 0
-                    };
-                return "fixed" === r.css(c, "position") ? b = c.getBoundingClientRect() : (a = this.offsetParent(), b = this.offset(), B(a[0], "html") || (d = a.offset()), d = {
-                    top: d.top + r.css(a[0], "borderTopWidth", !0),
-                    left: d.left + r.css(a[0], "borderLeftWidth", !0)
-                }), {
-                    top: b.top - d.top - r.css(c, "marginTop", !0),
-                    left: b.left - d.left - r.css(c, "marginLeft", !0)
+                    },
+                    d = this[0];
+                return "fixed" === n.css(d, "position") ? b = d.getBoundingClientRect() : (a = this.offsetParent(), b = this.offset(), n.nodeName(a[0], "html") || (c = a.offset()), c.top += n.css(a[0], "borderTopWidth", !0), c.left += n.css(a[0], "borderLeftWidth", !0)), {
+                    top: b.top - c.top - n.css(d, "marginTop", !0),
+                    left: b.left - c.left - n.css(d, "marginLeft", !0)
                 }
             }
         },
         offsetParent: function() {
             return this.map(function() {
-                var a = this.offsetParent;
-                while (a && "static" === r.css(a, "position")) a = a.offsetParent;
-                return a || ra
+                var a = this.offsetParent || dd;
+                while (a && !n.nodeName(a, "html") && "static" === n.css(a, "position")) a = a.offsetParent;
+                return a || dd
             })
         }
-    }), r.each({
+    }), n.each({
         scrollLeft: "pageXOffset",
         scrollTop: "pageYOffset"
     }, function(a, b) {
-        var c = "pageYOffset" === b;
-        r.fn[a] = function(d) {
-            return T(this, function(a, d, e) {
-                var f;
-                return r.isWindow(a) ? f = a : 9 === a.nodeType && (f = a.defaultView), void 0 === e ? f ? f[b] : a[d] : void(f ? f.scrollTo(c ? f.pageXOffset : e, c ? e : f.pageYOffset) : a[d] = e)
-            }, a, d, arguments.length)
-        }
-    }), r.each(["top", "left"], function(a, b) {
-        r.cssHooks[b] = Pa(o.pixelPosition, function(a, c) {
-            if (c) return c = Oa(a, b), Ma.test(c) ? r(a).position()[b] + "px" : c
+        var c = /Y/.test(b);
+        n.fn[a] = function(d) {
+            return W(this, function(a, d, e) {
+                var f = ed(a);
+                return void 0 === e ? f ? b in f ? f[b] : f.document.documentElement[d] : a[d] : void(f ? f.scrollTo(c ? n(f).scrollLeft() : e, c ? e : n(f).scrollTop()) : a[d] = e)
+            }, a, d, arguments.length, null)
+        }
+    }), n.each(["top", "left"], function(a, b) {
+        n.cssHooks[b] = Mb(l.pixelPosition, function(a, c) {
+            return c ? (c = Kb(a, b), Ib.test(c) ? n(a).position()[b] + "px" : c) : void 0
         })
-    }), r.each({
+    }), n.each({
         Height: "height",
         Width: "width"
     }, function(a, b) {
-        r.each({
+        n.each({
             padding: "inner" + a,
             content: b,
             "": "outer" + a
         }, function(c, d) {
-            r.fn[d] = function(e, f) {
-                var g = arguments.length && (c || "boolean" != typeof e),
-                    h = c || (e === !0 || f === !0 ? "margin" : "border");
-                return T(this, function(b, c, e) {
-                    var f;
-                    return r.isWindow(b) ? 0 === d.indexOf("outer") ? b["inner" + a] : b.document.documentElement["client" + a] : 9 === b.nodeType ? (f = b.documentElement, Math.max(b.body["scroll" + a], f["scroll" + a], b.body["offset" + a], f["offset" + a], f["client" + a])) : void 0 === e ? r.css(b, c, h) : r.style(b, c, e, h)
-                }, b, g ? e : void 0, g)
+            n.fn[d] = function(d, e) {
+                var f = arguments.length && (c || "boolean" != typeof d),
+                    g = c || (d === !0 || e === !0 ? "margin" : "border");
+                return W(this, function(b, c, d) {
+                    var e;
+                    return n.isWindow(b) ? b.document.documentElement["client" + a] : 9 === b.nodeType ? (e = b.documentElement, Math.max(b.body["scroll" + a], e["scroll" + a], b.body["offset" + a], e["offset" + a], e["client" + a])) : void 0 === d ? n.css(b, c, g) : n.style(b, c, d, g)
+                }, b, f ? d : void 0, f, null)
             }
         })
-    }), r.fn.extend({
-        bind: function(a, b, c) {
-            return this.on(a, null, b, c)
-        },
-        unbind: function(a, b) {
-            return this.off(a, null, b)
-        },
-        delegate: function(a, b, c, d) {
-            return this.on(b, a, c, d)
-        },
-        undelegate: function(a, b, c) {
-            return 1 === arguments.length ? this.off(a, "**") : this.off(b, a || "**", c)
-        }
-    }), r.holdReady = function(a) {
-        a ? r.readyWait++ : r.ready(!0)
-    }, r.isArray = Array.isArray, r.parseJSON = JSON.parse, r.nodeName = B, "function" == typeof define && define.amd && define("jquery", [], function() {
-        return r
+    }), n.fn.size = function() {
+        return this.length
+    }, n.fn.andSelf = n.fn.addBack, "function" == typeof define && define.amd && define("jquery", [], function() {
+        return n
     });
-    var Vb = a.jQuery,
-        Wb = a.$;
-    return r.noConflict = function(b) {
-        return a.$ === r && (a.$ = Wb), b && a.jQuery === r && (a.jQuery = Vb), r
-    }, b || (a.jQuery = a.$ = r), r
+    var fd = a.jQuery,
+        gd = a.$;
+    return n.noConflict = function(b) {
+        return a.$ === n && (a.$ = gd), b && a.jQuery === n && (a.jQuery = fd), n
+    }, typeof b === L && (a.jQuery = a.$ = n), n
 });
```

### Comparing `peewee-3.9.5/docs/_build/html/_static/peewee-white.png` & `peewee-3.9.6/docs/_static/peewee-white.png`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_build/html/_sources/peewee/query_builder.rst.txt` & `peewee-3.9.6/docs/peewee/query_builder.rst`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_build/html/_sources/peewee/models.rst.txt` & `peewee-3.9.6/docs/peewee/models.rst`

 * *Files 0% similar despite different names*

```diff
@@ -739,19 +739,19 @@
 The :py:class:`ModelOptions` class implements several methods which may be of
 use for retrieving model metadata (such as lists of fields, foreign key
 relationships, and more).
 
 .. code-block:: pycon
 
     >>> Person._meta.fields
-    {'id': <peewee.PrimaryKeyField object at 0x7f51a2e92750>,
+    {'id': <peewee.AutoField object at 0x7f51a2e92750>,
      'name': <peewee.CharField object at 0x7f51a2f0a510>}
 
     >>> Person._meta.primary_key
-    <peewee.PrimaryKeyField object at 0x7f51a2e92750>
+    <peewee.AutoField object at 0x7f51a2e92750>
 
     >>> Person._meta.database
     <peewee.SqliteDatabase object at 0x7f519bff6dd0>
 
 There are several options you can specify as ``Meta`` attributes. While most
 options are inheritable, some are table-specific and will not be inherited by
 subclasses.
@@ -1212,15 +1212,15 @@
 
     data = load_user_csv()
     fields = [User.id, User.username]
     with db.atomic():
         User.insert_many(data, fields=fields).execute()
 
 If you *always* want to have control over the primary key, simply do not use
-the :py:class:`PrimaryKeyField` field type, but use a normal
+the :py:class:`AutoField` field type, but use a normal
 :py:class:`IntegerField` (or other column type):
 
 .. code-block:: python
 
     class User(BaseModel):
         id = IntegerField(primary_key=True)
         username = CharField()
```

### Comparing `peewee-3.9.5/docs/_build/html/_sources/peewee/query_operators.rst.txt` & `peewee-3.9.6/docs/peewee/query_operators.rst`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_build/html/_sources/peewee/querying.rst.txt` & `peewee-3.9.6/docs/peewee/querying.rst`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_build/html/_sources/peewee/playhouse.rst.txt` & `peewee-3.9.6/docs/peewee/playhouse.rst`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_build/html/_sources/peewee/relationships.rst.txt` & `peewee-3.9.6/docs/peewee/relationships.rst`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_build/html/_sources/peewee/changes.rst.txt` & `peewee-3.9.6/docs/peewee/changes.rst`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_build/html/_sources/peewee/api.rst.txt` & `peewee-3.9.6/docs/peewee/api.rst`

 * *Files 1% similar despite different names*

```diff
@@ -238,14 +238,47 @@
                         raise
 
         The above code is equivalent to the following::
 
             with db.atomic():
                 user.delete_instance(recursive=True)
 
+    .. py:method:: session_start()
+
+        Begin a new transaction (without using a context-manager or decorator).
+        This method is useful if you intend to execute a sequence of operations
+        inside a transaction, but using a decorator or context-manager would
+        not be appropriate.
+
+        .. note::
+            It is strongly advised that you use the :py:meth:`Database.atomic`
+            method whenever possible for managing transactions/savepoints. The
+            ``atomic`` method correctly manages nesting, uses the appropriate
+            construction (e.g., transaction-vs-savepoint), and always cleans up
+            after itself.
+
+            The :py:meth:`~Database.session_start` method should only be used
+            if the sequence of operations does not easily lend itself to
+            wrapping using either a context-manager or decorator.
+
+        .. warning::
+            You must *always* call either :py:meth:`~Database.session_commit`
+            or :py:meth:`~Database.session_rollback` after calling the
+            ``session_start`` method.
+
+    .. py:method:: session_commit()
+
+        Commit any changes made during a transaction begun with
+        :py:meth:`~Database.session_start`.
+
+    .. py:method:: session_rollback()
+
+        Roll back any changes made during a transaction begun with
+        :py:meth:`~Database.session_start`.
+
     .. py:method:: transaction()
 
         Create a context-manager that runs all queries in the wrapped block in
         a transaction.
 
         .. warning::
             Calls to ``transaction`` cannot be nested. Only the top-most call
@@ -878,14 +911,22 @@
     Postgresql database implementation.
 
     Additional optional keyword-parameters:
 
     :param bool register_unicode: Register unicode types.
     :param str encoding: Database encoding.
 
+    .. py:method:: set_time_zone(timezone)
+
+        :param str timezone: timezone name, e.g. "US/Central".
+        :returns: no return value.
+
+        Set the timezone on the current connection. If no connection is open,
+        then one will be opened.
+
 
 .. py:class:: MySQLDatabase(database[, **kwargs])
 
     MySQL database implementation.
 
 .. _query-builder-api:
```

### Comparing `peewee-3.9.5/docs/_build/html/_sources/peewee/sqlite_ext.rst.txt` & `peewee-3.9.6/docs/peewee/sqlite_ext.rst`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_build/html/_sources/peewee/example.rst.txt` & `peewee-3.9.6/docs/peewee/example.rst`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_build/html/_sources/peewee/contributing.rst.txt` & `peewee-3.9.6/docs/peewee/contributing.rst`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_build/html/_sources/peewee/installation.rst.txt` & `peewee-3.9.6/docs/peewee/installation.rst`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_build/html/_sources/peewee/database.rst.txt` & `peewee-3.9.6/docs/peewee/database.rst`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_build/html/_sources/peewee/interactive.rst.txt` & `peewee-3.9.6/docs/peewee/interactive.rst`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_build/html/_sources/peewee/quickstart.rst.txt` & `peewee-3.9.6/docs/peewee/quickstart.rst`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_build/html/_sources/peewee/query_examples.rst.txt` & `peewee-3.9.6/docs/peewee/query_examples.rst`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_build/html/_sources/peewee/hacks.rst.txt` & `peewee-3.9.6/docs/peewee/hacks.rst`

 * *Files 0% similar despite different names*

```diff
@@ -438,15 +438,15 @@
     # whether the current time (now) is 12:00:15 or later.
     now >= task.last_run + schedule.interval
 
 So we can write the following code:
 
 .. code-block:: python
 
-    next_occurrence = ???
+    next_occurrence = something  # ??? how do we define this ???
 
     # We can express the current time as a Python datetime value, or we could
     # alternatively use the appropriate SQL function/name.
     now = Value(datetime.datetime.now())  # Or SQL('current_timestamp'), e.g.
 
     query = (Task
              .select(Task, Schedule)
```

### Comparing `peewee-3.9.5/docs/_build/html/_images/schema-horizontal.png` & `peewee-3.9.6/docs/peewee/schema-horizontal.png`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_build/html/_images/tweepee.jpg` & `peewee-3.9.6/docs/peewee/tweepee.jpg`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_build/html/_images/schema.jpg` & `peewee-3.9.6/docs/peewee/schema.jpg`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_build/html/_images/sqlite.png` & `peewee-3.9.6/docs/sqlite.png`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/_build/html/_images/postgresql.png` & `peewee-3.9.6/docs/postgresql.png`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/peewee-logo.png` & `peewee-3.9.6/docs/peewee-logo.png`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/docs/conf.py` & `peewee-3.9.6/docs/conf.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/examples/diary.py` & `peewee-3.9.6/examples/diary.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/examples/graph.py` & `peewee-3.9.6/examples/graph.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/examples/analytics/app.py` & `peewee-3.9.6/examples/analytics/app.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/examples/analytics/reports.py` & `peewee-3.9.6/examples/analytics/reports.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/examples/blog/templates/base.html` & `peewee-3.9.6/examples/blog/templates/base.html`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/examples/blog/templates/create.html` & `peewee-3.9.6/examples/blog/templates/create.html`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/examples/blog/templates/index.html` & `peewee-3.9.6/examples/blog/templates/index.html`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/examples/blog/templates/includes/pagination.html` & `peewee-3.9.6/examples/blog/templates/includes/pagination.html`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/examples/blog/templates/login.html` & `peewee-3.9.6/examples/blog/templates/login.html`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/examples/blog/app.py` & `peewee-3.9.6/examples/blog/app.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/examples/blog/static/css/hilite.css` & `peewee-3.9.6/examples/blog/static/css/hilite.css`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/examples/blog/static/css/blog.min.css` & `peewee-3.9.6/examples/blog/static/css/blog.min.css`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/examples/blog/static/js/bootstrap.min.js` & `peewee-3.9.6/examples/blog/static/js/bootstrap.min.js`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/examples/blog/static/fonts/glyphicons-halflings-regular.eot` & `peewee-3.9.6/examples/blog/static/fonts/glyphicons-halflings-regular.eot`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/examples/blog/static/fonts/glyphicons-halflings-regular.ttf` & `peewee-3.9.6/examples/blog/static/fonts/glyphicons-halflings-regular.ttf`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/examples/blog/static/fonts/glyphicons-halflings-regular.svg` & `peewee-3.9.6/examples/blog/static/fonts/glyphicons-halflings-regular.svg`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/examples/blog/static/fonts/glyphicons-halflings-regular.woff` & `peewee-3.9.6/examples/blog/static/fonts/glyphicons-halflings-regular.woff`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/examples/hexastore.py` & `peewee-3.9.6/examples/hexastore.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/examples/twitter/templates/user_detail.html` & `peewee-3.9.6/examples/twitter/templates/user_detail.html`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/examples/twitter/templates/layout.html` & `peewee-3.9.6/examples/twitter/templates/layout.html`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/examples/twitter/app.py` & `peewee-3.9.6/examples/twitter/app.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/examples/twitter/static/style.css` & `peewee-3.9.6/examples/twitter/static/style.css`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/examples/adjacency_list.py` & `peewee-3.9.6/examples/adjacency_list.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/setup.py` & `peewee-3.9.6/setup.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/runtests.py` & `peewee-3.9.6/runtests.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/pwiz.py` & `peewee-3.9.6/pwiz.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/fields.py` & `peewee-3.9.6/playhouse/fields.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/sqlite_ext.py` & `peewee-3.9.6/playhouse/sqlite_ext.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/_sqlite_udf.c` & `peewee-3.9.6/playhouse/_sqlite_udf.c`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/sqlite_udf.py` & `peewee-3.9.6/playhouse/sqlite_udf.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/_sqlite_udf.pyx` & `peewee-3.9.6/playhouse/_sqlite_udf.pyx`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/README.md` & `peewee-3.9.6/playhouse/README.md`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/db_url.py` & `peewee-3.9.6/playhouse/db_url.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/flask_utils.py` & `peewee-3.9.6/playhouse/flask_utils.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/signals.py` & `peewee-3.9.6/playhouse/signals.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/reflection.py` & `peewee-3.9.6/playhouse/reflection.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/pool.py` & `peewee-3.9.6/playhouse/pool.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/test_utils.py` & `peewee-3.9.6/playhouse/test_utils.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/sqlcipher_ext.py` & `peewee-3.9.6/playhouse/sqlcipher_ext.py`

 * *Files 2% similar despite different names*

```diff
@@ -49,28 +49,30 @@
 import sys
 
 from peewee import *
 from playhouse.sqlite_ext import SqliteExtDatabase
 if sys.version_info[0] != 3:
     from pysqlcipher import dbapi2 as sqlcipher
 else:
-    from pysqlcipher3 import dbapi2 as sqlcipher
+    try:
+        from sqlcipher3 import dbapi2 as sqlcipher
+    except ImportError:
+        from pysqlcipher3 import dbapi2 as sqlcipher
 
 sqlcipher.register_adapter(decimal.Decimal, str)
 sqlcipher.register_adapter(datetime.date, str)
 sqlcipher.register_adapter(datetime.time, str)
 
 
 class _SqlCipherDatabase(object):
     def _connect(self):
         params = dict(self.connect_params)
         passphrase = params.pop('passphrase', '').replace("'", "''")
 
-        conn = sqlcipher.connect(self.database, **params)
-        conn.isolation_level = None
+        conn = sqlcipher.connect(self.database, isolation_level=None, **params)
         try:
             if passphrase:
                 conn.execute("PRAGMA key='%s'" % passphrase)
             self._add_conn_hooks(conn)
         except:
             conn.close()
             raise
```

### Comparing `peewee-3.9.5/playhouse/migrate.py` & `peewee-3.9.6/playhouse/migrate.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/mysql_ext.py` & `peewee-3.9.6/playhouse/mysql_ext.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/postgres_ext.py` & `peewee-3.9.6/playhouse/postgres_ext.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/_sqlite_ext.pyx` & `peewee-3.9.6/playhouse/_sqlite_ext.pyx`

 * *Files 1% similar despite different names*

```diff
@@ -27,27 +27,27 @@
 from peewee import OperationalError
 from peewee import sqlite3 as pysqlite
 
 import traceback
 
 
 cdef struct sqlite3_index_constraint:
-    int iColumn
-    unsigned char op
-    unsigned char usable
-    int iTermOffset
+    int iColumn  # Column constrained, -1 for rowid.
+    unsigned char op  # Constraint operator.
+    unsigned char usable  # True if this constraint is usable.
+    int iTermOffset  # Used internally - xBestIndex should ignore.
 
 
 cdef struct sqlite3_index_orderby:
     int iColumn
     unsigned char desc
 
 
 cdef struct sqlite3_index_constraint_usage:
-    int argvIndex
+    int argvIndex  # if > 0, constraint is part of argv to xFilter.
     unsigned char omit
 
 
 cdef extern from "sqlite3.h" nogil:
     ctypedef struct sqlite3:
         int busyTimeout
     ctypedef struct sqlite3_backup
@@ -78,17 +78,17 @@
         int orderByConsumed
         double estimatedCost
         sqlite3_int64 estimatedRows
         int idxFlags
 
     ctypedef struct sqlite3_module:
         int iVersion
-        int (*xCreate)(sqlite3*, void *pAux, int argc, char **argv,
+        int (*xCreate)(sqlite3*, void *pAux, int argc, const char *const*argv,
                        sqlite3_vtab **ppVTab, char**)
-        int (*xConnect)(sqlite3*, void *pAux, int argc, char **argv,
+        int (*xConnect)(sqlite3*, void *pAux, int argc, const char *const*argv,
                         sqlite3_vtab **ppVTab, char**)
         int (*xBestIndex)(sqlite3_vtab *pVTab, sqlite3_index_info*)
         int (*xDisconnect)(sqlite3_vtab *pVTab)
         int (*xDestroy)(sqlite3_vtab *pVTab)
         int (*xOpen)(sqlite3_vtab *pVTab, sqlite3_vtab_cursor **ppCursor)
         int (*xClose)(sqlite3_vtab_cursor*)
         int (*xFilter)(sqlite3_vtab_cursor*, int idxNum, const char *idxStr,
@@ -381,20 +381,20 @@
     void *table_func
     void *row_data
     bint stopped
 
 
 # We define an xConnect function, but leave xCreate NULL so that the
 # table-function can be called eponymously.
-cdef int pwConnect(sqlite3 *db, void *pAux, int argc, char **argv,
+cdef int pwConnect(sqlite3 *db, void *pAux, int argc, const char *const*argv,
                    sqlite3_vtab **ppVtab, char **pzErr) with gil:
     cdef:
         int rc
         object table_func_cls = <object>pAux
-        peewee_vtab *pNew
+        peewee_vtab *pNew = <peewee_vtab *>0
 
     rc = sqlite3_declare_vtab(
         db,
         encode('CREATE TABLE x(%s);' %
                table_func_cls.get_table_columns_declaration()))
     if rc == SQLITE_OK:
         pNew = <peewee_vtab *>sqlite3_malloc(sizeof(pNew[0]))
@@ -418,15 +418,15 @@
 
 
 # The xOpen method is used to initialize a cursor. In this method we
 # instantiate the TableFunction class and zero out a new cursor for iteration.
 cdef int pwOpen(sqlite3_vtab *pBase, sqlite3_vtab_cursor **ppCursor) with gil:
     cdef:
         peewee_vtab *pVtab = <peewee_vtab *>pBase
-        peewee_cursor *pCur
+        peewee_cursor *pCur = <peewee_cursor *>0
         object table_func_cls = <object>pVtab.table_func_cls
 
     pCur = <peewee_cursor *>sqlite3_malloc(sizeof(pCur[0]))
     memset(<char *>pCur, 0, sizeof(pCur[0]))
     ppCursor[0] = &(pCur.base)
     pCur.idx = 0
     try:
@@ -574,22 +574,21 @@
 cdef int pwBestIndex(sqlite3_vtab *pBase, sqlite3_index_info *pIdxInfo) \
         with gil:
     cdef:
         int i
         int idxNum = 0, nArg = 0
         peewee_vtab *pVtab = <peewee_vtab *>pBase
         object table_func_cls = <object>pVtab.table_func_cls
-        sqlite3_index_constraint *pConstraint
+        sqlite3_index_constraint *pConstraint = <sqlite3_index_constraint *>0
         list columns = []
         char *idxStr
         int nParams = len(table_func_cls.params)
 
-    pConstraint = <sqlite3_index_constraint*>0
     for i in range(pIdxInfo.nConstraint):
-        pConstraint = &pIdxInfo.aConstraint[i]
+        pConstraint = pIdxInfo.aConstraint + i
         if not pConstraint.usable:
             continue
         if pConstraint.op != SQLITE_INDEX_CONSTRAINT_EQ:
             continue
 
         columns.append(table_func_cls.params[pConstraint.iColumn -
                                              table_func_cls._ncols])
@@ -1096,15 +1095,15 @@
     size_t size
 
 cdef int seeds[10]
 seeds[:] = [0, 1337, 37, 0xabcd, 0xdead, 0xface, 97, 0xed11, 0xcad9, 0x827b]
 
 
 cdef bf_t *bf_create(size_t size):
-    cdef bf_t *bf = <bf_t *>calloc(1, sizeof(bf[0]))
+    cdef bf_t *bf = <bf_t *>calloc(1, sizeof(bf_t))
     bf.size = size
     bf.bits = malloc(size)
     return bf
 
 @cython.cdivision(True)
 cdef uint32_t bf_bitindex(bf_t *bf, unsigned char *key, size_t klen, int seed):
     cdef:
@@ -1448,15 +1447,15 @@
             sqlite3_update_hook(self.conn.db, _update_callback, <void *>fn)
 
     def set_busy_handler(self, timeout=5):
         """
         Replace the default busy handler with one that introduces some "jitter"
         into the amount of time delayed between checks.
         """
-        cdef int n = timeout * 1000
+        cdef sqlite3_int64 n = timeout * 1000
         sqlite3_busy_handler(self.conn.db, _aggressive_busy_handler, <void *>n)
         return True
 
     def changes(self):
         return sqlite3_changes(self.conn.db)
 
     def last_insert_rowid(self):
@@ -1482,16 +1481,16 @@
 
 cdef void _rollback_callback(void *userData) with gil:
     # C-callback that delegates to the Python rollback handler.
     cdef object fn = <object>userData
     fn()
 
 
-cdef void _update_callback(void *userData, int queryType, char *database,
-                            char *table, sqlite3_int64 rowid) with gil:
+cdef void _update_callback(void *userData, int queryType, const char *database,
+                           const char *table, sqlite3_int64 rowid) with gil:
     # C-callback that delegates to a Python function that is executed whenever
     # the database is updated (insert/update/delete queries). The Python
     # callback receives a string indicating the query type, the name of the
     # database, the name of the table being updated, and the rowid of the row
     # being updatd.
     cdef object fn = <object>userData
     if queryType == SQLITE_INSERT:
@@ -1557,15 +1556,15 @@
 cdef int _aggressive_busy_handler(void *ptr, int n) nogil:
     # In concurrent environments, it often seems that if multiple queries are
     # kicked off at around the same time, they proceed in lock-step to check
     # for the availability of the lock. By introducing some "jitter" we can
     # ensure that this doesn't happen. Furthermore, this function makes more
     # attempts in the same time period than the default handler.
     cdef:
-        int busyTimeout = <int>ptr
+        sqlite3_int64 busyTimeout = <sqlite3_int64>ptr
         int current, total
 
     if n < 20:
         current = 25 - (rand() % 10)  # ~20ms
         total = n * 20
     elif n < 40:
         current = 50 - (rand() % 20)  # ~40ms
```

### Comparing `peewee-3.9.5/playhouse/_sqlite_ext.c` & `peewee-3.9.6/playhouse/_sqlite_ext.c`

 * *Files 4% similar despite different names*

```diff
@@ -1,39 +1,38 @@
-/* Generated by Cython 0.29.7 */
+/* Generated by Cython 0.27.3 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
             "playhouse/_pysqlite/connection.h"
-        ],
+        ], 
         "include_dirs": [
             "playhouse"
-        ],
+        ], 
         "libraries": [
             "sqlite3"
-        ],
-        "name": "playhouse._sqlite_ext",
+        ], 
+        "name": "playhouse._sqlite_ext", 
         "sources": [
             "playhouse/_sqlite_ext.pyx"
         ]
-    },
+    }, 
     "module_name": "playhouse._sqlite_ext"
 }
 END: Cython Metadata */
 
 #define PY_SSIZE_T_CLEAN
 #include "Python.h"
 #ifndef Py_PYTHON_H
     #error Python headers needed to compile C extensions, please install development version of Python.
 #elif PY_VERSION_HEX < 0x02060000 || (0x03000000 <= PY_VERSION_HEX && PY_VERSION_HEX < 0x03030000)
     #error Cython requires Python 2.6+ or Python 3.3+.
 #else
-#define CYTHON_ABI "0_29_7"
-#define CYTHON_HEX_VERSION 0x001D07F0
+#define CYTHON_ABI "0_27_3"
 #define CYTHON_FUTURE_DIVISION 0
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -96,18 +95,14 @@
   #define CYTHON_FAST_THREAD_STATE 0
   #undef CYTHON_FAST_PYCALL
   #define CYTHON_FAST_PYCALL 0
   #undef CYTHON_PEP489_MULTI_PHASE_INIT
   #define CYTHON_PEP489_MULTI_PHASE_INIT 0
   #undef CYTHON_USE_TP_FINALIZE
   #define CYTHON_USE_TP_FINALIZE 0
-  #undef CYTHON_USE_DICT_VERSIONS
-  #define CYTHON_USE_DICT_VERSIONS 0
-  #undef CYTHON_USE_EXC_INFO_STACK
-  #define CYTHON_USE_EXC_INFO_STACK 0
 #elif defined(PYSTON_VERSION)
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_PYSTON 1
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
@@ -137,18 +132,14 @@
   #define CYTHON_FAST_THREAD_STATE 0
   #undef CYTHON_FAST_PYCALL
   #define CYTHON_FAST_PYCALL 0
   #undef CYTHON_PEP489_MULTI_PHASE_INIT
   #define CYTHON_PEP489_MULTI_PHASE_INIT 0
   #undef CYTHON_USE_TP_FINALIZE
   #define CYTHON_USE_TP_FINALIZE 0
-  #undef CYTHON_USE_DICT_VERSIONS
-  #define CYTHON_USE_DICT_VERSIONS 0
-  #undef CYTHON_USE_EXC_INFO_STACK
-  #define CYTHON_USE_EXC_INFO_STACK 0
 #else
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_PYSTON 0
   #define CYTHON_COMPILING_IN_CPYTHON 1
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
@@ -194,135 +185,29 @@
   #ifndef CYTHON_FAST_THREAD_STATE
     #define CYTHON_FAST_THREAD_STATE 1
   #endif
   #ifndef CYTHON_FAST_PYCALL
     #define CYTHON_FAST_PYCALL 1
   #endif
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
-    #define CYTHON_PEP489_MULTI_PHASE_INIT (PY_VERSION_HEX >= 0x03050000)
+    #define CYTHON_PEP489_MULTI_PHASE_INIT (0 && PY_VERSION_HEX >= 0x03050000)
   #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE (PY_VERSION_HEX >= 0x030400a1)
   #endif
-  #ifndef CYTHON_USE_DICT_VERSIONS
-    #define CYTHON_USE_DICT_VERSIONS (PY_VERSION_HEX >= 0x030600B1)
-  #endif
-  #ifndef CYTHON_USE_EXC_INFO_STACK
-    #define CYTHON_USE_EXC_INFO_STACK (PY_VERSION_HEX >= 0x030700A3)
-  #endif
 #endif
 #if !defined(CYTHON_FAST_PYCCALL)
 #define CYTHON_FAST_PYCCALL  (CYTHON_FAST_PYCALL && PY_VERSION_HEX >= 0x030600B1)
 #endif
 #if CYTHON_USE_PYLONG_INTERNALS
   #include "longintrepr.h"
   #undef SHIFT
   #undef BASE
   #undef MASK
-  #ifdef SIZEOF_VOID_P
-    enum { __pyx_check_sizeof_voidp = 1 / (int)(SIZEOF_VOID_P == sizeof(void*)) };
-  #endif
-#endif
-#ifndef __has_attribute
-  #define __has_attribute(x) 0
-#endif
-#ifndef __has_cpp_attribute
-  #define __has_cpp_attribute(x) 0
-#endif
-#ifndef CYTHON_RESTRICT
-  #if defined(__GNUC__)
-    #define CYTHON_RESTRICT __restrict__
-  #elif defined(_MSC_VER) && _MSC_VER >= 1400
-    #define CYTHON_RESTRICT __restrict
-  #elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
-    #define CYTHON_RESTRICT restrict
-  #else
-    #define CYTHON_RESTRICT
-  #endif
-#endif
-#ifndef CYTHON_UNUSED
-# if defined(__GNUC__)
-#   if !(defined(__cplusplus)) || (__GNUC__ > 3 || (__GNUC__ == 3 && __GNUC_MINOR__ >= 4))
-#     define CYTHON_UNUSED __attribute__ ((__unused__))
-#   else
-#     define CYTHON_UNUSED
-#   endif
-# elif defined(__ICC) || (defined(__INTEL_COMPILER) && !defined(_MSC_VER))
-#   define CYTHON_UNUSED __attribute__ ((__unused__))
-# else
-#   define CYTHON_UNUSED
-# endif
-#endif
-#ifndef CYTHON_MAYBE_UNUSED_VAR
-#  if defined(__cplusplus)
-     template<class T> void CYTHON_MAYBE_UNUSED_VAR( const T& ) { }
-#  else
-#    define CYTHON_MAYBE_UNUSED_VAR(x) (void)(x)
-#  endif
-#endif
-#ifndef CYTHON_NCP_UNUSED
-# if CYTHON_COMPILING_IN_CPYTHON
-#  define CYTHON_NCP_UNUSED
-# else
-#  define CYTHON_NCP_UNUSED CYTHON_UNUSED
-# endif
-#endif
-#define __Pyx_void_to_None(void_result) ((void)(void_result), Py_INCREF(Py_None), Py_None)
-#ifdef _MSC_VER
-    #ifndef _MSC_STDINT_H_
-        #if _MSC_VER < 1300
-           typedef unsigned char     uint8_t;
-           typedef unsigned int      uint32_t;
-        #else
-           typedef unsigned __int8   uint8_t;
-           typedef unsigned __int32  uint32_t;
-        #endif
-    #endif
-#else
-   #include <stdint.h>
-#endif
-#ifndef CYTHON_FALLTHROUGH
-  #if defined(__cplusplus) && __cplusplus >= 201103L
-    #if __has_cpp_attribute(fallthrough)
-      #define CYTHON_FALLTHROUGH [[fallthrough]]
-    #elif __has_cpp_attribute(clang::fallthrough)
-      #define CYTHON_FALLTHROUGH [[clang::fallthrough]]
-    #elif __has_cpp_attribute(gnu::fallthrough)
-      #define CYTHON_FALLTHROUGH [[gnu::fallthrough]]
-    #endif
-  #endif
-  #ifndef CYTHON_FALLTHROUGH
-    #if __has_attribute(fallthrough)
-      #define CYTHON_FALLTHROUGH __attribute__((fallthrough))
-    #else
-      #define CYTHON_FALLTHROUGH
-    #endif
-  #endif
-  #if defined(__clang__ ) && defined(__apple_build_version__)
-    #if __apple_build_version__ < 7000000
-      #undef  CYTHON_FALLTHROUGH
-      #define CYTHON_FALLTHROUGH
-    #endif
-  #endif
 #endif
-
-#ifndef CYTHON_INLINE
-  #if defined(__clang__)
-    #define CYTHON_INLINE __inline__ __attribute__ ((__unused__))
-  #elif defined(__GNUC__)
-    #define CYTHON_INLINE __inline__
-  #elif defined(_MSC_VER)
-    #define CYTHON_INLINE __inline
-  #elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
-    #define CYTHON_INLINE inline
-  #else
-    #define CYTHON_INLINE
-  #endif
-#endif
-
 #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX < 0x02070600 && !defined(Py_OptimizeFlag)
   #define Py_OptimizeFlag 0
 #endif
 #define __PYX_BUILD_PY_SSIZE_T "n"
 #define CYTHON_FORMAT_SSIZE_T "z"
 #if PY_MAJOR_VERSION < 3
   #define __Pyx_BUILTIN_MODULE_NAME "__builtin__"
@@ -343,107 +228,52 @@
 #endif
 #ifndef Py_TPFLAGS_HAVE_NEWBUFFER
   #define Py_TPFLAGS_HAVE_NEWBUFFER 0
 #endif
 #ifndef Py_TPFLAGS_HAVE_FINALIZE
   #define Py_TPFLAGS_HAVE_FINALIZE 0
 #endif
-#ifndef METH_STACKLESS
-  #define METH_STACKLESS 0
-#endif
-#if PY_VERSION_HEX <= 0x030700A3 || !defined(METH_FASTCALL)
+#if PY_VERSION_HEX < 0x030700A0 || !defined(METH_FASTCALL)
   #ifndef METH_FASTCALL
      #define METH_FASTCALL 0x80
   #endif
-  typedef PyObject *(*__Pyx_PyCFunctionFast) (PyObject *self, PyObject *const *args, Py_ssize_t nargs);
-  typedef PyObject *(*__Pyx_PyCFunctionFastWithKeywords) (PyObject *self, PyObject *const *args,
+  typedef PyObject *(*__Pyx_PyCFunctionFast) (PyObject *self, PyObject **args, Py_ssize_t nargs);
+  typedef PyObject *(*__Pyx_PyCFunctionFastWithKeywords) (PyObject *self, PyObject **args,
                                                           Py_ssize_t nargs, PyObject *kwnames);
 #else
   #define __Pyx_PyCFunctionFast _PyCFunctionFast
   #define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
 #endif
 #if CYTHON_FAST_PYCCALL
 #define __Pyx_PyFastCFunction_Check(func)\
-    ((PyCFunction_Check(func) && (METH_FASTCALL == (PyCFunction_GET_FLAGS(func) & ~(METH_CLASS | METH_STATIC | METH_COEXIST | METH_KEYWORDS | METH_STACKLESS)))))
+    ((PyCFunction_Check(func) && (METH_FASTCALL == (PyCFunction_GET_FLAGS(func) & ~(METH_CLASS | METH_STATIC | METH_COEXIST | METH_KEYWORDS)))))
 #else
 #define __Pyx_PyFastCFunction_Check(func) 0
 #endif
-#if CYTHON_COMPILING_IN_PYPY && !defined(PyObject_Malloc)
-  #define PyObject_Malloc(s)   PyMem_Malloc(s)
-  #define PyObject_Free(p)     PyMem_Free(p)
-  #define PyObject_Realloc(p)  PyMem_Realloc(p)
-#endif
-#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX < 0x030400A1
-  #define PyMem_RawMalloc(n)           PyMem_Malloc(n)
-  #define PyMem_RawRealloc(p, n)       PyMem_Realloc(p, n)
-  #define PyMem_RawFree(p)             PyMem_Free(p)
-#endif
-#if CYTHON_COMPILING_IN_PYSTON
-  #define __Pyx_PyCode_HasFreeVars(co)  PyCode_HasFreeVars(co)
-  #define __Pyx_PyFrame_SetLineNumber(frame, lineno) PyFrame_SetLineNumber(frame, lineno)
-#else
-  #define __Pyx_PyCode_HasFreeVars(co)  (PyCode_GetNumFree(co) > 0)
-  #define __Pyx_PyFrame_SetLineNumber(frame, lineno)  (frame)->f_lineno = (lineno)
-#endif
 #if !CYTHON_FAST_THREAD_STATE || PY_VERSION_HEX < 0x02070000
   #define __Pyx_PyThreadState_Current PyThreadState_GET()
 #elif PY_VERSION_HEX >= 0x03060000
   #define __Pyx_PyThreadState_Current _PyThreadState_UncheckedGet()
 #elif PY_VERSION_HEX >= 0x03000000
   #define __Pyx_PyThreadState_Current PyThreadState_GET()
 #else
   #define __Pyx_PyThreadState_Current _PyThreadState_Current
 #endif
-#if PY_VERSION_HEX < 0x030700A2 && !defined(PyThread_tss_create) && !defined(Py_tss_NEEDS_INIT)
-#include "pythread.h"
-#define Py_tss_NEEDS_INIT 0
-typedef int Py_tss_t;
-static CYTHON_INLINE int PyThread_tss_create(Py_tss_t *key) {
-  *key = PyThread_create_key();
-  return 0;
-}
-static CYTHON_INLINE Py_tss_t * PyThread_tss_alloc(void) {
-  Py_tss_t *key = (Py_tss_t *)PyObject_Malloc(sizeof(Py_tss_t));
-  *key = Py_tss_NEEDS_INIT;
-  return key;
-}
-static CYTHON_INLINE void PyThread_tss_free(Py_tss_t *key) {
-  PyObject_Free(key);
-}
-static CYTHON_INLINE int PyThread_tss_is_created(Py_tss_t *key) {
-  return *key != Py_tss_NEEDS_INIT;
-}
-static CYTHON_INLINE void PyThread_tss_delete(Py_tss_t *key) {
-  PyThread_delete_key(*key);
-  *key = Py_tss_NEEDS_INIT;
-}
-static CYTHON_INLINE int PyThread_tss_set(Py_tss_t *key, void *value) {
-  return PyThread_set_key_value(*key, value);
-}
-static CYTHON_INLINE void * PyThread_tss_get(Py_tss_t *key) {
-  return PyThread_get_key_value(*key);
-}
-#endif
 #if CYTHON_COMPILING_IN_CPYTHON || defined(_PyDict_NewPresized)
 #define __Pyx_PyDict_NewPresized(n)  ((n <= 8) ? PyDict_New() : _PyDict_NewPresized(n))
 #else
 #define __Pyx_PyDict_NewPresized(n)  PyDict_New()
 #endif
 #if PY_MAJOR_VERSION >= 3 || CYTHON_FUTURE_DIVISION
   #define __Pyx_PyNumber_Divide(x,y)         PyNumber_TrueDivide(x,y)
   #define __Pyx_PyNumber_InPlaceDivide(x,y)  PyNumber_InPlaceTrueDivide(x,y)
 #else
   #define __Pyx_PyNumber_Divide(x,y)         PyNumber_Divide(x,y)
   #define __Pyx_PyNumber_InPlaceDivide(x,y)  PyNumber_InPlaceDivide(x,y)
 #endif
-#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030500A1 && CYTHON_USE_UNICODE_INTERNALS
-#define __Pyx_PyDict_GetItemStr(dict, name)  _PyDict_GetItem_KnownHash(dict, name, ((PyASCIIObject *) name)->hash)
-#else
-#define __Pyx_PyDict_GetItemStr(dict, name)  PyDict_GetItem(dict, name)
-#endif
 #if PY_VERSION_HEX > 0x03030000 && defined(PyUnicode_KIND)
   #define CYTHON_PEP393_ENABLED 1
   #define __Pyx_PyUnicode_READY(op)       (likely(PyUnicode_IS_READY(op)) ?\
                                               0 : _PyUnicode_Ready((PyObject *)(op)))
   #define __Pyx_PyUnicode_GET_LENGTH(u)   PyUnicode_GET_LENGTH(u)
   #define __Pyx_PyUnicode_READ_CHAR(u, i) PyUnicode_READ_CHAR(u, i)
   #define __Pyx_PyUnicode_MAX_CHAR_VALUE(u)   PyUnicode_MAX_CHAR_VALUE(u)
@@ -480,47 +310,54 @@
 #endif
 #if CYTHON_COMPILING_IN_PYPY && !defined(PyByteArray_Check)
   #define PyByteArray_Check(obj)  PyObject_TypeCheck(obj, &PyByteArray_Type)
 #endif
 #if CYTHON_COMPILING_IN_PYPY && !defined(PyObject_Format)
   #define PyObject_Format(obj, fmt)  PyObject_CallMethod(obj, "__format__", "O", fmt)
 #endif
-#define __Pyx_PyString_FormatSafe(a, b)   ((unlikely((a) == Py_None || (PyString_Check(b) && !PyString_CheckExact(b)))) ? PyNumber_Remainder(a, b) : __Pyx_PyString_Format(a, b))
-#define __Pyx_PyUnicode_FormatSafe(a, b)  ((unlikely((a) == Py_None || (PyUnicode_Check(b) && !PyUnicode_CheckExact(b)))) ? PyNumber_Remainder(a, b) : PyUnicode_Format(a, b))
+#if CYTHON_COMPILING_IN_PYPY && !defined(PyObject_Malloc)
+  #define PyObject_Malloc(s)   PyMem_Malloc(s)
+  #define PyObject_Free(p)     PyMem_Free(p)
+  #define PyObject_Realloc(p)  PyMem_Realloc(p)
+#endif
+#if CYTHON_COMPILING_IN_PYSTON
+  #define __Pyx_PyCode_HasFreeVars(co)  PyCode_HasFreeVars(co)
+  #define __Pyx_PyFrame_SetLineNumber(frame, lineno) PyFrame_SetLineNumber(frame, lineno)
+#else
+  #define __Pyx_PyCode_HasFreeVars(co)  (PyCode_GetNumFree(co) > 0)
+  #define __Pyx_PyFrame_SetLineNumber(frame, lineno)  (frame)->f_lineno = (lineno)
+#endif
+#define __Pyx_PyString_FormatSafe(a, b)   ((unlikely((a) == Py_None)) ? PyNumber_Remainder(a, b) : __Pyx_PyString_Format(a, b))
+#define __Pyx_PyUnicode_FormatSafe(a, b)  ((unlikely((a) == Py_None)) ? PyNumber_Remainder(a, b) : PyUnicode_Format(a, b))
 #if PY_MAJOR_VERSION >= 3
   #define __Pyx_PyString_Format(a, b)  PyUnicode_Format(a, b)
 #else
   #define __Pyx_PyString_Format(a, b)  PyString_Format(a, b)
 #endif
 #if PY_MAJOR_VERSION < 3 && !defined(PyObject_ASCII)
   #define PyObject_ASCII(o)            PyObject_Repr(o)
 #endif
 #if PY_MAJOR_VERSION >= 3
   #define PyBaseString_Type            PyUnicode_Type
   #define PyStringObject               PyUnicodeObject
   #define PyString_Type                PyUnicode_Type
   #define PyString_Check               PyUnicode_Check
   #define PyString_CheckExact          PyUnicode_CheckExact
-  #define PyObject_Unicode             PyObject_Str
 #endif
 #if PY_MAJOR_VERSION >= 3
   #define __Pyx_PyBaseString_Check(obj) PyUnicode_Check(obj)
   #define __Pyx_PyBaseString_CheckExact(obj) PyUnicode_CheckExact(obj)
 #else
   #define __Pyx_PyBaseString_Check(obj) (PyString_Check(obj) || PyUnicode_Check(obj))
   #define __Pyx_PyBaseString_CheckExact(obj) (PyString_CheckExact(obj) || PyUnicode_CheckExact(obj))
 #endif
 #ifndef PySet_CheckExact
   #define PySet_CheckExact(obj)        (Py_TYPE(obj) == &PySet_Type)
 #endif
-#if CYTHON_ASSUME_SAFE_MACROS
-  #define __Pyx_PySequence_SIZE(seq)  Py_SIZE(seq)
-#else
-  #define __Pyx_PySequence_SIZE(seq)  PySequence_Size(seq)
-#endif
+#define __Pyx_PyException_Check(obj) __Pyx_TypeCheck(obj, PyExc_Exception)
 #if PY_MAJOR_VERSION >= 3
   #define PyIntObject                  PyLongObject
   #define PyInt_Type                   PyLong_Type
   #define PyInt_Check(op)              PyLong_Check(op)
   #define PyInt_CheckExact(op)         PyLong_CheckExact(op)
   #define PyInt_FromString             PyLong_FromString
   #define PyInt_FromUnicode            PyLong_FromUnicode
@@ -547,18 +384,24 @@
   #define __Pyx_PyInt_FromHash_t PyInt_FromLong
   #define __Pyx_PyInt_AsHash_t   PyInt_AsLong
 #else
   #define __Pyx_PyInt_FromHash_t PyInt_FromSsize_t
   #define __Pyx_PyInt_AsHash_t   PyInt_AsSsize_t
 #endif
 #if PY_MAJOR_VERSION >= 3
-  #define __Pyx_PyMethod_New(func, self, klass) ((self) ? PyMethod_New(func, self) : (Py_INCREF(func), func))
+  #define __Pyx_PyMethod_New(func, self, klass) ((self) ? PyMethod_New(func, self) : PyInstanceMethod_New(func))
 #else
   #define __Pyx_PyMethod_New(func, self, klass) PyMethod_New(func, self, klass)
 #endif
+#ifndef __has_attribute
+  #define __has_attribute(x) 0
+#endif
+#ifndef __has_cpp_attribute
+  #define __has_cpp_attribute(x) 0
+#endif
 #if CYTHON_USE_ASYNC_SLOTS
   #if PY_VERSION_HEX >= 0x030500B1
     #define __Pyx_PyAsyncMethodsStruct PyAsyncMethods
     #define __Pyx_PyType_AsAsync(obj) (Py_TYPE(obj)->tp_as_async)
   #else
     #define __Pyx_PyType_AsAsync(obj) ((__Pyx_PyAsyncMethodsStruct*) (Py_TYPE(obj)->tp_reserved))
   #endif
@@ -568,14 +411,104 @@
 #ifndef __Pyx_PyAsyncMethodsStruct
     typedef struct {
         unaryfunc am_await;
         unaryfunc am_aiter;
         unaryfunc am_anext;
     } __Pyx_PyAsyncMethodsStruct;
 #endif
+#ifndef CYTHON_RESTRICT
+  #if defined(__GNUC__)
+    #define CYTHON_RESTRICT __restrict__
+  #elif defined(_MSC_VER) && _MSC_VER >= 1400
+    #define CYTHON_RESTRICT __restrict
+  #elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
+    #define CYTHON_RESTRICT restrict
+  #else
+    #define CYTHON_RESTRICT
+  #endif
+#endif
+#ifndef CYTHON_UNUSED
+# if defined(__GNUC__)
+#   if !(defined(__cplusplus)) || (__GNUC__ > 3 || (__GNUC__ == 3 && __GNUC_MINOR__ >= 4))
+#     define CYTHON_UNUSED __attribute__ ((__unused__))
+#   else
+#     define CYTHON_UNUSED
+#   endif
+# elif defined(__ICC) || (defined(__INTEL_COMPILER) && !defined(_MSC_VER))
+#   define CYTHON_UNUSED __attribute__ ((__unused__))
+# else
+#   define CYTHON_UNUSED
+# endif
+#endif
+#ifndef CYTHON_MAYBE_UNUSED_VAR
+#  if defined(__cplusplus)
+     template<class T> void CYTHON_MAYBE_UNUSED_VAR( const T& ) { }
+#  else
+#    define CYTHON_MAYBE_UNUSED_VAR(x) (void)(x)
+#  endif
+#endif
+#ifndef CYTHON_NCP_UNUSED
+# if CYTHON_COMPILING_IN_CPYTHON
+#  define CYTHON_NCP_UNUSED
+# else
+#  define CYTHON_NCP_UNUSED CYTHON_UNUSED
+# endif
+#endif
+#define __Pyx_void_to_None(void_result) ((void)(void_result), Py_INCREF(Py_None), Py_None)
+#ifdef _MSC_VER
+    #ifndef _MSC_STDINT_H_
+        #if _MSC_VER < 1300
+           typedef unsigned char     uint8_t;
+           typedef unsigned int      uint32_t;
+        #else
+           typedef unsigned __int8   uint8_t;
+           typedef unsigned __int32  uint32_t;
+        #endif
+    #endif
+#else
+   #include <stdint.h>
+#endif
+#ifndef CYTHON_FALLTHROUGH
+  #if defined(__cplusplus) && __cplusplus >= 201103L
+    #if __has_cpp_attribute(fallthrough)
+      #define CYTHON_FALLTHROUGH [[fallthrough]]
+    #elif __has_cpp_attribute(clang::fallthrough)
+      #define CYTHON_FALLTHROUGH [[clang::fallthrough]]
+    #elif __has_cpp_attribute(gnu::fallthrough)
+      #define CYTHON_FALLTHROUGH [[gnu::fallthrough]]
+    #endif
+  #endif
+  #ifndef CYTHON_FALLTHROUGH
+    #if __has_attribute(fallthrough)
+      #define CYTHON_FALLTHROUGH __attribute__((fallthrough))
+    #else
+      #define CYTHON_FALLTHROUGH
+    #endif
+  #endif
+  #if defined(__clang__ ) && defined(__apple_build_version__)
+    #if __apple_build_version__ < 7000000
+      #undef  CYTHON_FALLTHROUGH
+      #define CYTHON_FALLTHROUGH
+    #endif
+  #endif
+#endif
+
+#ifndef CYTHON_INLINE
+  #if defined(__clang__)
+    #define CYTHON_INLINE __inline__ __attribute__ ((__unused__))
+  #elif defined(__GNUC__)
+    #define CYTHON_INLINE __inline__
+  #elif defined(_MSC_VER)
+    #define CYTHON_INLINE __inline
+  #elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
+    #define CYTHON_INLINE inline
+  #else
+    #define CYTHON_INLINE
+  #endif
+#endif
 
 #if defined(WIN32) || defined(MS_WINDOWS)
   #define _USE_MATH_DEFINES
 #endif
 #include <math.h>
 #ifdef NAN
 #define __PYX_NAN() ((float) NAN)
@@ -604,15 +537,14 @@
   #else
     #define __PYX_EXTERN_C extern
   #endif
 #endif
 
 #define __PYX_HAVE__playhouse___sqlite_ext
 #define __PYX_HAVE_API__playhouse___sqlite_ext
-/* Early includes */
 #include <string.h>
 #include <stdio.h>
 #include "pythread.h"
 #include "datetime.h"
 #include <float.h>
 #include <math.h>
 #include <stdint.h>
@@ -627,16 +559,15 @@
 #define CYTHON_WITHOUT_ASSERTIONS
 #endif
 
 typedef struct {PyObject **p; const char *s; const Py_ssize_t n; const char* encoding;
                 const char is_unicode; const char is_str; const char intern; } __Pyx_StringTabEntry;
 
 #define __PYX_DEFAULT_STRING_ENCODING_IS_ASCII 0
-#define __PYX_DEFAULT_STRING_ENCODING_IS_UTF8 0
-#define __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT (PY_MAJOR_VERSION >= 3 && __PYX_DEFAULT_STRING_ENCODING_IS_UTF8)
+#define __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT 0
 #define __PYX_DEFAULT_STRING_ENCODING ""
 #define __Pyx_PyObject_FromString __Pyx_PyBytes_FromString
 #define __Pyx_PyObject_FromStringAndSize __Pyx_PyBytes_FromStringAndSize
 #define __Pyx_uchar_cast(c) ((unsigned char)c)
 #define __Pyx_long_cast(x) ((long)x)
 #define __Pyx_fits_Py_ssize_t(v, type, is_signed)  (\
     (sizeof(type) < sizeof(Py_ssize_t))  ||\
@@ -644,17 +575,14 @@
           likely(v < (type)PY_SSIZE_T_MAX ||\
                  v == (type)PY_SSIZE_T_MAX)  &&\
           (!is_signed || likely(v > (type)PY_SSIZE_T_MIN ||\
                                 v == (type)PY_SSIZE_T_MIN)))  ||\
     (sizeof(type) == sizeof(Py_ssize_t) &&\
           (is_signed || likely(v < (type)PY_SSIZE_T_MAX ||\
                                v == (type)PY_SSIZE_T_MAX)))  )
-static CYTHON_INLINE int __Pyx_is_valid_index(Py_ssize_t i, Py_ssize_t limit) {
-    return (size_t) i < (size_t) limit;
-}
 #if defined (__cplusplus) && __cplusplus >= 201103L
     #include <cstdlib>
     #define __Pyx_sst_abs(value) std::abs(value)
 #elif SIZEOF_INT >= SIZEOF_SIZE_T
     #define __Pyx_sst_abs(value) abs(value)
 #elif SIZEOF_LONG >= SIZEOF_SIZE_T
     #define __Pyx_sst_abs(value) labs(value)
@@ -703,17 +631,16 @@
     return (size_t)(u_end - u - 1);
 }
 #define __Pyx_PyUnicode_FromUnicode(u)       PyUnicode_FromUnicode(u, __Pyx_Py_UNICODE_strlen(u))
 #define __Pyx_PyUnicode_FromUnicodeAndLength PyUnicode_FromUnicode
 #define __Pyx_PyUnicode_AsUnicode            PyUnicode_AsUnicode
 #define __Pyx_NewRef(obj) (Py_INCREF(obj), obj)
 #define __Pyx_Owned_Py_None(b) __Pyx_NewRef(Py_None)
-static CYTHON_INLINE PyObject * __Pyx_PyBool_FromLong(long b);
+#define __Pyx_PyBool_FromLong(b) ((b) ? __Pyx_NewRef(Py_True) : __Pyx_NewRef(Py_False))
 static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
-static CYTHON_INLINE int __Pyx_PyObject_IsTrueAndDecref(PyObject*);
 static CYTHON_INLINE PyObject* __Pyx_PyNumber_IntOrLong(PyObject* x);
 #define __Pyx_PySequence_Tuple(obj)\
     (likely(PyTuple_CheckExact(obj)) ? __Pyx_NewRef(obj) : PySequence_Tuple(obj))
 static CYTHON_INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject*);
 static CYTHON_INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t);
 #if CYTHON_ASSUME_SAFE_MACROS
 #define __pyx_PyFloat_AsDouble(x) (PyFloat_CheckExact(x) ? PyFloat_AS_DOUBLE(x) : PyFloat_AsDouble(x))
@@ -786,15 +713,15 @@
     sys = PyImport_ImportModule("sys");
     if (!sys) goto bad;
     default_encoding = PyObject_CallMethod(sys, (char*) (const char*) "getdefaultencoding", NULL);
     Py_DECREF(sys);
     if (!default_encoding) goto bad;
     default_encoding_c = PyBytes_AsString(default_encoding);
     if (!default_encoding_c) goto bad;
-    __PYX_DEFAULT_STRING_ENCODING = (char*) malloc(strlen(default_encoding_c) + 1);
+    __PYX_DEFAULT_STRING_ENCODING = (char*) malloc(strlen(default_encoding_c));
     if (!__PYX_DEFAULT_STRING_ENCODING) goto bad;
     strcpy(__PYX_DEFAULT_STRING_ENCODING, default_encoding_c);
     Py_DECREF(default_encoding);
     return 0;
 bad:
     Py_XDECREF(default_encoding);
     return -1;
@@ -812,15 +739,15 @@
   #define unlikely(x) (x)
 #endif /* __GNUC__ */
 static CYTHON_INLINE void __Pyx_pretend_to_initialize(void* ptr) { (void)ptr; }
 
 static PyObject *__pyx_m = NULL;
 static PyObject *__pyx_d;
 static PyObject *__pyx_b;
-static PyObject *__pyx_cython_runtime = NULL;
+static PyObject *__pyx_cython_runtime;
 static PyObject *__pyx_empty_tuple;
 static PyObject *__pyx_empty_bytes;
 static PyObject *__pyx_empty_unicode;
 static int __pyx_lineno;
 static int __pyx_clineno = 0;
 static const char * __pyx_cfilenm= __FILE__;
 static const char *__pyx_filename;
@@ -864,16 +791,16 @@
 struct __pyx_t_9playhouse_11_sqlite_ext_bf_t;
 typedef struct __pyx_t_9playhouse_11_sqlite_ext_bf_t __pyx_t_9playhouse_11_sqlite_ext_bf_t;
 
 /* "playhouse/_sqlite_ext.pyx":33
  * 
  * 
  * cdef struct sqlite3_index_constraint:             # <<<<<<<<<<<<<<
- *     int iColumn
- *     unsigned char op
+ *     int iColumn  # Column constrained, -1 for rowid.
+ *     unsigned char op  # Constraint operator.
  */
 struct __pyx_t_9playhouse_11_sqlite_ext_sqlite3_index_constraint {
   int iColumn;
   unsigned char op;
   unsigned char usable;
   int iTermOffset;
 };
@@ -890,15 +817,15 @@
   unsigned char desc;
 };
 
 /* "playhouse/_sqlite_ext.pyx":45
  * 
  * 
  * cdef struct sqlite3_index_constraint_usage:             # <<<<<<<<<<<<<<
- *     int argvIndex
+ *     int argvIndex  # if > 0, constraint is part of argv to xFilter.
  *     unsigned char omit
  */
 struct __pyx_t_9playhouse_11_sqlite_ext_sqlite3_index_constraint_usage {
   int argvIndex;
   unsigned char omit;
 };
 
@@ -925,68 +852,68 @@
   sqlite3_vtab_cursor base;
   PY_LONG_LONG idx;
   void *table_func;
   void *row_data;
   int stopped;
 };
 
-/* "playhouse/_sqlite_ext.pyx":1094
+/* "playhouse/_sqlite_ext.pyx":1093
  * 
  * 
  * ctypedef struct bf_t:             # <<<<<<<<<<<<<<
  *     void *bits
  *     size_t size
  */
 struct __pyx_t_9playhouse_11_sqlite_ext_bf_t {
   void *bits;
   size_t size;
 };
 
-/* "playhouse/_sqlite_ext.pyx":625
+/* "playhouse/_sqlite_ext.pyx":624
  * 
  * 
  * cdef class _TableFunctionImpl(object):             # <<<<<<<<<<<<<<
  *     cdef:
  *         sqlite3_module module
  */
 struct __pyx_obj_9playhouse_11_sqlite_ext__TableFunctionImpl {
   PyObject_HEAD
   struct __pyx_vtabstruct_9playhouse_11_sqlite_ext__TableFunctionImpl *__pyx_vtab;
   sqlite3_module module;
   PyObject *table_function;
 };
 
 
-/* "playhouse/_sqlite_ext.pyx":1147
+/* "playhouse/_sqlite_ext.pyx":1146
  * 
  * 
  * cdef class BloomFilter(object):             # <<<<<<<<<<<<<<
  *     cdef:
  *         bf_t *bf
  */
 struct __pyx_obj_9playhouse_11_sqlite_ext_BloomFilter {
   PyObject_HEAD
   __pyx_t_9playhouse_11_sqlite_ext_bf_t *bf;
 };
 
 
-/* "playhouse/_sqlite_ext.pyx":1183
+/* "playhouse/_sqlite_ext.pyx":1182
  * 
  * 
  * cdef class BloomFilterAggregate(object):             # <<<<<<<<<<<<<<
  *     cdef:
  *         BloomFilter bf
  */
 struct __pyx_obj_9playhouse_11_sqlite_ext_BloomFilterAggregate {
   PyObject_HEAD
   struct __pyx_obj_9playhouse_11_sqlite_ext_BloomFilter *bf;
 };
 
 
-/* "playhouse/_sqlite_ext.pyx":1250
+/* "playhouse/_sqlite_ext.pyx":1249
  * 
  * 
  * cdef class Blob(object)  # Forward declaration.             # <<<<<<<<<<<<<<
  * 
  * 
  */
 struct __pyx_obj_9playhouse_11_sqlite_ext_Blob {
@@ -994,15 +921,15 @@
   struct __pyx_vtabstruct_9playhouse_11_sqlite_ext_Blob *__pyx_vtab;
   int offset;
   pysqlite_Connection *conn;
   sqlite3_blob *pBlob;
 };
 
 
-/* "playhouse/_sqlite_ext.pyx":1407
+/* "playhouse/_sqlite_ext.pyx":1406
  * 
  * 
  * cdef class ConnectionHelper(object):             # <<<<<<<<<<<<<<
  *     cdef:
  *         object _commit_hook, _rollback_hook, _update_hook
  */
 struct __pyx_obj_9playhouse_11_sqlite_ext_ConnectionHelper {
@@ -1010,43 +937,43 @@
   PyObject *_commit_hook;
   PyObject *_rollback_hook;
   PyObject *_update_hook;
   pysqlite_Connection *conn;
 };
 
 
-/* "playhouse/_sqlite_ext.pyx":1057
+/* "playhouse/_sqlite_ext.pyx":1056
  * 
  * 
  * def make_hash(hash_impl):             # <<<<<<<<<<<<<<
  *     def inner(*items):
  *         state = hash_impl()
  */
 struct __pyx_obj_9playhouse_11_sqlite_ext___pyx_scope_struct__make_hash {
   PyObject_HEAD
   PyObject *__pyx_v_hash_impl;
 };
 
 
 
-/* "playhouse/_sqlite_ext.pyx":625
+/* "playhouse/_sqlite_ext.pyx":624
  * 
  * 
  * cdef class _TableFunctionImpl(object):             # <<<<<<<<<<<<<<
  *     cdef:
  *         sqlite3_module module
  */
 
 struct __pyx_vtabstruct_9playhouse_11_sqlite_ext__TableFunctionImpl {
   PyObject *(*create_module)(struct __pyx_obj_9playhouse_11_sqlite_ext__TableFunctionImpl *, pysqlite_Connection *);
 };
 static struct __pyx_vtabstruct_9playhouse_11_sqlite_ext__TableFunctionImpl *__pyx_vtabptr_9playhouse_11_sqlite_ext__TableFunctionImpl;
 
 
-/* "playhouse/_sqlite_ext.pyx":1259
+/* "playhouse/_sqlite_ext.pyx":1258
  * 
  * 
  * cdef class Blob(object):             # <<<<<<<<<<<<<<
  *     cdef:
  *         int offset
  */
 
@@ -1117,15 +1044,24 @@
         r = v; __Pyx_DECREF(tmp);\
     } while (0)
 #define __Pyx_CLEAR(r)    do { PyObject* tmp = ((PyObject*)(r)); r = NULL; __Pyx_DECREF(tmp);} while(0)
 #define __Pyx_XCLEAR(r)   do { if((r) != NULL) {PyObject* tmp = ((PyObject*)(r)); r = NULL; __Pyx_DECREF(tmp);}} while(0)
 
 /* PyObjectGetAttrStr.proto */
 #if CYTHON_USE_TYPE_SLOTS
-static CYTHON_INLINE PyObject* __Pyx_PyObject_GetAttrStr(PyObject* obj, PyObject* attr_name);
+static CYTHON_INLINE PyObject* __Pyx_PyObject_GetAttrStr(PyObject* obj, PyObject* attr_name) {
+    PyTypeObject* tp = Py_TYPE(obj);
+    if (likely(tp->tp_getattro))
+        return tp->tp_getattro(obj, attr_name);
+#if PY_MAJOR_VERSION < 3
+    if (likely(tp->tp_getattr))
+        return tp->tp_getattr(obj, PyString_AS_STRING(attr_name));
+#endif
+    return PyObject_GetAttr(obj, attr_name);
+}
 #else
 #define __Pyx_PyObject_GetAttrStr(o,n) PyObject_GetAttr(o,n)
 #endif
 
 /* GetBuiltinName.proto */
 static PyObject *__Pyx_GetBuiltinName(PyObject *name);
 
@@ -1142,66 +1078,54 @@
     }
     return PyList_Append(list, x);
 }
 #else
 #define __Pyx_PyList_Append(L,x) PyList_Append(L,x)
 #endif
 
+/* PyCFunctionFastCall.proto */
+#if CYTHON_FAST_PYCCALL
+static CYTHON_INLINE PyObject *__Pyx_PyCFunction_FastCall(PyObject *func, PyObject **args, Py_ssize_t nargs);
+#else
+#define __Pyx_PyCFunction_FastCall(func, args, nargs)  (assert(0), NULL)
+#endif
+
 /* PyFunctionFastCall.proto */
 #if CYTHON_FAST_PYCALL
 #define __Pyx_PyFunction_FastCall(func, args, nargs)\
     __Pyx_PyFunction_FastCallDict((func), (args), (nargs), NULL)
 #if 1 || PY_VERSION_HEX < 0x030600B1
 static PyObject *__Pyx_PyFunction_FastCallDict(PyObject *func, PyObject **args, int nargs, PyObject *kwargs);
 #else
 #define __Pyx_PyFunction_FastCallDict(func, args, nargs, kwargs) _PyFunction_FastCallDict(func, args, nargs, kwargs)
 #endif
-#define __Pyx_BUILD_ASSERT_EXPR(cond)\
-    (sizeof(char [1 - 2*!(cond)]) - 1)
-#ifndef Py_MEMBER_SIZE
-#define Py_MEMBER_SIZE(type, member) sizeof(((type *)0)->member)
-#endif
-  static size_t __pyx_pyframe_localsplus_offset = 0;
-  #include "frameobject.h"
-  #define __Pxy_PyFrame_Initialize_Offsets()\
-    ((void)__Pyx_BUILD_ASSERT_EXPR(sizeof(PyFrameObject) == offsetof(PyFrameObject, f_localsplus) + Py_MEMBER_SIZE(PyFrameObject, f_localsplus)),\
-     (void)(__pyx_pyframe_localsplus_offset = ((size_t)PyFrame_Type.tp_basicsize) - Py_MEMBER_SIZE(PyFrameObject, f_localsplus)))
-  #define __Pyx_PyFrame_GetLocalsplus(frame)\
-    (assert(__pyx_pyframe_localsplus_offset), (PyObject **)(((char *)(frame)) + __pyx_pyframe_localsplus_offset))
 #endif
 
 /* PyObjectCall.proto */
 #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw);
 #else
 #define __Pyx_PyObject_Call(func, arg, kw) PyObject_Call(func, arg, kw)
 #endif
 
 /* PyObjectCallMethO.proto */
 #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg);
 #endif
 
+/* PyObjectCallOneArg.proto */
+static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg);
+
 /* PyObjectCallNoArg.proto */
 #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func);
 #else
 #define __Pyx_PyObject_CallNoArg(func) __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL)
 #endif
 
-/* PyCFunctionFastCall.proto */
-#if CYTHON_FAST_PYCCALL
-static CYTHON_INLINE PyObject *__Pyx_PyCFunction_FastCall(PyObject *func, PyObject **args, Py_ssize_t nargs);
-#else
-#define __Pyx_PyCFunction_FastCall(func, args, nargs)  (assert(0), NULL)
-#endif
-
-/* PyObjectCallOneArg.proto */
-static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg);
-
 /* PyThreadStateGet.proto */
 #if CYTHON_FAST_THREAD_STATE
 #define __Pyx_PyThreadState_declare  PyThreadState *__pyx_tstate;
 #define __Pyx_PyThreadState_assign  __pyx_tstate = __Pyx_PyThreadState_Current;
 #define __Pyx_PyErr_Occurred()  __pyx_tstate->curexc_type
 #else
 #define __Pyx_PyThreadState_declare
@@ -1235,19 +1159,14 @@
 #endif
 
 /* WriteUnraisableException.proto */
 static void __Pyx_WriteUnraisable(const char *name, int clineno,
                                   int lineno, const char *filename,
                                   int full_traceback, int nogil);
 
-/* GetTopmostException.proto */
-#if CYTHON_USE_EXC_INFO_STACK
-static _PyErr_StackItem * __Pyx_PyErr_GetTopmostException(PyThreadState *tstate);
-#endif
-
 /* SaveResetException.proto */
 #if CYTHON_FAST_THREAD_STATE
 #define __Pyx_ExceptionSave(type, value, tb)  __Pyx__ExceptionSave(__pyx_tstate, type, value, tb)
 static CYTHON_INLINE void __Pyx__ExceptionSave(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
 #define __Pyx_ExceptionReset(type, value, tb)  __Pyx__ExceptionReset(__pyx_tstate, type, value, tb)
 static CYTHON_INLINE void __Pyx__ExceptionReset(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb);
 #else
@@ -1259,63 +1178,16 @@
 #if CYTHON_FAST_THREAD_STATE
 #define __Pyx_GetException(type, value, tb)  __Pyx__GetException(__pyx_tstate, type, value, tb)
 static int __Pyx__GetException(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
 #else
 static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb);
 #endif
 
-/* PyDictVersioning.proto */
-#if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_TYPE_SLOTS
-#define __PYX_DICT_VERSION_INIT  ((PY_UINT64_T) -1)
-#define __PYX_GET_DICT_VERSION(dict)  (((PyDictObject*)(dict))->ma_version_tag)
-#define __PYX_UPDATE_DICT_CACHE(dict, value, cache_var, version_var)\
-    (version_var) = __PYX_GET_DICT_VERSION(dict);\
-    (cache_var) = (value);
-#define __PYX_PY_DICT_LOOKUP_IF_MODIFIED(VAR, DICT, LOOKUP) {\
-    static PY_UINT64_T __pyx_dict_version = 0;\
-    static PyObject *__pyx_dict_cached_value = NULL;\
-    if (likely(__PYX_GET_DICT_VERSION(DICT) == __pyx_dict_version)) {\
-        (VAR) = __pyx_dict_cached_value;\
-    } else {\
-        (VAR) = __pyx_dict_cached_value = (LOOKUP);\
-        __pyx_dict_version = __PYX_GET_DICT_VERSION(DICT);\
-    }\
-}
-static CYTHON_INLINE PY_UINT64_T __Pyx_get_tp_dict_version(PyObject *obj);
-static CYTHON_INLINE PY_UINT64_T __Pyx_get_object_dict_version(PyObject *obj);
-static CYTHON_INLINE int __Pyx_object_dict_version_matches(PyObject* obj, PY_UINT64_T tp_dict_version, PY_UINT64_T obj_dict_version);
-#else
-#define __PYX_GET_DICT_VERSION(dict)  (0)
-#define __PYX_UPDATE_DICT_CACHE(dict, value, cache_var, version_var)
-#define __PYX_PY_DICT_LOOKUP_IF_MODIFIED(VAR, DICT, LOOKUP)  (VAR) = (LOOKUP);
-#endif
-
 /* GetModuleGlobalName.proto */
-#if CYTHON_USE_DICT_VERSIONS
-#define __Pyx_GetModuleGlobalName(var, name)  {\
-    static PY_UINT64_T __pyx_dict_version = 0;\
-    static PyObject *__pyx_dict_cached_value = NULL;\
-    (var) = (likely(__pyx_dict_version == __PYX_GET_DICT_VERSION(__pyx_d))) ?\
-        (likely(__pyx_dict_cached_value) ? __Pyx_NewRef(__pyx_dict_cached_value) : __Pyx_GetBuiltinName(name)) :\
-        __Pyx__GetModuleGlobalName(name, &__pyx_dict_version, &__pyx_dict_cached_value);\
-}
-#define __Pyx_GetModuleGlobalNameUncached(var, name)  {\
-    PY_UINT64_T __pyx_dict_version;\
-    PyObject *__pyx_dict_cached_value;\
-    (var) = __Pyx__GetModuleGlobalName(name, &__pyx_dict_version, &__pyx_dict_cached_value);\
-}
-static PyObject *__Pyx__GetModuleGlobalName(PyObject *name, PY_UINT64_T *dict_version, PyObject **dict_cached_value);
-#else
-#define __Pyx_GetModuleGlobalName(var, name)  (var) = __Pyx__GetModuleGlobalName(name)
-#define __Pyx_GetModuleGlobalNameUncached(var, name)  (var) = __Pyx__GetModuleGlobalName(name)
-static CYTHON_INLINE PyObject *__Pyx__GetModuleGlobalName(PyObject *name);
-#endif
-
-/* PyObjectCall2Args.proto */
-static CYTHON_UNUSED PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2);
+static CYTHON_INLINE PyObject *__Pyx_GetModuleGlobalName(PyObject *name);
 
 /* PyErrExceptionMatches.proto */
 #if CYTHON_FAST_THREAD_STATE
 #define __Pyx_PyErr_ExceptionMatches(err) __Pyx_PyErr_ExceptionMatchesInState(__pyx_tstate, err)
 static CYTHON_INLINE int __Pyx_PyErr_ExceptionMatchesInState(PyThreadState* tstate, PyObject* err);
 #else
 #define __Pyx_PyErr_ExceptionMatches(err)  PyErr_ExceptionMatches(err)
@@ -1342,21 +1214,14 @@
 static PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j);
 static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i,
                                                      int is_list, int wraparound, int boundscheck);
 
 /* IncludeStringH.proto */
 #include <string.h>
 
-/* ObjectGetItem.proto */
-#if CYTHON_USE_TYPE_SLOTS
-static CYTHON_INLINE PyObject *__Pyx_PyObject_GetItem(PyObject *obj, PyObject* key);
-#else
-#define __Pyx_PyObject_GetItem(obj, key)  PyObject_GetItem(obj, key)
-#endif
-
 /* StringJoin.proto */
 #if PY_MAJOR_VERSION < 3
 #define __Pyx_PyString_Join __Pyx_PyBytes_Join
 #define __Pyx_PyBaseString_Join(s, v) (PyUnicode_CheckExact(s) ? PyUnicode_Join(s, v) : __Pyx_PyBytes_Join(s, v))
 #else
 #define __Pyx_PyString_Join PyUnicode_Join
 #define __Pyx_PyBaseString_Join PyUnicode_Join
@@ -1384,50 +1249,51 @@
     Py_ssize_t num_min, Py_ssize_t num_max, Py_ssize_t num_found);
 
 /* RaiseException.proto */
 static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause);
 
 /* PyObjectSetAttrStr.proto */
 #if CYTHON_USE_TYPE_SLOTS
-#define __Pyx_PyObject_DelAttrStr(o,n) __Pyx_PyObject_SetAttrStr(o, n, NULL)
-static CYTHON_INLINE int __Pyx_PyObject_SetAttrStr(PyObject* obj, PyObject* attr_name, PyObject* value);
+#define __Pyx_PyObject_DelAttrStr(o,n) __Pyx_PyObject_SetAttrStr(o,n,NULL)
+static CYTHON_INLINE int __Pyx_PyObject_SetAttrStr(PyObject* obj, PyObject* attr_name, PyObject* value) {
+    PyTypeObject* tp = Py_TYPE(obj);
+    if (likely(tp->tp_setattro))
+        return tp->tp_setattro(obj, attr_name, value);
+#if PY_MAJOR_VERSION < 3
+    if (likely(tp->tp_setattr))
+        return tp->tp_setattr(obj, PyString_AS_STRING(attr_name), value);
+#endif
+    return PyObject_SetAttr(obj, attr_name, value);
+}
 #else
 #define __Pyx_PyObject_DelAttrStr(o,n)   PyObject_DelAttr(o,n)
 #define __Pyx_PyObject_SetAttrStr(o,n,v) PyObject_SetAttr(o,n,v)
 #endif
 
 /* PyDictContains.proto */
 static CYTHON_INLINE int __Pyx_PyDict_ContainsTF(PyObject* item, PyObject* dict, int eq) {
     int result = PyDict_Contains(dict, item);
     return unlikely(result < 0) ? result : (result == (eq == Py_EQ));
 }
 
 /* ExtTypeTest.proto */
 static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type);
 
-/* PyObject_Unicode.proto */
-#if PY_MAJOR_VERSION >= 3
-#define __Pyx_PyObject_Unicode(obj)\
-    (likely(PyUnicode_CheckExact(obj)) ? __Pyx_NewRef(obj) : PyObject_Str(obj))
-#else
-#define __Pyx_PyObject_Unicode(obj)\
-    (likely(PyUnicode_CheckExact(obj)) ? __Pyx_NewRef(obj) : PyObject_Unicode(obj))
-#endif
-
 /* KeywordStringCheck.proto */
 static int __Pyx_CheckKeywordStrings(PyObject *kwdict, const char* function_name, int kw_allowed);
 
 /* None.proto */
 static CYTHON_INLINE void __Pyx_RaiseClosureNameError(const char *varname);
 
 /* FetchCommonType.proto */
 static PyTypeObject* __Pyx_FetchCommonType(PyTypeObject* type);
 
 /* CythonFunction.proto */
 #define __Pyx_CyFunction_USED 1
+#include <structmember.h>
 #define __Pyx_CYFUNCTION_STATICMETHOD  0x01
 #define __Pyx_CYFUNCTION_CLASSMETHOD   0x02
 #define __Pyx_CYFUNCTION_CCLASS        0x04
 #define __Pyx_CyFunction_GetClosure(f)\
     (((__pyx_CyFunctionObject *) (f))->func_closure)
 #define __Pyx_CyFunction_GetClassObj(f)\
     (((__pyx_CyFunctionObject *) (f))->func_classobj)
@@ -1453,15 +1319,14 @@
     int flags;
     PyObject *defaults_tuple;
     PyObject *defaults_kwdict;
     PyObject *(*defaults_getter)(PyObject *);
     PyObject *func_annotations;
 } __pyx_CyFunctionObject;
 static PyTypeObject *__pyx_CyFunctionType = 0;
-#define __Pyx_CyFunction_Check(obj)  (__Pyx_TypeCheck(obj, __pyx_CyFunctionType))
 #define __Pyx_CyFunction_NewEx(ml, flags, qualname, self, module, globals, code)\
     __Pyx_CyFunction_New(__pyx_CyFunctionType, ml, flags, qualname, self, module, globals, code)
 static PyObject *__Pyx_CyFunction_New(PyTypeObject *, PyMethodDef *ml,
                                       int flags, PyObject* qualname,
                                       PyObject *self,
                                       PyObject *module, PyObject *globals,
                                       PyObject* code);
@@ -1486,31 +1351,36 @@
 static CYTHON_INLINE int __Pyx_IterFinish(void);
 
 /* UnpackItemEndCheck.proto */
 static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected);
 
 /* PyFloatBinop.proto */
 #if !CYTHON_COMPILING_IN_PYPY
-static PyObject* __Pyx_PyFloat_DivideCObj(PyObject *op1, PyObject *op2, double floatval, int inplace, int zerodivision_check);
+static PyObject* __Pyx_PyFloat_DivideCObj(PyObject *op1, PyObject *op2, double floatval, int inplace);
 #else
-#define __Pyx_PyFloat_DivideCObj(op1, op2, floatval, inplace, zerodivision_check)\
+#define __Pyx_PyFloat_DivideCObj(op1, op2, floatval, inplace)\
     ((inplace ? __Pyx_PyNumber_InPlaceDivide(op1, op2) : __Pyx_PyNumber_Divide(op1, op2)))
     #endif
 
 /* pow2.proto */
 #define __Pyx_PyNumber_Power2(a, b) PyNumber_Power(a, b, Py_None)
 
 /* GetAttr.proto */
 static CYTHON_INLINE PyObject *__Pyx_GetAttr(PyObject *, PyObject *);
 
 /* GetAttr3.proto */
 static CYTHON_INLINE PyObject *__Pyx_GetAttr3(PyObject *, PyObject *, PyObject *);
 
-/* PyIntCompare.proto */
-static CYTHON_INLINE PyObject* __Pyx_PyInt_EqObjC(PyObject *op1, PyObject *op2, long intval, long inplace);
+/* PyIntBinop.proto */
+#if !CYTHON_COMPILING_IN_PYPY
+static PyObject* __Pyx_PyInt_EqObjC(PyObject *op1, PyObject *op2, long intval, int inplace);
+#else
+#define __Pyx_PyInt_EqObjC(op1, op2, intval, inplace)\
+    PyObject_RichCompare(op1, op2, Py_EQ)
+    #endif
 
 /* ArgTypeTest.proto */
 #define __Pyx_ArgTypeTest(obj, type, none_allowed, name, exact)\
     ((likely((Py_TYPE(obj) == type) | (none_allowed && (obj == Py_None)))) ? 1 :\
         __Pyx__ArgTypeTest(obj, type, name, exact))
 static int __Pyx__ArgTypeTest(PyObject *obj, PyTypeObject *type, const char *name, int exact);
 
@@ -1522,72 +1392,35 @@
 
 /* ImportFrom.proto */
 static PyObject* __Pyx_ImportFrom(PyObject* module, PyObject* name);
 
 /* HasAttr.proto */
 static CYTHON_INLINE int __Pyx_HasAttr(PyObject *, PyObject *);
 
-/* PyObject_GenericGetAttrNoDict.proto */
-#if CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP && PY_VERSION_HEX < 0x03070000
-static CYTHON_INLINE PyObject* __Pyx_PyObject_GenericGetAttrNoDict(PyObject* obj, PyObject* attr_name);
-#else
-#define __Pyx_PyObject_GenericGetAttrNoDict PyObject_GenericGetAttr
-#endif
-
-/* PyObject_GenericGetAttr.proto */
-#if CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP && PY_VERSION_HEX < 0x03070000
-static PyObject* __Pyx_PyObject_GenericGetAttr(PyObject* obj, PyObject* attr_name);
-#else
-#define __Pyx_PyObject_GenericGetAttr PyObject_GenericGetAttr
-#endif
-
 /* SetVTable.proto */
 static int __Pyx_SetVtable(PyObject *dict, void *vtable);
 
 /* SetupReduce.proto */
 static int __Pyx_setup_reduce(PyObject* type_obj);
 
-/* TypeImport.proto */
-#ifndef __PYX_HAVE_RT_ImportType_proto
-#define __PYX_HAVE_RT_ImportType_proto
-enum __Pyx_ImportType_CheckSize {
-   __Pyx_ImportType_CheckSize_Error = 0,
-   __Pyx_ImportType_CheckSize_Warn = 1,
-   __Pyx_ImportType_CheckSize_Ignore = 2
-};
-static PyTypeObject *__Pyx_ImportType(PyObject* module, const char *module_name, const char *class_name, size_t size, enum __Pyx_ImportType_CheckSize check_size);
-#endif
-
 /* CalculateMetaclass.proto */
 static PyObject *__Pyx_CalculateMetaclass(PyTypeObject *metaclass, PyObject *bases);
 
-/* SetNameInClass.proto */
-#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030500A1
-#define __Pyx_SetNameInClass(ns, name, value)\
-    (likely(PyDict_CheckExact(ns)) ? _PyDict_SetItem_KnownHash(ns, name, value, ((PyASCIIObject *) name)->hash) : PyObject_SetItem(ns, name, value))
-#elif CYTHON_COMPILING_IN_CPYTHON
-#define __Pyx_SetNameInClass(ns, name, value)\
-    (likely(PyDict_CheckExact(ns)) ? PyDict_SetItem(ns, name, value) : PyObject_SetItem(ns, name, value))
-#else
-#define __Pyx_SetNameInClass(ns, name, value)  PyObject_SetItem(ns, name, value)
-#endif
-
 /* ClassMethod.proto */
 #include "descrobject.h"
-static CYTHON_UNUSED PyObject* __Pyx_Method_ClassMethod(PyObject *method);
+static PyObject* __Pyx_Method_ClassMethod(PyObject *method);
 
 /* Py3ClassCreate.proto */
 static PyObject *__Pyx_Py3MetaclassPrepare(PyObject *metaclass, PyObject *bases, PyObject *name, PyObject *qualname,
                                            PyObject *mkw, PyObject *modname, PyObject *doc);
 static PyObject *__Pyx_Py3ClassCreate(PyObject *metaclass, PyObject *name, PyObject *bases, PyObject *dict,
                                       PyObject *mkw, int calculate_metaclass, int allow_py2_metaclass);
 
 /* GetNameInClass.proto */
-#define __Pyx_GetNameInClass(var, nmspace, name)  (var) = __Pyx__GetNameInClass(nmspace, name)
-static PyObject *__Pyx__GetNameInClass(PyObject *nmspace, PyObject *name);
+static PyObject *__Pyx_GetNameInClass(PyObject *nmspace, PyObject *name);
 
 /* CLineInTraceback.proto */
 #ifdef CYTHON_CLINE_IN_TRACEBACK
 #define __Pyx_CLineForTraceback(tstate, c_line)  (((CYTHON_CLINE_IN_TRACEBACK)) ? c_line : 0)
 #else
 static int __Pyx_CLineForTraceback(PyThreadState *tstate, int c_line);
 #endif
@@ -1648,19 +1481,33 @@
 static CYTHON_INLINE int __Pyx_PyErr_GivenExceptionMatches(PyObject *err, PyObject *type);
 static CYTHON_INLINE int __Pyx_PyErr_GivenExceptionMatches2(PyObject *err, PyObject *type1, PyObject *type2);
 #else
 #define __Pyx_TypeCheck(obj, type) PyObject_TypeCheck(obj, (PyTypeObject *)type)
 #define __Pyx_PyErr_GivenExceptionMatches(err, type) PyErr_GivenExceptionMatches(err, type)
 #define __Pyx_PyErr_GivenExceptionMatches2(err, type1, type2) (PyErr_GivenExceptionMatches(err, type1) || PyErr_GivenExceptionMatches(err, type2))
 #endif
-#define __Pyx_PyException_Check(obj) __Pyx_TypeCheck(obj, PyExc_Exception)
 
 /* CheckBinaryVersion.proto */
 static int __Pyx_check_binary_version(void);
 
+/* PyIdentifierFromString.proto */
+#if !defined(__Pyx_PyIdentifier_FromString)
+#if PY_MAJOR_VERSION < 3
+  #define __Pyx_PyIdentifier_FromString(s) PyString_FromString(s)
+#else
+  #define __Pyx_PyIdentifier_FromString(s) PyUnicode_FromString(s)
+#endif
+#endif
+
+/* ModuleImport.proto */
+static PyObject *__Pyx_ImportModule(const char *name);
+
+/* TypeImport.proto */
+static PyTypeObject *__Pyx_ImportType(const char *module_name, const char *class_name, size_t size, int strict);
+
 /* InitStrings.proto */
 static int __Pyx_InitStrings(__Pyx_StringTabEntry *t);
 
 static PyObject *__pyx_f_9playhouse_11_sqlite_ext_18_TableFunctionImpl_create_module(struct __pyx_obj_9playhouse_11_sqlite_ext__TableFunctionImpl *__pyx_v_self, pysqlite_Connection *__pyx_v_sqlite_conn); /* proto*/
 static PyObject *__pyx_f_9playhouse_11_sqlite_ext_4Blob__close(struct __pyx_obj_9playhouse_11_sqlite_ext_Blob *__pyx_v_self); /* proto*/
 
 /* Module declarations from 'cython' */
@@ -1774,15 +1621,15 @@
 static PyTypeObject *__pyx_ptype_9playhouse_11_sqlite_ext___pyx_scope_struct__make_hash = 0;
 static int __pyx_v_9playhouse_11_sqlite_ext_SQLITE_CONSTRAINT;
 static PyObject *__pyx_v_9playhouse_11_sqlite_ext_SQLITE_DATETIME_FORMATS = 0;
 static PyObject *__pyx_v_9playhouse_11_sqlite_ext_SQLITE_DATE_TRUNC_MAPPING = 0;
 static int __pyx_v_9playhouse_11_sqlite_ext_seeds[10];
 static PyObject *__pyx_f_9playhouse_11_sqlite_ext_sqlite_to_python(int, sqlite3_value **); /*proto*/
 static PyObject *__pyx_f_9playhouse_11_sqlite_ext_python_to_sqlite(sqlite3_context *, PyObject *); /*proto*/
-static int __pyx_f_9playhouse_11_sqlite_ext_pwConnect(sqlite3 *, void *, int, char **, sqlite3_vtab **, char **); /*proto*/
+static int __pyx_f_9playhouse_11_sqlite_ext_pwConnect(sqlite3 *, void *, int, char const *const *, sqlite3_vtab **, char **); /*proto*/
 static int __pyx_f_9playhouse_11_sqlite_ext_pwDisconnect(sqlite3_vtab *); /*proto*/
 static int __pyx_f_9playhouse_11_sqlite_ext_pwOpen(sqlite3_vtab *, sqlite3_vtab_cursor **); /*proto*/
 static int __pyx_f_9playhouse_11_sqlite_ext_pwClose(sqlite3_vtab_cursor *); /*proto*/
 static int __pyx_f_9playhouse_11_sqlite_ext_pwNext(sqlite3_vtab_cursor *); /*proto*/
 static int __pyx_f_9playhouse_11_sqlite_ext_pwColumn(sqlite3_vtab_cursor *, sqlite3_context *, int); /*proto*/
 static int __pyx_f_9playhouse_11_sqlite_ext_pwRowid(sqlite3_vtab_cursor *, sqlite3_int64 *); /*proto*/
 static int __pyx_f_9playhouse_11_sqlite_ext_pwEof(sqlite3_vtab_cursor *); /*proto*/
@@ -1797,15 +1644,15 @@
 static PyObject *__pyx_f_9playhouse_11_sqlite_ext_bf_add(__pyx_t_9playhouse_11_sqlite_ext_bf_t *, unsigned char *); /*proto*/
 static int __pyx_f_9playhouse_11_sqlite_ext_bf_contains(__pyx_t_9playhouse_11_sqlite_ext_bf_t *, unsigned char *); /*proto*/
 static PyObject *__pyx_f_9playhouse_11_sqlite_ext_bf_free(__pyx_t_9playhouse_11_sqlite_ext_bf_t *); /*proto*/
 static CYTHON_INLINE int __pyx_f_9playhouse_11_sqlite_ext__check_connection(pysqlite_Connection *); /*proto*/
 static CYTHON_INLINE int __pyx_f_9playhouse_11_sqlite_ext__check_blob_closed(struct __pyx_obj_9playhouse_11_sqlite_ext_Blob *); /*proto*/
 static int __pyx_f_9playhouse_11_sqlite_ext__commit_callback(void *); /*proto*/
 static void __pyx_f_9playhouse_11_sqlite_ext__rollback_callback(void *); /*proto*/
-static void __pyx_f_9playhouse_11_sqlite_ext__update_callback(void *, int, char *, char *, sqlite3_int64); /*proto*/
+static void __pyx_f_9playhouse_11_sqlite_ext__update_callback(void *, int, char const *, char const *, sqlite3_int64); /*proto*/
 static int __pyx_f_9playhouse_11_sqlite_ext__aggressive_busy_handler(void *, int); /*proto*/
 static PyObject *__pyx_f_9playhouse_11_sqlite_ext___pyx_unpickle_BloomFilterAggregate__set_state(struct __pyx_obj_9playhouse_11_sqlite_ext_BloomFilterAggregate *, PyObject *); /*proto*/
 #define __Pyx_MODULE_NAME "playhouse._sqlite_ext"
 extern int __pyx_module_is_main_playhouse___sqlite_ext;
 int __pyx_module_is_main_playhouse___sqlite_ext = 0;
 
 /* Implementation of 'playhouse._sqlite_ext' */
@@ -1820,27 +1667,27 @@
 static const char __pyx_k_[] = ",";
 static const char __pyx_k_B[] = "B";
 static const char __pyx_k_K[] = "K";
 static const char __pyx_k_Y[] = "%Y";
 static const char __pyx_k_n[] = "n";
 static const char __pyx_k_p[] = "p";
 static const char __pyx_k_x[] = "x";
-static const char __pyx_k__5[] = ", ";
+static const char __pyx_k__6[] = ", ";
 static const char __pyx_k_bf[] = "bf";
 static const char __pyx_k_rc[] = "rc";
 static const char __pyx_k_tf[] = "tf";
 static const char __pyx_k_A_O[] = "A_O";
 static const char __pyx_k_C_O[] = "C_O";
 static const char __pyx_k_H_M[] = "%H:%M";
 static const char __pyx_k_L_O[] = "L_O";
 static const char __pyx_k_N_O[] = "N_O";
 static const char __pyx_k_P_O[] = "P_O";
 static const char __pyx_k_X_O[] = "X_O";
 static const char __pyx_k_Y_m[] = "%Y-%m";
-static const char __pyx_k__12[] = "";
+static const char __pyx_k__17[] = "";
 static const char __pyx_k_add[] = "add";
 static const char __pyx_k_cls[] = "cls";
 static const char __pyx_k_ctx[] = "ctx";
 static const char __pyx_k_day[] = "day";
 static const char __pyx_k_doc[] = "__doc__";
 static const char __pyx_k_idf[] = "idf";
 static const char __pyx_k_idx[] = "idx";
@@ -1849,15 +1696,14 @@
 static const char __pyx_k_new[] = "__new__";
 static const char __pyx_k_num[] = "num";
 static const char __pyx_k_rhs[] = "rhs";
 static const char __pyx_k_s_s[] = "%s %s";
 static const char __pyx_k_sql[] = "__sql__";
 static const char __pyx_k_src[] = "src";
 static const char __pyx_k_3_26[] = "3.26";
-static const char __pyx_k_Blob[] = "Blob";
 static const char __pyx_k_Node[] = "Node";
 static const char __pyx_k_bkey[] = "bkey";
 static const char __pyx_k_conn[] = "conn";
 static const char __pyx_k_data[] = "data";
 static const char __pyx_k_dest[] = "dest";
 static const char __pyx_k_dict[] = "__dict__";
 static const char __pyx_k_flag[] = "flag";
@@ -1997,15 +1843,14 @@
 static const char __pyx_k_murmurhash[] = "murmurhash";
 static const char __pyx_k_page_count[] = "page_count";
 static const char __pyx_k_peewee_md5[] = "peewee_md5";
 static const char __pyx_k_pyx_result[] = "__pyx_result";
 static const char __pyx_k_pyx_vtable[] = "__pyx_vtable__";
 static const char __pyx_k_total_docs[] = "total_docs";
 static const char __pyx_k_zeroblob_s[] = "zeroblob(%s)";
-static const char __pyx_k_BloomFilter[] = "BloomFilter";
 static const char __pyx_k_MemoryError[] = "MemoryError";
 static const char __pyx_k_PickleError[] = "PickleError";
 static const char __pyx_k_Y_m_d_H_M_S[] = "%Y-%m-%d %H:%M:%S";
 static const char __pyx_k_bloomfilter[] = "bloomfilter";
 static const char __pyx_k_global_hits[] = "global_hits";
 static const char __pyx_k_no_row_data[] = "no row data";
 static const char __pyx_k_peewee_bm25[] = "peewee_bm25";
@@ -2031,30 +1876,27 @@
 static const char __pyx_k_match_info_buf[] = "_match_info_buf";
 static const char __pyx_k_table_function[] = "table_function";
 static const char __pyx_k_term_frequency[] = "term_frequency";
 static const char __pyx_k_ZeroBlob___init[] = "ZeroBlob.__init__";
 static const char __pyx_k_pyx_PickleError[] = "__pyx_PickleError";
 static const char __pyx_k_setstate_cython[] = "__setstate_cython__";
 static const char __pyx_k_CREATE_TABLE_x_s[] = "CREATE TABLE x(%s);";
-static const char __pyx_k_ConnectionHelper[] = "ConnectionHelper";
 static const char __pyx_k_OperationalError[] = "OperationalError";
 static const char __pyx_k_match_info_buf_2[] = "match_info_buf";
 static const char __pyx_k_print_tracebacks[] = "print_tracebacks";
-static const char __pyx_k_TableFunctionImpl[] = "_TableFunctionImpl";
 static const char __pyx_k_peewee_murmurhash[] = "peewee_murmurhash";
 static const char __pyx_k_register_function[] = "register_function";
 static const char __pyx_k_sqlite_get_status[] = "sqlite_get_status";
 static const char __pyx_k_Unsupported_type_s[] = "Unsupported type %s";
 static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
 static const char __pyx_k_frame_of_reference[] = "frame_of_reference";
 static const char __pyx_k_register_aggregate[] = "register_aggregate";
 static const char __pyx_k_register_functions[] = "_register_functions";
 static const char __pyx_k_NotImplementedError[] = "NotImplementedError";
 static const char __pyx_k_Unable_to_open_blob[] = "Unable to open blob.";
-static const char __pyx_k_BloomFilterAggregate[] = "BloomFilterAggregate";
 static const char __pyx_k_bloomfilter_contains[] = "bloomfilter_contains";
 static const char __pyx_k_register_bloomfilter[] = "register_bloomfilter";
 static const char __pyx_k_sqlite_get_db_status[] = "sqlite_get_db_status";
 static const char __pyx_k_Error_writing_to_blob[] = "Error writing to blob.";
 static const char __pyx_k_TableFunction_iterate[] = "TableFunction.iterate";
 static const char __pyx_k_USE_SQLITE_CONSTRAINT[] = "USE_SQLITE_CONSTRAINT";
 static const char __pyx_k_playhouse__sqlite_ext[] = "playhouse._sqlite_ext";
@@ -2091,23 +1933,19 @@
 static const char __pyx_k_self_conn_cannot_be_converted_to[] = "self.conn cannot be converted to a Python object for pickling";
 static const char __pyx_k_self_conn_self_pBlob_cannot_be_c[] = "self.conn,self.pBlob cannot be converted to a Python object for pickling";
 static PyObject *__pyx_kp_s_;
 static PyObject *__pyx_kp_b_3_26;
 static PyObject *__pyx_n_s_A_O;
 static PyObject *__pyx_n_s_B;
 static PyObject *__pyx_n_s_Binary;
-static PyObject *__pyx_n_s_Blob;
-static PyObject *__pyx_n_s_BloomFilter;
-static PyObject *__pyx_n_s_BloomFilterAggregate;
 static PyObject *__pyx_kp_s_CREATE_TABLE_x_s;
 static PyObject *__pyx_n_s_C_O;
 static PyObject *__pyx_kp_s_Cannot_operate_on_closed_blob;
 static PyObject *__pyx_kp_s_Cannot_operate_on_closed_databas;
 static PyObject *__pyx_kp_s_Column_must_be_either_a_string_o;
-static PyObject *__pyx_n_s_ConnectionHelper;
 static PyObject *__pyx_n_s_DELETE;
 static PyObject *__pyx_kp_s_Data_is_too_large_integer_wrap;
 static PyObject *__pyx_kp_s_Data_would_go_beyond_end_of_blob;
 static PyObject *__pyx_kp_s_Error_backuping_up_database_s;
 static PyObject *__pyx_kp_s_Error_reading_from_blob;
 static PyObject *__pyx_kp_s_Error_requesting_db_status_s;
 static PyObject *__pyx_kp_s_Error_requesting_status_s;
@@ -2126,15 +1964,14 @@
 static PyObject *__pyx_n_s_Node;
 static PyObject *__pyx_n_s_NotImplementedError;
 static PyObject *__pyx_n_s_OperationalError;
 static PyObject *__pyx_n_s_P_O;
 static PyObject *__pyx_n_s_PickleError;
 static PyObject *__pyx_n_s_StopIteration;
 static PyObject *__pyx_n_s_TableFunction;
-static PyObject *__pyx_n_s_TableFunctionImpl;
 static PyObject *__pyx_n_s_TableFunction_get_table_columns;
 static PyObject *__pyx_n_s_TableFunction_initialize;
 static PyObject *__pyx_n_s_TableFunction_iterate;
 static PyObject *__pyx_n_s_TableFunction_register;
 static PyObject *__pyx_n_s_TypeError;
 static PyObject *__pyx_n_s_UPDATE;
 static PyObject *__pyx_n_s_USE_SQLITE_CONSTRAINT;
@@ -2151,17 +1988,17 @@
 static PyObject *__pyx_kp_s_Y_m_d_H;
 static PyObject *__pyx_kp_s_Y_m_d_H_M;
 static PyObject *__pyx_kp_s_Y_m_d_H_M_S;
 static PyObject *__pyx_kp_s_Y_m_d_H_M_S_f;
 static PyObject *__pyx_n_s_ZeroBlob;
 static PyObject *__pyx_n_s_ZeroBlob___init;
 static PyObject *__pyx_n_s_ZeroBlob___sql;
-static PyObject *__pyx_kp_b__12;
-static PyObject *__pyx_kp_s__12;
-static PyObject *__pyx_kp_s__5;
+static PyObject *__pyx_kp_b__17;
+static PyObject *__pyx_kp_s__17;
+static PyObject *__pyx_kp_s__6;
 static PyObject *__pyx_n_s_accum;
 static PyObject *__pyx_n_s_add;
 static PyObject *__pyx_n_s_adler32;
 static PyObject *__pyx_n_s_avg_length;
 static PyObject *__pyx_n_s_b_part;
 static PyObject *__pyx_n_s_backup;
 static PyObject *__pyx_n_s_backup_to_file;
@@ -2440,77 +2277,87 @@
 static PyObject *__pyx_int_5;
 static PyObject *__pyx_int_1000;
 static PyObject *__pyx_int_32768;
 static PyObject *__pyx_int_211787133;
 static PyObject *__pyx_tuple__2;
 static PyObject *__pyx_tuple__3;
 static PyObject *__pyx_tuple__4;
-static PyObject *__pyx_tuple__6;
+static PyObject *__pyx_tuple__5;
+static PyObject *__pyx_tuple__7;
 static PyObject *__pyx_tuple__8;
-static PyObject *__pyx_tuple__9;
 static PyObject *__pyx_tuple__10;
 static PyObject *__pyx_tuple__11;
+static PyObject *__pyx_tuple__12;
 static PyObject *__pyx_tuple__13;
 static PyObject *__pyx_tuple__14;
 static PyObject *__pyx_tuple__15;
 static PyObject *__pyx_tuple__16;
-static PyObject *__pyx_tuple__17;
 static PyObject *__pyx_tuple__18;
 static PyObject *__pyx_tuple__19;
 static PyObject *__pyx_tuple__20;
 static PyObject *__pyx_tuple__21;
 static PyObject *__pyx_tuple__22;
+static PyObject *__pyx_tuple__23;
 static PyObject *__pyx_tuple__24;
+static PyObject *__pyx_tuple__25;
 static PyObject *__pyx_tuple__26;
+static PyObject *__pyx_tuple__27;
 static PyObject *__pyx_tuple__28;
+static PyObject *__pyx_tuple__29;
 static PyObject *__pyx_tuple__30;
 static PyObject *__pyx_tuple__31;
+static PyObject *__pyx_tuple__32;
 static PyObject *__pyx_tuple__33;
 static PyObject *__pyx_tuple__35;
 static PyObject *__pyx_tuple__37;
 static PyObject *__pyx_tuple__39;
 static PyObject *__pyx_tuple__41;
-static PyObject *__pyx_tuple__43;
-static PyObject *__pyx_tuple__45;
-static PyObject *__pyx_tuple__47;
-static PyObject *__pyx_tuple__49;
-static PyObject *__pyx_tuple__51;
-static PyObject *__pyx_tuple__53;
-static PyObject *__pyx_tuple__55;
-static PyObject *__pyx_tuple__57;
-static PyObject *__pyx_tuple__59;
-static PyObject *__pyx_tuple__61;
-static PyObject *__pyx_tuple__63;
-static PyObject *__pyx_tuple__65;
-static PyObject *__pyx_tuple__67;
-static PyObject *__pyx_codeobj__7;
-static PyObject *__pyx_codeobj__23;
-static PyObject *__pyx_codeobj__25;
-static PyObject *__pyx_codeobj__27;
-static PyObject *__pyx_codeobj__29;
-static PyObject *__pyx_codeobj__32;
+static PyObject *__pyx_tuple__42;
+static PyObject *__pyx_tuple__44;
+static PyObject *__pyx_tuple__46;
+static PyObject *__pyx_tuple__48;
+static PyObject *__pyx_tuple__50;
+static PyObject *__pyx_tuple__52;
+static PyObject *__pyx_tuple__54;
+static PyObject *__pyx_tuple__56;
+static PyObject *__pyx_tuple__58;
+static PyObject *__pyx_tuple__60;
+static PyObject *__pyx_tuple__62;
+static PyObject *__pyx_tuple__64;
+static PyObject *__pyx_tuple__66;
+static PyObject *__pyx_tuple__68;
+static PyObject *__pyx_tuple__70;
+static PyObject *__pyx_tuple__72;
+static PyObject *__pyx_tuple__74;
+static PyObject *__pyx_tuple__76;
+static PyObject *__pyx_tuple__78;
+static PyObject *__pyx_codeobj__9;
 static PyObject *__pyx_codeobj__34;
 static PyObject *__pyx_codeobj__36;
 static PyObject *__pyx_codeobj__38;
 static PyObject *__pyx_codeobj__40;
-static PyObject *__pyx_codeobj__42;
-static PyObject *__pyx_codeobj__44;
-static PyObject *__pyx_codeobj__46;
-static PyObject *__pyx_codeobj__48;
-static PyObject *__pyx_codeobj__50;
-static PyObject *__pyx_codeobj__52;
-static PyObject *__pyx_codeobj__54;
-static PyObject *__pyx_codeobj__56;
-static PyObject *__pyx_codeobj__58;
-static PyObject *__pyx_codeobj__60;
-static PyObject *__pyx_codeobj__62;
-static PyObject *__pyx_codeobj__64;
-static PyObject *__pyx_codeobj__66;
-static PyObject *__pyx_codeobj__68;
-/* Late includes */
+static PyObject *__pyx_codeobj__43;
+static PyObject *__pyx_codeobj__45;
+static PyObject *__pyx_codeobj__47;
+static PyObject *__pyx_codeobj__49;
+static PyObject *__pyx_codeobj__51;
+static PyObject *__pyx_codeobj__53;
+static PyObject *__pyx_codeobj__55;
+static PyObject *__pyx_codeobj__57;
+static PyObject *__pyx_codeobj__59;
+static PyObject *__pyx_codeobj__61;
+static PyObject *__pyx_codeobj__63;
+static PyObject *__pyx_codeobj__65;
+static PyObject *__pyx_codeobj__67;
+static PyObject *__pyx_codeobj__69;
+static PyObject *__pyx_codeobj__71;
+static PyObject *__pyx_codeobj__73;
+static PyObject *__pyx_codeobj__75;
+static PyObject *__pyx_codeobj__77;
+static PyObject *__pyx_codeobj__79;
 
 /* "playhouse/_sqlite_ext.pyx":296
  * 
  * 
  * cdef sqlite_to_python(int argc, sqlite3_value **params):             # <<<<<<<<<<<<<<
  *     cdef:
  *         int i
@@ -2524,15 +2371,14 @@
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_t_2;
   int __pyx_t_3;
   int __pyx_t_4;
   int __pyx_t_5;
-  int __pyx_t_6;
   __Pyx_RefNannySetupContext("sqlite_to_python", 0);
 
   /* "playhouse/_sqlite_ext.pyx":300
  *         int i
  *         int vtype
  *         list pyargs = []             # <<<<<<<<<<<<<<
  * 
@@ -2547,17 +2393,16 @@
  *         list pyargs = []
  * 
  *     for i in range(argc):             # <<<<<<<<<<<<<<
  *         vtype = sqlite3_value_type(params[i])
  *         if vtype == SQLITE_INTEGER:
  */
   __pyx_t_2 = __pyx_v_argc;
-  __pyx_t_3 = __pyx_t_2;
-  for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
-    __pyx_v_i = __pyx_t_4;
+  for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
+    __pyx_v_i = __pyx_t_3;
 
     /* "playhouse/_sqlite_ext.pyx":303
  * 
  *     for i in range(argc):
  *         vtype = sqlite3_value_type(params[i])             # <<<<<<<<<<<<<<
  *         if vtype == SQLITE_INTEGER:
  *             pyval = sqlite3_value_int(params[i])
@@ -2567,16 +2412,16 @@
     /* "playhouse/_sqlite_ext.pyx":304
  *     for i in range(argc):
  *         vtype = sqlite3_value_type(params[i])
  *         if vtype == SQLITE_INTEGER:             # <<<<<<<<<<<<<<
  *             pyval = sqlite3_value_int(params[i])
  *         elif vtype == SQLITE_FLOAT:
  */
-    __pyx_t_5 = ((__pyx_v_vtype == SQLITE_INTEGER) != 0);
-    if (__pyx_t_5) {
+    __pyx_t_4 = ((__pyx_v_vtype == SQLITE_INTEGER) != 0);
+    if (__pyx_t_4) {
 
       /* "playhouse/_sqlite_ext.pyx":305
  *         vtype = sqlite3_value_type(params[i])
  *         if vtype == SQLITE_INTEGER:
  *             pyval = sqlite3_value_int(params[i])             # <<<<<<<<<<<<<<
  *         elif vtype == SQLITE_FLOAT:
  *             pyval = sqlite3_value_double(params[i])
@@ -2599,16 +2444,16 @@
     /* "playhouse/_sqlite_ext.pyx":306
  *         if vtype == SQLITE_INTEGER:
  *             pyval = sqlite3_value_int(params[i])
  *         elif vtype == SQLITE_FLOAT:             # <<<<<<<<<<<<<<
  *             pyval = sqlite3_value_double(params[i])
  *         elif vtype == SQLITE_TEXT:
  */
-    __pyx_t_5 = ((__pyx_v_vtype == SQLITE_FLOAT) != 0);
-    if (__pyx_t_5) {
+    __pyx_t_4 = ((__pyx_v_vtype == SQLITE_FLOAT) != 0);
+    if (__pyx_t_4) {
 
       /* "playhouse/_sqlite_ext.pyx":307
  *             pyval = sqlite3_value_int(params[i])
  *         elif vtype == SQLITE_FLOAT:
  *             pyval = sqlite3_value_double(params[i])             # <<<<<<<<<<<<<<
  *         elif vtype == SQLITE_TEXT:
  *             pyval = PyUnicode_DecodeUTF8(
@@ -2631,16 +2476,16 @@
     /* "playhouse/_sqlite_ext.pyx":308
  *         elif vtype == SQLITE_FLOAT:
  *             pyval = sqlite3_value_double(params[i])
  *         elif vtype == SQLITE_TEXT:             # <<<<<<<<<<<<<<
  *             pyval = PyUnicode_DecodeUTF8(
  *                 <const char *>sqlite3_value_text(params[i]),
  */
-    __pyx_t_5 = ((__pyx_v_vtype == SQLITE_TEXT) != 0);
-    if (__pyx_t_5) {
+    __pyx_t_4 = ((__pyx_v_vtype == SQLITE_TEXT) != 0);
+    if (__pyx_t_4) {
 
       /* "playhouse/_sqlite_ext.pyx":309
  *             pyval = sqlite3_value_double(params[i])
  *         elif vtype == SQLITE_TEXT:
  *             pyval = PyUnicode_DecodeUTF8(             # <<<<<<<<<<<<<<
  *                 <const char *>sqlite3_value_text(params[i]),
  *                 <Py_ssize_t>sqlite3_value_bytes(params[i]), NULL)
@@ -2663,16 +2508,16 @@
     /* "playhouse/_sqlite_ext.pyx":312
  *                 <const char *>sqlite3_value_text(params[i]),
  *                 <Py_ssize_t>sqlite3_value_bytes(params[i]), NULL)
  *         elif vtype == SQLITE_BLOB:             # <<<<<<<<<<<<<<
  *             pyval = PyBytes_FromStringAndSize(
  *                 <const char *>sqlite3_value_blob(params[i]),
  */
-    __pyx_t_5 = ((__pyx_v_vtype == SQLITE_BLOB) != 0);
-    if (__pyx_t_5) {
+    __pyx_t_4 = ((__pyx_v_vtype == SQLITE_BLOB) != 0);
+    if (__pyx_t_4) {
 
       /* "playhouse/_sqlite_ext.pyx":313
  *                 <Py_ssize_t>sqlite3_value_bytes(params[i]), NULL)
  *         elif vtype == SQLITE_BLOB:
  *             pyval = PyBytes_FromStringAndSize(             # <<<<<<<<<<<<<<
  *                 <const char *>sqlite3_value_blob(params[i]),
  *                 <Py_ssize_t>sqlite3_value_bytes(params[i]))
@@ -2695,16 +2540,16 @@
     /* "playhouse/_sqlite_ext.pyx":316
  *                 <const char *>sqlite3_value_blob(params[i]),
  *                 <Py_ssize_t>sqlite3_value_bytes(params[i]))
  *         elif vtype == SQLITE_NULL:             # <<<<<<<<<<<<<<
  *             pyval = None
  *         else:
  */
-    __pyx_t_5 = ((__pyx_v_vtype == SQLITE_NULL) != 0);
-    if (__pyx_t_5) {
+    __pyx_t_4 = ((__pyx_v_vtype == SQLITE_NULL) != 0);
+    if (__pyx_t_4) {
 
       /* "playhouse/_sqlite_ext.pyx":317
  *                 <Py_ssize_t>sqlite3_value_bytes(params[i]))
  *         elif vtype == SQLITE_NULL:
  *             pyval = None             # <<<<<<<<<<<<<<
  *         else:
  *             pyval = None
@@ -2738,15 +2583,15 @@
     /* "playhouse/_sqlite_ext.pyx":321
  *             pyval = None
  * 
  *         pyargs.append(pyval)             # <<<<<<<<<<<<<<
  * 
  *     return pyargs
  */
-    __pyx_t_6 = __Pyx_PyList_Append(__pyx_v_pyargs, __pyx_v_pyval); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 321, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyList_Append(__pyx_v_pyargs, __pyx_v_pyval); if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 321, __pyx_L1_error)
   }
 
   /* "playhouse/_sqlite_ext.pyx":323
  *         pyargs.append(pyval)
  * 
  *     return pyargs             # <<<<<<<<<<<<<<
  * 
@@ -3092,15 +2937,15 @@
     /* "playhouse/_sqlite_ext.pyx":356
  *         sqlite3_result_error(
  *             context,
  *             encode('Unsupported type %s' % type(value)),             # <<<<<<<<<<<<<<
  *             -1)
  *         return SQLITE_ERROR
  */
-    __pyx_t_6 = __Pyx_PyString_FormatSafe(__pyx_kp_s_Unsupported_type_s, ((PyObject *)Py_TYPE(__pyx_v_value))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 356, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyString_Format(__pyx_kp_s_Unsupported_type_s, ((PyObject *)Py_TYPE(__pyx_v_value))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 356, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_11 = __pyx_f_9playhouse_11_sqlite_ext_encode(__pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 356, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     if (unlikely(__pyx_t_11 == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "expected bytes, NoneType found");
       __PYX_ERR(0, 356, __pyx_L1_error)
@@ -3167,20 +3012,20 @@
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* "playhouse/_sqlite_ext.pyx":388
  * # We define an xConnect function, but leave xCreate NULL so that the
  * # table-function can be called eponymously.
- * cdef int pwConnect(sqlite3 *db, void *pAux, int argc, char **argv,             # <<<<<<<<<<<<<<
+ * cdef int pwConnect(sqlite3 *db, void *pAux, int argc, const char *const*argv,             # <<<<<<<<<<<<<<
  *                    sqlite3_vtab **ppVtab, char **pzErr) with gil:
  *     cdef:
  */
 
-static int __pyx_f_9playhouse_11_sqlite_ext_pwConnect(sqlite3 *__pyx_v_db, void *__pyx_v_pAux, CYTHON_UNUSED int __pyx_v_argc, CYTHON_UNUSED char **__pyx_v_argv, sqlite3_vtab **__pyx_v_ppVtab, CYTHON_UNUSED char **__pyx_v_pzErr) {
+static int __pyx_f_9playhouse_11_sqlite_ext_pwConnect(sqlite3 *__pyx_v_db, void *__pyx_v_pAux, CYTHON_UNUSED int __pyx_v_argc, CYTHON_UNUSED char const *const *__pyx_v_argv, sqlite3_vtab **__pyx_v_ppVtab, CYTHON_UNUSED char **__pyx_v_pzErr) {
   int __pyx_v_rc;
   PyObject *__pyx_v_table_func_cls = 0;
   __pyx_t_9playhouse_11_sqlite_ext_peewee_vtab *__pyx_v_pNew;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
@@ -3192,22 +3037,31 @@
   #endif
   __Pyx_RefNannySetupContext("pwConnect", 0);
 
   /* "playhouse/_sqlite_ext.pyx":392
  *     cdef:
  *         int rc
  *         object table_func_cls = <object>pAux             # <<<<<<<<<<<<<<
- *         peewee_vtab *pNew
+ *         peewee_vtab *pNew = <peewee_vtab *>0
  * 
  */
   __pyx_t_1 = ((PyObject *)__pyx_v_pAux);
   __Pyx_INCREF(__pyx_t_1);
   __pyx_v_table_func_cls = __pyx_t_1;
   __pyx_t_1 = 0;
 
+  /* "playhouse/_sqlite_ext.pyx":393
+ *         int rc
+ *         object table_func_cls = <object>pAux
+ *         peewee_vtab *pNew = <peewee_vtab *>0             # <<<<<<<<<<<<<<
+ * 
+ *     rc = sqlite3_declare_vtab(
+ */
+  __pyx_v_pNew = ((__pyx_t_9playhouse_11_sqlite_ext_peewee_vtab *)0);
+
   /* "playhouse/_sqlite_ext.pyx":398
  *         db,
  *         encode('CREATE TABLE x(%s);' %
  *                table_func_cls.get_table_columns_declaration()))             # <<<<<<<<<<<<<<
  *     if rc == SQLITE_OK:
  *         pNew = <peewee_vtab *>sqlite3_malloc(sizeof(pNew[0]))
  */
@@ -3219,41 +3073,44 @@
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
-  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 398, __pyx_L1_error)
+  if (__pyx_t_3) {
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 398, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  } else {
+    __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 398, __pyx_L1_error)
+  }
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "playhouse/_sqlite_ext.pyx":397
  *     rc = sqlite3_declare_vtab(
  *         db,
  *         encode('CREATE TABLE x(%s);' %             # <<<<<<<<<<<<<<
  *                table_func_cls.get_table_columns_declaration()))
  *     if rc == SQLITE_OK:
  */
-  __pyx_t_2 = __Pyx_PyString_FormatSafe(__pyx_kp_s_CREATE_TABLE_x_s, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 397, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyString_Format(__pyx_kp_s_CREATE_TABLE_x_s, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 397, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = __pyx_f_9playhouse_11_sqlite_ext_encode(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 397, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (unlikely(__pyx_t_1 == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "expected bytes, NoneType found");
     __PYX_ERR(0, 397, __pyx_L1_error)
   }
   __pyx_t_4 = __Pyx_PyBytes_AsString(__pyx_t_1); if (unlikely((!__pyx_t_4) && PyErr_Occurred())) __PYX_ERR(0, 397, __pyx_L1_error)
 
   /* "playhouse/_sqlite_ext.pyx":395
- *         peewee_vtab *pNew
+ *         peewee_vtab *pNew = <peewee_vtab *>0
  * 
  *     rc = sqlite3_declare_vtab(             # <<<<<<<<<<<<<<
  *         db,
  *         encode('CREATE TABLE x(%s);' %
  */
   __pyx_v_rc = sqlite3_declare_vtab(__pyx_v_db, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -3280,15 +3137,15 @@
     /* "playhouse/_sqlite_ext.pyx":401
  *     if rc == SQLITE_OK:
  *         pNew = <peewee_vtab *>sqlite3_malloc(sizeof(pNew[0]))
  *         memset(<char *>pNew, 0, sizeof(pNew[0]))             # <<<<<<<<<<<<<<
  *         ppVtab[0] = &(pNew.base)
  * 
  */
-    (void)(memset(((char *)__pyx_v_pNew), 0, (sizeof((__pyx_v_pNew[0])))));
+    memset(((char *)__pyx_v_pNew), 0, (sizeof((__pyx_v_pNew[0]))));
 
     /* "playhouse/_sqlite_ext.pyx":402
  *         pNew = <peewee_vtab *>sqlite3_malloc(sizeof(pNew[0]))
  *         memset(<char *>pNew, 0, sizeof(pNew[0]))
  *         ppVtab[0] = &(pNew.base)             # <<<<<<<<<<<<<<
  * 
  *         pNew.table_func_cls = <void *>table_func_cls
@@ -3331,15 +3188,15 @@
  */
   __pyx_r = __pyx_v_rc;
   goto __pyx_L0;
 
   /* "playhouse/_sqlite_ext.pyx":388
  * # We define an xConnect function, but leave xCreate NULL so that the
  * # table-function can be called eponymously.
- * cdef int pwConnect(sqlite3 *db, void *pAux, int argc, char **argv,             # <<<<<<<<<<<<<<
+ * cdef int pwConnect(sqlite3 *db, void *pAux, int argc, const char *const*argv,             # <<<<<<<<<<<<<<
  *                    sqlite3_vtab **ppVtab, char **pzErr) with gil:
  *     cdef:
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
@@ -3472,22 +3329,31 @@
   #endif
   __Pyx_RefNannySetupContext("pwOpen", 0);
 
   /* "playhouse/_sqlite_ext.pyx":424
  * cdef int pwOpen(sqlite3_vtab *pBase, sqlite3_vtab_cursor **ppCursor) with gil:
  *     cdef:
  *         peewee_vtab *pVtab = <peewee_vtab *>pBase             # <<<<<<<<<<<<<<
- *         peewee_cursor *pCur
+ *         peewee_cursor *pCur = <peewee_cursor *>0
  *         object table_func_cls = <object>pVtab.table_func_cls
  */
   __pyx_v_pVtab = ((__pyx_t_9playhouse_11_sqlite_ext_peewee_vtab *)__pyx_v_pBase);
 
+  /* "playhouse/_sqlite_ext.pyx":425
+ *     cdef:
+ *         peewee_vtab *pVtab = <peewee_vtab *>pBase
+ *         peewee_cursor *pCur = <peewee_cursor *>0             # <<<<<<<<<<<<<<
+ *         object table_func_cls = <object>pVtab.table_func_cls
+ * 
+ */
+  __pyx_v_pCur = ((__pyx_t_9playhouse_11_sqlite_ext_peewee_cursor *)0);
+
   /* "playhouse/_sqlite_ext.pyx":426
  *         peewee_vtab *pVtab = <peewee_vtab *>pBase
- *         peewee_cursor *pCur
+ *         peewee_cursor *pCur = <peewee_cursor *>0
  *         object table_func_cls = <object>pVtab.table_func_cls             # <<<<<<<<<<<<<<
  * 
  *     pCur = <peewee_cursor *>sqlite3_malloc(sizeof(pCur[0]))
  */
   __pyx_t_1 = ((PyObject *)__pyx_v_pVtab->table_func_cls);
   __Pyx_INCREF(__pyx_t_1);
   __pyx_v_table_func_cls = __pyx_t_1;
@@ -3505,15 +3371,15 @@
   /* "playhouse/_sqlite_ext.pyx":429
  * 
  *     pCur = <peewee_cursor *>sqlite3_malloc(sizeof(pCur[0]))
  *     memset(<char *>pCur, 0, sizeof(pCur[0]))             # <<<<<<<<<<<<<<
  *     ppCursor[0] = &(pCur.base)
  *     pCur.idx = 0
  */
-  (void)(memset(((char *)__pyx_v_pCur), 0, (sizeof((__pyx_v_pCur[0])))));
+  memset(((char *)__pyx_v_pCur), 0, (sizeof((__pyx_v_pCur[0]))));
 
   /* "playhouse/_sqlite_ext.pyx":430
  *     pCur = <peewee_cursor *>sqlite3_malloc(sizeof(pCur[0]))
  *     memset(<char *>pCur, 0, sizeof(pCur[0]))
  *     ppCursor[0] = &(pCur.base)             # <<<<<<<<<<<<<<
  *     pCur.idx = 0
  *     try:
@@ -3559,17 +3425,20 @@
         if (likely(__pyx_t_6)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
           __Pyx_INCREF(__pyx_t_6);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_5, function);
         }
       }
-      __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6) : __Pyx_PyObject_CallNoArg(__pyx_t_5);
-      __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 433, __pyx_L3_error)
+      if (__pyx_t_6) {
+        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 433, __pyx_L3_error)
+        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      } else {
+        __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 433, __pyx_L3_error)
+      }
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_v_table_func = __pyx_t_1;
       __pyx_t_1 = 0;
 
       /* "playhouse/_sqlite_ext.pyx":432
  *     ppCursor[0] = &(pCur.base)
@@ -3580,17 +3449,17 @@
  */
     }
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
-    __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
 
     /* "playhouse/_sqlite_ext.pyx":434
  *     try:
  *         table_func = table_func_cls()
  *     except:             # <<<<<<<<<<<<<<
  *         if table_func_cls.print_tracebacks:
  *             traceback.print_exc()
@@ -3618,32 +3487,35 @@
         /* "playhouse/_sqlite_ext.pyx":436
  *     except:
  *         if table_func_cls.print_tracebacks:
  *             traceback.print_exc()             # <<<<<<<<<<<<<<
  *         sqlite3_free(pCur)
  *         return SQLITE_ERROR
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_traceback); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 436, __pyx_L5_except_error)
+        __pyx_t_9 = __Pyx_GetModuleGlobalName(__pyx_n_s_traceback); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 436, __pyx_L5_except_error)
         __Pyx_GOTREF(__pyx_t_9);
         __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_print_exc); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 436, __pyx_L5_except_error)
         __Pyx_GOTREF(__pyx_t_10);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         __pyx_t_9 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_10))) {
           __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_10);
           if (likely(__pyx_t_9)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
             __Pyx_INCREF(__pyx_t_9);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_10, function);
           }
         }
-        __pyx_t_7 = (__pyx_t_9) ? __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_9) : __Pyx_PyObject_CallNoArg(__pyx_t_10);
-        __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-        if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 436, __pyx_L5_except_error)
+        if (__pyx_t_9) {
+          __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 436, __pyx_L5_except_error)
+          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+        } else {
+          __pyx_t_7 = __Pyx_PyObject_CallNoArg(__pyx_t_10); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 436, __pyx_L5_except_error)
+        }
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
         /* "playhouse/_sqlite_ext.pyx":435
  *         table_func = table_func_cls()
  *     except:
@@ -3867,16 +3739,16 @@
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
-  int __pyx_t_9;
-  PyObject *__pyx_t_10 = NULL;
+  PyObject *__pyx_t_9 = NULL;
+  int __pyx_t_10;
   PyObject *__pyx_t_11 = NULL;
   #ifdef WITH_THREAD
   PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
   #endif
   __Pyx_RefNannySetupContext("pwNext", 0);
 
   /* "playhouse/_sqlite_ext.pyx":459
@@ -3973,19 +3845,49 @@
         if (likely(__pyx_t_8)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
           __Pyx_INCREF(__pyx_t_8);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_6, function);
         }
       }
-      __pyx_t_1 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_8, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_7);
-      __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 468, __pyx_L4_error)
-      __Pyx_GOTREF(__pyx_t_1);
+      if (!__pyx_t_8) {
+        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 468, __pyx_L4_error)
+        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+        __Pyx_GOTREF(__pyx_t_1);
+      } else {
+        #if CYTHON_FAST_PYCALL
+        if (PyFunction_Check(__pyx_t_6)) {
+          PyObject *__pyx_temp[2] = {__pyx_t_8, __pyx_t_7};
+          __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 468, __pyx_L4_error)
+          __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
+          __Pyx_GOTREF(__pyx_t_1);
+          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+        } else
+        #endif
+        #if CYTHON_FAST_PYCCALL
+        if (__Pyx_PyFastCFunction_Check(__pyx_t_6)) {
+          PyObject *__pyx_temp[2] = {__pyx_t_8, __pyx_t_7};
+          __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 468, __pyx_L4_error)
+          __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
+          __Pyx_GOTREF(__pyx_t_1);
+          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+        } else
+        #endif
+        {
+          __pyx_t_9 = PyTuple_New(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 468, __pyx_L4_error)
+          __Pyx_GOTREF(__pyx_t_9);
+          __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_8); __pyx_t_8 = NULL;
+          __Pyx_GIVEREF(__pyx_t_7);
+          PyTuple_SET_ITEM(__pyx_t_9, 0+1, __pyx_t_7);
+          __pyx_t_7 = 0;
+          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 468, __pyx_L4_error)
+          __Pyx_GOTREF(__pyx_t_1);
+          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+        }
+      }
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __pyx_t_6 = __Pyx_PySequence_Tuple(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 468, __pyx_L4_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_v_result = ((PyObject*)__pyx_t_6);
       __pyx_t_6 = 0;
 
@@ -4036,103 +3938,107 @@
       __pyx_v_pCur->stopped = 0;
     }
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     goto __pyx_L9_try_end;
     __pyx_L4_error:;
+    __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
+    __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
 
     /* "playhouse/_sqlite_ext.pyx":469
  *     try:
  *         result = tuple(table_func.iterate(pCur.idx))
  *     except StopIteration:             # <<<<<<<<<<<<<<
  *         pCur.stopped = True
  *     except:
  */
-    __pyx_t_9 = __Pyx_PyErr_ExceptionMatches(__pyx_builtin_StopIteration);
-    if (__pyx_t_9) {
+    __pyx_t_10 = __Pyx_PyErr_ExceptionMatches(__pyx_builtin_StopIteration);
+    if (__pyx_t_10) {
       __Pyx_AddTraceback("playhouse._sqlite_ext.pwNext", __pyx_clineno, __pyx_lineno, __pyx_filename);
-      if (__Pyx_GetException(&__pyx_t_6, &__pyx_t_1, &__pyx_t_7) < 0) __PYX_ERR(0, 469, __pyx_L6_except_error)
+      if (__Pyx_GetException(&__pyx_t_6, &__pyx_t_1, &__pyx_t_9) < 0) __PYX_ERR(0, 469, __pyx_L6_except_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_GOTREF(__pyx_t_7);
+      __Pyx_GOTREF(__pyx_t_9);
 
       /* "playhouse/_sqlite_ext.pyx":470
  *         result = tuple(table_func.iterate(pCur.idx))
  *     except StopIteration:
  *         pCur.stopped = True             # <<<<<<<<<<<<<<
  *     except:
  *         if table_func.print_tracebacks:
  */
       __pyx_v_pCur->stopped = 1;
-      __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       goto __pyx_L5_exception_handled;
     }
 
     /* "playhouse/_sqlite_ext.pyx":471
  *     except StopIteration:
  *         pCur.stopped = True
  *     except:             # <<<<<<<<<<<<<<
  *         if table_func.print_tracebacks:
  *             traceback.print_exc()
  */
     /*except:*/ {
       __Pyx_AddTraceback("playhouse._sqlite_ext.pwNext", __pyx_clineno, __pyx_lineno, __pyx_filename);
-      if (__Pyx_GetException(&__pyx_t_7, &__pyx_t_1, &__pyx_t_6) < 0) __PYX_ERR(0, 471, __pyx_L6_except_error)
-      __Pyx_GOTREF(__pyx_t_7);
+      if (__Pyx_GetException(&__pyx_t_9, &__pyx_t_1, &__pyx_t_6) < 0) __PYX_ERR(0, 471, __pyx_L6_except_error)
+      __Pyx_GOTREF(__pyx_t_9);
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_GOTREF(__pyx_t_6);
 
       /* "playhouse/_sqlite_ext.pyx":472
  *         pCur.stopped = True
  *     except:
  *         if table_func.print_tracebacks:             # <<<<<<<<<<<<<<
  *             traceback.print_exc()
  *         return SQLITE_ERROR
  */
-      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_table_func, __pyx_n_s_print_tracebacks); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 472, __pyx_L6_except_error)
-      __Pyx_GOTREF(__pyx_t_8);
-      __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 472, __pyx_L6_except_error)
-      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_table_func, __pyx_n_s_print_tracebacks); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 472, __pyx_L6_except_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 472, __pyx_L6_except_error)
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       if (__pyx_t_2) {
 
         /* "playhouse/_sqlite_ext.pyx":473
  *     except:
  *         if table_func.print_tracebacks:
  *             traceback.print_exc()             # <<<<<<<<<<<<<<
  *         return SQLITE_ERROR
  *     else:
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_traceback); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 473, __pyx_L6_except_error)
-        __Pyx_GOTREF(__pyx_t_10);
-        __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_print_exc); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 473, __pyx_L6_except_error)
+        __pyx_t_8 = __Pyx_GetModuleGlobalName(__pyx_n_s_traceback); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 473, __pyx_L6_except_error)
+        __Pyx_GOTREF(__pyx_t_8);
+        __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_print_exc); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 473, __pyx_L6_except_error)
         __Pyx_GOTREF(__pyx_t_11);
-        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-        __pyx_t_10 = NULL;
+        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+        __pyx_t_8 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
-          __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_11);
-          if (likely(__pyx_t_10)) {
+          __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_11);
+          if (likely(__pyx_t_8)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
-            __Pyx_INCREF(__pyx_t_10);
+            __Pyx_INCREF(__pyx_t_8);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_11, function);
           }
         }
-        __pyx_t_8 = (__pyx_t_10) ? __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_10) : __Pyx_PyObject_CallNoArg(__pyx_t_11);
-        __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-        if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 473, __pyx_L6_except_error)
-        __Pyx_GOTREF(__pyx_t_8);
+        if (__pyx_t_8) {
+          __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 473, __pyx_L6_except_error)
+          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+        } else {
+          __pyx_t_7 = __Pyx_PyObject_CallNoArg(__pyx_t_11); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 473, __pyx_L6_except_error)
+        }
+        __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
         /* "playhouse/_sqlite_ext.pyx":472
  *         pCur.stopped = True
  *     except:
  *         if table_func.print_tracebacks:             # <<<<<<<<<<<<<<
  *             traceback.print_exc()
  *         return SQLITE_ERROR
@@ -4145,15 +4051,15 @@
  *         return SQLITE_ERROR             # <<<<<<<<<<<<<<
  *     else:
  *         Py_INCREF(result)
  */
       __pyx_r = SQLITE_ERROR;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       goto __pyx_L7_except_return;
     }
     __pyx_L6_except_error:;
 
     /* "playhouse/_sqlite_ext.pyx":467
  * 
  *     pCur.row_data = NULL
@@ -4200,15 +4106,15 @@
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_6);
   __Pyx_XDECREF(__pyx_t_7);
   __Pyx_XDECREF(__pyx_t_8);
-  __Pyx_XDECREF(__pyx_t_10);
+  __Pyx_XDECREF(__pyx_t_9);
   __Pyx_XDECREF(__pyx_t_11);
   __Pyx_WriteUnraisable("playhouse._sqlite_ext.pwNext", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_table_func);
   __Pyx_XDECREF(__pyx_v_result);
   __Pyx_RefNannyFinishContext();
@@ -4890,32 +4796,35 @@
         /* "playhouse/_sqlite_ext.pyx":553
  *     except:
  *         if table_func.print_tracebacks:
  *             traceback.print_exc()             # <<<<<<<<<<<<<<
  *         return SQLITE_ERROR
  * 
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_traceback); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 553, __pyx_L12_except_error)
+        __pyx_t_14 = __Pyx_GetModuleGlobalName(__pyx_n_s_traceback); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 553, __pyx_L12_except_error)
         __Pyx_GOTREF(__pyx_t_14);
         __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_print_exc); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 553, __pyx_L12_except_error)
         __Pyx_GOTREF(__pyx_t_15);
         __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
         __pyx_t_14 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_15))) {
           __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_15);
           if (likely(__pyx_t_14)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_15);
             __Pyx_INCREF(__pyx_t_14);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_15, function);
           }
         }
-        __pyx_t_13 = (__pyx_t_14) ? __Pyx_PyObject_CallOneArg(__pyx_t_15, __pyx_t_14) : __Pyx_PyObject_CallNoArg(__pyx_t_15);
-        __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-        if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 553, __pyx_L12_except_error)
+        if (__pyx_t_14) {
+          __pyx_t_13 = __Pyx_PyObject_CallOneArg(__pyx_t_15, __pyx_t_14); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 553, __pyx_L12_except_error)
+          __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
+        } else {
+          __pyx_t_13 = __Pyx_PyObject_CallNoArg(__pyx_t_15); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 553, __pyx_L12_except_error)
+        }
         __Pyx_GOTREF(__pyx_t_13);
         __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
         __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
 
         /* "playhouse/_sqlite_ext.pyx":552
  *         table_func.initialize(**query)
  *     except:
@@ -4989,36 +4898,24 @@
       /* "playhouse/_sqlite_ext.pyx":558
  *     pCur.stopped = False
  *     try:
  *         row_data = tuple(table_func.iterate(0))             # <<<<<<<<<<<<<<
  *     except StopIteration:
  *         pCur.stopped = True
  */
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_table_func, __pyx_n_s_iterate); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 558, __pyx_L19_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
-        __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
-        if (likely(__pyx_t_6)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
-          __Pyx_INCREF(__pyx_t_6);
-          __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_1, function);
-        }
-      }
-      __pyx_t_12 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_6, __pyx_int_0) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_int_0);
-      __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 558, __pyx_L19_error)
+      __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_v_table_func, __pyx_n_s_iterate); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 558, __pyx_L19_error)
       __Pyx_GOTREF(__pyx_t_12);
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PySequence_Tuple(__pyx_t_12); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 558, __pyx_L19_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_tuple__2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 558, __pyx_L19_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-      __pyx_v_row_data = ((PyObject*)__pyx_t_1);
-      __pyx_t_1 = 0;
+      __pyx_t_12 = __Pyx_PySequence_Tuple(__pyx_t_1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 558, __pyx_L19_error)
+      __Pyx_GOTREF(__pyx_t_12);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __pyx_v_row_data = ((PyObject*)__pyx_t_12);
+      __pyx_t_12 = 0;
 
       /* "playhouse/_sqlite_ext.pyx":557
  * 
  *     pCur.stopped = False
  *     try:             # <<<<<<<<<<<<<<
  *         row_data = tuple(table_func.iterate(0))
  *     except StopIteration:
@@ -5054,63 +4951,63 @@
       __pyx_v_pCur->idx = (__pyx_v_pCur->idx + 1);
     }
     __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
     goto __pyx_L24_try_end;
     __pyx_L19_error:;
-    __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
-    __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
     __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
+    __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
 
     /* "playhouse/_sqlite_ext.pyx":559
  *     try:
  *         row_data = tuple(table_func.iterate(0))
  *     except StopIteration:             # <<<<<<<<<<<<<<
  *         pCur.stopped = True
  *     except:
  */
     __pyx_t_7 = __Pyx_PyErr_ExceptionMatches(__pyx_builtin_StopIteration);
     if (__pyx_t_7) {
       __Pyx_AddTraceback("playhouse._sqlite_ext.pwFilter", __pyx_clineno, __pyx_lineno, __pyx_filename);
-      if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_12, &__pyx_t_6) < 0) __PYX_ERR(0, 559, __pyx_L21_except_error)
-      __Pyx_GOTREF(__pyx_t_1);
+      if (__Pyx_GetException(&__pyx_t_12, &__pyx_t_1, &__pyx_t_6) < 0) __PYX_ERR(0, 559, __pyx_L21_except_error)
       __Pyx_GOTREF(__pyx_t_12);
+      __Pyx_GOTREF(__pyx_t_1);
       __Pyx_GOTREF(__pyx_t_6);
 
       /* "playhouse/_sqlite_ext.pyx":560
  *         row_data = tuple(table_func.iterate(0))
  *     except StopIteration:
  *         pCur.stopped = True             # <<<<<<<<<<<<<<
  *     except:
  *         if table_func.print_tracebacks:
  */
       __pyx_v_pCur->stopped = 1;
-      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
-      __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       goto __pyx_L20_exception_handled;
     }
 
     /* "playhouse/_sqlite_ext.pyx":561
  *     except StopIteration:
  *         pCur.stopped = True
  *     except:             # <<<<<<<<<<<<<<
  *         if table_func.print_tracebacks:
  *             traceback.print_exc()
  */
     /*except:*/ {
       __Pyx_AddTraceback("playhouse._sqlite_ext.pwFilter", __pyx_clineno, __pyx_lineno, __pyx_filename);
-      if (__Pyx_GetException(&__pyx_t_6, &__pyx_t_12, &__pyx_t_1) < 0) __PYX_ERR(0, 561, __pyx_L21_except_error)
+      if (__Pyx_GetException(&__pyx_t_6, &__pyx_t_1, &__pyx_t_12) < 0) __PYX_ERR(0, 561, __pyx_L21_except_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __Pyx_GOTREF(__pyx_t_12);
       __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_GOTREF(__pyx_t_12);
 
       /* "playhouse/_sqlite_ext.pyx":562
  *         pCur.stopped = True
  *     except:
  *         if table_func.print_tracebacks:             # <<<<<<<<<<<<<<
  *             traceback.print_exc()
  *         return SQLITE_ERROR
@@ -5124,32 +5021,35 @@
         /* "playhouse/_sqlite_ext.pyx":563
  *     except:
  *         if table_func.print_tracebacks:
  *             traceback.print_exc()             # <<<<<<<<<<<<<<
  *         return SQLITE_ERROR
  *     else:
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_15, __pyx_n_s_traceback); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 563, __pyx_L21_except_error)
+        __pyx_t_15 = __Pyx_GetModuleGlobalName(__pyx_n_s_traceback); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 563, __pyx_L21_except_error)
         __Pyx_GOTREF(__pyx_t_15);
         __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_15, __pyx_n_s_print_exc); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 563, __pyx_L21_except_error)
         __Pyx_GOTREF(__pyx_t_14);
         __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
         __pyx_t_15 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_14))) {
           __pyx_t_15 = PyMethod_GET_SELF(__pyx_t_14);
           if (likely(__pyx_t_15)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_14);
             __Pyx_INCREF(__pyx_t_15);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_14, function);
           }
         }
-        __pyx_t_13 = (__pyx_t_15) ? __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_t_15) : __Pyx_PyObject_CallNoArg(__pyx_t_14);
-        __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
-        if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 563, __pyx_L21_except_error)
+        if (__pyx_t_15) {
+          __pyx_t_13 = __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_t_15); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 563, __pyx_L21_except_error)
+          __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
+        } else {
+          __pyx_t_13 = __Pyx_PyObject_CallNoArg(__pyx_t_14); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 563, __pyx_L21_except_error)
+        }
         __Pyx_GOTREF(__pyx_t_13);
         __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
         __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
 
         /* "playhouse/_sqlite_ext.pyx":562
  *         pCur.stopped = True
  *     except:
@@ -5264,21 +5164,20 @@
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   Py_ssize_t __pyx_t_2;
   int __pyx_t_3;
   int __pyx_t_4;
   int __pyx_t_5;
-  int __pyx_t_6;
+  PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
-  PyObject *__pyx_t_9 = NULL;
+  int __pyx_t_9;
   int __pyx_t_10;
-  int __pyx_t_11;
-  char *__pyx_t_12;
+  char *__pyx_t_11;
   #ifdef WITH_THREAD
   PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
   #endif
   __Pyx_RefNannySetupContext("pwBestIndex", 0);
 
   /* "playhouse/_sqlite_ext.pyx":578
  *     cdef:
@@ -5291,431 +5190,430 @@
   __pyx_v_nArg = 0;
 
   /* "playhouse/_sqlite_ext.pyx":579
  *         int i
  *         int idxNum = 0, nArg = 0
  *         peewee_vtab *pVtab = <peewee_vtab *>pBase             # <<<<<<<<<<<<<<
  *         object table_func_cls = <object>pVtab.table_func_cls
- *         sqlite3_index_constraint *pConstraint
+ *         sqlite3_index_constraint *pConstraint = <sqlite3_index_constraint *>0
  */
   __pyx_v_pVtab = ((__pyx_t_9playhouse_11_sqlite_ext_peewee_vtab *)__pyx_v_pBase);
 
   /* "playhouse/_sqlite_ext.pyx":580
  *         int idxNum = 0, nArg = 0
  *         peewee_vtab *pVtab = <peewee_vtab *>pBase
  *         object table_func_cls = <object>pVtab.table_func_cls             # <<<<<<<<<<<<<<
- *         sqlite3_index_constraint *pConstraint
+ *         sqlite3_index_constraint *pConstraint = <sqlite3_index_constraint *>0
  *         list columns = []
  */
   __pyx_t_1 = ((PyObject *)__pyx_v_pVtab->table_func_cls);
   __Pyx_INCREF(__pyx_t_1);
   __pyx_v_table_func_cls = __pyx_t_1;
   __pyx_t_1 = 0;
 
+  /* "playhouse/_sqlite_ext.pyx":581
+ *         peewee_vtab *pVtab = <peewee_vtab *>pBase
+ *         object table_func_cls = <object>pVtab.table_func_cls
+ *         sqlite3_index_constraint *pConstraint = <sqlite3_index_constraint *>0             # <<<<<<<<<<<<<<
+ *         list columns = []
+ *         char *idxStr
+ */
+  __pyx_v_pConstraint = ((struct __pyx_t_9playhouse_11_sqlite_ext_sqlite3_index_constraint *)0);
+
   /* "playhouse/_sqlite_ext.pyx":582
  *         object table_func_cls = <object>pVtab.table_func_cls
- *         sqlite3_index_constraint *pConstraint
+ *         sqlite3_index_constraint *pConstraint = <sqlite3_index_constraint *>0
  *         list columns = []             # <<<<<<<<<<<<<<
  *         char *idxStr
  *         int nParams = len(table_func_cls.params)
  */
   __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 582, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_columns = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
   /* "playhouse/_sqlite_ext.pyx":584
  *         list columns = []
  *         char *idxStr
  *         int nParams = len(table_func_cls.params)             # <<<<<<<<<<<<<<
  * 
- *     pConstraint = <sqlite3_index_constraint*>0
+ *     for i in range(pIdxInfo.nConstraint):
  */
   __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_table_func_cls, __pyx_n_s_params); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 584, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 584, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_nParams = __pyx_t_2;
 
   /* "playhouse/_sqlite_ext.pyx":586
  *         int nParams = len(table_func_cls.params)
  * 
- *     pConstraint = <sqlite3_index_constraint*>0             # <<<<<<<<<<<<<<
- *     for i in range(pIdxInfo.nConstraint):
- *         pConstraint = &pIdxInfo.aConstraint[i]
- */
-  __pyx_v_pConstraint = ((struct __pyx_t_9playhouse_11_sqlite_ext_sqlite3_index_constraint *)0);
-
-  /* "playhouse/_sqlite_ext.pyx":587
- * 
- *     pConstraint = <sqlite3_index_constraint*>0
  *     for i in range(pIdxInfo.nConstraint):             # <<<<<<<<<<<<<<
- *         pConstraint = &pIdxInfo.aConstraint[i]
+ *         pConstraint = pIdxInfo.aConstraint + i
  *         if not pConstraint.usable:
  */
   __pyx_t_3 = __pyx_v_pIdxInfo->nConstraint;
-  __pyx_t_4 = __pyx_t_3;
-  for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
-    __pyx_v_i = __pyx_t_5;
+  for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
+    __pyx_v_i = __pyx_t_4;
 
-    /* "playhouse/_sqlite_ext.pyx":588
- *     pConstraint = <sqlite3_index_constraint*>0
+    /* "playhouse/_sqlite_ext.pyx":587
+ * 
  *     for i in range(pIdxInfo.nConstraint):
- *         pConstraint = &pIdxInfo.aConstraint[i]             # <<<<<<<<<<<<<<
+ *         pConstraint = pIdxInfo.aConstraint + i             # <<<<<<<<<<<<<<
  *         if not pConstraint.usable:
  *             continue
  */
-    __pyx_v_pConstraint = (&(__pyx_v_pIdxInfo->aConstraint[__pyx_v_i]));
+    __pyx_v_pConstraint = (__pyx_v_pIdxInfo->aConstraint + __pyx_v_i);
 
-    /* "playhouse/_sqlite_ext.pyx":589
+    /* "playhouse/_sqlite_ext.pyx":588
  *     for i in range(pIdxInfo.nConstraint):
- *         pConstraint = &pIdxInfo.aConstraint[i]
+ *         pConstraint = pIdxInfo.aConstraint + i
  *         if not pConstraint.usable:             # <<<<<<<<<<<<<<
  *             continue
  *         if pConstraint.op != SQLITE_INDEX_CONSTRAINT_EQ:
  */
-    __pyx_t_6 = ((!(__pyx_v_pConstraint->usable != 0)) != 0);
-    if (__pyx_t_6) {
+    __pyx_t_5 = ((!(__pyx_v_pConstraint->usable != 0)) != 0);
+    if (__pyx_t_5) {
 
-      /* "playhouse/_sqlite_ext.pyx":590
- *         pConstraint = &pIdxInfo.aConstraint[i]
+      /* "playhouse/_sqlite_ext.pyx":589
+ *         pConstraint = pIdxInfo.aConstraint + i
  *         if not pConstraint.usable:
  *             continue             # <<<<<<<<<<<<<<
  *         if pConstraint.op != SQLITE_INDEX_CONSTRAINT_EQ:
  *             continue
  */
       goto __pyx_L3_continue;
 
-      /* "playhouse/_sqlite_ext.pyx":589
+      /* "playhouse/_sqlite_ext.pyx":588
  *     for i in range(pIdxInfo.nConstraint):
- *         pConstraint = &pIdxInfo.aConstraint[i]
+ *         pConstraint = pIdxInfo.aConstraint + i
  *         if not pConstraint.usable:             # <<<<<<<<<<<<<<
  *             continue
  *         if pConstraint.op != SQLITE_INDEX_CONSTRAINT_EQ:
  */
     }
 
-    /* "playhouse/_sqlite_ext.pyx":591
+    /* "playhouse/_sqlite_ext.pyx":590
  *         if not pConstraint.usable:
  *             continue
  *         if pConstraint.op != SQLITE_INDEX_CONSTRAINT_EQ:             # <<<<<<<<<<<<<<
  *             continue
  * 
  */
-    __pyx_t_6 = ((__pyx_v_pConstraint->op != SQLITE_INDEX_CONSTRAINT_EQ) != 0);
-    if (__pyx_t_6) {
+    __pyx_t_5 = ((__pyx_v_pConstraint->op != SQLITE_INDEX_CONSTRAINT_EQ) != 0);
+    if (__pyx_t_5) {
 
-      /* "playhouse/_sqlite_ext.pyx":592
+      /* "playhouse/_sqlite_ext.pyx":591
  *             continue
  *         if pConstraint.op != SQLITE_INDEX_CONSTRAINT_EQ:
  *             continue             # <<<<<<<<<<<<<<
  * 
  *         columns.append(table_func_cls.params[pConstraint.iColumn -
  */
       goto __pyx_L3_continue;
 
-      /* "playhouse/_sqlite_ext.pyx":591
+      /* "playhouse/_sqlite_ext.pyx":590
  *         if not pConstraint.usable:
  *             continue
  *         if pConstraint.op != SQLITE_INDEX_CONSTRAINT_EQ:             # <<<<<<<<<<<<<<
  *             continue
  * 
  */
     }
 
-    /* "playhouse/_sqlite_ext.pyx":594
+    /* "playhouse/_sqlite_ext.pyx":593
  *             continue
  * 
  *         columns.append(table_func_cls.params[pConstraint.iColumn -             # <<<<<<<<<<<<<<
  *                                              table_func_cls._ncols])
  *         nArg += 1
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_table_func_cls, __pyx_n_s_params); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 594, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_table_func_cls, __pyx_n_s_params); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 593, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_pConstraint->iColumn); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 594, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_7);
+    __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_pConstraint->iColumn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 593, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
 
-    /* "playhouse/_sqlite_ext.pyx":595
+    /* "playhouse/_sqlite_ext.pyx":594
  * 
  *         columns.append(table_func_cls.params[pConstraint.iColumn -
  *                                              table_func_cls._ncols])             # <<<<<<<<<<<<<<
  *         nArg += 1
  *         pIdxInfo.aConstraintUsage[i].argvIndex = nArg
  */
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_table_func_cls, __pyx_n_s_ncols); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 595, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_8);
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_table_func_cls, __pyx_n_s_ncols); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 594, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
 
-    /* "playhouse/_sqlite_ext.pyx":594
+    /* "playhouse/_sqlite_ext.pyx":593
  *             continue
  * 
  *         columns.append(table_func_cls.params[pConstraint.iColumn -             # <<<<<<<<<<<<<<
  *                                              table_func_cls._ncols])
  *         nArg += 1
  */
-    __pyx_t_9 = PyNumber_Subtract(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 594, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_9);
-    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 594, __pyx_L1_error)
+    __pyx_t_8 = PyNumber_Subtract(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 593, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __pyx_t_7 = PyObject_GetItem(__pyx_t_1, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 593, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_columns, __pyx_t_8); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 594, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+    __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_columns, __pyx_t_7); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 593, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":596
+    /* "playhouse/_sqlite_ext.pyx":595
  *         columns.append(table_func_cls.params[pConstraint.iColumn -
  *                                              table_func_cls._ncols])
  *         nArg += 1             # <<<<<<<<<<<<<<
  *         pIdxInfo.aConstraintUsage[i].argvIndex = nArg
  *         pIdxInfo.aConstraintUsage[i].omit = 1
  */
     __pyx_v_nArg = (__pyx_v_nArg + 1);
 
-    /* "playhouse/_sqlite_ext.pyx":597
+    /* "playhouse/_sqlite_ext.pyx":596
  *                                              table_func_cls._ncols])
  *         nArg += 1
  *         pIdxInfo.aConstraintUsage[i].argvIndex = nArg             # <<<<<<<<<<<<<<
  *         pIdxInfo.aConstraintUsage[i].omit = 1
  * 
  */
     (__pyx_v_pIdxInfo->aConstraintUsage[__pyx_v_i]).argvIndex = __pyx_v_nArg;
 
-    /* "playhouse/_sqlite_ext.pyx":598
+    /* "playhouse/_sqlite_ext.pyx":597
  *         nArg += 1
  *         pIdxInfo.aConstraintUsage[i].argvIndex = nArg
  *         pIdxInfo.aConstraintUsage[i].omit = 1             # <<<<<<<<<<<<<<
  * 
  *     if nArg > 0 or nParams == 0:
  */
     (__pyx_v_pIdxInfo->aConstraintUsage[__pyx_v_i]).omit = 1;
     __pyx_L3_continue:;
   }
 
-  /* "playhouse/_sqlite_ext.pyx":600
+  /* "playhouse/_sqlite_ext.pyx":599
  *         pIdxInfo.aConstraintUsage[i].omit = 1
  * 
  *     if nArg > 0 or nParams == 0:             # <<<<<<<<<<<<<<
  *         if nArg == nParams:
  *             # All parameters are present, this is ideal.
  */
-  __pyx_t_11 = ((__pyx_v_nArg > 0) != 0);
-  if (!__pyx_t_11) {
+  __pyx_t_10 = ((__pyx_v_nArg > 0) != 0);
+  if (!__pyx_t_10) {
   } else {
-    __pyx_t_6 = __pyx_t_11;
+    __pyx_t_5 = __pyx_t_10;
     goto __pyx_L8_bool_binop_done;
   }
-  __pyx_t_11 = ((__pyx_v_nParams == 0) != 0);
-  __pyx_t_6 = __pyx_t_11;
+  __pyx_t_10 = ((__pyx_v_nParams == 0) != 0);
+  __pyx_t_5 = __pyx_t_10;
   __pyx_L8_bool_binop_done:;
-  if (__pyx_t_6) {
+  if (__pyx_t_5) {
 
-    /* "playhouse/_sqlite_ext.pyx":601
+    /* "playhouse/_sqlite_ext.pyx":600
  * 
  *     if nArg > 0 or nParams == 0:
  *         if nArg == nParams:             # <<<<<<<<<<<<<<
  *             # All parameters are present, this is ideal.
  *             pIdxInfo.estimatedCost = <double>1
  */
-    __pyx_t_6 = ((__pyx_v_nArg == __pyx_v_nParams) != 0);
-    if (__pyx_t_6) {
+    __pyx_t_5 = ((__pyx_v_nArg == __pyx_v_nParams) != 0);
+    if (__pyx_t_5) {
 
-      /* "playhouse/_sqlite_ext.pyx":603
+      /* "playhouse/_sqlite_ext.pyx":602
  *         if nArg == nParams:
  *             # All parameters are present, this is ideal.
  *             pIdxInfo.estimatedCost = <double>1             # <<<<<<<<<<<<<<
  *             pIdxInfo.estimatedRows = 10
  *         else:
  */
       __pyx_v_pIdxInfo->estimatedCost = ((double)1);
 
-      /* "playhouse/_sqlite_ext.pyx":604
+      /* "playhouse/_sqlite_ext.pyx":603
  *             # All parameters are present, this is ideal.
  *             pIdxInfo.estimatedCost = <double>1
  *             pIdxInfo.estimatedRows = 10             # <<<<<<<<<<<<<<
  *         else:
  *             # Penalize score based on number of missing params.
  */
       __pyx_v_pIdxInfo->estimatedRows = 10;
 
-      /* "playhouse/_sqlite_ext.pyx":601
+      /* "playhouse/_sqlite_ext.pyx":600
  * 
  *     if nArg > 0 or nParams == 0:
  *         if nArg == nParams:             # <<<<<<<<<<<<<<
  *             # All parameters are present, this is ideal.
  *             pIdxInfo.estimatedCost = <double>1
  */
       goto __pyx_L10;
     }
 
-    /* "playhouse/_sqlite_ext.pyx":607
+    /* "playhouse/_sqlite_ext.pyx":606
  *         else:
  *             # Penalize score based on number of missing params.
  *             pIdxInfo.estimatedCost = <double>10000000000000 * <double>(nParams - nArg)             # <<<<<<<<<<<<<<
  *             pIdxInfo.estimatedRows = 10 ** (nParams - nArg)
  * 
  */
     /*else*/ {
       __pyx_v_pIdxInfo->estimatedCost = (((double)10000000000000.0) * ((double)(__pyx_v_nParams - __pyx_v_nArg)));
 
-      /* "playhouse/_sqlite_ext.pyx":608
+      /* "playhouse/_sqlite_ext.pyx":607
  *             # Penalize score based on number of missing params.
  *             pIdxInfo.estimatedCost = <double>10000000000000 * <double>(nParams - nArg)
  *             pIdxInfo.estimatedRows = 10 ** (nParams - nArg)             # <<<<<<<<<<<<<<
  * 
  *         # Store a reference to the columns in the index info structure.
  */
       __pyx_v_pIdxInfo->estimatedRows = __Pyx_pow_long(10, ((long)(__pyx_v_nParams - __pyx_v_nArg)));
     }
     __pyx_L10:;
 
-    /* "playhouse/_sqlite_ext.pyx":611
+    /* "playhouse/_sqlite_ext.pyx":610
  * 
  *         # Store a reference to the columns in the index info structure.
  *         joinedCols = encode(','.join(columns))             # <<<<<<<<<<<<<<
  *         idxStr = <char *>sqlite3_malloc((len(joinedCols) + 1) * sizeof(char))
  *         memcpy(idxStr, <char *>joinedCols, len(joinedCols))
  */
-    __pyx_t_8 = __Pyx_PyString_Join(__pyx_kp_s_, __pyx_v_columns); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 611, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyString_Join(__pyx_kp_s_, __pyx_v_columns); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 610, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __pyx_t_8 = __pyx_f_9playhouse_11_sqlite_ext_encode(__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 610, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_9 = __pyx_f_9playhouse_11_sqlite_ext_encode(__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 611, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_9);
-    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_v_joinedCols = ((PyObject*)__pyx_t_9);
-    __pyx_t_9 = 0;
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __pyx_v_joinedCols = ((PyObject*)__pyx_t_8);
+    __pyx_t_8 = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":612
+    /* "playhouse/_sqlite_ext.pyx":611
  *         # Store a reference to the columns in the index info structure.
  *         joinedCols = encode(','.join(columns))
  *         idxStr = <char *>sqlite3_malloc((len(joinedCols) + 1) * sizeof(char))             # <<<<<<<<<<<<<<
  *         memcpy(idxStr, <char *>joinedCols, len(joinedCols))
  *         idxStr[len(joinedCols)] = '\x00'
  */
     if (unlikely(__pyx_v_joinedCols == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "object of type 'NoneType' has no len()");
-      __PYX_ERR(0, 612, __pyx_L1_error)
+      __PYX_ERR(0, 611, __pyx_L1_error)
     }
-    __pyx_t_2 = PyBytes_GET_SIZE(__pyx_v_joinedCols); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 612, __pyx_L1_error)
+    __pyx_t_2 = PyBytes_GET_SIZE(__pyx_v_joinedCols); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 611, __pyx_L1_error)
     __pyx_v_idxStr = ((char *)sqlite3_malloc(((__pyx_t_2 + 1) * (sizeof(char)))));
 
-    /* "playhouse/_sqlite_ext.pyx":613
+    /* "playhouse/_sqlite_ext.pyx":612
  *         joinedCols = encode(','.join(columns))
  *         idxStr = <char *>sqlite3_malloc((len(joinedCols) + 1) * sizeof(char))
  *         memcpy(idxStr, <char *>joinedCols, len(joinedCols))             # <<<<<<<<<<<<<<
  *         idxStr[len(joinedCols)] = '\x00'
  *         pIdxInfo.idxStr = idxStr
  */
     if (unlikely(__pyx_v_joinedCols == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "expected bytes, NoneType found");
-      __PYX_ERR(0, 613, __pyx_L1_error)
+      __PYX_ERR(0, 612, __pyx_L1_error)
     }
-    __pyx_t_12 = __Pyx_PyBytes_AsWritableString(__pyx_v_joinedCols); if (unlikely((!__pyx_t_12) && PyErr_Occurred())) __PYX_ERR(0, 613, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyBytes_AsWritableString(__pyx_v_joinedCols); if (unlikely((!__pyx_t_11) && PyErr_Occurred())) __PYX_ERR(0, 612, __pyx_L1_error)
     if (unlikely(__pyx_v_joinedCols == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "object of type 'NoneType' has no len()");
-      __PYX_ERR(0, 613, __pyx_L1_error)
+      __PYX_ERR(0, 612, __pyx_L1_error)
     }
-    __pyx_t_2 = PyBytes_GET_SIZE(__pyx_v_joinedCols); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 613, __pyx_L1_error)
-    (void)(memcpy(__pyx_v_idxStr, ((char *)__pyx_t_12), __pyx_t_2));
+    __pyx_t_2 = PyBytes_GET_SIZE(__pyx_v_joinedCols); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 612, __pyx_L1_error)
+    memcpy(__pyx_v_idxStr, ((char *)__pyx_t_11), __pyx_t_2);
 
-    /* "playhouse/_sqlite_ext.pyx":614
+    /* "playhouse/_sqlite_ext.pyx":613
  *         idxStr = <char *>sqlite3_malloc((len(joinedCols) + 1) * sizeof(char))
  *         memcpy(idxStr, <char *>joinedCols, len(joinedCols))
  *         idxStr[len(joinedCols)] = '\x00'             # <<<<<<<<<<<<<<
  *         pIdxInfo.idxStr = idxStr
  *         pIdxInfo.needToFreeIdxStr = 0
  */
     if (unlikely(__pyx_v_joinedCols == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "object of type 'NoneType' has no len()");
-      __PYX_ERR(0, 614, __pyx_L1_error)
+      __PYX_ERR(0, 613, __pyx_L1_error)
     }
-    __pyx_t_2 = PyBytes_GET_SIZE(__pyx_v_joinedCols); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 614, __pyx_L1_error)
+    __pyx_t_2 = PyBytes_GET_SIZE(__pyx_v_joinedCols); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 613, __pyx_L1_error)
     (__pyx_v_idxStr[__pyx_t_2]) = '\x00';
 
-    /* "playhouse/_sqlite_ext.pyx":615
+    /* "playhouse/_sqlite_ext.pyx":614
  *         memcpy(idxStr, <char *>joinedCols, len(joinedCols))
  *         idxStr[len(joinedCols)] = '\x00'
  *         pIdxInfo.idxStr = idxStr             # <<<<<<<<<<<<<<
  *         pIdxInfo.needToFreeIdxStr = 0
  *     elif USE_SQLITE_CONSTRAINT:
  */
     __pyx_v_pIdxInfo->idxStr = __pyx_v_idxStr;
 
-    /* "playhouse/_sqlite_ext.pyx":616
+    /* "playhouse/_sqlite_ext.pyx":615
  *         idxStr[len(joinedCols)] = '\x00'
  *         pIdxInfo.idxStr = idxStr
  *         pIdxInfo.needToFreeIdxStr = 0             # <<<<<<<<<<<<<<
  *     elif USE_SQLITE_CONSTRAINT:
  *         return SQLITE_CONSTRAINT
  */
     __pyx_v_pIdxInfo->needToFreeIdxStr = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":600
+    /* "playhouse/_sqlite_ext.pyx":599
  *         pIdxInfo.aConstraintUsage[i].omit = 1
  * 
  *     if nArg > 0 or nParams == 0:             # <<<<<<<<<<<<<<
  *         if nArg == nParams:
  *             # All parameters are present, this is ideal.
  */
     goto __pyx_L7;
   }
 
-  /* "playhouse/_sqlite_ext.pyx":617
+  /* "playhouse/_sqlite_ext.pyx":616
  *         pIdxInfo.idxStr = idxStr
  *         pIdxInfo.needToFreeIdxStr = 0
  *     elif USE_SQLITE_CONSTRAINT:             # <<<<<<<<<<<<<<
  *         return SQLITE_CONSTRAINT
  *     else:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_USE_SQLITE_CONSTRAINT); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 617, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_9);
-  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 617, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-  if (__pyx_t_6) {
+  __pyx_t_8 = __Pyx_GetModuleGlobalName(__pyx_n_s_USE_SQLITE_CONSTRAINT); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 616, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_8);
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 616, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+  if (__pyx_t_5) {
 
-    /* "playhouse/_sqlite_ext.pyx":618
+    /* "playhouse/_sqlite_ext.pyx":617
  *         pIdxInfo.needToFreeIdxStr = 0
  *     elif USE_SQLITE_CONSTRAINT:
  *         return SQLITE_CONSTRAINT             # <<<<<<<<<<<<<<
  *     else:
  *         pIdxInfo.estimatedCost = DBL_MAX
  */
     __pyx_r = __pyx_v_9playhouse_11_sqlite_ext_SQLITE_CONSTRAINT;
     goto __pyx_L0;
 
-    /* "playhouse/_sqlite_ext.pyx":617
+    /* "playhouse/_sqlite_ext.pyx":616
  *         pIdxInfo.idxStr = idxStr
  *         pIdxInfo.needToFreeIdxStr = 0
  *     elif USE_SQLITE_CONSTRAINT:             # <<<<<<<<<<<<<<
  *         return SQLITE_CONSTRAINT
  *     else:
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":620
+  /* "playhouse/_sqlite_ext.pyx":619
  *         return SQLITE_CONSTRAINT
  *     else:
  *         pIdxInfo.estimatedCost = DBL_MAX             # <<<<<<<<<<<<<<
  *         pIdxInfo.estimatedRows = 100000
  *     return SQLITE_OK
  */
   /*else*/ {
     __pyx_v_pIdxInfo->estimatedCost = DBL_MAX;
 
-    /* "playhouse/_sqlite_ext.pyx":621
+    /* "playhouse/_sqlite_ext.pyx":620
  *     else:
  *         pIdxInfo.estimatedCost = DBL_MAX
  *         pIdxInfo.estimatedRows = 100000             # <<<<<<<<<<<<<<
  *     return SQLITE_OK
  * 
  */
     __pyx_v_pIdxInfo->estimatedRows = 0x186A0;
   }
   __pyx_L7:;
 
-  /* "playhouse/_sqlite_ext.pyx":622
+  /* "playhouse/_sqlite_ext.pyx":621
  *         pIdxInfo.estimatedCost = DBL_MAX
  *         pIdxInfo.estimatedRows = 100000
  *     return SQLITE_OK             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = SQLITE_OK;
@@ -5728,31 +5626,31 @@
  *         with gil:
  *     cdef:
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_6);
   __Pyx_XDECREF(__pyx_t_7);
   __Pyx_XDECREF(__pyx_t_8);
-  __Pyx_XDECREF(__pyx_t_9);
   __Pyx_WriteUnraisable("playhouse._sqlite_ext.pwBestIndex", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_table_func_cls);
   __Pyx_XDECREF(__pyx_v_columns);
   __Pyx_XDECREF(__pyx_v_joinedCols);
   __Pyx_RefNannyFinishContext();
   #ifdef WITH_THREAD
   __Pyx_PyGILState_Release(__pyx_gilstate_save);
   #endif
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":630
+/* "playhouse/_sqlite_ext.pyx":629
  *         object table_function
  * 
  *     def __cinit__(self, table_function):             # <<<<<<<<<<<<<<
  *         self.table_function = table_function
  * 
  */
 
@@ -5774,30 +5672,30 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_table_function)) != 0)) kw_args--;
+        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_table_function)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 630, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 629, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
     }
     __pyx_v_table_function = values[0];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 630, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 629, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("playhouse._sqlite_ext._TableFunctionImpl.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_18_TableFunctionImpl___cinit__(((struct __pyx_obj_9playhouse_11_sqlite_ext__TableFunctionImpl *)__pyx_v_self), __pyx_v_table_function);
 
@@ -5807,42 +5705,42 @@
 }
 
 static int __pyx_pf_9playhouse_11_sqlite_ext_18_TableFunctionImpl___cinit__(struct __pyx_obj_9playhouse_11_sqlite_ext__TableFunctionImpl *__pyx_v_self, PyObject *__pyx_v_table_function) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__cinit__", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":631
+  /* "playhouse/_sqlite_ext.pyx":630
  * 
  *     def __cinit__(self, table_function):
  *         self.table_function = table_function             # <<<<<<<<<<<<<<
  * 
  *     cdef create_module(self, pysqlite_Connection* sqlite_conn):
  */
   __Pyx_INCREF(__pyx_v_table_function);
   __Pyx_GIVEREF(__pyx_v_table_function);
   __Pyx_GOTREF(__pyx_v_self->table_function);
   __Pyx_DECREF(__pyx_v_self->table_function);
   __pyx_v_self->table_function = __pyx_v_table_function;
 
-  /* "playhouse/_sqlite_ext.pyx":630
+  /* "playhouse/_sqlite_ext.pyx":629
  *         object table_function
  * 
  *     def __cinit__(self, table_function):             # <<<<<<<<<<<<<<
  *         self.table_function = table_function
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":633
+/* "playhouse/_sqlite_ext.pyx":632
  *         self.table_function = table_function
  * 
  *     cdef create_module(self, pysqlite_Connection* sqlite_conn):             # <<<<<<<<<<<<<<
  *         cdef:
  *             bytes name = encode(self.table_function.name)
  */
 
@@ -5854,265 +5752,265 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   sqlite3 *__pyx_t_3;
   char const *__pyx_t_4;
   __Pyx_RefNannySetupContext("create_module", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":635
+  /* "playhouse/_sqlite_ext.pyx":634
  *     cdef create_module(self, pysqlite_Connection* sqlite_conn):
  *         cdef:
  *             bytes name = encode(self.table_function.name)             # <<<<<<<<<<<<<<
  *             sqlite3 *db = sqlite_conn.db
  *             int rc
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->table_function, __pyx_n_s_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->table_function, __pyx_n_s_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 634, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __pyx_f_9playhouse_11_sqlite_ext_encode(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __pyx_t_2 = __pyx_f_9playhouse_11_sqlite_ext_encode(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 634, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_name = ((PyObject*)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":636
+  /* "playhouse/_sqlite_ext.pyx":635
  *         cdef:
  *             bytes name = encode(self.table_function.name)
  *             sqlite3 *db = sqlite_conn.db             # <<<<<<<<<<<<<<
  *             int rc
  * 
  */
   __pyx_t_3 = __pyx_v_sqlite_conn->db;
   __pyx_v_db = __pyx_t_3;
 
-  /* "playhouse/_sqlite_ext.pyx":640
+  /* "playhouse/_sqlite_ext.pyx":639
  * 
  *         # Populate the SQLite module struct members.
  *         self.module.iVersion = 0             # <<<<<<<<<<<<<<
  *         self.module.xCreate = NULL
  *         self.module.xConnect = pwConnect
  */
   __pyx_v_self->module.iVersion = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":641
+  /* "playhouse/_sqlite_ext.pyx":640
  *         # Populate the SQLite module struct members.
  *         self.module.iVersion = 0
  *         self.module.xCreate = NULL             # <<<<<<<<<<<<<<
  *         self.module.xConnect = pwConnect
  *         self.module.xBestIndex = pwBestIndex
  */
   __pyx_v_self->module.xCreate = NULL;
 
-  /* "playhouse/_sqlite_ext.pyx":642
+  /* "playhouse/_sqlite_ext.pyx":641
  *         self.module.iVersion = 0
  *         self.module.xCreate = NULL
  *         self.module.xConnect = pwConnect             # <<<<<<<<<<<<<<
  *         self.module.xBestIndex = pwBestIndex
  *         self.module.xDisconnect = pwDisconnect
  */
   __pyx_v_self->module.xConnect = __pyx_f_9playhouse_11_sqlite_ext_pwConnect;
 
-  /* "playhouse/_sqlite_ext.pyx":643
+  /* "playhouse/_sqlite_ext.pyx":642
  *         self.module.xCreate = NULL
  *         self.module.xConnect = pwConnect
  *         self.module.xBestIndex = pwBestIndex             # <<<<<<<<<<<<<<
  *         self.module.xDisconnect = pwDisconnect
  *         self.module.xDestroy = NULL
  */
   __pyx_v_self->module.xBestIndex = __pyx_f_9playhouse_11_sqlite_ext_pwBestIndex;
 
-  /* "playhouse/_sqlite_ext.pyx":644
+  /* "playhouse/_sqlite_ext.pyx":643
  *         self.module.xConnect = pwConnect
  *         self.module.xBestIndex = pwBestIndex
  *         self.module.xDisconnect = pwDisconnect             # <<<<<<<<<<<<<<
  *         self.module.xDestroy = NULL
  *         self.module.xOpen = pwOpen
  */
   __pyx_v_self->module.xDisconnect = __pyx_f_9playhouse_11_sqlite_ext_pwDisconnect;
 
-  /* "playhouse/_sqlite_ext.pyx":645
+  /* "playhouse/_sqlite_ext.pyx":644
  *         self.module.xBestIndex = pwBestIndex
  *         self.module.xDisconnect = pwDisconnect
  *         self.module.xDestroy = NULL             # <<<<<<<<<<<<<<
  *         self.module.xOpen = pwOpen
  *         self.module.xClose = pwClose
  */
   __pyx_v_self->module.xDestroy = NULL;
 
-  /* "playhouse/_sqlite_ext.pyx":646
+  /* "playhouse/_sqlite_ext.pyx":645
  *         self.module.xDisconnect = pwDisconnect
  *         self.module.xDestroy = NULL
  *         self.module.xOpen = pwOpen             # <<<<<<<<<<<<<<
  *         self.module.xClose = pwClose
  *         self.module.xFilter = pwFilter
  */
   __pyx_v_self->module.xOpen = __pyx_f_9playhouse_11_sqlite_ext_pwOpen;
 
-  /* "playhouse/_sqlite_ext.pyx":647
+  /* "playhouse/_sqlite_ext.pyx":646
  *         self.module.xDestroy = NULL
  *         self.module.xOpen = pwOpen
  *         self.module.xClose = pwClose             # <<<<<<<<<<<<<<
  *         self.module.xFilter = pwFilter
  *         self.module.xNext = pwNext
  */
   __pyx_v_self->module.xClose = __pyx_f_9playhouse_11_sqlite_ext_pwClose;
 
-  /* "playhouse/_sqlite_ext.pyx":648
+  /* "playhouse/_sqlite_ext.pyx":647
  *         self.module.xOpen = pwOpen
  *         self.module.xClose = pwClose
  *         self.module.xFilter = pwFilter             # <<<<<<<<<<<<<<
  *         self.module.xNext = pwNext
  *         self.module.xEof = pwEof
  */
   __pyx_v_self->module.xFilter = __pyx_f_9playhouse_11_sqlite_ext_pwFilter;
 
-  /* "playhouse/_sqlite_ext.pyx":649
+  /* "playhouse/_sqlite_ext.pyx":648
  *         self.module.xClose = pwClose
  *         self.module.xFilter = pwFilter
  *         self.module.xNext = pwNext             # <<<<<<<<<<<<<<
  *         self.module.xEof = pwEof
  *         self.module.xColumn = pwColumn
  */
   __pyx_v_self->module.xNext = __pyx_f_9playhouse_11_sqlite_ext_pwNext;
 
-  /* "playhouse/_sqlite_ext.pyx":650
+  /* "playhouse/_sqlite_ext.pyx":649
  *         self.module.xFilter = pwFilter
  *         self.module.xNext = pwNext
  *         self.module.xEof = pwEof             # <<<<<<<<<<<<<<
  *         self.module.xColumn = pwColumn
  *         self.module.xRowid = pwRowid
  */
   __pyx_v_self->module.xEof = __pyx_f_9playhouse_11_sqlite_ext_pwEof;
 
-  /* "playhouse/_sqlite_ext.pyx":651
+  /* "playhouse/_sqlite_ext.pyx":650
  *         self.module.xNext = pwNext
  *         self.module.xEof = pwEof
  *         self.module.xColumn = pwColumn             # <<<<<<<<<<<<<<
  *         self.module.xRowid = pwRowid
  *         self.module.xUpdate = NULL
  */
   __pyx_v_self->module.xColumn = __pyx_f_9playhouse_11_sqlite_ext_pwColumn;
 
-  /* "playhouse/_sqlite_ext.pyx":652
+  /* "playhouse/_sqlite_ext.pyx":651
  *         self.module.xEof = pwEof
  *         self.module.xColumn = pwColumn
  *         self.module.xRowid = pwRowid             # <<<<<<<<<<<<<<
  *         self.module.xUpdate = NULL
  *         self.module.xBegin = NULL
  */
   __pyx_v_self->module.xRowid = __pyx_f_9playhouse_11_sqlite_ext_pwRowid;
 
-  /* "playhouse/_sqlite_ext.pyx":653
+  /* "playhouse/_sqlite_ext.pyx":652
  *         self.module.xColumn = pwColumn
  *         self.module.xRowid = pwRowid
  *         self.module.xUpdate = NULL             # <<<<<<<<<<<<<<
  *         self.module.xBegin = NULL
  *         self.module.xSync = NULL
  */
   __pyx_v_self->module.xUpdate = NULL;
 
-  /* "playhouse/_sqlite_ext.pyx":654
+  /* "playhouse/_sqlite_ext.pyx":653
  *         self.module.xRowid = pwRowid
  *         self.module.xUpdate = NULL
  *         self.module.xBegin = NULL             # <<<<<<<<<<<<<<
  *         self.module.xSync = NULL
  *         self.module.xCommit = NULL
  */
   __pyx_v_self->module.xBegin = NULL;
 
-  /* "playhouse/_sqlite_ext.pyx":655
+  /* "playhouse/_sqlite_ext.pyx":654
  *         self.module.xUpdate = NULL
  *         self.module.xBegin = NULL
  *         self.module.xSync = NULL             # <<<<<<<<<<<<<<
  *         self.module.xCommit = NULL
  *         self.module.xRollback = NULL
  */
   __pyx_v_self->module.xSync = NULL;
 
-  /* "playhouse/_sqlite_ext.pyx":656
+  /* "playhouse/_sqlite_ext.pyx":655
  *         self.module.xBegin = NULL
  *         self.module.xSync = NULL
  *         self.module.xCommit = NULL             # <<<<<<<<<<<<<<
  *         self.module.xRollback = NULL
  *         self.module.xFindFunction = NULL
  */
   __pyx_v_self->module.xCommit = NULL;
 
-  /* "playhouse/_sqlite_ext.pyx":657
+  /* "playhouse/_sqlite_ext.pyx":656
  *         self.module.xSync = NULL
  *         self.module.xCommit = NULL
  *         self.module.xRollback = NULL             # <<<<<<<<<<<<<<
  *         self.module.xFindFunction = NULL
  *         self.module.xRename = NULL
  */
   __pyx_v_self->module.xRollback = NULL;
 
-  /* "playhouse/_sqlite_ext.pyx":658
+  /* "playhouse/_sqlite_ext.pyx":657
  *         self.module.xCommit = NULL
  *         self.module.xRollback = NULL
  *         self.module.xFindFunction = NULL             # <<<<<<<<<<<<<<
  *         self.module.xRename = NULL
  * 
  */
   __pyx_v_self->module.xFindFunction = NULL;
 
-  /* "playhouse/_sqlite_ext.pyx":659
+  /* "playhouse/_sqlite_ext.pyx":658
  *         self.module.xRollback = NULL
  *         self.module.xFindFunction = NULL
  *         self.module.xRename = NULL             # <<<<<<<<<<<<<<
  * 
  *         # Create the SQLite virtual table.
  */
   __pyx_v_self->module.xRename = NULL;
 
-  /* "playhouse/_sqlite_ext.pyx":664
+  /* "playhouse/_sqlite_ext.pyx":663
  *         rc = sqlite3_create_module(
  *             db,
  *             <const char *>name,             # <<<<<<<<<<<<<<
  *             &self.module,
  *             <void *>(self.table_function))
  */
   if (unlikely(__pyx_v_name == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "expected bytes, NoneType found");
-    __PYX_ERR(0, 664, __pyx_L1_error)
+    __PYX_ERR(0, 663, __pyx_L1_error)
   }
-  __pyx_t_4 = __Pyx_PyBytes_AsString(__pyx_v_name); if (unlikely((!__pyx_t_4) && PyErr_Occurred())) __PYX_ERR(0, 664, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyBytes_AsString(__pyx_v_name); if (unlikely((!__pyx_t_4) && PyErr_Occurred())) __PYX_ERR(0, 663, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":662
+  /* "playhouse/_sqlite_ext.pyx":661
  * 
  *         # Create the SQLite virtual table.
  *         rc = sqlite3_create_module(             # <<<<<<<<<<<<<<
  *             db,
  *             <const char *>name,
  */
   __pyx_v_rc = sqlite3_create_module(__pyx_v_db, ((char const *)__pyx_t_4), (&__pyx_v_self->module), ((void *)__pyx_v_self->table_function));
 
-  /* "playhouse/_sqlite_ext.pyx":668
+  /* "playhouse/_sqlite_ext.pyx":667
  *             <void *>(self.table_function))
  * 
  *         Py_INCREF(self)             # <<<<<<<<<<<<<<
  * 
  *         return rc == SQLITE_OK
  */
   Py_INCREF(((PyObject *)__pyx_v_self));
 
-  /* "playhouse/_sqlite_ext.pyx":670
+  /* "playhouse/_sqlite_ext.pyx":669
  *         Py_INCREF(self)
  * 
  *         return rc == SQLITE_OK             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __Pyx_PyBool_FromLong((__pyx_v_rc == SQLITE_OK)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 670, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyBool_FromLong((__pyx_v_rc == SQLITE_OK)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 669, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":633
+  /* "playhouse/_sqlite_ext.pyx":632
  *         self.table_function = table_function
  * 
  *     cdef create_module(self, pysqlite_Connection* sqlite_conn):             # <<<<<<<<<<<<<<
  *         cdef:
  *             bytes name = encode(self.table_function.name)
  */
 
@@ -6156,15 +6054,15 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(1, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
@@ -6209,15 +6107,15 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(1, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
@@ -6232,25 +6130,25 @@
   __Pyx_AddTraceback("playhouse._sqlite_ext._TableFunctionImpl.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":681
+/* "playhouse/_sqlite_ext.pyx":680
  * 
  *     @classmethod
  *     def register(cls, conn):             # <<<<<<<<<<<<<<
  *         cdef _TableFunctionImpl impl = _TableFunctionImpl(cls)
  *         impl.create_module(<pysqlite_Connection *>conn)
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_13TableFunction_1register(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_13TableFunction_1register = {"register", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_13TableFunction_1register, METH_VARARGS|METH_KEYWORDS, 0};
+static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_13TableFunction_1register = {"register", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_13TableFunction_1register, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_13TableFunction_1register(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_cls = 0;
   PyObject *__pyx_v_conn = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("register (wrapper)", 0);
   {
@@ -6266,38 +6164,38 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_cls)) != 0)) kw_args--;
+        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_cls)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_conn)) != 0)) kw_args--;
+        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_conn)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("register", 1, 2, 2, 1); __PYX_ERR(0, 681, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("register", 1, 2, 2, 1); __PYX_ERR(0, 680, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "register") < 0)) __PYX_ERR(0, 681, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "register") < 0)) __PYX_ERR(0, 680, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_cls = values[0];
     __pyx_v_conn = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("register", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 681, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("register", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 680, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("playhouse._sqlite_ext.TableFunction.register", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_13TableFunction_register(__pyx_self, __pyx_v_cls, __pyx_v_conn);
 
@@ -6307,89 +6205,97 @@
 }
 
 static PyObject *__pyx_pf_9playhouse_11_sqlite_ext_13TableFunction_register(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_cls, PyObject *__pyx_v_conn) {
   struct __pyx_obj_9playhouse_11_sqlite_ext__TableFunctionImpl *__pyx_v_impl = 0;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
-  Py_ssize_t __pyx_t_2;
+  PyObject *__pyx_t_2 = NULL;
+  Py_ssize_t __pyx_t_3;
   __Pyx_RefNannySetupContext("register", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":682
+  /* "playhouse/_sqlite_ext.pyx":681
  *     @classmethod
  *     def register(cls, conn):
  *         cdef _TableFunctionImpl impl = _TableFunctionImpl(cls)             # <<<<<<<<<<<<<<
  *         impl.create_module(<pysqlite_Connection *>conn)
  *         cls._ncols = len(cls.columns)
  */
-  __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)__pyx_ptype_9playhouse_11_sqlite_ext__TableFunctionImpl), __pyx_v_cls); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 682, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 681, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_v_impl = ((struct __pyx_obj_9playhouse_11_sqlite_ext__TableFunctionImpl *)__pyx_t_1);
-  __pyx_t_1 = 0;
+  __Pyx_INCREF(__pyx_v_cls);
+  __Pyx_GIVEREF(__pyx_v_cls);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_cls);
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_9playhouse_11_sqlite_ext__TableFunctionImpl), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 681, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_impl = ((struct __pyx_obj_9playhouse_11_sqlite_ext__TableFunctionImpl *)__pyx_t_2);
+  __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":683
+  /* "playhouse/_sqlite_ext.pyx":682
  *     def register(cls, conn):
  *         cdef _TableFunctionImpl impl = _TableFunctionImpl(cls)
  *         impl.create_module(<pysqlite_Connection *>conn)             # <<<<<<<<<<<<<<
  *         cls._ncols = len(cls.columns)
  * 
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_9playhouse_11_sqlite_ext__TableFunctionImpl *)__pyx_v_impl->__pyx_vtab)->create_module(__pyx_v_impl, ((pysqlite_Connection *)__pyx_v_conn)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 683, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_2 = ((struct __pyx_vtabstruct_9playhouse_11_sqlite_ext__TableFunctionImpl *)__pyx_v_impl->__pyx_vtab)->create_module(__pyx_v_impl, ((pysqlite_Connection *)__pyx_v_conn)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 682, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":684
+  /* "playhouse/_sqlite_ext.pyx":683
  *         cdef _TableFunctionImpl impl = _TableFunctionImpl(cls)
  *         impl.create_module(<pysqlite_Connection *>conn)
  *         cls._ncols = len(cls.columns)             # <<<<<<<<<<<<<<
  * 
  *     def initialize(self, **filters):
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_cls, __pyx_n_s_columns); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 684, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 684, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 684, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_cls, __pyx_n_s_ncols, __pyx_t_1) < 0) __PYX_ERR(0, 684, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_cls, __pyx_n_s_columns); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 683, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = PyObject_Length(__pyx_t_2); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 683, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 683, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_cls, __pyx_n_s_ncols, __pyx_t_2) < 0) __PYX_ERR(0, 683, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":681
+  /* "playhouse/_sqlite_ext.pyx":680
  * 
  *     @classmethod
  *     def register(cls, conn):             # <<<<<<<<<<<<<<
  *         cdef _TableFunctionImpl impl = _TableFunctionImpl(cls)
  *         impl.create_module(<pysqlite_Connection *>conn)
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
   __Pyx_AddTraceback("playhouse._sqlite_ext.TableFunction.register", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_impl);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":686
+/* "playhouse/_sqlite_ext.pyx":685
  *         cls._ncols = len(cls.columns)
  * 
  *     def initialize(self, **filters):             # <<<<<<<<<<<<<<
  *         raise NotImplementedError
  * 
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_13TableFunction_3initialize(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_13TableFunction_3initialize = {"initialize", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_13TableFunction_3initialize, METH_VARARGS|METH_KEYWORDS, 0};
+static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_13TableFunction_3initialize = {"initialize", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_13TableFunction_3initialize, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_13TableFunction_3initialize(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   CYTHON_UNUSED PyObject *__pyx_v_self = 0;
   CYTHON_UNUSED PyObject *__pyx_v_filters = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("initialize (wrapper)", 0);
   __pyx_v_filters = PyDict_New(); if (unlikely(!__pyx_v_filters)) return NULL;
@@ -6405,30 +6311,30 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
+        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_filters, values, pos_args, "initialize") < 0)) __PYX_ERR(0, 686, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_filters, values, pos_args, "initialize") < 0)) __PYX_ERR(0, 685, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
     }
     __pyx_v_self = values[0];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("initialize", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 686, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("initialize", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 685, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_DECREF(__pyx_v_filters); __pyx_v_filters = 0;
   __Pyx_AddTraceback("playhouse._sqlite_ext.TableFunction.initialize", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_13TableFunction_2initialize(__pyx_self, __pyx_v_self, __pyx_v_filters);
@@ -6440,25 +6346,25 @@
 }
 
 static PyObject *__pyx_pf_9playhouse_11_sqlite_ext_13TableFunction_2initialize(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_filters) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("initialize", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":687
+  /* "playhouse/_sqlite_ext.pyx":686
  * 
  *     def initialize(self, **filters):
  *         raise NotImplementedError             # <<<<<<<<<<<<<<
  * 
  *     def iterate(self, idx):
  */
   __Pyx_Raise(__pyx_builtin_NotImplementedError, 0, 0, 0);
-  __PYX_ERR(0, 687, __pyx_L1_error)
+  __PYX_ERR(0, 686, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":686
+  /* "playhouse/_sqlite_ext.pyx":685
  *         cls._ncols = len(cls.columns)
  * 
  *     def initialize(self, **filters):             # <<<<<<<<<<<<<<
  *         raise NotImplementedError
  * 
  */
 
@@ -6467,25 +6373,25 @@
   __Pyx_AddTraceback("playhouse._sqlite_ext.TableFunction.initialize", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":689
+/* "playhouse/_sqlite_ext.pyx":688
  *         raise NotImplementedError
  * 
  *     def iterate(self, idx):             # <<<<<<<<<<<<<<
  *         raise NotImplementedError
  * 
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_13TableFunction_5iterate(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_13TableFunction_5iterate = {"iterate", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_13TableFunction_5iterate, METH_VARARGS|METH_KEYWORDS, 0};
+static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_13TableFunction_5iterate = {"iterate", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_13TableFunction_5iterate, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_13TableFunction_5iterate(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   CYTHON_UNUSED PyObject *__pyx_v_self = 0;
   CYTHON_UNUSED PyObject *__pyx_v_idx = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("iterate (wrapper)", 0);
   {
@@ -6501,38 +6407,38 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
+        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_idx)) != 0)) kw_args--;
+        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_idx)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("iterate", 1, 2, 2, 1); __PYX_ERR(0, 689, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("iterate", 1, 2, 2, 1); __PYX_ERR(0, 688, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "iterate") < 0)) __PYX_ERR(0, 689, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "iterate") < 0)) __PYX_ERR(0, 688, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_self = values[0];
     __pyx_v_idx = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("iterate", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 689, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("iterate", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 688, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("playhouse._sqlite_ext.TableFunction.iterate", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_13TableFunction_4iterate(__pyx_self, __pyx_v_self, __pyx_v_idx);
 
@@ -6542,25 +6448,25 @@
 }
 
 static PyObject *__pyx_pf_9playhouse_11_sqlite_ext_13TableFunction_4iterate(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_idx) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("iterate", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":690
+  /* "playhouse/_sqlite_ext.pyx":689
  * 
  *     def iterate(self, idx):
  *         raise NotImplementedError             # <<<<<<<<<<<<<<
  * 
  *     @classmethod
  */
   __Pyx_Raise(__pyx_builtin_NotImplementedError, 0, 0, 0);
-  __PYX_ERR(0, 690, __pyx_L1_error)
+  __PYX_ERR(0, 689, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":689
+  /* "playhouse/_sqlite_ext.pyx":688
  *         raise NotImplementedError
  * 
  *     def iterate(self, idx):             # <<<<<<<<<<<<<<
  *         raise NotImplementedError
  * 
  */
 
@@ -6569,15 +6475,15 @@
   __Pyx_AddTraceback("playhouse._sqlite_ext.TableFunction.iterate", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":693
+/* "playhouse/_sqlite_ext.pyx":692
  * 
  *     @classmethod
  *     def get_table_columns_declaration(cls):             # <<<<<<<<<<<<<<
  *         cdef list accum = []
  * 
  */
 
@@ -6607,255 +6513,255 @@
   PyObject *(*__pyx_t_4)(PyObject *);
   int __pyx_t_5;
   int __pyx_t_6;
   Py_ssize_t __pyx_t_7;
   int __pyx_t_8;
   __Pyx_RefNannySetupContext("get_table_columns_declaration", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":694
+  /* "playhouse/_sqlite_ext.pyx":693
  *     @classmethod
  *     def get_table_columns_declaration(cls):
  *         cdef list accum = []             # <<<<<<<<<<<<<<
  * 
  *         for column in cls.columns:
  */
-  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 694, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 693, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_accum = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":696
+  /* "playhouse/_sqlite_ext.pyx":695
  *         cdef list accum = []
  * 
  *         for column in cls.columns:             # <<<<<<<<<<<<<<
  *             if isinstance(column, tuple):
  *                 if len(column) != 2:
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_cls, __pyx_n_s_columns); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 696, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_cls, __pyx_n_s_columns); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 695, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
     __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
     __pyx_t_4 = NULL;
   } else {
-    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 696, __pyx_L1_error)
+    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 695, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 696, __pyx_L1_error)
+    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 695, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_4)) {
       if (likely(PyList_CheckExact(__pyx_t_2))) {
         if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 696, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 695, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 696, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 695, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
         if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 696, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 695, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 696, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 695, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
       __pyx_t_1 = __pyx_t_4(__pyx_t_2);
       if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 696, __pyx_L1_error)
+          else __PYX_ERR(0, 695, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XDECREF_SET(__pyx_v_column, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":697
+    /* "playhouse/_sqlite_ext.pyx":696
  * 
  *         for column in cls.columns:
  *             if isinstance(column, tuple):             # <<<<<<<<<<<<<<
  *                 if len(column) != 2:
  *                     raise ValueError('Column must be either a string or a '
  */
     __pyx_t_5 = PyTuple_Check(__pyx_v_column); 
     __pyx_t_6 = (__pyx_t_5 != 0);
     if (__pyx_t_6) {
 
-      /* "playhouse/_sqlite_ext.pyx":698
+      /* "playhouse/_sqlite_ext.pyx":697
  *         for column in cls.columns:
  *             if isinstance(column, tuple):
  *                 if len(column) != 2:             # <<<<<<<<<<<<<<
  *                     raise ValueError('Column must be either a string or a '
  *                                      '2-tuple of name, type')
  */
-      __pyx_t_7 = PyObject_Length(__pyx_v_column); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 698, __pyx_L1_error)
+      __pyx_t_7 = PyObject_Length(__pyx_v_column); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 697, __pyx_L1_error)
       __pyx_t_6 = ((__pyx_t_7 != 2) != 0);
-      if (unlikely(__pyx_t_6)) {
+      if (__pyx_t_6) {
 
-        /* "playhouse/_sqlite_ext.pyx":699
+        /* "playhouse/_sqlite_ext.pyx":698
  *             if isinstance(column, tuple):
  *                 if len(column) != 2:
  *                     raise ValueError('Column must be either a string or a '             # <<<<<<<<<<<<<<
  *                                      '2-tuple of name, type')
  *                 accum.append('%s %s' % column)
  */
-        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 699, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 698, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_Raise(__pyx_t_1, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __PYX_ERR(0, 699, __pyx_L1_error)
+        __PYX_ERR(0, 698, __pyx_L1_error)
 
-        /* "playhouse/_sqlite_ext.pyx":698
+        /* "playhouse/_sqlite_ext.pyx":697
  *         for column in cls.columns:
  *             if isinstance(column, tuple):
  *                 if len(column) != 2:             # <<<<<<<<<<<<<<
  *                     raise ValueError('Column must be either a string or a '
  *                                      '2-tuple of name, type')
  */
       }
 
-      /* "playhouse/_sqlite_ext.pyx":701
+      /* "playhouse/_sqlite_ext.pyx":700
  *                     raise ValueError('Column must be either a string or a '
  *                                      '2-tuple of name, type')
  *                 accum.append('%s %s' % column)             # <<<<<<<<<<<<<<
  *             else:
  *                 accum.append(column)
  */
-      __pyx_t_1 = __Pyx_PyString_FormatSafe(__pyx_kp_s_s_s, __pyx_v_column); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 701, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyString_Format(__pyx_kp_s_s_s, __pyx_v_column); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 700, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_8 = __Pyx_PyList_Append(__pyx_v_accum, __pyx_t_1); if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 701, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyList_Append(__pyx_v_accum, __pyx_t_1); if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 700, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "playhouse/_sqlite_ext.pyx":697
+      /* "playhouse/_sqlite_ext.pyx":696
  * 
  *         for column in cls.columns:
  *             if isinstance(column, tuple):             # <<<<<<<<<<<<<<
  *                 if len(column) != 2:
  *                     raise ValueError('Column must be either a string or a '
  */
       goto __pyx_L5;
     }
 
-    /* "playhouse/_sqlite_ext.pyx":703
+    /* "playhouse/_sqlite_ext.pyx":702
  *                 accum.append('%s %s' % column)
  *             else:
  *                 accum.append(column)             # <<<<<<<<<<<<<<
  * 
  *         for param in cls.params:
  */
     /*else*/ {
-      __pyx_t_8 = __Pyx_PyList_Append(__pyx_v_accum, __pyx_v_column); if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 703, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyList_Append(__pyx_v_accum, __pyx_v_column); if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 702, __pyx_L1_error)
     }
     __pyx_L5:;
 
-    /* "playhouse/_sqlite_ext.pyx":696
+    /* "playhouse/_sqlite_ext.pyx":695
  *         cdef list accum = []
  * 
  *         for column in cls.columns:             # <<<<<<<<<<<<<<
  *             if isinstance(column, tuple):
  *                 if len(column) != 2:
  */
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":705
+  /* "playhouse/_sqlite_ext.pyx":704
  *                 accum.append(column)
  * 
  *         for param in cls.params:             # <<<<<<<<<<<<<<
  *             accum.append('%s HIDDEN' % param)
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_cls, __pyx_n_s_params); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 705, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_cls, __pyx_n_s_params); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 704, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
     __pyx_t_1 = __pyx_t_2; __Pyx_INCREF(__pyx_t_1); __pyx_t_3 = 0;
     __pyx_t_4 = NULL;
   } else {
-    __pyx_t_3 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 705, __pyx_L1_error)
+    __pyx_t_3 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 704, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 705, __pyx_L1_error)
+    __pyx_t_4 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 704, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   for (;;) {
     if (likely(!__pyx_t_4)) {
       if (likely(PyList_CheckExact(__pyx_t_1))) {
         if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 705, __pyx_L1_error)
+        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 704, __pyx_L1_error)
         #else
-        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 705, __pyx_L1_error)
+        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 704, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         #endif
       } else {
         if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 705, __pyx_L1_error)
+        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 704, __pyx_L1_error)
         #else
-        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 705, __pyx_L1_error)
+        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 704, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         #endif
       }
     } else {
       __pyx_t_2 = __pyx_t_4(__pyx_t_1);
       if (unlikely(!__pyx_t_2)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 705, __pyx_L1_error)
+          else __PYX_ERR(0, 704, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_2);
     }
     __Pyx_XDECREF_SET(__pyx_v_param, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":706
+    /* "playhouse/_sqlite_ext.pyx":705
  * 
  *         for param in cls.params:
  *             accum.append('%s HIDDEN' % param)             # <<<<<<<<<<<<<<
  * 
  *         return ', '.join(accum)
  */
-    __pyx_t_2 = __Pyx_PyString_FormatSafe(__pyx_kp_s_s_HIDDEN, __pyx_v_param); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 706, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyString_Format(__pyx_kp_s_s_HIDDEN, __pyx_v_param); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 705, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_8 = __Pyx_PyList_Append(__pyx_v_accum, __pyx_t_2); if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 706, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyList_Append(__pyx_v_accum, __pyx_t_2); if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 705, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":705
+    /* "playhouse/_sqlite_ext.pyx":704
  *                 accum.append(column)
  * 
  *         for param in cls.params:             # <<<<<<<<<<<<<<
  *             accum.append('%s HIDDEN' % param)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":708
+  /* "playhouse/_sqlite_ext.pyx":707
  *             accum.append('%s HIDDEN' % param)
  * 
  *         return ', '.join(accum)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyString_Join(__pyx_kp_s__5, __pyx_v_accum); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 708, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyString_Join(__pyx_kp_s__6, __pyx_v_accum); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 707, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":693
+  /* "playhouse/_sqlite_ext.pyx":692
  * 
  *     @classmethod
  *     def get_table_columns_declaration(cls):             # <<<<<<<<<<<<<<
  *         cdef list accum = []
  * 
  */
 
@@ -6870,15 +6776,15 @@
   __Pyx_XDECREF(__pyx_v_column);
   __Pyx_XDECREF(__pyx_v_param);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":728
+/* "playhouse/_sqlite_ext.pyx":727
  * 
  * 
  * cdef tuple validate_and_format_datetime(lookup, date_str):             # <<<<<<<<<<<<<<
  *     if not date_str or not lookup:
  *         return
  */
 
@@ -6900,149 +6806,152 @@
   PyObject *__pyx_t_10 = NULL;
   PyObject *__pyx_t_11 = NULL;
   int __pyx_t_12;
   PyObject *__pyx_t_13 = NULL;
   __Pyx_RefNannySetupContext("validate_and_format_datetime", 0);
   __Pyx_INCREF(__pyx_v_lookup);
 
-  /* "playhouse/_sqlite_ext.pyx":729
+  /* "playhouse/_sqlite_ext.pyx":728
  * 
  * cdef tuple validate_and_format_datetime(lookup, date_str):
  *     if not date_str or not lookup:             # <<<<<<<<<<<<<<
  *         return
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_date_str); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 729, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_date_str); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 728, __pyx_L1_error)
   __pyx_t_3 = ((!__pyx_t_2) != 0);
   if (!__pyx_t_3) {
   } else {
     __pyx_t_1 = __pyx_t_3;
     goto __pyx_L4_bool_binop_done;
   }
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_lookup); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 729, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_lookup); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 728, __pyx_L1_error)
   __pyx_t_2 = ((!__pyx_t_3) != 0);
   __pyx_t_1 = __pyx_t_2;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "playhouse/_sqlite_ext.pyx":730
+    /* "playhouse/_sqlite_ext.pyx":729
  * cdef tuple validate_and_format_datetime(lookup, date_str):
  *     if not date_str or not lookup:
  *         return             # <<<<<<<<<<<<<<
  * 
  *     lookup = lookup.lower()
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = ((PyObject*)Py_None); __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "playhouse/_sqlite_ext.pyx":729
+    /* "playhouse/_sqlite_ext.pyx":728
  * 
  * cdef tuple validate_and_format_datetime(lookup, date_str):
  *     if not date_str or not lookup:             # <<<<<<<<<<<<<<
  *         return
  * 
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":732
+  /* "playhouse/_sqlite_ext.pyx":731
  *         return
  * 
  *     lookup = lookup.lower()             # <<<<<<<<<<<<<<
  *     if lookup not in SQLITE_DATE_TRUNC_MAPPING:
  *         return
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_lookup, __pyx_n_s_lower); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 732, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_lookup, __pyx_n_s_lower); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 731, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
-  __pyx_t_4 = (__pyx_t_6) ? __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6) : __Pyx_PyObject_CallNoArg(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 732, __pyx_L1_error)
+  if (__pyx_t_6) {
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 731, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  } else {
+    __pyx_t_4 = __Pyx_PyObject_CallNoArg(__pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 731, __pyx_L1_error)
+  }
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF_SET(__pyx_v_lookup, __pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":733
+  /* "playhouse/_sqlite_ext.pyx":732
  * 
  *     lookup = lookup.lower()
  *     if lookup not in SQLITE_DATE_TRUNC_MAPPING:             # <<<<<<<<<<<<<<
  *         return
  * 
  */
   if (unlikely(__pyx_v_9playhouse_11_sqlite_ext_SQLITE_DATE_TRUNC_MAPPING == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 733, __pyx_L1_error)
+    __PYX_ERR(0, 732, __pyx_L1_error)
   }
-  __pyx_t_1 = (__Pyx_PyDict_ContainsTF(__pyx_v_lookup, __pyx_v_9playhouse_11_sqlite_ext_SQLITE_DATE_TRUNC_MAPPING, Py_NE)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 733, __pyx_L1_error)
+  __pyx_t_1 = (__Pyx_PyDict_ContainsTF(__pyx_v_lookup, __pyx_v_9playhouse_11_sqlite_ext_SQLITE_DATE_TRUNC_MAPPING, Py_NE)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 732, __pyx_L1_error)
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":734
+    /* "playhouse/_sqlite_ext.pyx":733
  *     lookup = lookup.lower()
  *     if lookup not in SQLITE_DATE_TRUNC_MAPPING:
  *         return             # <<<<<<<<<<<<<<
  * 
  *     cdef datetime.datetime date_obj
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = ((PyObject*)Py_None); __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "playhouse/_sqlite_ext.pyx":733
+    /* "playhouse/_sqlite_ext.pyx":732
  * 
  *     lookup = lookup.lower()
  *     if lookup not in SQLITE_DATE_TRUNC_MAPPING:             # <<<<<<<<<<<<<<
  *         return
  * 
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":737
+  /* "playhouse/_sqlite_ext.pyx":736
  * 
  *     cdef datetime.datetime date_obj
  *     cdef bint success = False             # <<<<<<<<<<<<<<
  * 
  *     for date_format in SQLITE_DATETIME_FORMATS:
  */
   __pyx_v_success = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":739
+  /* "playhouse/_sqlite_ext.pyx":738
  *     cdef bint success = False
  * 
  *     for date_format in SQLITE_DATETIME_FORMATS:             # <<<<<<<<<<<<<<
  *         try:
  *             date_obj = datetime.datetime.strptime(date_str, date_format)
  */
   if (unlikely(__pyx_v_9playhouse_11_sqlite_ext_SQLITE_DATETIME_FORMATS == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 739, __pyx_L1_error)
+    __PYX_ERR(0, 738, __pyx_L1_error)
   }
   __pyx_t_4 = __pyx_v_9playhouse_11_sqlite_ext_SQLITE_DATETIME_FORMATS; __Pyx_INCREF(__pyx_t_4); __pyx_t_7 = 0;
   for (;;) {
     if (__pyx_t_7 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_7); __Pyx_INCREF(__pyx_t_5); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 739, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_7); __Pyx_INCREF(__pyx_t_5); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 738, __pyx_L1_error)
     #else
-    __pyx_t_5 = PySequence_ITEM(__pyx_t_4, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 739, __pyx_L1_error)
+    __pyx_t_5 = PySequence_ITEM(__pyx_t_4, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 738, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     #endif
     __Pyx_XDECREF_SET(__pyx_v_date_format, __pyx_t_5);
     __pyx_t_5 = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":740
+    /* "playhouse/_sqlite_ext.pyx":739
  * 
  *     for date_format in SQLITE_DATETIME_FORMATS:
  *         try:             # <<<<<<<<<<<<<<
  *             date_obj = datetime.datetime.strptime(date_str, date_format)
  *         except ValueError:
  */
     {
@@ -7050,22 +6959,22 @@
       __Pyx_PyThreadState_assign
       __Pyx_ExceptionSave(&__pyx_t_8, &__pyx_t_9, &__pyx_t_10);
       __Pyx_XGOTREF(__pyx_t_8);
       __Pyx_XGOTREF(__pyx_t_9);
       __Pyx_XGOTREF(__pyx_t_10);
       /*try:*/ {
 
-        /* "playhouse/_sqlite_ext.pyx":741
+        /* "playhouse/_sqlite_ext.pyx":740
  *     for date_format in SQLITE_DATETIME_FORMATS:
  *         try:
  *             date_obj = datetime.datetime.strptime(date_str, date_format)             # <<<<<<<<<<<<<<
  *         except ValueError:
  *             pass
  */
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_7cpython_8datetime_datetime), __pyx_n_s_strptime); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 741, __pyx_L9_error)
+        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_7cpython_8datetime_datetime), __pyx_n_s_strptime); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 740, __pyx_L9_error)
         __Pyx_GOTREF(__pyx_t_6);
         __pyx_t_11 = NULL;
         __pyx_t_12 = 0;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
           __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_6);
           if (likely(__pyx_t_11)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
@@ -7074,67 +6983,67 @@
             __Pyx_DECREF_SET(__pyx_t_6, function);
             __pyx_t_12 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_6)) {
           PyObject *__pyx_temp[3] = {__pyx_t_11, __pyx_v_date_str, __pyx_v_date_format};
-          __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_12, 2+__pyx_t_12); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 741, __pyx_L9_error)
+          __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_12, 2+__pyx_t_12); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 740, __pyx_L9_error)
           __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
           __Pyx_GOTREF(__pyx_t_5);
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_6)) {
           PyObject *__pyx_temp[3] = {__pyx_t_11, __pyx_v_date_str, __pyx_v_date_format};
-          __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_12, 2+__pyx_t_12); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 741, __pyx_L9_error)
+          __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_12, 2+__pyx_t_12); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 740, __pyx_L9_error)
           __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
           __Pyx_GOTREF(__pyx_t_5);
         } else
         #endif
         {
-          __pyx_t_13 = PyTuple_New(2+__pyx_t_12); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 741, __pyx_L9_error)
+          __pyx_t_13 = PyTuple_New(2+__pyx_t_12); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 740, __pyx_L9_error)
           __Pyx_GOTREF(__pyx_t_13);
           if (__pyx_t_11) {
             __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_11); __pyx_t_11 = NULL;
           }
           __Pyx_INCREF(__pyx_v_date_str);
           __Pyx_GIVEREF(__pyx_v_date_str);
           PyTuple_SET_ITEM(__pyx_t_13, 0+__pyx_t_12, __pyx_v_date_str);
           __Pyx_INCREF(__pyx_v_date_format);
           __Pyx_GIVEREF(__pyx_v_date_format);
           PyTuple_SET_ITEM(__pyx_t_13, 1+__pyx_t_12, __pyx_v_date_format);
-          __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_13, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 741, __pyx_L9_error)
+          __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_13, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 740, __pyx_L9_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         }
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_7cpython_8datetime_datetime))))) __PYX_ERR(0, 741, __pyx_L9_error)
+        if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_7cpython_8datetime_datetime))))) __PYX_ERR(0, 740, __pyx_L9_error)
         __Pyx_XDECREF_SET(__pyx_v_date_obj, ((PyDateTime_DateTime *)__pyx_t_5));
         __pyx_t_5 = 0;
 
-        /* "playhouse/_sqlite_ext.pyx":740
+        /* "playhouse/_sqlite_ext.pyx":739
  * 
  *     for date_format in SQLITE_DATETIME_FORMATS:
  *         try:             # <<<<<<<<<<<<<<
  *             date_obj = datetime.datetime.strptime(date_str, date_format)
  *         except ValueError:
  */
       }
 
-      /* "playhouse/_sqlite_ext.pyx":745
+      /* "playhouse/_sqlite_ext.pyx":744
  *             pass
  *         else:
  *             return (date_obj, lookup)             # <<<<<<<<<<<<<<
  * 
  * 
  */
       /*else:*/ {
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 745, __pyx_L11_except_error)
+        __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 744, __pyx_L11_except_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_INCREF(((PyObject *)__pyx_v_date_obj));
         __Pyx_GIVEREF(((PyObject *)__pyx_v_date_obj));
         PyTuple_SET_ITEM(__pyx_t_5, 0, ((PyObject *)__pyx_v_date_obj));
         __Pyx_INCREF(__pyx_v_lookup);
         __Pyx_GIVEREF(__pyx_v_lookup);
         PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_lookup);
@@ -7142,33 +7051,33 @@
         __pyx_t_5 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         goto __pyx_L12_except_return;
       }
       __pyx_L9_error:;
       __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
-      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-      /* "playhouse/_sqlite_ext.pyx":742
+      /* "playhouse/_sqlite_ext.pyx":741
  *         try:
  *             date_obj = datetime.datetime.strptime(date_str, date_format)
  *         except ValueError:             # <<<<<<<<<<<<<<
  *             pass
  *         else:
  */
       __pyx_t_12 = __Pyx_PyErr_ExceptionMatches(__pyx_builtin_ValueError);
       if (__pyx_t_12) {
         __Pyx_ErrRestore(0,0,0);
         goto __pyx_L10_exception_handled;
       }
       goto __pyx_L11_except_error;
       __pyx_L11_except_error:;
 
-      /* "playhouse/_sqlite_ext.pyx":740
+      /* "playhouse/_sqlite_ext.pyx":739
  * 
  *     for date_format in SQLITE_DATETIME_FORMATS:
  *         try:             # <<<<<<<<<<<<<<
  *             date_obj = datetime.datetime.strptime(date_str, date_format)
  *         except ValueError:
  */
       __Pyx_XGIVEREF(__pyx_t_8);
@@ -7185,25 +7094,25 @@
       __pyx_L10_exception_handled:;
       __Pyx_XGIVEREF(__pyx_t_8);
       __Pyx_XGIVEREF(__pyx_t_9);
       __Pyx_XGIVEREF(__pyx_t_10);
       __Pyx_ExceptionReset(__pyx_t_8, __pyx_t_9, __pyx_t_10);
     }
 
-    /* "playhouse/_sqlite_ext.pyx":739
+    /* "playhouse/_sqlite_ext.pyx":738
  *     cdef bint success = False
  * 
  *     for date_format in SQLITE_DATETIME_FORMATS:             # <<<<<<<<<<<<<<
  *         try:
  *             date_obj = datetime.datetime.strptime(date_str, date_format)
  */
   }
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":728
+  /* "playhouse/_sqlite_ext.pyx":727
  * 
  * 
  * cdef tuple validate_and_format_datetime(lookup, date_str):             # <<<<<<<<<<<<<<
  *     if not date_str or not lookup:
  *         return
  */
 
@@ -7223,15 +7132,15 @@
   __Pyx_XDECREF(__pyx_v_date_format);
   __Pyx_XDECREF(__pyx_v_lookup);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":748
+/* "playhouse/_sqlite_ext.pyx":747
  * 
  * 
  * cdef inline bytes encode(key):             # <<<<<<<<<<<<<<
  *     cdef bytes bkey
  *     if PyUnicode_Check(key):
  */
 
@@ -7241,140 +7150,147 @@
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_t_3;
   PyObject *__pyx_t_4 = NULL;
   __Pyx_RefNannySetupContext("encode", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":750
+  /* "playhouse/_sqlite_ext.pyx":749
  * cdef inline bytes encode(key):
  *     cdef bytes bkey
  *     if PyUnicode_Check(key):             # <<<<<<<<<<<<<<
  *         bkey = PyUnicode_AsUTF8String(key)
  *     elif PyBytes_Check(key):
  */
   __pyx_t_1 = (PyUnicode_Check(__pyx_v_key) != 0);
   if (__pyx_t_1) {
 
-    /* "playhouse/_sqlite_ext.pyx":751
+    /* "playhouse/_sqlite_ext.pyx":750
  *     cdef bytes bkey
  *     if PyUnicode_Check(key):
  *         bkey = PyUnicode_AsUTF8String(key)             # <<<<<<<<<<<<<<
  *     elif PyBytes_Check(key):
  *         bkey = <bytes>key
  */
-    __pyx_t_2 = PyUnicode_AsUTF8String(__pyx_v_key); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 751, __pyx_L1_error)
+    __pyx_t_2 = PyUnicode_AsUTF8String(__pyx_v_key); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 750, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_bkey = ((PyObject*)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":750
+    /* "playhouse/_sqlite_ext.pyx":749
  * cdef inline bytes encode(key):
  *     cdef bytes bkey
  *     if PyUnicode_Check(key):             # <<<<<<<<<<<<<<
  *         bkey = PyUnicode_AsUTF8String(key)
  *     elif PyBytes_Check(key):
  */
     goto __pyx_L3;
   }
 
-  /* "playhouse/_sqlite_ext.pyx":752
+  /* "playhouse/_sqlite_ext.pyx":751
  *     if PyUnicode_Check(key):
  *         bkey = PyUnicode_AsUTF8String(key)
  *     elif PyBytes_Check(key):             # <<<<<<<<<<<<<<
  *         bkey = <bytes>key
  *     elif key is None:
  */
   __pyx_t_1 = (PyBytes_Check(__pyx_v_key) != 0);
   if (__pyx_t_1) {
 
-    /* "playhouse/_sqlite_ext.pyx":753
+    /* "playhouse/_sqlite_ext.pyx":752
  *         bkey = PyUnicode_AsUTF8String(key)
  *     elif PyBytes_Check(key):
  *         bkey = <bytes>key             # <<<<<<<<<<<<<<
  *     elif key is None:
  *         return None
  */
     __pyx_t_2 = __pyx_v_key;
     __Pyx_INCREF(__pyx_t_2);
     __pyx_v_bkey = ((PyObject*)__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":752
+    /* "playhouse/_sqlite_ext.pyx":751
  *     if PyUnicode_Check(key):
  *         bkey = PyUnicode_AsUTF8String(key)
  *     elif PyBytes_Check(key):             # <<<<<<<<<<<<<<
  *         bkey = <bytes>key
  *     elif key is None:
  */
     goto __pyx_L3;
   }
 
-  /* "playhouse/_sqlite_ext.pyx":754
+  /* "playhouse/_sqlite_ext.pyx":753
  *     elif PyBytes_Check(key):
  *         bkey = <bytes>key
  *     elif key is None:             # <<<<<<<<<<<<<<
  *         return None
  *     else:
  */
   __pyx_t_1 = (__pyx_v_key == Py_None);
   __pyx_t_3 = (__pyx_t_1 != 0);
   if (__pyx_t_3) {
 
-    /* "playhouse/_sqlite_ext.pyx":755
+    /* "playhouse/_sqlite_ext.pyx":754
  *         bkey = <bytes>key
  *     elif key is None:
  *         return None             # <<<<<<<<<<<<<<
  *     else:
  *         bkey = PyUnicode_AsUTF8String(str(key))
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_r = ((PyObject*)Py_None); __Pyx_INCREF(Py_None);
+    __Pyx_INCREF(Py_None);
+    __pyx_r = ((PyObject*)Py_None);
     goto __pyx_L0;
 
-    /* "playhouse/_sqlite_ext.pyx":754
+    /* "playhouse/_sqlite_ext.pyx":753
  *     elif PyBytes_Check(key):
  *         bkey = <bytes>key
  *     elif key is None:             # <<<<<<<<<<<<<<
  *         return None
  *     else:
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":757
+  /* "playhouse/_sqlite_ext.pyx":756
  *         return None
  *     else:
  *         bkey = PyUnicode_AsUTF8String(str(key))             # <<<<<<<<<<<<<<
  *     return bkey
  * 
  */
   /*else*/ {
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyString_Type)), __pyx_v_key); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 757, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 756, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = PyUnicode_AsUTF8String(__pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 757, __pyx_L1_error)
+    __Pyx_INCREF(__pyx_v_key);
+    __Pyx_GIVEREF(__pyx_v_key);
+    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_key);
+    __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)(&PyString_Type)), __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 756, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_v_bkey = ((PyObject*)__pyx_t_4);
-    __pyx_t_4 = 0;
+    __pyx_t_2 = PyUnicode_AsUTF8String(__pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 756, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_v_bkey = ((PyObject*)__pyx_t_2);
+    __pyx_t_2 = 0;
   }
   __pyx_L3:;
 
-  /* "playhouse/_sqlite_ext.pyx":758
+  /* "playhouse/_sqlite_ext.pyx":757
  *     else:
  *         bkey = PyUnicode_AsUTF8String(str(key))
  *     return bkey             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_bkey);
   __pyx_r = __pyx_v_bkey;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":748
+  /* "playhouse/_sqlite_ext.pyx":747
  * 
  * 
  * cdef inline bytes encode(key):             # <<<<<<<<<<<<<<
  *     cdef bytes bkey
  *     if PyUnicode_Check(key):
  */
 
@@ -7387,194 +7303,187 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_bkey);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":761
+/* "playhouse/_sqlite_ext.pyx":760
  * 
  * 
  * cdef inline unicode decode(key):             # <<<<<<<<<<<<<<
  *     cdef unicode ukey
  *     if PyBytes_Check(key):
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_9playhouse_11_sqlite_ext_decode(PyObject *__pyx_v_key) {
   PyObject *__pyx_v_ukey = 0;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
-  PyObject *__pyx_t_4 = NULL;
-  int __pyx_t_5;
+  int __pyx_t_4;
   __Pyx_RefNannySetupContext("decode", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":763
+  /* "playhouse/_sqlite_ext.pyx":762
  * cdef inline unicode decode(key):
  *     cdef unicode ukey
  *     if PyBytes_Check(key):             # <<<<<<<<<<<<<<
  *         ukey = key.decode('utf-8')
  *     elif PyUnicode_Check(key):
  */
   __pyx_t_1 = (PyBytes_Check(__pyx_v_key) != 0);
   if (__pyx_t_1) {
 
-    /* "playhouse/_sqlite_ext.pyx":764
+    /* "playhouse/_sqlite_ext.pyx":763
  *     cdef unicode ukey
  *     if PyBytes_Check(key):
  *         ukey = key.decode('utf-8')             # <<<<<<<<<<<<<<
  *     elif PyUnicode_Check(key):
  *         ukey = <unicode>key
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_key, __pyx_n_s_decode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 764, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = NULL;
-    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
-      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
-      if (likely(__pyx_t_4)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-        __Pyx_INCREF(__pyx_t_4);
-        __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_3, function);
-      }
-    }
-    __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_kp_s_utf_8) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_kp_s_utf_8);
-    __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 764, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_key, __pyx_n_s_decode); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 763, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (!(likely(PyUnicode_CheckExact(__pyx_t_2))||((__pyx_t_2) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "unicode", Py_TYPE(__pyx_t_2)->tp_name), 0))) __PYX_ERR(0, 764, __pyx_L1_error)
-    __pyx_v_ukey = ((PyObject*)__pyx_t_2);
-    __pyx_t_2 = 0;
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 763, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    if (!(likely(PyUnicode_CheckExact(__pyx_t_3))||((__pyx_t_3) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "unicode", Py_TYPE(__pyx_t_3)->tp_name), 0))) __PYX_ERR(0, 763, __pyx_L1_error)
+    __pyx_v_ukey = ((PyObject*)__pyx_t_3);
+    __pyx_t_3 = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":763
+    /* "playhouse/_sqlite_ext.pyx":762
  * cdef inline unicode decode(key):
  *     cdef unicode ukey
  *     if PyBytes_Check(key):             # <<<<<<<<<<<<<<
  *         ukey = key.decode('utf-8')
  *     elif PyUnicode_Check(key):
  */
     goto __pyx_L3;
   }
 
-  /* "playhouse/_sqlite_ext.pyx":765
+  /* "playhouse/_sqlite_ext.pyx":764
  *     if PyBytes_Check(key):
  *         ukey = key.decode('utf-8')
  *     elif PyUnicode_Check(key):             # <<<<<<<<<<<<<<
  *         ukey = <unicode>key
  *     elif key is None:
  */
   __pyx_t_1 = (PyUnicode_Check(__pyx_v_key) != 0);
   if (__pyx_t_1) {
 
-    /* "playhouse/_sqlite_ext.pyx":766
+    /* "playhouse/_sqlite_ext.pyx":765
  *         ukey = key.decode('utf-8')
  *     elif PyUnicode_Check(key):
  *         ukey = <unicode>key             # <<<<<<<<<<<<<<
  *     elif key is None:
  *         return None
  */
-    __pyx_t_2 = __pyx_v_key;
-    __Pyx_INCREF(__pyx_t_2);
-    __pyx_v_ukey = ((PyObject*)__pyx_t_2);
-    __pyx_t_2 = 0;
+    __pyx_t_3 = __pyx_v_key;
+    __Pyx_INCREF(__pyx_t_3);
+    __pyx_v_ukey = ((PyObject*)__pyx_t_3);
+    __pyx_t_3 = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":765
+    /* "playhouse/_sqlite_ext.pyx":764
  *     if PyBytes_Check(key):
  *         ukey = key.decode('utf-8')
  *     elif PyUnicode_Check(key):             # <<<<<<<<<<<<<<
  *         ukey = <unicode>key
  *     elif key is None:
  */
     goto __pyx_L3;
   }
 
-  /* "playhouse/_sqlite_ext.pyx":767
+  /* "playhouse/_sqlite_ext.pyx":766
  *     elif PyUnicode_Check(key):
  *         ukey = <unicode>key
  *     elif key is None:             # <<<<<<<<<<<<<<
  *         return None
  *     else:
  */
   __pyx_t_1 = (__pyx_v_key == Py_None);
-  __pyx_t_5 = (__pyx_t_1 != 0);
-  if (__pyx_t_5) {
+  __pyx_t_4 = (__pyx_t_1 != 0);
+  if (__pyx_t_4) {
 
-    /* "playhouse/_sqlite_ext.pyx":768
+    /* "playhouse/_sqlite_ext.pyx":767
  *         ukey = <unicode>key
  *     elif key is None:
  *         return None             # <<<<<<<<<<<<<<
  *     else:
  *         ukey = unicode(key)
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_r = ((PyObject*)Py_None); __Pyx_INCREF(Py_None);
+    __Pyx_INCREF(Py_None);
+    __pyx_r = ((PyObject*)Py_None);
     goto __pyx_L0;
 
-    /* "playhouse/_sqlite_ext.pyx":767
+    /* "playhouse/_sqlite_ext.pyx":766
  *     elif PyUnicode_Check(key):
  *         ukey = <unicode>key
  *     elif key is None:             # <<<<<<<<<<<<<<
  *         return None
  *     else:
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":770
+  /* "playhouse/_sqlite_ext.pyx":769
  *         return None
  *     else:
  *         ukey = unicode(key)             # <<<<<<<<<<<<<<
  *     return ukey
  * 
  */
   /*else*/ {
-    __pyx_t_2 = __Pyx_PyObject_Unicode(__pyx_v_key); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 770, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 769, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_INCREF(__pyx_v_key);
+    __Pyx_GIVEREF(__pyx_v_key);
+    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_key);
+    __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)(&PyUnicode_Type)), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 769, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_v_ukey = ((PyObject*)__pyx_t_2);
     __pyx_t_2 = 0;
   }
   __pyx_L3:;
 
-  /* "playhouse/_sqlite_ext.pyx":771
+  /* "playhouse/_sqlite_ext.pyx":770
  *     else:
  *         ukey = unicode(key)
  *     return ukey             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_ukey);
   __pyx_r = __pyx_v_ukey;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":761
+  /* "playhouse/_sqlite_ext.pyx":760
  * 
  * 
  * cdef inline unicode decode(key):             # <<<<<<<<<<<<<<
  *     cdef unicode ukey
  *     if PyBytes_Check(key):
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_4);
   __Pyx_AddTraceback("playhouse._sqlite_ext.decode", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_ukey);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":774
+/* "playhouse/_sqlite_ext.pyx":773
  * 
  * 
  * cdef double *get_weights(int ncol, tuple raw_weights):             # <<<<<<<<<<<<<<
  *     cdef:
  *         int argc = len(raw_weights)
  */
 
@@ -7584,172 +7493,170 @@
   double *__pyx_v_weights;
   double *__pyx_r;
   __Pyx_RefNannyDeclarations
   Py_ssize_t __pyx_t_1;
   int __pyx_t_2;
   int __pyx_t_3;
   int __pyx_t_4;
-  int __pyx_t_5;
-  PyObject *__pyx_t_6 = NULL;
-  double __pyx_t_7;
+  PyObject *__pyx_t_5 = NULL;
+  double __pyx_t_6;
   __Pyx_RefNannySetupContext("get_weights", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":776
+  /* "playhouse/_sqlite_ext.pyx":775
  * cdef double *get_weights(int ncol, tuple raw_weights):
  *     cdef:
  *         int argc = len(raw_weights)             # <<<<<<<<<<<<<<
  *         int icol
  *         double *weights = <double *>malloc(sizeof(double) * ncol)
  */
   if (unlikely(__pyx_v_raw_weights == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "object of type 'NoneType' has no len()");
-    __PYX_ERR(0, 776, __pyx_L1_error)
+    __PYX_ERR(0, 775, __pyx_L1_error)
   }
-  __pyx_t_1 = PyTuple_GET_SIZE(__pyx_v_raw_weights); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 776, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_GET_SIZE(__pyx_v_raw_weights); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 775, __pyx_L1_error)
   __pyx_v_argc = __pyx_t_1;
 
-  /* "playhouse/_sqlite_ext.pyx":778
+  /* "playhouse/_sqlite_ext.pyx":777
  *         int argc = len(raw_weights)
  *         int icol
  *         double *weights = <double *>malloc(sizeof(double) * ncol)             # <<<<<<<<<<<<<<
  * 
  *     for icol in range(ncol):
  */
   __pyx_v_weights = ((double *)malloc(((sizeof(double)) * __pyx_v_ncol)));
 
-  /* "playhouse/_sqlite_ext.pyx":780
+  /* "playhouse/_sqlite_ext.pyx":779
  *         double *weights = <double *>malloc(sizeof(double) * ncol)
  * 
  *     for icol in range(ncol):             # <<<<<<<<<<<<<<
  *         if argc == 0:
  *             weights[icol] = 1.0
  */
   __pyx_t_2 = __pyx_v_ncol;
-  __pyx_t_3 = __pyx_t_2;
-  for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
-    __pyx_v_icol = __pyx_t_4;
+  for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
+    __pyx_v_icol = __pyx_t_3;
 
-    /* "playhouse/_sqlite_ext.pyx":781
+    /* "playhouse/_sqlite_ext.pyx":780
  * 
  *     for icol in range(ncol):
  *         if argc == 0:             # <<<<<<<<<<<<<<
  *             weights[icol] = 1.0
  *         elif icol < argc:
  */
-    __pyx_t_5 = ((__pyx_v_argc == 0) != 0);
-    if (__pyx_t_5) {
+    __pyx_t_4 = ((__pyx_v_argc == 0) != 0);
+    if (__pyx_t_4) {
 
-      /* "playhouse/_sqlite_ext.pyx":782
+      /* "playhouse/_sqlite_ext.pyx":781
  *     for icol in range(ncol):
  *         if argc == 0:
  *             weights[icol] = 1.0             # <<<<<<<<<<<<<<
  *         elif icol < argc:
  *             weights[icol] = <double>raw_weights[icol]
  */
       (__pyx_v_weights[__pyx_v_icol]) = 1.0;
 
-      /* "playhouse/_sqlite_ext.pyx":781
+      /* "playhouse/_sqlite_ext.pyx":780
  * 
  *     for icol in range(ncol):
  *         if argc == 0:             # <<<<<<<<<<<<<<
  *             weights[icol] = 1.0
  *         elif icol < argc:
  */
       goto __pyx_L5;
     }
 
-    /* "playhouse/_sqlite_ext.pyx":783
+    /* "playhouse/_sqlite_ext.pyx":782
  *         if argc == 0:
  *             weights[icol] = 1.0
  *         elif icol < argc:             # <<<<<<<<<<<<<<
  *             weights[icol] = <double>raw_weights[icol]
  *         else:
  */
-    __pyx_t_5 = ((__pyx_v_icol < __pyx_v_argc) != 0);
-    if (__pyx_t_5) {
+    __pyx_t_4 = ((__pyx_v_icol < __pyx_v_argc) != 0);
+    if (__pyx_t_4) {
 
-      /* "playhouse/_sqlite_ext.pyx":784
+      /* "playhouse/_sqlite_ext.pyx":783
  *             weights[icol] = 1.0
  *         elif icol < argc:
  *             weights[icol] = <double>raw_weights[icol]             # <<<<<<<<<<<<<<
  *         else:
  *             weights[icol] = 0.0
  */
       if (unlikely(__pyx_v_raw_weights == Py_None)) {
         PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-        __PYX_ERR(0, 784, __pyx_L1_error)
+        __PYX_ERR(0, 783, __pyx_L1_error)
       }
-      __pyx_t_6 = __Pyx_GetItemInt_Tuple(__pyx_v_raw_weights, __pyx_v_icol, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 784, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_7 = __pyx_PyFloat_AsDouble(__pyx_t_6); if (unlikely((__pyx_t_7 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 784, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      (__pyx_v_weights[__pyx_v_icol]) = ((double)__pyx_t_7);
+      __pyx_t_5 = __Pyx_GetItemInt_Tuple(__pyx_v_raw_weights, __pyx_v_icol, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 783, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_t_6 = __pyx_PyFloat_AsDouble(__pyx_t_5); if (unlikely((__pyx_t_6 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 783, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      (__pyx_v_weights[__pyx_v_icol]) = ((double)__pyx_t_6);
 
-      /* "playhouse/_sqlite_ext.pyx":783
+      /* "playhouse/_sqlite_ext.pyx":782
  *         if argc == 0:
  *             weights[icol] = 1.0
  *         elif icol < argc:             # <<<<<<<<<<<<<<
  *             weights[icol] = <double>raw_weights[icol]
  *         else:
  */
       goto __pyx_L5;
     }
 
-    /* "playhouse/_sqlite_ext.pyx":786
+    /* "playhouse/_sqlite_ext.pyx":785
  *             weights[icol] = <double>raw_weights[icol]
  *         else:
  *             weights[icol] = 0.0             # <<<<<<<<<<<<<<
  *     return weights
  * 
  */
     /*else*/ {
       (__pyx_v_weights[__pyx_v_icol]) = 0.0;
     }
     __pyx_L5:;
   }
 
-  /* "playhouse/_sqlite_ext.pyx":787
+  /* "playhouse/_sqlite_ext.pyx":786
  *         else:
  *             weights[icol] = 0.0
  *     return weights             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = __pyx_v_weights;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":774
+  /* "playhouse/_sqlite_ext.pyx":773
  * 
  * 
  * cdef double *get_weights(int ncol, tuple raw_weights):             # <<<<<<<<<<<<<<
  *     cdef:
  *         int argc = len(raw_weights)
  */
 
   /* function exit code */
   __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_5);
   __Pyx_WriteUnraisable("playhouse._sqlite_ext.get_weights", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":790
+/* "playhouse/_sqlite_ext.pyx":789
  * 
  * 
  * def peewee_rank(py_match_info, *raw_weights):             # <<<<<<<<<<<<<<
  *     cdef:
  *         unsigned int *match_info
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_1peewee_rank(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_1peewee_rank = {"peewee_rank", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_1peewee_rank, METH_VARARGS|METH_KEYWORDS, 0};
+static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_1peewee_rank = {"peewee_rank", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_1peewee_rank, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_1peewee_rank(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_py_match_info = 0;
   PyObject *__pyx_v_raw_weights = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("peewee_rank (wrapper)", 0);
   if (PyTuple_GET_SIZE(__pyx_args) > 1) {
@@ -7773,31 +7680,31 @@
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_py_match_info)) != 0)) kw_args--;
+        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_py_match_info)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t used_pos_args = (pos_args < 1) ? pos_args : 1;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, used_pos_args, "peewee_rank") < 0)) __PYX_ERR(0, 790, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, used_pos_args, "peewee_rank") < 0)) __PYX_ERR(0, 789, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) < 1) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
     }
     __pyx_v_py_match_info = values[0];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("peewee_rank", 0, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 790, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("peewee_rank", 0, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 789, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_DECREF(__pyx_v_raw_weights); __pyx_v_raw_weights = 0;
   __Pyx_AddTraceback("playhouse._sqlite_ext.peewee_rank", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_peewee_rank(__pyx_self, __pyx_v_py_match_info, __pyx_v_raw_weights);
@@ -7824,279 +7731,283 @@
   int __pyx_v_X_O;
   double __pyx_v_score;
   double __pyx_v_weight;
   double *__pyx_v_weights;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
-  char *__pyx_t_2;
-  int __pyx_t_3;
+  PyObject *__pyx_t_2 = NULL;
+  char *__pyx_t_3;
   int __pyx_t_4;
   int __pyx_t_5;
   int __pyx_t_6;
   int __pyx_t_7;
   int __pyx_t_8;
-  int __pyx_t_9;
   __Pyx_RefNannySetupContext("peewee_rank", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":794
+  /* "playhouse/_sqlite_ext.pyx":793
  *         unsigned int *match_info
  *         unsigned int *phrase_info
  *         bytes _match_info_buf = bytes(py_match_info)             # <<<<<<<<<<<<<<
  *         char *match_info_buf = _match_info_buf
  *         int nphrase, ncol, icol, iphrase, hits, global_hits
  */
-  __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyBytes_Type)), __pyx_v_py_match_info); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 794, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 793, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_v__match_info_buf = ((PyObject*)__pyx_t_1);
-  __pyx_t_1 = 0;
+  __Pyx_INCREF(__pyx_v_py_match_info);
+  __Pyx_GIVEREF(__pyx_v_py_match_info);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_py_match_info);
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)(&PyBytes_Type)), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 793, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v__match_info_buf = ((PyObject*)__pyx_t_2);
+  __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":795
+  /* "playhouse/_sqlite_ext.pyx":794
  *         unsigned int *phrase_info
  *         bytes _match_info_buf = bytes(py_match_info)
  *         char *match_info_buf = _match_info_buf             # <<<<<<<<<<<<<<
  *         int nphrase, ncol, icol, iphrase, hits, global_hits
  *         int P_O = 0, C_O = 1, X_O = 2
  */
-  __pyx_t_2 = __Pyx_PyBytes_AsWritableString(__pyx_v__match_info_buf); if (unlikely((!__pyx_t_2) && PyErr_Occurred())) __PYX_ERR(0, 795, __pyx_L1_error)
-  __pyx_v_match_info_buf = __pyx_t_2;
+  __pyx_t_3 = __Pyx_PyBytes_AsWritableString(__pyx_v__match_info_buf); if (unlikely((!__pyx_t_3) && PyErr_Occurred())) __PYX_ERR(0, 794, __pyx_L1_error)
+  __pyx_v_match_info_buf = __pyx_t_3;
 
-  /* "playhouse/_sqlite_ext.pyx":797
+  /* "playhouse/_sqlite_ext.pyx":796
  *         char *match_info_buf = _match_info_buf
  *         int nphrase, ncol, icol, iphrase, hits, global_hits
  *         int P_O = 0, C_O = 1, X_O = 2             # <<<<<<<<<<<<<<
  *         double score = 0.0, weight
  *         double *weights
  */
   __pyx_v_P_O = 0;
   __pyx_v_C_O = 1;
   __pyx_v_X_O = 2;
 
-  /* "playhouse/_sqlite_ext.pyx":798
+  /* "playhouse/_sqlite_ext.pyx":797
  *         int nphrase, ncol, icol, iphrase, hits, global_hits
  *         int P_O = 0, C_O = 1, X_O = 2
  *         double score = 0.0, weight             # <<<<<<<<<<<<<<
  *         double *weights
  * 
  */
   __pyx_v_score = 0.0;
 
-  /* "playhouse/_sqlite_ext.pyx":801
+  /* "playhouse/_sqlite_ext.pyx":800
  *         double *weights
  * 
  *     match_info = <unsigned int *>match_info_buf             # <<<<<<<<<<<<<<
  *     nphrase = match_info[P_O]
  *     ncol = match_info[C_O]
  */
   __pyx_v_match_info = ((unsigned int *)__pyx_v_match_info_buf);
 
-  /* "playhouse/_sqlite_ext.pyx":802
+  /* "playhouse/_sqlite_ext.pyx":801
  * 
  *     match_info = <unsigned int *>match_info_buf
  *     nphrase = match_info[P_O]             # <<<<<<<<<<<<<<
  *     ncol = match_info[C_O]
  *     weights = get_weights(ncol, raw_weights)
  */
   __pyx_v_nphrase = (__pyx_v_match_info[__pyx_v_P_O]);
 
-  /* "playhouse/_sqlite_ext.pyx":803
+  /* "playhouse/_sqlite_ext.pyx":802
  *     match_info = <unsigned int *>match_info_buf
  *     nphrase = match_info[P_O]
  *     ncol = match_info[C_O]             # <<<<<<<<<<<<<<
  *     weights = get_weights(ncol, raw_weights)
  * 
  */
   __pyx_v_ncol = (__pyx_v_match_info[__pyx_v_C_O]);
 
-  /* "playhouse/_sqlite_ext.pyx":804
+  /* "playhouse/_sqlite_ext.pyx":803
  *     nphrase = match_info[P_O]
  *     ncol = match_info[C_O]
  *     weights = get_weights(ncol, raw_weights)             # <<<<<<<<<<<<<<
  * 
  *     # matchinfo X value corresponds to, for each phrase in the search query, a
  */
   __pyx_v_weights = __pyx_f_9playhouse_11_sqlite_ext_get_weights(__pyx_v_ncol, __pyx_v_raw_weights);
 
-  /* "playhouse/_sqlite_ext.pyx":812
+  /* "playhouse/_sqlite_ext.pyx":811
  *     # p0 : c0=[0, 1, 2],   c1=[3, 4, 5],    c2=[6, 7, 8]
  *     # p1 : c0=[9, 10, 11], c1=[12, 13, 14], c2=[15, 16, 17]
  *     for iphrase in range(nphrase):             # <<<<<<<<<<<<<<
  *         phrase_info = &match_info[X_O + iphrase * ncol * 3]
  *         for icol in range(ncol):
  */
-  __pyx_t_3 = __pyx_v_nphrase;
-  __pyx_t_4 = __pyx_t_3;
+  __pyx_t_4 = __pyx_v_nphrase;
   for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
     __pyx_v_iphrase = __pyx_t_5;
 
-    /* "playhouse/_sqlite_ext.pyx":813
+    /* "playhouse/_sqlite_ext.pyx":812
  *     # p1 : c0=[9, 10, 11], c1=[12, 13, 14], c2=[15, 16, 17]
  *     for iphrase in range(nphrase):
  *         phrase_info = &match_info[X_O + iphrase * ncol * 3]             # <<<<<<<<<<<<<<
  *         for icol in range(ncol):
  *             weight = weights[icol]
  */
     __pyx_v_phrase_info = (&(__pyx_v_match_info[(__pyx_v_X_O + ((__pyx_v_iphrase * __pyx_v_ncol) * 3))]));
 
-    /* "playhouse/_sqlite_ext.pyx":814
+    /* "playhouse/_sqlite_ext.pyx":813
  *     for iphrase in range(nphrase):
  *         phrase_info = &match_info[X_O + iphrase * ncol * 3]
  *         for icol in range(ncol):             # <<<<<<<<<<<<<<
  *             weight = weights[icol]
  *             if weight == 0:
  */
     __pyx_t_6 = __pyx_v_ncol;
-    __pyx_t_7 = __pyx_t_6;
-    for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
-      __pyx_v_icol = __pyx_t_8;
+    for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
+      __pyx_v_icol = __pyx_t_7;
 
-      /* "playhouse/_sqlite_ext.pyx":815
+      /* "playhouse/_sqlite_ext.pyx":814
  *         phrase_info = &match_info[X_O + iphrase * ncol * 3]
  *         for icol in range(ncol):
  *             weight = weights[icol]             # <<<<<<<<<<<<<<
  *             if weight == 0:
  *                 continue
  */
       __pyx_v_weight = (__pyx_v_weights[__pyx_v_icol]);
 
-      /* "playhouse/_sqlite_ext.pyx":816
+      /* "playhouse/_sqlite_ext.pyx":815
  *         for icol in range(ncol):
  *             weight = weights[icol]
  *             if weight == 0:             # <<<<<<<<<<<<<<
  *                 continue
  * 
  */
-      __pyx_t_9 = ((__pyx_v_weight == 0.0) != 0);
-      if (__pyx_t_9) {
+      __pyx_t_8 = ((__pyx_v_weight == 0.0) != 0);
+      if (__pyx_t_8) {
 
-        /* "playhouse/_sqlite_ext.pyx":817
+        /* "playhouse/_sqlite_ext.pyx":816
  *             weight = weights[icol]
  *             if weight == 0:
  *                 continue             # <<<<<<<<<<<<<<
  * 
  *             # The idea is that we count the number of times the phrase appears
  */
         goto __pyx_L5_continue;
 
-        /* "playhouse/_sqlite_ext.pyx":816
+        /* "playhouse/_sqlite_ext.pyx":815
  *         for icol in range(ncol):
  *             weight = weights[icol]
  *             if weight == 0:             # <<<<<<<<<<<<<<
  *                 continue
  * 
  */
       }
 
-      /* "playhouse/_sqlite_ext.pyx":823
+      /* "playhouse/_sqlite_ext.pyx":822
  *             # appears in this column across all rows. The ratio of these values
  *             # provides a rough way to score based on "high value" terms.
  *             hits = phrase_info[3 * icol]             # <<<<<<<<<<<<<<
  *             global_hits = phrase_info[3 * icol + 1]
  *             if hits > 0:
  */
       __pyx_v_hits = (__pyx_v_phrase_info[(3 * __pyx_v_icol)]);
 
-      /* "playhouse/_sqlite_ext.pyx":824
+      /* "playhouse/_sqlite_ext.pyx":823
  *             # provides a rough way to score based on "high value" terms.
  *             hits = phrase_info[3 * icol]
  *             global_hits = phrase_info[3 * icol + 1]             # <<<<<<<<<<<<<<
  *             if hits > 0:
  *                 score += weight * (<double>hits / <double>global_hits)
  */
       __pyx_v_global_hits = (__pyx_v_phrase_info[((3 * __pyx_v_icol) + 1)]);
 
-      /* "playhouse/_sqlite_ext.pyx":825
+      /* "playhouse/_sqlite_ext.pyx":824
  *             hits = phrase_info[3 * icol]
  *             global_hits = phrase_info[3 * icol + 1]
  *             if hits > 0:             # <<<<<<<<<<<<<<
  *                 score += weight * (<double>hits / <double>global_hits)
  * 
  */
-      __pyx_t_9 = ((__pyx_v_hits > 0) != 0);
-      if (__pyx_t_9) {
+      __pyx_t_8 = ((__pyx_v_hits > 0) != 0);
+      if (__pyx_t_8) {
 
-        /* "playhouse/_sqlite_ext.pyx":826
+        /* "playhouse/_sqlite_ext.pyx":825
  *             global_hits = phrase_info[3 * icol + 1]
  *             if hits > 0:
  *                 score += weight * (<double>hits / <double>global_hits)             # <<<<<<<<<<<<<<
  * 
  *     free(weights)
  */
         if (unlikely(((double)__pyx_v_global_hits) == 0)) {
           PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-          __PYX_ERR(0, 826, __pyx_L1_error)
+          __PYX_ERR(0, 825, __pyx_L1_error)
         }
         __pyx_v_score = (__pyx_v_score + (__pyx_v_weight * (((double)__pyx_v_hits) / ((double)__pyx_v_global_hits))));
 
-        /* "playhouse/_sqlite_ext.pyx":825
+        /* "playhouse/_sqlite_ext.pyx":824
  *             hits = phrase_info[3 * icol]
  *             global_hits = phrase_info[3 * icol + 1]
  *             if hits > 0:             # <<<<<<<<<<<<<<
  *                 score += weight * (<double>hits / <double>global_hits)
  * 
  */
       }
       __pyx_L5_continue:;
     }
   }
 
-  /* "playhouse/_sqlite_ext.pyx":828
+  /* "playhouse/_sqlite_ext.pyx":827
  *                 score += weight * (<double>hits / <double>global_hits)
  * 
  *     free(weights)             # <<<<<<<<<<<<<<
  *     return -1 * score
  * 
  */
   free(__pyx_v_weights);
 
-  /* "playhouse/_sqlite_ext.pyx":829
+  /* "playhouse/_sqlite_ext.pyx":828
  * 
  *     free(weights)
  *     return -1 * score             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((-1.0 * __pyx_v_score)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 829, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_r = __pyx_t_1;
-  __pyx_t_1 = 0;
+  __pyx_t_2 = PyFloat_FromDouble((-1.0 * __pyx_v_score)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 828, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_r = __pyx_t_2;
+  __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":790
+  /* "playhouse/_sqlite_ext.pyx":789
  * 
  * 
  * def peewee_rank(py_match_info, *raw_weights):             # <<<<<<<<<<<<<<
  *     cdef:
  *         unsigned int *match_info
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
   __Pyx_AddTraceback("playhouse._sqlite_ext.peewee_rank", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v__match_info_buf);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":832
+/* "playhouse/_sqlite_ext.pyx":831
  * 
  * 
  * def peewee_lucene(py_match_info, *raw_weights):             # <<<<<<<<<<<<<<
  *     # Usage: peewee_lucene(matchinfo(table, 'pcnalx'), 1)
  *     cdef:
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_3peewee_lucene(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_3peewee_lucene = {"peewee_lucene", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_3peewee_lucene, METH_VARARGS|METH_KEYWORDS, 0};
+static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_3peewee_lucene = {"peewee_lucene", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_3peewee_lucene, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_3peewee_lucene(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_py_match_info = 0;
   PyObject *__pyx_v_raw_weights = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("peewee_lucene (wrapper)", 0);
   if (PyTuple_GET_SIZE(__pyx_args) > 1) {
@@ -8120,31 +8031,31 @@
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_py_match_info)) != 0)) kw_args--;
+        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_py_match_info)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t used_pos_args = (pos_args < 1) ? pos_args : 1;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, used_pos_args, "peewee_lucene") < 0)) __PYX_ERR(0, 832, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, used_pos_args, "peewee_lucene") < 0)) __PYX_ERR(0, 831, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) < 1) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
     }
     __pyx_v_py_match_info = values[0];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("peewee_lucene", 0, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 832, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("peewee_lucene", 0, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 831, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_DECREF(__pyx_v_raw_weights); __pyx_v_raw_weights = 0;
   __Pyx_AddTraceback("playhouse._sqlite_ext.peewee_lucene", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_2peewee_lucene(__pyx_self, __pyx_v_py_match_info, __pyx_v_raw_weights);
@@ -8178,339 +8089,343 @@
   int __pyx_v_x;
   double __pyx_v_score;
   double __pyx_v_tf;
   double __pyx_v_fieldNorms;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
-  char *__pyx_t_2;
-  int __pyx_t_3;
+  PyObject *__pyx_t_2 = NULL;
+  char *__pyx_t_3;
   int __pyx_t_4;
   int __pyx_t_5;
   int __pyx_t_6;
   int __pyx_t_7;
   int __pyx_t_8;
-  int __pyx_t_9;
-  double __pyx_t_10;
-  unsigned int __pyx_t_11;
+  double __pyx_t_9;
+  unsigned int __pyx_t_10;
   __Pyx_RefNannySetupContext("peewee_lucene", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":836
+  /* "playhouse/_sqlite_ext.pyx":835
  *     cdef:
  *         unsigned int *match_info
  *         bytes _match_info_buf = bytes(py_match_info)             # <<<<<<<<<<<<<<
  *         char *match_info_buf = _match_info_buf
  *         int nphrase, ncol
  */
-  __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyBytes_Type)), __pyx_v_py_match_info); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 836, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 835, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_v__match_info_buf = ((PyObject*)__pyx_t_1);
-  __pyx_t_1 = 0;
+  __Pyx_INCREF(__pyx_v_py_match_info);
+  __Pyx_GIVEREF(__pyx_v_py_match_info);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_py_match_info);
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)(&PyBytes_Type)), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 835, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v__match_info_buf = ((PyObject*)__pyx_t_2);
+  __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":837
+  /* "playhouse/_sqlite_ext.pyx":836
  *         unsigned int *match_info
  *         bytes _match_info_buf = bytes(py_match_info)
  *         char *match_info_buf = _match_info_buf             # <<<<<<<<<<<<<<
  *         int nphrase, ncol
  *         double total_docs, term_frequency
  */
-  __pyx_t_2 = __Pyx_PyBytes_AsWritableString(__pyx_v__match_info_buf); if (unlikely((!__pyx_t_2) && PyErr_Occurred())) __PYX_ERR(0, 837, __pyx_L1_error)
-  __pyx_v_match_info_buf = __pyx_t_2;
+  __pyx_t_3 = __Pyx_PyBytes_AsWritableString(__pyx_v__match_info_buf); if (unlikely((!__pyx_t_3) && PyErr_Occurred())) __PYX_ERR(0, 836, __pyx_L1_error)
+  __pyx_v_match_info_buf = __pyx_t_3;
 
-  /* "playhouse/_sqlite_ext.pyx":843
+  /* "playhouse/_sqlite_ext.pyx":842
  *         double idf, weight, rhs, denom
  *         double *weights
  *         int P_O = 0, C_O = 1, N_O = 2, L_O, X_O             # <<<<<<<<<<<<<<
  *         int iphrase, icol, x
  *         double score = 0.0
  */
   __pyx_v_P_O = 0;
   __pyx_v_C_O = 1;
   __pyx_v_N_O = 2;
 
-  /* "playhouse/_sqlite_ext.pyx":845
+  /* "playhouse/_sqlite_ext.pyx":844
  *         int P_O = 0, C_O = 1, N_O = 2, L_O, X_O
  *         int iphrase, icol, x
  *         double score = 0.0             # <<<<<<<<<<<<<<
  * 
  *     match_info = <unsigned int *>match_info_buf
  */
   __pyx_v_score = 0.0;
 
-  /* "playhouse/_sqlite_ext.pyx":847
+  /* "playhouse/_sqlite_ext.pyx":846
  *         double score = 0.0
  * 
  *     match_info = <unsigned int *>match_info_buf             # <<<<<<<<<<<<<<
  *     nphrase = match_info[P_O]
  *     ncol = match_info[C_O]
  */
   __pyx_v_match_info = ((unsigned int *)__pyx_v_match_info_buf);
 
-  /* "playhouse/_sqlite_ext.pyx":848
+  /* "playhouse/_sqlite_ext.pyx":847
  * 
  *     match_info = <unsigned int *>match_info_buf
  *     nphrase = match_info[P_O]             # <<<<<<<<<<<<<<
  *     ncol = match_info[C_O]
  *     total_docs = match_info[N_O]
  */
   __pyx_v_nphrase = (__pyx_v_match_info[__pyx_v_P_O]);
 
-  /* "playhouse/_sqlite_ext.pyx":849
+  /* "playhouse/_sqlite_ext.pyx":848
  *     match_info = <unsigned int *>match_info_buf
  *     nphrase = match_info[P_O]
  *     ncol = match_info[C_O]             # <<<<<<<<<<<<<<
  *     total_docs = match_info[N_O]
  * 
  */
   __pyx_v_ncol = (__pyx_v_match_info[__pyx_v_C_O]);
 
-  /* "playhouse/_sqlite_ext.pyx":850
+  /* "playhouse/_sqlite_ext.pyx":849
  *     nphrase = match_info[P_O]
  *     ncol = match_info[C_O]
  *     total_docs = match_info[N_O]             # <<<<<<<<<<<<<<
  * 
  *     L_O = 3 + ncol
  */
   __pyx_v_total_docs = (__pyx_v_match_info[__pyx_v_N_O]);
 
-  /* "playhouse/_sqlite_ext.pyx":852
+  /* "playhouse/_sqlite_ext.pyx":851
  *     total_docs = match_info[N_O]
  * 
  *     L_O = 3 + ncol             # <<<<<<<<<<<<<<
  *     X_O = L_O + ncol
  *     weights = get_weights(ncol, raw_weights)
  */
   __pyx_v_L_O = (3 + __pyx_v_ncol);
 
-  /* "playhouse/_sqlite_ext.pyx":853
+  /* "playhouse/_sqlite_ext.pyx":852
  * 
  *     L_O = 3 + ncol
  *     X_O = L_O + ncol             # <<<<<<<<<<<<<<
  *     weights = get_weights(ncol, raw_weights)
  * 
  */
   __pyx_v_X_O = (__pyx_v_L_O + __pyx_v_ncol);
 
-  /* "playhouse/_sqlite_ext.pyx":854
+  /* "playhouse/_sqlite_ext.pyx":853
  *     L_O = 3 + ncol
  *     X_O = L_O + ncol
  *     weights = get_weights(ncol, raw_weights)             # <<<<<<<<<<<<<<
  * 
  *     for iphrase in range(nphrase):
  */
   __pyx_v_weights = __pyx_f_9playhouse_11_sqlite_ext_get_weights(__pyx_v_ncol, __pyx_v_raw_weights);
 
-  /* "playhouse/_sqlite_ext.pyx":856
+  /* "playhouse/_sqlite_ext.pyx":855
  *     weights = get_weights(ncol, raw_weights)
  * 
  *     for iphrase in range(nphrase):             # <<<<<<<<<<<<<<
  *         for icol in range(ncol):
  *             weight = weights[icol]
  */
-  __pyx_t_3 = __pyx_v_nphrase;
-  __pyx_t_4 = __pyx_t_3;
+  __pyx_t_4 = __pyx_v_nphrase;
   for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
     __pyx_v_iphrase = __pyx_t_5;
 
-    /* "playhouse/_sqlite_ext.pyx":857
+    /* "playhouse/_sqlite_ext.pyx":856
  * 
  *     for iphrase in range(nphrase):
  *         for icol in range(ncol):             # <<<<<<<<<<<<<<
  *             weight = weights[icol]
  *             if weight == 0:
  */
     __pyx_t_6 = __pyx_v_ncol;
-    __pyx_t_7 = __pyx_t_6;
-    for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
-      __pyx_v_icol = __pyx_t_8;
+    for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
+      __pyx_v_icol = __pyx_t_7;
 
-      /* "playhouse/_sqlite_ext.pyx":858
+      /* "playhouse/_sqlite_ext.pyx":857
  *     for iphrase in range(nphrase):
  *         for icol in range(ncol):
  *             weight = weights[icol]             # <<<<<<<<<<<<<<
  *             if weight == 0:
  *                 continue
  */
       __pyx_v_weight = (__pyx_v_weights[__pyx_v_icol]);
 
-      /* "playhouse/_sqlite_ext.pyx":859
+      /* "playhouse/_sqlite_ext.pyx":858
  *         for icol in range(ncol):
  *             weight = weights[icol]
  *             if weight == 0:             # <<<<<<<<<<<<<<
  *                 continue
  *             doc_length = match_info[L_O + icol]
  */
-      __pyx_t_9 = ((__pyx_v_weight == 0.0) != 0);
-      if (__pyx_t_9) {
+      __pyx_t_8 = ((__pyx_v_weight == 0.0) != 0);
+      if (__pyx_t_8) {
 
-        /* "playhouse/_sqlite_ext.pyx":860
+        /* "playhouse/_sqlite_ext.pyx":859
  *             weight = weights[icol]
  *             if weight == 0:
  *                 continue             # <<<<<<<<<<<<<<
  *             doc_length = match_info[L_O + icol]
  *             x = X_O + (3 * (icol + iphrase * ncol))
  */
         goto __pyx_L5_continue;
 
-        /* "playhouse/_sqlite_ext.pyx":859
+        /* "playhouse/_sqlite_ext.pyx":858
  *         for icol in range(ncol):
  *             weight = weights[icol]
  *             if weight == 0:             # <<<<<<<<<<<<<<
  *                 continue
  *             doc_length = match_info[L_O + icol]
  */
       }
 
-      /* "playhouse/_sqlite_ext.pyx":861
+      /* "playhouse/_sqlite_ext.pyx":860
  *             if weight == 0:
  *                 continue
  *             doc_length = match_info[L_O + icol]             # <<<<<<<<<<<<<<
  *             x = X_O + (3 * (icol + iphrase * ncol))
  *             term_frequency = match_info[x]  # f(qi)
  */
       __pyx_v_doc_length = (__pyx_v_match_info[(__pyx_v_L_O + __pyx_v_icol)]);
 
-      /* "playhouse/_sqlite_ext.pyx":862
+      /* "playhouse/_sqlite_ext.pyx":861
  *                 continue
  *             doc_length = match_info[L_O + icol]
  *             x = X_O + (3 * (icol + iphrase * ncol))             # <<<<<<<<<<<<<<
  *             term_frequency = match_info[x]  # f(qi)
  *             docs_with_term = match_info[x + 2] or 1. # n(qi)
  */
       __pyx_v_x = (__pyx_v_X_O + (3 * (__pyx_v_icol + (__pyx_v_iphrase * __pyx_v_ncol))));
 
-      /* "playhouse/_sqlite_ext.pyx":863
+      /* "playhouse/_sqlite_ext.pyx":862
  *             doc_length = match_info[L_O + icol]
  *             x = X_O + (3 * (icol + iphrase * ncol))
  *             term_frequency = match_info[x]  # f(qi)             # <<<<<<<<<<<<<<
  *             docs_with_term = match_info[x + 2] or 1. # n(qi)
  *             idf = log(total_docs / (docs_with_term + 1.))
  */
       __pyx_v_term_frequency = (__pyx_v_match_info[__pyx_v_x]);
 
-      /* "playhouse/_sqlite_ext.pyx":864
+      /* "playhouse/_sqlite_ext.pyx":863
  *             x = X_O + (3 * (icol + iphrase * ncol))
  *             term_frequency = match_info[x]  # f(qi)
  *             docs_with_term = match_info[x + 2] or 1. # n(qi)             # <<<<<<<<<<<<<<
  *             idf = log(total_docs / (docs_with_term + 1.))
  *             tf = sqrt(term_frequency)
  */
-      __pyx_t_11 = (__pyx_v_match_info[(__pyx_v_x + 2)]);
-      if (!__pyx_t_11) {
+      __pyx_t_10 = (__pyx_v_match_info[(__pyx_v_x + 2)]);
+      if (!__pyx_t_10) {
       } else {
-        __pyx_t_10 = __pyx_t_11;
+        __pyx_t_9 = __pyx_t_10;
         goto __pyx_L8_bool_binop_done;
       }
-      __pyx_t_10 = 1.;
+      __pyx_t_9 = 1.;
       __pyx_L8_bool_binop_done:;
-      __pyx_v_docs_with_term = __pyx_t_10;
+      __pyx_v_docs_with_term = __pyx_t_9;
 
-      /* "playhouse/_sqlite_ext.pyx":865
+      /* "playhouse/_sqlite_ext.pyx":864
  *             term_frequency = match_info[x]  # f(qi)
  *             docs_with_term = match_info[x + 2] or 1. # n(qi)
  *             idf = log(total_docs / (docs_with_term + 1.))             # <<<<<<<<<<<<<<
  *             tf = sqrt(term_frequency)
  *             fieldNorms = 1.0 / sqrt(doc_length)
  */
-      __pyx_t_10 = (__pyx_v_docs_with_term + 1.);
-      if (unlikely(__pyx_t_10 == 0)) {
+      __pyx_t_9 = (__pyx_v_docs_with_term + 1.);
+      if (unlikely(__pyx_t_9 == 0)) {
         PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-        __PYX_ERR(0, 865, __pyx_L1_error)
+        __PYX_ERR(0, 864, __pyx_L1_error)
       }
-      __pyx_v_idf = log((__pyx_v_total_docs / __pyx_t_10));
+      __pyx_v_idf = log((__pyx_v_total_docs / __pyx_t_9));
 
-      /* "playhouse/_sqlite_ext.pyx":866
+      /* "playhouse/_sqlite_ext.pyx":865
  *             docs_with_term = match_info[x + 2] or 1. # n(qi)
  *             idf = log(total_docs / (docs_with_term + 1.))
  *             tf = sqrt(term_frequency)             # <<<<<<<<<<<<<<
  *             fieldNorms = 1.0 / sqrt(doc_length)
  *             score += (idf * tf * fieldNorms)
  */
       __pyx_v_tf = sqrt(__pyx_v_term_frequency);
 
-      /* "playhouse/_sqlite_ext.pyx":867
+      /* "playhouse/_sqlite_ext.pyx":866
  *             idf = log(total_docs / (docs_with_term + 1.))
  *             tf = sqrt(term_frequency)
  *             fieldNorms = 1.0 / sqrt(doc_length)             # <<<<<<<<<<<<<<
  *             score += (idf * tf * fieldNorms)
  * 
  */
-      __pyx_t_10 = sqrt(__pyx_v_doc_length);
-      if (unlikely(__pyx_t_10 == 0)) {
+      __pyx_t_9 = sqrt(__pyx_v_doc_length);
+      if (unlikely(__pyx_t_9 == 0)) {
         PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-        __PYX_ERR(0, 867, __pyx_L1_error)
+        __PYX_ERR(0, 866, __pyx_L1_error)
       }
-      __pyx_v_fieldNorms = (1.0 / __pyx_t_10);
+      __pyx_v_fieldNorms = (1.0 / __pyx_t_9);
 
-      /* "playhouse/_sqlite_ext.pyx":868
+      /* "playhouse/_sqlite_ext.pyx":867
  *             tf = sqrt(term_frequency)
  *             fieldNorms = 1.0 / sqrt(doc_length)
  *             score += (idf * tf * fieldNorms)             # <<<<<<<<<<<<<<
  * 
  *     free(weights)
  */
       __pyx_v_score = (__pyx_v_score + ((__pyx_v_idf * __pyx_v_tf) * __pyx_v_fieldNorms));
       __pyx_L5_continue:;
     }
   }
 
-  /* "playhouse/_sqlite_ext.pyx":870
+  /* "playhouse/_sqlite_ext.pyx":869
  *             score += (idf * tf * fieldNorms)
  * 
  *     free(weights)             # <<<<<<<<<<<<<<
  *     return -1 * score
  * 
  */
   free(__pyx_v_weights);
 
-  /* "playhouse/_sqlite_ext.pyx":871
+  /* "playhouse/_sqlite_ext.pyx":870
  * 
  *     free(weights)
  *     return -1 * score             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((-1.0 * __pyx_v_score)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 871, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_r = __pyx_t_1;
-  __pyx_t_1 = 0;
+  __pyx_t_2 = PyFloat_FromDouble((-1.0 * __pyx_v_score)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 870, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_r = __pyx_t_2;
+  __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":832
+  /* "playhouse/_sqlite_ext.pyx":831
  * 
  * 
  * def peewee_lucene(py_match_info, *raw_weights):             # <<<<<<<<<<<<<<
  *     # Usage: peewee_lucene(matchinfo(table, 'pcnalx'), 1)
  *     cdef:
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
   __Pyx_AddTraceback("playhouse._sqlite_ext.peewee_lucene", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v__match_info_buf);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":874
+/* "playhouse/_sqlite_ext.pyx":873
  * 
  * 
  * def peewee_bm25(py_match_info, *raw_weights):             # <<<<<<<<<<<<<<
  *     # Usage: peewee_bm25(matchinfo(table, 'pcnalx'), 1)
  *     # where the second parameter is the index of the column and
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_5peewee_bm25(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_5peewee_bm25 = {"peewee_bm25", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_5peewee_bm25, METH_VARARGS|METH_KEYWORDS, 0};
+static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_5peewee_bm25 = {"peewee_bm25", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_5peewee_bm25, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_5peewee_bm25(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_py_match_info = 0;
   PyObject *__pyx_v_raw_weights = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("peewee_bm25 (wrapper)", 0);
   if (PyTuple_GET_SIZE(__pyx_args) > 1) {
@@ -8534,31 +8449,31 @@
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_py_match_info)) != 0)) kw_args--;
+        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_py_match_info)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t used_pos_args = (pos_args < 1) ? pos_args : 1;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, used_pos_args, "peewee_bm25") < 0)) __PYX_ERR(0, 874, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, used_pos_args, "peewee_bm25") < 0)) __PYX_ERR(0, 873, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) < 1) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
     }
     __pyx_v_py_match_info = values[0];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("peewee_bm25", 0, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 874, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("peewee_bm25", 0, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 873, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_DECREF(__pyx_v_raw_weights); __pyx_v_raw_weights = 0;
   __Pyx_AddTraceback("playhouse._sqlite_ext.peewee_bm25", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_4peewee_bm25(__pyx_self, __pyx_v_py_match_info, __pyx_v_raw_weights);
@@ -8599,462 +8514,466 @@
   int __pyx_v_iphrase;
   int __pyx_v_icol;
   int __pyx_v_x;
   double __pyx_v_score;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
-  char *__pyx_t_2;
-  int __pyx_t_3;
+  PyObject *__pyx_t_2 = NULL;
+  char *__pyx_t_3;
   int __pyx_t_4;
   int __pyx_t_5;
   int __pyx_t_6;
   int __pyx_t_7;
   int __pyx_t_8;
-  int __pyx_t_9;
+  double __pyx_t_9;
   double __pyx_t_10;
-  double __pyx_t_11;
   __Pyx_RefNannySetupContext("peewee_bm25", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":880
+  /* "playhouse/_sqlite_ext.pyx":879
  *     cdef:
  *         unsigned int *match_info
  *         bytes _match_info_buf = bytes(py_match_info)             # <<<<<<<<<<<<<<
  *         char *match_info_buf = _match_info_buf
  *         int nphrase, ncol
  */
-  __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyBytes_Type)), __pyx_v_py_match_info); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 880, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 879, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_v__match_info_buf = ((PyObject*)__pyx_t_1);
-  __pyx_t_1 = 0;
+  __Pyx_INCREF(__pyx_v_py_match_info);
+  __Pyx_GIVEREF(__pyx_v_py_match_info);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_py_match_info);
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)(&PyBytes_Type)), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 879, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v__match_info_buf = ((PyObject*)__pyx_t_2);
+  __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":881
+  /* "playhouse/_sqlite_ext.pyx":880
  *         unsigned int *match_info
  *         bytes _match_info_buf = bytes(py_match_info)
  *         char *match_info_buf = _match_info_buf             # <<<<<<<<<<<<<<
  *         int nphrase, ncol
  *         double B = 0.75, K = 1.2
  */
-  __pyx_t_2 = __Pyx_PyBytes_AsWritableString(__pyx_v__match_info_buf); if (unlikely((!__pyx_t_2) && PyErr_Occurred())) __PYX_ERR(0, 881, __pyx_L1_error)
-  __pyx_v_match_info_buf = __pyx_t_2;
+  __pyx_t_3 = __Pyx_PyBytes_AsWritableString(__pyx_v__match_info_buf); if (unlikely((!__pyx_t_3) && PyErr_Occurred())) __PYX_ERR(0, 880, __pyx_L1_error)
+  __pyx_v_match_info_buf = __pyx_t_3;
 
-  /* "playhouse/_sqlite_ext.pyx":883
+  /* "playhouse/_sqlite_ext.pyx":882
  *         char *match_info_buf = _match_info_buf
  *         int nphrase, ncol
  *         double B = 0.75, K = 1.2             # <<<<<<<<<<<<<<
  *         double total_docs, term_frequency
  *         double doc_length, docs_with_term, avg_length
  */
   __pyx_v_B = 0.75;
   __pyx_v_K = 1.2;
 
-  /* "playhouse/_sqlite_ext.pyx":888
+  /* "playhouse/_sqlite_ext.pyx":887
  *         double idf, weight, ratio, num, b_part, denom, pc_score
  *         double *weights
  *         int P_O = 0, C_O = 1, N_O = 2, A_O = 3, L_O, X_O             # <<<<<<<<<<<<<<
  *         int iphrase, icol, x
  *         double score = 0.0
  */
   __pyx_v_P_O = 0;
   __pyx_v_C_O = 1;
   __pyx_v_N_O = 2;
   __pyx_v_A_O = 3;
 
-  /* "playhouse/_sqlite_ext.pyx":890
+  /* "playhouse/_sqlite_ext.pyx":889
  *         int P_O = 0, C_O = 1, N_O = 2, A_O = 3, L_O, X_O
  *         int iphrase, icol, x
  *         double score = 0.0             # <<<<<<<<<<<<<<
  * 
  *     match_info = <unsigned int *>match_info_buf
  */
   __pyx_v_score = 0.0;
 
-  /* "playhouse/_sqlite_ext.pyx":892
+  /* "playhouse/_sqlite_ext.pyx":891
  *         double score = 0.0
  * 
  *     match_info = <unsigned int *>match_info_buf             # <<<<<<<<<<<<<<
  *     # PCNALX = matchinfo format.
  *     # P = 1 = phrase count within query.
  */
   __pyx_v_match_info = ((unsigned int *)__pyx_v_match_info_buf);
 
-  /* "playhouse/_sqlite_ext.pyx":903
+  /* "playhouse/_sqlite_ext.pyx":902
  *     # * phrase count within column for all rows.
  *     # * total rows for which column contains phrase.
  *     nphrase = match_info[P_O]  # n             # <<<<<<<<<<<<<<
  *     ncol = match_info[C_O]
  *     total_docs = match_info[N_O]  # N
  */
   __pyx_v_nphrase = (__pyx_v_match_info[__pyx_v_P_O]);
 
-  /* "playhouse/_sqlite_ext.pyx":904
+  /* "playhouse/_sqlite_ext.pyx":903
  *     # * total rows for which column contains phrase.
  *     nphrase = match_info[P_O]  # n
  *     ncol = match_info[C_O]             # <<<<<<<<<<<<<<
  *     total_docs = match_info[N_O]  # N
  * 
  */
   __pyx_v_ncol = (__pyx_v_match_info[__pyx_v_C_O]);
 
-  /* "playhouse/_sqlite_ext.pyx":905
+  /* "playhouse/_sqlite_ext.pyx":904
  *     nphrase = match_info[P_O]  # n
  *     ncol = match_info[C_O]
  *     total_docs = match_info[N_O]  # N             # <<<<<<<<<<<<<<
  * 
  *     L_O = A_O + ncol
  */
   __pyx_v_total_docs = (__pyx_v_match_info[__pyx_v_N_O]);
 
-  /* "playhouse/_sqlite_ext.pyx":907
+  /* "playhouse/_sqlite_ext.pyx":906
  *     total_docs = match_info[N_O]  # N
  * 
  *     L_O = A_O + ncol             # <<<<<<<<<<<<<<
  *     X_O = L_O + ncol
  *     weights = get_weights(ncol, raw_weights)
  */
   __pyx_v_L_O = (__pyx_v_A_O + __pyx_v_ncol);
 
-  /* "playhouse/_sqlite_ext.pyx":908
+  /* "playhouse/_sqlite_ext.pyx":907
  * 
  *     L_O = A_O + ncol
  *     X_O = L_O + ncol             # <<<<<<<<<<<<<<
  *     weights = get_weights(ncol, raw_weights)
  * 
  */
   __pyx_v_X_O = (__pyx_v_L_O + __pyx_v_ncol);
 
-  /* "playhouse/_sqlite_ext.pyx":909
+  /* "playhouse/_sqlite_ext.pyx":908
  *     L_O = A_O + ncol
  *     X_O = L_O + ncol
  *     weights = get_weights(ncol, raw_weights)             # <<<<<<<<<<<<<<
  * 
  *     for iphrase in range(nphrase):
  */
   __pyx_v_weights = __pyx_f_9playhouse_11_sqlite_ext_get_weights(__pyx_v_ncol, __pyx_v_raw_weights);
 
-  /* "playhouse/_sqlite_ext.pyx":911
+  /* "playhouse/_sqlite_ext.pyx":910
  *     weights = get_weights(ncol, raw_weights)
  * 
  *     for iphrase in range(nphrase):             # <<<<<<<<<<<<<<
  *         for icol in range(ncol):
  *             weight = weights[icol]
  */
-  __pyx_t_3 = __pyx_v_nphrase;
-  __pyx_t_4 = __pyx_t_3;
+  __pyx_t_4 = __pyx_v_nphrase;
   for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
     __pyx_v_iphrase = __pyx_t_5;
 
-    /* "playhouse/_sqlite_ext.pyx":912
+    /* "playhouse/_sqlite_ext.pyx":911
  * 
  *     for iphrase in range(nphrase):
  *         for icol in range(ncol):             # <<<<<<<<<<<<<<
  *             weight = weights[icol]
  *             if weight == 0:
  */
     __pyx_t_6 = __pyx_v_ncol;
-    __pyx_t_7 = __pyx_t_6;
-    for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
-      __pyx_v_icol = __pyx_t_8;
+    for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
+      __pyx_v_icol = __pyx_t_7;
 
-      /* "playhouse/_sqlite_ext.pyx":913
+      /* "playhouse/_sqlite_ext.pyx":912
  *     for iphrase in range(nphrase):
  *         for icol in range(ncol):
  *             weight = weights[icol]             # <<<<<<<<<<<<<<
  *             if weight == 0:
  *                 continue
  */
       __pyx_v_weight = (__pyx_v_weights[__pyx_v_icol]);
 
-      /* "playhouse/_sqlite_ext.pyx":914
+      /* "playhouse/_sqlite_ext.pyx":913
  *         for icol in range(ncol):
  *             weight = weights[icol]
  *             if weight == 0:             # <<<<<<<<<<<<<<
  *                 continue
  * 
  */
-      __pyx_t_9 = ((__pyx_v_weight == 0.0) != 0);
-      if (__pyx_t_9) {
+      __pyx_t_8 = ((__pyx_v_weight == 0.0) != 0);
+      if (__pyx_t_8) {
 
-        /* "playhouse/_sqlite_ext.pyx":915
+        /* "playhouse/_sqlite_ext.pyx":914
  *             weight = weights[icol]
  *             if weight == 0:
  *                 continue             # <<<<<<<<<<<<<<
  * 
  *             x = X_O + (3 * (icol + iphrase * ncol))
  */
         goto __pyx_L5_continue;
 
-        /* "playhouse/_sqlite_ext.pyx":914
+        /* "playhouse/_sqlite_ext.pyx":913
  *         for icol in range(ncol):
  *             weight = weights[icol]
  *             if weight == 0:             # <<<<<<<<<<<<<<
  *                 continue
  * 
  */
       }
 
-      /* "playhouse/_sqlite_ext.pyx":917
+      /* "playhouse/_sqlite_ext.pyx":916
  *                 continue
  * 
  *             x = X_O + (3 * (icol + iphrase * ncol))             # <<<<<<<<<<<<<<
  *             term_frequency = match_info[x]  # f(qi, D)
  *             docs_with_term = match_info[x + 2]  # n(qi)
  */
       __pyx_v_x = (__pyx_v_X_O + (3 * (__pyx_v_icol + (__pyx_v_iphrase * __pyx_v_ncol))));
 
-      /* "playhouse/_sqlite_ext.pyx":918
+      /* "playhouse/_sqlite_ext.pyx":917
  * 
  *             x = X_O + (3 * (icol + iphrase * ncol))
  *             term_frequency = match_info[x]  # f(qi, D)             # <<<<<<<<<<<<<<
  *             docs_with_term = match_info[x + 2]  # n(qi)
  * 
  */
       __pyx_v_term_frequency = (__pyx_v_match_info[__pyx_v_x]);
 
-      /* "playhouse/_sqlite_ext.pyx":919
+      /* "playhouse/_sqlite_ext.pyx":918
  *             x = X_O + (3 * (icol + iphrase * ncol))
  *             term_frequency = match_info[x]  # f(qi, D)
  *             docs_with_term = match_info[x + 2]  # n(qi)             # <<<<<<<<<<<<<<
  * 
  *             # log( (N - n(qi) + 0.5) / (n(qi) + 0.5) )
  */
       __pyx_v_docs_with_term = (__pyx_v_match_info[(__pyx_v_x + 2)]);
 
-      /* "playhouse/_sqlite_ext.pyx":923
+      /* "playhouse/_sqlite_ext.pyx":922
  *             # log( (N - n(qi) + 0.5) / (n(qi) + 0.5) )
  *             idf = log(
  *                     (total_docs - docs_with_term + 0.5) /             # <<<<<<<<<<<<<<
  *                     (docs_with_term + 0.5))
  *             if idf <= 0.0:
  */
-      __pyx_t_10 = ((__pyx_v_total_docs - __pyx_v_docs_with_term) + 0.5);
+      __pyx_t_9 = ((__pyx_v_total_docs - __pyx_v_docs_with_term) + 0.5);
 
-      /* "playhouse/_sqlite_ext.pyx":924
+      /* "playhouse/_sqlite_ext.pyx":923
  *             idf = log(
  *                     (total_docs - docs_with_term + 0.5) /
  *                     (docs_with_term + 0.5))             # <<<<<<<<<<<<<<
  *             if idf <= 0.0:
  *                 idf = 1e-6
  */
-      __pyx_t_11 = (__pyx_v_docs_with_term + 0.5);
+      __pyx_t_10 = (__pyx_v_docs_with_term + 0.5);
 
-      /* "playhouse/_sqlite_ext.pyx":923
+      /* "playhouse/_sqlite_ext.pyx":922
  *             # log( (N - n(qi) + 0.5) / (n(qi) + 0.5) )
  *             idf = log(
  *                     (total_docs - docs_with_term + 0.5) /             # <<<<<<<<<<<<<<
  *                     (docs_with_term + 0.5))
  *             if idf <= 0.0:
  */
-      if (unlikely(__pyx_t_11 == 0)) {
+      if (unlikely(__pyx_t_10 == 0)) {
         PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-        __PYX_ERR(0, 923, __pyx_L1_error)
+        __PYX_ERR(0, 922, __pyx_L1_error)
       }
 
-      /* "playhouse/_sqlite_ext.pyx":922
+      /* "playhouse/_sqlite_ext.pyx":921
  * 
  *             # log( (N - n(qi) + 0.5) / (n(qi) + 0.5) )
  *             idf = log(             # <<<<<<<<<<<<<<
  *                     (total_docs - docs_with_term + 0.5) /
  *                     (docs_with_term + 0.5))
  */
-      __pyx_v_idf = log((__pyx_t_10 / __pyx_t_11));
+      __pyx_v_idf = log((__pyx_t_9 / __pyx_t_10));
 
-      /* "playhouse/_sqlite_ext.pyx":925
+      /* "playhouse/_sqlite_ext.pyx":924
  *                     (total_docs - docs_with_term + 0.5) /
  *                     (docs_with_term + 0.5))
  *             if idf <= 0.0:             # <<<<<<<<<<<<<<
  *                 idf = 1e-6
  * 
  */
-      __pyx_t_9 = ((__pyx_v_idf <= 0.0) != 0);
-      if (__pyx_t_9) {
+      __pyx_t_8 = ((__pyx_v_idf <= 0.0) != 0);
+      if (__pyx_t_8) {
 
-        /* "playhouse/_sqlite_ext.pyx":926
+        /* "playhouse/_sqlite_ext.pyx":925
  *                     (docs_with_term + 0.5))
  *             if idf <= 0.0:
  *                 idf = 1e-6             # <<<<<<<<<<<<<<
  * 
  *             doc_length = match_info[L_O + icol]  # |D|
  */
         __pyx_v_idf = 1e-6;
 
-        /* "playhouse/_sqlite_ext.pyx":925
+        /* "playhouse/_sqlite_ext.pyx":924
  *                     (total_docs - docs_with_term + 0.5) /
  *                     (docs_with_term + 0.5))
  *             if idf <= 0.0:             # <<<<<<<<<<<<<<
  *                 idf = 1e-6
  * 
  */
       }
 
-      /* "playhouse/_sqlite_ext.pyx":928
+      /* "playhouse/_sqlite_ext.pyx":927
  *                 idf = 1e-6
  * 
  *             doc_length = match_info[L_O + icol]  # |D|             # <<<<<<<<<<<<<<
  *             avg_length = match_info[A_O + icol]  # avgdl
  *             if avg_length == 0:
  */
       __pyx_v_doc_length = (__pyx_v_match_info[(__pyx_v_L_O + __pyx_v_icol)]);
 
-      /* "playhouse/_sqlite_ext.pyx":929
+      /* "playhouse/_sqlite_ext.pyx":928
  * 
  *             doc_length = match_info[L_O + icol]  # |D|
  *             avg_length = match_info[A_O + icol]  # avgdl             # <<<<<<<<<<<<<<
  *             if avg_length == 0:
  *                 avg_length = 1
  */
       __pyx_v_avg_length = (__pyx_v_match_info[(__pyx_v_A_O + __pyx_v_icol)]);
 
-      /* "playhouse/_sqlite_ext.pyx":930
+      /* "playhouse/_sqlite_ext.pyx":929
  *             doc_length = match_info[L_O + icol]  # |D|
  *             avg_length = match_info[A_O + icol]  # avgdl
  *             if avg_length == 0:             # <<<<<<<<<<<<<<
  *                 avg_length = 1
  *             ratio = doc_length / avg_length
  */
-      __pyx_t_9 = ((__pyx_v_avg_length == 0.0) != 0);
-      if (__pyx_t_9) {
+      __pyx_t_8 = ((__pyx_v_avg_length == 0.0) != 0);
+      if (__pyx_t_8) {
 
-        /* "playhouse/_sqlite_ext.pyx":931
+        /* "playhouse/_sqlite_ext.pyx":930
  *             avg_length = match_info[A_O + icol]  # avgdl
  *             if avg_length == 0:
  *                 avg_length = 1             # <<<<<<<<<<<<<<
  *             ratio = doc_length / avg_length
  * 
  */
         __pyx_v_avg_length = 1.0;
 
-        /* "playhouse/_sqlite_ext.pyx":930
+        /* "playhouse/_sqlite_ext.pyx":929
  *             doc_length = match_info[L_O + icol]  # |D|
  *             avg_length = match_info[A_O + icol]  # avgdl
  *             if avg_length == 0:             # <<<<<<<<<<<<<<
  *                 avg_length = 1
  *             ratio = doc_length / avg_length
  */
       }
 
-      /* "playhouse/_sqlite_ext.pyx":932
+      /* "playhouse/_sqlite_ext.pyx":931
  *             if avg_length == 0:
  *                 avg_length = 1
  *             ratio = doc_length / avg_length             # <<<<<<<<<<<<<<
  * 
  *             num = term_frequency * (K + 1)
  */
       if (unlikely(__pyx_v_avg_length == 0)) {
         PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-        __PYX_ERR(0, 932, __pyx_L1_error)
+        __PYX_ERR(0, 931, __pyx_L1_error)
       }
       __pyx_v_ratio = (__pyx_v_doc_length / __pyx_v_avg_length);
 
-      /* "playhouse/_sqlite_ext.pyx":934
+      /* "playhouse/_sqlite_ext.pyx":933
  *             ratio = doc_length / avg_length
  * 
  *             num = term_frequency * (K + 1)             # <<<<<<<<<<<<<<
  *             b_part = 1 - B + (B * ratio)
  *             denom = term_frequency + (K * b_part)
  */
       __pyx_v_num = (__pyx_v_term_frequency * (__pyx_v_K + 1.0));
 
-      /* "playhouse/_sqlite_ext.pyx":935
+      /* "playhouse/_sqlite_ext.pyx":934
  * 
  *             num = term_frequency * (K + 1)
  *             b_part = 1 - B + (B * ratio)             # <<<<<<<<<<<<<<
  *             denom = term_frequency + (K * b_part)
  * 
  */
       __pyx_v_b_part = ((1.0 - __pyx_v_B) + (__pyx_v_B * __pyx_v_ratio));
 
-      /* "playhouse/_sqlite_ext.pyx":936
+      /* "playhouse/_sqlite_ext.pyx":935
  *             num = term_frequency * (K + 1)
  *             b_part = 1 - B + (B * ratio)
  *             denom = term_frequency + (K * b_part)             # <<<<<<<<<<<<<<
  * 
  *             pc_score = idf * (num / denom)
  */
       __pyx_v_denom = (__pyx_v_term_frequency + (__pyx_v_K * __pyx_v_b_part));
 
-      /* "playhouse/_sqlite_ext.pyx":938
+      /* "playhouse/_sqlite_ext.pyx":937
  *             denom = term_frequency + (K * b_part)
  * 
  *             pc_score = idf * (num / denom)             # <<<<<<<<<<<<<<
  *             score += (pc_score * weight)
  * 
  */
       if (unlikely(__pyx_v_denom == 0)) {
         PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-        __PYX_ERR(0, 938, __pyx_L1_error)
+        __PYX_ERR(0, 937, __pyx_L1_error)
       }
       __pyx_v_pc_score = (__pyx_v_idf * (__pyx_v_num / __pyx_v_denom));
 
-      /* "playhouse/_sqlite_ext.pyx":939
+      /* "playhouse/_sqlite_ext.pyx":938
  * 
  *             pc_score = idf * (num / denom)
  *             score += (pc_score * weight)             # <<<<<<<<<<<<<<
  * 
  *     free(weights)
  */
       __pyx_v_score = (__pyx_v_score + (__pyx_v_pc_score * __pyx_v_weight));
       __pyx_L5_continue:;
     }
   }
 
-  /* "playhouse/_sqlite_ext.pyx":941
+  /* "playhouse/_sqlite_ext.pyx":940
  *             score += (pc_score * weight)
  * 
  *     free(weights)             # <<<<<<<<<<<<<<
  *     return -1 * score
  * 
  */
   free(__pyx_v_weights);
 
-  /* "playhouse/_sqlite_ext.pyx":942
+  /* "playhouse/_sqlite_ext.pyx":941
  * 
  *     free(weights)
  *     return -1 * score             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((-1.0 * __pyx_v_score)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 942, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_r = __pyx_t_1;
-  __pyx_t_1 = 0;
+  __pyx_t_2 = PyFloat_FromDouble((-1.0 * __pyx_v_score)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 941, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_r = __pyx_t_2;
+  __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":874
+  /* "playhouse/_sqlite_ext.pyx":873
  * 
  * 
  * def peewee_bm25(py_match_info, *raw_weights):             # <<<<<<<<<<<<<<
  *     # Usage: peewee_bm25(matchinfo(table, 'pcnalx'), 1)
  *     # where the second parameter is the index of the column and
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
   __Pyx_AddTraceback("playhouse._sqlite_ext.peewee_bm25", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v__match_info_buf);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":945
+/* "playhouse/_sqlite_ext.pyx":944
  * 
  * 
  * def peewee_bm25f(py_match_info, *raw_weights):             # <<<<<<<<<<<<<<
  *     # Usage: peewee_bm25f(matchinfo(table, 'pcnalx'), 1)
  *     # where the second parameter is the index of the column and
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_7peewee_bm25f(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_7peewee_bm25f = {"peewee_bm25f", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_7peewee_bm25f, METH_VARARGS|METH_KEYWORDS, 0};
+static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_7peewee_bm25f = {"peewee_bm25f", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_7peewee_bm25f, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_7peewee_bm25f(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_py_match_info = 0;
   PyObject *__pyx_v_raw_weights = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("peewee_bm25f (wrapper)", 0);
   if (PyTuple_GET_SIZE(__pyx_args) > 1) {
@@ -9078,31 +8997,31 @@
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_py_match_info)) != 0)) kw_args--;
+        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_py_match_info)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t used_pos_args = (pos_args < 1) ? pos_args : 1;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, used_pos_args, "peewee_bm25f") < 0)) __PYX_ERR(0, 945, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, used_pos_args, "peewee_bm25f") < 0)) __PYX_ERR(0, 944, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) < 1) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
     }
     __pyx_v_py_match_info = values[0];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("peewee_bm25f", 0, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 945, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("peewee_bm25f", 0, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 944, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_DECREF(__pyx_v_raw_weights); __pyx_v_raw_weights = 0;
   __Pyx_AddTraceback("playhouse._sqlite_ext.peewee_bm25f", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_6peewee_bm25f(__pyx_self, __pyx_v_py_match_info, __pyx_v_raw_weights);
@@ -9144,475 +9063,478 @@
   int __pyx_v_iphrase;
   int __pyx_v_icol;
   int __pyx_v_x;
   double __pyx_v_score;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
-  char *__pyx_t_2;
-  int __pyx_t_3;
+  PyObject *__pyx_t_2 = NULL;
+  char *__pyx_t_3;
   int __pyx_t_4;
   int __pyx_t_5;
   double __pyx_t_6;
   int __pyx_t_7;
   int __pyx_t_8;
   int __pyx_t_9;
-  int __pyx_t_10;
-  double __pyx_t_11;
+  double __pyx_t_10;
   __Pyx_RefNannySetupContext("peewee_bm25f", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":951
+  /* "playhouse/_sqlite_ext.pyx":950
  *     cdef:
  *         unsigned int *match_info
  *         bytes _match_info_buf = bytes(py_match_info)             # <<<<<<<<<<<<<<
  *         char *match_info_buf = _match_info_buf
  *         int nphrase, ncol
  */
-  __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyBytes_Type)), __pyx_v_py_match_info); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 951, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 950, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_v__match_info_buf = ((PyObject*)__pyx_t_1);
-  __pyx_t_1 = 0;
+  __Pyx_INCREF(__pyx_v_py_match_info);
+  __Pyx_GIVEREF(__pyx_v_py_match_info);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_py_match_info);
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)(&PyBytes_Type)), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 950, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v__match_info_buf = ((PyObject*)__pyx_t_2);
+  __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":952
+  /* "playhouse/_sqlite_ext.pyx":951
  *         unsigned int *match_info
  *         bytes _match_info_buf = bytes(py_match_info)
  *         char *match_info_buf = _match_info_buf             # <<<<<<<<<<<<<<
  *         int nphrase, ncol
  *         double B = 0.75, K = 1.2, epsilon
  */
-  __pyx_t_2 = __Pyx_PyBytes_AsWritableString(__pyx_v__match_info_buf); if (unlikely((!__pyx_t_2) && PyErr_Occurred())) __PYX_ERR(0, 952, __pyx_L1_error)
-  __pyx_v_match_info_buf = __pyx_t_2;
+  __pyx_t_3 = __Pyx_PyBytes_AsWritableString(__pyx_v__match_info_buf); if (unlikely((!__pyx_t_3) && PyErr_Occurred())) __PYX_ERR(0, 951, __pyx_L1_error)
+  __pyx_v_match_info_buf = __pyx_t_3;
 
-  /* "playhouse/_sqlite_ext.pyx":954
+  /* "playhouse/_sqlite_ext.pyx":953
  *         char *match_info_buf = _match_info_buf
  *         int nphrase, ncol
  *         double B = 0.75, K = 1.2, epsilon             # <<<<<<<<<<<<<<
  *         double total_docs, term_frequency, docs_with_term
  *         double doc_length = 0.0, avg_length = 0.0
  */
   __pyx_v_B = 0.75;
   __pyx_v_K = 1.2;
 
-  /* "playhouse/_sqlite_ext.pyx":956
+  /* "playhouse/_sqlite_ext.pyx":955
  *         double B = 0.75, K = 1.2, epsilon
  *         double total_docs, term_frequency, docs_with_term
  *         double doc_length = 0.0, avg_length = 0.0             # <<<<<<<<<<<<<<
  *         double idf, weight, ratio, num, b_part, denom, pc_score
  *         double *weights
  */
   __pyx_v_doc_length = 0.0;
   __pyx_v_avg_length = 0.0;
 
-  /* "playhouse/_sqlite_ext.pyx":959
+  /* "playhouse/_sqlite_ext.pyx":958
  *         double idf, weight, ratio, num, b_part, denom, pc_score
  *         double *weights
  *         int P_O = 0, C_O = 1, N_O = 2, A_O = 3, L_O, X_O             # <<<<<<<<<<<<<<
  *         int iphrase, icol, x
  *         double score = 0.0
  */
   __pyx_v_P_O = 0;
   __pyx_v_C_O = 1;
   __pyx_v_N_O = 2;
   __pyx_v_A_O = 3;
 
-  /* "playhouse/_sqlite_ext.pyx":961
+  /* "playhouse/_sqlite_ext.pyx":960
  *         int P_O = 0, C_O = 1, N_O = 2, A_O = 3, L_O, X_O
  *         int iphrase, icol, x
  *         double score = 0.0             # <<<<<<<<<<<<<<
  * 
  *     match_info = <unsigned int *>match_info_buf
  */
   __pyx_v_score = 0.0;
 
-  /* "playhouse/_sqlite_ext.pyx":963
+  /* "playhouse/_sqlite_ext.pyx":962
  *         double score = 0.0
  * 
  *     match_info = <unsigned int *>match_info_buf             # <<<<<<<<<<<<<<
  *     nphrase = match_info[P_O]  # n
  *     ncol = match_info[C_O]
  */
   __pyx_v_match_info = ((unsigned int *)__pyx_v_match_info_buf);
 
-  /* "playhouse/_sqlite_ext.pyx":964
+  /* "playhouse/_sqlite_ext.pyx":963
  * 
  *     match_info = <unsigned int *>match_info_buf
  *     nphrase = match_info[P_O]  # n             # <<<<<<<<<<<<<<
  *     ncol = match_info[C_O]
  *     total_docs = match_info[N_O]  # N
  */
   __pyx_v_nphrase = (__pyx_v_match_info[__pyx_v_P_O]);
 
-  /* "playhouse/_sqlite_ext.pyx":965
+  /* "playhouse/_sqlite_ext.pyx":964
  *     match_info = <unsigned int *>match_info_buf
  *     nphrase = match_info[P_O]  # n
  *     ncol = match_info[C_O]             # <<<<<<<<<<<<<<
  *     total_docs = match_info[N_O]  # N
  * 
  */
   __pyx_v_ncol = (__pyx_v_match_info[__pyx_v_C_O]);
 
-  /* "playhouse/_sqlite_ext.pyx":966
+  /* "playhouse/_sqlite_ext.pyx":965
  *     nphrase = match_info[P_O]  # n
  *     ncol = match_info[C_O]
  *     total_docs = match_info[N_O]  # N             # <<<<<<<<<<<<<<
  * 
  *     L_O = A_O + ncol
  */
   __pyx_v_total_docs = (__pyx_v_match_info[__pyx_v_N_O]);
 
-  /* "playhouse/_sqlite_ext.pyx":968
+  /* "playhouse/_sqlite_ext.pyx":967
  *     total_docs = match_info[N_O]  # N
  * 
  *     L_O = A_O + ncol             # <<<<<<<<<<<<<<
  *     X_O = L_O + ncol
  * 
  */
   __pyx_v_L_O = (__pyx_v_A_O + __pyx_v_ncol);
 
-  /* "playhouse/_sqlite_ext.pyx":969
+  /* "playhouse/_sqlite_ext.pyx":968
  * 
  *     L_O = A_O + ncol
  *     X_O = L_O + ncol             # <<<<<<<<<<<<<<
  * 
  *     for icol in range(ncol):
  */
   __pyx_v_X_O = (__pyx_v_L_O + __pyx_v_ncol);
 
-  /* "playhouse/_sqlite_ext.pyx":971
+  /* "playhouse/_sqlite_ext.pyx":970
  *     X_O = L_O + ncol
  * 
  *     for icol in range(ncol):             # <<<<<<<<<<<<<<
  *         avg_length += match_info[A_O + icol]
  *         doc_length += match_info[L_O + icol]
  */
-  __pyx_t_3 = __pyx_v_ncol;
-  __pyx_t_4 = __pyx_t_3;
+  __pyx_t_4 = __pyx_v_ncol;
   for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
     __pyx_v_icol = __pyx_t_5;
 
-    /* "playhouse/_sqlite_ext.pyx":972
+    /* "playhouse/_sqlite_ext.pyx":971
  * 
  *     for icol in range(ncol):
  *         avg_length += match_info[A_O + icol]             # <<<<<<<<<<<<<<
  *         doc_length += match_info[L_O + icol]
  * 
  */
     __pyx_v_avg_length = (__pyx_v_avg_length + (__pyx_v_match_info[(__pyx_v_A_O + __pyx_v_icol)]));
 
-    /* "playhouse/_sqlite_ext.pyx":973
+    /* "playhouse/_sqlite_ext.pyx":972
  *     for icol in range(ncol):
  *         avg_length += match_info[A_O + icol]
  *         doc_length += match_info[L_O + icol]             # <<<<<<<<<<<<<<
  * 
  *     epsilon = 1.0 / (total_docs * avg_length)
  */
     __pyx_v_doc_length = (__pyx_v_doc_length + (__pyx_v_match_info[(__pyx_v_L_O + __pyx_v_icol)]));
   }
 
-  /* "playhouse/_sqlite_ext.pyx":975
+  /* "playhouse/_sqlite_ext.pyx":974
  *         doc_length += match_info[L_O + icol]
  * 
  *     epsilon = 1.0 / (total_docs * avg_length)             # <<<<<<<<<<<<<<
  *     if avg_length == 0:
  *         avg_length = 1
  */
   __pyx_t_6 = (__pyx_v_total_docs * __pyx_v_avg_length);
   if (unlikely(__pyx_t_6 == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 975, __pyx_L1_error)
+    __PYX_ERR(0, 974, __pyx_L1_error)
   }
   __pyx_v_epsilon = (1.0 / __pyx_t_6);
 
-  /* "playhouse/_sqlite_ext.pyx":976
+  /* "playhouse/_sqlite_ext.pyx":975
  * 
  *     epsilon = 1.0 / (total_docs * avg_length)
  *     if avg_length == 0:             # <<<<<<<<<<<<<<
  *         avg_length = 1
  *     ratio = doc_length / avg_length
  */
   __pyx_t_7 = ((__pyx_v_avg_length == 0.0) != 0);
   if (__pyx_t_7) {
 
-    /* "playhouse/_sqlite_ext.pyx":977
+    /* "playhouse/_sqlite_ext.pyx":976
  *     epsilon = 1.0 / (total_docs * avg_length)
  *     if avg_length == 0:
  *         avg_length = 1             # <<<<<<<<<<<<<<
  *     ratio = doc_length / avg_length
  *     weights = get_weights(ncol, raw_weights)
  */
     __pyx_v_avg_length = 1.0;
 
-    /* "playhouse/_sqlite_ext.pyx":976
+    /* "playhouse/_sqlite_ext.pyx":975
  * 
  *     epsilon = 1.0 / (total_docs * avg_length)
  *     if avg_length == 0:             # <<<<<<<<<<<<<<
  *         avg_length = 1
  *     ratio = doc_length / avg_length
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":978
+  /* "playhouse/_sqlite_ext.pyx":977
  *     if avg_length == 0:
  *         avg_length = 1
  *     ratio = doc_length / avg_length             # <<<<<<<<<<<<<<
  *     weights = get_weights(ncol, raw_weights)
  * 
  */
   if (unlikely(__pyx_v_avg_length == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 978, __pyx_L1_error)
+    __PYX_ERR(0, 977, __pyx_L1_error)
   }
   __pyx_v_ratio = (__pyx_v_doc_length / __pyx_v_avg_length);
 
-  /* "playhouse/_sqlite_ext.pyx":979
+  /* "playhouse/_sqlite_ext.pyx":978
  *         avg_length = 1
  *     ratio = doc_length / avg_length
  *     weights = get_weights(ncol, raw_weights)             # <<<<<<<<<<<<<<
  * 
  *     for iphrase in range(nphrase):
  */
   __pyx_v_weights = __pyx_f_9playhouse_11_sqlite_ext_get_weights(__pyx_v_ncol, __pyx_v_raw_weights);
 
-  /* "playhouse/_sqlite_ext.pyx":981
+  /* "playhouse/_sqlite_ext.pyx":980
  *     weights = get_weights(ncol, raw_weights)
  * 
  *     for iphrase in range(nphrase):             # <<<<<<<<<<<<<<
  *         for icol in range(ncol):
  *             weight = weights[icol]
  */
-  __pyx_t_3 = __pyx_v_nphrase;
-  __pyx_t_4 = __pyx_t_3;
+  __pyx_t_4 = __pyx_v_nphrase;
   for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
     __pyx_v_iphrase = __pyx_t_5;
 
-    /* "playhouse/_sqlite_ext.pyx":982
+    /* "playhouse/_sqlite_ext.pyx":981
  * 
  *     for iphrase in range(nphrase):
  *         for icol in range(ncol):             # <<<<<<<<<<<<<<
  *             weight = weights[icol]
  *             if weight == 0:
  */
     __pyx_t_8 = __pyx_v_ncol;
-    __pyx_t_9 = __pyx_t_8;
-    for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
-      __pyx_v_icol = __pyx_t_10;
+    for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
+      __pyx_v_icol = __pyx_t_9;
 
-      /* "playhouse/_sqlite_ext.pyx":983
+      /* "playhouse/_sqlite_ext.pyx":982
  *     for iphrase in range(nphrase):
  *         for icol in range(ncol):
  *             weight = weights[icol]             # <<<<<<<<<<<<<<
  *             if weight == 0:
  *                 continue
  */
       __pyx_v_weight = (__pyx_v_weights[__pyx_v_icol]);
 
-      /* "playhouse/_sqlite_ext.pyx":984
+      /* "playhouse/_sqlite_ext.pyx":983
  *         for icol in range(ncol):
  *             weight = weights[icol]
  *             if weight == 0:             # <<<<<<<<<<<<<<
  *                 continue
  * 
  */
       __pyx_t_7 = ((__pyx_v_weight == 0.0) != 0);
       if (__pyx_t_7) {
 
-        /* "playhouse/_sqlite_ext.pyx":985
+        /* "playhouse/_sqlite_ext.pyx":984
  *             weight = weights[icol]
  *             if weight == 0:
  *                 continue             # <<<<<<<<<<<<<<
  * 
  *             x = X_O + (3 * (icol + iphrase * ncol))
  */
         goto __pyx_L8_continue;
 
-        /* "playhouse/_sqlite_ext.pyx":984
+        /* "playhouse/_sqlite_ext.pyx":983
  *         for icol in range(ncol):
  *             weight = weights[icol]
  *             if weight == 0:             # <<<<<<<<<<<<<<
  *                 continue
  * 
  */
       }
 
-      /* "playhouse/_sqlite_ext.pyx":987
+      /* "playhouse/_sqlite_ext.pyx":986
  *                 continue
  * 
  *             x = X_O + (3 * (icol + iphrase * ncol))             # <<<<<<<<<<<<<<
  *             term_frequency = match_info[x]  # f(qi, D)
  *             docs_with_term = match_info[x + 2]  # n(qi)
  */
       __pyx_v_x = (__pyx_v_X_O + (3 * (__pyx_v_icol + (__pyx_v_iphrase * __pyx_v_ncol))));
 
-      /* "playhouse/_sqlite_ext.pyx":988
+      /* "playhouse/_sqlite_ext.pyx":987
  * 
  *             x = X_O + (3 * (icol + iphrase * ncol))
  *             term_frequency = match_info[x]  # f(qi, D)             # <<<<<<<<<<<<<<
  *             docs_with_term = match_info[x + 2]  # n(qi)
  * 
  */
       __pyx_v_term_frequency = (__pyx_v_match_info[__pyx_v_x]);
 
-      /* "playhouse/_sqlite_ext.pyx":989
+      /* "playhouse/_sqlite_ext.pyx":988
  *             x = X_O + (3 * (icol + iphrase * ncol))
  *             term_frequency = match_info[x]  # f(qi, D)
  *             docs_with_term = match_info[x + 2]  # n(qi)             # <<<<<<<<<<<<<<
  * 
  *             # log( (N - n(qi) + 0.5) / (n(qi) + 0.5) )
  */
       __pyx_v_docs_with_term = (__pyx_v_match_info[(__pyx_v_x + 2)]);
 
-      /* "playhouse/_sqlite_ext.pyx":993
+      /* "playhouse/_sqlite_ext.pyx":992
  *             # log( (N - n(qi) + 0.5) / (n(qi) + 0.5) )
  *             idf = log(
  *                 (total_docs - docs_with_term + 0.5) /             # <<<<<<<<<<<<<<
  *                 (docs_with_term + 0.5))
  *             idf = epsilon if idf <= 0 else idf
  */
       __pyx_t_6 = ((__pyx_v_total_docs - __pyx_v_docs_with_term) + 0.5);
 
-      /* "playhouse/_sqlite_ext.pyx":994
+      /* "playhouse/_sqlite_ext.pyx":993
  *             idf = log(
  *                 (total_docs - docs_with_term + 0.5) /
  *                 (docs_with_term + 0.5))             # <<<<<<<<<<<<<<
  *             idf = epsilon if idf <= 0 else idf
  * 
  */
-      __pyx_t_11 = (__pyx_v_docs_with_term + 0.5);
+      __pyx_t_10 = (__pyx_v_docs_with_term + 0.5);
 
-      /* "playhouse/_sqlite_ext.pyx":993
+      /* "playhouse/_sqlite_ext.pyx":992
  *             # log( (N - n(qi) + 0.5) / (n(qi) + 0.5) )
  *             idf = log(
  *                 (total_docs - docs_with_term + 0.5) /             # <<<<<<<<<<<<<<
  *                 (docs_with_term + 0.5))
  *             idf = epsilon if idf <= 0 else idf
  */
-      if (unlikely(__pyx_t_11 == 0)) {
+      if (unlikely(__pyx_t_10 == 0)) {
         PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-        __PYX_ERR(0, 993, __pyx_L1_error)
+        __PYX_ERR(0, 992, __pyx_L1_error)
       }
 
-      /* "playhouse/_sqlite_ext.pyx":992
+      /* "playhouse/_sqlite_ext.pyx":991
  * 
  *             # log( (N - n(qi) + 0.5) / (n(qi) + 0.5) )
  *             idf = log(             # <<<<<<<<<<<<<<
  *                 (total_docs - docs_with_term + 0.5) /
  *                 (docs_with_term + 0.5))
  */
-      __pyx_v_idf = log((__pyx_t_6 / __pyx_t_11));
+      __pyx_v_idf = log((__pyx_t_6 / __pyx_t_10));
 
-      /* "playhouse/_sqlite_ext.pyx":995
+      /* "playhouse/_sqlite_ext.pyx":994
  *                 (total_docs - docs_with_term + 0.5) /
  *                 (docs_with_term + 0.5))
  *             idf = epsilon if idf <= 0 else idf             # <<<<<<<<<<<<<<
  * 
  *             num = term_frequency * (K + 1)
  */
       if (((__pyx_v_idf <= 0.0) != 0)) {
-        __pyx_t_11 = __pyx_v_epsilon;
+        __pyx_t_10 = __pyx_v_epsilon;
       } else {
-        __pyx_t_11 = __pyx_v_idf;
+        __pyx_t_10 = __pyx_v_idf;
       }
-      __pyx_v_idf = __pyx_t_11;
+      __pyx_v_idf = __pyx_t_10;
 
-      /* "playhouse/_sqlite_ext.pyx":997
+      /* "playhouse/_sqlite_ext.pyx":996
  *             idf = epsilon if idf <= 0 else idf
  * 
  *             num = term_frequency * (K + 1)             # <<<<<<<<<<<<<<
  *             b_part = 1 - B + (B * ratio)
  *             denom = term_frequency + (K * b_part)
  */
       __pyx_v_num = (__pyx_v_term_frequency * (__pyx_v_K + 1.0));
 
-      /* "playhouse/_sqlite_ext.pyx":998
+      /* "playhouse/_sqlite_ext.pyx":997
  * 
  *             num = term_frequency * (K + 1)
  *             b_part = 1 - B + (B * ratio)             # <<<<<<<<<<<<<<
  *             denom = term_frequency + (K * b_part)
  * 
  */
       __pyx_v_b_part = ((1.0 - __pyx_v_B) + (__pyx_v_B * __pyx_v_ratio));
 
-      /* "playhouse/_sqlite_ext.pyx":999
+      /* "playhouse/_sqlite_ext.pyx":998
  *             num = term_frequency * (K + 1)
  *             b_part = 1 - B + (B * ratio)
  *             denom = term_frequency + (K * b_part)             # <<<<<<<<<<<<<<
  * 
  *             pc_score = idf * ((num / denom) + 1.)
  */
       __pyx_v_denom = (__pyx_v_term_frequency + (__pyx_v_K * __pyx_v_b_part));
 
-      /* "playhouse/_sqlite_ext.pyx":1001
+      /* "playhouse/_sqlite_ext.pyx":1000
  *             denom = term_frequency + (K * b_part)
  * 
  *             pc_score = idf * ((num / denom) + 1.)             # <<<<<<<<<<<<<<
  *             score += (pc_score * weight)
  * 
  */
       if (unlikely(__pyx_v_denom == 0)) {
         PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-        __PYX_ERR(0, 1001, __pyx_L1_error)
+        __PYX_ERR(0, 1000, __pyx_L1_error)
       }
       __pyx_v_pc_score = (__pyx_v_idf * ((__pyx_v_num / __pyx_v_denom) + 1.));
 
-      /* "playhouse/_sqlite_ext.pyx":1002
+      /* "playhouse/_sqlite_ext.pyx":1001
  * 
  *             pc_score = idf * ((num / denom) + 1.)
  *             score += (pc_score * weight)             # <<<<<<<<<<<<<<
  * 
  *     free(weights)
  */
       __pyx_v_score = (__pyx_v_score + (__pyx_v_pc_score * __pyx_v_weight));
       __pyx_L8_continue:;
     }
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1004
+  /* "playhouse/_sqlite_ext.pyx":1003
  *             score += (pc_score * weight)
  * 
  *     free(weights)             # <<<<<<<<<<<<<<
  *     return -1 * score
  * 
  */
   free(__pyx_v_weights);
 
-  /* "playhouse/_sqlite_ext.pyx":1005
+  /* "playhouse/_sqlite_ext.pyx":1004
  * 
  *     free(weights)
  *     return -1 * score             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble((-1.0 * __pyx_v_score)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1005, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_r = __pyx_t_1;
-  __pyx_t_1 = 0;
+  __pyx_t_2 = PyFloat_FromDouble((-1.0 * __pyx_v_score)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1004, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_r = __pyx_t_2;
+  __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":945
+  /* "playhouse/_sqlite_ext.pyx":944
  * 
  * 
  * def peewee_bm25f(py_match_info, *raw_weights):             # <<<<<<<<<<<<<<
  *     # Usage: peewee_bm25f(matchinfo(table, 'pcnalx'), 1)
  *     # where the second parameter is the index of the column and
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
   __Pyx_AddTraceback("playhouse._sqlite_ext.peewee_bm25f", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v__match_info_buf);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1008
+/* "playhouse/_sqlite_ext.pyx":1007
  * 
  * 
  * cdef uint32_t murmurhash2(const unsigned char *key, ssize_t nlen,             # <<<<<<<<<<<<<<
  *                           uint32_t seed):
  *     cdef:
  */
 
@@ -9623,289 +9545,289 @@
   uint32_t __pyx_v_h;
   uint32_t __pyx_v_k;
   uint32_t __pyx_r;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("murmurhash2", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1011
+  /* "playhouse/_sqlite_ext.pyx":1010
  *                           uint32_t seed):
  *     cdef:
  *         uint32_t m = 0x5bd1e995             # <<<<<<<<<<<<<<
  *         int r = 24
  *         const unsigned char *data = key
  */
   __pyx_v_m = 0x5bd1e995;
 
-  /* "playhouse/_sqlite_ext.pyx":1012
+  /* "playhouse/_sqlite_ext.pyx":1011
  *     cdef:
  *         uint32_t m = 0x5bd1e995
  *         int r = 24             # <<<<<<<<<<<<<<
  *         const unsigned char *data = key
  *         uint32_t h = seed ^ nlen
  */
   __pyx_v_r = 24;
 
-  /* "playhouse/_sqlite_ext.pyx":1013
+  /* "playhouse/_sqlite_ext.pyx":1012
  *         uint32_t m = 0x5bd1e995
  *         int r = 24
  *         const unsigned char *data = key             # <<<<<<<<<<<<<<
  *         uint32_t h = seed ^ nlen
  *         uint32_t k
  */
   __pyx_v_data = __pyx_v_key;
 
-  /* "playhouse/_sqlite_ext.pyx":1014
+  /* "playhouse/_sqlite_ext.pyx":1013
  *         int r = 24
  *         const unsigned char *data = key
  *         uint32_t h = seed ^ nlen             # <<<<<<<<<<<<<<
  *         uint32_t k
  * 
  */
   __pyx_v_h = (__pyx_v_seed ^ __pyx_v_nlen);
 
-  /* "playhouse/_sqlite_ext.pyx":1017
+  /* "playhouse/_sqlite_ext.pyx":1016
  *         uint32_t k
  * 
  *     while nlen >= 4:             # <<<<<<<<<<<<<<
  *         k = <uint32_t>((<uint32_t *>data)[0])
  * 
  */
   while (1) {
     __pyx_t_1 = ((__pyx_v_nlen >= 4) != 0);
     if (!__pyx_t_1) break;
 
-    /* "playhouse/_sqlite_ext.pyx":1018
+    /* "playhouse/_sqlite_ext.pyx":1017
  * 
  *     while nlen >= 4:
  *         k = <uint32_t>((<uint32_t *>data)[0])             # <<<<<<<<<<<<<<
  * 
  *         k *= m
  */
     __pyx_v_k = ((uint32_t)(((uint32_t *)__pyx_v_data)[0]));
 
-    /* "playhouse/_sqlite_ext.pyx":1020
+    /* "playhouse/_sqlite_ext.pyx":1019
  *         k = <uint32_t>((<uint32_t *>data)[0])
  * 
  *         k *= m             # <<<<<<<<<<<<<<
  *         k = k ^ (k >> r)
  *         k *= m
  */
     __pyx_v_k = (__pyx_v_k * __pyx_v_m);
 
-    /* "playhouse/_sqlite_ext.pyx":1021
+    /* "playhouse/_sqlite_ext.pyx":1020
  * 
  *         k *= m
  *         k = k ^ (k >> r)             # <<<<<<<<<<<<<<
  *         k *= m
  * 
  */
     __pyx_v_k = (__pyx_v_k ^ (__pyx_v_k >> __pyx_v_r));
 
-    /* "playhouse/_sqlite_ext.pyx":1022
+    /* "playhouse/_sqlite_ext.pyx":1021
  *         k *= m
  *         k = k ^ (k >> r)
  *         k *= m             # <<<<<<<<<<<<<<
  * 
  *         h *= m
  */
     __pyx_v_k = (__pyx_v_k * __pyx_v_m);
 
-    /* "playhouse/_sqlite_ext.pyx":1024
+    /* "playhouse/_sqlite_ext.pyx":1023
  *         k *= m
  * 
  *         h *= m             # <<<<<<<<<<<<<<
  *         h = h ^ k
  * 
  */
     __pyx_v_h = (__pyx_v_h * __pyx_v_m);
 
-    /* "playhouse/_sqlite_ext.pyx":1025
+    /* "playhouse/_sqlite_ext.pyx":1024
  * 
  *         h *= m
  *         h = h ^ k             # <<<<<<<<<<<<<<
  * 
  *         data += 4
  */
     __pyx_v_h = (__pyx_v_h ^ __pyx_v_k);
 
-    /* "playhouse/_sqlite_ext.pyx":1027
+    /* "playhouse/_sqlite_ext.pyx":1026
  *         h = h ^ k
  * 
  *         data += 4             # <<<<<<<<<<<<<<
  *         nlen -= 4
  * 
  */
     __pyx_v_data = (__pyx_v_data + 4);
 
-    /* "playhouse/_sqlite_ext.pyx":1028
+    /* "playhouse/_sqlite_ext.pyx":1027
  * 
  *         data += 4
  *         nlen -= 4             # <<<<<<<<<<<<<<
  * 
  *     if nlen == 3:
  */
     __pyx_v_nlen = (__pyx_v_nlen - 4);
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1030
+  /* "playhouse/_sqlite_ext.pyx":1029
  *         nlen -= 4
  * 
  *     if nlen == 3:             # <<<<<<<<<<<<<<
  *         h = h ^ (data[2] << 16)
  *     if nlen >= 2:
  */
   __pyx_t_1 = ((__pyx_v_nlen == 3) != 0);
   if (__pyx_t_1) {
 
-    /* "playhouse/_sqlite_ext.pyx":1031
+    /* "playhouse/_sqlite_ext.pyx":1030
  * 
  *     if nlen == 3:
  *         h = h ^ (data[2] << 16)             # <<<<<<<<<<<<<<
  *     if nlen >= 2:
  *         h = h ^ (data[1] << 8)
  */
     __pyx_v_h = (__pyx_v_h ^ ((__pyx_v_data[2]) << 16));
 
-    /* "playhouse/_sqlite_ext.pyx":1030
+    /* "playhouse/_sqlite_ext.pyx":1029
  *         nlen -= 4
  * 
  *     if nlen == 3:             # <<<<<<<<<<<<<<
  *         h = h ^ (data[2] << 16)
  *     if nlen >= 2:
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1032
+  /* "playhouse/_sqlite_ext.pyx":1031
  *     if nlen == 3:
  *         h = h ^ (data[2] << 16)
  *     if nlen >= 2:             # <<<<<<<<<<<<<<
  *         h = h ^ (data[1] << 8)
  *     if nlen >= 1:
  */
   __pyx_t_1 = ((__pyx_v_nlen >= 2) != 0);
   if (__pyx_t_1) {
 
-    /* "playhouse/_sqlite_ext.pyx":1033
+    /* "playhouse/_sqlite_ext.pyx":1032
  *         h = h ^ (data[2] << 16)
  *     if nlen >= 2:
  *         h = h ^ (data[1] << 8)             # <<<<<<<<<<<<<<
  *     if nlen >= 1:
  *         h = h ^ (data[0])
  */
     __pyx_v_h = (__pyx_v_h ^ ((__pyx_v_data[1]) << 8));
 
-    /* "playhouse/_sqlite_ext.pyx":1032
+    /* "playhouse/_sqlite_ext.pyx":1031
  *     if nlen == 3:
  *         h = h ^ (data[2] << 16)
  *     if nlen >= 2:             # <<<<<<<<<<<<<<
  *         h = h ^ (data[1] << 8)
  *     if nlen >= 1:
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1034
+  /* "playhouse/_sqlite_ext.pyx":1033
  *     if nlen >= 2:
  *         h = h ^ (data[1] << 8)
  *     if nlen >= 1:             # <<<<<<<<<<<<<<
  *         h = h ^ (data[0])
  *         h *= m
  */
   __pyx_t_1 = ((__pyx_v_nlen >= 1) != 0);
   if (__pyx_t_1) {
 
-    /* "playhouse/_sqlite_ext.pyx":1035
+    /* "playhouse/_sqlite_ext.pyx":1034
  *         h = h ^ (data[1] << 8)
  *     if nlen >= 1:
  *         h = h ^ (data[0])             # <<<<<<<<<<<<<<
  *         h *= m
  * 
  */
     __pyx_v_h = (__pyx_v_h ^ (__pyx_v_data[0]));
 
-    /* "playhouse/_sqlite_ext.pyx":1036
+    /* "playhouse/_sqlite_ext.pyx":1035
  *     if nlen >= 1:
  *         h = h ^ (data[0])
  *         h *= m             # <<<<<<<<<<<<<<
  * 
  *     h = h ^ (h >> 13)
  */
     __pyx_v_h = (__pyx_v_h * __pyx_v_m);
 
-    /* "playhouse/_sqlite_ext.pyx":1034
+    /* "playhouse/_sqlite_ext.pyx":1033
  *     if nlen >= 2:
  *         h = h ^ (data[1] << 8)
  *     if nlen >= 1:             # <<<<<<<<<<<<<<
  *         h = h ^ (data[0])
  *         h *= m
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1038
+  /* "playhouse/_sqlite_ext.pyx":1037
  *         h *= m
  * 
  *     h = h ^ (h >> 13)             # <<<<<<<<<<<<<<
  *     h *= m
  *     h = h ^ (h >> 15)
  */
   __pyx_v_h = (__pyx_v_h ^ (__pyx_v_h >> 13));
 
-  /* "playhouse/_sqlite_ext.pyx":1039
+  /* "playhouse/_sqlite_ext.pyx":1038
  * 
  *     h = h ^ (h >> 13)
  *     h *= m             # <<<<<<<<<<<<<<
  *     h = h ^ (h >> 15)
  *     return h
  */
   __pyx_v_h = (__pyx_v_h * __pyx_v_m);
 
-  /* "playhouse/_sqlite_ext.pyx":1040
+  /* "playhouse/_sqlite_ext.pyx":1039
  *     h = h ^ (h >> 13)
  *     h *= m
  *     h = h ^ (h >> 15)             # <<<<<<<<<<<<<<
  *     return h
  * 
  */
   __pyx_v_h = (__pyx_v_h ^ (__pyx_v_h >> 15));
 
-  /* "playhouse/_sqlite_ext.pyx":1041
+  /* "playhouse/_sqlite_ext.pyx":1040
  *     h *= m
  *     h = h ^ (h >> 15)
  *     return h             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = __pyx_v_h;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1008
+  /* "playhouse/_sqlite_ext.pyx":1007
  * 
  * 
  * cdef uint32_t murmurhash2(const unsigned char *key, ssize_t nlen,             # <<<<<<<<<<<<<<
  *                           uint32_t seed):
  *     cdef:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1044
+/* "playhouse/_sqlite_ext.pyx":1043
  * 
  * 
  * def peewee_murmurhash(key, seed=None):             # <<<<<<<<<<<<<<
  *     if key is None:
  *         return
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_9peewee_murmurhash(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_9peewee_murmurhash = {"peewee_murmurhash", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_9peewee_murmurhash, METH_VARARGS|METH_KEYWORDS, 0};
+static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_9peewee_murmurhash = {"peewee_murmurhash", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_9peewee_murmurhash, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_9peewee_murmurhash(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_key = 0;
   PyObject *__pyx_v_seed = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("peewee_murmurhash (wrapper)", 0);
   {
@@ -9922,25 +9844,25 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_key)) != 0)) kw_args--;
+        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_key)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_seed);
+          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_seed);
           if (value) { values[1] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "peewee_murmurhash") < 0)) __PYX_ERR(0, 1044, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "peewee_murmurhash") < 0)) __PYX_ERR(0, 1043, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
@@ -9948,15 +9870,15 @@
       }
     }
     __pyx_v_key = values[0];
     __pyx_v_seed = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("peewee_murmurhash", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1044, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("peewee_murmurhash", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1043, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("playhouse._sqlite_ext.peewee_murmurhash", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_8peewee_murmurhash(__pyx_self, __pyx_v_key, __pyx_v_seed);
 
@@ -9975,131 +9897,131 @@
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   int __pyx_t_5;
   unsigned char *__pyx_t_6;
   Py_ssize_t __pyx_t_7;
   __Pyx_RefNannySetupContext("peewee_murmurhash", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1045
+  /* "playhouse/_sqlite_ext.pyx":1044
  * 
  * def peewee_murmurhash(key, seed=None):
  *     if key is None:             # <<<<<<<<<<<<<<
  *         return
  * 
  */
   __pyx_t_1 = (__pyx_v_key == Py_None);
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":1046
+    /* "playhouse/_sqlite_ext.pyx":1045
  * def peewee_murmurhash(key, seed=None):
  *     if key is None:
  *         return             # <<<<<<<<<<<<<<
  * 
  *     cdef:
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "playhouse/_sqlite_ext.pyx":1045
+    /* "playhouse/_sqlite_ext.pyx":1044
  * 
  * def peewee_murmurhash(key, seed=None):
  *     if key is None:             # <<<<<<<<<<<<<<
  *         return
  * 
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1049
+  /* "playhouse/_sqlite_ext.pyx":1048
  * 
  *     cdef:
  *         bytes bkey = encode(key)             # <<<<<<<<<<<<<<
  *         int nseed = seed or 0
  * 
  */
-  __pyx_t_3 = __pyx_f_9playhouse_11_sqlite_ext_encode(__pyx_v_key); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1049, __pyx_L1_error)
+  __pyx_t_3 = __pyx_f_9playhouse_11_sqlite_ext_encode(__pyx_v_key); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1048, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_v_bkey = ((PyObject*)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1050
+  /* "playhouse/_sqlite_ext.pyx":1049
  *     cdef:
  *         bytes bkey = encode(key)
  *         int nseed = seed or 0             # <<<<<<<<<<<<<<
  * 
  *     if key:
  */
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_seed); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1050, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_seed); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1049, __pyx_L1_error)
   if (!__pyx_t_2) {
   } else {
-    __pyx_t_5 = __Pyx_PyInt_As_int(__pyx_v_seed); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1050, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_As_int(__pyx_v_seed); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1049, __pyx_L1_error)
     __pyx_t_4 = __pyx_t_5;
     goto __pyx_L4_bool_binop_done;
   }
   __pyx_t_4 = 0;
   __pyx_L4_bool_binop_done:;
   __pyx_v_nseed = __pyx_t_4;
 
-  /* "playhouse/_sqlite_ext.pyx":1052
+  /* "playhouse/_sqlite_ext.pyx":1051
  *         int nseed = seed or 0
  * 
  *     if key:             # <<<<<<<<<<<<<<
  *         return murmurhash2(<unsigned char *>bkey, len(bkey), nseed)
  *     return 0
  */
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_key); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1052, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_key); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1051, __pyx_L1_error)
   if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":1053
+    /* "playhouse/_sqlite_ext.pyx":1052
  * 
  *     if key:
  *         return murmurhash2(<unsigned char *>bkey, len(bkey), nseed)             # <<<<<<<<<<<<<<
  *     return 0
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     if (unlikely(__pyx_v_bkey == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "expected bytes, NoneType found");
-      __PYX_ERR(0, 1053, __pyx_L1_error)
+      __PYX_ERR(0, 1052, __pyx_L1_error)
     }
-    __pyx_t_6 = __Pyx_PyBytes_AsWritableUString(__pyx_v_bkey); if (unlikely((!__pyx_t_6) && PyErr_Occurred())) __PYX_ERR(0, 1053, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyBytes_AsWritableUString(__pyx_v_bkey); if (unlikely((!__pyx_t_6) && PyErr_Occurred())) __PYX_ERR(0, 1052, __pyx_L1_error)
     if (unlikely(__pyx_v_bkey == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "object of type 'NoneType' has no len()");
-      __PYX_ERR(0, 1053, __pyx_L1_error)
+      __PYX_ERR(0, 1052, __pyx_L1_error)
     }
-    __pyx_t_7 = PyBytes_GET_SIZE(__pyx_v_bkey); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1053, __pyx_L1_error)
-    __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_f_9playhouse_11_sqlite_ext_murmurhash2(((unsigned char *)__pyx_t_6), __pyx_t_7, __pyx_v_nseed)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1053, __pyx_L1_error)
+    __pyx_t_7 = PyBytes_GET_SIZE(__pyx_v_bkey); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1052, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_f_9playhouse_11_sqlite_ext_murmurhash2(((unsigned char *)__pyx_t_6), __pyx_t_7, __pyx_v_nseed)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1052, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
     goto __pyx_L0;
 
-    /* "playhouse/_sqlite_ext.pyx":1052
+    /* "playhouse/_sqlite_ext.pyx":1051
  *         int nseed = seed or 0
  * 
  *     if key:             # <<<<<<<<<<<<<<
  *         return murmurhash2(<unsigned char *>bkey, len(bkey), nseed)
  *     return 0
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1054
+  /* "playhouse/_sqlite_ext.pyx":1053
  *     if key:
  *         return murmurhash2(<unsigned char *>bkey, len(bkey), nseed)
  *     return 0             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_int_0);
   __pyx_r = __pyx_int_0;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1044
+  /* "playhouse/_sqlite_ext.pyx":1043
  * 
  * 
  * def peewee_murmurhash(key, seed=None):             # <<<<<<<<<<<<<<
  *     if key is None:
  *         return
  */
 
@@ -10111,15 +10033,15 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_bkey);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1057
+/* "playhouse/_sqlite_ext.pyx":1056
  * 
  * 
  * def make_hash(hash_impl):             # <<<<<<<<<<<<<<
  *     def inner(*items):
  *         state = hash_impl()
  */
 
@@ -10133,25 +10055,25 @@
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_10make_hash(__pyx_self, ((PyObject *)__pyx_v_hash_impl));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1058
+/* "playhouse/_sqlite_ext.pyx":1057
  * 
  * def make_hash(hash_impl):
  *     def inner(*items):             # <<<<<<<<<<<<<<
  *         state = hash_impl()
  *         for item in items:
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_9make_hash_1inner(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_9make_hash_1inner = {"inner", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_9make_hash_1inner, METH_VARARGS|METH_KEYWORDS, 0};
+static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_9make_hash_1inner = {"inner", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_9make_hash_1inner, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_9make_hash_1inner(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_items = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("inner (wrapper)", 0);
   if (unlikely(__pyx_kwds) && unlikely(PyDict_Size(__pyx_kwds) > 0) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "inner", 0))) return NULL;
   __Pyx_INCREF(__pyx_args);
@@ -10173,158 +10095,196 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   Py_ssize_t __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
+  PyObject *__pyx_t_7 = NULL;
   __Pyx_RefNannySetupContext("inner", 0);
   __pyx_outer_scope = (struct __pyx_obj_9playhouse_11_sqlite_ext___pyx_scope_struct__make_hash *) __Pyx_CyFunction_GetClosure(__pyx_self);
   __pyx_cur_scope = __pyx_outer_scope;
 
-  /* "playhouse/_sqlite_ext.pyx":1059
+  /* "playhouse/_sqlite_ext.pyx":1058
  * def make_hash(hash_impl):
  *     def inner(*items):
  *         state = hash_impl()             # <<<<<<<<<<<<<<
  *         for item in items:
  *             state.update(encode(item))
  */
-  if (unlikely(!__pyx_cur_scope->__pyx_v_hash_impl)) { __Pyx_RaiseClosureNameError("hash_impl"); __PYX_ERR(0, 1059, __pyx_L1_error) }
+  if (unlikely(!__pyx_cur_scope->__pyx_v_hash_impl)) { __Pyx_RaiseClosureNameError("hash_impl"); __PYX_ERR(0, 1058, __pyx_L1_error) }
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_hash_impl);
   __pyx_t_2 = __pyx_cur_scope->__pyx_v_hash_impl; __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
-  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1059, __pyx_L1_error)
+  if (__pyx_t_3) {
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1058, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  } else {
+    __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1058, __pyx_L1_error)
+  }
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_state = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1060
+  /* "playhouse/_sqlite_ext.pyx":1059
  *     def inner(*items):
  *         state = hash_impl()
  *         for item in items:             # <<<<<<<<<<<<<<
  *             state.update(encode(item))
  *         return state.hexdigest()
  */
   __pyx_t_1 = __pyx_v_items; __Pyx_INCREF(__pyx_t_1); __pyx_t_4 = 0;
   for (;;) {
     if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1060, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1059, __pyx_L1_error)
     #else
-    __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1060, __pyx_L1_error)
+    __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1059, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     #endif
     __Pyx_XDECREF_SET(__pyx_v_item, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":1061
+    /* "playhouse/_sqlite_ext.pyx":1060
  *         state = hash_impl()
  *         for item in items:
  *             state.update(encode(item))             # <<<<<<<<<<<<<<
  *         return state.hexdigest()
  *     return inner
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_state, __pyx_n_s_update); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1061, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_state, __pyx_n_s_update); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1060, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_5 = __pyx_f_9playhouse_11_sqlite_ext_encode(__pyx_v_item); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1061, __pyx_L1_error)
+    __pyx_t_5 = __pyx_f_9playhouse_11_sqlite_ext_encode(__pyx_v_item); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1060, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
-    __pyx_t_2 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_6, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5);
-    __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1061, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
+    if (!__pyx_t_6) {
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1060, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_GOTREF(__pyx_t_2);
+    } else {
+      #if CYTHON_FAST_PYCALL
+      if (PyFunction_Check(__pyx_t_3)) {
+        PyObject *__pyx_temp[2] = {__pyx_t_6, __pyx_t_5};
+        __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1060, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      } else
+      #endif
+      #if CYTHON_FAST_PYCCALL
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
+        PyObject *__pyx_temp[2] = {__pyx_t_6, __pyx_t_5};
+        __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1060, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      } else
+      #endif
+      {
+        __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1060, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_7);
+        __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_6); __pyx_t_6 = NULL;
+        __Pyx_GIVEREF(__pyx_t_5);
+        PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_t_5);
+        __pyx_t_5 = 0;
+        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1060, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      }
+    }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":1060
+    /* "playhouse/_sqlite_ext.pyx":1059
  *     def inner(*items):
  *         state = hash_impl()
  *         for item in items:             # <<<<<<<<<<<<<<
  *             state.update(encode(item))
  *         return state.hexdigest()
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1062
+  /* "playhouse/_sqlite_ext.pyx":1061
  *         for item in items:
  *             state.update(encode(item))
  *         return state.hexdigest()             # <<<<<<<<<<<<<<
  *     return inner
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_state, __pyx_n_s_hexdigest); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_state, __pyx_n_s_hexdigest); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
-  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  if (__pyx_t_3) {
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1061, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  } else {
+    __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  }
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1058
+  /* "playhouse/_sqlite_ext.pyx":1057
  * 
  * def make_hash(hash_impl):
  *     def inner(*items):             # <<<<<<<<<<<<<<
  *         state = hash_impl()
  *         for item in items:
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_7);
   __Pyx_AddTraceback("playhouse._sqlite_ext.make_hash.inner", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_state);
   __Pyx_XDECREF(__pyx_v_item);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1057
+/* "playhouse/_sqlite_ext.pyx":1056
  * 
  * 
  * def make_hash(hash_impl):             # <<<<<<<<<<<<<<
  *     def inner(*items):
  *         state = hash_impl()
  */
 
@@ -10335,47 +10295,47 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   __Pyx_RefNannySetupContext("make_hash", 0);
   __pyx_cur_scope = (struct __pyx_obj_9playhouse_11_sqlite_ext___pyx_scope_struct__make_hash *)__pyx_tp_new_9playhouse_11_sqlite_ext___pyx_scope_struct__make_hash(__pyx_ptype_9playhouse_11_sqlite_ext___pyx_scope_struct__make_hash, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_9playhouse_11_sqlite_ext___pyx_scope_struct__make_hash *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 1057, __pyx_L1_error)
+    __PYX_ERR(0, 1056, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_hash_impl = __pyx_v_hash_impl;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_hash_impl);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_hash_impl);
 
-  /* "playhouse/_sqlite_ext.pyx":1058
+  /* "playhouse/_sqlite_ext.pyx":1057
  * 
  * def make_hash(hash_impl):
  *     def inner(*items):             # <<<<<<<<<<<<<<
  *         state = hash_impl()
  *         for item in items:
  */
-  __pyx_t_1 = __Pyx_CyFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_9make_hash_1inner, 0, __pyx_n_s_make_hash_locals_inner, ((PyObject*)__pyx_cur_scope), __pyx_n_s_playhouse__sqlite_ext, __pyx_d, ((PyObject *)__pyx_codeobj__7)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1058, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CyFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_9make_hash_1inner, 0, __pyx_n_s_make_hash_locals_inner, ((PyObject*)__pyx_cur_scope), __pyx_n_s_playhouse__sqlite_ext, __pyx_d, ((PyObject *)__pyx_codeobj__9)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1057, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_inner = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1063
+  /* "playhouse/_sqlite_ext.pyx":1062
  *             state.update(encode(item))
  *         return state.hexdigest()
  *     return inner             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_inner);
   __pyx_r = __pyx_v_inner;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1057
+  /* "playhouse/_sqlite_ext.pyx":1056
  * 
  * 
  * def make_hash(hash_impl):             # <<<<<<<<<<<<<<
  *     def inner(*items):
  *         state = hash_impl()
  */
 
@@ -10388,25 +10348,25 @@
   __Pyx_XDECREF(__pyx_v_inner);
   __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1071
+/* "playhouse/_sqlite_ext.pyx":1070
  * 
  * 
  * def _register_functions(database, pairs):             # <<<<<<<<<<<<<<
  *     for func, name in pairs:
  *         database.register_function(func, name)
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_13_register_functions(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_13_register_functions = {"_register_functions", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_13_register_functions, METH_VARARGS|METH_KEYWORDS, 0};
+static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_13_register_functions = {"_register_functions", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_13_register_functions, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_13_register_functions(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_database = 0;
   PyObject *__pyx_v_pairs = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("_register_functions (wrapper)", 0);
   {
@@ -10422,38 +10382,38 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_database)) != 0)) kw_args--;
+        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_database)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pairs)) != 0)) kw_args--;
+        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_pairs)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_register_functions", 1, 2, 2, 1); __PYX_ERR(0, 1071, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_register_functions", 1, 2, 2, 1); __PYX_ERR(0, 1070, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_register_functions") < 0)) __PYX_ERR(0, 1071, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_register_functions") < 0)) __PYX_ERR(0, 1070, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_database = values[0];
     __pyx_v_pairs = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_register_functions", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1071, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_register_functions", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1070, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("playhouse._sqlite_ext._register_functions", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_12_register_functions(__pyx_self, __pyx_v_database, __pyx_v_pairs);
 
@@ -10474,119 +10434,123 @@
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   PyObject *(*__pyx_t_8)(PyObject *);
   int __pyx_t_9;
   __Pyx_RefNannySetupContext("_register_functions", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1072
+  /* "playhouse/_sqlite_ext.pyx":1071
  * 
  * def _register_functions(database, pairs):
  *     for func, name in pairs:             # <<<<<<<<<<<<<<
  *         database.register_function(func, name)
  * 
  */
   if (likely(PyList_CheckExact(__pyx_v_pairs)) || PyTuple_CheckExact(__pyx_v_pairs)) {
     __pyx_t_1 = __pyx_v_pairs; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
     __pyx_t_3 = NULL;
   } else {
-    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_pairs); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1072, __pyx_L1_error)
+    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_pairs); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1071, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1072, __pyx_L1_error)
+    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1071, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_3)) {
       if (likely(PyList_CheckExact(__pyx_t_1))) {
         if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1072, __pyx_L1_error)
+        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1071, __pyx_L1_error)
         #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1072, __pyx_L1_error)
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1071, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
       } else {
         if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1072, __pyx_L1_error)
+        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1071, __pyx_L1_error)
         #else
-        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1072, __pyx_L1_error)
+        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1071, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
       }
     } else {
       __pyx_t_4 = __pyx_t_3(__pyx_t_1);
       if (unlikely(!__pyx_t_4)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 1072, __pyx_L1_error)
+          else __PYX_ERR(0, 1071, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_4);
     }
     if ((likely(PyTuple_CheckExact(__pyx_t_4))) || (PyList_CheckExact(__pyx_t_4))) {
       PyObject* sequence = __pyx_t_4;
-      Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
+      #if !CYTHON_COMPILING_IN_PYPY
+      Py_ssize_t size = Py_SIZE(sequence);
+      #else
+      Py_ssize_t size = PySequence_Size(sequence);
+      #endif
       if (unlikely(size != 2)) {
         if (size > 2) __Pyx_RaiseTooManyValuesError(2);
         else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-        __PYX_ERR(0, 1072, __pyx_L1_error)
+        __PYX_ERR(0, 1071, __pyx_L1_error)
       }
       #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
       if (likely(PyTuple_CheckExact(sequence))) {
         __pyx_t_5 = PyTuple_GET_ITEM(sequence, 0); 
         __pyx_t_6 = PyTuple_GET_ITEM(sequence, 1); 
       } else {
         __pyx_t_5 = PyList_GET_ITEM(sequence, 0); 
         __pyx_t_6 = PyList_GET_ITEM(sequence, 1); 
       }
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       #else
-      __pyx_t_5 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1072, __pyx_L1_error)
+      __pyx_t_5 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1071, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1072, __pyx_L1_error)
+      __pyx_t_6 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1071, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       #endif
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     } else {
       Py_ssize_t index = -1;
-      __pyx_t_7 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1072, __pyx_L1_error)
+      __pyx_t_7 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1071, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_8 = Py_TYPE(__pyx_t_7)->tp_iternext;
       index = 0; __pyx_t_5 = __pyx_t_8(__pyx_t_7); if (unlikely(!__pyx_t_5)) goto __pyx_L5_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_5);
       index = 1; __pyx_t_6 = __pyx_t_8(__pyx_t_7); if (unlikely(!__pyx_t_6)) goto __pyx_L5_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_6);
-      if (__Pyx_IternextUnpackEndCheck(__pyx_t_8(__pyx_t_7), 2) < 0) __PYX_ERR(0, 1072, __pyx_L1_error)
+      if (__Pyx_IternextUnpackEndCheck(__pyx_t_8(__pyx_t_7), 2) < 0) __PYX_ERR(0, 1071, __pyx_L1_error)
       __pyx_t_8 = NULL;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       goto __pyx_L6_unpacking_done;
       __pyx_L5_unpacking_failed:;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __pyx_t_8 = NULL;
       if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-      __PYX_ERR(0, 1072, __pyx_L1_error)
+      __PYX_ERR(0, 1071, __pyx_L1_error)
       __pyx_L6_unpacking_done:;
     }
     __Pyx_XDECREF_SET(__pyx_v_func, __pyx_t_5);
     __pyx_t_5 = 0;
     __Pyx_XDECREF_SET(__pyx_v_name, __pyx_t_6);
     __pyx_t_6 = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":1073
+    /* "playhouse/_sqlite_ext.pyx":1072
  * def _register_functions(database, pairs):
  *     for func, name in pairs:
  *         database.register_function(func, name)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_database, __pyx_n_s_register_function); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1073, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_database, __pyx_n_s_register_function); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1072, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_5 = NULL;
     __pyx_t_9 = 0;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
@@ -10595,57 +10559,57 @@
         __Pyx_DECREF_SET(__pyx_t_6, function);
         __pyx_t_9 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_6)) {
       PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_func, __pyx_v_name};
-      __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1073, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1072, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_GOTREF(__pyx_t_4);
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_6)) {
       PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_func, __pyx_v_name};
-      __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1073, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1072, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_GOTREF(__pyx_t_4);
     } else
     #endif
     {
-      __pyx_t_7 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1073, __pyx_L1_error)
+      __pyx_t_7 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1072, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (__pyx_t_5) {
         __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
       }
       __Pyx_INCREF(__pyx_v_func);
       __Pyx_GIVEREF(__pyx_v_func);
       PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_9, __pyx_v_func);
       __Pyx_INCREF(__pyx_v_name);
       __Pyx_GIVEREF(__pyx_v_name);
       PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_9, __pyx_v_name);
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_7, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1073, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_7, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1072, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     }
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":1072
+    /* "playhouse/_sqlite_ext.pyx":1071
  * 
  * def _register_functions(database, pairs):
  *     for func, name in pairs:             # <<<<<<<<<<<<<<
  *         database.register_function(func, name)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1071
+  /* "playhouse/_sqlite_ext.pyx":1070
  * 
  * 
  * def _register_functions(database, pairs):             # <<<<<<<<<<<<<<
  *     for func, name in pairs:
  *         database.register_function(func, name)
  */
 
@@ -10664,15 +10628,15 @@
   __Pyx_XDECREF(__pyx_v_func);
   __Pyx_XDECREF(__pyx_v_name);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1076
+/* "playhouse/_sqlite_ext.pyx":1075
  * 
  * 
  * def register_hash_functions(database):             # <<<<<<<<<<<<<<
  *     _register_functions(database, (
  *         (peewee_murmurhash, 'murmurhash'),
  */
 
@@ -10701,146 +10665,146 @@
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   PyObject *__pyx_t_9 = NULL;
   int __pyx_t_10;
   __Pyx_RefNannySetupContext("register_hash_functions", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1077
+  /* "playhouse/_sqlite_ext.pyx":1076
  * 
  * def register_hash_functions(database):
  *     _register_functions(database, (             # <<<<<<<<<<<<<<
  *         (peewee_murmurhash, 'murmurhash'),
  *         (peewee_md5, 'md5'),
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_register_functions); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1077, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_register_functions); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1076, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
 
-  /* "playhouse/_sqlite_ext.pyx":1078
+  /* "playhouse/_sqlite_ext.pyx":1077
  * def register_hash_functions(database):
  *     _register_functions(database, (
  *         (peewee_murmurhash, 'murmurhash'),             # <<<<<<<<<<<<<<
  *         (peewee_md5, 'md5'),
  *         (peewee_sha1, 'sha1'),
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_peewee_murmurhash); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1078, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_peewee_murmurhash); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1077, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1078, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1077, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __Pyx_INCREF(__pyx_n_s_murmurhash);
   __Pyx_GIVEREF(__pyx_n_s_murmurhash);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_n_s_murmurhash);
   __pyx_t_3 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1079
+  /* "playhouse/_sqlite_ext.pyx":1078
  *     _register_functions(database, (
  *         (peewee_murmurhash, 'murmurhash'),
  *         (peewee_md5, 'md5'),             # <<<<<<<<<<<<<<
  *         (peewee_sha1, 'sha1'),
  *         (peewee_sha256, 'sha256'),
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_peewee_md5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1079, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_peewee_md5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1078, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1079, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1078, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3);
   __Pyx_INCREF(__pyx_n_s_md5);
   __Pyx_GIVEREF(__pyx_n_s_md5);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_n_s_md5);
   __pyx_t_3 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1080
+  /* "playhouse/_sqlite_ext.pyx":1079
  *         (peewee_murmurhash, 'murmurhash'),
  *         (peewee_md5, 'md5'),
  *         (peewee_sha1, 'sha1'),             # <<<<<<<<<<<<<<
  *         (peewee_sha256, 'sha256'),
  *         (zlib.adler32, 'adler32'),
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_peewee_sha1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1080, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_peewee_sha1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1079, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1080, __pyx_L1_error)
+  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1079, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
   __Pyx_INCREF(__pyx_n_s_sha1);
   __Pyx_GIVEREF(__pyx_n_s_sha1);
   PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_n_s_sha1);
   __pyx_t_3 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1081
+  /* "playhouse/_sqlite_ext.pyx":1080
  *         (peewee_md5, 'md5'),
  *         (peewee_sha1, 'sha1'),
  *         (peewee_sha256, 'sha256'),             # <<<<<<<<<<<<<<
  *         (zlib.adler32, 'adler32'),
  *         (zlib.crc32, 'crc32')))
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_peewee_sha256); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1081, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_peewee_sha256); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1080, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1081, __pyx_L1_error)
+  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1080, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_3);
   __Pyx_INCREF(__pyx_n_s_sha256);
   __Pyx_GIVEREF(__pyx_n_s_sha256);
   PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_n_s_sha256);
   __pyx_t_3 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1082
+  /* "playhouse/_sqlite_ext.pyx":1081
  *         (peewee_sha1, 'sha1'),
  *         (peewee_sha256, 'sha256'),
  *         (zlib.adler32, 'adler32'),             # <<<<<<<<<<<<<<
  *         (zlib.crc32, 'crc32')))
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_zlib); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1082, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_zlib); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1081, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_adler32); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1082, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_adler32); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1081, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1082, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1081, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_8);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_8);
   __Pyx_INCREF(__pyx_n_s_adler32);
   __Pyx_GIVEREF(__pyx_n_s_adler32);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_n_s_adler32);
   __pyx_t_8 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1083
+  /* "playhouse/_sqlite_ext.pyx":1082
  *         (peewee_sha256, 'sha256'),
  *         (zlib.adler32, 'adler32'),
  *         (zlib.crc32, 'crc32')))             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_zlib); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1083, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_GetModuleGlobalName(__pyx_n_s_zlib); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1082, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_crc32); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1083, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_crc32); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1082, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1083, __pyx_L1_error)
+  __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1082, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_GIVEREF(__pyx_t_9);
   PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_9);
   __Pyx_INCREF(__pyx_n_s_crc32);
   __Pyx_GIVEREF(__pyx_n_s_crc32);
   PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_n_s_crc32);
   __pyx_t_9 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1078
+  /* "playhouse/_sqlite_ext.pyx":1077
  * def register_hash_functions(database):
  *     _register_functions(database, (
  *         (peewee_murmurhash, 'murmurhash'),             # <<<<<<<<<<<<<<
  *         (peewee_md5, 'md5'),
  *         (peewee_sha1, 'sha1'),
  */
-  __pyx_t_9 = PyTuple_New(6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1078, __pyx_L1_error)
+  __pyx_t_9 = PyTuple_New(6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1077, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_6);
   PyTuple_SET_ITEM(__pyx_t_9, 2, __pyx_t_6);
@@ -10867,49 +10831,49 @@
       __Pyx_DECREF_SET(__pyx_t_2, function);
       __pyx_t_10 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_v_database, __pyx_t_9};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1077, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1076, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_v_database, __pyx_t_9};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1077, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1076, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   } else
   #endif
   {
-    __pyx_t_3 = PyTuple_New(2+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1077, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(2+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1076, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     if (__pyx_t_8) {
       __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_8); __pyx_t_8 = NULL;
     }
     __Pyx_INCREF(__pyx_v_database);
     __Pyx_GIVEREF(__pyx_v_database);
     PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_10, __pyx_v_database);
     __Pyx_GIVEREF(__pyx_t_9);
     PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_10, __pyx_t_9);
     __pyx_t_9 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1077, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1076, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1076
+  /* "playhouse/_sqlite_ext.pyx":1075
  * 
  * 
  * def register_hash_functions(database):             # <<<<<<<<<<<<<<
  *     _register_functions(database, (
  *         (peewee_murmurhash, 'murmurhash'),
  */
 
@@ -10930,15 +10894,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1086
+/* "playhouse/_sqlite_ext.pyx":1085
  * 
  * 
  * def register_rank_functions(database):             # <<<<<<<<<<<<<<
  *     _register_functions(database, (
  *         (peewee_bm25, 'fts_bm25'),
  */
 
@@ -10965,104 +10929,104 @@
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_t_8;
   __Pyx_RefNannySetupContext("register_rank_functions", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1087
+  /* "playhouse/_sqlite_ext.pyx":1086
  * 
  * def register_rank_functions(database):
  *     _register_functions(database, (             # <<<<<<<<<<<<<<
  *         (peewee_bm25, 'fts_bm25'),
  *         (peewee_bm25f, 'fts_bm25f'),
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_register_functions); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1087, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_register_functions); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1086, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
 
-  /* "playhouse/_sqlite_ext.pyx":1088
+  /* "playhouse/_sqlite_ext.pyx":1087
  * def register_rank_functions(database):
  *     _register_functions(database, (
  *         (peewee_bm25, 'fts_bm25'),             # <<<<<<<<<<<<<<
  *         (peewee_bm25f, 'fts_bm25f'),
  *         (peewee_lucene, 'fts_lucene'),
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_peewee_bm25); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1088, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_peewee_bm25); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1087, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1088, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1087, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __Pyx_INCREF(__pyx_n_s_fts_bm25);
   __Pyx_GIVEREF(__pyx_n_s_fts_bm25);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_n_s_fts_bm25);
   __pyx_t_3 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1089
+  /* "playhouse/_sqlite_ext.pyx":1088
  *     _register_functions(database, (
  *         (peewee_bm25, 'fts_bm25'),
  *         (peewee_bm25f, 'fts_bm25f'),             # <<<<<<<<<<<<<<
  *         (peewee_lucene, 'fts_lucene'),
  *         (peewee_rank, 'fts_rank')))
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_peewee_bm25f); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1089, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_peewee_bm25f); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1088, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1089, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1088, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3);
   __Pyx_INCREF(__pyx_n_s_fts_bm25f);
   __Pyx_GIVEREF(__pyx_n_s_fts_bm25f);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_n_s_fts_bm25f);
   __pyx_t_3 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1090
+  /* "playhouse/_sqlite_ext.pyx":1089
  *         (peewee_bm25, 'fts_bm25'),
  *         (peewee_bm25f, 'fts_bm25f'),
  *         (peewee_lucene, 'fts_lucene'),             # <<<<<<<<<<<<<<
  *         (peewee_rank, 'fts_rank')))
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_peewee_lucene); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1090, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_peewee_lucene); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1089, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1090, __pyx_L1_error)
+  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1089, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
   __Pyx_INCREF(__pyx_n_s_fts_lucene);
   __Pyx_GIVEREF(__pyx_n_s_fts_lucene);
   PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_n_s_fts_lucene);
   __pyx_t_3 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1091
+  /* "playhouse/_sqlite_ext.pyx":1090
  *         (peewee_bm25f, 'fts_bm25f'),
  *         (peewee_lucene, 'fts_lucene'),
  *         (peewee_rank, 'fts_rank')))             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_peewee_rank); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1091, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_peewee_rank); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1090, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1091, __pyx_L1_error)
+  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1090, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_3);
   __Pyx_INCREF(__pyx_n_s_fts_rank);
   __Pyx_GIVEREF(__pyx_n_s_fts_rank);
   PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_n_s_fts_rank);
   __pyx_t_3 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1088
+  /* "playhouse/_sqlite_ext.pyx":1087
  * def register_rank_functions(database):
  *     _register_functions(database, (
  *         (peewee_bm25, 'fts_bm25'),             # <<<<<<<<<<<<<<
  *         (peewee_bm25f, 'fts_bm25f'),
  *         (peewee_lucene, 'fts_lucene'),
  */
-  __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1088, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1087, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_6);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_6);
@@ -11083,49 +11047,49 @@
       __Pyx_DECREF_SET(__pyx_t_2, function);
       __pyx_t_8 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_v_database, __pyx_t_3};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1087, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1086, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_v_database, __pyx_t_3};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1087, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1086, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   } else
   #endif
   {
-    __pyx_t_6 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1087, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1086, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     if (__pyx_t_7) {
       __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_7); __pyx_t_7 = NULL;
     }
     __Pyx_INCREF(__pyx_v_database);
     __Pyx_GIVEREF(__pyx_v_database);
     PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_8, __pyx_v_database);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_8, __pyx_t_3);
     __pyx_t_3 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1087, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1086, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1086
+  /* "playhouse/_sqlite_ext.pyx":1085
  * 
  * 
  * def register_rank_functions(database):             # <<<<<<<<<<<<<<
  *     _register_functions(database, (
  *         (peewee_bm25, 'fts_bm25'),
  */
 
@@ -11144,127 +11108,127 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1102
+/* "playhouse/_sqlite_ext.pyx":1101
  * 
  * 
  * cdef bf_t *bf_create(size_t size):             # <<<<<<<<<<<<<<
- *     cdef bf_t *bf = <bf_t *>calloc(1, sizeof(bf[0]))
+ *     cdef bf_t *bf = <bf_t *>calloc(1, sizeof(bf_t))
  *     bf.size = size
  */
 
 static __pyx_t_9playhouse_11_sqlite_ext_bf_t *__pyx_f_9playhouse_11_sqlite_ext_bf_create(size_t __pyx_v_size) {
   __pyx_t_9playhouse_11_sqlite_ext_bf_t *__pyx_v_bf;
   __pyx_t_9playhouse_11_sqlite_ext_bf_t *__pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("bf_create", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1103
+  /* "playhouse/_sqlite_ext.pyx":1102
  * 
  * cdef bf_t *bf_create(size_t size):
- *     cdef bf_t *bf = <bf_t *>calloc(1, sizeof(bf[0]))             # <<<<<<<<<<<<<<
+ *     cdef bf_t *bf = <bf_t *>calloc(1, sizeof(bf_t))             # <<<<<<<<<<<<<<
  *     bf.size = size
  *     bf.bits = malloc(size)
  */
-  __pyx_v_bf = ((__pyx_t_9playhouse_11_sqlite_ext_bf_t *)calloc(1, (sizeof((__pyx_v_bf[0])))));
+  __pyx_v_bf = ((__pyx_t_9playhouse_11_sqlite_ext_bf_t *)calloc(1, (sizeof(__pyx_t_9playhouse_11_sqlite_ext_bf_t))));
 
-  /* "playhouse/_sqlite_ext.pyx":1104
+  /* "playhouse/_sqlite_ext.pyx":1103
  * cdef bf_t *bf_create(size_t size):
- *     cdef bf_t *bf = <bf_t *>calloc(1, sizeof(bf[0]))
+ *     cdef bf_t *bf = <bf_t *>calloc(1, sizeof(bf_t))
  *     bf.size = size             # <<<<<<<<<<<<<<
  *     bf.bits = malloc(size)
  *     return bf
  */
   __pyx_v_bf->size = __pyx_v_size;
 
-  /* "playhouse/_sqlite_ext.pyx":1105
- *     cdef bf_t *bf = <bf_t *>calloc(1, sizeof(bf[0]))
+  /* "playhouse/_sqlite_ext.pyx":1104
+ *     cdef bf_t *bf = <bf_t *>calloc(1, sizeof(bf_t))
  *     bf.size = size
  *     bf.bits = malloc(size)             # <<<<<<<<<<<<<<
  *     return bf
  * 
  */
   __pyx_v_bf->bits = malloc(__pyx_v_size);
 
-  /* "playhouse/_sqlite_ext.pyx":1106
+  /* "playhouse/_sqlite_ext.pyx":1105
  *     bf.size = size
  *     bf.bits = malloc(size)
  *     return bf             # <<<<<<<<<<<<<<
  * 
  * @cython.cdivision(True)
  */
   __pyx_r = __pyx_v_bf;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1102
+  /* "playhouse/_sqlite_ext.pyx":1101
  * 
  * 
  * cdef bf_t *bf_create(size_t size):             # <<<<<<<<<<<<<<
- *     cdef bf_t *bf = <bf_t *>calloc(1, sizeof(bf[0]))
+ *     cdef bf_t *bf = <bf_t *>calloc(1, sizeof(bf_t))
  *     bf.size = size
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1109
+/* "playhouse/_sqlite_ext.pyx":1108
  * 
  * @cython.cdivision(True)
  * cdef uint32_t bf_bitindex(bf_t *bf, unsigned char *key, size_t klen, int seed):             # <<<<<<<<<<<<<<
  *     cdef:
  *         uint32_t h = murmurhash2(key, klen, seed)
  */
 
 static uint32_t __pyx_f_9playhouse_11_sqlite_ext_bf_bitindex(__pyx_t_9playhouse_11_sqlite_ext_bf_t *__pyx_v_bf, unsigned char *__pyx_v_key, size_t __pyx_v_klen, int __pyx_v_seed) {
   uint32_t __pyx_v_h;
   uint32_t __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("bf_bitindex", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1111
+  /* "playhouse/_sqlite_ext.pyx":1110
  * cdef uint32_t bf_bitindex(bf_t *bf, unsigned char *key, size_t klen, int seed):
  *     cdef:
  *         uint32_t h = murmurhash2(key, klen, seed)             # <<<<<<<<<<<<<<
  *     return h % (bf.size * 8)
  * 
  */
   __pyx_v_h = __pyx_f_9playhouse_11_sqlite_ext_murmurhash2(__pyx_v_key, __pyx_v_klen, __pyx_v_seed);
 
-  /* "playhouse/_sqlite_ext.pyx":1112
+  /* "playhouse/_sqlite_ext.pyx":1111
  *     cdef:
  *         uint32_t h = murmurhash2(key, klen, seed)
  *     return h % (bf.size * 8)             # <<<<<<<<<<<<<<
  * 
  * @cython.cdivision(True)
  */
   __pyx_r = (__pyx_v_h % (__pyx_v_bf->size * 8));
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1109
+  /* "playhouse/_sqlite_ext.pyx":1108
  * 
  * @cython.cdivision(True)
  * cdef uint32_t bf_bitindex(bf_t *bf, unsigned char *key, size_t klen, int seed):             # <<<<<<<<<<<<<<
  *     cdef:
  *         uint32_t h = murmurhash2(key, klen, seed)
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1115
+/* "playhouse/_sqlite_ext.pyx":1114
  * 
  * @cython.cdivision(True)
  * cdef bf_add(bf_t *bf, unsigned char *key):             # <<<<<<<<<<<<<<
  *     cdef:
  *         uint8_t *bits = <uint8_t *>(bf.bits)
  */
 
@@ -11277,88 +11241,88 @@
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int *__pyx_t_1;
   int *__pyx_t_2;
   int *__pyx_t_3;
   __Pyx_RefNannySetupContext("bf_add", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1117
+  /* "playhouse/_sqlite_ext.pyx":1116
  * cdef bf_add(bf_t *bf, unsigned char *key):
  *     cdef:
  *         uint8_t *bits = <uint8_t *>(bf.bits)             # <<<<<<<<<<<<<<
  *         uint32_t h
  *         int pos, seed
  */
   __pyx_v_bits = ((uint8_t *)__pyx_v_bf->bits);
 
-  /* "playhouse/_sqlite_ext.pyx":1120
+  /* "playhouse/_sqlite_ext.pyx":1119
  *         uint32_t h
  *         int pos, seed
  *         size_t keylen = strlen(<const char *>key)             # <<<<<<<<<<<<<<
  * 
  *     for seed in seeds:
  */
   __pyx_v_keylen = strlen(((char const *)__pyx_v_key));
 
-  /* "playhouse/_sqlite_ext.pyx":1122
+  /* "playhouse/_sqlite_ext.pyx":1121
  *         size_t keylen = strlen(<const char *>key)
  * 
  *     for seed in seeds:             # <<<<<<<<<<<<<<
  *         h = bf_bitindex(bf, key, keylen, seed)
  *         pos = h / 8
  */
   __pyx_t_2 = (__pyx_v_9playhouse_11_sqlite_ext_seeds + 10);
   for (__pyx_t_3 = __pyx_v_9playhouse_11_sqlite_ext_seeds; __pyx_t_3 < __pyx_t_2; __pyx_t_3++) {
     __pyx_t_1 = __pyx_t_3;
     __pyx_v_seed = (__pyx_t_1[0]);
 
-    /* "playhouse/_sqlite_ext.pyx":1123
+    /* "playhouse/_sqlite_ext.pyx":1122
  * 
  *     for seed in seeds:
  *         h = bf_bitindex(bf, key, keylen, seed)             # <<<<<<<<<<<<<<
  *         pos = h / 8
  *         bits[pos] = bits[pos] | (1 << (h % 8))
  */
     __pyx_v_h = __pyx_f_9playhouse_11_sqlite_ext_bf_bitindex(__pyx_v_bf, __pyx_v_key, __pyx_v_keylen, __pyx_v_seed);
 
-    /* "playhouse/_sqlite_ext.pyx":1124
+    /* "playhouse/_sqlite_ext.pyx":1123
  *     for seed in seeds:
  *         h = bf_bitindex(bf, key, keylen, seed)
  *         pos = h / 8             # <<<<<<<<<<<<<<
  *         bits[pos] = bits[pos] | (1 << (h % 8))
  * 
  */
     __pyx_v_pos = (__pyx_v_h / 8);
 
-    /* "playhouse/_sqlite_ext.pyx":1125
+    /* "playhouse/_sqlite_ext.pyx":1124
  *         h = bf_bitindex(bf, key, keylen, seed)
  *         pos = h / 8
  *         bits[pos] = bits[pos] | (1 << (h % 8))             # <<<<<<<<<<<<<<
  * 
  * @cython.cdivision(True)
  */
     (__pyx_v_bits[__pyx_v_pos]) = ((__pyx_v_bits[__pyx_v_pos]) | (1 << (__pyx_v_h % 8)));
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1115
+  /* "playhouse/_sqlite_ext.pyx":1114
  * 
  * @cython.cdivision(True)
  * cdef bf_add(bf_t *bf, unsigned char *key):             # <<<<<<<<<<<<<<
  *     cdef:
  *         uint8_t *bits = <uint8_t *>(bf.bits)
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1128
+/* "playhouse/_sqlite_ext.pyx":1127
  * 
  * @cython.cdivision(True)
  * cdef int bf_contains(bf_t *bf, unsigned char *key):             # <<<<<<<<<<<<<<
  *     cdef:
  *         uint8_t *bits = <uint8_t *>(bf.bits)
  */
 
@@ -11372,163 +11336,163 @@
   __Pyx_RefNannyDeclarations
   int *__pyx_t_1;
   int *__pyx_t_2;
   int *__pyx_t_3;
   int __pyx_t_4;
   __Pyx_RefNannySetupContext("bf_contains", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1130
+  /* "playhouse/_sqlite_ext.pyx":1129
  * cdef int bf_contains(bf_t *bf, unsigned char *key):
  *     cdef:
  *         uint8_t *bits = <uint8_t *>(bf.bits)             # <<<<<<<<<<<<<<
  *         uint32_t h
  *         int pos, seed
  */
   __pyx_v_bits = ((uint8_t *)__pyx_v_bf->bits);
 
-  /* "playhouse/_sqlite_ext.pyx":1133
+  /* "playhouse/_sqlite_ext.pyx":1132
  *         uint32_t h
  *         int pos, seed
  *         size_t keylen = strlen(<const char *>key)             # <<<<<<<<<<<<<<
  * 
  *     for seed in seeds:
  */
   __pyx_v_keylen = strlen(((char const *)__pyx_v_key));
 
-  /* "playhouse/_sqlite_ext.pyx":1135
+  /* "playhouse/_sqlite_ext.pyx":1134
  *         size_t keylen = strlen(<const char *>key)
  * 
  *     for seed in seeds:             # <<<<<<<<<<<<<<
  *         h = bf_bitindex(bf, key, keylen, seed)
  *         pos = h / 8
  */
   __pyx_t_2 = (__pyx_v_9playhouse_11_sqlite_ext_seeds + 10);
   for (__pyx_t_3 = __pyx_v_9playhouse_11_sqlite_ext_seeds; __pyx_t_3 < __pyx_t_2; __pyx_t_3++) {
     __pyx_t_1 = __pyx_t_3;
     __pyx_v_seed = (__pyx_t_1[0]);
 
-    /* "playhouse/_sqlite_ext.pyx":1136
+    /* "playhouse/_sqlite_ext.pyx":1135
  * 
  *     for seed in seeds:
  *         h = bf_bitindex(bf, key, keylen, seed)             # <<<<<<<<<<<<<<
  *         pos = h / 8
  *         if not (bits[pos] & (1 << (h % 8))):
  */
     __pyx_v_h = __pyx_f_9playhouse_11_sqlite_ext_bf_bitindex(__pyx_v_bf, __pyx_v_key, __pyx_v_keylen, __pyx_v_seed);
 
-    /* "playhouse/_sqlite_ext.pyx":1137
+    /* "playhouse/_sqlite_ext.pyx":1136
  *     for seed in seeds:
  *         h = bf_bitindex(bf, key, keylen, seed)
  *         pos = h / 8             # <<<<<<<<<<<<<<
  *         if not (bits[pos] & (1 << (h % 8))):
  *             return 0
  */
     __pyx_v_pos = (__pyx_v_h / 8);
 
-    /* "playhouse/_sqlite_ext.pyx":1138
+    /* "playhouse/_sqlite_ext.pyx":1137
  *         h = bf_bitindex(bf, key, keylen, seed)
  *         pos = h / 8
  *         if not (bits[pos] & (1 << (h % 8))):             # <<<<<<<<<<<<<<
  *             return 0
  *     return 1
  */
     __pyx_t_4 = ((!(((__pyx_v_bits[__pyx_v_pos]) & (1 << (__pyx_v_h % 8))) != 0)) != 0);
     if (__pyx_t_4) {
 
-      /* "playhouse/_sqlite_ext.pyx":1139
+      /* "playhouse/_sqlite_ext.pyx":1138
  *         pos = h / 8
  *         if not (bits[pos] & (1 << (h % 8))):
  *             return 0             # <<<<<<<<<<<<<<
  *     return 1
  * 
  */
       __pyx_r = 0;
       goto __pyx_L0;
 
-      /* "playhouse/_sqlite_ext.pyx":1138
+      /* "playhouse/_sqlite_ext.pyx":1137
  *         h = bf_bitindex(bf, key, keylen, seed)
  *         pos = h / 8
  *         if not (bits[pos] & (1 << (h % 8))):             # <<<<<<<<<<<<<<
  *             return 0
  *     return 1
  */
     }
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1140
+  /* "playhouse/_sqlite_ext.pyx":1139
  *         if not (bits[pos] & (1 << (h % 8))):
  *             return 0
  *     return 1             # <<<<<<<<<<<<<<
  * 
  * cdef bf_free(bf_t *bf):
  */
   __pyx_r = 1;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1128
+  /* "playhouse/_sqlite_ext.pyx":1127
  * 
  * @cython.cdivision(True)
  * cdef int bf_contains(bf_t *bf, unsigned char *key):             # <<<<<<<<<<<<<<
  *     cdef:
  *         uint8_t *bits = <uint8_t *>(bf.bits)
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1142
+/* "playhouse/_sqlite_ext.pyx":1141
  *     return 1
  * 
  * cdef bf_free(bf_t *bf):             # <<<<<<<<<<<<<<
  *     free(bf.bits)
  *     free(bf)
  */
 
 static PyObject *__pyx_f_9playhouse_11_sqlite_ext_bf_free(__pyx_t_9playhouse_11_sqlite_ext_bf_t *__pyx_v_bf) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("bf_free", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1143
+  /* "playhouse/_sqlite_ext.pyx":1142
  * 
  * cdef bf_free(bf_t *bf):
  *     free(bf.bits)             # <<<<<<<<<<<<<<
  *     free(bf)
  * 
  */
   free(__pyx_v_bf->bits);
 
-  /* "playhouse/_sqlite_ext.pyx":1144
+  /* "playhouse/_sqlite_ext.pyx":1143
  * cdef bf_free(bf_t *bf):
  *     free(bf.bits)
  *     free(bf)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   free(__pyx_v_bf);
 
-  /* "playhouse/_sqlite_ext.pyx":1142
+  /* "playhouse/_sqlite_ext.pyx":1141
  *     return 1
  * 
  * cdef bf_free(bf_t *bf):             # <<<<<<<<<<<<<<
  *     free(bf.bits)
  *     free(bf)
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1151
+/* "playhouse/_sqlite_ext.pyx":1150
  *         bf_t *bf
  * 
  *     def __init__(self, size=1024 * 32):             # <<<<<<<<<<<<<<
  *         self.bf = bf_create(<size_t>size)
  * 
  */
 
@@ -11552,34 +11516,34 @@
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_size);
+          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_size);
           if (value) { values[0] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 1151, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 1150, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_size = values[0];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1151, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1150, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("playhouse._sqlite_ext.BloomFilter.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_11BloomFilter___init__(((struct __pyx_obj_9playhouse_11_sqlite_ext_BloomFilter *)__pyx_v_self), __pyx_v_size);
 
@@ -11590,25 +11554,25 @@
 
 static int __pyx_pf_9playhouse_11_sqlite_ext_11BloomFilter___init__(struct __pyx_obj_9playhouse_11_sqlite_ext_BloomFilter *__pyx_v_self, PyObject *__pyx_v_size) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   size_t __pyx_t_1;
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1152
+  /* "playhouse/_sqlite_ext.pyx":1151
  * 
  *     def __init__(self, size=1024 * 32):
  *         self.bf = bf_create(<size_t>size)             # <<<<<<<<<<<<<<
  * 
  *     def __dealloc__(self):
  */
-  __pyx_t_1 = __Pyx_PyInt_As_size_t(__pyx_v_size); if (unlikely((__pyx_t_1 == (size_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 1152, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_As_size_t(__pyx_v_size); if (unlikely((__pyx_t_1 == (size_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 1151, __pyx_L1_error)
   __pyx_v_self->bf = __pyx_f_9playhouse_11_sqlite_ext_bf_create(((size_t)__pyx_t_1));
 
-  /* "playhouse/_sqlite_ext.pyx":1151
+  /* "playhouse/_sqlite_ext.pyx":1150
  *         bf_t *bf
  * 
  *     def __init__(self, size=1024 * 32):             # <<<<<<<<<<<<<<
  *         self.bf = bf_create(<size_t>size)
  * 
  */
 
@@ -11619,15 +11583,15 @@
   __Pyx_AddTraceback("playhouse._sqlite_ext.BloomFilter.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1154
+/* "playhouse/_sqlite_ext.pyx":1153
  *         self.bf = bf_create(<size_t>size)
  * 
  *     def __dealloc__(self):             # <<<<<<<<<<<<<<
  *         if self.bf:
  *             bf_free(self.bf)
  */
 
@@ -11644,45 +11608,45 @@
 
 static void __pyx_pf_9playhouse_11_sqlite_ext_11BloomFilter_2__dealloc__(struct __pyx_obj_9playhouse_11_sqlite_ext_BloomFilter *__pyx_v_self) {
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   __Pyx_RefNannySetupContext("__dealloc__", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1155
+  /* "playhouse/_sqlite_ext.pyx":1154
  * 
  *     def __dealloc__(self):
  *         if self.bf:             # <<<<<<<<<<<<<<
  *             bf_free(self.bf)
  * 
  */
   __pyx_t_1 = (__pyx_v_self->bf != 0);
   if (__pyx_t_1) {
 
-    /* "playhouse/_sqlite_ext.pyx":1156
+    /* "playhouse/_sqlite_ext.pyx":1155
  *     def __dealloc__(self):
  *         if self.bf:
  *             bf_free(self.bf)             # <<<<<<<<<<<<<<
  * 
  *     def add(self, *keys):
  */
-    __pyx_t_2 = __pyx_f_9playhouse_11_sqlite_ext_bf_free(__pyx_v_self->bf); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1156, __pyx_L1_error)
+    __pyx_t_2 = __pyx_f_9playhouse_11_sqlite_ext_bf_free(__pyx_v_self->bf); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1155, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":1155
+    /* "playhouse/_sqlite_ext.pyx":1154
  * 
  *     def __dealloc__(self):
  *         if self.bf:             # <<<<<<<<<<<<<<
  *             bf_free(self.bf)
  * 
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1154
+  /* "playhouse/_sqlite_ext.pyx":1153
  *         self.bf = bf_create(<size_t>size)
  * 
  *     def __dealloc__(self):             # <<<<<<<<<<<<<<
  *         if self.bf:
  *             bf_free(self.bf)
  */
 
@@ -11691,15 +11655,15 @@
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_WriteUnraisable("playhouse._sqlite_ext.BloomFilter.__dealloc__", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
 }
 
-/* "playhouse/_sqlite_ext.pyx":1158
+/* "playhouse/_sqlite_ext.pyx":1157
  *             bf_free(self.bf)
  * 
  *     def add(self, *keys):             # <<<<<<<<<<<<<<
  *         cdef bytes bkey
  * 
  */
 
@@ -11728,72 +11692,72 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   Py_ssize_t __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   unsigned char *__pyx_t_4;
   __Pyx_RefNannySetupContext("add", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1161
+  /* "playhouse/_sqlite_ext.pyx":1160
  *         cdef bytes bkey
  * 
  *         for key in keys:             # <<<<<<<<<<<<<<
  *             bkey = encode(key)
  *             bf_add(self.bf, <unsigned char *>bkey)
  */
   __pyx_t_1 = __pyx_v_keys; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1161, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1160, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1161, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1160, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
     __Pyx_XDECREF_SET(__pyx_v_key, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":1162
+    /* "playhouse/_sqlite_ext.pyx":1161
  * 
  *         for key in keys:
  *             bkey = encode(key)             # <<<<<<<<<<<<<<
  *             bf_add(self.bf, <unsigned char *>bkey)
  * 
  */
-    __pyx_t_3 = __pyx_f_9playhouse_11_sqlite_ext_encode(__pyx_v_key); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1162, __pyx_L1_error)
+    __pyx_t_3 = __pyx_f_9playhouse_11_sqlite_ext_encode(__pyx_v_key); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1161, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_XDECREF_SET(__pyx_v_bkey, ((PyObject*)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":1163
+    /* "playhouse/_sqlite_ext.pyx":1162
  *         for key in keys:
  *             bkey = encode(key)
  *             bf_add(self.bf, <unsigned char *>bkey)             # <<<<<<<<<<<<<<
  * 
  *     def __contains__(self, key):
  */
     if (unlikely(__pyx_v_bkey == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "expected bytes, NoneType found");
-      __PYX_ERR(0, 1163, __pyx_L1_error)
+      __PYX_ERR(0, 1162, __pyx_L1_error)
     }
-    __pyx_t_4 = __Pyx_PyBytes_AsWritableUString(__pyx_v_bkey); if (unlikely((!__pyx_t_4) && PyErr_Occurred())) __PYX_ERR(0, 1163, __pyx_L1_error)
-    __pyx_t_3 = __pyx_f_9playhouse_11_sqlite_ext_bf_add(__pyx_v_self->bf, ((unsigned char *)__pyx_t_4)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1163, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyBytes_AsWritableUString(__pyx_v_bkey); if (unlikely((!__pyx_t_4) && PyErr_Occurred())) __PYX_ERR(0, 1162, __pyx_L1_error)
+    __pyx_t_3 = __pyx_f_9playhouse_11_sqlite_ext_bf_add(__pyx_v_self->bf, ((unsigned char *)__pyx_t_4)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1162, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":1161
+    /* "playhouse/_sqlite_ext.pyx":1160
  *         cdef bytes bkey
  * 
  *         for key in keys:             # <<<<<<<<<<<<<<
  *             bkey = encode(key)
  *             bf_add(self.bf, <unsigned char *>bkey)
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1158
+  /* "playhouse/_sqlite_ext.pyx":1157
  *             bf_free(self.bf)
  * 
  *     def add(self, *keys):             # <<<<<<<<<<<<<<
  *         cdef bytes bkey
  * 
  */
 
@@ -11809,15 +11773,15 @@
   __Pyx_XDECREF(__pyx_v_bkey);
   __Pyx_XDECREF(__pyx_v_key);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1165
+/* "playhouse/_sqlite_ext.pyx":1164
  *             bf_add(self.bf, <unsigned char *>bkey)
  * 
  *     def __contains__(self, key):             # <<<<<<<<<<<<<<
  *         cdef bytes bkey = encode(key)
  *         return bf_contains(self.bf, <unsigned char *>bkey)
  */
 
@@ -11838,42 +11802,42 @@
   PyObject *__pyx_v_bkey = 0;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   unsigned char *__pyx_t_2;
   __Pyx_RefNannySetupContext("__contains__", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1166
+  /* "playhouse/_sqlite_ext.pyx":1165
  * 
  *     def __contains__(self, key):
  *         cdef bytes bkey = encode(key)             # <<<<<<<<<<<<<<
  *         return bf_contains(self.bf, <unsigned char *>bkey)
  * 
  */
-  __pyx_t_1 = __pyx_f_9playhouse_11_sqlite_ext_encode(__pyx_v_key); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1166, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_9playhouse_11_sqlite_ext_encode(__pyx_v_key); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1165, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_bkey = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1167
+  /* "playhouse/_sqlite_ext.pyx":1166
  *     def __contains__(self, key):
  *         cdef bytes bkey = encode(key)
  *         return bf_contains(self.bf, <unsigned char *>bkey)             # <<<<<<<<<<<<<<
  * 
  *     def to_buffer(self):
  */
   if (unlikely(__pyx_v_bkey == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "expected bytes, NoneType found");
-    __PYX_ERR(0, 1167, __pyx_L1_error)
+    __PYX_ERR(0, 1166, __pyx_L1_error)
   }
-  __pyx_t_2 = __Pyx_PyBytes_AsWritableUString(__pyx_v_bkey); if (unlikely((!__pyx_t_2) && PyErr_Occurred())) __PYX_ERR(0, 1167, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyBytes_AsWritableUString(__pyx_v_bkey); if (unlikely((!__pyx_t_2) && PyErr_Occurred())) __PYX_ERR(0, 1166, __pyx_L1_error)
   __pyx_r = __pyx_f_9playhouse_11_sqlite_ext_bf_contains(__pyx_v_self->bf, ((unsigned char *)__pyx_t_2));
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1165
+  /* "playhouse/_sqlite_ext.pyx":1164
  *             bf_add(self.bf, <unsigned char *>bkey)
  * 
  *     def __contains__(self, key):             # <<<<<<<<<<<<<<
  *         cdef bytes bkey = encode(key)
  *         return bf_contains(self.bf, <unsigned char *>bkey)
  */
 
@@ -11884,15 +11848,15 @@
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_bkey);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1169
+/* "playhouse/_sqlite_ext.pyx":1168
  *         return bf_contains(self.bf, <unsigned char *>bkey)
  * 
  *     def to_buffer(self):             # <<<<<<<<<<<<<<
  *         # We have to do this so that embedded NULL bytes are preserved.
  *         cdef bytes buf = PyBytes_FromStringAndSize(<char *>(self.bf.bits),
  */
 
@@ -11912,39 +11876,39 @@
 static PyObject *__pyx_pf_9playhouse_11_sqlite_ext_11BloomFilter_8to_buffer(struct __pyx_obj_9playhouse_11_sqlite_ext_BloomFilter *__pyx_v_self) {
   PyObject *__pyx_v_buf = 0;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   __Pyx_RefNannySetupContext("to_buffer", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1171
+  /* "playhouse/_sqlite_ext.pyx":1170
  *     def to_buffer(self):
  *         # We have to do this so that embedded NULL bytes are preserved.
  *         cdef bytes buf = PyBytes_FromStringAndSize(<char *>(self.bf.bits),             # <<<<<<<<<<<<<<
  *                                                    self.bf.size)
  *         # Similarly we wrap in a buffer object so pysqlite preserves the
  */
-  __pyx_t_1 = PyBytes_FromStringAndSize(((char *)__pyx_v_self->bf->bits), __pyx_v_self->bf->size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1171, __pyx_L1_error)
+  __pyx_t_1 = PyBytes_FromStringAndSize(((char *)__pyx_v_self->bf->bits), __pyx_v_self->bf->size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1170, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_buf = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1175
+  /* "playhouse/_sqlite_ext.pyx":1174
  *         # Similarly we wrap in a buffer object so pysqlite preserves the
  *         # embedded NULL bytes.
  *         return buf             # <<<<<<<<<<<<<<
  * 
  *     @classmethod
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_buf);
   __pyx_r = __pyx_v_buf;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1169
+  /* "playhouse/_sqlite_ext.pyx":1168
  *         return bf_contains(self.bf, <unsigned char *>bkey)
  * 
  *     def to_buffer(self):             # <<<<<<<<<<<<<<
  *         # We have to do this so that embedded NULL bytes are preserved.
  *         cdef bytes buf = PyBytes_FromStringAndSize(<char *>(self.bf.bits),
  */
 
@@ -11956,15 +11920,15 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_buf);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1178
+/* "playhouse/_sqlite_ext.pyx":1177
  * 
  *     @classmethod
  *     def calculate_size(cls, double n, double p):             # <<<<<<<<<<<<<<
  *         cdef double m = ceil((n * log(p)) / log(1.0 / (pow(2.0, log(2.0)))))
  *         return m
  */
 
@@ -11989,38 +11953,38 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_n)) != 0)) kw_args--;
+        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_n)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
+        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("calculate_size", 1, 2, 2, 1); __PYX_ERR(0, 1178, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calculate_size", 1, 2, 2, 1); __PYX_ERR(0, 1177, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calculate_size") < 0)) __PYX_ERR(0, 1178, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calculate_size") < 0)) __PYX_ERR(0, 1177, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
-    __pyx_v_n = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_n == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1178, __pyx_L3_error)
-    __pyx_v_p = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_p == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1178, __pyx_L3_error)
+    __pyx_v_n = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_n == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1177, __pyx_L3_error)
+    __pyx_v_p = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_p == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1177, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("calculate_size", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1178, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("calculate_size", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1177, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("playhouse._sqlite_ext.BloomFilter.calculate_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_11BloomFilter_10calculate_size(((PyTypeObject*)__pyx_v_cls), __pyx_v_n, __pyx_v_p);
 
@@ -12036,54 +12000,54 @@
   double __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   double __pyx_t_4;
   double __pyx_t_5;
   __Pyx_RefNannySetupContext("calculate_size", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1179
+  /* "playhouse/_sqlite_ext.pyx":1178
  *     @classmethod
  *     def calculate_size(cls, double n, double p):
  *         cdef double m = ceil((n * log(p)) / log(1.0 / (pow(2.0, log(2.0)))))             # <<<<<<<<<<<<<<
  *         return m
  * 
  */
   __pyx_t_1 = (__pyx_v_n * log(__pyx_v_p));
-  __pyx_t_2 = PyFloat_FromDouble(log(2.0)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1179, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(log(2.0)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1178, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyNumber_Power2(__pyx_float_2_0, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1179, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyNumber_Power2(__pyx_float_2_0, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1178, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyFloat_DivideCObj(__pyx_float_1_0, __pyx_t_3, 1.0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1179, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyFloat_DivideCObj(__pyx_float_1_0, __pyx_t_3, 1.0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1178, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1179, __pyx_L1_error)
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1178, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_5 = log(__pyx_t_4);
   if (unlikely(__pyx_t_5 == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 1179, __pyx_L1_error)
+    __PYX_ERR(0, 1178, __pyx_L1_error)
   }
   __pyx_v_m = ceil((__pyx_t_1 / __pyx_t_5));
 
-  /* "playhouse/_sqlite_ext.pyx":1180
+  /* "playhouse/_sqlite_ext.pyx":1179
  *     def calculate_size(cls, double n, double p):
  *         cdef double m = ceil((n * log(p)) / log(1.0 / (pow(2.0, log(2.0)))))
  *         return m             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_m); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1180, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_m); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1179, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1178
+  /* "playhouse/_sqlite_ext.pyx":1177
  * 
  *     @classmethod
  *     def calculate_size(cls, double n, double p):             # <<<<<<<<<<<<<<
  *         cdef double m = ceil((n * log(p)) / log(1.0 / (pow(2.0, log(2.0)))))
  *         return m
  */
 
@@ -12126,15 +12090,15 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("self.bf cannot be converted to a Python object for pickling")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("self.bf cannot be converted to a Python object for pickling")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__8, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(1, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
@@ -12179,15 +12143,15 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("self.bf cannot be converted to a Python object for pickling")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("self.bf cannot be converted to a Python object for pickling")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__11, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(1, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
@@ -12202,15 +12166,15 @@
   __Pyx_AddTraceback("playhouse._sqlite_ext.BloomFilter.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1187
+/* "playhouse/_sqlite_ext.pyx":1186
  *         BloomFilter bf
  * 
  *     def __init__(self):             # <<<<<<<<<<<<<<
  *         self.bf = None
  * 
  */
 
@@ -12231,42 +12195,42 @@
 }
 
 static int __pyx_pf_9playhouse_11_sqlite_ext_20BloomFilterAggregate___init__(struct __pyx_obj_9playhouse_11_sqlite_ext_BloomFilterAggregate *__pyx_v_self) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1188
+  /* "playhouse/_sqlite_ext.pyx":1187
  * 
  *     def __init__(self):
  *         self.bf = None             # <<<<<<<<<<<<<<
  * 
  *     def step(self, value, size=None):
  */
   __Pyx_INCREF(Py_None);
   __Pyx_GIVEREF(Py_None);
   __Pyx_GOTREF(__pyx_v_self->bf);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->bf));
   __pyx_v_self->bf = ((struct __pyx_obj_9playhouse_11_sqlite_ext_BloomFilter *)Py_None);
 
-  /* "playhouse/_sqlite_ext.pyx":1187
+  /* "playhouse/_sqlite_ext.pyx":1186
  *         BloomFilter bf
  * 
  *     def __init__(self):             # <<<<<<<<<<<<<<
  *         self.bf = None
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1190
+/* "playhouse/_sqlite_ext.pyx":1189
  *         self.bf = None
  * 
  *     def step(self, value, size=None):             # <<<<<<<<<<<<<<
  *         if not self.bf:
  *             size = size or 1024
  */
 
@@ -12292,25 +12256,25 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_value)) != 0)) kw_args--;
+        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_value)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_size);
+          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_size);
           if (value) { values[1] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "step") < 0)) __PYX_ERR(0, 1190, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "step") < 0)) __PYX_ERR(0, 1189, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
@@ -12318,15 +12282,15 @@
       }
     }
     __pyx_v_value = values[0];
     __pyx_v_size = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("step", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1190, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("step", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1189, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("playhouse._sqlite_ext.BloomFilterAggregate.step", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_20BloomFilterAggregate_2step(((struct __pyx_obj_9playhouse_11_sqlite_ext_BloomFilterAggregate *)__pyx_v_self), __pyx_v_value, __pyx_v_size);
 
@@ -12339,125 +12303,161 @@
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
+  PyObject *__pyx_t_6 = NULL;
   __Pyx_RefNannySetupContext("step", 0);
   __Pyx_INCREF(__pyx_v_size);
 
-  /* "playhouse/_sqlite_ext.pyx":1191
+  /* "playhouse/_sqlite_ext.pyx":1190
  * 
  *     def step(self, value, size=None):
  *         if not self.bf:             # <<<<<<<<<<<<<<
  *             size = size or 1024
  *             self.bf = BloomFilter(size)
  */
-  __pyx_t_1 = __Pyx_PyObject_IsTrue(((PyObject *)__pyx_v_self->bf)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1191, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_IsTrue(((PyObject *)__pyx_v_self->bf)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1190, __pyx_L1_error)
   __pyx_t_2 = ((!__pyx_t_1) != 0);
   if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":1192
+    /* "playhouse/_sqlite_ext.pyx":1191
  *     def step(self, value, size=None):
  *         if not self.bf:
  *             size = size or 1024             # <<<<<<<<<<<<<<
  *             self.bf = BloomFilter(size)
  * 
  */
-    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_size); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1192, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_size); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1191, __pyx_L1_error)
     if (!__pyx_t_2) {
     } else {
       __Pyx_INCREF(__pyx_v_size);
       __pyx_t_3 = __pyx_v_size;
       goto __pyx_L4_bool_binop_done;
     }
-    __pyx_t_4 = __Pyx_PyInt_From_long(0x400); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1192, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyInt_From_long(0x400); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1191, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_3 = __pyx_t_4;
     __pyx_t_4 = 0;
     __pyx_L4_bool_binop_done:;
     __Pyx_DECREF_SET(__pyx_v_size, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":1193
+    /* "playhouse/_sqlite_ext.pyx":1192
  *         if not self.bf:
  *             size = size or 1024
  *             self.bf = BloomFilter(size)             # <<<<<<<<<<<<<<
  * 
  *         self.bf.add(value)
  */
-    __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)__pyx_ptype_9playhouse_11_sqlite_ext_BloomFilter), __pyx_v_size); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1193, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1192, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_GIVEREF(__pyx_t_3);
+    __Pyx_INCREF(__pyx_v_size);
+    __Pyx_GIVEREF(__pyx_v_size);
+    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_size);
+    __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_9playhouse_11_sqlite_ext_BloomFilter), __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1192, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_GIVEREF(__pyx_t_4);
     __Pyx_GOTREF(__pyx_v_self->bf);
     __Pyx_DECREF(((PyObject *)__pyx_v_self->bf));
-    __pyx_v_self->bf = ((struct __pyx_obj_9playhouse_11_sqlite_ext_BloomFilter *)__pyx_t_3);
-    __pyx_t_3 = 0;
+    __pyx_v_self->bf = ((struct __pyx_obj_9playhouse_11_sqlite_ext_BloomFilter *)__pyx_t_4);
+    __pyx_t_4 = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":1191
+    /* "playhouse/_sqlite_ext.pyx":1190
  * 
  *     def step(self, value, size=None):
  *         if not self.bf:             # <<<<<<<<<<<<<<
  *             size = size or 1024
  *             self.bf = BloomFilter(size)
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1195
+  /* "playhouse/_sqlite_ext.pyx":1194
  *             self.bf = BloomFilter(size)
  * 
  *         self.bf.add(value)             # <<<<<<<<<<<<<<
  * 
  *     def finalize(self):
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->bf), __pyx_n_s_add); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1195, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->bf), __pyx_n_s_add); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1194, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_5 = NULL;
-  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
-    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
+  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
+    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_5)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_4, function);
+      __Pyx_DECREF_SET(__pyx_t_3, function);
+    }
+  }
+  if (!__pyx_t_5) {
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_value); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1194, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+  } else {
+    #if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(__pyx_t_3)) {
+      PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_v_value};
+      __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1194, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_GOTREF(__pyx_t_4);
+    } else
+    #endif
+    #if CYTHON_FAST_PYCCALL
+    if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
+      PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_v_value};
+      __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1194, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_GOTREF(__pyx_t_4);
+    } else
+    #endif
+    {
+      __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1194, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
+      __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5); __pyx_t_5 = NULL;
+      __Pyx_INCREF(__pyx_v_value);
+      __Pyx_GIVEREF(__pyx_v_value);
+      PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_v_value);
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1194, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     }
   }
-  __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_v_value) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_value);
-  __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1195, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1190
+  /* "playhouse/_sqlite_ext.pyx":1189
  *         self.bf = None
  * 
  *     def step(self, value, size=None):             # <<<<<<<<<<<<<<
  *         if not self.bf:
  *             size = size or 1024
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6);
   __Pyx_AddTraceback("playhouse._sqlite_ext.BloomFilterAggregate.step", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_size);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1197
+/* "playhouse/_sqlite_ext.pyx":1196
  *         self.bf.add(value)
  * 
  *     def finalize(self):             # <<<<<<<<<<<<<<
  *         if not self.bf:
  *             return None
  */
 
@@ -12482,96 +12482,130 @@
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   __Pyx_RefNannySetupContext("finalize", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1198
+  /* "playhouse/_sqlite_ext.pyx":1197
  * 
  *     def finalize(self):
  *         if not self.bf:             # <<<<<<<<<<<<<<
  *             return None
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_IsTrue(((PyObject *)__pyx_v_self->bf)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1198, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_IsTrue(((PyObject *)__pyx_v_self->bf)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1197, __pyx_L1_error)
   __pyx_t_2 = ((!__pyx_t_1) != 0);
   if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":1199
+    /* "playhouse/_sqlite_ext.pyx":1198
  *     def finalize(self):
  *         if not self.bf:
  *             return None             # <<<<<<<<<<<<<<
  * 
  *         return pysqlite.Binary(self.bf.to_buffer())
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+    __Pyx_INCREF(Py_None);
+    __pyx_r = Py_None;
     goto __pyx_L0;
 
-    /* "playhouse/_sqlite_ext.pyx":1198
+    /* "playhouse/_sqlite_ext.pyx":1197
  * 
  *     def finalize(self):
  *         if not self.bf:             # <<<<<<<<<<<<<<
  *             return None
  * 
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1201
+  /* "playhouse/_sqlite_ext.pyx":1200
  *             return None
  * 
  *         return pysqlite.Binary(self.bf.to_buffer())             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_pysqlite); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1201, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_pysqlite); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1200, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_Binary); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1201, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_Binary); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1200, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->bf), __pyx_n_s_to_buffer); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1201, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->bf), __pyx_n_s_to_buffer); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1200, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __pyx_t_7 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_7)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
       __Pyx_INCREF(__pyx_t_7);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
-  __pyx_t_4 = (__pyx_t_7) ? __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_7) : __Pyx_PyObject_CallNoArg(__pyx_t_6);
-  __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1201, __pyx_L1_error)
+  if (__pyx_t_7) {
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1200, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  } else {
+    __pyx_t_4 = __Pyx_PyObject_CallNoArg(__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1200, __pyx_L1_error)
+  }
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
-  __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1201, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  if (!__pyx_t_6) {
+    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1200, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_GOTREF(__pyx_t_3);
+  } else {
+    #if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(__pyx_t_5)) {
+      PyObject *__pyx_temp[2] = {__pyx_t_6, __pyx_t_4};
+      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1200, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    } else
+    #endif
+    #if CYTHON_FAST_PYCCALL
+    if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
+      PyObject *__pyx_temp[2] = {__pyx_t_6, __pyx_t_4};
+      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1200, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    } else
+    #endif
+    {
+      __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1200, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_6); __pyx_t_6 = NULL;
+      __Pyx_GIVEREF(__pyx_t_4);
+      PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_t_4);
+      __pyx_t_4 = 0;
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1200, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    }
+  }
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_r = __pyx_t_3;
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1197
+  /* "playhouse/_sqlite_ext.pyx":1196
  *         self.bf.add(value)
  * 
  *     def finalize(self):             # <<<<<<<<<<<<<<
  *         if not self.bf:
  *             return None
  */
 
@@ -12588,16 +12622,16 @@
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
- *     cdef tuple state
- *     cdef object _dict
+ *     cdef bint use_setstate
+ *     state = (self.bf,)
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_20BloomFilterAggregate_7__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_20BloomFilterAggregate_7__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
@@ -12606,208 +12640,208 @@
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 static PyObject *__pyx_pf_9playhouse_11_sqlite_ext_20BloomFilterAggregate_6__reduce_cython__(struct __pyx_obj_9playhouse_11_sqlite_ext_BloomFilterAggregate *__pyx_v_self) {
-  PyObject *__pyx_v_state = 0;
-  PyObject *__pyx_v__dict = 0;
   int __pyx_v_use_setstate;
+  PyObject *__pyx_v_state = NULL;
+  PyObject *__pyx_v__dict = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_t_2;
   int __pyx_t_3;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   __Pyx_RefNannySetupContext("__reduce_cython__", 0);
 
-  /* "(tree fragment)":5
- *     cdef object _dict
+  /* "(tree fragment)":3
+ * def __reduce_cython__(self):
  *     cdef bint use_setstate
  *     state = (self.bf,)             # <<<<<<<<<<<<<<
  *     _dict = getattr(self, '__dict__', None)
  *     if _dict is not None:
  */
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 5, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 3, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(((PyObject *)__pyx_v_self->bf));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->bf));
   PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_self->bf));
   __pyx_v_state = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "(tree fragment)":6
+  /* "(tree fragment)":4
  *     cdef bint use_setstate
  *     state = (self.bf,)
  *     _dict = getattr(self, '__dict__', None)             # <<<<<<<<<<<<<<
  *     if _dict is not None:
  *         state += (_dict,)
  */
-  __pyx_t_1 = __Pyx_GetAttr3(((PyObject *)__pyx_v_self), __pyx_n_s_dict, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 6, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetAttr3(((PyObject *)__pyx_v_self), __pyx_n_s_dict, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v__dict = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "(tree fragment)":7
+  /* "(tree fragment)":5
  *     state = (self.bf,)
  *     _dict = getattr(self, '__dict__', None)
  *     if _dict is not None:             # <<<<<<<<<<<<<<
  *         state += (_dict,)
  *         use_setstate = True
  */
   __pyx_t_2 = (__pyx_v__dict != Py_None);
   __pyx_t_3 = (__pyx_t_2 != 0);
   if (__pyx_t_3) {
 
-    /* "(tree fragment)":8
+    /* "(tree fragment)":6
  *     _dict = getattr(self, '__dict__', None)
  *     if _dict is not None:
  *         state += (_dict,)             # <<<<<<<<<<<<<<
  *         use_setstate = True
  *     else:
  */
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 8, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 6, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_v__dict);
     __Pyx_GIVEREF(__pyx_v__dict);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v__dict);
-    __pyx_t_4 = PyNumber_InPlaceAdd(__pyx_v_state, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 8, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_InPlaceAdd(__pyx_v_state, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 6, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF_SET(__pyx_v_state, ((PyObject*)__pyx_t_4));
     __pyx_t_4 = 0;
 
-    /* "(tree fragment)":9
+    /* "(tree fragment)":7
  *     if _dict is not None:
  *         state += (_dict,)
  *         use_setstate = True             # <<<<<<<<<<<<<<
  *     else:
  *         use_setstate = self.bf is not None
  */
     __pyx_v_use_setstate = 1;
 
-    /* "(tree fragment)":7
+    /* "(tree fragment)":5
  *     state = (self.bf,)
  *     _dict = getattr(self, '__dict__', None)
  *     if _dict is not None:             # <<<<<<<<<<<<<<
  *         state += (_dict,)
  *         use_setstate = True
  */
     goto __pyx_L3;
   }
 
-  /* "(tree fragment)":11
+  /* "(tree fragment)":9
  *         use_setstate = True
  *     else:
  *         use_setstate = self.bf is not None             # <<<<<<<<<<<<<<
  *     if use_setstate:
  *         return __pyx_unpickle_BloomFilterAggregate, (type(self), 0xc9f9d7d, None), state
  */
   /*else*/ {
     __pyx_t_3 = (((PyObject *)__pyx_v_self->bf) != Py_None);
     __pyx_v_use_setstate = __pyx_t_3;
   }
   __pyx_L3:;
 
-  /* "(tree fragment)":12
+  /* "(tree fragment)":10
  *     else:
  *         use_setstate = self.bf is not None
  *     if use_setstate:             # <<<<<<<<<<<<<<
  *         return __pyx_unpickle_BloomFilterAggregate, (type(self), 0xc9f9d7d, None), state
  *     else:
  */
   __pyx_t_3 = (__pyx_v_use_setstate != 0);
   if (__pyx_t_3) {
 
-    /* "(tree fragment)":13
+    /* "(tree fragment)":11
  *         use_setstate = self.bf is not None
  *     if use_setstate:
  *         return __pyx_unpickle_BloomFilterAggregate, (type(self), 0xc9f9d7d, None), state             # <<<<<<<<<<<<<<
  *     else:
  *         return __pyx_unpickle_BloomFilterAggregate, (type(self), 0xc9f9d7d, state)
  */
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_pyx_unpickle_BloomFilterAggreg); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 13, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_pyx_unpickle_BloomFilterAggreg); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 11, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 13, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 11, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))));
     __Pyx_GIVEREF(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))));
     PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))));
     __Pyx_INCREF(__pyx_int_211787133);
     __Pyx_GIVEREF(__pyx_int_211787133);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_211787133);
     __Pyx_INCREF(Py_None);
     __Pyx_GIVEREF(Py_None);
     PyTuple_SET_ITEM(__pyx_t_1, 2, Py_None);
-    __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 13, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 11, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_1);
     __Pyx_INCREF(__pyx_v_state);
     __Pyx_GIVEREF(__pyx_v_state);
     PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_v_state);
     __pyx_t_4 = 0;
     __pyx_t_1 = 0;
     __pyx_r = __pyx_t_5;
     __pyx_t_5 = 0;
     goto __pyx_L0;
 
-    /* "(tree fragment)":12
+    /* "(tree fragment)":10
  *     else:
  *         use_setstate = self.bf is not None
  *     if use_setstate:             # <<<<<<<<<<<<<<
  *         return __pyx_unpickle_BloomFilterAggregate, (type(self), 0xc9f9d7d, None), state
  *     else:
  */
   }
 
-  /* "(tree fragment)":15
+  /* "(tree fragment)":13
  *         return __pyx_unpickle_BloomFilterAggregate, (type(self), 0xc9f9d7d, None), state
  *     else:
  *         return __pyx_unpickle_BloomFilterAggregate, (type(self), 0xc9f9d7d, state)             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     __pyx_unpickle_BloomFilterAggregate__set_state(self, __pyx_state)
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_pyx_unpickle_BloomFilterAggreg); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 15, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_pyx_unpickle_BloomFilterAggreg); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 13, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 15, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 13, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))));
     __Pyx_GIVEREF(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))));
     PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))));
     __Pyx_INCREF(__pyx_int_211787133);
     __Pyx_GIVEREF(__pyx_int_211787133);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_211787133);
     __Pyx_INCREF(__pyx_v_state);
     __Pyx_GIVEREF(__pyx_v_state);
     PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_state);
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 15, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 13, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_1);
     __pyx_t_5 = 0;
     __pyx_t_1 = 0;
     __pyx_r = __pyx_t_4;
     __pyx_t_4 = 0;
     goto __pyx_L0;
   }
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
- *     cdef tuple state
- *     cdef object _dict
+ *     cdef bint use_setstate
+ *     state = (self.bf,)
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
@@ -12817,15 +12851,15 @@
   __Pyx_XDECREF(__pyx_v_state);
   __Pyx_XDECREF(__pyx_v__dict);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "(tree fragment)":16
+/* "(tree fragment)":14
  *     else:
  *         return __pyx_unpickle_BloomFilterAggregate, (type(self), 0xc9f9d7d, state)
  * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
  *     __pyx_unpickle_BloomFilterAggregate__set_state(self, __pyx_state)
  */
 
 /* Python wrapper */
@@ -12843,25 +12877,25 @@
 
 static PyObject *__pyx_pf_9playhouse_11_sqlite_ext_20BloomFilterAggregate_8__setstate_cython__(struct __pyx_obj_9playhouse_11_sqlite_ext_BloomFilterAggregate *__pyx_v_self, PyObject *__pyx_v___pyx_state) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
-  /* "(tree fragment)":17
+  /* "(tree fragment)":15
  *         return __pyx_unpickle_BloomFilterAggregate, (type(self), 0xc9f9d7d, state)
  * def __setstate_cython__(self, __pyx_state):
  *     __pyx_unpickle_BloomFilterAggregate__set_state(self, __pyx_state)             # <<<<<<<<<<<<<<
  */
-  if (!(likely(PyTuple_CheckExact(__pyx_v___pyx_state))||((__pyx_v___pyx_state) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "tuple", Py_TYPE(__pyx_v___pyx_state)->tp_name), 0))) __PYX_ERR(1, 17, __pyx_L1_error)
-  __pyx_t_1 = __pyx_f_9playhouse_11_sqlite_ext___pyx_unpickle_BloomFilterAggregate__set_state(__pyx_v_self, ((PyObject*)__pyx_v___pyx_state)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 17, __pyx_L1_error)
+  if (!(likely(PyTuple_CheckExact(__pyx_v___pyx_state))||((__pyx_v___pyx_state) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "tuple", Py_TYPE(__pyx_v___pyx_state)->tp_name), 0))) __PYX_ERR(1, 15, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_9playhouse_11_sqlite_ext___pyx_unpickle_BloomFilterAggregate__set_state(__pyx_v_self, ((PyObject*)__pyx_v___pyx_state)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 15, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "(tree fragment)":16
+  /* "(tree fragment)":14
  *     else:
  *         return __pyx_unpickle_BloomFilterAggregate, (type(self), 0xc9f9d7d, state)
  * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
  *     __pyx_unpickle_BloomFilterAggregate__set_state(self, __pyx_state)
  */
 
   /* function exit code */
@@ -12873,25 +12907,25 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1204
+/* "playhouse/_sqlite_ext.pyx":1203
  * 
  * 
  * def peewee_bloomfilter_contains(key, data):             # <<<<<<<<<<<<<<
  *     cdef:
  *         bf_t bf
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_19peewee_bloomfilter_contains(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_19peewee_bloomfilter_contains = {"peewee_bloomfilter_contains", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_19peewee_bloomfilter_contains, METH_VARARGS|METH_KEYWORDS, 0};
+static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_19peewee_bloomfilter_contains = {"peewee_bloomfilter_contains", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_19peewee_bloomfilter_contains, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_19peewee_bloomfilter_contains(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_key = 0;
   PyObject *__pyx_v_data = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("peewee_bloomfilter_contains (wrapper)", 0);
   {
@@ -12907,38 +12941,38 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_key)) != 0)) kw_args--;
+        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_key)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_data)) != 0)) kw_args--;
+        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_data)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("peewee_bloomfilter_contains", 1, 2, 2, 1); __PYX_ERR(0, 1204, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("peewee_bloomfilter_contains", 1, 2, 2, 1); __PYX_ERR(0, 1203, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "peewee_bloomfilter_contains") < 0)) __PYX_ERR(0, 1204, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "peewee_bloomfilter_contains") < 0)) __PYX_ERR(0, 1203, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_key = values[0];
     __pyx_v_data = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("peewee_bloomfilter_contains", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1204, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("peewee_bloomfilter_contains", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1203, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("playhouse._sqlite_ext.peewee_bloomfilter_contains", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_18peewee_bloomfilter_contains(__pyx_self, __pyx_v_key, __pyx_v_data);
 
@@ -12951,122 +12985,130 @@
   __pyx_t_9playhouse_11_sqlite_ext_bf_t __pyx_v_bf;
   PyObject *__pyx_v_bkey = 0;
   PyObject *__pyx_v_bdata = 0;
   unsigned char *__pyx_v_cdata;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
-  unsigned char *__pyx_t_2;
-  Py_ssize_t __pyx_t_3;
+  PyObject *__pyx_t_2 = NULL;
+  unsigned char *__pyx_t_3;
+  Py_ssize_t __pyx_t_4;
   __Pyx_RefNannySetupContext("peewee_bloomfilter_contains", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1208
+  /* "playhouse/_sqlite_ext.pyx":1207
  *         bf_t bf
  *         bytes bkey
  *         bytes bdata = bytes(data)             # <<<<<<<<<<<<<<
  *         unsigned char *cdata = <unsigned char *>bdata
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyBytes_Type)), __pyx_v_data); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1208, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1207, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_v_bdata = ((PyObject*)__pyx_t_1);
-  __pyx_t_1 = 0;
+  __Pyx_INCREF(__pyx_v_data);
+  __Pyx_GIVEREF(__pyx_v_data);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_data);
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)(&PyBytes_Type)), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1207, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_bdata = ((PyObject*)__pyx_t_2);
+  __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1209
+  /* "playhouse/_sqlite_ext.pyx":1208
  *         bytes bkey
  *         bytes bdata = bytes(data)
  *         unsigned char *cdata = <unsigned char *>bdata             # <<<<<<<<<<<<<<
  * 
  *     bf.size = len(data)
  */
-  __pyx_t_2 = __Pyx_PyBytes_AsWritableUString(__pyx_v_bdata); if (unlikely((!__pyx_t_2) && PyErr_Occurred())) __PYX_ERR(0, 1209, __pyx_L1_error)
-  __pyx_v_cdata = ((unsigned char *)__pyx_t_2);
+  __pyx_t_3 = __Pyx_PyBytes_AsWritableUString(__pyx_v_bdata); if (unlikely((!__pyx_t_3) && PyErr_Occurred())) __PYX_ERR(0, 1208, __pyx_L1_error)
+  __pyx_v_cdata = ((unsigned char *)__pyx_t_3);
 
-  /* "playhouse/_sqlite_ext.pyx":1211
+  /* "playhouse/_sqlite_ext.pyx":1210
  *         unsigned char *cdata = <unsigned char *>bdata
  * 
  *     bf.size = len(data)             # <<<<<<<<<<<<<<
  *     bf.bits = <void *>cdata
  *     bkey = encode(key)
  */
-  __pyx_t_3 = PyObject_Length(__pyx_v_data); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1211, __pyx_L1_error)
-  __pyx_v_bf.size = __pyx_t_3;
+  __pyx_t_4 = PyObject_Length(__pyx_v_data); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1210, __pyx_L1_error)
+  __pyx_v_bf.size = __pyx_t_4;
 
-  /* "playhouse/_sqlite_ext.pyx":1212
+  /* "playhouse/_sqlite_ext.pyx":1211
  * 
  *     bf.size = len(data)
  *     bf.bits = <void *>cdata             # <<<<<<<<<<<<<<
  *     bkey = encode(key)
  * 
  */
   __pyx_v_bf.bits = ((void *)__pyx_v_cdata);
 
-  /* "playhouse/_sqlite_ext.pyx":1213
+  /* "playhouse/_sqlite_ext.pyx":1212
  *     bf.size = len(data)
  *     bf.bits = <void *>cdata
  *     bkey = encode(key)             # <<<<<<<<<<<<<<
  * 
  *     return bf_contains(&bf, <unsigned char *>bkey)
  */
-  __pyx_t_1 = __pyx_f_9playhouse_11_sqlite_ext_encode(__pyx_v_key); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1213, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_v_bkey = ((PyObject*)__pyx_t_1);
-  __pyx_t_1 = 0;
+  __pyx_t_2 = __pyx_f_9playhouse_11_sqlite_ext_encode(__pyx_v_key); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1212, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_v_bkey = ((PyObject*)__pyx_t_2);
+  __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1215
+  /* "playhouse/_sqlite_ext.pyx":1214
  *     bkey = encode(key)
  * 
  *     return bf_contains(&bf, <unsigned char *>bkey)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   if (unlikely(__pyx_v_bkey == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "expected bytes, NoneType found");
-    __PYX_ERR(0, 1215, __pyx_L1_error)
+    __PYX_ERR(0, 1214, __pyx_L1_error)
   }
-  __pyx_t_2 = __Pyx_PyBytes_AsWritableUString(__pyx_v_bkey); if (unlikely((!__pyx_t_2) && PyErr_Occurred())) __PYX_ERR(0, 1215, __pyx_L1_error)
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_f_9playhouse_11_sqlite_ext_bf_contains((&__pyx_v_bf), ((unsigned char *)__pyx_t_2))); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1215, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_r = __pyx_t_1;
-  __pyx_t_1 = 0;
+  __pyx_t_3 = __Pyx_PyBytes_AsWritableUString(__pyx_v_bkey); if (unlikely((!__pyx_t_3) && PyErr_Occurred())) __PYX_ERR(0, 1214, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_f_9playhouse_11_sqlite_ext_bf_contains((&__pyx_v_bf), ((unsigned char *)__pyx_t_3))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1214, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_r = __pyx_t_2;
+  __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1204
+  /* "playhouse/_sqlite_ext.pyx":1203
  * 
  * 
  * def peewee_bloomfilter_contains(key, data):             # <<<<<<<<<<<<<<
  *     cdef:
  *         bf_t bf
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
   __Pyx_AddTraceback("playhouse._sqlite_ext.peewee_bloomfilter_contains", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_bkey);
   __Pyx_XDECREF(__pyx_v_bdata);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1218
+/* "playhouse/_sqlite_ext.pyx":1217
  * 
  * 
  * def peewee_bloomfilter_calculate_size(n_items, error_p):             # <<<<<<<<<<<<<<
  *     return BloomFilter.calculate_size(n_items, error_p)
  * 
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_21peewee_bloomfilter_calculate_size(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_21peewee_bloomfilter_calculate_size = {"peewee_bloomfilter_calculate_size", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_21peewee_bloomfilter_calculate_size, METH_VARARGS|METH_KEYWORDS, 0};
+static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_21peewee_bloomfilter_calculate_size = {"peewee_bloomfilter_calculate_size", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_21peewee_bloomfilter_calculate_size, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_21peewee_bloomfilter_calculate_size(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_n_items = 0;
   PyObject *__pyx_v_error_p = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("peewee_bloomfilter_calculate_size (wrapper)", 0);
   {
@@ -13082,38 +13124,38 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_n_items)) != 0)) kw_args--;
+        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_n_items)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_error_p)) != 0)) kw_args--;
+        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_error_p)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("peewee_bloomfilter_calculate_size", 1, 2, 2, 1); __PYX_ERR(0, 1218, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("peewee_bloomfilter_calculate_size", 1, 2, 2, 1); __PYX_ERR(0, 1217, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "peewee_bloomfilter_calculate_size") < 0)) __PYX_ERR(0, 1218, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "peewee_bloomfilter_calculate_size") < 0)) __PYX_ERR(0, 1217, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_n_items = values[0];
     __pyx_v_error_p = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("peewee_bloomfilter_calculate_size", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1218, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("peewee_bloomfilter_calculate_size", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1217, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("playhouse._sqlite_ext.peewee_bloomfilter_calculate_size", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_20peewee_bloomfilter_calculate_size(__pyx_self, __pyx_v_n_items, __pyx_v_error_p);
 
@@ -13128,23 +13170,23 @@
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
   __Pyx_RefNannySetupContext("peewee_bloomfilter_calculate_size", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1219
+  /* "playhouse/_sqlite_ext.pyx":1218
  * 
  * def peewee_bloomfilter_calculate_size(n_items, error_p):
  *     return BloomFilter.calculate_size(n_items, error_p)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_9playhouse_11_sqlite_ext_BloomFilter), __pyx_n_s_calculate_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1219, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_9playhouse_11_sqlite_ext_BloomFilter), __pyx_n_s_calculate_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1218, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   __pyx_t_4 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -13153,49 +13195,49 @@
       __Pyx_DECREF_SET(__pyx_t_2, function);
       __pyx_t_4 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_n_items, __pyx_v_error_p};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1219, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1218, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_n_items, __pyx_v_error_p};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1219, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1218, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   {
-    __pyx_t_5 = PyTuple_New(2+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1219, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(2+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1218, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     if (__pyx_t_3) {
       __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
     }
     __Pyx_INCREF(__pyx_v_n_items);
     __Pyx_GIVEREF(__pyx_v_n_items);
     PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_4, __pyx_v_n_items);
     __Pyx_INCREF(__pyx_v_error_p);
     __Pyx_GIVEREF(__pyx_v_error_p);
     PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_4, __pyx_v_error_p);
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1219, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1218, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1218
+  /* "playhouse/_sqlite_ext.pyx":1217
  * 
  * 
  * def peewee_bloomfilter_calculate_size(n_items, error_p):             # <<<<<<<<<<<<<<
  *     return BloomFilter.calculate_size(n_items, error_p)
  * 
  */
 
@@ -13209,15 +13251,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1222
+/* "playhouse/_sqlite_ext.pyx":1221
  * 
  * 
  * def register_bloomfilter(database):             # <<<<<<<<<<<<<<
  *     database.register_aggregate(BloomFilterAggregate, 'bloomfilter')
  *     database.register_function(peewee_bloomfilter_contains,
  */
 
@@ -13242,22 +13284,22 @@
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   __Pyx_RefNannySetupContext("register_bloomfilter", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1223
+  /* "playhouse/_sqlite_ext.pyx":1222
  * 
  * def register_bloomfilter(database):
  *     database.register_aggregate(BloomFilterAggregate, 'bloomfilter')             # <<<<<<<<<<<<<<
  *     database.register_function(peewee_bloomfilter_contains,
  *                                'bloomfilter_contains')
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_database, __pyx_n_s_register_aggregate); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1223, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_database, __pyx_n_s_register_aggregate); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1222, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   __pyx_t_4 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -13266,56 +13308,56 @@
       __Pyx_DECREF_SET(__pyx_t_2, function);
       __pyx_t_4 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_3, ((PyObject *)__pyx_ptype_9playhouse_11_sqlite_ext_BloomFilterAggregate), __pyx_n_s_bloomfilter};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1223, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1222, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_3, ((PyObject *)__pyx_ptype_9playhouse_11_sqlite_ext_BloomFilterAggregate), __pyx_n_s_bloomfilter};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1223, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1222, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   {
-    __pyx_t_5 = PyTuple_New(2+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1223, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(2+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1222, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     if (__pyx_t_3) {
       __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
     }
     __Pyx_INCREF(((PyObject *)__pyx_ptype_9playhouse_11_sqlite_ext_BloomFilterAggregate));
     __Pyx_GIVEREF(((PyObject *)__pyx_ptype_9playhouse_11_sqlite_ext_BloomFilterAggregate));
     PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_4, ((PyObject *)__pyx_ptype_9playhouse_11_sqlite_ext_BloomFilterAggregate));
     __Pyx_INCREF(__pyx_n_s_bloomfilter);
     __Pyx_GIVEREF(__pyx_n_s_bloomfilter);
     PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_4, __pyx_n_s_bloomfilter);
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1223, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1222, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1224
+  /* "playhouse/_sqlite_ext.pyx":1223
  * def register_bloomfilter(database):
  *     database.register_aggregate(BloomFilterAggregate, 'bloomfilter')
  *     database.register_function(peewee_bloomfilter_contains,             # <<<<<<<<<<<<<<
  *                                'bloomfilter_contains')
  *     database.register_function(peewee_bloomfilter_calculate_size,
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_database, __pyx_n_s_register_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1224, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_database, __pyx_n_s_register_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1223, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_peewee_bloomfilter_contains); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1224, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_peewee_bloomfilter_contains); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1223, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_3 = NULL;
   __pyx_t_4 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -13324,58 +13366,58 @@
       __Pyx_DECREF_SET(__pyx_t_2, function);
       __pyx_t_4 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_t_5, __pyx_n_s_bloomfilter_contains};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1224, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1223, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_t_5, __pyx_n_s_bloomfilter_contains};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1224, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1223, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   } else
   #endif
   {
-    __pyx_t_6 = PyTuple_New(2+__pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1224, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2+__pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1223, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     if (__pyx_t_3) {
       __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3); __pyx_t_3 = NULL;
     }
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_4, __pyx_t_5);
     __Pyx_INCREF(__pyx_n_s_bloomfilter_contains);
     __Pyx_GIVEREF(__pyx_n_s_bloomfilter_contains);
     PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_4, __pyx_n_s_bloomfilter_contains);
     __pyx_t_5 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1224, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1223, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1226
+  /* "playhouse/_sqlite_ext.pyx":1225
  *     database.register_function(peewee_bloomfilter_contains,
  *                                'bloomfilter_contains')
  *     database.register_function(peewee_bloomfilter_calculate_size,             # <<<<<<<<<<<<<<
  *                                'bloomfilter_calculate_size')
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_database, __pyx_n_s_register_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1226, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_database, __pyx_n_s_register_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1225, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_peewee_bloomfilter_calculate_siz); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1226, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_peewee_bloomfilter_calculate_siz); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1225, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __pyx_t_5 = NULL;
   __pyx_t_4 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -13384,49 +13426,49 @@
       __Pyx_DECREF_SET(__pyx_t_2, function);
       __pyx_t_4 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_6, __pyx_n_s_bloomfilter_calculate_size};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1226, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1225, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_6, __pyx_n_s_bloomfilter_calculate_size};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1226, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1225, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   } else
   #endif
   {
-    __pyx_t_3 = PyTuple_New(2+__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1226, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(2+__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1225, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     if (__pyx_t_5) {
       __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
     }
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_4, __pyx_t_6);
     __Pyx_INCREF(__pyx_n_s_bloomfilter_calculate_size);
     __Pyx_GIVEREF(__pyx_n_s_bloomfilter_calculate_size);
     PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_4, __pyx_n_s_bloomfilter_calculate_size);
     __pyx_t_6 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1226, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1225, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1222
+  /* "playhouse/_sqlite_ext.pyx":1221
  * 
  * 
  * def register_bloomfilter(database):             # <<<<<<<<<<<<<<
  *     database.register_aggregate(BloomFilterAggregate, 'bloomfilter')
  *     database.register_function(peewee_bloomfilter_contains,
  */
 
@@ -13443,119 +13485,105 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1230
+/* "playhouse/_sqlite_ext.pyx":1229
  * 
  * 
  * cdef inline int _check_connection(pysqlite_Connection *conn) except -1:             # <<<<<<<<<<<<<<
  *     """
  *     Check that the underlying SQLite database connection is usable. Raises an
  */
 
 static CYTHON_INLINE int __pyx_f_9playhouse_11_sqlite_ext__check_connection(pysqlite_Connection *__pyx_v_conn) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
-  PyObject *__pyx_t_4 = NULL;
   __Pyx_RefNannySetupContext("_check_connection", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1235
+  /* "playhouse/_sqlite_ext.pyx":1234
  *     InterfaceError if the connection is either uninitialized or closed.
  *     """
  *     if not conn.db:             # <<<<<<<<<<<<<<
  *         raise InterfaceError('Cannot operate on closed database.')
  *     return 1
  */
   __pyx_t_1 = ((!(__pyx_v_conn->db != 0)) != 0);
-  if (unlikely(__pyx_t_1)) {
+  if (__pyx_t_1) {
 
-    /* "playhouse/_sqlite_ext.pyx":1236
+    /* "playhouse/_sqlite_ext.pyx":1235
  *     """
  *     if not conn.db:
  *         raise InterfaceError('Cannot operate on closed database.')             # <<<<<<<<<<<<<<
  *     return 1
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_InterfaceError); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1236, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = NULL;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
-      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
-      if (likely(__pyx_t_4)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-        __Pyx_INCREF(__pyx_t_4);
-        __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_3, function);
-      }
-    }
-    __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_kp_s_Cannot_operate_on_closed_databas) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_kp_s_Cannot_operate_on_closed_databas);
-    __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1236, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_InterfaceError); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1235, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__12, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1235, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 1236, __pyx_L1_error)
+    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __PYX_ERR(0, 1235, __pyx_L1_error)
 
-    /* "playhouse/_sqlite_ext.pyx":1235
+    /* "playhouse/_sqlite_ext.pyx":1234
  *     InterfaceError if the connection is either uninitialized or closed.
  *     """
  *     if not conn.db:             # <<<<<<<<<<<<<<
  *         raise InterfaceError('Cannot operate on closed database.')
  *     return 1
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1237
+  /* "playhouse/_sqlite_ext.pyx":1236
  *     if not conn.db:
  *         raise InterfaceError('Cannot operate on closed database.')
  *     return 1             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = 1;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1230
+  /* "playhouse/_sqlite_ext.pyx":1229
  * 
  * 
  * cdef inline int _check_connection(pysqlite_Connection *conn) except -1:             # <<<<<<<<<<<<<<
  *     """
  *     Check that the underlying SQLite database connection is usable. Raises an
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_4);
   __Pyx_AddTraceback("playhouse._sqlite_ext._check_connection", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1241
+/* "playhouse/_sqlite_ext.pyx":1240
  * 
  * class ZeroBlob(Node):
  *     def __init__(self, length):             # <<<<<<<<<<<<<<
  *         if not isinstance(length, int) or length < 0:
  *             raise ValueError('Length must be a positive integer.')
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_8ZeroBlob_1__init__(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_8ZeroBlob_1__init__ = {"__init__", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_8ZeroBlob_1__init__, METH_VARARGS|METH_KEYWORDS, 0};
+static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_8ZeroBlob_1__init__ = {"__init__", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_8ZeroBlob_1__init__, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_8ZeroBlob_1__init__(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_length = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
   {
@@ -13571,38 +13599,38 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
+        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_length)) != 0)) kw_args--;
+        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_length)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 2, 2, 1); __PYX_ERR(0, 1241, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 2, 2, 1); __PYX_ERR(0, 1240, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 1241, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 1240, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_self = values[0];
     __pyx_v_length = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1241, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1240, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("playhouse._sqlite_ext.ZeroBlob.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_8ZeroBlob___init__(__pyx_self, __pyx_v_self, __pyx_v_length);
 
@@ -13616,67 +13644,67 @@
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   int __pyx_t_3;
   PyObject *__pyx_t_4 = NULL;
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1242
+  /* "playhouse/_sqlite_ext.pyx":1241
  * class ZeroBlob(Node):
  *     def __init__(self, length):
  *         if not isinstance(length, int) or length < 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('Length must be a positive integer.')
  *         self.length = length
  */
   __pyx_t_2 = PyInt_Check(__pyx_v_length); 
   __pyx_t_3 = ((!(__pyx_t_2 != 0)) != 0);
   if (!__pyx_t_3) {
   } else {
     __pyx_t_1 = __pyx_t_3;
     goto __pyx_L4_bool_binop_done;
   }
-  __pyx_t_4 = PyObject_RichCompare(__pyx_v_length, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1242, __pyx_L1_error)
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 1242, __pyx_L1_error)
+  __pyx_t_4 = PyObject_RichCompare(__pyx_v_length, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1241, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 1241, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_1 = __pyx_t_3;
   __pyx_L4_bool_binop_done:;
-  if (unlikely(__pyx_t_1)) {
+  if (__pyx_t_1) {
 
-    /* "playhouse/_sqlite_ext.pyx":1243
+    /* "playhouse/_sqlite_ext.pyx":1242
  *     def __init__(self, length):
  *         if not isinstance(length, int) or length < 0:
  *             raise ValueError('Length must be a positive integer.')             # <<<<<<<<<<<<<<
  *         self.length = length
  * 
  */
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1243, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__13, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1242, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_Raise(__pyx_t_4, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __PYX_ERR(0, 1243, __pyx_L1_error)
+    __PYX_ERR(0, 1242, __pyx_L1_error)
 
-    /* "playhouse/_sqlite_ext.pyx":1242
+    /* "playhouse/_sqlite_ext.pyx":1241
  * class ZeroBlob(Node):
  *     def __init__(self, length):
  *         if not isinstance(length, int) or length < 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('Length must be a positive integer.')
  *         self.length = length
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1244
+  /* "playhouse/_sqlite_ext.pyx":1243
  *         if not isinstance(length, int) or length < 0:
  *             raise ValueError('Length must be a positive integer.')
  *         self.length = length             # <<<<<<<<<<<<<<
  * 
  *     def __sql__(self, ctx):
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_length, __pyx_v_length) < 0) __PYX_ERR(0, 1244, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_length, __pyx_v_length) < 0) __PYX_ERR(0, 1243, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1241
+  /* "playhouse/_sqlite_ext.pyx":1240
  * 
  * class ZeroBlob(Node):
  *     def __init__(self, length):             # <<<<<<<<<<<<<<
  *         if not isinstance(length, int) or length < 0:
  *             raise ValueError('Length must be a positive integer.')
  */
 
@@ -13689,25 +13717,25 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1246
+/* "playhouse/_sqlite_ext.pyx":1245
  *         self.length = length
  * 
  *     def __sql__(self, ctx):             # <<<<<<<<<<<<<<
  *         return ctx.literal('zeroblob(%s)' % self.length)
  * 
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_8ZeroBlob_3__sql__(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_8ZeroBlob_3__sql__ = {"__sql__", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_8ZeroBlob_3__sql__, METH_VARARGS|METH_KEYWORDS, 0};
+static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_8ZeroBlob_3__sql__ = {"__sql__", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_8ZeroBlob_3__sql__, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_8ZeroBlob_3__sql__(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_self = 0;
   PyObject *__pyx_v_ctx = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__sql__ (wrapper)", 0);
   {
@@ -13723,38 +13751,38 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
+        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_ctx)) != 0)) kw_args--;
+        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ctx)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__sql__", 1, 2, 2, 1); __PYX_ERR(0, 1246, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__sql__", 1, 2, 2, 1); __PYX_ERR(0, 1245, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__sql__") < 0)) __PYX_ERR(0, 1246, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__sql__") < 0)) __PYX_ERR(0, 1245, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_self = values[0];
     __pyx_v_ctx = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__sql__", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1246, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__sql__", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1245, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("playhouse._sqlite_ext.ZeroBlob.__sql__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_8ZeroBlob_2__sql__(__pyx_self, __pyx_v_self, __pyx_v_ctx);
 
@@ -13766,168 +13794,186 @@
 static PyObject *__pyx_pf_9playhouse_11_sqlite_ext_8ZeroBlob_2__sql__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_ctx) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
   __Pyx_RefNannySetupContext("__sql__", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1247
+  /* "playhouse/_sqlite_ext.pyx":1246
  * 
  *     def __sql__(self, ctx):
  *         return ctx.literal('zeroblob(%s)' % self.length)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_ctx, __pyx_n_s_literal); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1247, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_ctx, __pyx_n_s_literal); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1246, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1247, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_length); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1246, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyString_FormatSafe(__pyx_kp_s_zeroblob_s, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1247, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_zeroblob_s, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1246, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
-  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1247, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
+  if (!__pyx_t_3) {
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1246, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_GOTREF(__pyx_t_1);
+  } else {
+    #if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(__pyx_t_2)) {
+      PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_4};
+      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1246, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    } else
+    #endif
+    #if CYTHON_FAST_PYCCALL
+    if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
+      PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_4};
+      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1246, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    } else
+    #endif
+    {
+      __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1246, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
+      __Pyx_GIVEREF(__pyx_t_4);
+      PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_t_4);
+      __pyx_t_4 = 0;
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1246, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    }
+  }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1246
+  /* "playhouse/_sqlite_ext.pyx":1245
  *         self.length = length
  * 
  *     def __sql__(self, ctx):             # <<<<<<<<<<<<<<
  *         return ctx.literal('zeroblob(%s)' % self.length)
  * 
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
   __Pyx_AddTraceback("playhouse._sqlite_ext.ZeroBlob.__sql__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1253
+/* "playhouse/_sqlite_ext.pyx":1252
  * 
  * 
  * cdef inline int _check_blob_closed(Blob blob) except -1:             # <<<<<<<<<<<<<<
  *     if not blob.pBlob:
  *         raise InterfaceError('Cannot operate on closed blob.')
  */
 
 static CYTHON_INLINE int __pyx_f_9playhouse_11_sqlite_ext__check_blob_closed(struct __pyx_obj_9playhouse_11_sqlite_ext_Blob *__pyx_v_blob) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
-  PyObject *__pyx_t_4 = NULL;
   __Pyx_RefNannySetupContext("_check_blob_closed", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1254
+  /* "playhouse/_sqlite_ext.pyx":1253
  * 
  * cdef inline int _check_blob_closed(Blob blob) except -1:
  *     if not blob.pBlob:             # <<<<<<<<<<<<<<
  *         raise InterfaceError('Cannot operate on closed blob.')
  *     return 1
  */
   __pyx_t_1 = ((!(__pyx_v_blob->pBlob != 0)) != 0);
-  if (unlikely(__pyx_t_1)) {
+  if (__pyx_t_1) {
 
-    /* "playhouse/_sqlite_ext.pyx":1255
+    /* "playhouse/_sqlite_ext.pyx":1254
  * cdef inline int _check_blob_closed(Blob blob) except -1:
  *     if not blob.pBlob:
  *         raise InterfaceError('Cannot operate on closed blob.')             # <<<<<<<<<<<<<<
  *     return 1
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_InterfaceError); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1255, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = NULL;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
-      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
-      if (likely(__pyx_t_4)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-        __Pyx_INCREF(__pyx_t_4);
-        __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_3, function);
-      }
-    }
-    __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_kp_s_Cannot_operate_on_closed_blob) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_kp_s_Cannot_operate_on_closed_blob);
-    __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1255, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_InterfaceError); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1254, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__14, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1254, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 1255, __pyx_L1_error)
+    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __PYX_ERR(0, 1254, __pyx_L1_error)
 
-    /* "playhouse/_sqlite_ext.pyx":1254
+    /* "playhouse/_sqlite_ext.pyx":1253
  * 
  * cdef inline int _check_blob_closed(Blob blob) except -1:
  *     if not blob.pBlob:             # <<<<<<<<<<<<<<
  *         raise InterfaceError('Cannot operate on closed blob.')
  *     return 1
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1256
+  /* "playhouse/_sqlite_ext.pyx":1255
  *     if not blob.pBlob:
  *         raise InterfaceError('Cannot operate on closed blob.')
  *     return 1             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = 1;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1253
+  /* "playhouse/_sqlite_ext.pyx":1252
  * 
  * 
  * cdef inline int _check_blob_closed(Blob blob) except -1:             # <<<<<<<<<<<<<<
  *     if not blob.pBlob:
  *         raise InterfaceError('Cannot operate on closed blob.')
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_4);
   __Pyx_AddTraceback("playhouse._sqlite_ext._check_blob_closed", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1265
+/* "playhouse/_sqlite_ext.pyx":1264
  *         sqlite3_blob *pBlob
  * 
  *     def __init__(self, database, table, column, rowid,             # <<<<<<<<<<<<<<
  *                  read_only=False):
  *         cdef:
  */
 
@@ -13942,15 +13988,15 @@
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_database,&__pyx_n_s_table,&__pyx_n_s_column,&__pyx_n_s_rowid,&__pyx_n_s_read_only,0};
     PyObject* values[5] = {0,0,0,0,0};
 
-    /* "playhouse/_sqlite_ext.pyx":1266
+    /* "playhouse/_sqlite_ext.pyx":1265
  * 
  *     def __init__(self, database, table, column, rowid,
  *                  read_only=False):             # <<<<<<<<<<<<<<
  *         cdef:
  *             bytes btable = encode(table)
  */
     values[4] = ((PyObject *)Py_False);
@@ -13970,43 +14016,43 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_database)) != 0)) kw_args--;
+        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_database)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_table)) != 0)) kw_args--;
+        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_table)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 5, 1); __PYX_ERR(0, 1265, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 5, 1); __PYX_ERR(0, 1264, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_column)) != 0)) kw_args--;
+        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_column)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 5, 2); __PYX_ERR(0, 1265, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 5, 2); __PYX_ERR(0, 1264, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
-        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_rowid)) != 0)) kw_args--;
+        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_rowid)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 5, 3); __PYX_ERR(0, 1265, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 5, 3); __PYX_ERR(0, 1264, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_read_only);
+          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_read_only);
           if (value) { values[4] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 1265, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 1264, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -14020,23 +14066,23 @@
     __pyx_v_table = values[1];
     __pyx_v_column = values[2];
     __pyx_v_rowid = values[3];
     __pyx_v_read_only = values[4];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1265, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1264, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("playhouse._sqlite_ext.Blob.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_4Blob___init__(((struct __pyx_obj_9playhouse_11_sqlite_ext_Blob *)__pyx_v_self), __pyx_v_database, __pyx_v_table, __pyx_v_column, __pyx_v_rowid, __pyx_v_read_only);
 
-  /* "playhouse/_sqlite_ext.pyx":1265
+  /* "playhouse/_sqlite_ext.pyx":1264
  *         sqlite3_blob *pBlob
  * 
  *     def __init__(self, database, table, column, rowid,             # <<<<<<<<<<<<<<
  *                  read_only=False):
  *         cdef:
  */
 
@@ -14056,312 +14102,298 @@
   PyObject *__pyx_t_1 = NULL;
   int __pyx_t_2;
   int __pyx_t_3;
   PyObject *__pyx_t_4 = NULL;
   char *__pyx_t_5;
   char *__pyx_t_6;
   PY_LONG_LONG __pyx_t_7;
-  PyObject *__pyx_t_8 = NULL;
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1268
+  /* "playhouse/_sqlite_ext.pyx":1267
  *                  read_only=False):
  *         cdef:
  *             bytes btable = encode(table)             # <<<<<<<<<<<<<<
  *             bytes bcolumn = encode(column)
  *             int flags = 0 if read_only else 1
  */
-  __pyx_t_1 = __pyx_f_9playhouse_11_sqlite_ext_encode(__pyx_v_table); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1268, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_9playhouse_11_sqlite_ext_encode(__pyx_v_table); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1267, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_btable = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1269
+  /* "playhouse/_sqlite_ext.pyx":1268
  *         cdef:
  *             bytes btable = encode(table)
  *             bytes bcolumn = encode(column)             # <<<<<<<<<<<<<<
  *             int flags = 0 if read_only else 1
  *             int rc
  */
-  __pyx_t_1 = __pyx_f_9playhouse_11_sqlite_ext_encode(__pyx_v_column); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1269, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_9playhouse_11_sqlite_ext_encode(__pyx_v_column); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1268, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_bcolumn = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1270
+  /* "playhouse/_sqlite_ext.pyx":1269
  *             bytes btable = encode(table)
  *             bytes bcolumn = encode(column)
  *             int flags = 0 if read_only else 1             # <<<<<<<<<<<<<<
  *             int rc
  *             sqlite3_blob *blob
  */
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_read_only); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 1270, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_read_only); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 1269, __pyx_L1_error)
   if (__pyx_t_3) {
     __pyx_t_2 = 0;
   } else {
     __pyx_t_2 = 1;
   }
   __pyx_v_flags = __pyx_t_2;
 
-  /* "playhouse/_sqlite_ext.pyx":1274
+  /* "playhouse/_sqlite_ext.pyx":1273
  *             sqlite3_blob *blob
  * 
  *         self.conn = <pysqlite_Connection *>(database._state.conn)             # <<<<<<<<<<<<<<
  *         _check_connection(self.conn)
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_database, __pyx_n_s_state_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1274, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_database, __pyx_n_s_state_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1273, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_conn); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1274, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_conn); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1273, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_self->conn = ((pysqlite_Connection *)__pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1275
+  /* "playhouse/_sqlite_ext.pyx":1274
  * 
  *         self.conn = <pysqlite_Connection *>(database._state.conn)
  *         _check_connection(self.conn)             # <<<<<<<<<<<<<<
  * 
  *         rc = sqlite3_blob_open(
  */
-  __pyx_t_2 = __pyx_f_9playhouse_11_sqlite_ext__check_connection(__pyx_v_self->conn); if (unlikely(__pyx_t_2 == ((int)-1))) __PYX_ERR(0, 1275, __pyx_L1_error)
+  __pyx_t_2 = __pyx_f_9playhouse_11_sqlite_ext__check_connection(__pyx_v_self->conn); if (unlikely(__pyx_t_2 == ((int)-1))) __PYX_ERR(0, 1274, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1280
+  /* "playhouse/_sqlite_ext.pyx":1279
  *             self.conn.db,
  *             'main',
  *             <char *>btable,             # <<<<<<<<<<<<<<
  *             <char *>bcolumn,
  *             <long long>rowid,
  */
   if (unlikely(__pyx_v_btable == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "expected bytes, NoneType found");
-    __PYX_ERR(0, 1280, __pyx_L1_error)
+    __PYX_ERR(0, 1279, __pyx_L1_error)
   }
-  __pyx_t_5 = __Pyx_PyBytes_AsWritableString(__pyx_v_btable); if (unlikely((!__pyx_t_5) && PyErr_Occurred())) __PYX_ERR(0, 1280, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyBytes_AsWritableString(__pyx_v_btable); if (unlikely((!__pyx_t_5) && PyErr_Occurred())) __PYX_ERR(0, 1279, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1281
+  /* "playhouse/_sqlite_ext.pyx":1280
  *             'main',
  *             <char *>btable,
  *             <char *>bcolumn,             # <<<<<<<<<<<<<<
  *             <long long>rowid,
  *             flags,
  */
   if (unlikely(__pyx_v_bcolumn == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "expected bytes, NoneType found");
-    __PYX_ERR(0, 1281, __pyx_L1_error)
+    __PYX_ERR(0, 1280, __pyx_L1_error)
   }
-  __pyx_t_6 = __Pyx_PyBytes_AsWritableString(__pyx_v_bcolumn); if (unlikely((!__pyx_t_6) && PyErr_Occurred())) __PYX_ERR(0, 1281, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyBytes_AsWritableString(__pyx_v_bcolumn); if (unlikely((!__pyx_t_6) && PyErr_Occurred())) __PYX_ERR(0, 1280, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1282
+  /* "playhouse/_sqlite_ext.pyx":1281
  *             <char *>btable,
  *             <char *>bcolumn,
  *             <long long>rowid,             # <<<<<<<<<<<<<<
  *             flags,
  *             &blob)
  */
-  __pyx_t_7 = __Pyx_PyInt_As_PY_LONG_LONG(__pyx_v_rowid); if (unlikely((__pyx_t_7 == (PY_LONG_LONG)-1) && PyErr_Occurred())) __PYX_ERR(0, 1282, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_PY_LONG_LONG(__pyx_v_rowid); if (unlikely((__pyx_t_7 == (PY_LONG_LONG)-1) && PyErr_Occurred())) __PYX_ERR(0, 1281, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1277
+  /* "playhouse/_sqlite_ext.pyx":1276
  *         _check_connection(self.conn)
  * 
  *         rc = sqlite3_blob_open(             # <<<<<<<<<<<<<<
  *             self.conn.db,
  *             'main',
  */
   __pyx_v_rc = sqlite3_blob_open(__pyx_v_self->conn->db, ((char const *)"main"), ((char *)__pyx_t_5), ((char *)__pyx_t_6), ((PY_LONG_LONG)__pyx_t_7), __pyx_v_flags, (&__pyx_v_blob));
 
-  /* "playhouse/_sqlite_ext.pyx":1285
+  /* "playhouse/_sqlite_ext.pyx":1284
  *             flags,
  *             &blob)
  *         if rc != SQLITE_OK:             # <<<<<<<<<<<<<<
  *             raise OperationalError('Unable to open blob.')
  *         if not blob:
  */
   __pyx_t_3 = ((__pyx_v_rc != SQLITE_OK) != 0);
-  if (unlikely(__pyx_t_3)) {
+  if (__pyx_t_3) {
 
-    /* "playhouse/_sqlite_ext.pyx":1286
+    /* "playhouse/_sqlite_ext.pyx":1285
  *             &blob)
  *         if rc != SQLITE_OK:
  *             raise OperationalError('Unable to open blob.')             # <<<<<<<<<<<<<<
  *         if not blob:
  *             raise MemoryError('Unable to allocate blob.')
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_OperationalError); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1286, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_8 = NULL;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
-      __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_1);
-      if (likely(__pyx_t_8)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
-        __Pyx_INCREF(__pyx_t_8);
-        __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_1, function);
-      }
-    }
-    __pyx_t_4 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_8, __pyx_kp_s_Unable_to_open_blob) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_kp_s_Unable_to_open_blob);
-    __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1286, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_OperationalError); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1285, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_Raise(__pyx_t_4, 0, 0, 0);
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1285, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __PYX_ERR(0, 1286, __pyx_L1_error)
+    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __PYX_ERR(0, 1285, __pyx_L1_error)
 
-    /* "playhouse/_sqlite_ext.pyx":1285
+    /* "playhouse/_sqlite_ext.pyx":1284
  *             flags,
  *             &blob)
  *         if rc != SQLITE_OK:             # <<<<<<<<<<<<<<
  *             raise OperationalError('Unable to open blob.')
  *         if not blob:
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1287
+  /* "playhouse/_sqlite_ext.pyx":1286
  *         if rc != SQLITE_OK:
  *             raise OperationalError('Unable to open blob.')
  *         if not blob:             # <<<<<<<<<<<<<<
  *             raise MemoryError('Unable to allocate blob.')
  * 
  */
   __pyx_t_3 = ((!(__pyx_v_blob != 0)) != 0);
-  if (unlikely(__pyx_t_3)) {
+  if (__pyx_t_3) {
 
-    /* "playhouse/_sqlite_ext.pyx":1288
+    /* "playhouse/_sqlite_ext.pyx":1287
  *             raise OperationalError('Unable to open blob.')
  *         if not blob:
  *             raise MemoryError('Unable to allocate blob.')             # <<<<<<<<<<<<<<
  * 
  *         self.pBlob = blob
  */
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__11, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1288, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_Raise(__pyx_t_4, 0, 0, 0);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __PYX_ERR(0, 1288, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__16, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1287, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __PYX_ERR(0, 1287, __pyx_L1_error)
 
-    /* "playhouse/_sqlite_ext.pyx":1287
+    /* "playhouse/_sqlite_ext.pyx":1286
  *         if rc != SQLITE_OK:
  *             raise OperationalError('Unable to open blob.')
  *         if not blob:             # <<<<<<<<<<<<<<
  *             raise MemoryError('Unable to allocate blob.')
  * 
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1290
+  /* "playhouse/_sqlite_ext.pyx":1289
  *             raise MemoryError('Unable to allocate blob.')
  * 
  *         self.pBlob = blob             # <<<<<<<<<<<<<<
  *         self.offset = 0
  * 
  */
   __pyx_v_self->pBlob = __pyx_v_blob;
 
-  /* "playhouse/_sqlite_ext.pyx":1291
+  /* "playhouse/_sqlite_ext.pyx":1290
  * 
  *         self.pBlob = blob
  *         self.offset = 0             # <<<<<<<<<<<<<<
  * 
  *     cdef _close(self):
  */
   __pyx_v_self->offset = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1265
+  /* "playhouse/_sqlite_ext.pyx":1264
  *         sqlite3_blob *pBlob
  * 
  *     def __init__(self, database, table, column, rowid,             # <<<<<<<<<<<<<<
  *                  read_only=False):
  *         cdef:
  */
 
   /* function exit code */
   __pyx_r = 0;
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_8);
   __Pyx_AddTraceback("playhouse._sqlite_ext.Blob.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_btable);
   __Pyx_XDECREF(__pyx_v_bcolumn);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1293
+/* "playhouse/_sqlite_ext.pyx":1292
  *         self.offset = 0
  * 
  *     cdef _close(self):             # <<<<<<<<<<<<<<
  *         if self.pBlob:
  *             sqlite3_blob_close(self.pBlob)
  */
 
 static PyObject *__pyx_f_9playhouse_11_sqlite_ext_4Blob__close(struct __pyx_obj_9playhouse_11_sqlite_ext_Blob *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("_close", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1294
+  /* "playhouse/_sqlite_ext.pyx":1293
  * 
  *     cdef _close(self):
  *         if self.pBlob:             # <<<<<<<<<<<<<<
  *             sqlite3_blob_close(self.pBlob)
  *         self.pBlob = <sqlite3_blob *>0
  */
   __pyx_t_1 = (__pyx_v_self->pBlob != 0);
   if (__pyx_t_1) {
 
-    /* "playhouse/_sqlite_ext.pyx":1295
+    /* "playhouse/_sqlite_ext.pyx":1294
  *     cdef _close(self):
  *         if self.pBlob:
  *             sqlite3_blob_close(self.pBlob)             # <<<<<<<<<<<<<<
  *         self.pBlob = <sqlite3_blob *>0
  * 
  */
-    (void)(sqlite3_blob_close(__pyx_v_self->pBlob));
+    sqlite3_blob_close(__pyx_v_self->pBlob);
 
-    /* "playhouse/_sqlite_ext.pyx":1294
+    /* "playhouse/_sqlite_ext.pyx":1293
  * 
  *     cdef _close(self):
  *         if self.pBlob:             # <<<<<<<<<<<<<<
  *             sqlite3_blob_close(self.pBlob)
  *         self.pBlob = <sqlite3_blob *>0
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1296
+  /* "playhouse/_sqlite_ext.pyx":1295
  *         if self.pBlob:
  *             sqlite3_blob_close(self.pBlob)
  *         self.pBlob = <sqlite3_blob *>0             # <<<<<<<<<<<<<<
  * 
  *     def __dealloc__(self):
  */
   __pyx_v_self->pBlob = ((sqlite3_blob *)0);
 
-  /* "playhouse/_sqlite_ext.pyx":1293
+  /* "playhouse/_sqlite_ext.pyx":1292
  *         self.offset = 0
  * 
  *     cdef _close(self):             # <<<<<<<<<<<<<<
  *         if self.pBlob:
  *             sqlite3_blob_close(self.pBlob)
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1298
+/* "playhouse/_sqlite_ext.pyx":1297
  *         self.pBlob = <sqlite3_blob *>0
  * 
  *     def __dealloc__(self):             # <<<<<<<<<<<<<<
  *         self._close()
  * 
  */
 
@@ -14377,26 +14409,26 @@
 }
 
 static void __pyx_pf_9playhouse_11_sqlite_ext_4Blob_2__dealloc__(struct __pyx_obj_9playhouse_11_sqlite_ext_Blob *__pyx_v_self) {
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   __Pyx_RefNannySetupContext("__dealloc__", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1299
+  /* "playhouse/_sqlite_ext.pyx":1298
  * 
  *     def __dealloc__(self):
  *         self._close()             # <<<<<<<<<<<<<<
  * 
  *     def __len__(self):
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_9playhouse_11_sqlite_ext_Blob *)__pyx_v_self->__pyx_vtab)->_close(__pyx_v_self); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1299, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_9playhouse_11_sqlite_ext_Blob *)__pyx_v_self->__pyx_vtab)->_close(__pyx_v_self); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1298, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1298
+  /* "playhouse/_sqlite_ext.pyx":1297
  *         self.pBlob = <sqlite3_blob *>0
  * 
  *     def __dealloc__(self):             # <<<<<<<<<<<<<<
  *         self._close()
  * 
  */
 
@@ -14405,15 +14437,15 @@
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_WriteUnraisable("playhouse._sqlite_ext.Blob.__dealloc__", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
 }
 
-/* "playhouse/_sqlite_ext.pyx":1301
+/* "playhouse/_sqlite_ext.pyx":1300
  *         self._close()
  * 
  *     def __len__(self):             # <<<<<<<<<<<<<<
  *         _check_blob_closed(self)
  *         return sqlite3_blob_bytes(self.pBlob)
  */
 
@@ -14432,34 +14464,34 @@
 
 static Py_ssize_t __pyx_pf_9playhouse_11_sqlite_ext_4Blob_4__len__(struct __pyx_obj_9playhouse_11_sqlite_ext_Blob *__pyx_v_self) {
   Py_ssize_t __pyx_r;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("__len__", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1302
+  /* "playhouse/_sqlite_ext.pyx":1301
  * 
  *     def __len__(self):
  *         _check_blob_closed(self)             # <<<<<<<<<<<<<<
  *         return sqlite3_blob_bytes(self.pBlob)
  * 
  */
-  __pyx_t_1 = __pyx_f_9playhouse_11_sqlite_ext__check_blob_closed(__pyx_v_self); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 1302, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_9playhouse_11_sqlite_ext__check_blob_closed(__pyx_v_self); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 1301, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1303
+  /* "playhouse/_sqlite_ext.pyx":1302
  *     def __len__(self):
  *         _check_blob_closed(self)
  *         return sqlite3_blob_bytes(self.pBlob)             # <<<<<<<<<<<<<<
  * 
  *     def read(self, n=None):
  */
   __pyx_r = sqlite3_blob_bytes(__pyx_v_self->pBlob);
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1301
+  /* "playhouse/_sqlite_ext.pyx":1300
  *         self._close()
  * 
  *     def __len__(self):             # <<<<<<<<<<<<<<
  *         _check_blob_closed(self)
  *         return sqlite3_blob_bytes(self.pBlob)
  */
 
@@ -14468,15 +14500,15 @@
   __Pyx_AddTraceback("playhouse._sqlite_ext.Blob.__len__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1305
+/* "playhouse/_sqlite_ext.pyx":1304
  *         return sqlite3_blob_bytes(self.pBlob)
  * 
  *     def read(self, n=None):             # <<<<<<<<<<<<<<
  *         cdef:
  *             bytes pybuf
  */
 
@@ -14500,34 +14532,34 @@
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_n);
+          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_n);
           if (value) { values[0] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read") < 0)) __PYX_ERR(0, 1305, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read") < 0)) __PYX_ERR(0, 1304, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_n = values[0];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("read", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1305, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("read", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1304, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("playhouse._sqlite_ext.Blob.read", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_4Blob_6read(((struct __pyx_obj_9playhouse_11_sqlite_ext_Blob *)__pyx_v_self), __pyx_v_n);
 
@@ -14544,75 +14576,74 @@
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   int __pyx_t_3;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
-  PyObject *__pyx_t_6 = NULL;
   __Pyx_RefNannySetupContext("read", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1308
+  /* "playhouse/_sqlite_ext.pyx":1307
  *         cdef:
  *             bytes pybuf
  *             int length = -1             # <<<<<<<<<<<<<<
  *             int size
  *             char *buf
  */
   __pyx_v_length = -1;
 
-  /* "playhouse/_sqlite_ext.pyx":1312
+  /* "playhouse/_sqlite_ext.pyx":1311
  *             char *buf
  * 
  *         if n is not None:             # <<<<<<<<<<<<<<
  *             length = n
  * 
  */
   __pyx_t_1 = (__pyx_v_n != Py_None);
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":1313
+    /* "playhouse/_sqlite_ext.pyx":1312
  * 
  *         if n is not None:
  *             length = n             # <<<<<<<<<<<<<<
  * 
  *         _check_blob_closed(self)
  */
-    __pyx_t_3 = __Pyx_PyInt_As_int(__pyx_v_n); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1313, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_As_int(__pyx_v_n); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1312, __pyx_L1_error)
     __pyx_v_length = __pyx_t_3;
 
-    /* "playhouse/_sqlite_ext.pyx":1312
+    /* "playhouse/_sqlite_ext.pyx":1311
  *             char *buf
  * 
  *         if n is not None:             # <<<<<<<<<<<<<<
  *             length = n
  * 
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1315
+  /* "playhouse/_sqlite_ext.pyx":1314
  *             length = n
  * 
  *         _check_blob_closed(self)             # <<<<<<<<<<<<<<
  *         size = sqlite3_blob_bytes(self.pBlob)
  *         if self.offset == size or length == 0:
  */
-  __pyx_t_3 = __pyx_f_9playhouse_11_sqlite_ext__check_blob_closed(__pyx_v_self); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 1315, __pyx_L1_error)
+  __pyx_t_3 = __pyx_f_9playhouse_11_sqlite_ext__check_blob_closed(__pyx_v_self); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 1314, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1316
+  /* "playhouse/_sqlite_ext.pyx":1315
  * 
  *         _check_blob_closed(self)
  *         size = sqlite3_blob_bytes(self.pBlob)             # <<<<<<<<<<<<<<
  *         if self.offset == size or length == 0:
  *             return b''
  */
   __pyx_v_size = sqlite3_blob_bytes(__pyx_v_self->pBlob);
 
-  /* "playhouse/_sqlite_ext.pyx":1317
+  /* "playhouse/_sqlite_ext.pyx":1316
  *         _check_blob_closed(self)
  *         size = sqlite3_blob_bytes(self.pBlob)
  *         if self.offset == size or length == 0:             # <<<<<<<<<<<<<<
  *             return b''
  * 
  */
   __pyx_t_1 = ((__pyx_v_self->offset == __pyx_v_size) != 0);
@@ -14622,216 +14653,209 @@
     goto __pyx_L5_bool_binop_done;
   }
   __pyx_t_1 = ((__pyx_v_length == 0) != 0);
   __pyx_t_2 = __pyx_t_1;
   __pyx_L5_bool_binop_done:;
   if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":1318
+    /* "playhouse/_sqlite_ext.pyx":1317
  *         size = sqlite3_blob_bytes(self.pBlob)
  *         if self.offset == size or length == 0:
  *             return b''             # <<<<<<<<<<<<<<
  * 
  *         if length < 0:
  */
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_INCREF(__pyx_kp_b__12);
-    __pyx_r = __pyx_kp_b__12;
+    __Pyx_INCREF(__pyx_kp_b__17);
+    __pyx_r = __pyx_kp_b__17;
     goto __pyx_L0;
 
-    /* "playhouse/_sqlite_ext.pyx":1317
+    /* "playhouse/_sqlite_ext.pyx":1316
  *         _check_blob_closed(self)
  *         size = sqlite3_blob_bytes(self.pBlob)
  *         if self.offset == size or length == 0:             # <<<<<<<<<<<<<<
  *             return b''
  * 
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1320
+  /* "playhouse/_sqlite_ext.pyx":1319
  *             return b''
  * 
  *         if length < 0:             # <<<<<<<<<<<<<<
  *             length = size - self.offset
  * 
  */
   __pyx_t_2 = ((__pyx_v_length < 0) != 0);
   if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":1321
+    /* "playhouse/_sqlite_ext.pyx":1320
  * 
  *         if length < 0:
  *             length = size - self.offset             # <<<<<<<<<<<<<<
  * 
  *         if self.offset + length > size:
  */
     __pyx_v_length = (__pyx_v_size - __pyx_v_self->offset);
 
-    /* "playhouse/_sqlite_ext.pyx":1320
+    /* "playhouse/_sqlite_ext.pyx":1319
  *             return b''
  * 
  *         if length < 0:             # <<<<<<<<<<<<<<
  *             length = size - self.offset
  * 
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1323
+  /* "playhouse/_sqlite_ext.pyx":1322
  *             length = size - self.offset
  * 
  *         if self.offset + length > size:             # <<<<<<<<<<<<<<
  *             length = size - self.offset
  * 
  */
   __pyx_t_2 = (((__pyx_v_self->offset + __pyx_v_length) > __pyx_v_size) != 0);
   if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":1324
+    /* "playhouse/_sqlite_ext.pyx":1323
  * 
  *         if self.offset + length > size:
  *             length = size - self.offset             # <<<<<<<<<<<<<<
  * 
  *         pybuf = PyBytes_FromStringAndSize(NULL, length)
  */
     __pyx_v_length = (__pyx_v_size - __pyx_v_self->offset);
 
-    /* "playhouse/_sqlite_ext.pyx":1323
+    /* "playhouse/_sqlite_ext.pyx":1322
  *             length = size - self.offset
  * 
  *         if self.offset + length > size:             # <<<<<<<<<<<<<<
  *             length = size - self.offset
  * 
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1326
+  /* "playhouse/_sqlite_ext.pyx":1325
  *             length = size - self.offset
  * 
  *         pybuf = PyBytes_FromStringAndSize(NULL, length)             # <<<<<<<<<<<<<<
  *         buf = PyBytes_AS_STRING(pybuf)
  *         if sqlite3_blob_read(self.pBlob, buf, length, self.offset):
  */
-  __pyx_t_4 = PyBytes_FromStringAndSize(NULL, __pyx_v_length); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1326, __pyx_L1_error)
+  __pyx_t_4 = PyBytes_FromStringAndSize(NULL, __pyx_v_length); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1325, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_v_pybuf = ((PyObject*)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1327
+  /* "playhouse/_sqlite_ext.pyx":1326
  * 
  *         pybuf = PyBytes_FromStringAndSize(NULL, length)
  *         buf = PyBytes_AS_STRING(pybuf)             # <<<<<<<<<<<<<<
  *         if sqlite3_blob_read(self.pBlob, buf, length, self.offset):
  *             self._close()
  */
   __pyx_v_buf = PyBytes_AS_STRING(__pyx_v_pybuf);
 
-  /* "playhouse/_sqlite_ext.pyx":1328
+  /* "playhouse/_sqlite_ext.pyx":1327
  *         pybuf = PyBytes_FromStringAndSize(NULL, length)
  *         buf = PyBytes_AS_STRING(pybuf)
  *         if sqlite3_blob_read(self.pBlob, buf, length, self.offset):             # <<<<<<<<<<<<<<
  *             self._close()
  *             raise OperationalError('Error reading from blob.')
  */
   __pyx_t_2 = (sqlite3_blob_read(__pyx_v_self->pBlob, __pyx_v_buf, __pyx_v_length, __pyx_v_self->offset) != 0);
-  if (unlikely(__pyx_t_2)) {
+  if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":1329
+    /* "playhouse/_sqlite_ext.pyx":1328
  *         buf = PyBytes_AS_STRING(pybuf)
  *         if sqlite3_blob_read(self.pBlob, buf, length, self.offset):
  *             self._close()             # <<<<<<<<<<<<<<
  *             raise OperationalError('Error reading from blob.')
  * 
  */
-    __pyx_t_4 = ((struct __pyx_vtabstruct_9playhouse_11_sqlite_ext_Blob *)__pyx_v_self->__pyx_vtab)->_close(__pyx_v_self); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1329, __pyx_L1_error)
+    __pyx_t_4 = ((struct __pyx_vtabstruct_9playhouse_11_sqlite_ext_Blob *)__pyx_v_self->__pyx_vtab)->_close(__pyx_v_self); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1328, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":1330
+    /* "playhouse/_sqlite_ext.pyx":1329
  *         if sqlite3_blob_read(self.pBlob, buf, length, self.offset):
  *             self._close()
  *             raise OperationalError('Error reading from blob.')             # <<<<<<<<<<<<<<
  * 
  *         self.offset += length
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_OperationalError); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1330, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = NULL;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
-      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
-      if (likely(__pyx_t_6)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
-        __Pyx_INCREF(__pyx_t_6);
-        __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_5, function);
-      }
-    }
-    __pyx_t_4 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_kp_s_Error_reading_from_blob) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_kp_s_Error_reading_from_blob);
-    __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1330, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_OperationalError); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1329, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __Pyx_Raise(__pyx_t_4, 0, 0, 0);
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__18, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1329, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __PYX_ERR(0, 1330, __pyx_L1_error)
+    __Pyx_Raise(__pyx_t_5, 0, 0, 0);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __PYX_ERR(0, 1329, __pyx_L1_error)
 
-    /* "playhouse/_sqlite_ext.pyx":1328
+    /* "playhouse/_sqlite_ext.pyx":1327
  *         pybuf = PyBytes_FromStringAndSize(NULL, length)
  *         buf = PyBytes_AS_STRING(pybuf)
  *         if sqlite3_blob_read(self.pBlob, buf, length, self.offset):             # <<<<<<<<<<<<<<
  *             self._close()
  *             raise OperationalError('Error reading from blob.')
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1332
+  /* "playhouse/_sqlite_ext.pyx":1331
  *             raise OperationalError('Error reading from blob.')
  * 
  *         self.offset += length             # <<<<<<<<<<<<<<
  *         return bytes(pybuf)
  * 
  */
   __pyx_v_self->offset = (__pyx_v_self->offset + __pyx_v_length);
 
-  /* "playhouse/_sqlite_ext.pyx":1333
+  /* "playhouse/_sqlite_ext.pyx":1332
  * 
  *         self.offset += length
  *         return bytes(pybuf)             # <<<<<<<<<<<<<<
  * 
  *     def seek(self, offset, frame_of_reference=0):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyBytes_Type)), __pyx_v_pybuf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1333, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1332, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_INCREF(__pyx_v_pybuf);
+  __Pyx_GIVEREF(__pyx_v_pybuf);
+  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_pybuf);
+  __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)(&PyBytes_Type)), __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1332, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_r = __pyx_t_4;
   __pyx_t_4 = 0;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1305
+  /* "playhouse/_sqlite_ext.pyx":1304
  *         return sqlite3_blob_bytes(self.pBlob)
  * 
  *     def read(self, n=None):             # <<<<<<<<<<<<<<
  *         cdef:
  *             bytes pybuf
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_6);
   __Pyx_AddTraceback("playhouse._sqlite_ext.Blob.read", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_pybuf);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1335
+/* "playhouse/_sqlite_ext.pyx":1334
  *         return bytes(pybuf)
  * 
  *     def seek(self, offset, frame_of_reference=0):             # <<<<<<<<<<<<<<
  *         cdef int size
  *         _check_blob_closed(self)
  */
 
@@ -14857,25 +14881,25 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_offset)) != 0)) kw_args--;
+        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_offset)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_frame_of_reference);
+          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_frame_of_reference);
           if (value) { values[1] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "seek") < 0)) __PYX_ERR(0, 1335, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "seek") < 0)) __PYX_ERR(0, 1334, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
@@ -14883,15 +14907,15 @@
       }
     }
     __pyx_v_offset = values[0];
     __pyx_v_frame_of_reference = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("seek", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1335, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("seek", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1334, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("playhouse._sqlite_ext.Blob.seek", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_4Blob_8seek(((struct __pyx_obj_9playhouse_11_sqlite_ext_Blob *)__pyx_v_self), __pyx_v_offset, __pyx_v_frame_of_reference);
 
@@ -14908,325 +14932,325 @@
   PyObject *__pyx_t_2 = NULL;
   int __pyx_t_3;
   int __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   __Pyx_RefNannySetupContext("seek", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1337
+  /* "playhouse/_sqlite_ext.pyx":1336
  *     def seek(self, offset, frame_of_reference=0):
  *         cdef int size
  *         _check_blob_closed(self)             # <<<<<<<<<<<<<<
  *         size = sqlite3_blob_bytes(self.pBlob)
  *         if frame_of_reference == 0:
  */
-  __pyx_t_1 = __pyx_f_9playhouse_11_sqlite_ext__check_blob_closed(__pyx_v_self); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 1337, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_9playhouse_11_sqlite_ext__check_blob_closed(__pyx_v_self); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 1336, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1338
+  /* "playhouse/_sqlite_ext.pyx":1337
  *         cdef int size
  *         _check_blob_closed(self)
  *         size = sqlite3_blob_bytes(self.pBlob)             # <<<<<<<<<<<<<<
  *         if frame_of_reference == 0:
  *             if offset < 0 or offset > size:
  */
   __pyx_v_size = sqlite3_blob_bytes(__pyx_v_self->pBlob);
 
-  /* "playhouse/_sqlite_ext.pyx":1339
+  /* "playhouse/_sqlite_ext.pyx":1338
  *         _check_blob_closed(self)
  *         size = sqlite3_blob_bytes(self.pBlob)
  *         if frame_of_reference == 0:             # <<<<<<<<<<<<<<
  *             if offset < 0 or offset > size:
  *                 raise ValueError('seek() offset outside of valid range.')
  */
-  __pyx_t_2 = __Pyx_PyInt_EqObjC(__pyx_v_frame_of_reference, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1339, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_EqObjC(__pyx_v_frame_of_reference, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1338, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 1339, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 1338, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (__pyx_t_3) {
 
-    /* "playhouse/_sqlite_ext.pyx":1340
+    /* "playhouse/_sqlite_ext.pyx":1339
  *         size = sqlite3_blob_bytes(self.pBlob)
  *         if frame_of_reference == 0:
  *             if offset < 0 or offset > size:             # <<<<<<<<<<<<<<
  *                 raise ValueError('seek() offset outside of valid range.')
  *             self.offset = offset
  */
-    __pyx_t_2 = PyObject_RichCompare(__pyx_v_offset, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1340, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1340, __pyx_L1_error)
+    __pyx_t_2 = PyObject_RichCompare(__pyx_v_offset, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1339, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1339, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     if (!__pyx_t_4) {
     } else {
       __pyx_t_3 = __pyx_t_4;
       goto __pyx_L5_bool_binop_done;
     }
-    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1340, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1339, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = PyObject_RichCompare(__pyx_v_offset, __pyx_t_2, Py_GT); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1340, __pyx_L1_error)
+    __pyx_t_5 = PyObject_RichCompare(__pyx_v_offset, __pyx_t_2, Py_GT); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1339, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1340, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1339, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_3 = __pyx_t_4;
     __pyx_L5_bool_binop_done:;
-    if (unlikely(__pyx_t_3)) {
+    if (__pyx_t_3) {
 
-      /* "playhouse/_sqlite_ext.pyx":1341
+      /* "playhouse/_sqlite_ext.pyx":1340
  *         if frame_of_reference == 0:
  *             if offset < 0 or offset > size:
  *                 raise ValueError('seek() offset outside of valid range.')             # <<<<<<<<<<<<<<
  *             self.offset = offset
  *         elif frame_of_reference == 1:
  */
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__13, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1341, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__19, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1340, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_Raise(__pyx_t_5, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __PYX_ERR(0, 1341, __pyx_L1_error)
+      __PYX_ERR(0, 1340, __pyx_L1_error)
 
-      /* "playhouse/_sqlite_ext.pyx":1340
+      /* "playhouse/_sqlite_ext.pyx":1339
  *         size = sqlite3_blob_bytes(self.pBlob)
  *         if frame_of_reference == 0:
  *             if offset < 0 or offset > size:             # <<<<<<<<<<<<<<
  *                 raise ValueError('seek() offset outside of valid range.')
  *             self.offset = offset
  */
     }
 
-    /* "playhouse/_sqlite_ext.pyx":1342
+    /* "playhouse/_sqlite_ext.pyx":1341
  *             if offset < 0 or offset > size:
  *                 raise ValueError('seek() offset outside of valid range.')
  *             self.offset = offset             # <<<<<<<<<<<<<<
  *         elif frame_of_reference == 1:
  *             if self.offset + offset < 0 or self.offset + offset > size:
  */
-    __pyx_t_1 = __Pyx_PyInt_As_int(__pyx_v_offset); if (unlikely((__pyx_t_1 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1342, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_As_int(__pyx_v_offset); if (unlikely((__pyx_t_1 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1341, __pyx_L1_error)
     __pyx_v_self->offset = __pyx_t_1;
 
-    /* "playhouse/_sqlite_ext.pyx":1339
+    /* "playhouse/_sqlite_ext.pyx":1338
  *         _check_blob_closed(self)
  *         size = sqlite3_blob_bytes(self.pBlob)
  *         if frame_of_reference == 0:             # <<<<<<<<<<<<<<
  *             if offset < 0 or offset > size:
  *                 raise ValueError('seek() offset outside of valid range.')
  */
     goto __pyx_L3;
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1343
+  /* "playhouse/_sqlite_ext.pyx":1342
  *                 raise ValueError('seek() offset outside of valid range.')
  *             self.offset = offset
  *         elif frame_of_reference == 1:             # <<<<<<<<<<<<<<
  *             if self.offset + offset < 0 or self.offset + offset > size:
  *                 raise ValueError('seek() offset outside of valid range.')
  */
-  __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_v_frame_of_reference, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1343, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_v_frame_of_reference, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1342, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 1343, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 1342, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   if (__pyx_t_3) {
 
-    /* "playhouse/_sqlite_ext.pyx":1344
+    /* "playhouse/_sqlite_ext.pyx":1343
  *             self.offset = offset
  *         elif frame_of_reference == 1:
  *             if self.offset + offset < 0 or self.offset + offset > size:             # <<<<<<<<<<<<<<
  *                 raise ValueError('seek() offset outside of valid range.')
  *             self.offset += offset
  */
-    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_self->offset); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1344, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_self->offset); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1343, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_2 = PyNumber_Add(__pyx_t_5, __pyx_v_offset); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1344, __pyx_L1_error)
+    __pyx_t_2 = PyNumber_Add(__pyx_t_5, __pyx_v_offset); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1343, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyObject_RichCompare(__pyx_t_2, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1344, __pyx_L1_error)
+    __pyx_t_5 = PyObject_RichCompare(__pyx_t_2, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1343, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1344, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1343, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     if (!__pyx_t_4) {
     } else {
       __pyx_t_3 = __pyx_t_4;
       goto __pyx_L8_bool_binop_done;
     }
-    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_self->offset); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1344, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_self->offset); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1343, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_2 = PyNumber_Add(__pyx_t_5, __pyx_v_offset); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1344, __pyx_L1_error)
+    __pyx_t_2 = PyNumber_Add(__pyx_t_5, __pyx_v_offset); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1343, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1344, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1343, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = PyObject_RichCompare(__pyx_t_2, __pyx_t_5, Py_GT); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1344, __pyx_L1_error)
+    __pyx_t_6 = PyObject_RichCompare(__pyx_t_2, __pyx_t_5, Py_GT); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1343, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1344, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1343, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_3 = __pyx_t_4;
     __pyx_L8_bool_binop_done:;
-    if (unlikely(__pyx_t_3)) {
+    if (__pyx_t_3) {
 
-      /* "playhouse/_sqlite_ext.pyx":1345
+      /* "playhouse/_sqlite_ext.pyx":1344
  *         elif frame_of_reference == 1:
  *             if self.offset + offset < 0 or self.offset + offset > size:
  *                 raise ValueError('seek() offset outside of valid range.')             # <<<<<<<<<<<<<<
  *             self.offset += offset
  *         elif frame_of_reference == 2:
  */
-      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__13, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1345, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1344, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_Raise(__pyx_t_6, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __PYX_ERR(0, 1345, __pyx_L1_error)
+      __PYX_ERR(0, 1344, __pyx_L1_error)
 
-      /* "playhouse/_sqlite_ext.pyx":1344
+      /* "playhouse/_sqlite_ext.pyx":1343
  *             self.offset = offset
  *         elif frame_of_reference == 1:
  *             if self.offset + offset < 0 or self.offset + offset > size:             # <<<<<<<<<<<<<<
  *                 raise ValueError('seek() offset outside of valid range.')
  *             self.offset += offset
  */
     }
 
-    /* "playhouse/_sqlite_ext.pyx":1346
+    /* "playhouse/_sqlite_ext.pyx":1345
  *             if self.offset + offset < 0 or self.offset + offset > size:
  *                 raise ValueError('seek() offset outside of valid range.')
  *             self.offset += offset             # <<<<<<<<<<<<<<
  *         elif frame_of_reference == 2:
  *             if size + offset < 0 or size + offset > size:
  */
-    __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_self->offset); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1346, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_self->offset); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1345, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = PyNumber_InPlaceAdd(__pyx_t_6, __pyx_v_offset); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1346, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_InPlaceAdd(__pyx_t_6, __pyx_v_offset); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1345, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_1 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_1 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1346, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_1 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1345, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_v_self->offset = __pyx_t_1;
 
-    /* "playhouse/_sqlite_ext.pyx":1343
+    /* "playhouse/_sqlite_ext.pyx":1342
  *                 raise ValueError('seek() offset outside of valid range.')
  *             self.offset = offset
  *         elif frame_of_reference == 1:             # <<<<<<<<<<<<<<
  *             if self.offset + offset < 0 or self.offset + offset > size:
  *                 raise ValueError('seek() offset outside of valid range.')
  */
     goto __pyx_L3;
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1347
+  /* "playhouse/_sqlite_ext.pyx":1346
  *                 raise ValueError('seek() offset outside of valid range.')
  *             self.offset += offset
  *         elif frame_of_reference == 2:             # <<<<<<<<<<<<<<
  *             if size + offset < 0 or size + offset > size:
  *                 raise ValueError('seek() offset outside of valid range.')
  */
-  __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_v_frame_of_reference, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1347, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_v_frame_of_reference, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1346, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 1347, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 1346, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (likely(__pyx_t_3)) {
+  if (__pyx_t_3) {
 
-    /* "playhouse/_sqlite_ext.pyx":1348
+    /* "playhouse/_sqlite_ext.pyx":1347
  *             self.offset += offset
  *         elif frame_of_reference == 2:
  *             if size + offset < 0 or size + offset > size:             # <<<<<<<<<<<<<<
  *                 raise ValueError('seek() offset outside of valid range.')
  *             self.offset = size + offset
  */
-    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1348, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1347, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = PyNumber_Add(__pyx_t_5, __pyx_v_offset); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1348, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_Add(__pyx_t_5, __pyx_v_offset); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1347, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyObject_RichCompare(__pyx_t_6, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1348, __pyx_L1_error)
+    __pyx_t_5 = PyObject_RichCompare(__pyx_t_6, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1347, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1348, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1347, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     if (!__pyx_t_4) {
     } else {
       __pyx_t_3 = __pyx_t_4;
       goto __pyx_L11_bool_binop_done;
     }
-    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1348, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1347, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = PyNumber_Add(__pyx_t_5, __pyx_v_offset); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1348, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_Add(__pyx_t_5, __pyx_v_offset); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1347, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1348, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1347, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_2 = PyObject_RichCompare(__pyx_t_6, __pyx_t_5, Py_GT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1348, __pyx_L1_error)
+    __pyx_t_2 = PyObject_RichCompare(__pyx_t_6, __pyx_t_5, Py_GT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1347, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1348, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1347, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_3 = __pyx_t_4;
     __pyx_L11_bool_binop_done:;
-    if (unlikely(__pyx_t_3)) {
+    if (__pyx_t_3) {
 
-      /* "playhouse/_sqlite_ext.pyx":1349
+      /* "playhouse/_sqlite_ext.pyx":1348
  *         elif frame_of_reference == 2:
  *             if size + offset < 0 or size + offset > size:
  *                 raise ValueError('seek() offset outside of valid range.')             # <<<<<<<<<<<<<<
  *             self.offset = size + offset
  *         else:
  */
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__13, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1349, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__21, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1348, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_Raise(__pyx_t_2, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __PYX_ERR(0, 1349, __pyx_L1_error)
+      __PYX_ERR(0, 1348, __pyx_L1_error)
 
-      /* "playhouse/_sqlite_ext.pyx":1348
+      /* "playhouse/_sqlite_ext.pyx":1347
  *             self.offset += offset
  *         elif frame_of_reference == 2:
  *             if size + offset < 0 or size + offset > size:             # <<<<<<<<<<<<<<
  *                 raise ValueError('seek() offset outside of valid range.')
  *             self.offset = size + offset
  */
     }
 
-    /* "playhouse/_sqlite_ext.pyx":1350
+    /* "playhouse/_sqlite_ext.pyx":1349
  *             if size + offset < 0 or size + offset > size:
  *                 raise ValueError('seek() offset outside of valid range.')
  *             self.offset = size + offset             # <<<<<<<<<<<<<<
  *         else:
  *             raise ValueError('seek() frame of reference must be 0, 1 or 2.')
  */
-    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1350, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1349, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = PyNumber_Add(__pyx_t_2, __pyx_v_offset); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1350, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_Add(__pyx_t_2, __pyx_v_offset); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1349, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_1 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_1 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1350, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_1 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1349, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_v_self->offset = __pyx_t_1;
 
-    /* "playhouse/_sqlite_ext.pyx":1347
+    /* "playhouse/_sqlite_ext.pyx":1346
  *                 raise ValueError('seek() offset outside of valid range.')
  *             self.offset += offset
  *         elif frame_of_reference == 2:             # <<<<<<<<<<<<<<
  *             if size + offset < 0 or size + offset > size:
  *                 raise ValueError('seek() offset outside of valid range.')
  */
     goto __pyx_L3;
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1352
+  /* "playhouse/_sqlite_ext.pyx":1351
  *             self.offset = size + offset
  *         else:
  *             raise ValueError('seek() frame of reference must be 0, 1 or 2.')             # <<<<<<<<<<<<<<
  * 
  *     def tell(self):
  */
   /*else*/ {
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__14, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1352, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__22, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1351, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_Raise(__pyx_t_5, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __PYX_ERR(0, 1352, __pyx_L1_error)
+    __PYX_ERR(0, 1351, __pyx_L1_error)
   }
   __pyx_L3:;
 
-  /* "playhouse/_sqlite_ext.pyx":1335
+  /* "playhouse/_sqlite_ext.pyx":1334
  *         return bytes(pybuf)
  * 
  *     def seek(self, offset, frame_of_reference=0):             # <<<<<<<<<<<<<<
  *         cdef int size
  *         _check_blob_closed(self)
  */
 
@@ -15241,15 +15265,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1354
+/* "playhouse/_sqlite_ext.pyx":1353
  *             raise ValueError('seek() frame of reference must be 0, 1 or 2.')
  * 
  *     def tell(self):             # <<<<<<<<<<<<<<
  *         _check_blob_closed(self)
  *         return self.offset
  */
 
@@ -15269,38 +15293,38 @@
 static PyObject *__pyx_pf_9playhouse_11_sqlite_ext_4Blob_10tell(struct __pyx_obj_9playhouse_11_sqlite_ext_Blob *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   __Pyx_RefNannySetupContext("tell", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1355
+  /* "playhouse/_sqlite_ext.pyx":1354
  * 
  *     def tell(self):
  *         _check_blob_closed(self)             # <<<<<<<<<<<<<<
  *         return self.offset
  * 
  */
-  __pyx_t_1 = __pyx_f_9playhouse_11_sqlite_ext__check_blob_closed(__pyx_v_self); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 1355, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_9playhouse_11_sqlite_ext__check_blob_closed(__pyx_v_self); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 1354, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1356
+  /* "playhouse/_sqlite_ext.pyx":1355
  *     def tell(self):
  *         _check_blob_closed(self)
  *         return self.offset             # <<<<<<<<<<<<<<
  * 
  *     def write(self, bytes data):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_self->offset); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1356, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_self->offset); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1355, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1354
+  /* "playhouse/_sqlite_ext.pyx":1353
  *             raise ValueError('seek() frame of reference must be 0, 1 or 2.')
  * 
  *     def tell(self):             # <<<<<<<<<<<<<<
  *         _check_blob_closed(self)
  *         return self.offset
  */
 
@@ -15311,29 +15335,29 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1358
+/* "playhouse/_sqlite_ext.pyx":1357
  *         return self.offset
  * 
  *     def write(self, bytes data):             # <<<<<<<<<<<<<<
  *         cdef:
  *             char *buf
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_4Blob_13write(PyObject *__pyx_v_self, PyObject *__pyx_v_data); /*proto*/
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_4Blob_13write(PyObject *__pyx_v_self, PyObject *__pyx_v_data) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("write (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_data), (&PyBytes_Type), 1, "data", 1))) __PYX_ERR(0, 1358, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_data), (&PyBytes_Type), 1, "data", 1))) __PYX_ERR(0, 1357, __pyx_L1_error)
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_4Blob_12write(((struct __pyx_obj_9playhouse_11_sqlite_ext_Blob *)__pyx_v_self), ((PyObject*)__pyx_v_data));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -15347,188 +15371,174 @@
   Py_ssize_t __pyx_v_buflen;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
-  PyObject *__pyx_t_5 = NULL;
   __Pyx_RefNannySetupContext("write", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1364
+  /* "playhouse/_sqlite_ext.pyx":1363
  *             Py_ssize_t buflen
  * 
  *         _check_blob_closed(self)             # <<<<<<<<<<<<<<
  *         size = sqlite3_blob_bytes(self.pBlob)
  *         PyBytes_AsStringAndSize(data, &buf, &buflen)
  */
-  __pyx_t_1 = __pyx_f_9playhouse_11_sqlite_ext__check_blob_closed(__pyx_v_self); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 1364, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_9playhouse_11_sqlite_ext__check_blob_closed(__pyx_v_self); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 1363, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1365
+  /* "playhouse/_sqlite_ext.pyx":1364
  * 
  *         _check_blob_closed(self)
  *         size = sqlite3_blob_bytes(self.pBlob)             # <<<<<<<<<<<<<<
  *         PyBytes_AsStringAndSize(data, &buf, &buflen)
  *         if (<int>(buflen + self.offset)) < self.offset:
  */
   __pyx_v_size = sqlite3_blob_bytes(__pyx_v_self->pBlob);
 
-  /* "playhouse/_sqlite_ext.pyx":1366
+  /* "playhouse/_sqlite_ext.pyx":1365
  *         _check_blob_closed(self)
  *         size = sqlite3_blob_bytes(self.pBlob)
  *         PyBytes_AsStringAndSize(data, &buf, &buflen)             # <<<<<<<<<<<<<<
  *         if (<int>(buflen + self.offset)) < self.offset:
  *             raise ValueError('Data is too large (integer wrap)')
  */
-  __pyx_t_1 = PyBytes_AsStringAndSize(__pyx_v_data, (&__pyx_v_buf), (&__pyx_v_buflen)); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 1366, __pyx_L1_error)
+  __pyx_t_1 = PyBytes_AsStringAndSize(__pyx_v_data, (&__pyx_v_buf), (&__pyx_v_buflen)); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 1365, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1367
+  /* "playhouse/_sqlite_ext.pyx":1366
  *         size = sqlite3_blob_bytes(self.pBlob)
  *         PyBytes_AsStringAndSize(data, &buf, &buflen)
  *         if (<int>(buflen + self.offset)) < self.offset:             # <<<<<<<<<<<<<<
  *             raise ValueError('Data is too large (integer wrap)')
  *         if (<int>(buflen + self.offset)) > size:
  */
   __pyx_t_2 = ((((int)(__pyx_v_buflen + __pyx_v_self->offset)) < __pyx_v_self->offset) != 0);
-  if (unlikely(__pyx_t_2)) {
+  if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":1368
+    /* "playhouse/_sqlite_ext.pyx":1367
  *         PyBytes_AsStringAndSize(data, &buf, &buflen)
  *         if (<int>(buflen + self.offset)) < self.offset:
  *             raise ValueError('Data is too large (integer wrap)')             # <<<<<<<<<<<<<<
  *         if (<int>(buflen + self.offset)) > size:
  *             raise ValueError('Data would go beyond end of blob')
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1368, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__23, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1367, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(0, 1368, __pyx_L1_error)
+    __PYX_ERR(0, 1367, __pyx_L1_error)
 
-    /* "playhouse/_sqlite_ext.pyx":1367
+    /* "playhouse/_sqlite_ext.pyx":1366
  *         size = sqlite3_blob_bytes(self.pBlob)
  *         PyBytes_AsStringAndSize(data, &buf, &buflen)
  *         if (<int>(buflen + self.offset)) < self.offset:             # <<<<<<<<<<<<<<
  *             raise ValueError('Data is too large (integer wrap)')
  *         if (<int>(buflen + self.offset)) > size:
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1369
+  /* "playhouse/_sqlite_ext.pyx":1368
  *         if (<int>(buflen + self.offset)) < self.offset:
  *             raise ValueError('Data is too large (integer wrap)')
  *         if (<int>(buflen + self.offset)) > size:             # <<<<<<<<<<<<<<
  *             raise ValueError('Data would go beyond end of blob')
  *         if sqlite3_blob_write(self.pBlob, buf, buflen, self.offset):
  */
   __pyx_t_2 = ((((int)(__pyx_v_buflen + __pyx_v_self->offset)) > __pyx_v_size) != 0);
-  if (unlikely(__pyx_t_2)) {
+  if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":1370
+    /* "playhouse/_sqlite_ext.pyx":1369
  *             raise ValueError('Data is too large (integer wrap)')
  *         if (<int>(buflen + self.offset)) > size:
  *             raise ValueError('Data would go beyond end of blob')             # <<<<<<<<<<<<<<
  *         if sqlite3_blob_write(self.pBlob, buf, buflen, self.offset):
  *             raise OperationalError('Error writing to blob.')
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__16, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1370, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__24, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1369, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(0, 1370, __pyx_L1_error)
+    __PYX_ERR(0, 1369, __pyx_L1_error)
 
-    /* "playhouse/_sqlite_ext.pyx":1369
+    /* "playhouse/_sqlite_ext.pyx":1368
  *         if (<int>(buflen + self.offset)) < self.offset:
  *             raise ValueError('Data is too large (integer wrap)')
  *         if (<int>(buflen + self.offset)) > size:             # <<<<<<<<<<<<<<
  *             raise ValueError('Data would go beyond end of blob')
  *         if sqlite3_blob_write(self.pBlob, buf, buflen, self.offset):
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1371
+  /* "playhouse/_sqlite_ext.pyx":1370
  *         if (<int>(buflen + self.offset)) > size:
  *             raise ValueError('Data would go beyond end of blob')
  *         if sqlite3_blob_write(self.pBlob, buf, buflen, self.offset):             # <<<<<<<<<<<<<<
  *             raise OperationalError('Error writing to blob.')
  *         self.offset += <int>buflen
  */
   __pyx_t_2 = (sqlite3_blob_write(__pyx_v_self->pBlob, __pyx_v_buf, __pyx_v_buflen, __pyx_v_self->offset) != 0);
-  if (unlikely(__pyx_t_2)) {
+  if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":1372
+    /* "playhouse/_sqlite_ext.pyx":1371
  *             raise ValueError('Data would go beyond end of blob')
  *         if sqlite3_blob_write(self.pBlob, buf, buflen, self.offset):
  *             raise OperationalError('Error writing to blob.')             # <<<<<<<<<<<<<<
  *         self.offset += <int>buflen
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_OperationalError); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1372, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = NULL;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
-      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
-      if (likely(__pyx_t_5)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
-        __Pyx_INCREF(__pyx_t_5);
-        __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_4, function);
-      }
-    }
-    __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_kp_s_Error_writing_to_blob) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_kp_s_Error_writing_to_blob);
-    __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1372, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_OperationalError); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1371, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__25, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1371, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(0, 1372, __pyx_L1_error)
+    __Pyx_Raise(__pyx_t_4, 0, 0, 0);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __PYX_ERR(0, 1371, __pyx_L1_error)
 
-    /* "playhouse/_sqlite_ext.pyx":1371
+    /* "playhouse/_sqlite_ext.pyx":1370
  *         if (<int>(buflen + self.offset)) > size:
  *             raise ValueError('Data would go beyond end of blob')
  *         if sqlite3_blob_write(self.pBlob, buf, buflen, self.offset):             # <<<<<<<<<<<<<<
  *             raise OperationalError('Error writing to blob.')
  *         self.offset += <int>buflen
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1373
+  /* "playhouse/_sqlite_ext.pyx":1372
  *         if sqlite3_blob_write(self.pBlob, buf, buflen, self.offset):
  *             raise OperationalError('Error writing to blob.')
  *         self.offset += <int>buflen             # <<<<<<<<<<<<<<
  * 
  *     def close(self):
  */
   __pyx_v_self->offset = (__pyx_v_self->offset + ((int)__pyx_v_buflen));
 
-  /* "playhouse/_sqlite_ext.pyx":1358
+  /* "playhouse/_sqlite_ext.pyx":1357
  *         return self.offset
  * 
  *     def write(self, bytes data):             # <<<<<<<<<<<<<<
  *         cdef:
  *             char *buf
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_5);
   __Pyx_AddTraceback("playhouse._sqlite_ext.Blob.write", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1375
+/* "playhouse/_sqlite_ext.pyx":1374
  *         self.offset += <int>buflen
  * 
  *     def close(self):             # <<<<<<<<<<<<<<
  *         self._close()
  * 
  */
 
@@ -15547,26 +15557,26 @@
 
 static PyObject *__pyx_pf_9playhouse_11_sqlite_ext_4Blob_14close(struct __pyx_obj_9playhouse_11_sqlite_ext_Blob *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   __Pyx_RefNannySetupContext("close", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1376
+  /* "playhouse/_sqlite_ext.pyx":1375
  * 
  *     def close(self):
  *         self._close()             # <<<<<<<<<<<<<<
  * 
  *     def reopen(self, rowid):
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_9playhouse_11_sqlite_ext_Blob *)__pyx_v_self->__pyx_vtab)->_close(__pyx_v_self); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1376, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_9playhouse_11_sqlite_ext_Blob *)__pyx_v_self->__pyx_vtab)->_close(__pyx_v_self); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1375, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1375
+  /* "playhouse/_sqlite_ext.pyx":1374
  *         self.offset += <int>buflen
  * 
  *     def close(self):             # <<<<<<<<<<<<<<
  *         self._close()
  * 
  */
 
@@ -15579,15 +15589,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1378
+/* "playhouse/_sqlite_ext.pyx":1377
  *         self._close()
  * 
  *     def reopen(self, rowid):             # <<<<<<<<<<<<<<
  *         _check_blob_closed(self)
  *         self.offset = 0
  */
 
@@ -15608,109 +15618,95 @@
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   PY_LONG_LONG __pyx_t_2;
   int __pyx_t_3;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
-  PyObject *__pyx_t_6 = NULL;
   __Pyx_RefNannySetupContext("reopen", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1379
+  /* "playhouse/_sqlite_ext.pyx":1378
  * 
  *     def reopen(self, rowid):
  *         _check_blob_closed(self)             # <<<<<<<<<<<<<<
  *         self.offset = 0
  *         if sqlite3_blob_reopen(self.pBlob, <long long>rowid):
  */
-  __pyx_t_1 = __pyx_f_9playhouse_11_sqlite_ext__check_blob_closed(__pyx_v_self); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 1379, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_9playhouse_11_sqlite_ext__check_blob_closed(__pyx_v_self); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 1378, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1380
+  /* "playhouse/_sqlite_ext.pyx":1379
  *     def reopen(self, rowid):
  *         _check_blob_closed(self)
  *         self.offset = 0             # <<<<<<<<<<<<<<
  *         if sqlite3_blob_reopen(self.pBlob, <long long>rowid):
  *             self._close()
  */
   __pyx_v_self->offset = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1381
+  /* "playhouse/_sqlite_ext.pyx":1380
  *         _check_blob_closed(self)
  *         self.offset = 0
  *         if sqlite3_blob_reopen(self.pBlob, <long long>rowid):             # <<<<<<<<<<<<<<
  *             self._close()
  *             raise OperationalError('Unable to re-open blob.')
  */
-  __pyx_t_2 = __Pyx_PyInt_As_PY_LONG_LONG(__pyx_v_rowid); if (unlikely((__pyx_t_2 == (PY_LONG_LONG)-1) && PyErr_Occurred())) __PYX_ERR(0, 1381, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_As_PY_LONG_LONG(__pyx_v_rowid); if (unlikely((__pyx_t_2 == (PY_LONG_LONG)-1) && PyErr_Occurred())) __PYX_ERR(0, 1380, __pyx_L1_error)
   __pyx_t_3 = (sqlite3_blob_reopen(__pyx_v_self->pBlob, ((PY_LONG_LONG)__pyx_t_2)) != 0);
-  if (unlikely(__pyx_t_3)) {
+  if (__pyx_t_3) {
 
-    /* "playhouse/_sqlite_ext.pyx":1382
+    /* "playhouse/_sqlite_ext.pyx":1381
  *         self.offset = 0
  *         if sqlite3_blob_reopen(self.pBlob, <long long>rowid):
  *             self._close()             # <<<<<<<<<<<<<<
  *             raise OperationalError('Unable to re-open blob.')
  * 
  */
-    __pyx_t_4 = ((struct __pyx_vtabstruct_9playhouse_11_sqlite_ext_Blob *)__pyx_v_self->__pyx_vtab)->_close(__pyx_v_self); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1382, __pyx_L1_error)
+    __pyx_t_4 = ((struct __pyx_vtabstruct_9playhouse_11_sqlite_ext_Blob *)__pyx_v_self->__pyx_vtab)->_close(__pyx_v_self); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1381, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":1383
+    /* "playhouse/_sqlite_ext.pyx":1382
  *         if sqlite3_blob_reopen(self.pBlob, <long long>rowid):
  *             self._close()
  *             raise OperationalError('Unable to re-open blob.')             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_OperationalError); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1383, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = NULL;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
-      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
-      if (likely(__pyx_t_6)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
-        __Pyx_INCREF(__pyx_t_6);
-        __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_5, function);
-      }
-    }
-    __pyx_t_4 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_kp_s_Unable_to_re_open_blob) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_kp_s_Unable_to_re_open_blob);
-    __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1383, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_OperationalError); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1382, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __Pyx_Raise(__pyx_t_4, 0, 0, 0);
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1382, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __PYX_ERR(0, 1383, __pyx_L1_error)
+    __Pyx_Raise(__pyx_t_5, 0, 0, 0);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __PYX_ERR(0, 1382, __pyx_L1_error)
 
-    /* "playhouse/_sqlite_ext.pyx":1381
+    /* "playhouse/_sqlite_ext.pyx":1380
  *         _check_blob_closed(self)
  *         self.offset = 0
  *         if sqlite3_blob_reopen(self.pBlob, <long long>rowid):             # <<<<<<<<<<<<<<
  *             self._close()
  *             raise OperationalError('Unable to re-open blob.')
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1378
+  /* "playhouse/_sqlite_ext.pyx":1377
  *         self._close()
  * 
  *     def reopen(self, rowid):             # <<<<<<<<<<<<<<
  *         _check_blob_closed(self)
  *         self.offset = 0
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_6);
   __Pyx_AddTraceback("playhouse._sqlite_ext.Blob.reopen", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
@@ -15742,15 +15738,15 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("self.conn,self.pBlob cannot be converted to a Python object for pickling")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("self.conn,self.pBlob cannot be converted to a Python object for pickling")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__27, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(1, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
@@ -15795,15 +15791,15 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("self.conn,self.pBlob cannot be converted to a Python object for pickling")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("self.conn,self.pBlob cannot be converted to a Python object for pickling")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__18, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(1, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
@@ -15818,15 +15814,15 @@
   __Pyx_AddTraceback("playhouse._sqlite_ext.Blob.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1386
+/* "playhouse/_sqlite_ext.pyx":1385
  * 
  * 
  * def sqlite_get_status(flag):             # <<<<<<<<<<<<<<
  *     cdef:
  *         int current, highwater, rc
  */
 
@@ -15853,87 +15849,92 @@
   int __pyx_t_1;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   __Pyx_RefNannySetupContext("sqlite_get_status", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1390
+  /* "playhouse/_sqlite_ext.pyx":1389
  *         int current, highwater, rc
  * 
  *     rc = sqlite3_status(flag, &current, &highwater, 0)             # <<<<<<<<<<<<<<
  *     if rc == SQLITE_OK:
  *         return (current, highwater)
  */
-  __pyx_t_1 = __Pyx_PyInt_As_int(__pyx_v_flag); if (unlikely((__pyx_t_1 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1390, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_As_int(__pyx_v_flag); if (unlikely((__pyx_t_1 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1389, __pyx_L1_error)
   __pyx_v_rc = sqlite3_status(__pyx_t_1, (&__pyx_v_current), (&__pyx_v_highwater), 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1391
+  /* "playhouse/_sqlite_ext.pyx":1390
  * 
  *     rc = sqlite3_status(flag, &current, &highwater, 0)
  *     if rc == SQLITE_OK:             # <<<<<<<<<<<<<<
  *         return (current, highwater)
  *     raise Exception('Error requesting status: %s' % rc)
  */
   __pyx_t_2 = ((__pyx_v_rc == SQLITE_OK) != 0);
   if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":1392
+    /* "playhouse/_sqlite_ext.pyx":1391
  *     rc = sqlite3_status(flag, &current, &highwater, 0)
  *     if rc == SQLITE_OK:
  *         return (current, highwater)             # <<<<<<<<<<<<<<
  *     raise Exception('Error requesting status: %s' % rc)
  * 
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_current); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1392, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_current); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1391, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_highwater); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1392, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_highwater); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1391, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1392, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1391, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
     __pyx_t_3 = 0;
     __pyx_t_4 = 0;
     __pyx_r = __pyx_t_5;
     __pyx_t_5 = 0;
     goto __pyx_L0;
 
-    /* "playhouse/_sqlite_ext.pyx":1391
+    /* "playhouse/_sqlite_ext.pyx":1390
  * 
  *     rc = sqlite3_status(flag, &current, &highwater, 0)
  *     if rc == SQLITE_OK:             # <<<<<<<<<<<<<<
  *         return (current, highwater)
  *     raise Exception('Error requesting status: %s' % rc)
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1393
+  /* "playhouse/_sqlite_ext.pyx":1392
  *     if rc == SQLITE_OK:
  *         return (current, highwater)
  *     raise Exception('Error requesting status: %s' % rc)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_rc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1393, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_rc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1392, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_Error_requesting_status_s, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1393, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_Error_requesting_status_s, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1392, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_CallOneArg(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])), __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1393, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1392, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_Raise(__pyx_t_5, 0, 0, 0);
+  __Pyx_GIVEREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
+  __pyx_t_4 = 0;
+  __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])), __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1392, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __PYX_ERR(0, 1393, __pyx_L1_error)
+  __Pyx_Raise(__pyx_t_4, 0, 0, 0);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __PYX_ERR(0, 1392, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1386
+  /* "playhouse/_sqlite_ext.pyx":1385
  * 
  * 
  * def sqlite_get_status(flag):             # <<<<<<<<<<<<<<
  *     cdef:
  *         int current, highwater, rc
  */
 
@@ -15946,25 +15947,25 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1396
+/* "playhouse/_sqlite_ext.pyx":1395
  * 
  * 
  * def sqlite_get_db_status(conn, flag):             # <<<<<<<<<<<<<<
  *     cdef:
  *         int current, highwater, rc
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_27sqlite_get_db_status(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_27sqlite_get_db_status = {"sqlite_get_db_status", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_27sqlite_get_db_status, METH_VARARGS|METH_KEYWORDS, 0};
+static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_27sqlite_get_db_status = {"sqlite_get_db_status", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_27sqlite_get_db_status, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_27sqlite_get_db_status(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_conn = 0;
   PyObject *__pyx_v_flag = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("sqlite_get_db_status (wrapper)", 0);
   {
@@ -15980,38 +15981,38 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_conn)) != 0)) kw_args--;
+        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_conn)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_flag)) != 0)) kw_args--;
+        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("sqlite_get_db_status", 1, 2, 2, 1); __PYX_ERR(0, 1396, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("sqlite_get_db_status", 1, 2, 2, 1); __PYX_ERR(0, 1395, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "sqlite_get_db_status") < 0)) __PYX_ERR(0, 1396, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "sqlite_get_db_status") < 0)) __PYX_ERR(0, 1395, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_conn = values[0];
     __pyx_v_flag = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("sqlite_get_db_status", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1396, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("sqlite_get_db_status", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1395, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("playhouse._sqlite_ext.sqlite_get_db_status", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_26sqlite_get_db_status(__pyx_self, __pyx_v_conn, __pyx_v_flag);
 
@@ -16030,96 +16031,101 @@
   int __pyx_t_1;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   __Pyx_RefNannySetupContext("sqlite_get_db_status", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1399
+  /* "playhouse/_sqlite_ext.pyx":1398
  *     cdef:
  *         int current, highwater, rc
  *         pysqlite_Connection *c_conn = <pysqlite_Connection *>conn             # <<<<<<<<<<<<<<
  * 
  *     rc = sqlite3_db_status(c_conn.db, flag, &current, &highwater, 0)
  */
   __pyx_v_c_conn = ((pysqlite_Connection *)__pyx_v_conn);
 
-  /* "playhouse/_sqlite_ext.pyx":1401
+  /* "playhouse/_sqlite_ext.pyx":1400
  *         pysqlite_Connection *c_conn = <pysqlite_Connection *>conn
  * 
  *     rc = sqlite3_db_status(c_conn.db, flag, &current, &highwater, 0)             # <<<<<<<<<<<<<<
  *     if rc == SQLITE_OK:
  *         return (current, highwater)
  */
-  __pyx_t_1 = __Pyx_PyInt_As_int(__pyx_v_flag); if (unlikely((__pyx_t_1 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1401, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_As_int(__pyx_v_flag); if (unlikely((__pyx_t_1 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1400, __pyx_L1_error)
   __pyx_v_rc = sqlite3_db_status(__pyx_v_c_conn->db, __pyx_t_1, (&__pyx_v_current), (&__pyx_v_highwater), 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1402
+  /* "playhouse/_sqlite_ext.pyx":1401
  * 
  *     rc = sqlite3_db_status(c_conn.db, flag, &current, &highwater, 0)
  *     if rc == SQLITE_OK:             # <<<<<<<<<<<<<<
  *         return (current, highwater)
  *     raise Exception('Error requesting db status: %s' % rc)
  */
   __pyx_t_2 = ((__pyx_v_rc == SQLITE_OK) != 0);
   if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":1403
+    /* "playhouse/_sqlite_ext.pyx":1402
  *     rc = sqlite3_db_status(c_conn.db, flag, &current, &highwater, 0)
  *     if rc == SQLITE_OK:
  *         return (current, highwater)             # <<<<<<<<<<<<<<
  *     raise Exception('Error requesting db status: %s' % rc)
  * 
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_current); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1403, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_current); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1402, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_highwater); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1403, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_highwater); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1402, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1403, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1402, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
     __pyx_t_3 = 0;
     __pyx_t_4 = 0;
     __pyx_r = __pyx_t_5;
     __pyx_t_5 = 0;
     goto __pyx_L0;
 
-    /* "playhouse/_sqlite_ext.pyx":1402
+    /* "playhouse/_sqlite_ext.pyx":1401
  * 
  *     rc = sqlite3_db_status(c_conn.db, flag, &current, &highwater, 0)
  *     if rc == SQLITE_OK:             # <<<<<<<<<<<<<<
  *         return (current, highwater)
  *     raise Exception('Error requesting db status: %s' % rc)
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1404
+  /* "playhouse/_sqlite_ext.pyx":1403
  *     if rc == SQLITE_OK:
  *         return (current, highwater)
  *     raise Exception('Error requesting db status: %s' % rc)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_rc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1404, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_rc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1403, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_Error_requesting_db_status_s, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1404, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_Error_requesting_db_status_s, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1403, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_CallOneArg(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])), __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1404, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1403, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_Raise(__pyx_t_5, 0, 0, 0);
+  __Pyx_GIVEREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
+  __pyx_t_4 = 0;
+  __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])), __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1403, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __PYX_ERR(0, 1404, __pyx_L1_error)
+  __Pyx_Raise(__pyx_t_4, 0, 0, 0);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __PYX_ERR(0, 1403, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1396
+  /* "playhouse/_sqlite_ext.pyx":1395
  * 
  * 
  * def sqlite_get_db_status(conn, flag):             # <<<<<<<<<<<<<<
  *     cdef:
  *         int current, highwater, rc
  */
 
@@ -16132,15 +16138,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1412
+/* "playhouse/_sqlite_ext.pyx":1411
  *         pysqlite_Connection *conn
  * 
  *     def __init__(self, connection):             # <<<<<<<<<<<<<<
  *         self.conn = <pysqlite_Connection *>connection
  *         self._commit_hook = self._rollback_hook = self._update_hook = None
  */
 
@@ -16162,30 +16168,30 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_connection)) != 0)) kw_args--;
+        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_connection)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 1412, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 1411, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
     }
     __pyx_v_connection = values[0];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1412, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1411, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("playhouse._sqlite_ext.ConnectionHelper.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_16ConnectionHelper___init__(((struct __pyx_obj_9playhouse_11_sqlite_ext_ConnectionHelper *)__pyx_v_self), __pyx_v_connection);
 
@@ -16195,24 +16201,24 @@
 }
 
 static int __pyx_pf_9playhouse_11_sqlite_ext_16ConnectionHelper___init__(struct __pyx_obj_9playhouse_11_sqlite_ext_ConnectionHelper *__pyx_v_self, PyObject *__pyx_v_connection) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1413
+  /* "playhouse/_sqlite_ext.pyx":1412
  * 
  *     def __init__(self, connection):
  *         self.conn = <pysqlite_Connection *>connection             # <<<<<<<<<<<<<<
  *         self._commit_hook = self._rollback_hook = self._update_hook = None
  * 
  */
   __pyx_v_self->conn = ((pysqlite_Connection *)__pyx_v_connection);
 
-  /* "playhouse/_sqlite_ext.pyx":1414
+  /* "playhouse/_sqlite_ext.pyx":1413
  *     def __init__(self, connection):
  *         self.conn = <pysqlite_Connection *>connection
  *         self._commit_hook = self._rollback_hook = self._update_hook = None             # <<<<<<<<<<<<<<
  * 
  *     def __dealloc__(self):
  */
   __Pyx_INCREF(Py_None);
@@ -16227,29 +16233,29 @@
   __pyx_v_self->_rollback_hook = Py_None;
   __Pyx_INCREF(Py_None);
   __Pyx_GIVEREF(Py_None);
   __Pyx_GOTREF(__pyx_v_self->_update_hook);
   __Pyx_DECREF(__pyx_v_self->_update_hook);
   __pyx_v_self->_update_hook = Py_None;
 
-  /* "playhouse/_sqlite_ext.pyx":1412
+  /* "playhouse/_sqlite_ext.pyx":1411
  *         pysqlite_Connection *conn
  * 
  *     def __init__(self, connection):             # <<<<<<<<<<<<<<
  *         self.conn = <pysqlite_Connection *>connection
  *         self._commit_hook = self._rollback_hook = self._update_hook = None
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1416
+/* "playhouse/_sqlite_ext.pyx":1415
  *         self._commit_hook = self._rollback_hook = self._update_hook = None
  * 
  *     def __dealloc__(self):             # <<<<<<<<<<<<<<
  *         # When deallocating a Database object, we need to ensure that we clear
  *         # any commit, rollback or update hooks that may have been applied.
  */
 
@@ -16266,15 +16272,15 @@
 
 static void __pyx_pf_9playhouse_11_sqlite_ext_16ConnectionHelper_2__dealloc__(struct __pyx_obj_9playhouse_11_sqlite_ext_ConnectionHelper *__pyx_v_self) {
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   __Pyx_RefNannySetupContext("__dealloc__", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1419
+  /* "playhouse/_sqlite_ext.pyx":1418
  *         # When deallocating a Database object, we need to ensure that we clear
  *         # any commit, rollback or update hooks that may have been applied.
  *         if not self.conn.initialized or not self.conn.db:             # <<<<<<<<<<<<<<
  *             return
  * 
  */
   __pyx_t_2 = ((!(__pyx_v_self->conn->initialized != 0)) != 0);
@@ -16284,133 +16290,133 @@
     goto __pyx_L4_bool_binop_done;
   }
   __pyx_t_2 = ((!(__pyx_v_self->conn->db != 0)) != 0);
   __pyx_t_1 = __pyx_t_2;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "playhouse/_sqlite_ext.pyx":1420
+    /* "playhouse/_sqlite_ext.pyx":1419
  *         # any commit, rollback or update hooks that may have been applied.
  *         if not self.conn.initialized or not self.conn.db:
  *             return             # <<<<<<<<<<<<<<
  * 
  *         if self._commit_hook is not None:
  */
     goto __pyx_L0;
 
-    /* "playhouse/_sqlite_ext.pyx":1419
+    /* "playhouse/_sqlite_ext.pyx":1418
  *         # When deallocating a Database object, we need to ensure that we clear
  *         # any commit, rollback or update hooks that may have been applied.
  *         if not self.conn.initialized or not self.conn.db:             # <<<<<<<<<<<<<<
  *             return
  * 
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1422
+  /* "playhouse/_sqlite_ext.pyx":1421
  *             return
  * 
  *         if self._commit_hook is not None:             # <<<<<<<<<<<<<<
  *             sqlite3_commit_hook(self.conn.db, NULL, NULL)
  *         if self._rollback_hook is not None:
  */
   __pyx_t_1 = (__pyx_v_self->_commit_hook != Py_None);
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":1423
+    /* "playhouse/_sqlite_ext.pyx":1422
  * 
  *         if self._commit_hook is not None:
  *             sqlite3_commit_hook(self.conn.db, NULL, NULL)             # <<<<<<<<<<<<<<
  *         if self._rollback_hook is not None:
  *             sqlite3_rollback_hook(self.conn.db, NULL, NULL)
  */
-    (void)(sqlite3_commit_hook(__pyx_v_self->conn->db, NULL, NULL));
+    sqlite3_commit_hook(__pyx_v_self->conn->db, NULL, NULL);
 
-    /* "playhouse/_sqlite_ext.pyx":1422
+    /* "playhouse/_sqlite_ext.pyx":1421
  *             return
  * 
  *         if self._commit_hook is not None:             # <<<<<<<<<<<<<<
  *             sqlite3_commit_hook(self.conn.db, NULL, NULL)
  *         if self._rollback_hook is not None:
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1424
+  /* "playhouse/_sqlite_ext.pyx":1423
  *         if self._commit_hook is not None:
  *             sqlite3_commit_hook(self.conn.db, NULL, NULL)
  *         if self._rollback_hook is not None:             # <<<<<<<<<<<<<<
  *             sqlite3_rollback_hook(self.conn.db, NULL, NULL)
  *         if self._update_hook is not None:
  */
   __pyx_t_2 = (__pyx_v_self->_rollback_hook != Py_None);
   __pyx_t_1 = (__pyx_t_2 != 0);
   if (__pyx_t_1) {
 
-    /* "playhouse/_sqlite_ext.pyx":1425
+    /* "playhouse/_sqlite_ext.pyx":1424
  *             sqlite3_commit_hook(self.conn.db, NULL, NULL)
  *         if self._rollback_hook is not None:
  *             sqlite3_rollback_hook(self.conn.db, NULL, NULL)             # <<<<<<<<<<<<<<
  *         if self._update_hook is not None:
  *             sqlite3_update_hook(self.conn.db, NULL, NULL)
  */
-    (void)(sqlite3_rollback_hook(__pyx_v_self->conn->db, NULL, NULL));
+    sqlite3_rollback_hook(__pyx_v_self->conn->db, NULL, NULL);
 
-    /* "playhouse/_sqlite_ext.pyx":1424
+    /* "playhouse/_sqlite_ext.pyx":1423
  *         if self._commit_hook is not None:
  *             sqlite3_commit_hook(self.conn.db, NULL, NULL)
  *         if self._rollback_hook is not None:             # <<<<<<<<<<<<<<
  *             sqlite3_rollback_hook(self.conn.db, NULL, NULL)
  *         if self._update_hook is not None:
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1426
+  /* "playhouse/_sqlite_ext.pyx":1425
  *         if self._rollback_hook is not None:
  *             sqlite3_rollback_hook(self.conn.db, NULL, NULL)
  *         if self._update_hook is not None:             # <<<<<<<<<<<<<<
  *             sqlite3_update_hook(self.conn.db, NULL, NULL)
  * 
  */
   __pyx_t_1 = (__pyx_v_self->_update_hook != Py_None);
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":1427
+    /* "playhouse/_sqlite_ext.pyx":1426
  *             sqlite3_rollback_hook(self.conn.db, NULL, NULL)
  *         if self._update_hook is not None:
  *             sqlite3_update_hook(self.conn.db, NULL, NULL)             # <<<<<<<<<<<<<<
  * 
  *     def set_commit_hook(self, fn):
  */
-    (void)(sqlite3_update_hook(__pyx_v_self->conn->db, NULL, NULL));
+    sqlite3_update_hook(__pyx_v_self->conn->db, NULL, NULL);
 
-    /* "playhouse/_sqlite_ext.pyx":1426
+    /* "playhouse/_sqlite_ext.pyx":1425
  *         if self._rollback_hook is not None:
  *             sqlite3_rollback_hook(self.conn.db, NULL, NULL)
  *         if self._update_hook is not None:             # <<<<<<<<<<<<<<
  *             sqlite3_update_hook(self.conn.db, NULL, NULL)
  * 
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1416
+  /* "playhouse/_sqlite_ext.pyx":1415
  *         self._commit_hook = self._rollback_hook = self._update_hook = None
  * 
  *     def __dealloc__(self):             # <<<<<<<<<<<<<<
  *         # When deallocating a Database object, we need to ensure that we clear
  *         # any commit, rollback or update hooks that may have been applied.
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
 }
 
-/* "playhouse/_sqlite_ext.pyx":1429
+/* "playhouse/_sqlite_ext.pyx":1428
  *             sqlite3_update_hook(self.conn.db, NULL, NULL)
  * 
  *     def set_commit_hook(self, fn):             # <<<<<<<<<<<<<<
  *         self._commit_hook = fn
  *         if fn is None:
  */
 
@@ -16430,85 +16436,85 @@
 static PyObject *__pyx_pf_9playhouse_11_sqlite_ext_16ConnectionHelper_4set_commit_hook(struct __pyx_obj_9playhouse_11_sqlite_ext_ConnectionHelper *__pyx_v_self, PyObject *__pyx_v_fn) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   __Pyx_RefNannySetupContext("set_commit_hook", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1430
+  /* "playhouse/_sqlite_ext.pyx":1429
  * 
  *     def set_commit_hook(self, fn):
  *         self._commit_hook = fn             # <<<<<<<<<<<<<<
  *         if fn is None:
  *             sqlite3_commit_hook(self.conn.db, NULL, NULL)
  */
   __Pyx_INCREF(__pyx_v_fn);
   __Pyx_GIVEREF(__pyx_v_fn);
   __Pyx_GOTREF(__pyx_v_self->_commit_hook);
   __Pyx_DECREF(__pyx_v_self->_commit_hook);
   __pyx_v_self->_commit_hook = __pyx_v_fn;
 
-  /* "playhouse/_sqlite_ext.pyx":1431
+  /* "playhouse/_sqlite_ext.pyx":1430
  *     def set_commit_hook(self, fn):
  *         self._commit_hook = fn
  *         if fn is None:             # <<<<<<<<<<<<<<
  *             sqlite3_commit_hook(self.conn.db, NULL, NULL)
  *         else:
  */
   __pyx_t_1 = (__pyx_v_fn == Py_None);
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":1432
+    /* "playhouse/_sqlite_ext.pyx":1431
  *         self._commit_hook = fn
  *         if fn is None:
  *             sqlite3_commit_hook(self.conn.db, NULL, NULL)             # <<<<<<<<<<<<<<
  *         else:
  *             sqlite3_commit_hook(self.conn.db, _commit_callback, <void *>fn)
  */
-    (void)(sqlite3_commit_hook(__pyx_v_self->conn->db, NULL, NULL));
+    sqlite3_commit_hook(__pyx_v_self->conn->db, NULL, NULL);
 
-    /* "playhouse/_sqlite_ext.pyx":1431
+    /* "playhouse/_sqlite_ext.pyx":1430
  *     def set_commit_hook(self, fn):
  *         self._commit_hook = fn
  *         if fn is None:             # <<<<<<<<<<<<<<
  *             sqlite3_commit_hook(self.conn.db, NULL, NULL)
  *         else:
  */
     goto __pyx_L3;
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1434
+  /* "playhouse/_sqlite_ext.pyx":1433
  *             sqlite3_commit_hook(self.conn.db, NULL, NULL)
  *         else:
  *             sqlite3_commit_hook(self.conn.db, _commit_callback, <void *>fn)             # <<<<<<<<<<<<<<
  * 
  *     def set_rollback_hook(self, fn):
  */
   /*else*/ {
-    (void)(sqlite3_commit_hook(__pyx_v_self->conn->db, __pyx_f_9playhouse_11_sqlite_ext__commit_callback, ((void *)__pyx_v_fn)));
+    sqlite3_commit_hook(__pyx_v_self->conn->db, __pyx_f_9playhouse_11_sqlite_ext__commit_callback, ((void *)__pyx_v_fn));
   }
   __pyx_L3:;
 
-  /* "playhouse/_sqlite_ext.pyx":1429
+  /* "playhouse/_sqlite_ext.pyx":1428
  *             sqlite3_update_hook(self.conn.db, NULL, NULL)
  * 
  *     def set_commit_hook(self, fn):             # <<<<<<<<<<<<<<
  *         self._commit_hook = fn
  *         if fn is None:
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1436
+/* "playhouse/_sqlite_ext.pyx":1435
  *             sqlite3_commit_hook(self.conn.db, _commit_callback, <void *>fn)
  * 
  *     def set_rollback_hook(self, fn):             # <<<<<<<<<<<<<<
  *         self._rollback_hook = fn
  *         if fn is None:
  */
 
@@ -16528,85 +16534,85 @@
 static PyObject *__pyx_pf_9playhouse_11_sqlite_ext_16ConnectionHelper_6set_rollback_hook(struct __pyx_obj_9playhouse_11_sqlite_ext_ConnectionHelper *__pyx_v_self, PyObject *__pyx_v_fn) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   __Pyx_RefNannySetupContext("set_rollback_hook", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1437
+  /* "playhouse/_sqlite_ext.pyx":1436
  * 
  *     def set_rollback_hook(self, fn):
  *         self._rollback_hook = fn             # <<<<<<<<<<<<<<
  *         if fn is None:
  *             sqlite3_rollback_hook(self.conn.db, NULL, NULL)
  */
   __Pyx_INCREF(__pyx_v_fn);
   __Pyx_GIVEREF(__pyx_v_fn);
   __Pyx_GOTREF(__pyx_v_self->_rollback_hook);
   __Pyx_DECREF(__pyx_v_self->_rollback_hook);
   __pyx_v_self->_rollback_hook = __pyx_v_fn;
 
-  /* "playhouse/_sqlite_ext.pyx":1438
+  /* "playhouse/_sqlite_ext.pyx":1437
  *     def set_rollback_hook(self, fn):
  *         self._rollback_hook = fn
  *         if fn is None:             # <<<<<<<<<<<<<<
  *             sqlite3_rollback_hook(self.conn.db, NULL, NULL)
  *         else:
  */
   __pyx_t_1 = (__pyx_v_fn == Py_None);
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":1439
+    /* "playhouse/_sqlite_ext.pyx":1438
  *         self._rollback_hook = fn
  *         if fn is None:
  *             sqlite3_rollback_hook(self.conn.db, NULL, NULL)             # <<<<<<<<<<<<<<
  *         else:
  *             sqlite3_rollback_hook(self.conn.db, _rollback_callback, <void *>fn)
  */
-    (void)(sqlite3_rollback_hook(__pyx_v_self->conn->db, NULL, NULL));
+    sqlite3_rollback_hook(__pyx_v_self->conn->db, NULL, NULL);
 
-    /* "playhouse/_sqlite_ext.pyx":1438
+    /* "playhouse/_sqlite_ext.pyx":1437
  *     def set_rollback_hook(self, fn):
  *         self._rollback_hook = fn
  *         if fn is None:             # <<<<<<<<<<<<<<
  *             sqlite3_rollback_hook(self.conn.db, NULL, NULL)
  *         else:
  */
     goto __pyx_L3;
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1441
+  /* "playhouse/_sqlite_ext.pyx":1440
  *             sqlite3_rollback_hook(self.conn.db, NULL, NULL)
  *         else:
  *             sqlite3_rollback_hook(self.conn.db, _rollback_callback, <void *>fn)             # <<<<<<<<<<<<<<
  * 
  *     def set_update_hook(self, fn):
  */
   /*else*/ {
-    (void)(sqlite3_rollback_hook(__pyx_v_self->conn->db, __pyx_f_9playhouse_11_sqlite_ext__rollback_callback, ((void *)__pyx_v_fn)));
+    sqlite3_rollback_hook(__pyx_v_self->conn->db, __pyx_f_9playhouse_11_sqlite_ext__rollback_callback, ((void *)__pyx_v_fn));
   }
   __pyx_L3:;
 
-  /* "playhouse/_sqlite_ext.pyx":1436
+  /* "playhouse/_sqlite_ext.pyx":1435
  *             sqlite3_commit_hook(self.conn.db, _commit_callback, <void *>fn)
  * 
  *     def set_rollback_hook(self, fn):             # <<<<<<<<<<<<<<
  *         self._rollback_hook = fn
  *         if fn is None:
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1443
+/* "playhouse/_sqlite_ext.pyx":1442
  *             sqlite3_rollback_hook(self.conn.db, _rollback_callback, <void *>fn)
  * 
  *     def set_update_hook(self, fn):             # <<<<<<<<<<<<<<
  *         self._update_hook = fn
  *         if fn is None:
  */
 
@@ -16626,85 +16632,85 @@
 static PyObject *__pyx_pf_9playhouse_11_sqlite_ext_16ConnectionHelper_8set_update_hook(struct __pyx_obj_9playhouse_11_sqlite_ext_ConnectionHelper *__pyx_v_self, PyObject *__pyx_v_fn) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   __Pyx_RefNannySetupContext("set_update_hook", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1444
+  /* "playhouse/_sqlite_ext.pyx":1443
  * 
  *     def set_update_hook(self, fn):
  *         self._update_hook = fn             # <<<<<<<<<<<<<<
  *         if fn is None:
  *             sqlite3_update_hook(self.conn.db, NULL, NULL)
  */
   __Pyx_INCREF(__pyx_v_fn);
   __Pyx_GIVEREF(__pyx_v_fn);
   __Pyx_GOTREF(__pyx_v_self->_update_hook);
   __Pyx_DECREF(__pyx_v_self->_update_hook);
   __pyx_v_self->_update_hook = __pyx_v_fn;
 
-  /* "playhouse/_sqlite_ext.pyx":1445
+  /* "playhouse/_sqlite_ext.pyx":1444
  *     def set_update_hook(self, fn):
  *         self._update_hook = fn
  *         if fn is None:             # <<<<<<<<<<<<<<
  *             sqlite3_update_hook(self.conn.db, NULL, NULL)
  *         else:
  */
   __pyx_t_1 = (__pyx_v_fn == Py_None);
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":1446
+    /* "playhouse/_sqlite_ext.pyx":1445
  *         self._update_hook = fn
  *         if fn is None:
  *             sqlite3_update_hook(self.conn.db, NULL, NULL)             # <<<<<<<<<<<<<<
  *         else:
  *             sqlite3_update_hook(self.conn.db, _update_callback, <void *>fn)
  */
-    (void)(sqlite3_update_hook(__pyx_v_self->conn->db, NULL, NULL));
+    sqlite3_update_hook(__pyx_v_self->conn->db, NULL, NULL);
 
-    /* "playhouse/_sqlite_ext.pyx":1445
+    /* "playhouse/_sqlite_ext.pyx":1444
  *     def set_update_hook(self, fn):
  *         self._update_hook = fn
  *         if fn is None:             # <<<<<<<<<<<<<<
  *             sqlite3_update_hook(self.conn.db, NULL, NULL)
  *         else:
  */
     goto __pyx_L3;
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1448
+  /* "playhouse/_sqlite_ext.pyx":1447
  *             sqlite3_update_hook(self.conn.db, NULL, NULL)
  *         else:
  *             sqlite3_update_hook(self.conn.db, _update_callback, <void *>fn)             # <<<<<<<<<<<<<<
  * 
  *     def set_busy_handler(self, timeout=5):
  */
   /*else*/ {
-    (void)(sqlite3_update_hook(__pyx_v_self->conn->db, __pyx_f_9playhouse_11_sqlite_ext__update_callback, ((void *)__pyx_v_fn)));
+    sqlite3_update_hook(__pyx_v_self->conn->db, __pyx_f_9playhouse_11_sqlite_ext__update_callback, ((void *)__pyx_v_fn));
   }
   __pyx_L3:;
 
-  /* "playhouse/_sqlite_ext.pyx":1443
+  /* "playhouse/_sqlite_ext.pyx":1442
  *             sqlite3_rollback_hook(self.conn.db, _rollback_callback, <void *>fn)
  * 
  *     def set_update_hook(self, fn):             # <<<<<<<<<<<<<<
  *         self._update_hook = fn
  *         if fn is None:
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1450
+/* "playhouse/_sqlite_ext.pyx":1449
  *             sqlite3_update_hook(self.conn.db, _update_callback, <void *>fn)
  * 
  *     def set_busy_handler(self, timeout=5):             # <<<<<<<<<<<<<<
  *         """
  *         Replace the default busy handler with one that introduces some "jitter"
  */
 
@@ -16729,89 +16735,89 @@
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_timeout);
+          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_timeout);
           if (value) { values[0] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "set_busy_handler") < 0)) __PYX_ERR(0, 1450, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "set_busy_handler") < 0)) __PYX_ERR(0, 1449, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_timeout = values[0];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("set_busy_handler", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1450, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("set_busy_handler", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1449, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("playhouse._sqlite_ext.ConnectionHelper.set_busy_handler", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_16ConnectionHelper_10set_busy_handler(((struct __pyx_obj_9playhouse_11_sqlite_ext_ConnectionHelper *)__pyx_v_self), __pyx_v_timeout);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 static PyObject *__pyx_pf_9playhouse_11_sqlite_ext_16ConnectionHelper_10set_busy_handler(struct __pyx_obj_9playhouse_11_sqlite_ext_ConnectionHelper *__pyx_v_self, PyObject *__pyx_v_timeout) {
-  int __pyx_v_n;
+  sqlite3_int64 __pyx_v_n;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
-  int __pyx_t_2;
+  sqlite3_int64 __pyx_t_2;
   __Pyx_RefNannySetupContext("set_busy_handler", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1455
+  /* "playhouse/_sqlite_ext.pyx":1454
  *         into the amount of time delayed between checks.
  *         """
- *         cdef int n = timeout * 1000             # <<<<<<<<<<<<<<
+ *         cdef sqlite3_int64 n = timeout * 1000             # <<<<<<<<<<<<<<
  *         sqlite3_busy_handler(self.conn.db, _aggressive_busy_handler, <void *>n)
  *         return True
  */
-  __pyx_t_1 = PyNumber_Multiply(__pyx_v_timeout, __pyx_int_1000); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1455, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_timeout, __pyx_int_1000); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1454, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1455, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_As_sqlite3_int64(__pyx_t_1); if (unlikely((__pyx_t_2 == ((sqlite3_int64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1454, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_n = __pyx_t_2;
 
-  /* "playhouse/_sqlite_ext.pyx":1456
+  /* "playhouse/_sqlite_ext.pyx":1455
  *         """
- *         cdef int n = timeout * 1000
+ *         cdef sqlite3_int64 n = timeout * 1000
  *         sqlite3_busy_handler(self.conn.db, _aggressive_busy_handler, <void *>n)             # <<<<<<<<<<<<<<
  *         return True
  * 
  */
-  (void)(sqlite3_busy_handler(__pyx_v_self->conn->db, __pyx_f_9playhouse_11_sqlite_ext__aggressive_busy_handler, ((void *)__pyx_v_n)));
+  sqlite3_busy_handler(__pyx_v_self->conn->db, __pyx_f_9playhouse_11_sqlite_ext__aggressive_busy_handler, ((void *)__pyx_v_n));
 
-  /* "playhouse/_sqlite_ext.pyx":1457
- *         cdef int n = timeout * 1000
+  /* "playhouse/_sqlite_ext.pyx":1456
+ *         cdef sqlite3_int64 n = timeout * 1000
  *         sqlite3_busy_handler(self.conn.db, _aggressive_busy_handler, <void *>n)
  *         return True             # <<<<<<<<<<<<<<
  * 
  *     def changes(self):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(Py_True);
   __pyx_r = Py_True;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1450
+  /* "playhouse/_sqlite_ext.pyx":1449
  *             sqlite3_update_hook(self.conn.db, _update_callback, <void *>fn)
  * 
  *     def set_busy_handler(self, timeout=5):             # <<<<<<<<<<<<<<
  *         """
  *         Replace the default busy handler with one that introduces some "jitter"
  */
 
@@ -16822,15 +16828,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1459
+/* "playhouse/_sqlite_ext.pyx":1458
  *         return True
  * 
  *     def changes(self):             # <<<<<<<<<<<<<<
  *         return sqlite3_changes(self.conn.db)
  * 
  */
 
@@ -16849,29 +16855,29 @@
 
 static PyObject *__pyx_pf_9playhouse_11_sqlite_ext_16ConnectionHelper_12changes(struct __pyx_obj_9playhouse_11_sqlite_ext_ConnectionHelper *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   __Pyx_RefNannySetupContext("changes", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1460
+  /* "playhouse/_sqlite_ext.pyx":1459
  * 
  *     def changes(self):
  *         return sqlite3_changes(self.conn.db)             # <<<<<<<<<<<<<<
  * 
  *     def last_insert_rowid(self):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyInt_From_int(sqlite3_changes(__pyx_v_self->conn->db)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1460, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(sqlite3_changes(__pyx_v_self->conn->db)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1459, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1459
+  /* "playhouse/_sqlite_ext.pyx":1458
  *         return True
  * 
  *     def changes(self):             # <<<<<<<<<<<<<<
  *         return sqlite3_changes(self.conn.db)
  * 
  */
 
@@ -16882,15 +16888,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1462
+/* "playhouse/_sqlite_ext.pyx":1461
  *         return sqlite3_changes(self.conn.db)
  * 
  *     def last_insert_rowid(self):             # <<<<<<<<<<<<<<
  *         return <int>sqlite3_last_insert_rowid(self.conn.db)
  * 
  */
 
@@ -16909,29 +16915,29 @@
 
 static PyObject *__pyx_pf_9playhouse_11_sqlite_ext_16ConnectionHelper_14last_insert_rowid(struct __pyx_obj_9playhouse_11_sqlite_ext_ConnectionHelper *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   __Pyx_RefNannySetupContext("last_insert_rowid", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1463
+  /* "playhouse/_sqlite_ext.pyx":1462
  * 
  *     def last_insert_rowid(self):
  *         return <int>sqlite3_last_insert_rowid(self.conn.db)             # <<<<<<<<<<<<<<
  * 
  *     def autocommit(self):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyInt_From_int(((int)sqlite3_last_insert_rowid(__pyx_v_self->conn->db))); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1463, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(((int)sqlite3_last_insert_rowid(__pyx_v_self->conn->db))); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1462, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1462
+  /* "playhouse/_sqlite_ext.pyx":1461
  *         return sqlite3_changes(self.conn.db)
  * 
  *     def last_insert_rowid(self):             # <<<<<<<<<<<<<<
  *         return <int>sqlite3_last_insert_rowid(self.conn.db)
  * 
  */
 
@@ -16942,15 +16948,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1465
+/* "playhouse/_sqlite_ext.pyx":1464
  *         return <int>sqlite3_last_insert_rowid(self.conn.db)
  * 
  *     def autocommit(self):             # <<<<<<<<<<<<<<
  *         return sqlite3_get_autocommit(self.conn.db) != 0
  * 
  */
 
@@ -16969,29 +16975,29 @@
 
 static PyObject *__pyx_pf_9playhouse_11_sqlite_ext_16ConnectionHelper_16autocommit(struct __pyx_obj_9playhouse_11_sqlite_ext_ConnectionHelper *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   __Pyx_RefNannySetupContext("autocommit", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1466
+  /* "playhouse/_sqlite_ext.pyx":1465
  * 
  *     def autocommit(self):
  *         return sqlite3_get_autocommit(self.conn.db) != 0             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyBool_FromLong((sqlite3_get_autocommit(__pyx_v_self->conn->db) != 0)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1466, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyBool_FromLong((sqlite3_get_autocommit(__pyx_v_self->conn->db) != 0)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1465, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1465
+  /* "playhouse/_sqlite_ext.pyx":1464
  *         return <int>sqlite3_last_insert_rowid(self.conn.db)
  * 
  *     def autocommit(self):             # <<<<<<<<<<<<<<
  *         return sqlite3_get_autocommit(self.conn.db) != 0
  * 
  */
 
@@ -17033,15 +17039,15 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("self.conn cannot be converted to a Python object for pickling")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("self.conn cannot be converted to a Python object for pickling")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__19, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__29, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(1, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
@@ -17086,15 +17092,15 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("self.conn cannot be converted to a Python object for pickling")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("self.conn cannot be converted to a Python object for pickling")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__30, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(1, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
@@ -17109,15 +17115,15 @@
   __Pyx_AddTraceback("playhouse._sqlite_ext.ConnectionHelper.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1469
+/* "playhouse/_sqlite_ext.pyx":1468
  * 
  * 
  * cdef int _commit_callback(void *userData) with gil:             # <<<<<<<<<<<<<<
  *     # C-callback that delegates to the Python commit handler. If the Python
  *     # function raises a ValueError, then the commit is aborted and the
  */
 
@@ -17133,27 +17139,27 @@
   PyObject *__pyx_t_6 = NULL;
   int __pyx_t_7;
   #ifdef WITH_THREAD
   PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
   #endif
   __Pyx_RefNannySetupContext("_commit_callback", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1474
+  /* "playhouse/_sqlite_ext.pyx":1473
  *     # transaction rolled back. Otherwise, regardless of the function return
  *     # value, the transaction will commit.
  *     cdef object fn = <object>userData             # <<<<<<<<<<<<<<
  *     try:
  *         fn()
  */
   __pyx_t_1 = ((PyObject *)__pyx_v_userData);
   __Pyx_INCREF(__pyx_t_1);
   __pyx_v_fn = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1475
+  /* "playhouse/_sqlite_ext.pyx":1474
  *     # value, the transaction will commit.
  *     cdef object fn = <object>userData
  *     try:             # <<<<<<<<<<<<<<
  *         fn()
  *     except ValueError:
  */
   {
@@ -17161,15 +17167,15 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_2, &__pyx_t_3, &__pyx_t_4);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_4);
     /*try:*/ {
 
-      /* "playhouse/_sqlite_ext.pyx":1476
+      /* "playhouse/_sqlite_ext.pyx":1475
  *     cdef object fn = <object>userData
  *     try:
  *         fn()             # <<<<<<<<<<<<<<
  *     except ValueError:
  *         return 1
  */
       __Pyx_INCREF(__pyx_v_fn);
@@ -17179,62 +17185,65 @@
         if (likely(__pyx_t_6)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
           __Pyx_INCREF(__pyx_t_6);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_5, function);
         }
       }
-      __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6) : __Pyx_PyObject_CallNoArg(__pyx_t_5);
-      __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1476, __pyx_L3_error)
+      if (__pyx_t_6) {
+        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1475, __pyx_L3_error)
+        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      } else {
+        __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1475, __pyx_L3_error)
+      }
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "playhouse/_sqlite_ext.pyx":1475
+      /* "playhouse/_sqlite_ext.pyx":1474
  *     # value, the transaction will commit.
  *     cdef object fn = <object>userData
  *     try:             # <<<<<<<<<<<<<<
  *         fn()
  *     except ValueError:
  */
     }
 
-    /* "playhouse/_sqlite_ext.pyx":1480
+    /* "playhouse/_sqlite_ext.pyx":1479
  *         return 1
  *     else:
  *         return SQLITE_OK             # <<<<<<<<<<<<<<
  * 
  * 
  */
     /*else:*/ {
       __pyx_r = SQLITE_OK;
       goto __pyx_L6_except_return;
     }
     __pyx_L3_error:;
-    __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "playhouse/_sqlite_ext.pyx":1477
+    /* "playhouse/_sqlite_ext.pyx":1476
  *     try:
  *         fn()
  *     except ValueError:             # <<<<<<<<<<<<<<
  *         return 1
  *     else:
  */
     __pyx_t_7 = __Pyx_PyErr_ExceptionMatches(__pyx_builtin_ValueError);
     if (__pyx_t_7) {
       __Pyx_AddTraceback("playhouse._sqlite_ext._commit_callback", __pyx_clineno, __pyx_lineno, __pyx_filename);
-      if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_5, &__pyx_t_6) < 0) __PYX_ERR(0, 1477, __pyx_L5_except_error)
+      if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_5, &__pyx_t_6) < 0) __PYX_ERR(0, 1476, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
 
-      /* "playhouse/_sqlite_ext.pyx":1478
+      /* "playhouse/_sqlite_ext.pyx":1477
  *         fn()
  *     except ValueError:
  *         return 1             # <<<<<<<<<<<<<<
  *     else:
  *         return SQLITE_OK
  */
       __pyx_r = 1;
@@ -17242,15 +17251,15 @@
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       goto __pyx_L6_except_return;
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "playhouse/_sqlite_ext.pyx":1475
+    /* "playhouse/_sqlite_ext.pyx":1474
  *     # value, the transaction will commit.
  *     cdef object fn = <object>userData
  *     try:             # <<<<<<<<<<<<<<
  *         fn()
  *     except ValueError:
  */
     __Pyx_XGIVEREF(__pyx_t_2);
@@ -17262,15 +17271,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_XGIVEREF(__pyx_t_4);
     __Pyx_ExceptionReset(__pyx_t_2, __pyx_t_3, __pyx_t_4);
     goto __pyx_L0;
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1469
+  /* "playhouse/_sqlite_ext.pyx":1468
  * 
  * 
  * cdef int _commit_callback(void *userData) with gil:             # <<<<<<<<<<<<<<
  *     # C-callback that delegates to the Python commit handler. If the Python
  *     # function raises a ValueError, then the commit is aborted and the
  */
 
@@ -17286,15 +17295,15 @@
   __Pyx_RefNannyFinishContext();
   #ifdef WITH_THREAD
   __Pyx_PyGILState_Release(__pyx_gilstate_save);
   #endif
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1483
+/* "playhouse/_sqlite_ext.pyx":1482
  * 
  * 
  * cdef void _rollback_callback(void *userData) with gil:             # <<<<<<<<<<<<<<
  *     # C-callback that delegates to the Python rollback handler.
  *     cdef object fn = <object>userData
  */
 
@@ -17305,27 +17314,27 @@
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   #ifdef WITH_THREAD
   PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
   #endif
   __Pyx_RefNannySetupContext("_rollback_callback", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1485
+  /* "playhouse/_sqlite_ext.pyx":1484
  * cdef void _rollback_callback(void *userData) with gil:
  *     # C-callback that delegates to the Python rollback handler.
  *     cdef object fn = <object>userData             # <<<<<<<<<<<<<<
  *     fn()
  * 
  */
   __pyx_t_1 = ((PyObject *)__pyx_v_userData);
   __Pyx_INCREF(__pyx_t_1);
   __pyx_v_fn = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1486
+  /* "playhouse/_sqlite_ext.pyx":1485
  *     # C-callback that delegates to the Python rollback handler.
  *     cdef object fn = <object>userData
  *     fn()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_INCREF(__pyx_v_fn);
@@ -17335,22 +17344,25 @@
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
-  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1486, __pyx_L1_error)
+  if (__pyx_t_3) {
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1485, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  } else {
+    __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1485, __pyx_L1_error)
+  }
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1483
+  /* "playhouse/_sqlite_ext.pyx":1482
  * 
  * 
  * cdef void _rollback_callback(void *userData) with gil:             # <<<<<<<<<<<<<<
  *     # C-callback that delegates to the Python rollback handler.
  *     cdef object fn = <object>userData
  */
 
@@ -17365,23 +17377,23 @@
   __Pyx_XDECREF(__pyx_v_fn);
   __Pyx_RefNannyFinishContext();
   #ifdef WITH_THREAD
   __Pyx_PyGILState_Release(__pyx_gilstate_save);
   #endif
 }
 
-/* "playhouse/_sqlite_ext.pyx":1489
+/* "playhouse/_sqlite_ext.pyx":1488
  * 
  * 
- * cdef void _update_callback(void *userData, int queryType, char *database,             # <<<<<<<<<<<<<<
- *                             char *table, sqlite3_int64 rowid) with gil:
+ * cdef void _update_callback(void *userData, int queryType, const char *database,             # <<<<<<<<<<<<<<
+ *                            const char *table, sqlite3_int64 rowid) with gil:
  *     # C-callback that delegates to a Python function that is executed whenever
  */
 
-static void __pyx_f_9playhouse_11_sqlite_ext__update_callback(void *__pyx_v_userData, int __pyx_v_queryType, char *__pyx_v_database, char *__pyx_v_table, sqlite3_int64 __pyx_v_rowid) {
+static void __pyx_f_9playhouse_11_sqlite_ext__update_callback(void *__pyx_v_userData, int __pyx_v_queryType, char const *__pyx_v_database, char const *__pyx_v_table, sqlite3_int64 __pyx_v_rowid) {
   PyObject *__pyx_v_fn = 0;
   PyObject *__pyx_v_query = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
@@ -17391,147 +17403,147 @@
   int __pyx_t_8;
   PyObject *__pyx_t_9 = NULL;
   #ifdef WITH_THREAD
   PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
   #endif
   __Pyx_RefNannySetupContext("_update_callback", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1496
+  /* "playhouse/_sqlite_ext.pyx":1495
  *     # database, the name of the table being updated, and the rowid of the row
  *     # being updatd.
  *     cdef object fn = <object>userData             # <<<<<<<<<<<<<<
  *     if queryType == SQLITE_INSERT:
  *         query = 'INSERT'
  */
   __pyx_t_1 = ((PyObject *)__pyx_v_userData);
   __Pyx_INCREF(__pyx_t_1);
   __pyx_v_fn = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1497
+  /* "playhouse/_sqlite_ext.pyx":1496
  *     # being updatd.
  *     cdef object fn = <object>userData
  *     if queryType == SQLITE_INSERT:             # <<<<<<<<<<<<<<
  *         query = 'INSERT'
  *     elif queryType == SQLITE_UPDATE:
  */
   __pyx_t_2 = ((__pyx_v_queryType == SQLITE_INSERT) != 0);
   if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":1498
+    /* "playhouse/_sqlite_ext.pyx":1497
  *     cdef object fn = <object>userData
  *     if queryType == SQLITE_INSERT:
  *         query = 'INSERT'             # <<<<<<<<<<<<<<
  *     elif queryType == SQLITE_UPDATE:
  *         query = 'UPDATE'
  */
     __Pyx_INCREF(__pyx_n_s_INSERT);
     __pyx_v_query = __pyx_n_s_INSERT;
 
-    /* "playhouse/_sqlite_ext.pyx":1497
+    /* "playhouse/_sqlite_ext.pyx":1496
  *     # being updatd.
  *     cdef object fn = <object>userData
  *     if queryType == SQLITE_INSERT:             # <<<<<<<<<<<<<<
  *         query = 'INSERT'
  *     elif queryType == SQLITE_UPDATE:
  */
     goto __pyx_L3;
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1499
+  /* "playhouse/_sqlite_ext.pyx":1498
  *     if queryType == SQLITE_INSERT:
  *         query = 'INSERT'
  *     elif queryType == SQLITE_UPDATE:             # <<<<<<<<<<<<<<
  *         query = 'UPDATE'
  *     elif queryType == SQLITE_DELETE:
  */
   __pyx_t_2 = ((__pyx_v_queryType == SQLITE_UPDATE) != 0);
   if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":1500
+    /* "playhouse/_sqlite_ext.pyx":1499
  *         query = 'INSERT'
  *     elif queryType == SQLITE_UPDATE:
  *         query = 'UPDATE'             # <<<<<<<<<<<<<<
  *     elif queryType == SQLITE_DELETE:
  *         query = 'DELETE'
  */
     __Pyx_INCREF(__pyx_n_s_UPDATE);
     __pyx_v_query = __pyx_n_s_UPDATE;
 
-    /* "playhouse/_sqlite_ext.pyx":1499
+    /* "playhouse/_sqlite_ext.pyx":1498
  *     if queryType == SQLITE_INSERT:
  *         query = 'INSERT'
  *     elif queryType == SQLITE_UPDATE:             # <<<<<<<<<<<<<<
  *         query = 'UPDATE'
  *     elif queryType == SQLITE_DELETE:
  */
     goto __pyx_L3;
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1501
+  /* "playhouse/_sqlite_ext.pyx":1500
  *     elif queryType == SQLITE_UPDATE:
  *         query = 'UPDATE'
  *     elif queryType == SQLITE_DELETE:             # <<<<<<<<<<<<<<
  *         query = 'DELETE'
  *     else:
  */
   __pyx_t_2 = ((__pyx_v_queryType == SQLITE_DELETE) != 0);
   if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":1502
+    /* "playhouse/_sqlite_ext.pyx":1501
  *         query = 'UPDATE'
  *     elif queryType == SQLITE_DELETE:
  *         query = 'DELETE'             # <<<<<<<<<<<<<<
  *     else:
  *         query = ''
  */
     __Pyx_INCREF(__pyx_n_s_DELETE);
     __pyx_v_query = __pyx_n_s_DELETE;
 
-    /* "playhouse/_sqlite_ext.pyx":1501
+    /* "playhouse/_sqlite_ext.pyx":1500
  *     elif queryType == SQLITE_UPDATE:
  *         query = 'UPDATE'
  *     elif queryType == SQLITE_DELETE:             # <<<<<<<<<<<<<<
  *         query = 'DELETE'
  *     else:
  */
     goto __pyx_L3;
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1504
+  /* "playhouse/_sqlite_ext.pyx":1503
  *         query = 'DELETE'
  *     else:
  *         query = ''             # <<<<<<<<<<<<<<
  *     fn(query, decode(database), decode(table), <int>rowid)
  * 
  */
   /*else*/ {
-    __Pyx_INCREF(__pyx_kp_s__12);
-    __pyx_v_query = __pyx_kp_s__12;
+    __Pyx_INCREF(__pyx_kp_s__17);
+    __pyx_v_query = __pyx_kp_s__17;
   }
   __pyx_L3:;
 
-  /* "playhouse/_sqlite_ext.pyx":1505
+  /* "playhouse/_sqlite_ext.pyx":1504
  *     else:
  *         query = ''
  *     fn(query, decode(database), decode(table), <int>rowid)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_3 = __Pyx_PyBytes_FromString(__pyx_v_database); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1505, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyBytes_FromString(__pyx_v_database); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1504, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __pyx_f_9playhouse_11_sqlite_ext_decode(__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1505, __pyx_L1_error)
+  __pyx_t_4 = __pyx_f_9playhouse_11_sqlite_ext_decode(__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1504, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyBytes_FromString(__pyx_v_table); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1505, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyBytes_FromString(__pyx_v_table); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1504, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __pyx_f_9playhouse_11_sqlite_ext_decode(__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1505, __pyx_L1_error)
+  __pyx_t_5 = __pyx_f_9playhouse_11_sqlite_ext_decode(__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1504, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyInt_From_int(((int)__pyx_v_rowid)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1505, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(((int)__pyx_v_rowid)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1504, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_v_fn);
   __pyx_t_6 = __pyx_v_fn; __pyx_t_7 = NULL;
   __pyx_t_8 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_7)) {
@@ -17541,35 +17553,35 @@
       __Pyx_DECREF_SET(__pyx_t_6, function);
       __pyx_t_8 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_6)) {
     PyObject *__pyx_temp[5] = {__pyx_t_7, __pyx_v_query, __pyx_t_4, __pyx_t_5, __pyx_t_3};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_8, 4+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1505, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_8, 4+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1504, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_6)) {
     PyObject *__pyx_temp[5] = {__pyx_t_7, __pyx_v_query, __pyx_t_4, __pyx_t_5, __pyx_t_3};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_8, 4+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1505, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_8, 4+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1504, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   } else
   #endif
   {
-    __pyx_t_9 = PyTuple_New(4+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1505, __pyx_L1_error)
+    __pyx_t_9 = PyTuple_New(4+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1504, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     if (__pyx_t_7) {
       __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_7); __pyx_t_7 = NULL;
     }
     __Pyx_INCREF(__pyx_v_query);
     __Pyx_GIVEREF(__pyx_v_query);
     PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_8, __pyx_v_query);
@@ -17578,26 +17590,26 @@
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_9, 2+__pyx_t_8, __pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_9, 3+__pyx_t_8, __pyx_t_3);
     __pyx_t_4 = 0;
     __pyx_t_5 = 0;
     __pyx_t_3 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1505, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1504, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   }
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1489
+  /* "playhouse/_sqlite_ext.pyx":1488
  * 
  * 
- * cdef void _update_callback(void *userData, int queryType, char *database,             # <<<<<<<<<<<<<<
- *                             char *table, sqlite3_int64 rowid) with gil:
+ * cdef void _update_callback(void *userData, int queryType, const char *database,             # <<<<<<<<<<<<<<
+ *                            const char *table, sqlite3_int64 rowid) with gil:
  *     # C-callback that delegates to a Python function that is executed whenever
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
@@ -17613,25 +17625,25 @@
   __Pyx_XDECREF(__pyx_v_query);
   __Pyx_RefNannyFinishContext();
   #ifdef WITH_THREAD
   __Pyx_PyGILState_Release(__pyx_gilstate_save);
   #endif
 }
 
-/* "playhouse/_sqlite_ext.pyx":1508
+/* "playhouse/_sqlite_ext.pyx":1507
  * 
  * 
  * def backup(src_conn, dest_conn, pages=None, name=None, progress=None):             # <<<<<<<<<<<<<<
  *     cdef:
  *         bytes bname = encode(name or 'main')
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_29backup(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_29backup = {"backup", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_29backup, METH_VARARGS|METH_KEYWORDS, 0};
+static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_29backup = {"backup", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_29backup, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_29backup(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_src_conn = 0;
   PyObject *__pyx_v_dest_conn = 0;
   PyObject *__pyx_v_pages = 0;
   PyObject *__pyx_v_name = 0;
   PyObject *__pyx_v_progress = 0;
   PyObject *__pyx_r = 0;
@@ -17659,43 +17671,43 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_src_conn)) != 0)) kw_args--;
+        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_src_conn)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_dest_conn)) != 0)) kw_args--;
+        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_dest_conn)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("backup", 0, 2, 5, 1); __PYX_ERR(0, 1508, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("backup", 0, 2, 5, 1); __PYX_ERR(0, 1507, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pages);
+          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_pages);
           if (value) { values[2] = value; kw_args--; }
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_name);
+          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_name);
           if (value) { values[3] = value; kw_args--; }
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_progress);
+          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_progress);
           if (value) { values[4] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "backup") < 0)) __PYX_ERR(0, 1508, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "backup") < 0)) __PYX_ERR(0, 1507, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
@@ -17711,15 +17723,15 @@
     __pyx_v_dest_conn = values[1];
     __pyx_v_pages = values[2];
     __pyx_v_name = values[3];
     __pyx_v_progress = values[4];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("backup", 0, 2, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1508, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("backup", 0, 2, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1507, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("playhouse._sqlite_ext.backup", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_28backup(__pyx_self, __pyx_v_src_conn, __pyx_v_dest_conn, __pyx_v_pages, __pyx_v_name, __pyx_v_progress);
 
@@ -17744,200 +17756,188 @@
   PyObject *__pyx_t_1 = NULL;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   int __pyx_t_5;
   sqlite3 *__pyx_t_6;
   char const *__pyx_t_7;
-  PyObject *__pyx_t_8 = NULL;
-  int __pyx_t_9;
+  int __pyx_t_8;
+  PyObject *__pyx_t_9 = NULL;
   PyObject *__pyx_t_10 = NULL;
   PyObject *__pyx_t_11 = NULL;
   PyObject *__pyx_t_12 = NULL;
   PyObject *__pyx_t_13 = NULL;
   PyObject *__pyx_t_14 = NULL;
   PyObject *__pyx_t_15 = NULL;
   PyObject *__pyx_t_16 = NULL;
   __Pyx_RefNannySetupContext("backup", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1510
+  /* "playhouse/_sqlite_ext.pyx":1509
  * def backup(src_conn, dest_conn, pages=None, name=None, progress=None):
  *     cdef:
  *         bytes bname = encode(name or 'main')             # <<<<<<<<<<<<<<
  *         int page_step = pages or -1
  *         int rc
  */
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_name); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1510, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_name); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1509, __pyx_L1_error)
   if (!__pyx_t_2) {
   } else {
     __Pyx_INCREF(__pyx_v_name);
     __pyx_t_1 = __pyx_v_name;
     goto __pyx_L3_bool_binop_done;
   }
   __Pyx_INCREF(__pyx_n_s_main);
   __pyx_t_1 = __pyx_n_s_main;
   __pyx_L3_bool_binop_done:;
-  __pyx_t_3 = __pyx_f_9playhouse_11_sqlite_ext_encode(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1510, __pyx_L1_error)
+  __pyx_t_3 = __pyx_f_9playhouse_11_sqlite_ext_encode(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1509, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_bname = ((PyObject*)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1511
+  /* "playhouse/_sqlite_ext.pyx":1510
  *     cdef:
  *         bytes bname = encode(name or 'main')
  *         int page_step = pages or -1             # <<<<<<<<<<<<<<
  *         int rc
  *         pysqlite_Connection *src = <pysqlite_Connection *>src_conn
  */
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_pages); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1511, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_pages); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1510, __pyx_L1_error)
   if (!__pyx_t_2) {
   } else {
-    __pyx_t_5 = __Pyx_PyInt_As_int(__pyx_v_pages); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1511, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_As_int(__pyx_v_pages); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1510, __pyx_L1_error)
     __pyx_t_4 = __pyx_t_5;
     goto __pyx_L5_bool_binop_done;
   }
   __pyx_t_4 = -1L;
   __pyx_L5_bool_binop_done:;
   __pyx_v_page_step = __pyx_t_4;
 
-  /* "playhouse/_sqlite_ext.pyx":1513
+  /* "playhouse/_sqlite_ext.pyx":1512
  *         int page_step = pages or -1
  *         int rc
  *         pysqlite_Connection *src = <pysqlite_Connection *>src_conn             # <<<<<<<<<<<<<<
  *         pysqlite_Connection *dest = <pysqlite_Connection *>dest_conn
  *         sqlite3 *src_db = src.db
  */
   __pyx_v_src = ((pysqlite_Connection *)__pyx_v_src_conn);
 
-  /* "playhouse/_sqlite_ext.pyx":1514
+  /* "playhouse/_sqlite_ext.pyx":1513
  *         int rc
  *         pysqlite_Connection *src = <pysqlite_Connection *>src_conn
  *         pysqlite_Connection *dest = <pysqlite_Connection *>dest_conn             # <<<<<<<<<<<<<<
  *         sqlite3 *src_db = src.db
  *         sqlite3 *dest_db = dest.db
  */
   __pyx_v_dest = ((pysqlite_Connection *)__pyx_v_dest_conn);
 
-  /* "playhouse/_sqlite_ext.pyx":1515
+  /* "playhouse/_sqlite_ext.pyx":1514
  *         pysqlite_Connection *src = <pysqlite_Connection *>src_conn
  *         pysqlite_Connection *dest = <pysqlite_Connection *>dest_conn
  *         sqlite3 *src_db = src.db             # <<<<<<<<<<<<<<
  *         sqlite3 *dest_db = dest.db
  *         sqlite3_backup *backup
  */
   __pyx_t_6 = __pyx_v_src->db;
   __pyx_v_src_db = __pyx_t_6;
 
-  /* "playhouse/_sqlite_ext.pyx":1516
+  /* "playhouse/_sqlite_ext.pyx":1515
  *         pysqlite_Connection *dest = <pysqlite_Connection *>dest_conn
  *         sqlite3 *src_db = src.db
  *         sqlite3 *dest_db = dest.db             # <<<<<<<<<<<<<<
  *         sqlite3_backup *backup
  * 
  */
   __pyx_t_6 = __pyx_v_dest->db;
   __pyx_v_dest_db = __pyx_t_6;
 
-  /* "playhouse/_sqlite_ext.pyx":1520
+  /* "playhouse/_sqlite_ext.pyx":1519
  * 
  *     # We always backup to the "main" database in the dest db.
  *     backup = sqlite3_backup_init(dest_db, b'main', src_db, bname)             # <<<<<<<<<<<<<<
  *     if backup == NULL:
  *         raise OperationalError('Unable to initialize backup.')
  */
   if (unlikely(__pyx_v_bname == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "expected bytes, NoneType found");
-    __PYX_ERR(0, 1520, __pyx_L1_error)
+    __PYX_ERR(0, 1519, __pyx_L1_error)
   }
-  __pyx_t_7 = __Pyx_PyBytes_AsString(__pyx_v_bname); if (unlikely((!__pyx_t_7) && PyErr_Occurred())) __PYX_ERR(0, 1520, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyBytes_AsString(__pyx_v_bname); if (unlikely((!__pyx_t_7) && PyErr_Occurred())) __PYX_ERR(0, 1519, __pyx_L1_error)
   __pyx_v_backup = sqlite3_backup_init(__pyx_v_dest_db, ((char const *)"main"), __pyx_v_src_db, __pyx_t_7);
 
-  /* "playhouse/_sqlite_ext.pyx":1521
+  /* "playhouse/_sqlite_ext.pyx":1520
  *     # We always backup to the "main" database in the dest db.
  *     backup = sqlite3_backup_init(dest_db, b'main', src_db, bname)
  *     if backup == NULL:             # <<<<<<<<<<<<<<
  *         raise OperationalError('Unable to initialize backup.')
  * 
  */
   __pyx_t_2 = ((__pyx_v_backup == NULL) != 0);
-  if (unlikely(__pyx_t_2)) {
+  if (__pyx_t_2) {
 
-    /* "playhouse/_sqlite_ext.pyx":1522
+    /* "playhouse/_sqlite_ext.pyx":1521
  *     backup = sqlite3_backup_init(dest_db, b'main', src_db, bname)
  *     if backup == NULL:
  *         raise OperationalError('Unable to initialize backup.')             # <<<<<<<<<<<<<<
  * 
  *     while True:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_OperationalError); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1522, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_8 = NULL;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
-      __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_1);
-      if (likely(__pyx_t_8)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
-        __Pyx_INCREF(__pyx_t_8);
-        __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_1, function);
-      }
-    }
-    __pyx_t_3 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_8, __pyx_kp_s_Unable_to_initialize_backup) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_kp_s_Unable_to_initialize_backup);
-    __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1522, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_OperationalError); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1521, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__31, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1521, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(0, 1522, __pyx_L1_error)
+    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __PYX_ERR(0, 1521, __pyx_L1_error)
 
-    /* "playhouse/_sqlite_ext.pyx":1521
+    /* "playhouse/_sqlite_ext.pyx":1520
  *     # We always backup to the "main" database in the dest db.
  *     backup = sqlite3_backup_init(dest_db, b'main', src_db, bname)
  *     if backup == NULL:             # <<<<<<<<<<<<<<
  *         raise OperationalError('Unable to initialize backup.')
  * 
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1524
+  /* "playhouse/_sqlite_ext.pyx":1523
  *         raise OperationalError('Unable to initialize backup.')
  * 
  *     while True:             # <<<<<<<<<<<<<<
  *         with nogil:
  *             rc = sqlite3_backup_step(backup, page_step)
  */
   while (1) {
 
-    /* "playhouse/_sqlite_ext.pyx":1525
+    /* "playhouse/_sqlite_ext.pyx":1524
  * 
  *     while True:
  *         with nogil:             # <<<<<<<<<<<<<<
  *             rc = sqlite3_backup_step(backup, page_step)
  *         if progress is not None:
  */
     {
         #ifdef WITH_THREAD
         PyThreadState *_save;
         Py_UNBLOCK_THREADS
         __Pyx_FastGIL_Remember();
         #endif
         /*try:*/ {
 
-          /* "playhouse/_sqlite_ext.pyx":1526
+          /* "playhouse/_sqlite_ext.pyx":1525
  *     while True:
  *         with nogil:
  *             rc = sqlite3_backup_step(backup, page_step)             # <<<<<<<<<<<<<<
  *         if progress is not None:
  *             # Progress-handler is called with (remaining, page count, is done?)
  */
           __pyx_v_rc = sqlite3_backup_step(__pyx_v_backup, __pyx_v_page_step);
         }
 
-        /* "playhouse/_sqlite_ext.pyx":1525
+        /* "playhouse/_sqlite_ext.pyx":1524
  * 
  *     while True:
  *         with nogil:             # <<<<<<<<<<<<<<
  *             rc = sqlite3_backup_step(backup, page_step)
  *         if progress is not None:
  */
         /*finally:*/ {
@@ -17948,71 +17948,71 @@
             #endif
             goto __pyx_L14;
           }
           __pyx_L14:;
         }
     }
 
-    /* "playhouse/_sqlite_ext.pyx":1527
+    /* "playhouse/_sqlite_ext.pyx":1526
  *         with nogil:
  *             rc = sqlite3_backup_step(backup, page_step)
  *         if progress is not None:             # <<<<<<<<<<<<<<
  *             # Progress-handler is called with (remaining, page count, is done?)
  *             remaining = sqlite3_backup_remaining(backup)
  */
     __pyx_t_2 = (__pyx_v_progress != Py_None);
-    __pyx_t_9 = (__pyx_t_2 != 0);
-    if (__pyx_t_9) {
+    __pyx_t_8 = (__pyx_t_2 != 0);
+    if (__pyx_t_8) {
 
-      /* "playhouse/_sqlite_ext.pyx":1529
+      /* "playhouse/_sqlite_ext.pyx":1528
  *         if progress is not None:
  *             # Progress-handler is called with (remaining, page count, is done?)
  *             remaining = sqlite3_backup_remaining(backup)             # <<<<<<<<<<<<<<
  *             page_count = sqlite3_backup_pagecount(backup)
  *             try:
  */
       __pyx_v_remaining = sqlite3_backup_remaining(__pyx_v_backup);
 
-      /* "playhouse/_sqlite_ext.pyx":1530
+      /* "playhouse/_sqlite_ext.pyx":1529
  *             # Progress-handler is called with (remaining, page count, is done?)
  *             remaining = sqlite3_backup_remaining(backup)
  *             page_count = sqlite3_backup_pagecount(backup)             # <<<<<<<<<<<<<<
  *             try:
  *                 progress(remaining, page_count, rc == SQLITE_DONE)
  */
       __pyx_v_page_count = sqlite3_backup_pagecount(__pyx_v_backup);
 
-      /* "playhouse/_sqlite_ext.pyx":1531
+      /* "playhouse/_sqlite_ext.pyx":1530
  *             remaining = sqlite3_backup_remaining(backup)
  *             page_count = sqlite3_backup_pagecount(backup)
  *             try:             # <<<<<<<<<<<<<<
  *                 progress(remaining, page_count, rc == SQLITE_DONE)
  *             except:
  */
       {
         __Pyx_PyThreadState_declare
         __Pyx_PyThreadState_assign
-        __Pyx_ExceptionSave(&__pyx_t_10, &__pyx_t_11, &__pyx_t_12);
+        __Pyx_ExceptionSave(&__pyx_t_9, &__pyx_t_10, &__pyx_t_11);
+        __Pyx_XGOTREF(__pyx_t_9);
         __Pyx_XGOTREF(__pyx_t_10);
         __Pyx_XGOTREF(__pyx_t_11);
-        __Pyx_XGOTREF(__pyx_t_12);
         /*try:*/ {
 
-          /* "playhouse/_sqlite_ext.pyx":1532
+          /* "playhouse/_sqlite_ext.pyx":1531
  *             page_count = sqlite3_backup_pagecount(backup)
  *             try:
  *                 progress(remaining, page_count, rc == SQLITE_DONE)             # <<<<<<<<<<<<<<
  *             except:
  *                 sqlite3_backup_finish(backup)
  */
-          __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_remaining); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1532, __pyx_L16_error)
-          __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_page_count); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1532, __pyx_L16_error)
-          __Pyx_GOTREF(__pyx_t_8);
-          __pyx_t_13 = __Pyx_PyBool_FromLong((__pyx_v_rc == SQLITE_DONE)); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1532, __pyx_L16_error)
+          __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_remaining); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1531, __pyx_L16_error)
+          __Pyx_GOTREF(__pyx_t_3);
+          __pyx_t_12 = __Pyx_PyInt_From_int(__pyx_v_page_count); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1531, __pyx_L16_error)
+          __Pyx_GOTREF(__pyx_t_12);
+          __pyx_t_13 = __Pyx_PyBool_FromLong((__pyx_v_rc == SQLITE_DONE)); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1531, __pyx_L16_error)
           __Pyx_GOTREF(__pyx_t_13);
           __Pyx_INCREF(__pyx_v_progress);
           __pyx_t_14 = __pyx_v_progress; __pyx_t_15 = NULL;
           __pyx_t_4 = 0;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_14))) {
             __pyx_t_15 = PyMethod_GET_SELF(__pyx_t_14);
             if (likely(__pyx_t_15)) {
@@ -18021,184 +18021,184 @@
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_14, function);
               __pyx_t_4 = 1;
             }
           }
           #if CYTHON_FAST_PYCALL
           if (PyFunction_Check(__pyx_t_14)) {
-            PyObject *__pyx_temp[4] = {__pyx_t_15, __pyx_t_1, __pyx_t_8, __pyx_t_13};
-            __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_14, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1532, __pyx_L16_error)
+            PyObject *__pyx_temp[4] = {__pyx_t_15, __pyx_t_3, __pyx_t_12, __pyx_t_13};
+            __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_14, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1531, __pyx_L16_error)
             __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
-            __Pyx_GOTREF(__pyx_t_3);
-            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-            __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+            __Pyx_GOTREF(__pyx_t_1);
+            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+            __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
             __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
           } else
           #endif
           #if CYTHON_FAST_PYCCALL
           if (__Pyx_PyFastCFunction_Check(__pyx_t_14)) {
-            PyObject *__pyx_temp[4] = {__pyx_t_15, __pyx_t_1, __pyx_t_8, __pyx_t_13};
-            __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_14, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1532, __pyx_L16_error)
+            PyObject *__pyx_temp[4] = {__pyx_t_15, __pyx_t_3, __pyx_t_12, __pyx_t_13};
+            __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_14, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1531, __pyx_L16_error)
             __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
-            __Pyx_GOTREF(__pyx_t_3);
-            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-            __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+            __Pyx_GOTREF(__pyx_t_1);
+            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+            __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
             __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
           } else
           #endif
           {
-            __pyx_t_16 = PyTuple_New(3+__pyx_t_4); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1532, __pyx_L16_error)
+            __pyx_t_16 = PyTuple_New(3+__pyx_t_4); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1531, __pyx_L16_error)
             __Pyx_GOTREF(__pyx_t_16);
             if (__pyx_t_15) {
               __Pyx_GIVEREF(__pyx_t_15); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_15); __pyx_t_15 = NULL;
             }
-            __Pyx_GIVEREF(__pyx_t_1);
-            PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_4, __pyx_t_1);
-            __Pyx_GIVEREF(__pyx_t_8);
-            PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_4, __pyx_t_8);
+            __Pyx_GIVEREF(__pyx_t_3);
+            PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_4, __pyx_t_3);
+            __Pyx_GIVEREF(__pyx_t_12);
+            PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_4, __pyx_t_12);
             __Pyx_GIVEREF(__pyx_t_13);
             PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_4, __pyx_t_13);
-            __pyx_t_1 = 0;
-            __pyx_t_8 = 0;
+            __pyx_t_3 = 0;
+            __pyx_t_12 = 0;
             __pyx_t_13 = 0;
-            __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_14, __pyx_t_16, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1532, __pyx_L16_error)
-            __Pyx_GOTREF(__pyx_t_3);
+            __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_14, __pyx_t_16, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1531, __pyx_L16_error)
+            __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
           }
           __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-          /* "playhouse/_sqlite_ext.pyx":1531
+          /* "playhouse/_sqlite_ext.pyx":1530
  *             remaining = sqlite3_backup_remaining(backup)
  *             page_count = sqlite3_backup_pagecount(backup)
  *             try:             # <<<<<<<<<<<<<<
  *                 progress(remaining, page_count, rc == SQLITE_DONE)
  *             except:
  */
         }
+        __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
         __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
         __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
         goto __pyx_L23_try_end;
         __pyx_L16_error:;
-        __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
-        __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
         __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
-        __Pyx_XDECREF(__pyx_t_16); __pyx_t_16 = 0;
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
+        __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
+        __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
+        __Pyx_XDECREF(__pyx_t_16); __pyx_t_16 = 0;
+        __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
+        __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-        /* "playhouse/_sqlite_ext.pyx":1533
+        /* "playhouse/_sqlite_ext.pyx":1532
  *             try:
  *                 progress(remaining, page_count, rc == SQLITE_DONE)
  *             except:             # <<<<<<<<<<<<<<
  *                 sqlite3_backup_finish(backup)
  *                 raise
  */
         /*except:*/ {
           __Pyx_AddTraceback("playhouse._sqlite_ext.backup", __pyx_clineno, __pyx_lineno, __pyx_filename);
-          if (__Pyx_GetException(&__pyx_t_3, &__pyx_t_14, &__pyx_t_16) < 0) __PYX_ERR(0, 1533, __pyx_L18_except_error)
-          __Pyx_GOTREF(__pyx_t_3);
+          if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_14, &__pyx_t_16) < 0) __PYX_ERR(0, 1532, __pyx_L18_except_error)
+          __Pyx_GOTREF(__pyx_t_1);
           __Pyx_GOTREF(__pyx_t_14);
           __Pyx_GOTREF(__pyx_t_16);
 
-          /* "playhouse/_sqlite_ext.pyx":1534
+          /* "playhouse/_sqlite_ext.pyx":1533
  *                 progress(remaining, page_count, rc == SQLITE_DONE)
  *             except:
  *                 sqlite3_backup_finish(backup)             # <<<<<<<<<<<<<<
  *                 raise
  *         if rc == SQLITE_BUSY or rc == SQLITE_LOCKED:
  */
-          (void)(sqlite3_backup_finish(__pyx_v_backup));
+          sqlite3_backup_finish(__pyx_v_backup);
 
-          /* "playhouse/_sqlite_ext.pyx":1535
+          /* "playhouse/_sqlite_ext.pyx":1534
  *             except:
  *                 sqlite3_backup_finish(backup)
  *                 raise             # <<<<<<<<<<<<<<
  *         if rc == SQLITE_BUSY or rc == SQLITE_LOCKED:
  *             with nogil:
  */
-          __Pyx_GIVEREF(__pyx_t_3);
+          __Pyx_GIVEREF(__pyx_t_1);
           __Pyx_GIVEREF(__pyx_t_14);
           __Pyx_XGIVEREF(__pyx_t_16);
-          __Pyx_ErrRestoreWithState(__pyx_t_3, __pyx_t_14, __pyx_t_16);
-          __pyx_t_3 = 0; __pyx_t_14 = 0; __pyx_t_16 = 0; 
-          __PYX_ERR(0, 1535, __pyx_L18_except_error)
+          __Pyx_ErrRestoreWithState(__pyx_t_1, __pyx_t_14, __pyx_t_16);
+          __pyx_t_1 = 0; __pyx_t_14 = 0; __pyx_t_16 = 0; 
+          __PYX_ERR(0, 1534, __pyx_L18_except_error)
         }
         __pyx_L18_except_error:;
 
-        /* "playhouse/_sqlite_ext.pyx":1531
+        /* "playhouse/_sqlite_ext.pyx":1530
  *             remaining = sqlite3_backup_remaining(backup)
  *             page_count = sqlite3_backup_pagecount(backup)
  *             try:             # <<<<<<<<<<<<<<
  *                 progress(remaining, page_count, rc == SQLITE_DONE)
  *             except:
  */
+        __Pyx_XGIVEREF(__pyx_t_9);
         __Pyx_XGIVEREF(__pyx_t_10);
         __Pyx_XGIVEREF(__pyx_t_11);
-        __Pyx_XGIVEREF(__pyx_t_12);
-        __Pyx_ExceptionReset(__pyx_t_10, __pyx_t_11, __pyx_t_12);
+        __Pyx_ExceptionReset(__pyx_t_9, __pyx_t_10, __pyx_t_11);
         goto __pyx_L1_error;
         __pyx_L23_try_end:;
       }
 
-      /* "playhouse/_sqlite_ext.pyx":1527
+      /* "playhouse/_sqlite_ext.pyx":1526
  *         with nogil:
  *             rc = sqlite3_backup_step(backup, page_step)
  *         if progress is not None:             # <<<<<<<<<<<<<<
  *             # Progress-handler is called with (remaining, page count, is done?)
  *             remaining = sqlite3_backup_remaining(backup)
  */
     }
 
-    /* "playhouse/_sqlite_ext.pyx":1536
+    /* "playhouse/_sqlite_ext.pyx":1535
  *                 sqlite3_backup_finish(backup)
  *                 raise
  *         if rc == SQLITE_BUSY or rc == SQLITE_LOCKED:             # <<<<<<<<<<<<<<
  *             with nogil:
  *                 sqlite3_sleep(250)
  */
     __pyx_t_2 = ((__pyx_v_rc == SQLITE_BUSY) != 0);
     if (!__pyx_t_2) {
     } else {
-      __pyx_t_9 = __pyx_t_2;
+      __pyx_t_8 = __pyx_t_2;
       goto __pyx_L27_bool_binop_done;
     }
     __pyx_t_2 = ((__pyx_v_rc == SQLITE_LOCKED) != 0);
-    __pyx_t_9 = __pyx_t_2;
+    __pyx_t_8 = __pyx_t_2;
     __pyx_L27_bool_binop_done:;
-    if (__pyx_t_9) {
+    if (__pyx_t_8) {
 
-      /* "playhouse/_sqlite_ext.pyx":1537
+      /* "playhouse/_sqlite_ext.pyx":1536
  *                 raise
  *         if rc == SQLITE_BUSY or rc == SQLITE_LOCKED:
  *             with nogil:             # <<<<<<<<<<<<<<
  *                 sqlite3_sleep(250)
  *         elif rc == SQLITE_DONE:
  */
       {
           #ifdef WITH_THREAD
           PyThreadState *_save;
           Py_UNBLOCK_THREADS
           __Pyx_FastGIL_Remember();
           #endif
           /*try:*/ {
 
-            /* "playhouse/_sqlite_ext.pyx":1538
+            /* "playhouse/_sqlite_ext.pyx":1537
  *         if rc == SQLITE_BUSY or rc == SQLITE_LOCKED:
  *             with nogil:
  *                 sqlite3_sleep(250)             # <<<<<<<<<<<<<<
  *         elif rc == SQLITE_DONE:
  *             break
  */
-            (void)(sqlite3_sleep(0xFA));
+            sqlite3_sleep(0xFA);
           }
 
-          /* "playhouse/_sqlite_ext.pyx":1537
+          /* "playhouse/_sqlite_ext.pyx":1536
  *                 raise
  *         if rc == SQLITE_BUSY or rc == SQLITE_LOCKED:
  *             with nogil:             # <<<<<<<<<<<<<<
  *                 sqlite3_sleep(250)
  *         elif rc == SQLITE_DONE:
  */
           /*finally:*/ {
@@ -18209,81 +18209,81 @@
               #endif
               goto __pyx_L33;
             }
             __pyx_L33:;
           }
       }
 
-      /* "playhouse/_sqlite_ext.pyx":1536
+      /* "playhouse/_sqlite_ext.pyx":1535
  *                 sqlite3_backup_finish(backup)
  *                 raise
  *         if rc == SQLITE_BUSY or rc == SQLITE_LOCKED:             # <<<<<<<<<<<<<<
  *             with nogil:
  *                 sqlite3_sleep(250)
  */
       goto __pyx_L26;
     }
 
-    /* "playhouse/_sqlite_ext.pyx":1539
+    /* "playhouse/_sqlite_ext.pyx":1538
  *             with nogil:
  *                 sqlite3_sleep(250)
  *         elif rc == SQLITE_DONE:             # <<<<<<<<<<<<<<
  *             break
  * 
  */
-    __pyx_t_9 = ((__pyx_v_rc == SQLITE_DONE) != 0);
-    if (__pyx_t_9) {
+    __pyx_t_8 = ((__pyx_v_rc == SQLITE_DONE) != 0);
+    if (__pyx_t_8) {
 
-      /* "playhouse/_sqlite_ext.pyx":1540
+      /* "playhouse/_sqlite_ext.pyx":1539
  *                 sqlite3_sleep(250)
  *         elif rc == SQLITE_DONE:
  *             break             # <<<<<<<<<<<<<<
  * 
  *     with nogil:
  */
       goto __pyx_L9_break;
 
-      /* "playhouse/_sqlite_ext.pyx":1539
+      /* "playhouse/_sqlite_ext.pyx":1538
  *             with nogil:
  *                 sqlite3_sleep(250)
  *         elif rc == SQLITE_DONE:             # <<<<<<<<<<<<<<
  *             break
  * 
  */
     }
     __pyx_L26:;
   }
   __pyx_L9_break:;
 
-  /* "playhouse/_sqlite_ext.pyx":1542
+  /* "playhouse/_sqlite_ext.pyx":1541
  *             break
  * 
  *     with nogil:             # <<<<<<<<<<<<<<
  *         sqlite3_backup_finish(backup)
  *     if sqlite3_errcode(dest_db):
  */
   {
       #ifdef WITH_THREAD
       PyThreadState *_save;
       Py_UNBLOCK_THREADS
       __Pyx_FastGIL_Remember();
       #endif
       /*try:*/ {
 
-        /* "playhouse/_sqlite_ext.pyx":1543
+        /* "playhouse/_sqlite_ext.pyx":1542
  * 
  *     with nogil:
  *         sqlite3_backup_finish(backup)             # <<<<<<<<<<<<<<
  *     if sqlite3_errcode(dest_db):
  *         raise OperationalError('Error backuping up database: %s' %
  */
-        (void)(sqlite3_backup_finish(__pyx_v_backup));
+        sqlite3_backup_finish(__pyx_v_backup);
       }
 
-      /* "playhouse/_sqlite_ext.pyx":1542
+      /* "playhouse/_sqlite_ext.pyx":1541
  *             break
  * 
  *     with nogil:             # <<<<<<<<<<<<<<
  *         sqlite3_backup_finish(backup)
  *     if sqlite3_errcode(dest_db):
  */
       /*finally:*/ {
@@ -18294,132 +18294,162 @@
           #endif
           goto __pyx_L36;
         }
         __pyx_L36:;
       }
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1544
+  /* "playhouse/_sqlite_ext.pyx":1543
  *     with nogil:
  *         sqlite3_backup_finish(backup)
  *     if sqlite3_errcode(dest_db):             # <<<<<<<<<<<<<<
  *         raise OperationalError('Error backuping up database: %s' %
  *                                sqlite3_errmsg(dest_db))
  */
-  __pyx_t_9 = (sqlite3_errcode(__pyx_v_dest_db) != 0);
-  if (unlikely(__pyx_t_9)) {
+  __pyx_t_8 = (sqlite3_errcode(__pyx_v_dest_db) != 0);
+  if (__pyx_t_8) {
 
-    /* "playhouse/_sqlite_ext.pyx":1545
+    /* "playhouse/_sqlite_ext.pyx":1544
  *         sqlite3_backup_finish(backup)
  *     if sqlite3_errcode(dest_db):
  *         raise OperationalError('Error backuping up database: %s' %             # <<<<<<<<<<<<<<
  *                                sqlite3_errmsg(dest_db))
  *     return True
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_OperationalError); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1545, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_GetModuleGlobalName(__pyx_n_s_OperationalError); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1544, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
 
-    /* "playhouse/_sqlite_ext.pyx":1546
+    /* "playhouse/_sqlite_ext.pyx":1545
  *     if sqlite3_errcode(dest_db):
  *         raise OperationalError('Error backuping up database: %s' %
  *                                sqlite3_errmsg(dest_db))             # <<<<<<<<<<<<<<
  *     return True
  * 
  */
-    __pyx_t_3 = __Pyx_PyBytes_FromString(sqlite3_errmsg(__pyx_v_dest_db)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1546, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_1 = __Pyx_PyBytes_FromString(sqlite3_errmsg(__pyx_v_dest_db)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1545, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
 
-    /* "playhouse/_sqlite_ext.pyx":1545
+    /* "playhouse/_sqlite_ext.pyx":1544
  *         sqlite3_backup_finish(backup)
  *     if sqlite3_errcode(dest_db):
  *         raise OperationalError('Error backuping up database: %s' %             # <<<<<<<<<<<<<<
  *                                sqlite3_errmsg(dest_db))
  *     return True
  */
-    __pyx_t_13 = __Pyx_PyString_Format(__pyx_kp_s_Error_backuping_up_database_s, __pyx_t_3); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1545, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyString_Format(__pyx_kp_s_Error_backuping_up_database_s, __pyx_t_1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1544, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = NULL;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_14))) {
-      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_14);
-      if (likely(__pyx_t_3)) {
+      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_14);
+      if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_14);
-        __Pyx_INCREF(__pyx_t_3);
+        __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_14, function);
       }
     }
-    __pyx_t_16 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_14, __pyx_t_3, __pyx_t_13) : __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_t_13);
-    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-    if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1545, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_16);
+    if (!__pyx_t_1) {
+      __pyx_t_16 = __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_t_13); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1544, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+      __Pyx_GOTREF(__pyx_t_16);
+    } else {
+      #if CYTHON_FAST_PYCALL
+      if (PyFunction_Check(__pyx_t_14)) {
+        PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_t_13};
+        __pyx_t_16 = __Pyx_PyFunction_FastCall(__pyx_t_14, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1544, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
+        __Pyx_GOTREF(__pyx_t_16);
+        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+      } else
+      #endif
+      #if CYTHON_FAST_PYCCALL
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_14)) {
+        PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_t_13};
+        __pyx_t_16 = __Pyx_PyCFunction_FastCall(__pyx_t_14, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1544, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
+        __Pyx_GOTREF(__pyx_t_16);
+        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+      } else
+      #endif
+      {
+        __pyx_t_12 = PyTuple_New(1+1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1544, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_1); __pyx_t_1 = NULL;
+        __Pyx_GIVEREF(__pyx_t_13);
+        PyTuple_SET_ITEM(__pyx_t_12, 0+1, __pyx_t_13);
+        __pyx_t_13 = 0;
+        __pyx_t_16 = __Pyx_PyObject_Call(__pyx_t_14, __pyx_t_12, NULL); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1544, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_16);
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+      }
+    }
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_Raise(__pyx_t_16, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
-    __PYX_ERR(0, 1545, __pyx_L1_error)
+    __PYX_ERR(0, 1544, __pyx_L1_error)
 
-    /* "playhouse/_sqlite_ext.pyx":1544
+    /* "playhouse/_sqlite_ext.pyx":1543
  *     with nogil:
  *         sqlite3_backup_finish(backup)
  *     if sqlite3_errcode(dest_db):             # <<<<<<<<<<<<<<
  *         raise OperationalError('Error backuping up database: %s' %
  *                                sqlite3_errmsg(dest_db))
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1547
+  /* "playhouse/_sqlite_ext.pyx":1546
  *         raise OperationalError('Error backuping up database: %s' %
  *                                sqlite3_errmsg(dest_db))
  *     return True             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(Py_True);
   __pyx_r = Py_True;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1508
+  /* "playhouse/_sqlite_ext.pyx":1507
  * 
  * 
  * def backup(src_conn, dest_conn, pages=None, name=None, progress=None):             # <<<<<<<<<<<<<<
  *     cdef:
  *         bytes bname = encode(name or 'main')
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_XDECREF(__pyx_t_12);
   __Pyx_XDECREF(__pyx_t_13);
   __Pyx_XDECREF(__pyx_t_14);
   __Pyx_XDECREF(__pyx_t_15);
   __Pyx_XDECREF(__pyx_t_16);
   __Pyx_AddTraceback("playhouse._sqlite_ext.backup", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_bname);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1550
+/* "playhouse/_sqlite_ext.pyx":1549
  * 
  * 
  * def backup_to_file(src_conn, filename, pages=None, name=None, progress=None):             # <<<<<<<<<<<<<<
  *     dest_conn = pysqlite.connect(filename)
  *     backup(src_conn, dest_conn, pages=pages, name=name, progress=progress)
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_31backup_to_file(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_31backup_to_file = {"backup_to_file", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_31backup_to_file, METH_VARARGS|METH_KEYWORDS, 0};
+static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_31backup_to_file = {"backup_to_file", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_31backup_to_file, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_31backup_to_file(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_src_conn = 0;
   PyObject *__pyx_v_filename = 0;
   PyObject *__pyx_v_pages = 0;
   PyObject *__pyx_v_name = 0;
   PyObject *__pyx_v_progress = 0;
   PyObject *__pyx_r = 0;
@@ -18447,43 +18477,43 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_src_conn)) != 0)) kw_args--;
+        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_src_conn)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_filename)) != 0)) kw_args--;
+        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_filename)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("backup_to_file", 0, 2, 5, 1); __PYX_ERR(0, 1550, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("backup_to_file", 0, 2, 5, 1); __PYX_ERR(0, 1549, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pages);
+          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_pages);
           if (value) { values[2] = value; kw_args--; }
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_name);
+          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_name);
           if (value) { values[3] = value; kw_args--; }
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (kw_args > 0) {
-          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_progress);
+          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_progress);
           if (value) { values[4] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "backup_to_file") < 0)) __PYX_ERR(0, 1550, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "backup_to_file") < 0)) __PYX_ERR(0, 1549, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
@@ -18499,15 +18529,15 @@
     __pyx_v_filename = values[1];
     __pyx_v_pages = values[2];
     __pyx_v_name = values[3];
     __pyx_v_progress = values[4];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("backup_to_file", 0, 2, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1550, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("backup_to_file", 0, 2, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1549, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("playhouse._sqlite_ext.backup_to_file", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9playhouse_11_sqlite_ext_30backup_to_file(__pyx_self, __pyx_v_src_conn, __pyx_v_filename, __pyx_v_pages, __pyx_v_name, __pyx_v_progress);
 
@@ -18522,112 +18552,143 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   __Pyx_RefNannySetupContext("backup_to_file", 0);
 
-  /* "playhouse/_sqlite_ext.pyx":1551
+  /* "playhouse/_sqlite_ext.pyx":1550
  * 
  * def backup_to_file(src_conn, filename, pages=None, name=None, progress=None):
  *     dest_conn = pysqlite.connect(filename)             # <<<<<<<<<<<<<<
  *     backup(src_conn, dest_conn, pages=pages, name=name, progress=progress)
  *     dest_conn.close()
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_pysqlite); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1551, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_pysqlite); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1550, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_connect); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1551, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_connect); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1550, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
-  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_filename) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_filename);
-  __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1551, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
+  if (!__pyx_t_2) {
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_filename); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1550, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+  } else {
+    #if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(__pyx_t_3)) {
+      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_v_filename};
+      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1550, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_GOTREF(__pyx_t_1);
+    } else
+    #endif
+    #if CYTHON_FAST_PYCCALL
+    if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
+      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_v_filename};
+      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1550, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_GOTREF(__pyx_t_1);
+    } else
+    #endif
+    {
+      __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1550, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
+      __Pyx_INCREF(__pyx_v_filename);
+      __Pyx_GIVEREF(__pyx_v_filename);
+      PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_filename);
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1550, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    }
+  }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_dest_conn = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1552
+  /* "playhouse/_sqlite_ext.pyx":1551
  * def backup_to_file(src_conn, filename, pages=None, name=None, progress=None):
  *     dest_conn = pysqlite.connect(filename)
  *     backup(src_conn, dest_conn, pages=pages, name=name, progress=progress)             # <<<<<<<<<<<<<<
  *     dest_conn.close()
  *     return True
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_backup); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1552, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_backup); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1551, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1552, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1551, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_v_src_conn);
   __Pyx_GIVEREF(__pyx_v_src_conn);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_src_conn);
   __Pyx_INCREF(__pyx_v_dest_conn);
   __Pyx_GIVEREF(__pyx_v_dest_conn);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_dest_conn);
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1552, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_pages, __pyx_v_pages) < 0) __PYX_ERR(0, 1552, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_name, __pyx_v_name) < 0) __PYX_ERR(0, 1552, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_progress, __pyx_v_progress) < 0) __PYX_ERR(0, 1552, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1552, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1551, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_pages, __pyx_v_pages) < 0) __PYX_ERR(0, 1551, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_name, __pyx_v_name) < 0) __PYX_ERR(0, 1551, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_progress, __pyx_v_progress) < 0) __PYX_ERR(0, 1551, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1551, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1553
+  /* "playhouse/_sqlite_ext.pyx":1552
  *     dest_conn = pysqlite.connect(filename)
  *     backup(src_conn, dest_conn, pages=pages, name=name, progress=progress)
  *     dest_conn.close()             # <<<<<<<<<<<<<<
  *     return True
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_dest_conn, __pyx_n_s_close); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1553, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_dest_conn, __pyx_n_s_close); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1552, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_3 = NULL;
-  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
-    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
+  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
+    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_3)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_2, function);
+      __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
-  __pyx_t_4 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1553, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (__pyx_t_3) {
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1552, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  } else {
+    __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1552, __pyx_L1_error)
+  }
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1554
+  /* "playhouse/_sqlite_ext.pyx":1553
  *     backup(src_conn, dest_conn, pages=pages, name=name, progress=progress)
  *     dest_conn.close()
  *     return True             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(Py_True);
   __pyx_r = Py_True;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1550
+  /* "playhouse/_sqlite_ext.pyx":1549
  * 
  * 
  * def backup_to_file(src_conn, filename, pages=None, name=None, progress=None):             # <<<<<<<<<<<<<<
  *     dest_conn = pysqlite.connect(filename)
  *     backup(src_conn, dest_conn, pages=pages, name=name, progress=progress)
  */
 
@@ -18642,230 +18703,230 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_dest_conn);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "playhouse/_sqlite_ext.pyx":1557
+/* "playhouse/_sqlite_ext.pyx":1556
  * 
  * 
  * cdef int _aggressive_busy_handler(void *ptr, int n) nogil:             # <<<<<<<<<<<<<<
  *     # In concurrent environments, it often seems that if multiple queries are
  *     # kicked off at around the same time, they proceed in lock-step to check
  */
 
 static int __pyx_f_9playhouse_11_sqlite_ext__aggressive_busy_handler(void *__pyx_v_ptr, int __pyx_v_n) {
-  int __pyx_v_busyTimeout;
+  sqlite3_int64 __pyx_v_busyTimeout;
   int __pyx_v_current;
   int __pyx_v_total;
   int __pyx_r;
   int __pyx_t_1;
 
-  /* "playhouse/_sqlite_ext.pyx":1564
+  /* "playhouse/_sqlite_ext.pyx":1563
  *     # attempts in the same time period than the default handler.
  *     cdef:
- *         int busyTimeout = <int>ptr             # <<<<<<<<<<<<<<
+ *         sqlite3_int64 busyTimeout = <sqlite3_int64>ptr             # <<<<<<<<<<<<<<
  *         int current, total
  * 
  */
-  __pyx_v_busyTimeout = ((int)__pyx_v_ptr);
+  __pyx_v_busyTimeout = ((sqlite3_int64)__pyx_v_ptr);
 
-  /* "playhouse/_sqlite_ext.pyx":1567
+  /* "playhouse/_sqlite_ext.pyx":1566
  *         int current, total
  * 
  *     if n < 20:             # <<<<<<<<<<<<<<
  *         current = 25 - (rand() % 10)  # ~20ms
  *         total = n * 20
  */
   __pyx_t_1 = ((__pyx_v_n < 20) != 0);
   if (__pyx_t_1) {
 
-    /* "playhouse/_sqlite_ext.pyx":1568
+    /* "playhouse/_sqlite_ext.pyx":1567
  * 
  *     if n < 20:
  *         current = 25 - (rand() % 10)  # ~20ms             # <<<<<<<<<<<<<<
  *         total = n * 20
  *     elif n < 40:
  */
     __pyx_v_current = (25 - __Pyx_mod_long(rand(), 10));
 
-    /* "playhouse/_sqlite_ext.pyx":1569
+    /* "playhouse/_sqlite_ext.pyx":1568
  *     if n < 20:
  *         current = 25 - (rand() % 10)  # ~20ms
  *         total = n * 20             # <<<<<<<<<<<<<<
  *     elif n < 40:
  *         current = 50 - (rand() % 20)  # ~40ms
  */
     __pyx_v_total = (__pyx_v_n * 20);
 
-    /* "playhouse/_sqlite_ext.pyx":1567
+    /* "playhouse/_sqlite_ext.pyx":1566
  *         int current, total
  * 
  *     if n < 20:             # <<<<<<<<<<<<<<
  *         current = 25 - (rand() % 10)  # ~20ms
  *         total = n * 20
  */
     goto __pyx_L3;
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1570
+  /* "playhouse/_sqlite_ext.pyx":1569
  *         current = 25 - (rand() % 10)  # ~20ms
  *         total = n * 20
  *     elif n < 40:             # <<<<<<<<<<<<<<
  *         current = 50 - (rand() % 20)  # ~40ms
  *         total = 400 + ((n - 20) * 40)
  */
   __pyx_t_1 = ((__pyx_v_n < 40) != 0);
   if (__pyx_t_1) {
 
-    /* "playhouse/_sqlite_ext.pyx":1571
+    /* "playhouse/_sqlite_ext.pyx":1570
  *         total = n * 20
  *     elif n < 40:
  *         current = 50 - (rand() % 20)  # ~40ms             # <<<<<<<<<<<<<<
  *         total = 400 + ((n - 20) * 40)
  *     else:
  */
     __pyx_v_current = (50 - __Pyx_mod_long(rand(), 20));
 
-    /* "playhouse/_sqlite_ext.pyx":1572
+    /* "playhouse/_sqlite_ext.pyx":1571
  *     elif n < 40:
  *         current = 50 - (rand() % 20)  # ~40ms
  *         total = 400 + ((n - 20) * 40)             # <<<<<<<<<<<<<<
  *     else:
  *         current = 120 - (rand() % 40)  # ~100ms
  */
     __pyx_v_total = (0x190 + ((__pyx_v_n - 20) * 40));
 
-    /* "playhouse/_sqlite_ext.pyx":1570
+    /* "playhouse/_sqlite_ext.pyx":1569
  *         current = 25 - (rand() % 10)  # ~20ms
  *         total = n * 20
  *     elif n < 40:             # <<<<<<<<<<<<<<
  *         current = 50 - (rand() % 20)  # ~40ms
  *         total = 400 + ((n - 20) * 40)
  */
     goto __pyx_L3;
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1574
+  /* "playhouse/_sqlite_ext.pyx":1573
  *         total = 400 + ((n - 20) * 40)
  *     else:
  *         current = 120 - (rand() % 40)  # ~100ms             # <<<<<<<<<<<<<<
  *         total = 1200 + ((n - 40) * 100)  # Estimate the amount of time slept.
  * 
  */
   /*else*/ {
     __pyx_v_current = (0x78 - __Pyx_mod_long(rand(), 40));
 
-    /* "playhouse/_sqlite_ext.pyx":1575
+    /* "playhouse/_sqlite_ext.pyx":1574
  *     else:
  *         current = 120 - (rand() % 40)  # ~100ms
  *         total = 1200 + ((n - 40) * 100)  # Estimate the amount of time slept.             # <<<<<<<<<<<<<<
  * 
  *     if total + current > busyTimeout:
  */
     __pyx_v_total = (0x4B0 + ((__pyx_v_n - 40) * 0x64));
   }
   __pyx_L3:;
 
-  /* "playhouse/_sqlite_ext.pyx":1577
+  /* "playhouse/_sqlite_ext.pyx":1576
  *         total = 1200 + ((n - 40) * 100)  # Estimate the amount of time slept.
  * 
  *     if total + current > busyTimeout:             # <<<<<<<<<<<<<<
  *         current = busyTimeout - total
  *     if current > 0:
  */
   __pyx_t_1 = (((__pyx_v_total + __pyx_v_current) > __pyx_v_busyTimeout) != 0);
   if (__pyx_t_1) {
 
-    /* "playhouse/_sqlite_ext.pyx":1578
+    /* "playhouse/_sqlite_ext.pyx":1577
  * 
  *     if total + current > busyTimeout:
  *         current = busyTimeout - total             # <<<<<<<<<<<<<<
  *     if current > 0:
  *         sqlite3_sleep(current)
  */
     __pyx_v_current = (__pyx_v_busyTimeout - __pyx_v_total);
 
-    /* "playhouse/_sqlite_ext.pyx":1577
+    /* "playhouse/_sqlite_ext.pyx":1576
  *         total = 1200 + ((n - 40) * 100)  # Estimate the amount of time slept.
  * 
  *     if total + current > busyTimeout:             # <<<<<<<<<<<<<<
  *         current = busyTimeout - total
  *     if current > 0:
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1579
+  /* "playhouse/_sqlite_ext.pyx":1578
  *     if total + current > busyTimeout:
  *         current = busyTimeout - total
  *     if current > 0:             # <<<<<<<<<<<<<<
  *         sqlite3_sleep(current)
  *         return 1
  */
   __pyx_t_1 = ((__pyx_v_current > 0) != 0);
   if (__pyx_t_1) {
 
-    /* "playhouse/_sqlite_ext.pyx":1580
+    /* "playhouse/_sqlite_ext.pyx":1579
  *         current = busyTimeout - total
  *     if current > 0:
  *         sqlite3_sleep(current)             # <<<<<<<<<<<<<<
  *         return 1
  *     return 0
  */
-    (void)(sqlite3_sleep(__pyx_v_current));
+    sqlite3_sleep(__pyx_v_current);
 
-    /* "playhouse/_sqlite_ext.pyx":1581
+    /* "playhouse/_sqlite_ext.pyx":1580
  *     if current > 0:
  *         sqlite3_sleep(current)
  *         return 1             # <<<<<<<<<<<<<<
  *     return 0
  */
     __pyx_r = 1;
     goto __pyx_L0;
 
-    /* "playhouse/_sqlite_ext.pyx":1579
+    /* "playhouse/_sqlite_ext.pyx":1578
  *     if total + current > busyTimeout:
  *         current = busyTimeout - total
  *     if current > 0:             # <<<<<<<<<<<<<<
  *         sqlite3_sleep(current)
  *         return 1
  */
   }
 
-  /* "playhouse/_sqlite_ext.pyx":1582
+  /* "playhouse/_sqlite_ext.pyx":1581
  *         sqlite3_sleep(current)
  *         return 1
  *     return 0             # <<<<<<<<<<<<<<
  */
   __pyx_r = 0;
   goto __pyx_L0;
 
-  /* "playhouse/_sqlite_ext.pyx":1557
+  /* "playhouse/_sqlite_ext.pyx":1556
  * 
  * 
  * cdef int _aggressive_busy_handler(void *ptr, int n) nogil:             # <<<<<<<<<<<<<<
  *     # In concurrent environments, it often seems that if multiple queries are
  *     # kicked off at around the same time, they proceed in lock-step to check
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
 /* "(tree fragment)":1
  * def __pyx_unpickle_BloomFilterAggregate(__pyx_type, long __pyx_checksum, __pyx_state):             # <<<<<<<<<<<<<<
- *     cdef object __pyx_PickleError
- *     cdef object __pyx_result
+ *     if __pyx_checksum != 0xc9f9d7d:
+ *         from pickle import PickleError as __pyx_PickleError
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_33__pyx_unpickle_BloomFilterAggregate(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_33__pyx_unpickle_BloomFilterAggregate = {"__pyx_unpickle_BloomFilterAggregate", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_33__pyx_unpickle_BloomFilterAggregate, METH_VARARGS|METH_KEYWORDS, 0};
+static PyMethodDef __pyx_mdef_9playhouse_11_sqlite_ext_33__pyx_unpickle_BloomFilterAggregate = {"__pyx_unpickle_BloomFilterAggregate", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_33__pyx_unpickle_BloomFilterAggregate, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_9playhouse_11_sqlite_ext_33__pyx_unpickle_BloomFilterAggregate(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v___pyx_type = 0;
   long __pyx_v___pyx_checksum;
   PyObject *__pyx_v___pyx_state = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__pyx_unpickle_BloomFilterAggregate (wrapper)", 0);
@@ -18884,25 +18945,25 @@
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pyx_type)) != 0)) kw_args--;
+        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_pyx_type)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pyx_checksum)) != 0)) kw_args--;
+        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_pyx_checksum)) != 0)) kw_args--;
         else {
           __Pyx_RaiseArgtupleInvalid("__pyx_unpickle_BloomFilterAggregate", 1, 3, 3, 1); __PYX_ERR(1, 1, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pyx_state)) != 0)) kw_args--;
+        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_pyx_state)) != 0)) kw_args--;
         else {
           __Pyx_RaiseArgtupleInvalid("__pyx_unpickle_BloomFilterAggregate", 1, 3, 3, 2); __PYX_ERR(1, 1, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__pyx_unpickle_BloomFilterAggregate") < 0)) __PYX_ERR(1, 1, __pyx_L3_error)
       }
@@ -18929,194 +18990,252 @@
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 static PyObject *__pyx_pf_9playhouse_11_sqlite_ext_32__pyx_unpickle_BloomFilterAggregate(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v___pyx_type, long __pyx_v___pyx_checksum, PyObject *__pyx_v___pyx_state) {
-  PyObject *__pyx_v___pyx_PickleError = 0;
-  PyObject *__pyx_v___pyx_result = 0;
+  PyObject *__pyx_v___pyx_PickleError = NULL;
+  PyObject *__pyx_v___pyx_result = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
-  int __pyx_t_6;
+  PyObject *__pyx_t_6 = NULL;
+  int __pyx_t_7;
   __Pyx_RefNannySetupContext("__pyx_unpickle_BloomFilterAggregate", 0);
 
-  /* "(tree fragment)":4
- *     cdef object __pyx_PickleError
- *     cdef object __pyx_result
+  /* "(tree fragment)":2
+ * def __pyx_unpickle_BloomFilterAggregate(__pyx_type, long __pyx_checksum, __pyx_state):
  *     if __pyx_checksum != 0xc9f9d7d:             # <<<<<<<<<<<<<<
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError("Incompatible checksums (%s vs 0xc9f9d7d = (bf))" % __pyx_checksum)
  */
   __pyx_t_1 = ((__pyx_v___pyx_checksum != 0xc9f9d7d) != 0);
   if (__pyx_t_1) {
 
-    /* "(tree fragment)":5
- *     cdef object __pyx_result
+    /* "(tree fragment)":3
+ * def __pyx_unpickle_BloomFilterAggregate(__pyx_type, long __pyx_checksum, __pyx_state):
  *     if __pyx_checksum != 0xc9f9d7d:
  *         from pickle import PickleError as __pyx_PickleError             # <<<<<<<<<<<<<<
  *         raise __pyx_PickleError("Incompatible checksums (%s vs 0xc9f9d7d = (bf))" % __pyx_checksum)
  *     __pyx_result = BloomFilterAggregate.__new__(__pyx_type)
  */
-    __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 5, __pyx_L1_error)
+    __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 3, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_n_s_PickleError);
     __Pyx_GIVEREF(__pyx_n_s_PickleError);
     PyList_SET_ITEM(__pyx_t_2, 0, __pyx_n_s_PickleError);
-    __pyx_t_3 = __Pyx_Import(__pyx_n_s_pickle, __pyx_t_2, -1); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 5, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_Import(__pyx_n_s_pickle, __pyx_t_2, -1); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 3, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_3, __pyx_n_s_PickleError); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 5, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_3, __pyx_n_s_PickleError); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 3, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_t_2);
     __pyx_v___pyx_PickleError = __pyx_t_2;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "(tree fragment)":6
+    /* "(tree fragment)":4
  *     if __pyx_checksum != 0xc9f9d7d:
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError("Incompatible checksums (%s vs 0xc9f9d7d = (bf))" % __pyx_checksum)             # <<<<<<<<<<<<<<
  *     __pyx_result = BloomFilterAggregate.__new__(__pyx_type)
  *     if __pyx_state is not None:
  */
-    __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v___pyx_checksum); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 6, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v___pyx_checksum); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 4, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_Incompatible_checksums_s_vs_0xc9, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 6, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_Incompatible_checksums_s_vs_0xc9, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 4, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_INCREF(__pyx_v___pyx_PickleError);
     __pyx_t_2 = __pyx_v___pyx_PickleError; __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
-    __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
-    __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 6, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    if (!__pyx_t_5) {
+      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 4, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __Pyx_GOTREF(__pyx_t_3);
+    } else {
+      #if CYTHON_FAST_PYCALL
+      if (PyFunction_Check(__pyx_t_2)) {
+        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_4};
+        __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 4, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      } else
+      #endif
+      #if CYTHON_FAST_PYCCALL
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
+        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_4};
+        __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 4, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      } else
+      #endif
+      {
+        __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 4, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_6);
+        __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5); __pyx_t_5 = NULL;
+        __Pyx_GIVEREF(__pyx_t_4);
+        PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_t_4);
+        __pyx_t_4 = 0;
+        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 4, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      }
+    }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(1, 6, __pyx_L1_error)
+    __PYX_ERR(1, 4, __pyx_L1_error)
 
-    /* "(tree fragment)":4
- *     cdef object __pyx_PickleError
- *     cdef object __pyx_result
+    /* "(tree fragment)":2
+ * def __pyx_unpickle_BloomFilterAggregate(__pyx_type, long __pyx_checksum, __pyx_state):
  *     if __pyx_checksum != 0xc9f9d7d:             # <<<<<<<<<<<<<<
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError("Incompatible checksums (%s vs 0xc9f9d7d = (bf))" % __pyx_checksum)
  */
   }
 
-  /* "(tree fragment)":7
+  /* "(tree fragment)":5
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError("Incompatible checksums (%s vs 0xc9f9d7d = (bf))" % __pyx_checksum)
  *     __pyx_result = BloomFilterAggregate.__new__(__pyx_type)             # <<<<<<<<<<<<<<
  *     if __pyx_state is not None:
  *         __pyx_unpickle_BloomFilterAggregate__set_state(<BloomFilterAggregate> __pyx_result, __pyx_state)
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_9playhouse_11_sqlite_ext_BloomFilterAggregate), __pyx_n_s_new); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 7, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_9playhouse_11_sqlite_ext_BloomFilterAggregate), __pyx_n_s_new); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 5, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = NULL;
+  __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
-    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
-    if (likely(__pyx_t_4)) {
+    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
+    if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-      __Pyx_INCREF(__pyx_t_4);
+      __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
-  __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_v___pyx_type) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v___pyx_type);
-  __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 7, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  if (!__pyx_t_6) {
+    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v___pyx_type); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 5, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+  } else {
+    #if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(__pyx_t_2)) {
+      PyObject *__pyx_temp[2] = {__pyx_t_6, __pyx_v___pyx_type};
+      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 5, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_GOTREF(__pyx_t_3);
+    } else
+    #endif
+    #if CYTHON_FAST_PYCCALL
+    if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
+      PyObject *__pyx_temp[2] = {__pyx_t_6, __pyx_v___pyx_type};
+      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 5, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_GOTREF(__pyx_t_3);
+    } else
+    #endif
+    {
+      __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 5, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6); __pyx_t_6 = NULL;
+      __Pyx_INCREF(__pyx_v___pyx_type);
+      __Pyx_GIVEREF(__pyx_v___pyx_type);
+      PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v___pyx_type);
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 5, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    }
+  }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v___pyx_result = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "(tree fragment)":8
+  /* "(tree fragment)":6
  *         raise __pyx_PickleError("Incompatible checksums (%s vs 0xc9f9d7d = (bf))" % __pyx_checksum)
  *     __pyx_result = BloomFilterAggregate.__new__(__pyx_type)
  *     if __pyx_state is not None:             # <<<<<<<<<<<<<<
  *         __pyx_unpickle_BloomFilterAggregate__set_state(<BloomFilterAggregate> __pyx_result, __pyx_state)
  *     return __pyx_result
  */
   __pyx_t_1 = (__pyx_v___pyx_state != Py_None);
-  __pyx_t_6 = (__pyx_t_1 != 0);
-  if (__pyx_t_6) {
+  __pyx_t_7 = (__pyx_t_1 != 0);
+  if (__pyx_t_7) {
 
-    /* "(tree fragment)":9
+    /* "(tree fragment)":7
  *     __pyx_result = BloomFilterAggregate.__new__(__pyx_type)
  *     if __pyx_state is not None:
  *         __pyx_unpickle_BloomFilterAggregate__set_state(<BloomFilterAggregate> __pyx_result, __pyx_state)             # <<<<<<<<<<<<<<
  *     return __pyx_result
  * cdef __pyx_unpickle_BloomFilterAggregate__set_state(BloomFilterAggregate __pyx_result, tuple __pyx_state):
  */
-    if (!(likely(PyTuple_CheckExact(__pyx_v___pyx_state))||((__pyx_v___pyx_state) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "tuple", Py_TYPE(__pyx_v___pyx_state)->tp_name), 0))) __PYX_ERR(1, 9, __pyx_L1_error)
-    __pyx_t_3 = __pyx_f_9playhouse_11_sqlite_ext___pyx_unpickle_BloomFilterAggregate__set_state(((struct __pyx_obj_9playhouse_11_sqlite_ext_BloomFilterAggregate *)__pyx_v___pyx_result), ((PyObject*)__pyx_v___pyx_state)); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 9, __pyx_L1_error)
+    if (!(likely(PyTuple_CheckExact(__pyx_v___pyx_state))||((__pyx_v___pyx_state) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "tuple", Py_TYPE(__pyx_v___pyx_state)->tp_name), 0))) __PYX_ERR(1, 7, __pyx_L1_error)
+    __pyx_t_3 = __pyx_f_9playhouse_11_sqlite_ext___pyx_unpickle_BloomFilterAggregate__set_state(((struct __pyx_obj_9playhouse_11_sqlite_ext_BloomFilterAggregate *)__pyx_v___pyx_result), ((PyObject*)__pyx_v___pyx_state)); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 7, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "(tree fragment)":8
+    /* "(tree fragment)":6
  *         raise __pyx_PickleError("Incompatible checksums (%s vs 0xc9f9d7d = (bf))" % __pyx_checksum)
  *     __pyx_result = BloomFilterAggregate.__new__(__pyx_type)
  *     if __pyx_state is not None:             # <<<<<<<<<<<<<<
  *         __pyx_unpickle_BloomFilterAggregate__set_state(<BloomFilterAggregate> __pyx_result, __pyx_state)
  *     return __pyx_result
  */
   }
 
-  /* "(tree fragment)":10
+  /* "(tree fragment)":8
  *     if __pyx_state is not None:
  *         __pyx_unpickle_BloomFilterAggregate__set_state(<BloomFilterAggregate> __pyx_result, __pyx_state)
  *     return __pyx_result             # <<<<<<<<<<<<<<
  * cdef __pyx_unpickle_BloomFilterAggregate__set_state(BloomFilterAggregate __pyx_result, tuple __pyx_state):
  *     __pyx_result.bf = __pyx_state[0]
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v___pyx_result);
   __pyx_r = __pyx_v___pyx_result;
   goto __pyx_L0;
 
   /* "(tree fragment)":1
  * def __pyx_unpickle_BloomFilterAggregate(__pyx_type, long __pyx_checksum, __pyx_state):             # <<<<<<<<<<<<<<
- *     cdef object __pyx_PickleError
- *     cdef object __pyx_result
+ *     if __pyx_checksum != 0xc9f9d7d:
+ *         from pickle import PickleError as __pyx_PickleError
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6);
   __Pyx_AddTraceback("playhouse._sqlite_ext.__pyx_unpickle_BloomFilterAggregate", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v___pyx_PickleError);
   __Pyx_XDECREF(__pyx_v___pyx_result);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "(tree fragment)":11
+/* "(tree fragment)":9
  *         __pyx_unpickle_BloomFilterAggregate__set_state(<BloomFilterAggregate> __pyx_result, __pyx_state)
  *     return __pyx_result
  * cdef __pyx_unpickle_BloomFilterAggregate__set_state(BloomFilterAggregate __pyx_result, tuple __pyx_state):             # <<<<<<<<<<<<<<
  *     __pyx_result.bf = __pyx_state[0]
  *     if len(__pyx_state) > 1 and hasattr(__pyx_result, '__dict__'):
  */
 
@@ -19127,102 +19246,133 @@
   int __pyx_t_2;
   Py_ssize_t __pyx_t_3;
   int __pyx_t_4;
   int __pyx_t_5;
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
+  PyObject *__pyx_t_9 = NULL;
   __Pyx_RefNannySetupContext("__pyx_unpickle_BloomFilterAggregate__set_state", 0);
 
-  /* "(tree fragment)":12
+  /* "(tree fragment)":10
  *     return __pyx_result
  * cdef __pyx_unpickle_BloomFilterAggregate__set_state(BloomFilterAggregate __pyx_result, tuple __pyx_state):
  *     __pyx_result.bf = __pyx_state[0]             # <<<<<<<<<<<<<<
  *     if len(__pyx_state) > 1 and hasattr(__pyx_result, '__dict__'):
  *         __pyx_result.__dict__.update(__pyx_state[1])
  */
   if (unlikely(__pyx_v___pyx_state == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-    __PYX_ERR(1, 12, __pyx_L1_error)
+    __PYX_ERR(1, 10, __pyx_L1_error)
   }
-  __pyx_t_1 = __Pyx_GetItemInt_Tuple(__pyx_v___pyx_state, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 12, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt_Tuple(__pyx_v___pyx_state, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 10, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_9playhouse_11_sqlite_ext_BloomFilter))))) __PYX_ERR(1, 12, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_9playhouse_11_sqlite_ext_BloomFilter))))) __PYX_ERR(1, 10, __pyx_L1_error)
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v___pyx_result->bf);
   __Pyx_DECREF(((PyObject *)__pyx_v___pyx_result->bf));
   __pyx_v___pyx_result->bf = ((struct __pyx_obj_9playhouse_11_sqlite_ext_BloomFilter *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "(tree fragment)":13
+  /* "(tree fragment)":11
  * cdef __pyx_unpickle_BloomFilterAggregate__set_state(BloomFilterAggregate __pyx_result, tuple __pyx_state):
  *     __pyx_result.bf = __pyx_state[0]
  *     if len(__pyx_state) > 1 and hasattr(__pyx_result, '__dict__'):             # <<<<<<<<<<<<<<
  *         __pyx_result.__dict__.update(__pyx_state[1])
  */
   if (unlikely(__pyx_v___pyx_state == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "object of type 'NoneType' has no len()");
-    __PYX_ERR(1, 13, __pyx_L1_error)
+    __PYX_ERR(1, 11, __pyx_L1_error)
   }
-  __pyx_t_3 = PyTuple_GET_SIZE(__pyx_v___pyx_state); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(1, 13, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_GET_SIZE(__pyx_v___pyx_state); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(1, 11, __pyx_L1_error)
   __pyx_t_4 = ((__pyx_t_3 > 1) != 0);
   if (__pyx_t_4) {
   } else {
     __pyx_t_2 = __pyx_t_4;
     goto __pyx_L4_bool_binop_done;
   }
-  __pyx_t_4 = __Pyx_HasAttr(((PyObject *)__pyx_v___pyx_result), __pyx_n_s_dict); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 13, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_HasAttr(((PyObject *)__pyx_v___pyx_result), __pyx_n_s_dict); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 11, __pyx_L1_error)
   __pyx_t_5 = (__pyx_t_4 != 0);
   __pyx_t_2 = __pyx_t_5;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_2) {
 
-    /* "(tree fragment)":14
+    /* "(tree fragment)":12
  *     __pyx_result.bf = __pyx_state[0]
  *     if len(__pyx_state) > 1 and hasattr(__pyx_result, '__dict__'):
  *         __pyx_result.__dict__.update(__pyx_state[1])             # <<<<<<<<<<<<<<
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v___pyx_result), __pyx_n_s_dict); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 14, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v___pyx_result), __pyx_n_s_dict); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 12, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_update); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 14, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_update); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 12, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     if (unlikely(__pyx_v___pyx_state == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-      __PYX_ERR(1, 14, __pyx_L1_error)
+      __PYX_ERR(1, 12, __pyx_L1_error)
     }
-    __pyx_t_6 = __Pyx_GetItemInt_Tuple(__pyx_v___pyx_state, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 14, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_GetItemInt_Tuple(__pyx_v___pyx_state, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 12, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_8 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_8)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
         __Pyx_INCREF(__pyx_t_8);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_7, function);
       }
     }
-    __pyx_t_1 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_8, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_6);
-    __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 14, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
+    if (!__pyx_t_8) {
+      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 12, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_GOTREF(__pyx_t_1);
+    } else {
+      #if CYTHON_FAST_PYCALL
+      if (PyFunction_Check(__pyx_t_7)) {
+        PyObject *__pyx_temp[2] = {__pyx_t_8, __pyx_t_6};
+        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 12, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
+        __Pyx_GOTREF(__pyx_t_1);
+        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      } else
+      #endif
+      #if CYTHON_FAST_PYCCALL
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_7)) {
+        PyObject *__pyx_temp[2] = {__pyx_t_8, __pyx_t_6};
+        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 12, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
+        __Pyx_GOTREF(__pyx_t_1);
+        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      } else
+      #endif
+      {
+        __pyx_t_9 = PyTuple_New(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 12, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_9);
+        __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_8); __pyx_t_8 = NULL;
+        __Pyx_GIVEREF(__pyx_t_6);
+        PyTuple_SET_ITEM(__pyx_t_9, 0+1, __pyx_t_6);
+        __pyx_t_6 = 0;
+        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 12, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+      }
+    }
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "(tree fragment)":13
+    /* "(tree fragment)":11
  * cdef __pyx_unpickle_BloomFilterAggregate__set_state(BloomFilterAggregate __pyx_result, tuple __pyx_state):
  *     __pyx_result.bf = __pyx_state[0]
  *     if len(__pyx_state) > 1 and hasattr(__pyx_result, '__dict__'):             # <<<<<<<<<<<<<<
  *         __pyx_result.__dict__.update(__pyx_state[1])
  */
   }
 
-  /* "(tree fragment)":11
+  /* "(tree fragment)":9
  *         __pyx_unpickle_BloomFilterAggregate__set_state(<BloomFilterAggregate> __pyx_result, __pyx_state)
  *     return __pyx_result
  * cdef __pyx_unpickle_BloomFilterAggregate__set_state(BloomFilterAggregate __pyx_result, tuple __pyx_state):             # <<<<<<<<<<<<<<
  *     __pyx_result.bf = __pyx_state[0]
  *     if len(__pyx_state) > 1 and hasattr(__pyx_result, '__dict__'):
  */
 
@@ -19230,14 +19380,15 @@
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_6);
   __Pyx_XDECREF(__pyx_t_7);
   __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_XDECREF(__pyx_t_9);
   __Pyx_AddTraceback("playhouse._sqlite_ext.__pyx_unpickle_BloomFilterAggregate__set_state", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
@@ -19257,15 +19408,15 @@
   /* "datetime.pxd":105
  * # You have to call it before any usage of DateTime CAPI functions.
  * cdef inline void import_datetime():
  *     PyDateTime_IMPORT             # <<<<<<<<<<<<<<
  * 
  * # Create date object using DateTime CAPI factory function.
  */
-  (void)(PyDateTime_IMPORT);
+  PyDateTime_IMPORT;
 
   /* "datetime.pxd":104
  * # Datetime C API initialization function.
  * # You have to call it before any usage of DateTime CAPI functions.
  * cdef inline void import_datetime():             # <<<<<<<<<<<<<<
  *     PyDateTime_IMPORT
  * 
@@ -19513,15 +19664,16 @@
  *     else:
  *         return None             # <<<<<<<<<<<<<<
  * 
  * # Get tzinfo of datetime
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
-    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+    __Pyx_INCREF(Py_None);
+    __pyx_r = Py_None;
     goto __pyx_L0;
   }
 
   /* "datetime.pxd":133
  * 
  * # Get tzinfo of time
  * cdef inline object time_tzinfo(object o):             # <<<<<<<<<<<<<<
@@ -19586,15 +19738,16 @@
  *     else:
  *         return None             # <<<<<<<<<<<<<<
  * 
  * # Get year of date
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
-    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+    __Pyx_INCREF(Py_None);
+    __pyx_r = Py_None;
     goto __pyx_L0;
   }
 
   /* "datetime.pxd":140
  * 
  * # Get tzinfo of datetime
  * cdef inline object datetime_tzinfo(object o):             # <<<<<<<<<<<<<<
@@ -20373,17 +20526,17 @@
     --Py_REFCNT(o);
     PyErr_Restore(etype, eval, etb);
   }
   (*Py_TYPE(o)->tp_free)(o);
 }
 
 static PyMethodDef __pyx_methods_9playhouse_11_sqlite_ext_BloomFilter[] = {
-  {"add", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_11BloomFilter_5add, METH_VARARGS|METH_KEYWORDS, 0},
+  {"add", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_11BloomFilter_5add, METH_VARARGS|METH_KEYWORDS, 0},
   {"to_buffer", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_11BloomFilter_9to_buffer, METH_NOARGS, 0},
-  {"calculate_size", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_11BloomFilter_11calculate_size, METH_VARARGS|METH_KEYWORDS, 0},
+  {"calculate_size", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_11BloomFilter_11calculate_size, METH_VARARGS|METH_KEYWORDS, 0},
   {"__reduce_cython__", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_11BloomFilter_13__reduce_cython__, METH_NOARGS, 0},
   {"__setstate_cython__", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_11BloomFilter_15__setstate_cython__, METH_O, 0},
   {0, 0, 0, 0}
 };
 
 static PySequenceMethods __pyx_tp_as_sequence_BloomFilter = {
   0, /*sq_length*/
@@ -20497,15 +20650,15 @@
   tmp = ((PyObject*)p->bf);
   p->bf = ((struct __pyx_obj_9playhouse_11_sqlite_ext_BloomFilter *)Py_None); Py_INCREF(Py_None);
   Py_XDECREF(tmp);
   return 0;
 }
 
 static PyMethodDef __pyx_methods_9playhouse_11_sqlite_ext_BloomFilterAggregate[] = {
-  {"step", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_20BloomFilterAggregate_3step, METH_VARARGS|METH_KEYWORDS, 0},
+  {"step", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_20BloomFilterAggregate_3step, METH_VARARGS|METH_KEYWORDS, 0},
   {"finalize", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_20BloomFilterAggregate_5finalize, METH_NOARGS, 0},
   {"__reduce_cython__", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_20BloomFilterAggregate_7__reduce_cython__, METH_NOARGS, 0},
   {"__setstate_cython__", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_20BloomFilterAggregate_9__setstate_cython__, METH_O, 0},
   {0, 0, 0, 0}
 };
 
 static PyTypeObject __pyx_type_9playhouse_11_sqlite_ext_BloomFilterAggregate = {
@@ -20595,16 +20748,16 @@
     --Py_REFCNT(o);
     PyErr_Restore(etype, eval, etb);
   }
   (*Py_TYPE(o)->tp_free)(o);
 }
 
 static PyMethodDef __pyx_methods_9playhouse_11_sqlite_ext_Blob[] = {
-  {"read", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_4Blob_7read, METH_VARARGS|METH_KEYWORDS, 0},
-  {"seek", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_4Blob_9seek, METH_VARARGS|METH_KEYWORDS, 0},
+  {"read", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_4Blob_7read, METH_VARARGS|METH_KEYWORDS, 0},
+  {"seek", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_4Blob_9seek, METH_VARARGS|METH_KEYWORDS, 0},
   {"tell", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_4Blob_11tell, METH_NOARGS, 0},
   {"write", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_4Blob_13write, METH_O, 0},
   {"close", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_4Blob_15close, METH_NOARGS, 0},
   {"reopen", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_4Blob_17reopen, METH_O, 0},
   {"__reduce_cython__", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_4Blob_19__reduce_cython__, METH_NOARGS, 0},
   {"__setstate_cython__", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_4Blob_21__setstate_cython__, METH_O, 0},
   {0, 0, 0, 0}
@@ -20755,15 +20908,15 @@
   return 0;
 }
 
 static PyMethodDef __pyx_methods_9playhouse_11_sqlite_ext_ConnectionHelper[] = {
   {"set_commit_hook", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_16ConnectionHelper_5set_commit_hook, METH_O, 0},
   {"set_rollback_hook", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_16ConnectionHelper_7set_rollback_hook, METH_O, 0},
   {"set_update_hook", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_16ConnectionHelper_9set_update_hook, METH_O, 0},
-  {"set_busy_handler", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_9playhouse_11_sqlite_ext_16ConnectionHelper_11set_busy_handler, METH_VARARGS|METH_KEYWORDS, __pyx_doc_9playhouse_11_sqlite_ext_16ConnectionHelper_10set_busy_handler},
+  {"set_busy_handler", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_16ConnectionHelper_11set_busy_handler, METH_VARARGS|METH_KEYWORDS, __pyx_doc_9playhouse_11_sqlite_ext_16ConnectionHelper_10set_busy_handler},
   {"changes", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_16ConnectionHelper_13changes, METH_NOARGS, 0},
   {"last_insert_rowid", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_16ConnectionHelper_15last_insert_rowid, METH_NOARGS, 0},
   {"autocommit", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_16ConnectionHelper_17autocommit, METH_NOARGS, 0},
   {"__reduce_cython__", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_16ConnectionHelper_19__reduce_cython__, METH_NOARGS, 0},
   {"__setstate_cython__", (PyCFunction)__pyx_pw_9playhouse_11_sqlite_ext_16ConnectionHelper_21__setstate_cython__, METH_O, 0},
   {0, 0, 0, 0}
 };
@@ -20961,39 +21114,26 @@
     NULL, /* m_reload */
   #endif
     NULL, /* m_traverse */
     NULL, /* m_clear */
     NULL /* m_free */
 };
 #endif
-#ifndef CYTHON_SMALL_CODE
-#if defined(__clang__)
-    #define CYTHON_SMALL_CODE
-#elif defined(__GNUC__) && (__GNUC__ > 4 || (__GNUC__ == 4 && __GNUC_MINOR__ >= 3))
-    #define CYTHON_SMALL_CODE __attribute__((cold))
-#else
-    #define CYTHON_SMALL_CODE
-#endif
-#endif
 
 static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_kp_s_, __pyx_k_, sizeof(__pyx_k_), 0, 0, 1, 0},
   {&__pyx_kp_b_3_26, __pyx_k_3_26, sizeof(__pyx_k_3_26), 0, 0, 0, 0},
   {&__pyx_n_s_A_O, __pyx_k_A_O, sizeof(__pyx_k_A_O), 0, 0, 1, 1},
   {&__pyx_n_s_B, __pyx_k_B, sizeof(__pyx_k_B), 0, 0, 1, 1},
   {&__pyx_n_s_Binary, __pyx_k_Binary, sizeof(__pyx_k_Binary), 0, 0, 1, 1},
-  {&__pyx_n_s_Blob, __pyx_k_Blob, sizeof(__pyx_k_Blob), 0, 0, 1, 1},
-  {&__pyx_n_s_BloomFilter, __pyx_k_BloomFilter, sizeof(__pyx_k_BloomFilter), 0, 0, 1, 1},
-  {&__pyx_n_s_BloomFilterAggregate, __pyx_k_BloomFilterAggregate, sizeof(__pyx_k_BloomFilterAggregate), 0, 0, 1, 1},
   {&__pyx_kp_s_CREATE_TABLE_x_s, __pyx_k_CREATE_TABLE_x_s, sizeof(__pyx_k_CREATE_TABLE_x_s), 0, 0, 1, 0},
   {&__pyx_n_s_C_O, __pyx_k_C_O, sizeof(__pyx_k_C_O), 0, 0, 1, 1},
   {&__pyx_kp_s_Cannot_operate_on_closed_blob, __pyx_k_Cannot_operate_on_closed_blob, sizeof(__pyx_k_Cannot_operate_on_closed_blob), 0, 0, 1, 0},
   {&__pyx_kp_s_Cannot_operate_on_closed_databas, __pyx_k_Cannot_operate_on_closed_databas, sizeof(__pyx_k_Cannot_operate_on_closed_databas), 0, 0, 1, 0},
   {&__pyx_kp_s_Column_must_be_either_a_string_o, __pyx_k_Column_must_be_either_a_string_o, sizeof(__pyx_k_Column_must_be_either_a_string_o), 0, 0, 1, 0},
-  {&__pyx_n_s_ConnectionHelper, __pyx_k_ConnectionHelper, sizeof(__pyx_k_ConnectionHelper), 0, 0, 1, 1},
   {&__pyx_n_s_DELETE, __pyx_k_DELETE, sizeof(__pyx_k_DELETE), 0, 0, 1, 1},
   {&__pyx_kp_s_Data_is_too_large_integer_wrap, __pyx_k_Data_is_too_large_integer_wrap, sizeof(__pyx_k_Data_is_too_large_integer_wrap), 0, 0, 1, 0},
   {&__pyx_kp_s_Data_would_go_beyond_end_of_blob, __pyx_k_Data_would_go_beyond_end_of_blob, sizeof(__pyx_k_Data_would_go_beyond_end_of_blob), 0, 0, 1, 0},
   {&__pyx_kp_s_Error_backuping_up_database_s, __pyx_k_Error_backuping_up_database_s, sizeof(__pyx_k_Error_backuping_up_database_s), 0, 0, 1, 0},
   {&__pyx_kp_s_Error_reading_from_blob, __pyx_k_Error_reading_from_blob, sizeof(__pyx_k_Error_reading_from_blob), 0, 0, 1, 0},
   {&__pyx_kp_s_Error_requesting_db_status_s, __pyx_k_Error_requesting_db_status_s, sizeof(__pyx_k_Error_requesting_db_status_s), 0, 0, 1, 0},
   {&__pyx_kp_s_Error_requesting_status_s, __pyx_k_Error_requesting_status_s, sizeof(__pyx_k_Error_requesting_status_s), 0, 0, 1, 0},
@@ -21012,15 +21152,14 @@
   {&__pyx_n_s_Node, __pyx_k_Node, sizeof(__pyx_k_Node), 0, 0, 1, 1},
   {&__pyx_n_s_NotImplementedError, __pyx_k_NotImplementedError, sizeof(__pyx_k_NotImplementedError), 0, 0, 1, 1},
   {&__pyx_n_s_OperationalError, __pyx_k_OperationalError, sizeof(__pyx_k_OperationalError), 0, 0, 1, 1},
   {&__pyx_n_s_P_O, __pyx_k_P_O, sizeof(__pyx_k_P_O), 0, 0, 1, 1},
   {&__pyx_n_s_PickleError, __pyx_k_PickleError, sizeof(__pyx_k_PickleError), 0, 0, 1, 1},
   {&__pyx_n_s_StopIteration, __pyx_k_StopIteration, sizeof(__pyx_k_StopIteration), 0, 0, 1, 1},
   {&__pyx_n_s_TableFunction, __pyx_k_TableFunction, sizeof(__pyx_k_TableFunction), 0, 0, 1, 1},
-  {&__pyx_n_s_TableFunctionImpl, __pyx_k_TableFunctionImpl, sizeof(__pyx_k_TableFunctionImpl), 0, 0, 1, 1},
   {&__pyx_n_s_TableFunction_get_table_columns, __pyx_k_TableFunction_get_table_columns, sizeof(__pyx_k_TableFunction_get_table_columns), 0, 0, 1, 1},
   {&__pyx_n_s_TableFunction_initialize, __pyx_k_TableFunction_initialize, sizeof(__pyx_k_TableFunction_initialize), 0, 0, 1, 1},
   {&__pyx_n_s_TableFunction_iterate, __pyx_k_TableFunction_iterate, sizeof(__pyx_k_TableFunction_iterate), 0, 0, 1, 1},
   {&__pyx_n_s_TableFunction_register, __pyx_k_TableFunction_register, sizeof(__pyx_k_TableFunction_register), 0, 0, 1, 1},
   {&__pyx_n_s_TypeError, __pyx_k_TypeError, sizeof(__pyx_k_TypeError), 0, 0, 1, 1},
   {&__pyx_n_s_UPDATE, __pyx_k_UPDATE, sizeof(__pyx_k_UPDATE), 0, 0, 1, 1},
   {&__pyx_n_s_USE_SQLITE_CONSTRAINT, __pyx_k_USE_SQLITE_CONSTRAINT, sizeof(__pyx_k_USE_SQLITE_CONSTRAINT), 0, 0, 1, 1},
@@ -21037,17 +21176,17 @@
   {&__pyx_kp_s_Y_m_d_H, __pyx_k_Y_m_d_H, sizeof(__pyx_k_Y_m_d_H), 0, 0, 1, 0},
   {&__pyx_kp_s_Y_m_d_H_M, __pyx_k_Y_m_d_H_M, sizeof(__pyx_k_Y_m_d_H_M), 0, 0, 1, 0},
   {&__pyx_kp_s_Y_m_d_H_M_S, __pyx_k_Y_m_d_H_M_S, sizeof(__pyx_k_Y_m_d_H_M_S), 0, 0, 1, 0},
   {&__pyx_kp_s_Y_m_d_H_M_S_f, __pyx_k_Y_m_d_H_M_S_f, sizeof(__pyx_k_Y_m_d_H_M_S_f), 0, 0, 1, 0},
   {&__pyx_n_s_ZeroBlob, __pyx_k_ZeroBlob, sizeof(__pyx_k_ZeroBlob), 0, 0, 1, 1},
   {&__pyx_n_s_ZeroBlob___init, __pyx_k_ZeroBlob___init, sizeof(__pyx_k_ZeroBlob___init), 0, 0, 1, 1},
   {&__pyx_n_s_ZeroBlob___sql, __pyx_k_ZeroBlob___sql, sizeof(__pyx_k_ZeroBlob___sql), 0, 0, 1, 1},
-  {&__pyx_kp_b__12, __pyx_k__12, sizeof(__pyx_k__12), 0, 0, 0, 0},
-  {&__pyx_kp_s__12, __pyx_k__12, sizeof(__pyx_k__12), 0, 0, 1, 0},
-  {&__pyx_kp_s__5, __pyx_k__5, sizeof(__pyx_k__5), 0, 0, 1, 0},
+  {&__pyx_kp_b__17, __pyx_k__17, sizeof(__pyx_k__17), 0, 0, 0, 0},
+  {&__pyx_kp_s__17, __pyx_k__17, sizeof(__pyx_k__17), 0, 0, 1, 0},
+  {&__pyx_kp_s__6, __pyx_k__6, sizeof(__pyx_k__6), 0, 0, 1, 0},
   {&__pyx_n_s_accum, __pyx_k_accum, sizeof(__pyx_k_accum), 0, 0, 1, 1},
   {&__pyx_n_s_add, __pyx_k_add, sizeof(__pyx_k_add), 0, 0, 1, 1},
   {&__pyx_n_s_adler32, __pyx_k_adler32, sizeof(__pyx_k_adler32), 0, 0, 1, 1},
   {&__pyx_n_s_avg_length, __pyx_k_avg_length, sizeof(__pyx_k_avg_length), 0, 0, 1, 1},
   {&__pyx_n_s_b_part, __pyx_k_b_part, sizeof(__pyx_k_b_part), 0, 0, 1, 1},
   {&__pyx_n_s_backup, __pyx_k_backup, sizeof(__pyx_k_backup), 0, 0, 1, 1},
   {&__pyx_n_s_backup_to_file, __pyx_k_backup_to_file, sizeof(__pyx_k_backup_to_file), 0, 0, 1, 1},
@@ -21248,500 +21387,621 @@
   {&__pyx_n_s_weights, __pyx_k_weights, sizeof(__pyx_k_weights), 0, 0, 1, 1},
   {&__pyx_n_s_x, __pyx_k_x, sizeof(__pyx_k_x), 0, 0, 1, 1},
   {&__pyx_n_s_year, __pyx_k_year, sizeof(__pyx_k_year), 0, 0, 1, 1},
   {&__pyx_kp_s_zeroblob_s, __pyx_k_zeroblob_s, sizeof(__pyx_k_zeroblob_s), 0, 0, 1, 0},
   {&__pyx_n_s_zlib, __pyx_k_zlib, sizeof(__pyx_k_zlib), 0, 0, 1, 1},
   {0, 0, 0, 0, 0, 0, 0}
 };
-static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_object = __Pyx_GetBuiltinName(__pyx_n_s_object); if (!__pyx_builtin_object) __PYX_ERR(0, 673, __pyx_L1_error)
+static int __Pyx_InitCachedBuiltins(void) {
+  __pyx_builtin_object = __Pyx_GetBuiltinName(__pyx_n_s_object); if (!__pyx_builtin_object) __PYX_ERR(0, 672, __pyx_L1_error)
   __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 302, __pyx_L1_error)
   __pyx_builtin_StopIteration = __Pyx_GetBuiltinName(__pyx_n_s_StopIteration); if (!__pyx_builtin_StopIteration) __PYX_ERR(0, 469, __pyx_L1_error)
   __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(0, 542, __pyx_L1_error)
   __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(1, 2, __pyx_L1_error)
-  __pyx_builtin_NotImplementedError = __Pyx_GetBuiltinName(__pyx_n_s_NotImplementedError); if (!__pyx_builtin_NotImplementedError) __PYX_ERR(0, 687, __pyx_L1_error)
-  __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(0, 699, __pyx_L1_error)
-  __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(0, 1288, __pyx_L1_error)
+  __pyx_builtin_NotImplementedError = __Pyx_GetBuiltinName(__pyx_n_s_NotImplementedError); if (!__pyx_builtin_NotImplementedError) __PYX_ERR(0, 686, __pyx_L1_error)
+  __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(0, 698, __pyx_L1_error)
+  __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(0, 1287, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
 }
 
-static CYTHON_SMALL_CODE int __Pyx_InitCachedConstants(void) {
+static int __Pyx_InitCachedConstants(void) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants", 0);
 
+  /* "playhouse/_sqlite_ext.pyx":558
+ *     pCur.stopped = False
+ *     try:
+ *         row_data = tuple(table_func.iterate(0))             # <<<<<<<<<<<<<<
+ *     except StopIteration:
+ *         pCur.stopped = True
+ */
+  __pyx_tuple__2 = PyTuple_Pack(1, __pyx_int_0); if (unlikely(!__pyx_tuple__2)) __PYX_ERR(0, 558, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__2);
+  __Pyx_GIVEREF(__pyx_tuple__2);
+
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_tuple__2 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__2)) __PYX_ERR(1, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__2);
-  __Pyx_GIVEREF(__pyx_tuple__2);
+  __pyx_tuple__3 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__3)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__3);
+  __Pyx_GIVEREF(__pyx_tuple__3);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__3 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__3)) __PYX_ERR(1, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__3);
-  __Pyx_GIVEREF(__pyx_tuple__3);
+  __pyx_tuple__4 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__4)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__4);
+  __Pyx_GIVEREF(__pyx_tuple__4);
 
-  /* "playhouse/_sqlite_ext.pyx":699
+  /* "playhouse/_sqlite_ext.pyx":698
  *             if isinstance(column, tuple):
  *                 if len(column) != 2:
  *                     raise ValueError('Column must be either a string or a '             # <<<<<<<<<<<<<<
  *                                      '2-tuple of name, type')
  *                 accum.append('%s %s' % column)
  */
-  __pyx_tuple__4 = PyTuple_Pack(1, __pyx_kp_s_Column_must_be_either_a_string_o); if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 699, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__4);
-  __Pyx_GIVEREF(__pyx_tuple__4);
+  __pyx_tuple__5 = PyTuple_Pack(1, __pyx_kp_s_Column_must_be_either_a_string_o); if (unlikely(!__pyx_tuple__5)) __PYX_ERR(0, 698, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__5);
+  __Pyx_GIVEREF(__pyx_tuple__5);
 
-  /* "playhouse/_sqlite_ext.pyx":1058
+  /* "playhouse/_sqlite_ext.pyx":763
+ *     cdef unicode ukey
+ *     if PyBytes_Check(key):
+ *         ukey = key.decode('utf-8')             # <<<<<<<<<<<<<<
+ *     elif PyUnicode_Check(key):
+ *         ukey = <unicode>key
+ */
+  __pyx_tuple__7 = PyTuple_Pack(1, __pyx_kp_s_utf_8); if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 763, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__7);
+  __Pyx_GIVEREF(__pyx_tuple__7);
+
+  /* "playhouse/_sqlite_ext.pyx":1057
  * 
  * def make_hash(hash_impl):
  *     def inner(*items):             # <<<<<<<<<<<<<<
  *         state = hash_impl()
  *         for item in items:
  */
-  __pyx_tuple__6 = PyTuple_Pack(3, __pyx_n_s_items, __pyx_n_s_state, __pyx_n_s_item); if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 1058, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__6);
-  __Pyx_GIVEREF(__pyx_tuple__6);
-  __pyx_codeobj__7 = (PyObject*)__Pyx_PyCode_New(0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__6, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_inner, 1058, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__7)) __PYX_ERR(0, 1058, __pyx_L1_error)
+  __pyx_tuple__8 = PyTuple_Pack(3, __pyx_n_s_items, __pyx_n_s_state, __pyx_n_s_item); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 1057, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__8);
+  __Pyx_GIVEREF(__pyx_tuple__8);
+  __pyx_codeobj__9 = (PyObject*)__Pyx_PyCode_New(0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__8, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_inner, 1057, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__9)) __PYX_ERR(0, 1057, __pyx_L1_error)
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("self.bf cannot be converted to a Python object for pickling")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("self.bf cannot be converted to a Python object for pickling")
  */
-  __pyx_tuple__8 = PyTuple_Pack(1, __pyx_kp_s_self_bf_cannot_be_converted_to_a); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(1, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__8);
-  __Pyx_GIVEREF(__pyx_tuple__8);
+  __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_s_self_bf_cannot_be_converted_to_a); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__10);
+  __Pyx_GIVEREF(__pyx_tuple__10);
 
   /* "(tree fragment)":4
  *     raise TypeError("self.bf cannot be converted to a Python object for pickling")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("self.bf cannot be converted to a Python object for pickling")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_s_self_bf_cannot_be_converted_to_a); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(1, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__9);
-  __Pyx_GIVEREF(__pyx_tuple__9);
+  __pyx_tuple__11 = PyTuple_Pack(1, __pyx_kp_s_self_bf_cannot_be_converted_to_a); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__11);
+  __Pyx_GIVEREF(__pyx_tuple__11);
 
-  /* "playhouse/_sqlite_ext.pyx":1243
+  /* "playhouse/_sqlite_ext.pyx":1235
+ *     """
+ *     if not conn.db:
+ *         raise InterfaceError('Cannot operate on closed database.')             # <<<<<<<<<<<<<<
+ *     return 1
+ * 
+ */
+  __pyx_tuple__12 = PyTuple_Pack(1, __pyx_kp_s_Cannot_operate_on_closed_databas); if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 1235, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__12);
+  __Pyx_GIVEREF(__pyx_tuple__12);
+
+  /* "playhouse/_sqlite_ext.pyx":1242
  *     def __init__(self, length):
  *         if not isinstance(length, int) or length < 0:
  *             raise ValueError('Length must be a positive integer.')             # <<<<<<<<<<<<<<
  *         self.length = length
  * 
  */
-  __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_s_Length_must_be_a_positive_intege); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(0, 1243, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__10);
-  __Pyx_GIVEREF(__pyx_tuple__10);
+  __pyx_tuple__13 = PyTuple_Pack(1, __pyx_kp_s_Length_must_be_a_positive_intege); if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 1242, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__13);
+  __Pyx_GIVEREF(__pyx_tuple__13);
+
+  /* "playhouse/_sqlite_ext.pyx":1254
+ * cdef inline int _check_blob_closed(Blob blob) except -1:
+ *     if not blob.pBlob:
+ *         raise InterfaceError('Cannot operate on closed blob.')             # <<<<<<<<<<<<<<
+ *     return 1
+ * 
+ */
+  __pyx_tuple__14 = PyTuple_Pack(1, __pyx_kp_s_Cannot_operate_on_closed_blob); if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 1254, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__14);
+  __Pyx_GIVEREF(__pyx_tuple__14);
+
+  /* "playhouse/_sqlite_ext.pyx":1285
+ *             &blob)
+ *         if rc != SQLITE_OK:
+ *             raise OperationalError('Unable to open blob.')             # <<<<<<<<<<<<<<
+ *         if not blob:
+ *             raise MemoryError('Unable to allocate blob.')
+ */
+  __pyx_tuple__15 = PyTuple_Pack(1, __pyx_kp_s_Unable_to_open_blob); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 1285, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__15);
+  __Pyx_GIVEREF(__pyx_tuple__15);
 
-  /* "playhouse/_sqlite_ext.pyx":1288
+  /* "playhouse/_sqlite_ext.pyx":1287
  *             raise OperationalError('Unable to open blob.')
  *         if not blob:
  *             raise MemoryError('Unable to allocate blob.')             # <<<<<<<<<<<<<<
  * 
  *         self.pBlob = blob
  */
-  __pyx_tuple__11 = PyTuple_Pack(1, __pyx_kp_s_Unable_to_allocate_blob); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 1288, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__11);
-  __Pyx_GIVEREF(__pyx_tuple__11);
+  __pyx_tuple__16 = PyTuple_Pack(1, __pyx_kp_s_Unable_to_allocate_blob); if (unlikely(!__pyx_tuple__16)) __PYX_ERR(0, 1287, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__16);
+  __Pyx_GIVEREF(__pyx_tuple__16);
 
-  /* "playhouse/_sqlite_ext.pyx":1341
+  /* "playhouse/_sqlite_ext.pyx":1329
+ *         if sqlite3_blob_read(self.pBlob, buf, length, self.offset):
+ *             self._close()
+ *             raise OperationalError('Error reading from blob.')             # <<<<<<<<<<<<<<
+ * 
+ *         self.offset += length
+ */
+  __pyx_tuple__18 = PyTuple_Pack(1, __pyx_kp_s_Error_reading_from_blob); if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 1329, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__18);
+  __Pyx_GIVEREF(__pyx_tuple__18);
+
+  /* "playhouse/_sqlite_ext.pyx":1340
  *         if frame_of_reference == 0:
  *             if offset < 0 or offset > size:
  *                 raise ValueError('seek() offset outside of valid range.')             # <<<<<<<<<<<<<<
  *             self.offset = offset
  *         elif frame_of_reference == 1:
  */
-  __pyx_tuple__13 = PyTuple_Pack(1, __pyx_kp_s_seek_offset_outside_of_valid_ran); if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 1341, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__13);
-  __Pyx_GIVEREF(__pyx_tuple__13);
+  __pyx_tuple__19 = PyTuple_Pack(1, __pyx_kp_s_seek_offset_outside_of_valid_ran); if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 1340, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__19);
+  __Pyx_GIVEREF(__pyx_tuple__19);
+
+  /* "playhouse/_sqlite_ext.pyx":1344
+ *         elif frame_of_reference == 1:
+ *             if self.offset + offset < 0 or self.offset + offset > size:
+ *                 raise ValueError('seek() offset outside of valid range.')             # <<<<<<<<<<<<<<
+ *             self.offset += offset
+ *         elif frame_of_reference == 2:
+ */
+  __pyx_tuple__20 = PyTuple_Pack(1, __pyx_kp_s_seek_offset_outside_of_valid_ran); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 1344, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__20);
+  __Pyx_GIVEREF(__pyx_tuple__20);
 
-  /* "playhouse/_sqlite_ext.pyx":1352
+  /* "playhouse/_sqlite_ext.pyx":1348
+ *         elif frame_of_reference == 2:
+ *             if size + offset < 0 or size + offset > size:
+ *                 raise ValueError('seek() offset outside of valid range.')             # <<<<<<<<<<<<<<
+ *             self.offset = size + offset
+ *         else:
+ */
+  __pyx_tuple__21 = PyTuple_Pack(1, __pyx_kp_s_seek_offset_outside_of_valid_ran); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 1348, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__21);
+  __Pyx_GIVEREF(__pyx_tuple__21);
+
+  /* "playhouse/_sqlite_ext.pyx":1351
  *             self.offset = size + offset
  *         else:
  *             raise ValueError('seek() frame of reference must be 0, 1 or 2.')             # <<<<<<<<<<<<<<
  * 
  *     def tell(self):
  */
-  __pyx_tuple__14 = PyTuple_Pack(1, __pyx_kp_s_seek_frame_of_reference_must_be); if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 1352, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__14);
-  __Pyx_GIVEREF(__pyx_tuple__14);
+  __pyx_tuple__22 = PyTuple_Pack(1, __pyx_kp_s_seek_frame_of_reference_must_be); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 1351, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__22);
+  __Pyx_GIVEREF(__pyx_tuple__22);
 
-  /* "playhouse/_sqlite_ext.pyx":1368
+  /* "playhouse/_sqlite_ext.pyx":1367
  *         PyBytes_AsStringAndSize(data, &buf, &buflen)
  *         if (<int>(buflen + self.offset)) < self.offset:
  *             raise ValueError('Data is too large (integer wrap)')             # <<<<<<<<<<<<<<
  *         if (<int>(buflen + self.offset)) > size:
  *             raise ValueError('Data would go beyond end of blob')
  */
-  __pyx_tuple__15 = PyTuple_Pack(1, __pyx_kp_s_Data_is_too_large_integer_wrap); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 1368, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__15);
-  __Pyx_GIVEREF(__pyx_tuple__15);
+  __pyx_tuple__23 = PyTuple_Pack(1, __pyx_kp_s_Data_is_too_large_integer_wrap); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 1367, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__23);
+  __Pyx_GIVEREF(__pyx_tuple__23);
 
-  /* "playhouse/_sqlite_ext.pyx":1370
+  /* "playhouse/_sqlite_ext.pyx":1369
  *             raise ValueError('Data is too large (integer wrap)')
  *         if (<int>(buflen + self.offset)) > size:
  *             raise ValueError('Data would go beyond end of blob')             # <<<<<<<<<<<<<<
  *         if sqlite3_blob_write(self.pBlob, buf, buflen, self.offset):
  *             raise OperationalError('Error writing to blob.')
  */
-  __pyx_tuple__16 = PyTuple_Pack(1, __pyx_kp_s_Data_would_go_beyond_end_of_blob); if (unlikely(!__pyx_tuple__16)) __PYX_ERR(0, 1370, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__16);
-  __Pyx_GIVEREF(__pyx_tuple__16);
+  __pyx_tuple__24 = PyTuple_Pack(1, __pyx_kp_s_Data_would_go_beyond_end_of_blob); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 1369, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__24);
+  __Pyx_GIVEREF(__pyx_tuple__24);
+
+  /* "playhouse/_sqlite_ext.pyx":1371
+ *             raise ValueError('Data would go beyond end of blob')
+ *         if sqlite3_blob_write(self.pBlob, buf, buflen, self.offset):
+ *             raise OperationalError('Error writing to blob.')             # <<<<<<<<<<<<<<
+ *         self.offset += <int>buflen
+ * 
+ */
+  __pyx_tuple__25 = PyTuple_Pack(1, __pyx_kp_s_Error_writing_to_blob); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 1371, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__25);
+  __Pyx_GIVEREF(__pyx_tuple__25);
+
+  /* "playhouse/_sqlite_ext.pyx":1382
+ *         if sqlite3_blob_reopen(self.pBlob, <long long>rowid):
+ *             self._close()
+ *             raise OperationalError('Unable to re-open blob.')             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __pyx_tuple__26 = PyTuple_Pack(1, __pyx_kp_s_Unable_to_re_open_blob); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 1382, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__26);
+  __Pyx_GIVEREF(__pyx_tuple__26);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("self.conn,self.pBlob cannot be converted to a Python object for pickling")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("self.conn,self.pBlob cannot be converted to a Python object for pickling")
  */
-  __pyx_tuple__17 = PyTuple_Pack(1, __pyx_kp_s_self_conn_self_pBlob_cannot_be_c); if (unlikely(!__pyx_tuple__17)) __PYX_ERR(1, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__17);
-  __Pyx_GIVEREF(__pyx_tuple__17);
+  __pyx_tuple__27 = PyTuple_Pack(1, __pyx_kp_s_self_conn_self_pBlob_cannot_be_c); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__27);
+  __Pyx_GIVEREF(__pyx_tuple__27);
 
   /* "(tree fragment)":4
  *     raise TypeError("self.conn,self.pBlob cannot be converted to a Python object for pickling")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("self.conn,self.pBlob cannot be converted to a Python object for pickling")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__18 = PyTuple_Pack(1, __pyx_kp_s_self_conn_self_pBlob_cannot_be_c); if (unlikely(!__pyx_tuple__18)) __PYX_ERR(1, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__18);
-  __Pyx_GIVEREF(__pyx_tuple__18);
+  __pyx_tuple__28 = PyTuple_Pack(1, __pyx_kp_s_self_conn_self_pBlob_cannot_be_c); if (unlikely(!__pyx_tuple__28)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__28);
+  __Pyx_GIVEREF(__pyx_tuple__28);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("self.conn cannot be converted to a Python object for pickling")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("self.conn cannot be converted to a Python object for pickling")
  */
-  __pyx_tuple__19 = PyTuple_Pack(1, __pyx_kp_s_self_conn_cannot_be_converted_to); if (unlikely(!__pyx_tuple__19)) __PYX_ERR(1, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__19);
-  __Pyx_GIVEREF(__pyx_tuple__19);
+  __pyx_tuple__29 = PyTuple_Pack(1, __pyx_kp_s_self_conn_cannot_be_converted_to); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__29);
+  __Pyx_GIVEREF(__pyx_tuple__29);
 
   /* "(tree fragment)":4
  *     raise TypeError("self.conn cannot be converted to a Python object for pickling")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("self.conn cannot be converted to a Python object for pickling")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__20 = PyTuple_Pack(1, __pyx_kp_s_self_conn_cannot_be_converted_to); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(1, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__20);
-  __Pyx_GIVEREF(__pyx_tuple__20);
+  __pyx_tuple__30 = PyTuple_Pack(1, __pyx_kp_s_self_conn_cannot_be_converted_to); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__30);
+  __Pyx_GIVEREF(__pyx_tuple__30);
 
-  /* "playhouse/_sqlite_ext.pyx":673
+  /* "playhouse/_sqlite_ext.pyx":1521
+ *     backup = sqlite3_backup_init(dest_db, b'main', src_db, bname)
+ *     if backup == NULL:
+ *         raise OperationalError('Unable to initialize backup.')             # <<<<<<<<<<<<<<
+ * 
+ *     while True:
+ */
+  __pyx_tuple__31 = PyTuple_Pack(1, __pyx_kp_s_Unable_to_initialize_backup); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 1521, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__31);
+  __Pyx_GIVEREF(__pyx_tuple__31);
+
+  /* "playhouse/_sqlite_ext.pyx":672
  * 
  * 
  * class TableFunction(object):             # <<<<<<<<<<<<<<
  *     columns = None
  *     params = None
  */
-  __pyx_tuple__21 = PyTuple_Pack(1, __pyx_builtin_object); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 673, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__21);
-  __Pyx_GIVEREF(__pyx_tuple__21);
+  __pyx_tuple__32 = PyTuple_Pack(1, __pyx_builtin_object); if (unlikely(!__pyx_tuple__32)) __PYX_ERR(0, 672, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__32);
+  __Pyx_GIVEREF(__pyx_tuple__32);
 
-  /* "playhouse/_sqlite_ext.pyx":681
+  /* "playhouse/_sqlite_ext.pyx":680
  * 
  *     @classmethod
  *     def register(cls, conn):             # <<<<<<<<<<<<<<
  *         cdef _TableFunctionImpl impl = _TableFunctionImpl(cls)
  *         impl.create_module(<pysqlite_Connection *>conn)
  */
-  __pyx_tuple__22 = PyTuple_Pack(3, __pyx_n_s_cls, __pyx_n_s_conn, __pyx_n_s_impl); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 681, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__22);
-  __Pyx_GIVEREF(__pyx_tuple__22);
-  __pyx_codeobj__23 = (PyObject*)__Pyx_PyCode_New(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__22, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_register, 681, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__23)) __PYX_ERR(0, 681, __pyx_L1_error)
+  __pyx_tuple__33 = PyTuple_Pack(3, __pyx_n_s_cls, __pyx_n_s_conn, __pyx_n_s_impl); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(0, 680, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__33);
+  __Pyx_GIVEREF(__pyx_tuple__33);
+  __pyx_codeobj__34 = (PyObject*)__Pyx_PyCode_New(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__33, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_register, 680, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__34)) __PYX_ERR(0, 680, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":686
+  /* "playhouse/_sqlite_ext.pyx":685
  *         cls._ncols = len(cls.columns)
  * 
  *     def initialize(self, **filters):             # <<<<<<<<<<<<<<
  *         raise NotImplementedError
  * 
  */
-  __pyx_tuple__24 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_filters); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 686, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__24);
-  __Pyx_GIVEREF(__pyx_tuple__24);
-  __pyx_codeobj__25 = (PyObject*)__Pyx_PyCode_New(1, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__24, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_initialize, 686, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__25)) __PYX_ERR(0, 686, __pyx_L1_error)
+  __pyx_tuple__35 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_filters); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 685, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__35);
+  __Pyx_GIVEREF(__pyx_tuple__35);
+  __pyx_codeobj__36 = (PyObject*)__Pyx_PyCode_New(1, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__35, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_initialize, 685, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__36)) __PYX_ERR(0, 685, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":689
+  /* "playhouse/_sqlite_ext.pyx":688
  *         raise NotImplementedError
  * 
  *     def iterate(self, idx):             # <<<<<<<<<<<<<<
  *         raise NotImplementedError
  * 
  */
-  __pyx_tuple__26 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_idx); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 689, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__26);
-  __Pyx_GIVEREF(__pyx_tuple__26);
-  __pyx_codeobj__27 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__26, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_iterate, 689, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__27)) __PYX_ERR(0, 689, __pyx_L1_error)
+  __pyx_tuple__37 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_idx); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(0, 688, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__37);
+  __Pyx_GIVEREF(__pyx_tuple__37);
+  __pyx_codeobj__38 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__37, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_iterate, 688, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__38)) __PYX_ERR(0, 688, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":693
+  /* "playhouse/_sqlite_ext.pyx":692
  * 
  *     @classmethod
  *     def get_table_columns_declaration(cls):             # <<<<<<<<<<<<<<
  *         cdef list accum = []
  * 
  */
-  __pyx_tuple__28 = PyTuple_Pack(4, __pyx_n_s_cls, __pyx_n_s_accum, __pyx_n_s_column, __pyx_n_s_param); if (unlikely(!__pyx_tuple__28)) __PYX_ERR(0, 693, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__28);
-  __Pyx_GIVEREF(__pyx_tuple__28);
-  __pyx_codeobj__29 = (PyObject*)__Pyx_PyCode_New(1, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__28, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_get_table_columns_declaration, 693, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__29)) __PYX_ERR(0, 693, __pyx_L1_error)
+  __pyx_tuple__39 = PyTuple_Pack(4, __pyx_n_s_cls, __pyx_n_s_accum, __pyx_n_s_column, __pyx_n_s_param); if (unlikely(!__pyx_tuple__39)) __PYX_ERR(0, 692, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__39);
+  __Pyx_GIVEREF(__pyx_tuple__39);
+  __pyx_codeobj__40 = (PyObject*)__Pyx_PyCode_New(1, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__39, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_get_table_columns_declaration, 692, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__40)) __PYX_ERR(0, 692, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":712
+  /* "playhouse/_sqlite_ext.pyx":711
  * 
  * cdef tuple SQLITE_DATETIME_FORMATS = (
  *     '%Y-%m-%d %H:%M:%S',             # <<<<<<<<<<<<<<
  *     '%Y-%m-%d %H:%M:%S.%f',
  *     '%Y-%m-%d',
  */
-  __pyx_tuple__30 = PyTuple_Pack(6, __pyx_kp_s_Y_m_d_H_M_S, __pyx_kp_s_Y_m_d_H_M_S_f, __pyx_kp_s_Y_m_d, __pyx_kp_s_H_M_S, __pyx_kp_s_H_M_S_f, __pyx_kp_s_H_M); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(0, 712, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__30);
-  __Pyx_GIVEREF(__pyx_tuple__30);
+  __pyx_tuple__41 = PyTuple_Pack(6, __pyx_kp_s_Y_m_d_H_M_S, __pyx_kp_s_Y_m_d_H_M_S_f, __pyx_kp_s_Y_m_d, __pyx_kp_s_H_M_S, __pyx_kp_s_H_M_S_f, __pyx_kp_s_H_M); if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 711, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__41);
+  __Pyx_GIVEREF(__pyx_tuple__41);
 
-  /* "playhouse/_sqlite_ext.pyx":790
+  /* "playhouse/_sqlite_ext.pyx":789
  * 
  * 
  * def peewee_rank(py_match_info, *raw_weights):             # <<<<<<<<<<<<<<
  *     cdef:
  *         unsigned int *match_info
  */
-  __pyx_tuple__31 = PyTuple_Pack(18, __pyx_n_s_py_match_info, __pyx_n_s_raw_weights, __pyx_n_s_match_info, __pyx_n_s_phrase_info, __pyx_n_s_match_info_buf, __pyx_n_s_match_info_buf_2, __pyx_n_s_nphrase, __pyx_n_s_ncol, __pyx_n_s_icol, __pyx_n_s_iphrase, __pyx_n_s_hits, __pyx_n_s_global_hits, __pyx_n_s_P_O, __pyx_n_s_C_O, __pyx_n_s_X_O, __pyx_n_s_score, __pyx_n_s_weight, __pyx_n_s_weights); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 790, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__31);
-  __Pyx_GIVEREF(__pyx_tuple__31);
-  __pyx_codeobj__32 = (PyObject*)__Pyx_PyCode_New(1, 0, 18, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__31, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_peewee_rank, 790, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__32)) __PYX_ERR(0, 790, __pyx_L1_error)
+  __pyx_tuple__42 = PyTuple_Pack(18, __pyx_n_s_py_match_info, __pyx_n_s_raw_weights, __pyx_n_s_match_info, __pyx_n_s_phrase_info, __pyx_n_s_match_info_buf, __pyx_n_s_match_info_buf_2, __pyx_n_s_nphrase, __pyx_n_s_ncol, __pyx_n_s_icol, __pyx_n_s_iphrase, __pyx_n_s_hits, __pyx_n_s_global_hits, __pyx_n_s_P_O, __pyx_n_s_C_O, __pyx_n_s_X_O, __pyx_n_s_score, __pyx_n_s_weight, __pyx_n_s_weights); if (unlikely(!__pyx_tuple__42)) __PYX_ERR(0, 789, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__42);
+  __Pyx_GIVEREF(__pyx_tuple__42);
+  __pyx_codeobj__43 = (PyObject*)__Pyx_PyCode_New(1, 0, 18, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__42, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_peewee_rank, 789, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__43)) __PYX_ERR(0, 789, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":832
+  /* "playhouse/_sqlite_ext.pyx":831
  * 
  * 
  * def peewee_lucene(py_match_info, *raw_weights):             # <<<<<<<<<<<<<<
  *     # Usage: peewee_lucene(matchinfo(table, 'pcnalx'), 1)
  *     cdef:
  */
-  __pyx_tuple__33 = PyTuple_Pack(28, __pyx_n_s_py_match_info, __pyx_n_s_raw_weights, __pyx_n_s_match_info, __pyx_n_s_match_info_buf, __pyx_n_s_match_info_buf_2, __pyx_n_s_nphrase, __pyx_n_s_ncol, __pyx_n_s_total_docs, __pyx_n_s_term_frequency, __pyx_n_s_doc_length, __pyx_n_s_docs_with_term, __pyx_n_s_avg_length, __pyx_n_s_idf, __pyx_n_s_weight, __pyx_n_s_rhs, __pyx_n_s_denom, __pyx_n_s_weights, __pyx_n_s_P_O, __pyx_n_s_C_O, __pyx_n_s_N_O, __pyx_n_s_L_O, __pyx_n_s_X_O, __pyx_n_s_iphrase, __pyx_n_s_icol, __pyx_n_s_x, __pyx_n_s_score, __pyx_n_s_tf, __pyx_n_s_fieldNorms); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(0, 832, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__33);
-  __Pyx_GIVEREF(__pyx_tuple__33);
-  __pyx_codeobj__34 = (PyObject*)__Pyx_PyCode_New(1, 0, 28, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__33, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_peewee_lucene, 832, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__34)) __PYX_ERR(0, 832, __pyx_L1_error)
+  __pyx_tuple__44 = PyTuple_Pack(28, __pyx_n_s_py_match_info, __pyx_n_s_raw_weights, __pyx_n_s_match_info, __pyx_n_s_match_info_buf, __pyx_n_s_match_info_buf_2, __pyx_n_s_nphrase, __pyx_n_s_ncol, __pyx_n_s_total_docs, __pyx_n_s_term_frequency, __pyx_n_s_doc_length, __pyx_n_s_docs_with_term, __pyx_n_s_avg_length, __pyx_n_s_idf, __pyx_n_s_weight, __pyx_n_s_rhs, __pyx_n_s_denom, __pyx_n_s_weights, __pyx_n_s_P_O, __pyx_n_s_C_O, __pyx_n_s_N_O, __pyx_n_s_L_O, __pyx_n_s_X_O, __pyx_n_s_iphrase, __pyx_n_s_icol, __pyx_n_s_x, __pyx_n_s_score, __pyx_n_s_tf, __pyx_n_s_fieldNorms); if (unlikely(!__pyx_tuple__44)) __PYX_ERR(0, 831, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__44);
+  __Pyx_GIVEREF(__pyx_tuple__44);
+  __pyx_codeobj__45 = (PyObject*)__Pyx_PyCode_New(1, 0, 28, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__44, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_peewee_lucene, 831, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__45)) __PYX_ERR(0, 831, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":874
+  /* "playhouse/_sqlite_ext.pyx":873
  * 
  * 
  * def peewee_bm25(py_match_info, *raw_weights):             # <<<<<<<<<<<<<<
  *     # Usage: peewee_bm25(matchinfo(table, 'pcnalx'), 1)
  *     # where the second parameter is the index of the column and
  */
-  __pyx_tuple__35 = PyTuple_Pack(32, __pyx_n_s_py_match_info, __pyx_n_s_raw_weights, __pyx_n_s_match_info, __pyx_n_s_match_info_buf, __pyx_n_s_match_info_buf_2, __pyx_n_s_nphrase, __pyx_n_s_ncol, __pyx_n_s_B, __pyx_n_s_K, __pyx_n_s_total_docs, __pyx_n_s_term_frequency, __pyx_n_s_doc_length, __pyx_n_s_docs_with_term, __pyx_n_s_avg_length, __pyx_n_s_idf, __pyx_n_s_weight, __pyx_n_s_ratio, __pyx_n_s_num, __pyx_n_s_b_part, __pyx_n_s_denom, __pyx_n_s_pc_score, __pyx_n_s_weights, __pyx_n_s_P_O, __pyx_n_s_C_O, __pyx_n_s_N_O, __pyx_n_s_A_O, __pyx_n_s_L_O, __pyx_n_s_X_O, __pyx_n_s_iphrase, __pyx_n_s_icol, __pyx_n_s_x, __pyx_n_s_score); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 874, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__35);
-  __Pyx_GIVEREF(__pyx_tuple__35);
-  __pyx_codeobj__36 = (PyObject*)__Pyx_PyCode_New(1, 0, 32, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__35, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_peewee_bm25, 874, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__36)) __PYX_ERR(0, 874, __pyx_L1_error)
+  __pyx_tuple__46 = PyTuple_Pack(32, __pyx_n_s_py_match_info, __pyx_n_s_raw_weights, __pyx_n_s_match_info, __pyx_n_s_match_info_buf, __pyx_n_s_match_info_buf_2, __pyx_n_s_nphrase, __pyx_n_s_ncol, __pyx_n_s_B, __pyx_n_s_K, __pyx_n_s_total_docs, __pyx_n_s_term_frequency, __pyx_n_s_doc_length, __pyx_n_s_docs_with_term, __pyx_n_s_avg_length, __pyx_n_s_idf, __pyx_n_s_weight, __pyx_n_s_ratio, __pyx_n_s_num, __pyx_n_s_b_part, __pyx_n_s_denom, __pyx_n_s_pc_score, __pyx_n_s_weights, __pyx_n_s_P_O, __pyx_n_s_C_O, __pyx_n_s_N_O, __pyx_n_s_A_O, __pyx_n_s_L_O, __pyx_n_s_X_O, __pyx_n_s_iphrase, __pyx_n_s_icol, __pyx_n_s_x, __pyx_n_s_score); if (unlikely(!__pyx_tuple__46)) __PYX_ERR(0, 873, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__46);
+  __Pyx_GIVEREF(__pyx_tuple__46);
+  __pyx_codeobj__47 = (PyObject*)__Pyx_PyCode_New(1, 0, 32, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__46, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_peewee_bm25, 873, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__47)) __PYX_ERR(0, 873, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":945
+  /* "playhouse/_sqlite_ext.pyx":944
  * 
  * 
  * def peewee_bm25f(py_match_info, *raw_weights):             # <<<<<<<<<<<<<<
  *     # Usage: peewee_bm25f(matchinfo(table, 'pcnalx'), 1)
  *     # where the second parameter is the index of the column and
  */
-  __pyx_tuple__37 = PyTuple_Pack(33, __pyx_n_s_py_match_info, __pyx_n_s_raw_weights, __pyx_n_s_match_info, __pyx_n_s_match_info_buf, __pyx_n_s_match_info_buf_2, __pyx_n_s_nphrase, __pyx_n_s_ncol, __pyx_n_s_B, __pyx_n_s_K, __pyx_n_s_epsilon, __pyx_n_s_total_docs, __pyx_n_s_term_frequency, __pyx_n_s_docs_with_term, __pyx_n_s_doc_length, __pyx_n_s_avg_length, __pyx_n_s_idf, __pyx_n_s_weight, __pyx_n_s_ratio, __pyx_n_s_num, __pyx_n_s_b_part, __pyx_n_s_denom, __pyx_n_s_pc_score, __pyx_n_s_weights, __pyx_n_s_P_O, __pyx_n_s_C_O, __pyx_n_s_N_O, __pyx_n_s_A_O, __pyx_n_s_L_O, __pyx_n_s_X_O, __pyx_n_s_iphrase, __pyx_n_s_icol, __pyx_n_s_x, __pyx_n_s_score); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(0, 945, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__37);
-  __Pyx_GIVEREF(__pyx_tuple__37);
-  __pyx_codeobj__38 = (PyObject*)__Pyx_PyCode_New(1, 0, 33, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__37, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_peewee_bm25f, 945, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__38)) __PYX_ERR(0, 945, __pyx_L1_error)
+  __pyx_tuple__48 = PyTuple_Pack(33, __pyx_n_s_py_match_info, __pyx_n_s_raw_weights, __pyx_n_s_match_info, __pyx_n_s_match_info_buf, __pyx_n_s_match_info_buf_2, __pyx_n_s_nphrase, __pyx_n_s_ncol, __pyx_n_s_B, __pyx_n_s_K, __pyx_n_s_epsilon, __pyx_n_s_total_docs, __pyx_n_s_term_frequency, __pyx_n_s_docs_with_term, __pyx_n_s_doc_length, __pyx_n_s_avg_length, __pyx_n_s_idf, __pyx_n_s_weight, __pyx_n_s_ratio, __pyx_n_s_num, __pyx_n_s_b_part, __pyx_n_s_denom, __pyx_n_s_pc_score, __pyx_n_s_weights, __pyx_n_s_P_O, __pyx_n_s_C_O, __pyx_n_s_N_O, __pyx_n_s_A_O, __pyx_n_s_L_O, __pyx_n_s_X_O, __pyx_n_s_iphrase, __pyx_n_s_icol, __pyx_n_s_x, __pyx_n_s_score); if (unlikely(!__pyx_tuple__48)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__48);
+  __Pyx_GIVEREF(__pyx_tuple__48);
+  __pyx_codeobj__49 = (PyObject*)__Pyx_PyCode_New(1, 0, 33, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__48, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_peewee_bm25f, 944, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__49)) __PYX_ERR(0, 944, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1044
+  /* "playhouse/_sqlite_ext.pyx":1043
  * 
  * 
  * def peewee_murmurhash(key, seed=None):             # <<<<<<<<<<<<<<
  *     if key is None:
  *         return
  */
-  __pyx_tuple__39 = PyTuple_Pack(4, __pyx_n_s_key, __pyx_n_s_seed, __pyx_n_s_bkey, __pyx_n_s_nseed); if (unlikely(!__pyx_tuple__39)) __PYX_ERR(0, 1044, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__39);
-  __Pyx_GIVEREF(__pyx_tuple__39);
-  __pyx_codeobj__40 = (PyObject*)__Pyx_PyCode_New(2, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__39, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_peewee_murmurhash, 1044, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__40)) __PYX_ERR(0, 1044, __pyx_L1_error)
+  __pyx_tuple__50 = PyTuple_Pack(4, __pyx_n_s_key, __pyx_n_s_seed, __pyx_n_s_bkey, __pyx_n_s_nseed); if (unlikely(!__pyx_tuple__50)) __PYX_ERR(0, 1043, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__50);
+  __Pyx_GIVEREF(__pyx_tuple__50);
+  __pyx_codeobj__51 = (PyObject*)__Pyx_PyCode_New(2, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__50, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_peewee_murmurhash, 1043, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__51)) __PYX_ERR(0, 1043, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1057
+  /* "playhouse/_sqlite_ext.pyx":1056
  * 
  * 
  * def make_hash(hash_impl):             # <<<<<<<<<<<<<<
  *     def inner(*items):
  *         state = hash_impl()
  */
-  __pyx_tuple__41 = PyTuple_Pack(3, __pyx_n_s_hash_impl, __pyx_n_s_inner, __pyx_n_s_inner); if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 1057, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__41);
-  __Pyx_GIVEREF(__pyx_tuple__41);
-  __pyx_codeobj__42 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__41, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_make_hash, 1057, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__42)) __PYX_ERR(0, 1057, __pyx_L1_error)
+  __pyx_tuple__52 = PyTuple_Pack(3, __pyx_n_s_hash_impl, __pyx_n_s_inner, __pyx_n_s_inner); if (unlikely(!__pyx_tuple__52)) __PYX_ERR(0, 1056, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__52);
+  __Pyx_GIVEREF(__pyx_tuple__52);
+  __pyx_codeobj__53 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__52, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_make_hash, 1056, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__53)) __PYX_ERR(0, 1056, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1071
+  /* "playhouse/_sqlite_ext.pyx":1070
  * 
  * 
  * def _register_functions(database, pairs):             # <<<<<<<<<<<<<<
  *     for func, name in pairs:
  *         database.register_function(func, name)
  */
-  __pyx_tuple__43 = PyTuple_Pack(4, __pyx_n_s_database, __pyx_n_s_pairs, __pyx_n_s_func, __pyx_n_s_name); if (unlikely(!__pyx_tuple__43)) __PYX_ERR(0, 1071, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__43);
-  __Pyx_GIVEREF(__pyx_tuple__43);
-  __pyx_codeobj__44 = (PyObject*)__Pyx_PyCode_New(2, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__43, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_register_functions, 1071, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__44)) __PYX_ERR(0, 1071, __pyx_L1_error)
+  __pyx_tuple__54 = PyTuple_Pack(4, __pyx_n_s_database, __pyx_n_s_pairs, __pyx_n_s_func, __pyx_n_s_name); if (unlikely(!__pyx_tuple__54)) __PYX_ERR(0, 1070, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__54);
+  __Pyx_GIVEREF(__pyx_tuple__54);
+  __pyx_codeobj__55 = (PyObject*)__Pyx_PyCode_New(2, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__54, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_register_functions, 1070, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__55)) __PYX_ERR(0, 1070, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1076
+  /* "playhouse/_sqlite_ext.pyx":1075
  * 
  * 
  * def register_hash_functions(database):             # <<<<<<<<<<<<<<
  *     _register_functions(database, (
  *         (peewee_murmurhash, 'murmurhash'),
  */
-  __pyx_tuple__45 = PyTuple_Pack(1, __pyx_n_s_database); if (unlikely(!__pyx_tuple__45)) __PYX_ERR(0, 1076, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__45);
-  __Pyx_GIVEREF(__pyx_tuple__45);
-  __pyx_codeobj__46 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__45, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_register_hash_functions, 1076, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__46)) __PYX_ERR(0, 1076, __pyx_L1_error)
+  __pyx_tuple__56 = PyTuple_Pack(1, __pyx_n_s_database); if (unlikely(!__pyx_tuple__56)) __PYX_ERR(0, 1075, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__56);
+  __Pyx_GIVEREF(__pyx_tuple__56);
+  __pyx_codeobj__57 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__56, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_register_hash_functions, 1075, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__57)) __PYX_ERR(0, 1075, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1086
+  /* "playhouse/_sqlite_ext.pyx":1085
  * 
  * 
  * def register_rank_functions(database):             # <<<<<<<<<<<<<<
  *     _register_functions(database, (
  *         (peewee_bm25, 'fts_bm25'),
  */
-  __pyx_tuple__47 = PyTuple_Pack(1, __pyx_n_s_database); if (unlikely(!__pyx_tuple__47)) __PYX_ERR(0, 1086, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__47);
-  __Pyx_GIVEREF(__pyx_tuple__47);
-  __pyx_codeobj__48 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__47, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_register_rank_functions, 1086, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__48)) __PYX_ERR(0, 1086, __pyx_L1_error)
+  __pyx_tuple__58 = PyTuple_Pack(1, __pyx_n_s_database); if (unlikely(!__pyx_tuple__58)) __PYX_ERR(0, 1085, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__58);
+  __Pyx_GIVEREF(__pyx_tuple__58);
+  __pyx_codeobj__59 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__58, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_register_rank_functions, 1085, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__59)) __PYX_ERR(0, 1085, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1204
+  /* "playhouse/_sqlite_ext.pyx":1203
  * 
  * 
  * def peewee_bloomfilter_contains(key, data):             # <<<<<<<<<<<<<<
  *     cdef:
  *         bf_t bf
  */
-  __pyx_tuple__49 = PyTuple_Pack(6, __pyx_n_s_key, __pyx_n_s_data, __pyx_n_s_bf, __pyx_n_s_bkey, __pyx_n_s_bdata, __pyx_n_s_cdata); if (unlikely(!__pyx_tuple__49)) __PYX_ERR(0, 1204, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__49);
-  __Pyx_GIVEREF(__pyx_tuple__49);
-  __pyx_codeobj__50 = (PyObject*)__Pyx_PyCode_New(2, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__49, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_peewee_bloomfilter_contains, 1204, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__50)) __PYX_ERR(0, 1204, __pyx_L1_error)
+  __pyx_tuple__60 = PyTuple_Pack(6, __pyx_n_s_key, __pyx_n_s_data, __pyx_n_s_bf, __pyx_n_s_bkey, __pyx_n_s_bdata, __pyx_n_s_cdata); if (unlikely(!__pyx_tuple__60)) __PYX_ERR(0, 1203, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__60);
+  __Pyx_GIVEREF(__pyx_tuple__60);
+  __pyx_codeobj__61 = (PyObject*)__Pyx_PyCode_New(2, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__60, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_peewee_bloomfilter_contains, 1203, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__61)) __PYX_ERR(0, 1203, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1218
+  /* "playhouse/_sqlite_ext.pyx":1217
  * 
  * 
  * def peewee_bloomfilter_calculate_size(n_items, error_p):             # <<<<<<<<<<<<<<
  *     return BloomFilter.calculate_size(n_items, error_p)
  * 
  */
-  __pyx_tuple__51 = PyTuple_Pack(2, __pyx_n_s_n_items, __pyx_n_s_error_p); if (unlikely(!__pyx_tuple__51)) __PYX_ERR(0, 1218, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__51);
-  __Pyx_GIVEREF(__pyx_tuple__51);
-  __pyx_codeobj__52 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__51, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_peewee_bloomfilter_calculate_siz, 1218, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__52)) __PYX_ERR(0, 1218, __pyx_L1_error)
+  __pyx_tuple__62 = PyTuple_Pack(2, __pyx_n_s_n_items, __pyx_n_s_error_p); if (unlikely(!__pyx_tuple__62)) __PYX_ERR(0, 1217, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__62);
+  __Pyx_GIVEREF(__pyx_tuple__62);
+  __pyx_codeobj__63 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__62, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_peewee_bloomfilter_calculate_siz, 1217, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__63)) __PYX_ERR(0, 1217, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1222
+  /* "playhouse/_sqlite_ext.pyx":1221
  * 
  * 
  * def register_bloomfilter(database):             # <<<<<<<<<<<<<<
  *     database.register_aggregate(BloomFilterAggregate, 'bloomfilter')
  *     database.register_function(peewee_bloomfilter_contains,
  */
-  __pyx_tuple__53 = PyTuple_Pack(1, __pyx_n_s_database); if (unlikely(!__pyx_tuple__53)) __PYX_ERR(0, 1222, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__53);
-  __Pyx_GIVEREF(__pyx_tuple__53);
-  __pyx_codeobj__54 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__53, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_register_bloomfilter, 1222, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__54)) __PYX_ERR(0, 1222, __pyx_L1_error)
+  __pyx_tuple__64 = PyTuple_Pack(1, __pyx_n_s_database); if (unlikely(!__pyx_tuple__64)) __PYX_ERR(0, 1221, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__64);
+  __Pyx_GIVEREF(__pyx_tuple__64);
+  __pyx_codeobj__65 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__64, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_register_bloomfilter, 1221, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__65)) __PYX_ERR(0, 1221, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1241
+  /* "playhouse/_sqlite_ext.pyx":1240
  * 
  * class ZeroBlob(Node):
  *     def __init__(self, length):             # <<<<<<<<<<<<<<
  *         if not isinstance(length, int) or length < 0:
  *             raise ValueError('Length must be a positive integer.')
  */
-  __pyx_tuple__55 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_length); if (unlikely(!__pyx_tuple__55)) __PYX_ERR(0, 1241, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__55);
-  __Pyx_GIVEREF(__pyx_tuple__55);
-  __pyx_codeobj__56 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__55, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_init, 1241, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__56)) __PYX_ERR(0, 1241, __pyx_L1_error)
+  __pyx_tuple__66 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_length); if (unlikely(!__pyx_tuple__66)) __PYX_ERR(0, 1240, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__66);
+  __Pyx_GIVEREF(__pyx_tuple__66);
+  __pyx_codeobj__67 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__66, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_init, 1240, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__67)) __PYX_ERR(0, 1240, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1246
+  /* "playhouse/_sqlite_ext.pyx":1245
  *         self.length = length
  * 
  *     def __sql__(self, ctx):             # <<<<<<<<<<<<<<
  *         return ctx.literal('zeroblob(%s)' % self.length)
  * 
  */
-  __pyx_tuple__57 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_ctx); if (unlikely(!__pyx_tuple__57)) __PYX_ERR(0, 1246, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__57);
-  __Pyx_GIVEREF(__pyx_tuple__57);
-  __pyx_codeobj__58 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__57, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_sql, 1246, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__58)) __PYX_ERR(0, 1246, __pyx_L1_error)
+  __pyx_tuple__68 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_ctx); if (unlikely(!__pyx_tuple__68)) __PYX_ERR(0, 1245, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__68);
+  __Pyx_GIVEREF(__pyx_tuple__68);
+  __pyx_codeobj__69 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__68, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_sql, 1245, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__69)) __PYX_ERR(0, 1245, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1386
+  /* "playhouse/_sqlite_ext.pyx":1385
  * 
  * 
  * def sqlite_get_status(flag):             # <<<<<<<<<<<<<<
  *     cdef:
  *         int current, highwater, rc
  */
-  __pyx_tuple__59 = PyTuple_Pack(4, __pyx_n_s_flag, __pyx_n_s_current, __pyx_n_s_highwater, __pyx_n_s_rc); if (unlikely(!__pyx_tuple__59)) __PYX_ERR(0, 1386, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__59);
-  __Pyx_GIVEREF(__pyx_tuple__59);
-  __pyx_codeobj__60 = (PyObject*)__Pyx_PyCode_New(1, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__59, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_sqlite_get_status, 1386, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__60)) __PYX_ERR(0, 1386, __pyx_L1_error)
+  __pyx_tuple__70 = PyTuple_Pack(4, __pyx_n_s_flag, __pyx_n_s_current, __pyx_n_s_highwater, __pyx_n_s_rc); if (unlikely(!__pyx_tuple__70)) __PYX_ERR(0, 1385, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__70);
+  __Pyx_GIVEREF(__pyx_tuple__70);
+  __pyx_codeobj__71 = (PyObject*)__Pyx_PyCode_New(1, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__70, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_sqlite_get_status, 1385, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__71)) __PYX_ERR(0, 1385, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1396
+  /* "playhouse/_sqlite_ext.pyx":1395
  * 
  * 
  * def sqlite_get_db_status(conn, flag):             # <<<<<<<<<<<<<<
  *     cdef:
  *         int current, highwater, rc
  */
-  __pyx_tuple__61 = PyTuple_Pack(6, __pyx_n_s_conn, __pyx_n_s_flag, __pyx_n_s_current, __pyx_n_s_highwater, __pyx_n_s_rc, __pyx_n_s_c_conn); if (unlikely(!__pyx_tuple__61)) __PYX_ERR(0, 1396, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__61);
-  __Pyx_GIVEREF(__pyx_tuple__61);
-  __pyx_codeobj__62 = (PyObject*)__Pyx_PyCode_New(2, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__61, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_sqlite_get_db_status, 1396, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__62)) __PYX_ERR(0, 1396, __pyx_L1_error)
+  __pyx_tuple__72 = PyTuple_Pack(6, __pyx_n_s_conn, __pyx_n_s_flag, __pyx_n_s_current, __pyx_n_s_highwater, __pyx_n_s_rc, __pyx_n_s_c_conn); if (unlikely(!__pyx_tuple__72)) __PYX_ERR(0, 1395, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__72);
+  __Pyx_GIVEREF(__pyx_tuple__72);
+  __pyx_codeobj__73 = (PyObject*)__Pyx_PyCode_New(2, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__72, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_sqlite_get_db_status, 1395, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__73)) __PYX_ERR(0, 1395, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1508
+  /* "playhouse/_sqlite_ext.pyx":1507
  * 
  * 
  * def backup(src_conn, dest_conn, pages=None, name=None, progress=None):             # <<<<<<<<<<<<<<
  *     cdef:
  *         bytes bname = encode(name or 'main')
  */
-  __pyx_tuple__63 = PyTuple_Pack(15, __pyx_n_s_src_conn, __pyx_n_s_dest_conn, __pyx_n_s_pages, __pyx_n_s_name, __pyx_n_s_progress, __pyx_n_s_bname, __pyx_n_s_page_step, __pyx_n_s_rc, __pyx_n_s_src, __pyx_n_s_dest, __pyx_n_s_src_db, __pyx_n_s_dest_db, __pyx_n_s_backup, __pyx_n_s_remaining, __pyx_n_s_page_count); if (unlikely(!__pyx_tuple__63)) __PYX_ERR(0, 1508, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__63);
-  __Pyx_GIVEREF(__pyx_tuple__63);
-  __pyx_codeobj__64 = (PyObject*)__Pyx_PyCode_New(5, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__63, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_backup, 1508, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__64)) __PYX_ERR(0, 1508, __pyx_L1_error)
+  __pyx_tuple__74 = PyTuple_Pack(15, __pyx_n_s_src_conn, __pyx_n_s_dest_conn, __pyx_n_s_pages, __pyx_n_s_name, __pyx_n_s_progress, __pyx_n_s_bname, __pyx_n_s_page_step, __pyx_n_s_rc, __pyx_n_s_src, __pyx_n_s_dest, __pyx_n_s_src_db, __pyx_n_s_dest_db, __pyx_n_s_backup, __pyx_n_s_remaining, __pyx_n_s_page_count); if (unlikely(!__pyx_tuple__74)) __PYX_ERR(0, 1507, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__74);
+  __Pyx_GIVEREF(__pyx_tuple__74);
+  __pyx_codeobj__75 = (PyObject*)__Pyx_PyCode_New(5, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__74, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_backup, 1507, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__75)) __PYX_ERR(0, 1507, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":1550
+  /* "playhouse/_sqlite_ext.pyx":1549
  * 
  * 
  * def backup_to_file(src_conn, filename, pages=None, name=None, progress=None):             # <<<<<<<<<<<<<<
  *     dest_conn = pysqlite.connect(filename)
  *     backup(src_conn, dest_conn, pages=pages, name=name, progress=progress)
  */
-  __pyx_tuple__65 = PyTuple_Pack(6, __pyx_n_s_src_conn, __pyx_n_s_filename, __pyx_n_s_pages, __pyx_n_s_name, __pyx_n_s_progress, __pyx_n_s_dest_conn); if (unlikely(!__pyx_tuple__65)) __PYX_ERR(0, 1550, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__65);
-  __Pyx_GIVEREF(__pyx_tuple__65);
-  __pyx_codeobj__66 = (PyObject*)__Pyx_PyCode_New(5, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__65, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_backup_to_file, 1550, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__66)) __PYX_ERR(0, 1550, __pyx_L1_error)
+  __pyx_tuple__76 = PyTuple_Pack(6, __pyx_n_s_src_conn, __pyx_n_s_filename, __pyx_n_s_pages, __pyx_n_s_name, __pyx_n_s_progress, __pyx_n_s_dest_conn); if (unlikely(!__pyx_tuple__76)) __PYX_ERR(0, 1549, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__76);
+  __Pyx_GIVEREF(__pyx_tuple__76);
+  __pyx_codeobj__77 = (PyObject*)__Pyx_PyCode_New(5, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__76, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_playhouse__sqlite_ext_pyx, __pyx_n_s_backup_to_file, 1549, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__77)) __PYX_ERR(0, 1549, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __pyx_unpickle_BloomFilterAggregate(__pyx_type, long __pyx_checksum, __pyx_state):             # <<<<<<<<<<<<<<
- *     cdef object __pyx_PickleError
- *     cdef object __pyx_result
+ *     if __pyx_checksum != 0xc9f9d7d:
+ *         from pickle import PickleError as __pyx_PickleError
  */
-  __pyx_tuple__67 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__67)) __PYX_ERR(1, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__67);
-  __Pyx_GIVEREF(__pyx_tuple__67);
-  __pyx_codeobj__68 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__67, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_BloomFilterAggreg, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__68)) __PYX_ERR(1, 1, __pyx_L1_error)
+  __pyx_tuple__78 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__78)) __PYX_ERR(1, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__78);
+  __Pyx_GIVEREF(__pyx_tuple__78);
+  __pyx_codeobj__79 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__78, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_BloomFilterAggreg, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__79)) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 
-static CYTHON_SMALL_CODE int __Pyx_InitGlobals(void) {
+static int __Pyx_InitGlobals(void) {
   if (__Pyx_InitStrings(__pyx_string_tab) < 0) __PYX_ERR(0, 1, __pyx_L1_error);
   __pyx_float_1_0 = PyFloat_FromDouble(1.0); if (unlikely(!__pyx_float_1_0)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_float_2_0 = PyFloat_FromDouble(2.0); if (unlikely(!__pyx_float_2_0)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_0 = PyInt_FromLong(0); if (unlikely(!__pyx_int_0)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_2 = PyInt_FromLong(2); if (unlikely(!__pyx_int_2)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_5 = PyInt_FromLong(5); if (unlikely(!__pyx_int_5)) __PYX_ERR(0, 1, __pyx_L1_error)
@@ -21749,295 +22009,84 @@
   __pyx_int_32768 = PyInt_FromLong(32768L); if (unlikely(!__pyx_int_32768)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_211787133 = PyInt_FromLong(211787133L); if (unlikely(!__pyx_int_211787133)) __PYX_ERR(0, 1, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
 }
 
-static CYTHON_SMALL_CODE int __Pyx_modinit_global_init_code(void); /*proto*/
-static CYTHON_SMALL_CODE int __Pyx_modinit_variable_export_code(void); /*proto*/
-static CYTHON_SMALL_CODE int __Pyx_modinit_function_export_code(void); /*proto*/
-static CYTHON_SMALL_CODE int __Pyx_modinit_type_init_code(void); /*proto*/
-static CYTHON_SMALL_CODE int __Pyx_modinit_type_import_code(void); /*proto*/
-static CYTHON_SMALL_CODE int __Pyx_modinit_variable_import_code(void); /*proto*/
-static CYTHON_SMALL_CODE int __Pyx_modinit_function_import_code(void); /*proto*/
-
-static int __Pyx_modinit_global_init_code(void) {
-  __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("__Pyx_modinit_global_init_code", 0);
-  /*--- Global init code ---*/
-  __pyx_v_9playhouse_11_sqlite_ext_SQLITE_DATETIME_FORMATS = ((PyObject*)Py_None); Py_INCREF(Py_None);
-  __pyx_v_9playhouse_11_sqlite_ext_SQLITE_DATE_TRUNC_MAPPING = ((PyObject*)Py_None); Py_INCREF(Py_None);
-  __Pyx_RefNannyFinishContext();
-  return 0;
-}
-
-static int __Pyx_modinit_variable_export_code(void) {
-  __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("__Pyx_modinit_variable_export_code", 0);
-  /*--- Variable export code ---*/
-  __Pyx_RefNannyFinishContext();
-  return 0;
-}
-
-static int __Pyx_modinit_function_export_code(void) {
-  __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("__Pyx_modinit_function_export_code", 0);
-  /*--- Function export code ---*/
-  __Pyx_RefNannyFinishContext();
-  return 0;
-}
-
-static int __Pyx_modinit_type_init_code(void) {
-  __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("__Pyx_modinit_type_init_code", 0);
-  /*--- Type init code ---*/
-  __pyx_vtabptr_9playhouse_11_sqlite_ext__TableFunctionImpl = &__pyx_vtable_9playhouse_11_sqlite_ext__TableFunctionImpl;
-  __pyx_vtable_9playhouse_11_sqlite_ext__TableFunctionImpl.create_module = (PyObject *(*)(struct __pyx_obj_9playhouse_11_sqlite_ext__TableFunctionImpl *, pysqlite_Connection *))__pyx_f_9playhouse_11_sqlite_ext_18_TableFunctionImpl_create_module;
-  if (PyType_Ready(&__pyx_type_9playhouse_11_sqlite_ext__TableFunctionImpl) < 0) __PYX_ERR(0, 625, __pyx_L1_error)
-  __pyx_type_9playhouse_11_sqlite_ext__TableFunctionImpl.tp_print = 0;
-  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_9playhouse_11_sqlite_ext__TableFunctionImpl.tp_dictoffset && __pyx_type_9playhouse_11_sqlite_ext__TableFunctionImpl.tp_getattro == PyObject_GenericGetAttr)) {
-    __pyx_type_9playhouse_11_sqlite_ext__TableFunctionImpl.tp_getattro = __Pyx_PyObject_GenericGetAttr;
-  }
-  if (__Pyx_SetVtable(__pyx_type_9playhouse_11_sqlite_ext__TableFunctionImpl.tp_dict, __pyx_vtabptr_9playhouse_11_sqlite_ext__TableFunctionImpl) < 0) __PYX_ERR(0, 625, __pyx_L1_error)
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_TableFunctionImpl, (PyObject *)&__pyx_type_9playhouse_11_sqlite_ext__TableFunctionImpl) < 0) __PYX_ERR(0, 625, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_9playhouse_11_sqlite_ext__TableFunctionImpl) < 0) __PYX_ERR(0, 625, __pyx_L1_error)
-  __pyx_ptype_9playhouse_11_sqlite_ext__TableFunctionImpl = &__pyx_type_9playhouse_11_sqlite_ext__TableFunctionImpl;
-  if (PyType_Ready(&__pyx_type_9playhouse_11_sqlite_ext_BloomFilter) < 0) __PYX_ERR(0, 1147, __pyx_L1_error)
-  __pyx_type_9playhouse_11_sqlite_ext_BloomFilter.tp_print = 0;
-  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_9playhouse_11_sqlite_ext_BloomFilter.tp_dictoffset && __pyx_type_9playhouse_11_sqlite_ext_BloomFilter.tp_getattro == PyObject_GenericGetAttr)) {
-    __pyx_type_9playhouse_11_sqlite_ext_BloomFilter.tp_getattro = __Pyx_PyObject_GenericGetAttr;
-  }
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_BloomFilter, (PyObject *)&__pyx_type_9playhouse_11_sqlite_ext_BloomFilter) < 0) __PYX_ERR(0, 1147, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_9playhouse_11_sqlite_ext_BloomFilter) < 0) __PYX_ERR(0, 1147, __pyx_L1_error)
-  __pyx_ptype_9playhouse_11_sqlite_ext_BloomFilter = &__pyx_type_9playhouse_11_sqlite_ext_BloomFilter;
-  if (PyType_Ready(&__pyx_type_9playhouse_11_sqlite_ext_BloomFilterAggregate) < 0) __PYX_ERR(0, 1183, __pyx_L1_error)
-  __pyx_type_9playhouse_11_sqlite_ext_BloomFilterAggregate.tp_print = 0;
-  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_9playhouse_11_sqlite_ext_BloomFilterAggregate.tp_dictoffset && __pyx_type_9playhouse_11_sqlite_ext_BloomFilterAggregate.tp_getattro == PyObject_GenericGetAttr)) {
-    __pyx_type_9playhouse_11_sqlite_ext_BloomFilterAggregate.tp_getattro = __Pyx_PyObject_GenericGetAttr;
-  }
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_BloomFilterAggregate, (PyObject *)&__pyx_type_9playhouse_11_sqlite_ext_BloomFilterAggregate) < 0) __PYX_ERR(0, 1183, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_9playhouse_11_sqlite_ext_BloomFilterAggregate) < 0) __PYX_ERR(0, 1183, __pyx_L1_error)
-  __pyx_ptype_9playhouse_11_sqlite_ext_BloomFilterAggregate = &__pyx_type_9playhouse_11_sqlite_ext_BloomFilterAggregate;
-  __pyx_vtabptr_9playhouse_11_sqlite_ext_Blob = &__pyx_vtable_9playhouse_11_sqlite_ext_Blob;
-  __pyx_vtable_9playhouse_11_sqlite_ext_Blob._close = (PyObject *(*)(struct __pyx_obj_9playhouse_11_sqlite_ext_Blob *))__pyx_f_9playhouse_11_sqlite_ext_4Blob__close;
-  if (PyType_Ready(&__pyx_type_9playhouse_11_sqlite_ext_Blob) < 0) __PYX_ERR(0, 1259, __pyx_L1_error)
-  __pyx_type_9playhouse_11_sqlite_ext_Blob.tp_print = 0;
-  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_9playhouse_11_sqlite_ext_Blob.tp_dictoffset && __pyx_type_9playhouse_11_sqlite_ext_Blob.tp_getattro == PyObject_GenericGetAttr)) {
-    __pyx_type_9playhouse_11_sqlite_ext_Blob.tp_getattro = __Pyx_PyObject_GenericGetAttr;
-  }
-  if (__Pyx_SetVtable(__pyx_type_9playhouse_11_sqlite_ext_Blob.tp_dict, __pyx_vtabptr_9playhouse_11_sqlite_ext_Blob) < 0) __PYX_ERR(0, 1259, __pyx_L1_error)
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Blob, (PyObject *)&__pyx_type_9playhouse_11_sqlite_ext_Blob) < 0) __PYX_ERR(0, 1259, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_9playhouse_11_sqlite_ext_Blob) < 0) __PYX_ERR(0, 1259, __pyx_L1_error)
-  __pyx_ptype_9playhouse_11_sqlite_ext_Blob = &__pyx_type_9playhouse_11_sqlite_ext_Blob;
-  if (PyType_Ready(&__pyx_type_9playhouse_11_sqlite_ext_ConnectionHelper) < 0) __PYX_ERR(0, 1407, __pyx_L1_error)
-  __pyx_type_9playhouse_11_sqlite_ext_ConnectionHelper.tp_print = 0;
-  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_9playhouse_11_sqlite_ext_ConnectionHelper.tp_dictoffset && __pyx_type_9playhouse_11_sqlite_ext_ConnectionHelper.tp_getattro == PyObject_GenericGetAttr)) {
-    __pyx_type_9playhouse_11_sqlite_ext_ConnectionHelper.tp_getattro = __Pyx_PyObject_GenericGetAttr;
-  }
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_ConnectionHelper, (PyObject *)&__pyx_type_9playhouse_11_sqlite_ext_ConnectionHelper) < 0) __PYX_ERR(0, 1407, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_9playhouse_11_sqlite_ext_ConnectionHelper) < 0) __PYX_ERR(0, 1407, __pyx_L1_error)
-  __pyx_ptype_9playhouse_11_sqlite_ext_ConnectionHelper = &__pyx_type_9playhouse_11_sqlite_ext_ConnectionHelper;
-  if (PyType_Ready(&__pyx_type_9playhouse_11_sqlite_ext___pyx_scope_struct__make_hash) < 0) __PYX_ERR(0, 1057, __pyx_L1_error)
-  __pyx_type_9playhouse_11_sqlite_ext___pyx_scope_struct__make_hash.tp_print = 0;
-  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_9playhouse_11_sqlite_ext___pyx_scope_struct__make_hash.tp_dictoffset && __pyx_type_9playhouse_11_sqlite_ext___pyx_scope_struct__make_hash.tp_getattro == PyObject_GenericGetAttr)) {
-    __pyx_type_9playhouse_11_sqlite_ext___pyx_scope_struct__make_hash.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
-  }
-  __pyx_ptype_9playhouse_11_sqlite_ext___pyx_scope_struct__make_hash = &__pyx_type_9playhouse_11_sqlite_ext___pyx_scope_struct__make_hash;
-  __Pyx_RefNannyFinishContext();
-  return 0;
-  __pyx_L1_error:;
-  __Pyx_RefNannyFinishContext();
-  return -1;
-}
-
-static int __Pyx_modinit_type_import_code(void) {
-  __Pyx_RefNannyDeclarations
-  PyObject *__pyx_t_1 = NULL;
-  __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
-  /*--- Type import code ---*/
-  __pyx_t_1 = PyImport_ImportModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 9, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_7cpython_4type_type = __Pyx_ImportType(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "type", 
-  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
-  sizeof(PyTypeObject),
-  #else
-  sizeof(PyHeapTypeObject),
-  #endif
-  __Pyx_ImportType_CheckSize_Warn);
-   if (!__pyx_ptype_7cpython_4type_type) __PYX_ERR(3, 9, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyImport_ImportModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 8, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_7cpython_4bool_bool = __Pyx_ImportType(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "bool", sizeof(PyBoolObject), __Pyx_ImportType_CheckSize_Warn);
-   if (!__pyx_ptype_7cpython_4bool_bool) __PYX_ERR(4, 8, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyImport_ImportModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_t_1)) __PYX_ERR(5, 15, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_7cpython_7complex_complex = __Pyx_ImportType(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "complex", sizeof(PyComplexObject), __Pyx_ImportType_CheckSize_Warn);
-   if (!__pyx_ptype_7cpython_7complex_complex) __PYX_ERR(5, 15, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyImport_ImportModule("datetime"); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 9, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_7cpython_8datetime_date = __Pyx_ImportType(__pyx_t_1, "datetime", "date", sizeof(PyDateTime_Date), __Pyx_ImportType_CheckSize_Warn);
-   if (!__pyx_ptype_7cpython_8datetime_date) __PYX_ERR(2, 9, __pyx_L1_error)
-  __pyx_ptype_7cpython_8datetime_time = __Pyx_ImportType(__pyx_t_1, "datetime", "time", sizeof(PyDateTime_Time), __Pyx_ImportType_CheckSize_Warn);
-   if (!__pyx_ptype_7cpython_8datetime_time) __PYX_ERR(2, 12, __pyx_L1_error)
-  __pyx_ptype_7cpython_8datetime_datetime = __Pyx_ImportType(__pyx_t_1, "datetime", "datetime", sizeof(PyDateTime_DateTime), __Pyx_ImportType_CheckSize_Warn);
-   if (!__pyx_ptype_7cpython_8datetime_datetime) __PYX_ERR(2, 15, __pyx_L1_error)
-  __pyx_ptype_7cpython_8datetime_timedelta = __Pyx_ImportType(__pyx_t_1, "datetime", "timedelta", sizeof(PyDateTime_Delta), __Pyx_ImportType_CheckSize_Warn);
-   if (!__pyx_ptype_7cpython_8datetime_timedelta) __PYX_ERR(2, 18, __pyx_L1_error)
-  __pyx_ptype_7cpython_8datetime_tzinfo = __Pyx_ImportType(__pyx_t_1, "datetime", "tzinfo", sizeof(PyDateTime_TZInfo), __Pyx_ImportType_CheckSize_Warn);
-   if (!__pyx_ptype_7cpython_8datetime_tzinfo) __PYX_ERR(2, 21, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_RefNannyFinishContext();
-  return 0;
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_RefNannyFinishContext();
-  return -1;
-}
-
-static int __Pyx_modinit_variable_import_code(void) {
-  __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("__Pyx_modinit_variable_import_code", 0);
-  /*--- Variable import code ---*/
-  __Pyx_RefNannyFinishContext();
-  return 0;
-}
-
-static int __Pyx_modinit_function_import_code(void) {
-  __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("__Pyx_modinit_function_import_code", 0);
-  /*--- Function import code ---*/
-  __Pyx_RefNannyFinishContext();
-  return 0;
-}
-
-
 #if PY_MAJOR_VERSION < 3
-#ifdef CYTHON_NO_PYINIT_EXPORT
-#define __Pyx_PyMODINIT_FUNC void
-#else
-#define __Pyx_PyMODINIT_FUNC PyMODINIT_FUNC
-#endif
+PyMODINIT_FUNC init_sqlite_ext(void); /*proto*/
+PyMODINIT_FUNC init_sqlite_ext(void)
 #else
-#ifdef CYTHON_NO_PYINIT_EXPORT
-#define __Pyx_PyMODINIT_FUNC PyObject *
-#else
-#define __Pyx_PyMODINIT_FUNC PyMODINIT_FUNC
-#endif
-#endif
-
-
-#if PY_MAJOR_VERSION < 3
-__Pyx_PyMODINIT_FUNC init_sqlite_ext(void) CYTHON_SMALL_CODE; /*proto*/
-__Pyx_PyMODINIT_FUNC init_sqlite_ext(void)
-#else
-__Pyx_PyMODINIT_FUNC PyInit__sqlite_ext(void) CYTHON_SMALL_CODE; /*proto*/
-__Pyx_PyMODINIT_FUNC PyInit__sqlite_ext(void)
+PyMODINIT_FUNC PyInit__sqlite_ext(void); /*proto*/
+PyMODINIT_FUNC PyInit__sqlite_ext(void)
 #if CYTHON_PEP489_MULTI_PHASE_INIT
 {
   return PyModuleDef_Init(&__pyx_moduledef);
 }
-static CYTHON_SMALL_CODE int __Pyx_check_single_interpreter(void) {
-    #if PY_VERSION_HEX >= 0x030700A1
-    static PY_INT64_T main_interpreter_id = -1;
-    PY_INT64_T current_id = PyInterpreterState_GetID(PyThreadState_Get()->interp);
-    if (main_interpreter_id == -1) {
-        main_interpreter_id = current_id;
-        return (unlikely(current_id == -1)) ? -1 : 0;
-    } else if (unlikely(main_interpreter_id != current_id))
-    #else
-    static PyInterpreterState *main_interpreter = NULL;
-    PyInterpreterState *current_interpreter = PyThreadState_Get()->interp;
-    if (!main_interpreter) {
-        main_interpreter = current_interpreter;
-    } else if (unlikely(main_interpreter != current_interpreter))
-    #endif
-    {
-        PyErr_SetString(
-            PyExc_ImportError,
-            "Interpreter change detected - this module can only be loaded into one interpreter per process.");
-        return -1;
-    }
-    return 0;
-}
-static CYTHON_SMALL_CODE int __Pyx_copy_spec_to_module(PyObject *spec, PyObject *moddict, const char* from_name, const char* to_name, int allow_none) {
+static int __Pyx_copy_spec_to_module(PyObject *spec, PyObject *moddict, const char* from_name, const char* to_name) {
     PyObject *value = PyObject_GetAttrString(spec, from_name);
     int result = 0;
     if (likely(value)) {
-        if (allow_none || value != Py_None) {
-            result = PyDict_SetItemString(moddict, to_name, value);
-        }
+        result = PyDict_SetItemString(moddict, to_name, value);
         Py_DECREF(value);
     } else if (PyErr_ExceptionMatches(PyExc_AttributeError)) {
         PyErr_Clear();
     } else {
         result = -1;
     }
     return result;
 }
-static CYTHON_SMALL_CODE PyObject* __pyx_pymod_create(PyObject *spec, CYTHON_UNUSED PyModuleDef *def) {
+static PyObject* __pyx_pymod_create(PyObject *spec, CYTHON_UNUSED PyModuleDef *def) {
     PyObject *module = NULL, *moddict, *modname;
-    if (__Pyx_check_single_interpreter())
-        return NULL;
     if (__pyx_m)
         return __Pyx_NewRef(__pyx_m);
     modname = PyObject_GetAttrString(spec, "name");
     if (unlikely(!modname)) goto bad;
     module = PyModule_NewObject(modname);
     Py_DECREF(modname);
     if (unlikely(!module)) goto bad;
     moddict = PyModule_GetDict(module);
     if (unlikely(!moddict)) goto bad;
-    if (unlikely(__Pyx_copy_spec_to_module(spec, moddict, "loader", "__loader__", 1) < 0)) goto bad;
-    if (unlikely(__Pyx_copy_spec_to_module(spec, moddict, "origin", "__file__", 1) < 0)) goto bad;
-    if (unlikely(__Pyx_copy_spec_to_module(spec, moddict, "parent", "__package__", 1) < 0)) goto bad;
-    if (unlikely(__Pyx_copy_spec_to_module(spec, moddict, "submodule_search_locations", "__path__", 0) < 0)) goto bad;
+    if (unlikely(__Pyx_copy_spec_to_module(spec, moddict, "loader", "__loader__") < 0)) goto bad;
+    if (unlikely(__Pyx_copy_spec_to_module(spec, moddict, "origin", "__file__") < 0)) goto bad;
+    if (unlikely(__Pyx_copy_spec_to_module(spec, moddict, "parent", "__package__") < 0)) goto bad;
+    if (unlikely(__Pyx_copy_spec_to_module(spec, moddict, "submodule_search_locations", "__path__") < 0)) goto bad;
     return module;
 bad:
     Py_XDECREF(module);
     return NULL;
 }
 
 
-static CYTHON_SMALL_CODE int __pyx_pymod_exec__sqlite_ext(PyObject *__pyx_pyinit_module)
+static int __pyx_pymod_exec__sqlite_ext(PyObject *__pyx_pyinit_module)
 #endif
 #endif
 {
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
-  static int __pyx_t_5[10];
+  PyObject *__pyx_t_5 = NULL;
+  static int __pyx_t_6[10];
   __Pyx_RefNannyDeclarations
   #if CYTHON_PEP489_MULTI_PHASE_INIT
-  if (__pyx_m) {
-    if (__pyx_m == __pyx_pyinit_module) return 0;
-    PyErr_SetString(PyExc_RuntimeError, "Module '_sqlite_ext' has already been imported. Re-initialisation is not supported.");
-    return -1;
-  }
-  #elif PY_MAJOR_VERSION >= 3
-  if (__pyx_m) return __Pyx_NewRef(__pyx_m);
+  if (__pyx_m && __pyx_m == __pyx_pyinit_module) return 0;
   #endif
   #if CYTHON_REFNANNY
-__Pyx_RefNanny = __Pyx_RefNannyImportAPI("refnanny");
-if (!__Pyx_RefNanny) {
-  PyErr_Clear();
-  __Pyx_RefNanny = __Pyx_RefNannyImportAPI("Cython.Runtime.refnanny");
-  if (!__Pyx_RefNanny)
-      Py_FatalError("failed to import 'refnanny' module");
-}
-#endif
-  __Pyx_RefNannySetupContext("__Pyx_PyMODINIT_FUNC PyInit__sqlite_ext(void)", 0);
-  if (__Pyx_check_binary_version() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  #ifdef __Pxy_PyFrame_Initialize_Offsets
-  __Pxy_PyFrame_Initialize_Offsets();
+  __Pyx_RefNanny = __Pyx_RefNannyImportAPI("refnanny");
+  if (!__Pyx_RefNanny) {
+      PyErr_Clear();
+      __Pyx_RefNanny = __Pyx_RefNannyImportAPI("Cython.Runtime.refnanny");
+      if (!__Pyx_RefNanny)
+          Py_FatalError("failed to import 'refnanny' module");
+  }
   #endif
+  __Pyx_RefNannySetupContext("PyMODINIT_FUNC PyInit__sqlite_ext(void)", 0);
+  if (__Pyx_check_binary_version() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_empty_bytes = PyBytes_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_empty_unicode = PyUnicode_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_unicode)) __PYX_ERR(0, 1, __pyx_L1_error)
   #ifdef __Pyx_CyFunction_USED
   if (__pyx_CyFunction_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
   #ifdef __Pyx_FusedFunction_USED
@@ -22073,46 +22122,96 @@
   __pyx_m = PyModule_Create(&__pyx_moduledef);
   #endif
   if (unlikely(!__pyx_m)) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
   __pyx_d = PyModule_GetDict(__pyx_m); if (unlikely(!__pyx_d)) __PYX_ERR(0, 1, __pyx_L1_error)
   Py_INCREF(__pyx_d);
   __pyx_b = PyImport_AddModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_b)) __PYX_ERR(0, 1, __pyx_L1_error)
-  Py_INCREF(__pyx_b);
   __pyx_cython_runtime = PyImport_AddModule((char *) "cython_runtime"); if (unlikely(!__pyx_cython_runtime)) __PYX_ERR(0, 1, __pyx_L1_error)
-  Py_INCREF(__pyx_cython_runtime);
+  #if CYTHON_COMPILING_IN_PYPY
+  Py_INCREF(__pyx_b);
+  #endif
   if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) __PYX_ERR(0, 1, __pyx_L1_error);
   /*--- Initialize various global constants etc. ---*/
   if (__Pyx_InitGlobals() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #if PY_MAJOR_VERSION < 3 && (__PYX_DEFAULT_STRING_ENCODING_IS_ASCII || __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT)
   if (__Pyx_init_sys_getdefaultencoding_params() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
   if (__pyx_module_is_main_playhouse___sqlite_ext) {
-    if (PyObject_SetAttr(__pyx_m, __pyx_n_s_name_2, __pyx_n_s_main_2) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+    if (PyObject_SetAttrString(__pyx_m, "__name__", __pyx_n_s_main_2) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   }
   #if PY_MAJOR_VERSION >= 3
   {
     PyObject *modules = PyImport_GetModuleDict(); if (unlikely(!modules)) __PYX_ERR(0, 1, __pyx_L1_error)
     if (!PyDict_GetItemString(modules, "playhouse._sqlite_ext")) {
       if (unlikely(PyDict_SetItemString(modules, "playhouse._sqlite_ext", __pyx_m) < 0)) __PYX_ERR(0, 1, __pyx_L1_error)
     }
   }
   #endif
   /*--- Builtin init code ---*/
   if (__Pyx_InitCachedBuiltins() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   /*--- Constants init code ---*/
   if (__Pyx_InitCachedConstants() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  /*--- Global type/function init code ---*/
-  (void)__Pyx_modinit_global_init_code();
-  (void)__Pyx_modinit_variable_export_code();
-  (void)__Pyx_modinit_function_export_code();
-  if (unlikely(__Pyx_modinit_type_init_code() != 0)) goto __pyx_L1_error;
-  if (unlikely(__Pyx_modinit_type_import_code() != 0)) goto __pyx_L1_error;
-  (void)__Pyx_modinit_variable_import_code();
-  (void)__Pyx_modinit_function_import_code();
+  /*--- Global init code ---*/
+  __pyx_v_9playhouse_11_sqlite_ext_SQLITE_DATETIME_FORMATS = ((PyObject*)Py_None); Py_INCREF(Py_None);
+  __pyx_v_9playhouse_11_sqlite_ext_SQLITE_DATE_TRUNC_MAPPING = ((PyObject*)Py_None); Py_INCREF(Py_None);
+  /*--- Variable export code ---*/
+  /*--- Function export code ---*/
+  /*--- Type init code ---*/
+  __pyx_vtabptr_9playhouse_11_sqlite_ext__TableFunctionImpl = &__pyx_vtable_9playhouse_11_sqlite_ext__TableFunctionImpl;
+  __pyx_vtable_9playhouse_11_sqlite_ext__TableFunctionImpl.create_module = (PyObject *(*)(struct __pyx_obj_9playhouse_11_sqlite_ext__TableFunctionImpl *, pysqlite_Connection *))__pyx_f_9playhouse_11_sqlite_ext_18_TableFunctionImpl_create_module;
+  if (PyType_Ready(&__pyx_type_9playhouse_11_sqlite_ext__TableFunctionImpl) < 0) __PYX_ERR(0, 624, __pyx_L1_error)
+  __pyx_type_9playhouse_11_sqlite_ext__TableFunctionImpl.tp_print = 0;
+  if (__Pyx_SetVtable(__pyx_type_9playhouse_11_sqlite_ext__TableFunctionImpl.tp_dict, __pyx_vtabptr_9playhouse_11_sqlite_ext__TableFunctionImpl) < 0) __PYX_ERR(0, 624, __pyx_L1_error)
+  if (PyObject_SetAttrString(__pyx_m, "_TableFunctionImpl", (PyObject *)&__pyx_type_9playhouse_11_sqlite_ext__TableFunctionImpl) < 0) __PYX_ERR(0, 624, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_9playhouse_11_sqlite_ext__TableFunctionImpl) < 0) __PYX_ERR(0, 624, __pyx_L1_error)
+  __pyx_ptype_9playhouse_11_sqlite_ext__TableFunctionImpl = &__pyx_type_9playhouse_11_sqlite_ext__TableFunctionImpl;
+  if (PyType_Ready(&__pyx_type_9playhouse_11_sqlite_ext_BloomFilter) < 0) __PYX_ERR(0, 1146, __pyx_L1_error)
+  __pyx_type_9playhouse_11_sqlite_ext_BloomFilter.tp_print = 0;
+  if (PyObject_SetAttrString(__pyx_m, "BloomFilter", (PyObject *)&__pyx_type_9playhouse_11_sqlite_ext_BloomFilter) < 0) __PYX_ERR(0, 1146, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_9playhouse_11_sqlite_ext_BloomFilter) < 0) __PYX_ERR(0, 1146, __pyx_L1_error)
+  __pyx_ptype_9playhouse_11_sqlite_ext_BloomFilter = &__pyx_type_9playhouse_11_sqlite_ext_BloomFilter;
+  if (PyType_Ready(&__pyx_type_9playhouse_11_sqlite_ext_BloomFilterAggregate) < 0) __PYX_ERR(0, 1182, __pyx_L1_error)
+  __pyx_type_9playhouse_11_sqlite_ext_BloomFilterAggregate.tp_print = 0;
+  if (PyObject_SetAttrString(__pyx_m, "BloomFilterAggregate", (PyObject *)&__pyx_type_9playhouse_11_sqlite_ext_BloomFilterAggregate) < 0) __PYX_ERR(0, 1182, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_9playhouse_11_sqlite_ext_BloomFilterAggregate) < 0) __PYX_ERR(0, 1182, __pyx_L1_error)
+  __pyx_ptype_9playhouse_11_sqlite_ext_BloomFilterAggregate = &__pyx_type_9playhouse_11_sqlite_ext_BloomFilterAggregate;
+  __pyx_vtabptr_9playhouse_11_sqlite_ext_Blob = &__pyx_vtable_9playhouse_11_sqlite_ext_Blob;
+  __pyx_vtable_9playhouse_11_sqlite_ext_Blob._close = (PyObject *(*)(struct __pyx_obj_9playhouse_11_sqlite_ext_Blob *))__pyx_f_9playhouse_11_sqlite_ext_4Blob__close;
+  if (PyType_Ready(&__pyx_type_9playhouse_11_sqlite_ext_Blob) < 0) __PYX_ERR(0, 1258, __pyx_L1_error)
+  __pyx_type_9playhouse_11_sqlite_ext_Blob.tp_print = 0;
+  if (__Pyx_SetVtable(__pyx_type_9playhouse_11_sqlite_ext_Blob.tp_dict, __pyx_vtabptr_9playhouse_11_sqlite_ext_Blob) < 0) __PYX_ERR(0, 1258, __pyx_L1_error)
+  if (PyObject_SetAttrString(__pyx_m, "Blob", (PyObject *)&__pyx_type_9playhouse_11_sqlite_ext_Blob) < 0) __PYX_ERR(0, 1258, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_9playhouse_11_sqlite_ext_Blob) < 0) __PYX_ERR(0, 1258, __pyx_L1_error)
+  __pyx_ptype_9playhouse_11_sqlite_ext_Blob = &__pyx_type_9playhouse_11_sqlite_ext_Blob;
+  if (PyType_Ready(&__pyx_type_9playhouse_11_sqlite_ext_ConnectionHelper) < 0) __PYX_ERR(0, 1406, __pyx_L1_error)
+  __pyx_type_9playhouse_11_sqlite_ext_ConnectionHelper.tp_print = 0;
+  if (PyObject_SetAttrString(__pyx_m, "ConnectionHelper", (PyObject *)&__pyx_type_9playhouse_11_sqlite_ext_ConnectionHelper) < 0) __PYX_ERR(0, 1406, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_9playhouse_11_sqlite_ext_ConnectionHelper) < 0) __PYX_ERR(0, 1406, __pyx_L1_error)
+  __pyx_ptype_9playhouse_11_sqlite_ext_ConnectionHelper = &__pyx_type_9playhouse_11_sqlite_ext_ConnectionHelper;
+  if (PyType_Ready(&__pyx_type_9playhouse_11_sqlite_ext___pyx_scope_struct__make_hash) < 0) __PYX_ERR(0, 1056, __pyx_L1_error)
+  __pyx_type_9playhouse_11_sqlite_ext___pyx_scope_struct__make_hash.tp_print = 0;
+  __pyx_ptype_9playhouse_11_sqlite_ext___pyx_scope_struct__make_hash = &__pyx_type_9playhouse_11_sqlite_ext___pyx_scope_struct__make_hash;
+  /*--- Type import code ---*/
+  __pyx_ptype_7cpython_4type_type = __Pyx_ImportType(__Pyx_BUILTIN_MODULE_NAME, "type", 
+  #if CYTHON_COMPILING_IN_PYPY
+  sizeof(PyTypeObject),
+  #else
+  sizeof(PyHeapTypeObject),
+  #endif
+  0); if (unlikely(!__pyx_ptype_7cpython_4type_type)) __PYX_ERR(3, 9, __pyx_L1_error)
+  __pyx_ptype_7cpython_4bool_bool = __Pyx_ImportType(__Pyx_BUILTIN_MODULE_NAME, "bool", sizeof(PyBoolObject), 0); if (unlikely(!__pyx_ptype_7cpython_4bool_bool)) __PYX_ERR(4, 8, __pyx_L1_error)
+  __pyx_ptype_7cpython_7complex_complex = __Pyx_ImportType(__Pyx_BUILTIN_MODULE_NAME, "complex", sizeof(PyComplexObject), 0); if (unlikely(!__pyx_ptype_7cpython_7complex_complex)) __PYX_ERR(5, 15, __pyx_L1_error)
+  __pyx_ptype_7cpython_8datetime_date = __Pyx_ImportType("datetime", "date", sizeof(PyDateTime_Date), 0); if (unlikely(!__pyx_ptype_7cpython_8datetime_date)) __PYX_ERR(2, 9, __pyx_L1_error)
+  __pyx_ptype_7cpython_8datetime_time = __Pyx_ImportType("datetime", "time", sizeof(PyDateTime_Time), 0); if (unlikely(!__pyx_ptype_7cpython_8datetime_time)) __PYX_ERR(2, 12, __pyx_L1_error)
+  __pyx_ptype_7cpython_8datetime_datetime = __Pyx_ImportType("datetime", "datetime", sizeof(PyDateTime_DateTime), 0); if (unlikely(!__pyx_ptype_7cpython_8datetime_datetime)) __PYX_ERR(2, 15, __pyx_L1_error)
+  __pyx_ptype_7cpython_8datetime_timedelta = __Pyx_ImportType("datetime", "timedelta", sizeof(PyDateTime_Delta), 0); if (unlikely(!__pyx_ptype_7cpython_8datetime_timedelta)) __PYX_ERR(2, 18, __pyx_L1_error)
+  __pyx_ptype_7cpython_8datetime_tzinfo = __Pyx_ImportType("datetime", "tzinfo", sizeof(PyDateTime_TZInfo), 0); if (unlikely(!__pyx_ptype_7cpython_8datetime_tzinfo)) __PYX_ERR(2, 21, __pyx_L1_error)
+  /*--- Variable import code ---*/
+  /*--- Function import code ---*/
   /*--- Execution code ---*/
   #if defined(__Pyx_Generator_USED) || defined(__Pyx_Coroutine_USED)
   if (__Pyx_patch_abc() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
 
   /* "playhouse/_sqlite_ext.pyx":1
  * import hashlib             # <<<<<<<<<<<<<<
@@ -22250,547 +22349,673 @@
   __pyx_t_1 = __Pyx_PyBytes_FromStringAndSize(((const char*)sqlite3_version) + 0, 4 - 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = PyObject_RichCompare(__pyx_t_1, __pyx_kp_b_3_26, Py_GE); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_USE_SQLITE_CONSTRAINT, __pyx_t_2) < 0) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":673
+  /* "playhouse/_sqlite_ext.pyx":672
  * 
  * 
  * class TableFunction(object):             # <<<<<<<<<<<<<<
  *     columns = None
  *     params = None
  */
-  __pyx_t_2 = __Pyx_CalculateMetaclass(NULL, __pyx_tuple__21); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 673, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_CalculateMetaclass(NULL, __pyx_tuple__32); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 672, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_Py3MetaclassPrepare(__pyx_t_2, __pyx_tuple__21, __pyx_n_s_TableFunction, __pyx_n_s_TableFunction, (PyObject *) NULL, __pyx_n_s_playhouse__sqlite_ext, (PyObject *) NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 673, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_Py3MetaclassPrepare(__pyx_t_2, __pyx_tuple__32, __pyx_n_s_TableFunction, __pyx_n_s_TableFunction, (PyObject *) NULL, __pyx_n_s_playhouse__sqlite_ext, (PyObject *) NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 672, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
 
-  /* "playhouse/_sqlite_ext.pyx":674
+  /* "playhouse/_sqlite_ext.pyx":673
  * 
  * class TableFunction(object):
  *     columns = None             # <<<<<<<<<<<<<<
  *     params = None
  *     name = None
  */
-  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_columns, Py_None) < 0) __PYX_ERR(0, 674, __pyx_L1_error)
+  if (PyObject_SetItem(__pyx_t_1, __pyx_n_s_columns, Py_None) < 0) __PYX_ERR(0, 673, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":675
+  /* "playhouse/_sqlite_ext.pyx":674
  * class TableFunction(object):
  *     columns = None
  *     params = None             # <<<<<<<<<<<<<<
  *     name = None
  *     print_tracebacks = True
  */
-  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_params, Py_None) < 0) __PYX_ERR(0, 675, __pyx_L1_error)
+  if (PyObject_SetItem(__pyx_t_1, __pyx_n_s_params, Py_None) < 0) __PYX_ERR(0, 674, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":676
+  /* "playhouse/_sqlite_ext.pyx":675
  *     columns = None
  *     params = None
  *     name = None             # <<<<<<<<<<<<<<
  *     print_tracebacks = True
  *     _ncols = None
  */
-  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_name, Py_None) < 0) __PYX_ERR(0, 676, __pyx_L1_error)
+  if (PyObject_SetItem(__pyx_t_1, __pyx_n_s_name, Py_None) < 0) __PYX_ERR(0, 675, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":677
+  /* "playhouse/_sqlite_ext.pyx":676
  *     params = None
  *     name = None
  *     print_tracebacks = True             # <<<<<<<<<<<<<<
  *     _ncols = None
  * 
  */
-  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_print_tracebacks, Py_True) < 0) __PYX_ERR(0, 677, __pyx_L1_error)
+  if (PyObject_SetItem(__pyx_t_1, __pyx_n_s_print_tracebacks, Py_True) < 0) __PYX_ERR(0, 676, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":678
+  /* "playhouse/_sqlite_ext.pyx":677
  *     name = None
  *     print_tracebacks = True
  *     _ncols = None             # <<<<<<<<<<<<<<
  * 
  *     @classmethod
  */
-  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_ncols, Py_None) < 0) __PYX_ERR(0, 678, __pyx_L1_error)
+  if (PyObject_SetItem(__pyx_t_1, __pyx_n_s_ncols, Py_None) < 0) __PYX_ERR(0, 677, __pyx_L1_error)
 
-  /* "playhouse/_sqlite_ext.pyx":681
+  /* "playhouse/_sqlite_ext.pyx":680
  * 
  *     @classmethod
  *     def register(cls, conn):             # <<<<<<<<<<<<<<
  *         cdef _TableFunctionImpl impl = _TableFunctionImpl(cls)
  *         impl.create_module(<pysqlite_Connection *>conn)
  */
-  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_13TableFunction_1register, __Pyx_CYFUNCTION_CLASSMETHOD, __pyx_n_s_TableFunction_register, NULL, __pyx_n_s_playhouse__sqlite_ext, __pyx_d, ((PyObject *)__pyx_codeobj__23)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 681, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_13TableFunction_1register, __Pyx_CYFUNCTION_CLASSMETHOD, __pyx_n_s_TableFunction_register, NULL, __pyx_n_s_playhouse__sqlite_ext, __pyx_d, ((PyObject *)__pyx_codeobj__34)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 680, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
 
-  /* "playhouse/_sqlite_ext.pyx":680
+  /* "playhouse/_sqlite_ext.pyx":679
  *     _ncols = None
  * 
  *     @classmethod             # <<<<<<<<<<<<<<
  *     def register(cls, conn):
  *         cdef _TableFunctionImpl impl = _TableFunctionImpl(cls)
  */
-  __pyx_t_4 = __Pyx_Method_ClassMethod(__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 680, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_Method_ClassMethod(__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 679, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_register, __pyx_t_4) < 0) __PYX_ERR(0, 681, __pyx_L1_error)
+  if (PyObject_SetItem(__pyx_t_1, __pyx_n_s_register, __pyx_t_4) < 0) __PYX_ERR(0, 680, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":686
+  /* "playhouse/_sqlite_ext.pyx":685
  *         cls._ncols = len(cls.columns)
  * 
  *     def initialize(self, **filters):             # <<<<<<<<<<<<<<
  *         raise NotImplementedError
  * 
  */
-  __pyx_t_4 = __Pyx_CyFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_13TableFunction_3initialize, 0, __pyx_n_s_TableFunction_initialize, NULL, __pyx_n_s_playhouse__sqlite_ext, __pyx_d, ((PyObject *)__pyx_codeobj__25)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 686, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_13TableFunction_3initialize, 0, __pyx_n_s_TableFunction_initialize, NULL, __pyx_n_s_playhouse__sqlite_ext, __pyx_d, ((PyObject *)__pyx_codeobj__36)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 685, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_initialize, __pyx_t_4) < 0) __PYX_ERR(0, 686, __pyx_L1_error)
+  if (PyObject_SetItem(__pyx_t_1, __pyx_n_s_initialize, __pyx_t_4) < 0) __PYX_ERR(0, 685, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":689
+  /* "playhouse/_sqlite_ext.pyx":688
  *         raise NotImplementedError
  * 
  *     def iterate(self, idx):             # <<<<<<<<<<<<<<
  *         raise NotImplementedError
  * 
  */
-  __pyx_t_4 = __Pyx_CyFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_13TableFunction_5iterate, 0, __pyx_n_s_TableFunction_iterate, NULL, __pyx_n_s_playhouse__sqlite_ext, __pyx_d, ((PyObject *)__pyx_codeobj__27)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 689, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_13TableFunction_5iterate, 0, __pyx_n_s_TableFunction_iterate, NULL, __pyx_n_s_playhouse__sqlite_ext, __pyx_d, ((PyObject *)__pyx_codeobj__38)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 688, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_iterate, __pyx_t_4) < 0) __PYX_ERR(0, 689, __pyx_L1_error)
+  if (PyObject_SetItem(__pyx_t_1, __pyx_n_s_iterate, __pyx_t_4) < 0) __PYX_ERR(0, 688, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":693
+  /* "playhouse/_sqlite_ext.pyx":692
  * 
  *     @classmethod
  *     def get_table_columns_declaration(cls):             # <<<<<<<<<<<<<<
  *         cdef list accum = []
  * 
  */
-  __pyx_t_4 = __Pyx_CyFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_13TableFunction_7get_table_columns_declaration, __Pyx_CYFUNCTION_CLASSMETHOD, __pyx_n_s_TableFunction_get_table_columns, NULL, __pyx_n_s_playhouse__sqlite_ext, __pyx_d, ((PyObject *)__pyx_codeobj__29)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 693, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_13TableFunction_7get_table_columns_declaration, __Pyx_CYFUNCTION_CLASSMETHOD, __pyx_n_s_TableFunction_get_table_columns, NULL, __pyx_n_s_playhouse__sqlite_ext, __pyx_d, ((PyObject *)__pyx_codeobj__40)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 692, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
 
-  /* "playhouse/_sqlite_ext.pyx":692
+  /* "playhouse/_sqlite_ext.pyx":691
  *         raise NotImplementedError
  * 
  *     @classmethod             # <<<<<<<<<<<<<<
  *     def get_table_columns_declaration(cls):
  *         cdef list accum = []
  */
-  __pyx_t_3 = __Pyx_Method_ClassMethod(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 692, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_Method_ClassMethod(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 691, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_get_table_columns_declaration, __pyx_t_3) < 0) __PYX_ERR(0, 693, __pyx_L1_error)
+  if (PyObject_SetItem(__pyx_t_1, __pyx_n_s_get_table_columns_declaration, __pyx_t_3) < 0) __PYX_ERR(0, 692, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":673
+  /* "playhouse/_sqlite_ext.pyx":672
  * 
  * 
  * class TableFunction(object):             # <<<<<<<<<<<<<<
  *     columns = None
  *     params = None
  */
-  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_TableFunction, __pyx_tuple__21, __pyx_t_1, NULL, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 673, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_TableFunction, __pyx_tuple__32, __pyx_t_1, NULL, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 672, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_TableFunction, __pyx_t_3) < 0) __PYX_ERR(0, 673, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_TableFunction, __pyx_t_3) < 0) __PYX_ERR(0, 672, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":712
+  /* "playhouse/_sqlite_ext.pyx":711
  * 
  * cdef tuple SQLITE_DATETIME_FORMATS = (
  *     '%Y-%m-%d %H:%M:%S',             # <<<<<<<<<<<<<<
  *     '%Y-%m-%d %H:%M:%S.%f',
  *     '%Y-%m-%d',
  */
-  __Pyx_INCREF(__pyx_tuple__30);
+  __Pyx_INCREF(__pyx_tuple__41);
   __Pyx_XGOTREF(__pyx_v_9playhouse_11_sqlite_ext_SQLITE_DATETIME_FORMATS);
-  __Pyx_DECREF_SET(__pyx_v_9playhouse_11_sqlite_ext_SQLITE_DATETIME_FORMATS, __pyx_tuple__30);
-  __Pyx_GIVEREF(__pyx_tuple__30);
+  __Pyx_DECREF_SET(__pyx_v_9playhouse_11_sqlite_ext_SQLITE_DATETIME_FORMATS, __pyx_tuple__41);
+  __Pyx_GIVEREF(__pyx_tuple__41);
 
-  /* "playhouse/_sqlite_ext.pyx":720
+  /* "playhouse/_sqlite_ext.pyx":719
  * 
  * cdef dict SQLITE_DATE_TRUNC_MAPPING = {
  *     'year': '%Y',             # <<<<<<<<<<<<<<
  *     'month': '%Y-%m',
  *     'day': '%Y-%m-%d',
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 720, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 719, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_year, __pyx_kp_s_Y) < 0) __PYX_ERR(0, 720, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_month, __pyx_kp_s_Y_m) < 0) __PYX_ERR(0, 720, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_day, __pyx_kp_s_Y_m_d) < 0) __PYX_ERR(0, 720, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_hour, __pyx_kp_s_Y_m_d_H) < 0) __PYX_ERR(0, 720, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_minute, __pyx_kp_s_Y_m_d_H_M) < 0) __PYX_ERR(0, 720, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_second, __pyx_kp_s_Y_m_d_H_M_S) < 0) __PYX_ERR(0, 720, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_year, __pyx_kp_s_Y) < 0) __PYX_ERR(0, 719, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_month, __pyx_kp_s_Y_m) < 0) __PYX_ERR(0, 719, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_day, __pyx_kp_s_Y_m_d) < 0) __PYX_ERR(0, 719, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_hour, __pyx_kp_s_Y_m_d_H) < 0) __PYX_ERR(0, 719, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_minute, __pyx_kp_s_Y_m_d_H_M) < 0) __PYX_ERR(0, 719, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_second, __pyx_kp_s_Y_m_d_H_M_S) < 0) __PYX_ERR(0, 719, __pyx_L1_error)
   __Pyx_XGOTREF(__pyx_v_9playhouse_11_sqlite_ext_SQLITE_DATE_TRUNC_MAPPING);
   __Pyx_DECREF_SET(__pyx_v_9playhouse_11_sqlite_ext_SQLITE_DATE_TRUNC_MAPPING, ((PyObject*)__pyx_t_2));
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":790
+  /* "playhouse/_sqlite_ext.pyx":789
  * 
  * 
  * def peewee_rank(py_match_info, *raw_weights):             # <<<<<<<<<<<<<<
  *     cdef:
  *         unsigned int *match_info
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_1peewee_rank, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 790, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_1peewee_rank, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 789, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_peewee_rank, __pyx_t_2) < 0) __PYX_ERR(0, 790, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_peewee_rank, __pyx_t_2) < 0) __PYX_ERR(0, 789, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":832
+  /* "playhouse/_sqlite_ext.pyx":831
  * 
  * 
  * def peewee_lucene(py_match_info, *raw_weights):             # <<<<<<<<<<<<<<
  *     # Usage: peewee_lucene(matchinfo(table, 'pcnalx'), 1)
  *     cdef:
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_3peewee_lucene, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 832, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_3peewee_lucene, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 831, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_peewee_lucene, __pyx_t_2) < 0) __PYX_ERR(0, 832, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_peewee_lucene, __pyx_t_2) < 0) __PYX_ERR(0, 831, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":874
+  /* "playhouse/_sqlite_ext.pyx":873
  * 
  * 
  * def peewee_bm25(py_match_info, *raw_weights):             # <<<<<<<<<<<<<<
  *     # Usage: peewee_bm25(matchinfo(table, 'pcnalx'), 1)
  *     # where the second parameter is the index of the column and
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_5peewee_bm25, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 874, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_5peewee_bm25, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 873, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_peewee_bm25, __pyx_t_2) < 0) __PYX_ERR(0, 874, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_peewee_bm25, __pyx_t_2) < 0) __PYX_ERR(0, 873, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":945
+  /* "playhouse/_sqlite_ext.pyx":944
  * 
  * 
  * def peewee_bm25f(py_match_info, *raw_weights):             # <<<<<<<<<<<<<<
  *     # Usage: peewee_bm25f(matchinfo(table, 'pcnalx'), 1)
  *     # where the second parameter is the index of the column and
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_7peewee_bm25f, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 945, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_7peewee_bm25f, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 944, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_peewee_bm25f, __pyx_t_2) < 0) __PYX_ERR(0, 945, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_peewee_bm25f, __pyx_t_2) < 0) __PYX_ERR(0, 944, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1044
+  /* "playhouse/_sqlite_ext.pyx":1043
  * 
  * 
  * def peewee_murmurhash(key, seed=None):             # <<<<<<<<<<<<<<
  *     if key is None:
  *         return
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_9peewee_murmurhash, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1044, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_9peewee_murmurhash, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1043, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_peewee_murmurhash, __pyx_t_2) < 0) __PYX_ERR(0, 1044, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_peewee_murmurhash, __pyx_t_2) < 0) __PYX_ERR(0, 1043, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1057
+  /* "playhouse/_sqlite_ext.pyx":1056
  * 
  * 
  * def make_hash(hash_impl):             # <<<<<<<<<<<<<<
  *     def inner(*items):
  *         state = hash_impl()
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_11make_hash, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1057, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_11make_hash, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1056, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_make_hash, __pyx_t_2) < 0) __PYX_ERR(0, 1057, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_make_hash, __pyx_t_2) < 0) __PYX_ERR(0, 1056, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1066
+  /* "playhouse/_sqlite_ext.pyx":1065
  * 
  * 
  * peewee_md5 = make_hash(hashlib.md5)             # <<<<<<<<<<<<<<
  * peewee_sha1 = make_hash(hashlib.sha1)
  * peewee_sha256 = make_hash(hashlib.sha256)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_make_hash); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1066, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_hashlib); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1066, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_make_hash); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1065, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_md5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1066, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_hashlib); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1065, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1066, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_md5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1065, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_peewee_md5, __pyx_t_1) < 0) __PYX_ERR(0, 1066, __pyx_L1_error)
+  __pyx_t_3 = NULL;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
+    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
+    if (likely(__pyx_t_3)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+      __Pyx_INCREF(__pyx_t_3);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_1, function);
+    }
+  }
+  if (!__pyx_t_3) {
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1065, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_GOTREF(__pyx_t_2);
+  } else {
+    #if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(__pyx_t_1)) {
+      PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_4};
+      __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1065, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    } else
+    #endif
+    #if CYTHON_FAST_PYCCALL
+    if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
+      PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_4};
+      __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1065, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    } else
+    #endif
+    {
+      __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1065, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
+      __Pyx_GIVEREF(__pyx_t_4);
+      PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_t_4);
+      __pyx_t_4 = 0;
+      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_5, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1065, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    }
+  }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_peewee_md5, __pyx_t_2) < 0) __PYX_ERR(0, 1065, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1067
+  /* "playhouse/_sqlite_ext.pyx":1066
  * 
  * peewee_md5 = make_hash(hashlib.md5)
  * peewee_sha1 = make_hash(hashlib.sha1)             # <<<<<<<<<<<<<<
  * peewee_sha256 = make_hash(hashlib.sha256)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_make_hash); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1067, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_make_hash); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1066, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_hashlib); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1067, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_sha1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1067, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1067, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_hashlib); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1066, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_sha1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1066, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = NULL;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
+    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
+    if (likely(__pyx_t_5)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+      __Pyx_INCREF(__pyx_t_5);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_1, function);
+    }
+  }
+  if (!__pyx_t_5) {
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1066, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_GOTREF(__pyx_t_2);
+  } else {
+    #if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(__pyx_t_1)) {
+      PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_4};
+      __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1066, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    } else
+    #endif
+    #if CYTHON_FAST_PYCCALL
+    if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
+      PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_4};
+      __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1066, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    } else
+    #endif
+    {
+      __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1066, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
+      __Pyx_GIVEREF(__pyx_t_4);
+      PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_t_4);
+      __pyx_t_4 = 0;
+      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1066, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    }
+  }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_peewee_sha1, __pyx_t_2) < 0) __PYX_ERR(0, 1066, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_peewee_sha1, __pyx_t_3) < 0) __PYX_ERR(0, 1067, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1068
+  /* "playhouse/_sqlite_ext.pyx":1067
  * peewee_md5 = make_hash(hashlib.md5)
  * peewee_sha1 = make_hash(hashlib.sha1)
  * peewee_sha256 = make_hash(hashlib.sha256)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_make_hash); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1068, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_hashlib); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1068, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sha256); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1068, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_make_hash); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1067, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1068, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_hashlib); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1067, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_sha256); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1067, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = NULL;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
+    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
+    if (likely(__pyx_t_3)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+      __Pyx_INCREF(__pyx_t_3);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_1, function);
+    }
+  }
+  if (!__pyx_t_3) {
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1067, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_GOTREF(__pyx_t_2);
+  } else {
+    #if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(__pyx_t_1)) {
+      PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_4};
+      __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1067, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    } else
+    #endif
+    #if CYTHON_FAST_PYCCALL
+    if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
+      PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_4};
+      __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-1, 1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1067, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    } else
+    #endif
+    {
+      __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1067, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
+      __Pyx_GIVEREF(__pyx_t_4);
+      PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_t_4);
+      __pyx_t_4 = 0;
+      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_5, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1067, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    }
+  }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_peewee_sha256, __pyx_t_2) < 0) __PYX_ERR(0, 1068, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_peewee_sha256, __pyx_t_2) < 0) __PYX_ERR(0, 1067, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1071
+  /* "playhouse/_sqlite_ext.pyx":1070
  * 
  * 
  * def _register_functions(database, pairs):             # <<<<<<<<<<<<<<
  *     for func, name in pairs:
  *         database.register_function(func, name)
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_13_register_functions, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1071, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_13_register_functions, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1070, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_register_functions, __pyx_t_2) < 0) __PYX_ERR(0, 1071, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_register_functions, __pyx_t_2) < 0) __PYX_ERR(0, 1070, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1076
+  /* "playhouse/_sqlite_ext.pyx":1075
  * 
  * 
  * def register_hash_functions(database):             # <<<<<<<<<<<<<<
  *     _register_functions(database, (
  *         (peewee_murmurhash, 'murmurhash'),
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_15register_hash_functions, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1076, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_15register_hash_functions, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1075, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_register_hash_functions, __pyx_t_2) < 0) __PYX_ERR(0, 1076, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_register_hash_functions, __pyx_t_2) < 0) __PYX_ERR(0, 1075, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1086
+  /* "playhouse/_sqlite_ext.pyx":1085
  * 
  * 
  * def register_rank_functions(database):             # <<<<<<<<<<<<<<
  *     _register_functions(database, (
  *         (peewee_bm25, 'fts_bm25'),
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_17register_rank_functions, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1086, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_17register_rank_functions, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1085, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_register_rank_functions, __pyx_t_2) < 0) __PYX_ERR(0, 1086, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_register_rank_functions, __pyx_t_2) < 0) __PYX_ERR(0, 1085, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1099
+  /* "playhouse/_sqlite_ext.pyx":1098
  * 
  * cdef int seeds[10]
  * seeds[:] = [0, 1337, 37, 0xabcd, 0xdead, 0xface, 97, 0xed11, 0xcad9, 0x827b]             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_5[0] = 0;
-  __pyx_t_5[1] = 0x539;
-  __pyx_t_5[2] = 37;
-  __pyx_t_5[3] = 0xabcd;
-  __pyx_t_5[4] = 0xdead;
-  __pyx_t_5[5] = 0xface;
-  __pyx_t_5[6] = 97;
-  __pyx_t_5[7] = 0xed11;
-  __pyx_t_5[8] = 0xcad9;
-  __pyx_t_5[9] = 0x827b;
-  memcpy(&(__pyx_v_9playhouse_11_sqlite_ext_seeds[0]), __pyx_t_5, sizeof(__pyx_v_9playhouse_11_sqlite_ext_seeds[0]) * (10));
+  __pyx_t_6[0] = 0;
+  __pyx_t_6[1] = 0x539;
+  __pyx_t_6[2] = 37;
+  __pyx_t_6[3] = 0xabcd;
+  __pyx_t_6[4] = 0xdead;
+  __pyx_t_6[5] = 0xface;
+  __pyx_t_6[6] = 97;
+  __pyx_t_6[7] = 0xed11;
+  __pyx_t_6[8] = 0xcad9;
+  __pyx_t_6[9] = 0x827b;
+  memcpy(&(__pyx_v_9playhouse_11_sqlite_ext_seeds[0]), __pyx_t_6, sizeof(__pyx_v_9playhouse_11_sqlite_ext_seeds[0]) * (10));
 
-  /* "playhouse/_sqlite_ext.pyx":1178
+  /* "playhouse/_sqlite_ext.pyx":1177
  * 
  *     @classmethod
  *     def calculate_size(cls, double n, double p):             # <<<<<<<<<<<<<<
  *         cdef double m = ceil((n * log(p)) / log(1.0 / (pow(2.0, log(2.0)))))
  *         return m
  */
-  __Pyx_GetNameInClass(__pyx_t_2, (PyObject *)__pyx_ptype_9playhouse_11_sqlite_ext_BloomFilter, __pyx_n_s_calculate_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1178, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetNameInClass((PyObject *)__pyx_ptype_9playhouse_11_sqlite_ext_BloomFilter, __pyx_n_s_calculate_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1177, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
 
-  /* "playhouse/_sqlite_ext.pyx":1177
+  /* "playhouse/_sqlite_ext.pyx":1176
  *         return buf
  * 
  *     @classmethod             # <<<<<<<<<<<<<<
  *     def calculate_size(cls, double n, double p):
  *         cdef double m = ceil((n * log(p)) / log(1.0 / (pow(2.0, log(2.0)))))
  */
-  __pyx_t_1 = __Pyx_Method_ClassMethod(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1177, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_Method_ClassMethod(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1176, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem((PyObject *)__pyx_ptype_9playhouse_11_sqlite_ext_BloomFilter->tp_dict, __pyx_n_s_calculate_size, __pyx_t_1) < 0) __PYX_ERR(0, 1178, __pyx_L1_error)
+  if (PyDict_SetItem((PyObject *)__pyx_ptype_9playhouse_11_sqlite_ext_BloomFilter->tp_dict, __pyx_n_s_calculate_size, __pyx_t_1) < 0) __PYX_ERR(0, 1177, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   PyType_Modified(__pyx_ptype_9playhouse_11_sqlite_ext_BloomFilter);
 
-  /* "playhouse/_sqlite_ext.pyx":1204
+  /* "playhouse/_sqlite_ext.pyx":1203
  * 
  * 
  * def peewee_bloomfilter_contains(key, data):             # <<<<<<<<<<<<<<
  *     cdef:
  *         bf_t bf
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_19peewee_bloomfilter_contains, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1204, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_19peewee_bloomfilter_contains, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1203, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_peewee_bloomfilter_contains, __pyx_t_1) < 0) __PYX_ERR(0, 1204, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_peewee_bloomfilter_contains, __pyx_t_1) < 0) __PYX_ERR(0, 1203, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1218
+  /* "playhouse/_sqlite_ext.pyx":1217
  * 
  * 
  * def peewee_bloomfilter_calculate_size(n_items, error_p):             # <<<<<<<<<<<<<<
  *     return BloomFilter.calculate_size(n_items, error_p)
  * 
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_21peewee_bloomfilter_calculate_size, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1218, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_21peewee_bloomfilter_calculate_size, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1217, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_peewee_bloomfilter_calculate_siz, __pyx_t_1) < 0) __PYX_ERR(0, 1218, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_peewee_bloomfilter_calculate_siz, __pyx_t_1) < 0) __PYX_ERR(0, 1217, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1222
+  /* "playhouse/_sqlite_ext.pyx":1221
  * 
  * 
  * def register_bloomfilter(database):             # <<<<<<<<<<<<<<
  *     database.register_aggregate(BloomFilterAggregate, 'bloomfilter')
  *     database.register_function(peewee_bloomfilter_contains,
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_23register_bloomfilter, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1222, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_23register_bloomfilter, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1221, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_register_bloomfilter, __pyx_t_1) < 0) __PYX_ERR(0, 1222, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_register_bloomfilter, __pyx_t_1) < 0) __PYX_ERR(0, 1221, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1240
+  /* "playhouse/_sqlite_ext.pyx":1239
  * 
  * 
  * class ZeroBlob(Node):             # <<<<<<<<<<<<<<
  *     def __init__(self, length):
  *         if not isinstance(length, int) or length < 0:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Node); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1240, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_Node); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1239, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1240, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1239, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1240, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1239, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_t_2, __pyx_n_s_ZeroBlob, __pyx_n_s_ZeroBlob, (PyObject *) NULL, __pyx_n_s_playhouse__sqlite_ext, (PyObject *) NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1240, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_5 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_t_2, __pyx_n_s_ZeroBlob, __pyx_n_s_ZeroBlob, (PyObject *) NULL, __pyx_n_s_playhouse__sqlite_ext, (PyObject *) NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1239, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
 
-  /* "playhouse/_sqlite_ext.pyx":1241
+  /* "playhouse/_sqlite_ext.pyx":1240
  * 
  * class ZeroBlob(Node):
  *     def __init__(self, length):             # <<<<<<<<<<<<<<
  *         if not isinstance(length, int) or length < 0:
  *             raise ValueError('Length must be a positive integer.')
  */
-  __pyx_t_4 = __Pyx_CyFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_8ZeroBlob_1__init__, 0, __pyx_n_s_ZeroBlob___init, NULL, __pyx_n_s_playhouse__sqlite_ext, __pyx_d, ((PyObject *)__pyx_codeobj__56)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1241, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_8ZeroBlob_1__init__, 0, __pyx_n_s_ZeroBlob___init, NULL, __pyx_n_s_playhouse__sqlite_ext, __pyx_d, ((PyObject *)__pyx_codeobj__67)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1240, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (__Pyx_SetNameInClass(__pyx_t_3, __pyx_n_s_init, __pyx_t_4) < 0) __PYX_ERR(0, 1241, __pyx_L1_error)
+  if (PyObject_SetItem(__pyx_t_5, __pyx_n_s_init, __pyx_t_4) < 0) __PYX_ERR(0, 1240, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1246
+  /* "playhouse/_sqlite_ext.pyx":1245
  *         self.length = length
  * 
  *     def __sql__(self, ctx):             # <<<<<<<<<<<<<<
  *         return ctx.literal('zeroblob(%s)' % self.length)
  * 
  */
-  __pyx_t_4 = __Pyx_CyFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_8ZeroBlob_3__sql__, 0, __pyx_n_s_ZeroBlob___sql, NULL, __pyx_n_s_playhouse__sqlite_ext, __pyx_d, ((PyObject *)__pyx_codeobj__58)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1246, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_8ZeroBlob_3__sql__, 0, __pyx_n_s_ZeroBlob___sql, NULL, __pyx_n_s_playhouse__sqlite_ext, __pyx_d, ((PyObject *)__pyx_codeobj__69)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1245, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (__Pyx_SetNameInClass(__pyx_t_3, __pyx_n_s_sql, __pyx_t_4) < 0) __PYX_ERR(0, 1246, __pyx_L1_error)
+  if (PyObject_SetItem(__pyx_t_5, __pyx_n_s_sql, __pyx_t_4) < 0) __PYX_ERR(0, 1245, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1240
+  /* "playhouse/_sqlite_ext.pyx":1239
  * 
  * 
  * class ZeroBlob(Node):             # <<<<<<<<<<<<<<
  *     def __init__(self, length):
  *         if not isinstance(length, int) or length < 0:
  */
-  __pyx_t_4 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_ZeroBlob, __pyx_t_2, __pyx_t_3, NULL, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1240, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_ZeroBlob, __pyx_t_2, __pyx_t_5, NULL, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1239, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ZeroBlob, __pyx_t_4) < 0) __PYX_ERR(0, 1240, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ZeroBlob, __pyx_t_4) < 0) __PYX_ERR(0, 1239, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1386
+  /* "playhouse/_sqlite_ext.pyx":1385
  * 
  * 
  * def sqlite_get_status(flag):             # <<<<<<<<<<<<<<
  *     cdef:
  *         int current, highwater, rc
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_25sqlite_get_status, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1386, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_25sqlite_get_status, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1385, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_sqlite_get_status, __pyx_t_2) < 0) __PYX_ERR(0, 1386, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_sqlite_get_status, __pyx_t_2) < 0) __PYX_ERR(0, 1385, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1396
+  /* "playhouse/_sqlite_ext.pyx":1395
  * 
  * 
  * def sqlite_get_db_status(conn, flag):             # <<<<<<<<<<<<<<
  *     cdef:
  *         int current, highwater, rc
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_27sqlite_get_db_status, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1396, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_27sqlite_get_db_status, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1395, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_sqlite_get_db_status, __pyx_t_2) < 0) __PYX_ERR(0, 1396, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_sqlite_get_db_status, __pyx_t_2) < 0) __PYX_ERR(0, 1395, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1508
+  /* "playhouse/_sqlite_ext.pyx":1507
  * 
  * 
  * def backup(src_conn, dest_conn, pages=None, name=None, progress=None):             # <<<<<<<<<<<<<<
  *     cdef:
  *         bytes bname = encode(name or 'main')
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_29backup, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1508, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_29backup, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1507, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_backup, __pyx_t_2) < 0) __PYX_ERR(0, 1508, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_backup, __pyx_t_2) < 0) __PYX_ERR(0, 1507, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "playhouse/_sqlite_ext.pyx":1550
+  /* "playhouse/_sqlite_ext.pyx":1549
  * 
  * 
  * def backup_to_file(src_conn, filename, pages=None, name=None, progress=None):             # <<<<<<<<<<<<<<
  *     dest_conn = pysqlite.connect(filename)
  *     backup(src_conn, dest_conn, pages=pages, name=name, progress=progress)
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_31backup_to_file, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1550, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_31backup_to_file, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1549, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_backup_to_file, __pyx_t_2) < 0) __PYX_ERR(0, 1550, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_backup_to_file, __pyx_t_2) < 0) __PYX_ERR(0, 1549, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "(tree fragment)":1
  * def __pyx_unpickle_BloomFilterAggregate(__pyx_type, long __pyx_checksum, __pyx_state):             # <<<<<<<<<<<<<<
- *     cdef object __pyx_PickleError
- *     cdef object __pyx_result
+ *     if __pyx_checksum != 0xc9f9d7d:
+ *         from pickle import PickleError as __pyx_PickleError
  */
   __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_9playhouse_11_sqlite_ext_33__pyx_unpickle_BloomFilterAggregate, NULL, __pyx_n_s_playhouse__sqlite_ext); if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_pyx_unpickle_BloomFilterAggreg, __pyx_t_2) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "playhouse/_sqlite_ext.pyx":1
@@ -22814,19 +23039,20 @@
 
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
   if (__pyx_m) {
     if (__pyx_d) {
-      __Pyx_AddTraceback("init playhouse._sqlite_ext", __pyx_clineno, __pyx_lineno, __pyx_filename);
+      __Pyx_AddTraceback("init playhouse._sqlite_ext", 0, __pyx_lineno, __pyx_filename);
     }
-    Py_CLEAR(__pyx_m);
+    Py_DECREF(__pyx_m); __pyx_m = 0;
   } else if (!PyErr_Occurred()) {
     PyErr_SetString(PyExc_ImportError, "init playhouse._sqlite_ext");
   }
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   return (__pyx_m != NULL) ? 0 : -1;
@@ -22839,56 +23065,66 @@
 
 /* --- Runtime support code --- */
 /* Refnanny */
 #if CYTHON_REFNANNY
 static __Pyx_RefNannyAPIStruct *__Pyx_RefNannyImportAPI(const char *modname) {
     PyObject *m = NULL, *p = NULL;
     void *r = NULL;
-    m = PyImport_ImportModule(modname);
+    m = PyImport_ImportModule((char *)modname);
     if (!m) goto end;
-    p = PyObject_GetAttrString(m, "RefNannyAPI");
+    p = PyObject_GetAttrString(m, (char *)"RefNannyAPI");
     if (!p) goto end;
     r = PyLong_AsVoidPtr(p);
 end:
     Py_XDECREF(p);
     Py_XDECREF(m);
     return (__Pyx_RefNannyAPIStruct *)r;
 }
 #endif
 
-/* PyObjectGetAttrStr */
-#if CYTHON_USE_TYPE_SLOTS
-static CYTHON_INLINE PyObject* __Pyx_PyObject_GetAttrStr(PyObject* obj, PyObject* attr_name) {
-    PyTypeObject* tp = Py_TYPE(obj);
-    if (likely(tp->tp_getattro))
-        return tp->tp_getattro(obj, attr_name);
-#if PY_MAJOR_VERSION < 3
-    if (likely(tp->tp_getattr))
-        return tp->tp_getattr(obj, PyString_AS_STRING(attr_name));
-#endif
-    return PyObject_GetAttr(obj, attr_name);
-}
-#endif
-
 /* GetBuiltinName */
 static PyObject *__Pyx_GetBuiltinName(PyObject *name) {
     PyObject* result = __Pyx_PyObject_GetAttrStr(__pyx_b, name);
     if (unlikely(!result)) {
         PyErr_Format(PyExc_NameError,
 #if PY_MAJOR_VERSION >= 3
             "name '%U' is not defined", name);
 #else
             "name '%.200s' is not defined", PyString_AS_STRING(name));
 #endif
     }
     return result;
 }
 
+/* PyCFunctionFastCall */
+#if CYTHON_FAST_PYCCALL
+static CYTHON_INLINE PyObject * __Pyx_PyCFunction_FastCall(PyObject *func_obj, PyObject **args, Py_ssize_t nargs) {
+    PyCFunctionObject *func = (PyCFunctionObject*)func_obj;
+    PyCFunction meth = PyCFunction_GET_FUNCTION(func);
+    PyObject *self = PyCFunction_GET_SELF(func);
+    int flags = PyCFunction_GET_FLAGS(func);
+    assert(PyCFunction_Check(func));
+    assert(METH_FASTCALL == (flags & ~(METH_CLASS | METH_STATIC | METH_COEXIST | METH_KEYWORDS)));
+    assert(nargs >= 0);
+    assert(nargs == 0 || args != NULL);
+    /* _PyCFunction_FastCallDict() must not be called with an exception set,
+       because it may clear it (directly or indirectly) and so the
+       caller loses its exception */
+    assert(!PyErr_Occurred());
+    if ((PY_VERSION_HEX < 0x030700A0) || unlikely(flags & METH_KEYWORDS)) {
+        return (*((__Pyx_PyCFunctionFastWithKeywords)meth)) (self, args, nargs, NULL);
+    } else {
+        return (*((__Pyx_PyCFunctionFast)meth)) (self, args, nargs);
+    }
+}
+#endif
+
 /* PyFunctionFastCall */
 #if CYTHON_FAST_PYCALL
+#include "frameobject.h"
 static PyObject* __Pyx_PyFunction_FastCallNoKw(PyCodeObject *co, PyObject **args, Py_ssize_t na,
                                                PyObject *globals) {
     PyFrameObject *f;
     PyThreadState *tstate = __Pyx_PyThreadState_Current;
     PyObject **fastlocals;
     Py_ssize_t i;
     PyObject *result;
@@ -22898,15 +23134,15 @@
        take builtins without sanity checking them.
        */
     assert(tstate != NULL);
     f = PyFrame_New(tstate, co, globals, NULL);
     if (f == NULL) {
         return NULL;
     }
-    fastlocals = __Pyx_PyFrame_GetLocalsplus(f);
+    fastlocals = f->f_localsplus;
     for (i = 0; i < na; i++) {
         Py_INCREF(*args);
         fastlocals[i] = *args++;
     }
     result = PyEval_EvalFrameEx(f,0);
     ++tstate->recursion_depth;
     Py_DECREF(f);
@@ -23038,59 +23274,14 @@
             PyExc_SystemError,
             "NULL result without error in PyObject_Call");
     }
     return result;
 }
 #endif
 
-/* PyObjectCallNoArg */
-#if CYTHON_COMPILING_IN_CPYTHON
-static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func) {
-#if CYTHON_FAST_PYCALL
-    if (PyFunction_Check(func)) {
-        return __Pyx_PyFunction_FastCall(func, NULL, 0);
-    }
-#endif
-#ifdef __Pyx_CyFunction_USED
-    if (likely(PyCFunction_Check(func) || __Pyx_CyFunction_Check(func)))
-#else
-    if (likely(PyCFunction_Check(func)))
-#endif
-    {
-        if (likely(PyCFunction_GET_FLAGS(func) & METH_NOARGS)) {
-            return __Pyx_PyObject_CallMethO(func, NULL);
-        }
-    }
-    return __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL);
-}
-#endif
-
-/* PyCFunctionFastCall */
-#if CYTHON_FAST_PYCCALL
-static CYTHON_INLINE PyObject * __Pyx_PyCFunction_FastCall(PyObject *func_obj, PyObject **args, Py_ssize_t nargs) {
-    PyCFunctionObject *func = (PyCFunctionObject*)func_obj;
-    PyCFunction meth = PyCFunction_GET_FUNCTION(func);
-    PyObject *self = PyCFunction_GET_SELF(func);
-    int flags = PyCFunction_GET_FLAGS(func);
-    assert(PyCFunction_Check(func));
-    assert(METH_FASTCALL == (flags & ~(METH_CLASS | METH_STATIC | METH_COEXIST | METH_KEYWORDS | METH_STACKLESS)));
-    assert(nargs >= 0);
-    assert(nargs == 0 || args != NULL);
-    /* _PyCFunction_FastCallDict() must not be called with an exception set,
-       because it may clear it (directly or indirectly) and so the
-       caller loses its exception */
-    assert(!PyErr_Occurred());
-    if ((PY_VERSION_HEX < 0x030700A0) || unlikely(flags & METH_KEYWORDS)) {
-        return (*((__Pyx_PyCFunctionFastWithKeywords)(void*)meth)) (self, args, nargs, NULL);
-    } else {
-        return (*((__Pyx_PyCFunctionFast)(void*)meth)) (self, args, nargs);
-    }
-}
-#endif
-
 /* PyObjectCallOneArg */
 #if CYTHON_COMPILING_IN_CPYTHON
 static PyObject* __Pyx__PyObject_CallOneArg(PyObject *func, PyObject *arg) {
     PyObject *result;
     PyObject *args = PyTuple_New(1);
     if (unlikely(!args)) return NULL;
     Py_INCREF(arg);
@@ -23123,16 +23314,37 @@
     if (unlikely(!args)) return NULL;
     result = __Pyx_PyObject_Call(func, args, NULL);
     Py_DECREF(args);
     return result;
 }
 #endif
 
+/* PyObjectCallNoArg */
+#if CYTHON_COMPILING_IN_CPYTHON
+static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func) {
+#if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(func)) {
+        return __Pyx_PyFunction_FastCall(func, NULL, 0);
+    }
+#endif
+#ifdef __Pyx_CyFunction_USED
+    if (likely(PyCFunction_Check(func) || __Pyx_TypeCheck(func, __pyx_CyFunctionType))) {
+#else
+    if (likely(PyCFunction_Check(func))) {
+#endif
+        if (likely(PyCFunction_GET_FLAGS(func) & METH_NOARGS)) {
+            return __Pyx_PyObject_CallMethO(func, NULL);
+        }
+    }
+    return __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL);
+}
+#endif
+
 /* PyErrFetchRestore */
-#if CYTHON_FAST_THREAD_STATE
+  #if CYTHON_FAST_THREAD_STATE
 static CYTHON_INLINE void __Pyx_ErrRestoreInState(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb) {
     PyObject *tmp_type, *tmp_value, *tmp_tb;
     tmp_type = tstate->curexc_type;
     tmp_value = tstate->curexc_value;
     tmp_tb = tstate->curexc_traceback;
     tstate->curexc_type = type;
     tstate->curexc_value = value;
@@ -23148,15 +23360,15 @@
     tstate->curexc_type = 0;
     tstate->curexc_value = 0;
     tstate->curexc_traceback = 0;
 }
 #endif
 
 /* WriteUnraisableException */
-static void __Pyx_WriteUnraisable(const char *name, CYTHON_UNUSED int clineno,
+  static void __Pyx_WriteUnraisable(const char *name, CYTHON_UNUSED int clineno,
                                   CYTHON_UNUSED int lineno, CYTHON_UNUSED const char *filename,
                                   int full_traceback, CYTHON_UNUSED int nogil) {
     PyObject *old_exc, *old_val, *old_tb;
     PyObject *ctx;
     __Pyx_PyThreadState_declare
 #ifdef WITH_THREAD
     PyGILState_STATE state;
@@ -23189,56 +23401,39 @@
     }
 #ifdef WITH_THREAD
     if (nogil)
         PyGILState_Release(state);
 #endif
 }
 
-/* GetTopmostException */
-#if CYTHON_USE_EXC_INFO_STACK
-static _PyErr_StackItem *
-__Pyx_PyErr_GetTopmostException(PyThreadState *tstate)
-{
-    _PyErr_StackItem *exc_info = tstate->exc_info;
-    while ((exc_info->exc_type == NULL || exc_info->exc_type == Py_None) &&
-           exc_info->previous_item != NULL)
-    {
-        exc_info = exc_info->previous_item;
-    }
-    return exc_info;
-}
-#endif
-
 /* SaveResetException */
-#if CYTHON_FAST_THREAD_STATE
+  #if CYTHON_FAST_THREAD_STATE
 static CYTHON_INLINE void __Pyx__ExceptionSave(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb) {
-    #if CYTHON_USE_EXC_INFO_STACK
-    _PyErr_StackItem *exc_info = __Pyx_PyErr_GetTopmostException(tstate);
-    *type = exc_info->exc_type;
-    *value = exc_info->exc_value;
-    *tb = exc_info->exc_traceback;
+    #if PY_VERSION_HEX >= 0x030700A2
+    *type = tstate->exc_state.exc_type;
+    *value = tstate->exc_state.exc_value;
+    *tb = tstate->exc_state.exc_traceback;
     #else
     *type = tstate->exc_type;
     *value = tstate->exc_value;
     *tb = tstate->exc_traceback;
     #endif
     Py_XINCREF(*type);
     Py_XINCREF(*value);
     Py_XINCREF(*tb);
 }
 static CYTHON_INLINE void __Pyx__ExceptionReset(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb) {
     PyObject *tmp_type, *tmp_value, *tmp_tb;
-    #if CYTHON_USE_EXC_INFO_STACK
-    _PyErr_StackItem *exc_info = tstate->exc_info;
-    tmp_type = exc_info->exc_type;
-    tmp_value = exc_info->exc_value;
-    tmp_tb = exc_info->exc_traceback;
-    exc_info->exc_type = type;
-    exc_info->exc_value = value;
-    exc_info->exc_traceback = tb;
+    #if PY_VERSION_HEX >= 0x030700A2
+    tmp_type = tstate->exc_state.exc_type;
+    tmp_value = tstate->exc_state.exc_value;
+    tmp_tb = tstate->exc_state.exc_traceback;
+    tstate->exc_state.exc_type = type;
+    tstate->exc_state.exc_value = value;
+    tstate->exc_state.exc_traceback = tb;
     #else
     tmp_type = tstate->exc_type;
     tmp_value = tstate->exc_value;
     tmp_tb = tstate->exc_traceback;
     tstate->exc_type = type;
     tstate->exc_value = value;
     tstate->exc_traceback = tb;
@@ -23246,20 +23441,19 @@
     Py_XDECREF(tmp_type);
     Py_XDECREF(tmp_value);
     Py_XDECREF(tmp_tb);
 }
 #endif
 
 /* GetException */
-#if CYTHON_FAST_THREAD_STATE
-static int __Pyx__GetException(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb)
+  #if CYTHON_FAST_THREAD_STATE
+static int __Pyx__GetException(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb) {
 #else
-static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb)
+static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb) {
 #endif
-{
     PyObject *local_type, *local_value, *local_tb;
 #if CYTHON_FAST_THREAD_STATE
     PyObject *tmp_type, *tmp_value, *tmp_tb;
     local_type = tstate->curexc_type;
     local_value = tstate->curexc_value;
     local_tb = tstate->curexc_traceback;
     tstate->curexc_type = 0;
@@ -23284,24 +23478,21 @@
     Py_XINCREF(local_tb);
     Py_XINCREF(local_type);
     Py_XINCREF(local_value);
     *type = local_type;
     *value = local_value;
     *tb = local_tb;
 #if CYTHON_FAST_THREAD_STATE
-    #if CYTHON_USE_EXC_INFO_STACK
-    {
-        _PyErr_StackItem *exc_info = tstate->exc_info;
-        tmp_type = exc_info->exc_type;
-        tmp_value = exc_info->exc_value;
-        tmp_tb = exc_info->exc_traceback;
-        exc_info->exc_type = local_type;
-        exc_info->exc_value = local_value;
-        exc_info->exc_traceback = local_tb;
-    }
+    #if PY_VERSION_HEX >= 0x030700A2
+    tmp_type = tstate->exc_state.exc_type;
+    tmp_value = tstate->exc_state.exc_value;
+    tmp_tb = tstate->exc_state.exc_traceback;
+    tstate->exc_state.exc_type = local_type;
+    tstate->exc_state.exc_value = local_value;
+    tstate->exc_state.exc_traceback = local_tb;
     #else
     tmp_type = tstate->exc_type;
     tmp_value = tstate->exc_value;
     tmp_tb = tstate->exc_traceback;
     tstate->exc_type = local_type;
     tstate->exc_value = local_value;
     tstate->exc_traceback = local_tb;
@@ -23319,106 +23510,34 @@
     *tb = 0;
     Py_XDECREF(local_type);
     Py_XDECREF(local_value);
     Py_XDECREF(local_tb);
     return -1;
 }
 
-/* PyDictVersioning */
-#if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_TYPE_SLOTS
-static CYTHON_INLINE PY_UINT64_T __Pyx_get_tp_dict_version(PyObject *obj) {
-    PyObject *dict = Py_TYPE(obj)->tp_dict;
-    return likely(dict) ? __PYX_GET_DICT_VERSION(dict) : 0;
-}
-static CYTHON_INLINE PY_UINT64_T __Pyx_get_object_dict_version(PyObject *obj) {
-    PyObject **dictptr = NULL;
-    Py_ssize_t offset = Py_TYPE(obj)->tp_dictoffset;
-    if (offset) {
-#if CYTHON_COMPILING_IN_CPYTHON
-        dictptr = (likely(offset > 0)) ? (PyObject **) ((char *)obj + offset) : _PyObject_GetDictPtr(obj);
-#else
-        dictptr = _PyObject_GetDictPtr(obj);
-#endif
-    }
-    return (dictptr && *dictptr) ? __PYX_GET_DICT_VERSION(*dictptr) : 0;
-}
-static CYTHON_INLINE int __Pyx_object_dict_version_matches(PyObject* obj, PY_UINT64_T tp_dict_version, PY_UINT64_T obj_dict_version) {
-    PyObject *dict = Py_TYPE(obj)->tp_dict;
-    if (unlikely(!dict) || unlikely(tp_dict_version != __PYX_GET_DICT_VERSION(dict)))
-        return 0;
-    return obj_dict_version == __Pyx_get_object_dict_version(obj);
-}
-#endif
-
 /* GetModuleGlobalName */
-#if CYTHON_USE_DICT_VERSIONS
-static PyObject *__Pyx__GetModuleGlobalName(PyObject *name, PY_UINT64_T *dict_version, PyObject **dict_cached_value)
-#else
-static CYTHON_INLINE PyObject *__Pyx__GetModuleGlobalName(PyObject *name)
-#endif
-{
+    static CYTHON_INLINE PyObject *__Pyx_GetModuleGlobalName(PyObject *name) {
     PyObject *result;
 #if !CYTHON_AVOID_BORROWED_REFS
-#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030500A1
-    result = _PyDict_GetItem_KnownHash(__pyx_d, name, ((PyASCIIObject *) name)->hash);
-    __PYX_UPDATE_DICT_CACHE(__pyx_d, result, *dict_cached_value, *dict_version)
-    if (likely(result)) {
-        return __Pyx_NewRef(result);
-    } else if (unlikely(PyErr_Occurred())) {
-        return NULL;
-    }
-#else
     result = PyDict_GetItem(__pyx_d, name);
-    __PYX_UPDATE_DICT_CACHE(__pyx_d, result, *dict_cached_value, *dict_version)
     if (likely(result)) {
-        return __Pyx_NewRef(result);
-    }
-#endif
+        Py_INCREF(result);
+    } else {
 #else
     result = PyObject_GetItem(__pyx_d, name);
-    __PYX_UPDATE_DICT_CACHE(__pyx_d, result, *dict_cached_value, *dict_version)
-    if (likely(result)) {
-        return __Pyx_NewRef(result);
-    }
-    PyErr_Clear();
+    if (!result) {
+        PyErr_Clear();
 #endif
-    return __Pyx_GetBuiltinName(name);
-}
-
-/* PyObjectCall2Args */
-static CYTHON_UNUSED PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2) {
-    PyObject *args, *result = NULL;
-    #if CYTHON_FAST_PYCALL
-    if (PyFunction_Check(function)) {
-        PyObject *args[2] = {arg1, arg2};
-        return __Pyx_PyFunction_FastCall(function, args, 2);
-    }
-    #endif
-    #if CYTHON_FAST_PYCCALL
-    if (__Pyx_PyFastCFunction_Check(function)) {
-        PyObject *args[2] = {arg1, arg2};
-        return __Pyx_PyCFunction_FastCall(function, args, 2);
+        result = __Pyx_GetBuiltinName(name);
     }
-    #endif
-    args = PyTuple_New(2);
-    if (unlikely(!args)) goto done;
-    Py_INCREF(arg1);
-    PyTuple_SET_ITEM(args, 0, arg1);
-    Py_INCREF(arg2);
-    PyTuple_SET_ITEM(args, 1, arg2);
-    Py_INCREF(function);
-    result = __Pyx_PyObject_Call(function, args, NULL);
-    Py_DECREF(args);
-    Py_DECREF(function);
-done:
     return result;
 }
 
 /* PyErrExceptionMatches */
-#if CYTHON_FAST_THREAD_STATE
+      #if CYTHON_FAST_THREAD_STATE
 static int __Pyx_PyErr_ExceptionMatchesTuple(PyObject *exc_type, PyObject *tuple) {
     Py_ssize_t i, n;
     n = PyTuple_GET_SIZE(tuple);
 #if PY_MAJOR_VERSION >= 3
     for (i=0; i<n; i++) {
         if (exc_type == PyTuple_GET_ITEM(tuple, i)) return 1;
     }
@@ -23435,30 +23554,30 @@
     if (unlikely(PyTuple_Check(err)))
         return __Pyx_PyErr_ExceptionMatchesTuple(exc_type, err);
     return __Pyx_PyErr_GivenExceptionMatches(exc_type, err);
 }
 #endif
 
 /* GetItemInt */
-static PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j) {
+      static PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j) {
     PyObject *r;
     if (!j) return NULL;
     r = PyObject_GetItem(o, j);
     Py_DECREF(j);
     return r;
 }
 static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
                                                               CYTHON_NCP_UNUSED int wraparound,
                                                               CYTHON_NCP_UNUSED int boundscheck) {
 #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
     Py_ssize_t wrapped_i = i;
     if (wraparound & unlikely(i < 0)) {
         wrapped_i += PyList_GET_SIZE(o);
     }
-    if ((!boundscheck) || likely(__Pyx_is_valid_index(wrapped_i, PyList_GET_SIZE(o)))) {
+    if ((!boundscheck) || likely((0 <= wrapped_i) & (wrapped_i < PyList_GET_SIZE(o)))) {
         PyObject *r = PyList_GET_ITEM(o, wrapped_i);
         Py_INCREF(r);
         return r;
     }
     return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
 #else
     return PySequence_GetItem(o, i);
@@ -23468,15 +23587,15 @@
                                                               CYTHON_NCP_UNUSED int wraparound,
                                                               CYTHON_NCP_UNUSED int boundscheck) {
 #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
     Py_ssize_t wrapped_i = i;
     if (wraparound & unlikely(i < 0)) {
         wrapped_i += PyTuple_GET_SIZE(o);
     }
-    if ((!boundscheck) || likely(__Pyx_is_valid_index(wrapped_i, PyTuple_GET_SIZE(o)))) {
+    if ((!boundscheck) || likely((0 <= wrapped_i) & (wrapped_i < PyTuple_GET_SIZE(o)))) {
         PyObject *r = PyTuple_GET_ITEM(o, wrapped_i);
         Py_INCREF(r);
         return r;
     }
     return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
 #else
     return PySequence_GetItem(o, i);
@@ -23484,23 +23603,23 @@
 }
 static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i, int is_list,
                                                      CYTHON_NCP_UNUSED int wraparound,
                                                      CYTHON_NCP_UNUSED int boundscheck) {
 #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS && CYTHON_USE_TYPE_SLOTS
     if (is_list || PyList_CheckExact(o)) {
         Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyList_GET_SIZE(o);
-        if ((!boundscheck) || (likely(__Pyx_is_valid_index(n, PyList_GET_SIZE(o))))) {
+        if ((!boundscheck) || (likely((n >= 0) & (n < PyList_GET_SIZE(o))))) {
             PyObject *r = PyList_GET_ITEM(o, n);
             Py_INCREF(r);
             return r;
         }
     }
     else if (PyTuple_CheckExact(o)) {
         Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyTuple_GET_SIZE(o);
-        if ((!boundscheck) || likely(__Pyx_is_valid_index(n, PyTuple_GET_SIZE(o)))) {
+        if ((!boundscheck) || likely((n >= 0) & (n < PyTuple_GET_SIZE(o)))) {
             PyObject *r = PyTuple_GET_ITEM(o, n);
             Py_INCREF(r);
             return r;
         }
     } else {
         PySequenceMethods *m = Py_TYPE(o)->tp_as_sequence;
         if (likely(m && m->sq_item)) {
@@ -23521,66 +23640,37 @@
     if (is_list || PySequence_Check(o)) {
         return PySequence_GetItem(o, i);
     }
 #endif
     return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
 }
 
-/* ObjectGetItem */
-#if CYTHON_USE_TYPE_SLOTS
-static PyObject *__Pyx_PyObject_GetIndex(PyObject *obj, PyObject* index) {
-    PyObject *runerr;
-    Py_ssize_t key_value;
-    PySequenceMethods *m = Py_TYPE(obj)->tp_as_sequence;
-    if (unlikely(!(m && m->sq_item))) {
-        PyErr_Format(PyExc_TypeError, "'%.200s' object is not subscriptable", Py_TYPE(obj)->tp_name);
-        return NULL;
-    }
-    key_value = __Pyx_PyIndex_AsSsize_t(index);
-    if (likely(key_value != -1 || !(runerr = PyErr_Occurred()))) {
-        return __Pyx_GetItemInt_Fast(obj, key_value, 0, 1, 1);
-    }
-    if (PyErr_GivenExceptionMatches(runerr, PyExc_OverflowError)) {
-        PyErr_Clear();
-        PyErr_Format(PyExc_IndexError, "cannot fit '%.200s' into an index-sized integer", Py_TYPE(index)->tp_name);
-    }
-    return NULL;
-}
-static PyObject *__Pyx_PyObject_GetItem(PyObject *obj, PyObject* key) {
-    PyMappingMethods *m = Py_TYPE(obj)->tp_as_mapping;
-    if (likely(m && m->mp_subscript)) {
-        return m->mp_subscript(obj, key);
-    }
-    return __Pyx_PyObject_GetIndex(obj, key);
-}
-#endif
-
 /* StringJoin */
-#if !CYTHON_COMPILING_IN_CPYTHON
+      #if !CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyBytes_Join(PyObject* sep, PyObject* values) {
     return PyObject_CallMethodObjArgs(sep, __pyx_n_s_join, values, NULL);
 }
 #endif
 
 /* RaiseDoubleKeywords */
-static void __Pyx_RaiseDoubleKeywordsError(
+      static void __Pyx_RaiseDoubleKeywordsError(
     const char* func_name,
     PyObject* kw_name)
 {
     PyErr_Format(PyExc_TypeError,
         #if PY_MAJOR_VERSION >= 3
         "%s() got multiple values for keyword argument '%U'", func_name, kw_name);
         #else
         "%s() got multiple values for keyword argument '%s'", func_name,
         PyString_AsString(kw_name));
         #endif
 }
 
 /* ParseKeywords */
-static int __Pyx_ParseOptionalKeywords(
+      static int __Pyx_ParseOptionalKeywords(
     PyObject *kwds,
     PyObject **argnames[],
     PyObject *kwds2,
     PyObject *values[],
     Py_ssize_t num_pos_args,
     const char* function_name)
 {
@@ -23674,15 +23764,15 @@
         function_name, key);
     #endif
 bad:
     return -1;
 }
 
 /* RaiseArgTupleInvalid */
-static void __Pyx_RaiseArgtupleInvalid(
+      static void __Pyx_RaiseArgtupleInvalid(
     const char* func_name,
     int exact,
     Py_ssize_t num_min,
     Py_ssize_t num_max,
     Py_ssize_t num_found)
 {
     Py_ssize_t num_expected;
@@ -23700,15 +23790,15 @@
     PyErr_Format(PyExc_TypeError,
                  "%.200s() takes %.8s %" CYTHON_FORMAT_SSIZE_T "d positional argument%.1s (%" CYTHON_FORMAT_SSIZE_T "d given)",
                  func_name, more_or_less, num_expected,
                  (num_expected == 1) ? "" : "s", num_found);
 }
 
 /* RaiseException */
-#if PY_MAJOR_VERSION < 3
+      #if PY_MAJOR_VERSION < 3
 static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb,
                         CYTHON_UNUSED PyObject *cause) {
     __Pyx_PyThreadState_declare
     Py_XINCREF(type);
     if (!value || value == Py_None)
         value = NULL;
     else
@@ -23858,43 +23948,29 @@
     }
 bad:
     Py_XDECREF(owned_instance);
     return;
 }
 #endif
 
-/* PyObjectSetAttrStr */
-#if CYTHON_USE_TYPE_SLOTS
-static CYTHON_INLINE int __Pyx_PyObject_SetAttrStr(PyObject* obj, PyObject* attr_name, PyObject* value) {
-    PyTypeObject* tp = Py_TYPE(obj);
-    if (likely(tp->tp_setattro))
-        return tp->tp_setattro(obj, attr_name, value);
-#if PY_MAJOR_VERSION < 3
-    if (likely(tp->tp_setattr))
-        return tp->tp_setattr(obj, PyString_AS_STRING(attr_name), value);
-#endif
-    return PyObject_SetAttr(obj, attr_name, value);
-}
-#endif
-
 /* ExtTypeTest */
-static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
+      static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
     if (unlikely(!type)) {
         PyErr_SetString(PyExc_SystemError, "Missing type object");
         return 0;
     }
     if (likely(__Pyx_TypeCheck(obj, type)))
         return 1;
     PyErr_Format(PyExc_TypeError, "Cannot convert %.200s to %.200s",
                  Py_TYPE(obj)->tp_name, type->tp_name);
     return 0;
 }
 
 /* KeywordStringCheck */
-static int __Pyx_CheckKeywordStrings(
+      static int __Pyx_CheckKeywordStrings(
     PyObject *kwdict,
     const char* function_name,
     int kw_allowed)
 {
     PyObject* key = 0;
     Py_ssize_t pos = 0;
 #if CYTHON_COMPILING_IN_PYPY
@@ -23926,20 +24002,20 @@
         "%s() got an unexpected keyword argument '%U'",
         function_name, key);
     #endif
     return 0;
 }
 
 /* None */
-static CYTHON_INLINE void __Pyx_RaiseClosureNameError(const char *varname) {
+      static CYTHON_INLINE void __Pyx_RaiseClosureNameError(const char *varname) {
     PyErr_Format(PyExc_NameError, "free variable '%s' referenced before assignment in enclosing scope", varname);
 }
 
 /* FetchCommonType */
-static PyTypeObject* __Pyx_FetchCommonType(PyTypeObject* type) {
+      static PyTypeObject* __Pyx_FetchCommonType(PyTypeObject* type) {
     PyObject* fake_module;
     PyTypeObject* cached_type = NULL;
     fake_module = PyImport_AddModule((char*) "_cython_" CYTHON_ABI);
     if (!fake_module) return NULL;
     Py_INCREF(fake_module);
     cached_type = (PyTypeObject*) PyObject_GetAttrString(fake_module, type->tp_name);
     if (cached_type) {
@@ -23970,16 +24046,15 @@
 bad:
     Py_XDECREF(cached_type);
     cached_type = NULL;
     goto done;
 }
 
 /* CythonFunction */
-#include <structmember.h>
-static PyObject *
+      static PyObject *
 __Pyx_CyFunction_get_doc(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *closure)
 {
     if (unlikely(op->func_doc == NULL)) {
         if (op->func.m_ml->ml_doc) {
 #if PY_MAJOR_VERSION >= 3
             op->func_doc = PyUnicode_FromString(op->func.m_ml->ml_doc);
 #else
@@ -23992,76 +24067,74 @@
             return Py_None;
         }
     }
     Py_INCREF(op->func_doc);
     return op->func_doc;
 }
 static int
-__Pyx_CyFunction_set_doc(__pyx_CyFunctionObject *op, PyObject *value, CYTHON_UNUSED void *context)
+__Pyx_CyFunction_set_doc(__pyx_CyFunctionObject *op, PyObject *value)
 {
     PyObject *tmp = op->func_doc;
     if (value == NULL) {
         value = Py_None;
     }
     Py_INCREF(value);
     op->func_doc = value;
     Py_XDECREF(tmp);
     return 0;
 }
 static PyObject *
-__Pyx_CyFunction_get_name(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
+__Pyx_CyFunction_get_name(__pyx_CyFunctionObject *op)
 {
     if (unlikely(op->func_name == NULL)) {
 #if PY_MAJOR_VERSION >= 3
         op->func_name = PyUnicode_InternFromString(op->func.m_ml->ml_name);
 #else
         op->func_name = PyString_InternFromString(op->func.m_ml->ml_name);
 #endif
         if (unlikely(op->func_name == NULL))
             return NULL;
     }
     Py_INCREF(op->func_name);
     return op->func_name;
 }
 static int
-__Pyx_CyFunction_set_name(__pyx_CyFunctionObject *op, PyObject *value, CYTHON_UNUSED void *context)
+__Pyx_CyFunction_set_name(__pyx_CyFunctionObject *op, PyObject *value)
 {
     PyObject *tmp;
 #if PY_MAJOR_VERSION >= 3
-    if (unlikely(value == NULL || !PyUnicode_Check(value)))
+    if (unlikely(value == NULL || !PyUnicode_Check(value))) {
 #else
-    if (unlikely(value == NULL || !PyString_Check(value)))
+    if (unlikely(value == NULL || !PyString_Check(value))) {
 #endif
-    {
         PyErr_SetString(PyExc_TypeError,
                         "__name__ must be set to a string object");
         return -1;
     }
     tmp = op->func_name;
     Py_INCREF(value);
     op->func_name = value;
     Py_XDECREF(tmp);
     return 0;
 }
 static PyObject *
-__Pyx_CyFunction_get_qualname(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
+__Pyx_CyFunction_get_qualname(__pyx_CyFunctionObject *op)
 {
     Py_INCREF(op->func_qualname);
     return op->func_qualname;
 }
 static int
-__Pyx_CyFunction_set_qualname(__pyx_CyFunctionObject *op, PyObject *value, CYTHON_UNUSED void *context)
+__Pyx_CyFunction_set_qualname(__pyx_CyFunctionObject *op, PyObject *value)
 {
     PyObject *tmp;
 #if PY_MAJOR_VERSION >= 3
-    if (unlikely(value == NULL || !PyUnicode_Check(value)))
+    if (unlikely(value == NULL || !PyUnicode_Check(value))) {
 #else
-    if (unlikely(value == NULL || !PyString_Check(value)))
+    if (unlikely(value == NULL || !PyString_Check(value))) {
 #endif
-    {
         PyErr_SetString(PyExc_TypeError,
                         "__qualname__ must be set to a string object");
         return -1;
     }
     tmp = op->func_qualname;
     Py_INCREF(value);
     op->func_qualname = value;
@@ -24075,26 +24148,26 @@
     self = m->func_closure;
     if (self == NULL)
         self = Py_None;
     Py_INCREF(self);
     return self;
 }
 static PyObject *
-__Pyx_CyFunction_get_dict(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
+__Pyx_CyFunction_get_dict(__pyx_CyFunctionObject *op)
 {
     if (unlikely(op->func_dict == NULL)) {
         op->func_dict = PyDict_New();
         if (unlikely(op->func_dict == NULL))
             return NULL;
     }
     Py_INCREF(op->func_dict);
     return op->func_dict;
 }
 static int
-__Pyx_CyFunction_set_dict(__pyx_CyFunctionObject *op, PyObject *value, CYTHON_UNUSED void *context)
+__Pyx_CyFunction_set_dict(__pyx_CyFunctionObject *op, PyObject *value)
 {
     PyObject *tmp;
     if (unlikely(value == NULL)) {
         PyErr_SetString(PyExc_TypeError,
                "function's dictionary may not be deleted");
         return -1;
     }
@@ -24106,27 +24179,27 @@
     tmp = op->func_dict;
     Py_INCREF(value);
     op->func_dict = value;
     Py_XDECREF(tmp);
     return 0;
 }
 static PyObject *
-__Pyx_CyFunction_get_globals(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
+__Pyx_CyFunction_get_globals(__pyx_CyFunctionObject *op)
 {
     Py_INCREF(op->func_globals);
     return op->func_globals;
 }
 static PyObject *
-__Pyx_CyFunction_get_closure(CYTHON_UNUSED __pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
+__Pyx_CyFunction_get_closure(CYTHON_UNUSED __pyx_CyFunctionObject *op)
 {
     Py_INCREF(Py_None);
     return Py_None;
 }
 static PyObject *
-__Pyx_CyFunction_get_code(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
+__Pyx_CyFunction_get_code(__pyx_CyFunctionObject *op)
 {
     PyObject* result = (op->func_code) ? op->func_code : Py_None;
     Py_INCREF(result);
     return result;
 }
 static int
 __Pyx_CyFunction_init_defaults(__pyx_CyFunctionObject *op) {
@@ -24147,15 +24220,15 @@
         if (unlikely(!op->defaults_kwdict)) result = -1;
     }
     #endif
     Py_DECREF(res);
     return result;
 }
 static int
-__Pyx_CyFunction_set_defaults(__pyx_CyFunctionObject *op, PyObject* value, CYTHON_UNUSED void *context) {
+__Pyx_CyFunction_set_defaults(__pyx_CyFunctionObject *op, PyObject* value) {
     PyObject* tmp;
     if (!value) {
         value = Py_None;
     } else if (value != Py_None && !PyTuple_Check(value)) {
         PyErr_SetString(PyExc_TypeError,
                         "__defaults__ must be set to a tuple object");
         return -1;
@@ -24163,29 +24236,29 @@
     Py_INCREF(value);
     tmp = op->defaults_tuple;
     op->defaults_tuple = value;
     Py_XDECREF(tmp);
     return 0;
 }
 static PyObject *
-__Pyx_CyFunction_get_defaults(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context) {
+__Pyx_CyFunction_get_defaults(__pyx_CyFunctionObject *op) {
     PyObject* result = op->defaults_tuple;
     if (unlikely(!result)) {
         if (op->defaults_getter) {
             if (__Pyx_CyFunction_init_defaults(op) < 0) return NULL;
             result = op->defaults_tuple;
         } else {
             result = Py_None;
         }
     }
     Py_INCREF(result);
     return result;
 }
 static int
-__Pyx_CyFunction_set_kwdefaults(__pyx_CyFunctionObject *op, PyObject* value, CYTHON_UNUSED void *context) {
+__Pyx_CyFunction_set_kwdefaults(__pyx_CyFunctionObject *op, PyObject* value) {
     PyObject* tmp;
     if (!value) {
         value = Py_None;
     } else if (value != Py_None && !PyDict_Check(value)) {
         PyErr_SetString(PyExc_TypeError,
                         "__kwdefaults__ must be set to a dict object");
         return -1;
@@ -24193,29 +24266,29 @@
     Py_INCREF(value);
     tmp = op->defaults_kwdict;
     op->defaults_kwdict = value;
     Py_XDECREF(tmp);
     return 0;
 }
 static PyObject *
-__Pyx_CyFunction_get_kwdefaults(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context) {
+__Pyx_CyFunction_get_kwdefaults(__pyx_CyFunctionObject *op) {
     PyObject* result = op->defaults_kwdict;
     if (unlikely(!result)) {
         if (op->defaults_getter) {
             if (__Pyx_CyFunction_init_defaults(op) < 0) return NULL;
             result = op->defaults_kwdict;
         } else {
             result = Py_None;
         }
     }
     Py_INCREF(result);
     return result;
 }
 static int
-__Pyx_CyFunction_set_annotations(__pyx_CyFunctionObject *op, PyObject* value, CYTHON_UNUSED void *context) {
+__Pyx_CyFunction_set_annotations(__pyx_CyFunctionObject *op, PyObject* value) {
     PyObject* tmp;
     if (!value || value == Py_None) {
         value = NULL;
     } else if (!PyDict_Check(value)) {
         PyErr_SetString(PyExc_TypeError,
                         "__annotations__ must be set to a dict object");
         return -1;
@@ -24223,15 +24296,15 @@
     Py_XINCREF(value);
     tmp = op->func_annotations;
     op->func_annotations = value;
     Py_XDECREF(tmp);
     return 0;
 }
 static PyObject *
-__Pyx_CyFunction_get_annotations(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context) {
+__Pyx_CyFunction_get_annotations(__pyx_CyFunctionObject *op) {
     PyObject* result = op->func_annotations;
     if (unlikely(!result)) {
         result = PyDict_New();
         if (unlikely(!result)) return NULL;
         op->func_annotations = result;
     }
     Py_INCREF(result);
@@ -24403,15 +24476,15 @@
     Py_ssize_t size;
     switch (f->m_ml->ml_flags & (METH_VARARGS | METH_KEYWORDS | METH_NOARGS | METH_O)) {
     case METH_VARARGS:
         if (likely(kw == NULL || PyDict_Size(kw) == 0))
             return (*meth)(self, arg);
         break;
     case METH_VARARGS | METH_KEYWORDS:
-        return (*(PyCFunctionWithKeywords)(void*)meth)(self, arg, kw);
+        return (*(PyCFunctionWithKeywords)meth)(self, arg, kw);
     case METH_NOARGS:
         if (likely(kw == NULL || PyDict_Size(kw) == 0)) {
             size = PyTuple_GET_SIZE(arg);
             if (likely(size == 0))
                 return (*meth)(self, NULL);
             PyErr_Format(PyExc_TypeError,
                 "%.200s() takes no arguments (%" CYTHON_FORMAT_SSIZE_T "d given)",
@@ -24566,28 +24639,28 @@
 static CYTHON_INLINE void __Pyx_CyFunction_SetAnnotationsDict(PyObject *func, PyObject *dict) {
     __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
     m->func_annotations = dict;
     Py_INCREF(dict);
 }
 
 /* RaiseTooManyValuesToUnpack */
-static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected) {
+          static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected) {
     PyErr_Format(PyExc_ValueError,
                  "too many values to unpack (expected %" CYTHON_FORMAT_SSIZE_T "d)", expected);
 }
 
 /* RaiseNeedMoreValuesToUnpack */
-static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index) {
+          static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index) {
     PyErr_Format(PyExc_ValueError,
                  "need more than %" CYTHON_FORMAT_SSIZE_T "d value%.1s to unpack",
                  index, (index == 1) ? "" : "s");
 }
 
 /* IterFinish */
-static CYTHON_INLINE int __Pyx_IterFinish(void) {
+          static CYTHON_INLINE int __Pyx_IterFinish(void) {
 #if CYTHON_FAST_THREAD_STATE
     PyThreadState *tstate = __Pyx_PyThreadState_Current;
     PyObject* exc_type = tstate->curexc_type;
     if (unlikely(exc_type)) {
         if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) {
             PyObject *exc_value, *exc_tb;
             exc_value = tstate->curexc_value;
@@ -24614,203 +24687,208 @@
         }
     }
     return 0;
 #endif
 }
 
 /* UnpackItemEndCheck */
-static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected) {
+          static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected) {
     if (unlikely(retval)) {
         Py_DECREF(retval);
         __Pyx_RaiseTooManyValuesError(expected);
         return -1;
     } else {
         return __Pyx_IterFinish();
     }
     return 0;
 }
 
 /* PyFloatBinop */
-#if !CYTHON_COMPILING_IN_PYPY
-#define __Pyx_PyFloat_DivideCObj_ZeroDivisionError(operand) if (unlikely(zerodivision_check && ((operand) == 0))) {\
-    PyErr_SetString(PyExc_ZeroDivisionError, "float division by zero");\
-    return NULL;\
-}
-static PyObject* __Pyx_PyFloat_DivideCObj(PyObject *op1, PyObject *op2, double floatval, int inplace, int zerodivision_check) {
+          #if !CYTHON_COMPILING_IN_PYPY
+static PyObject* __Pyx_PyFloat_DivideCObj(PyObject *op1, PyObject *op2, double floatval, CYTHON_UNUSED int inplace) {
     const double a = floatval;
     double b, result;
-    (void)inplace;
-    (void)zerodivision_check;
     if (likely(PyFloat_CheckExact(op2))) {
         b = PyFloat_AS_DOUBLE(op2);
-        __Pyx_PyFloat_DivideCObj_ZeroDivisionError(b)
     } else
     #if PY_MAJOR_VERSION < 3
     if (likely(PyInt_CheckExact(op2))) {
         b = (double) PyInt_AS_LONG(op2);
-        __Pyx_PyFloat_DivideCObj_ZeroDivisionError(b)
     } else
     #endif
     if (likely(PyLong_CheckExact(op2))) {
         #if CYTHON_USE_PYLONG_INTERNALS
         const digit* digits = ((PyLongObject*)op2)->ob_digit;
         const Py_ssize_t size = Py_SIZE(op2);
         switch (size) {
-            case  0: __Pyx_PyFloat_DivideCObj_ZeroDivisionError(0) break;
+            case  0: b = 0.0; break;
             case -1: b = -(double) digits[0]; break;
             case  1: b = (double) digits[0]; break;
             case -2:
             case 2:
                 if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT && ((8 * sizeof(unsigned long) < 53) || (1 * PyLong_SHIFT < 53))) {
                     b = (double) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                     if ((8 * sizeof(unsigned long) < 53) || (2 * PyLong_SHIFT < 53) || (b < (double) ((PY_LONG_LONG)1 << 53))) {
                         if (size == -2)
                             b = -b;
                         break;
                     }
                 }
-                CYTHON_FALLTHROUGH;
             case -3:
             case 3:
                 if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT && ((8 * sizeof(unsigned long) < 53) || (2 * PyLong_SHIFT < 53))) {
                     b = (double) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                     if ((8 * sizeof(unsigned long) < 53) || (3 * PyLong_SHIFT < 53) || (b < (double) ((PY_LONG_LONG)1 << 53))) {
                         if (size == -3)
                             b = -b;
                         break;
                     }
                 }
-                CYTHON_FALLTHROUGH;
             case -4:
             case 4:
                 if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT && ((8 * sizeof(unsigned long) < 53) || (3 * PyLong_SHIFT < 53))) {
                     b = (double) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                     if ((8 * sizeof(unsigned long) < 53) || (4 * PyLong_SHIFT < 53) || (b < (double) ((PY_LONG_LONG)1 << 53))) {
                         if (size == -4)
                             b = -b;
                         break;
                     }
                 }
-                CYTHON_FALLTHROUGH;
             default:
         #else
         {
         #endif
             b = PyLong_AsDouble(op2);
             if (unlikely(b == -1.0 && PyErr_Occurred())) return NULL;
-            __Pyx_PyFloat_DivideCObj_ZeroDivisionError(b)
         }
     } else {
         return (inplace ? __Pyx_PyNumber_InPlaceDivide(op1, op2) : __Pyx_PyNumber_Divide(op1, op2));
     }
-        __Pyx_PyFloat_DivideCObj_ZeroDivisionError(b)
         PyFPE_START_PROTECT("divide", return NULL)
         result = a / b;
         PyFPE_END_PROTECT(result)
         return PyFloat_FromDouble(result);
 }
 #endif
 
 /* GetAttr */
-  static CYTHON_INLINE PyObject *__Pyx_GetAttr(PyObject *o, PyObject *n) {
+            static CYTHON_INLINE PyObject *__Pyx_GetAttr(PyObject *o, PyObject *n) {
 #if CYTHON_USE_TYPE_SLOTS
 #if PY_MAJOR_VERSION >= 3
     if (likely(PyUnicode_Check(n)))
 #else
     if (likely(PyString_Check(n)))
 #endif
         return __Pyx_PyObject_GetAttrStr(o, n);
 #endif
     return PyObject_GetAttr(o, n);
 }
 
 /* GetAttr3 */
-  static PyObject *__Pyx_GetAttr3Default(PyObject *d) {
+            static PyObject *__Pyx_GetAttr3Default(PyObject *d) {
     __Pyx_PyThreadState_declare
     __Pyx_PyThreadState_assign
     if (unlikely(!__Pyx_PyErr_ExceptionMatches(PyExc_AttributeError)))
         return NULL;
     __Pyx_PyErr_Clear();
     Py_INCREF(d);
     return d;
 }
 static CYTHON_INLINE PyObject *__Pyx_GetAttr3(PyObject *o, PyObject *n, PyObject *d) {
     PyObject *r = __Pyx_GetAttr(o, n);
     return (likely(r)) ? r : __Pyx_GetAttr3Default(d);
 }
 
-/* PyIntCompare */
-  static CYTHON_INLINE PyObject* __Pyx_PyInt_EqObjC(PyObject *op1, PyObject *op2, CYTHON_UNUSED long intval, CYTHON_UNUSED long inplace) {
+/* PyIntBinop */
+            #if !CYTHON_COMPILING_IN_PYPY
+static PyObject* __Pyx_PyInt_EqObjC(PyObject *op1, PyObject *op2, CYTHON_UNUSED long intval, CYTHON_UNUSED int inplace) {
     if (op1 == op2) {
         Py_RETURN_TRUE;
     }
     #if PY_MAJOR_VERSION < 3
     if (likely(PyInt_CheckExact(op1))) {
         const long b = intval;
         long a = PyInt_AS_LONG(op1);
-        if (a == b) Py_RETURN_TRUE; else Py_RETURN_FALSE;
+        if (a == b) {
+            Py_RETURN_TRUE;
+        } else {
+            Py_RETURN_FALSE;
+        }
     }
     #endif
     #if CYTHON_USE_PYLONG_INTERNALS
     if (likely(PyLong_CheckExact(op1))) {
-        int unequal;
-        unsigned long uintval;
-        Py_ssize_t size = Py_SIZE(op1);
+        const long b = intval;
+        long a;
         const digit* digits = ((PyLongObject*)op1)->ob_digit;
-        if (intval == 0) {
-            if (size == 0) Py_RETURN_TRUE; else Py_RETURN_FALSE;
-        } else if (intval < 0) {
-            if (size >= 0)
-                Py_RETURN_FALSE;
-            intval = -intval;
-            size = -size;
+        const Py_ssize_t size = Py_SIZE(op1);
+        if (likely(__Pyx_sst_abs(size) <= 1)) {
+            a = likely(size) ? digits[0] : 0;
+            if (size == -1) a = -a;
         } else {
-            if (size <= 0)
-                Py_RETURN_FALSE;
+            switch (size) {
+                case -2:
+                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
+                        a = -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
+                        break;
+                    }
+                case 2:
+                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
+                        a = (long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
+                        break;
+                    }
+                case -3:
+                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
+                        a = -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
+                        break;
+                    }
+                case 3:
+                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
+                        a = (long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
+                        break;
+                    }
+                case -4:
+                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
+                        a = -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
+                        break;
+                    }
+                case 4:
+                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
+                        a = (long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
+                        break;
+                    }
+                #if PyLong_SHIFT < 30 && PyLong_SHIFT != 15
+                default: return PyLong_Type.tp_richcompare(op1, op2, Py_EQ);
+                #else
+                default: Py_RETURN_FALSE;
+                #endif
+            }
         }
-        uintval = (unsigned long) intval;
-#if PyLong_SHIFT * 4 < SIZEOF_LONG*8
-        if (uintval >> (PyLong_SHIFT * 4)) {
-            unequal = (size != 5) || (digits[0] != (uintval & (unsigned long) PyLong_MASK))
-                 | (digits[1] != ((uintval >> (1 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[2] != ((uintval >> (2 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[3] != ((uintval >> (3 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[4] != ((uintval >> (4 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK));
-        } else
-#endif
-#if PyLong_SHIFT * 3 < SIZEOF_LONG*8
-        if (uintval >> (PyLong_SHIFT * 3)) {
-            unequal = (size != 4) || (digits[0] != (uintval & (unsigned long) PyLong_MASK))
-                 | (digits[1] != ((uintval >> (1 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[2] != ((uintval >> (2 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[3] != ((uintval >> (3 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK));
-        } else
-#endif
-#if PyLong_SHIFT * 2 < SIZEOF_LONG*8
-        if (uintval >> (PyLong_SHIFT * 2)) {
-            unequal = (size != 3) || (digits[0] != (uintval & (unsigned long) PyLong_MASK))
-                 | (digits[1] != ((uintval >> (1 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[2] != ((uintval >> (2 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK));
-        } else
-#endif
-#if PyLong_SHIFT * 1 < SIZEOF_LONG*8
-        if (uintval >> (PyLong_SHIFT * 1)) {
-            unequal = (size != 2) || (digits[0] != (uintval & (unsigned long) PyLong_MASK))
-                 | (digits[1] != ((uintval >> (1 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK));
-        } else
-#endif
-            unequal = (size != 1) || (((unsigned long) digits[0]) != (uintval & (unsigned long) PyLong_MASK));
-        if (unequal == 0) Py_RETURN_TRUE; else Py_RETURN_FALSE;
+            if (a == b) {
+                Py_RETURN_TRUE;
+            } else {
+                Py_RETURN_FALSE;
+            }
     }
     #endif
     if (PyFloat_CheckExact(op1)) {
         const long b = intval;
         double a = PyFloat_AS_DOUBLE(op1);
-        if ((double)a == (double)b) Py_RETURN_TRUE; else Py_RETURN_FALSE;
+            if ((double)a == (double)b) {
+                Py_RETURN_TRUE;
+            } else {
+                Py_RETURN_FALSE;
+            }
     }
-    return (
-        PyObject_RichCompare(op1, op2, Py_EQ));
+    return PyObject_RichCompare(op1, op2, Py_EQ);
 }
+#endif
 
 /* ArgTypeTest */
-  static int __Pyx__ArgTypeTest(PyObject *obj, PyTypeObject *type, const char *name, int exact)
+            static int __Pyx__ArgTypeTest(PyObject *obj, PyTypeObject *type, const char *name, int exact)
 {
     if (unlikely(!type)) {
         PyErr_SetString(PyExc_SystemError, "Missing type object");
         return 0;
     }
     else if (exact) {
         #if PY_MAJOR_VERSION == 2
@@ -24823,22 +24901,22 @@
     PyErr_Format(PyExc_TypeError,
         "Argument '%.200s' has incorrect type (expected %.200s, got %.200s)",
         name, type->tp_name, Py_TYPE(obj)->tp_name);
     return 0;
 }
 
 /* None */
-  static CYTHON_INLINE long __Pyx_mod_long(long a, long b) {
+            static CYTHON_INLINE long __Pyx_mod_long(long a, long b) {
     long r = a % b;
     r += ((r != 0) & ((r ^ b) < 0)) * b;
     return r;
 }
 
 /* Import */
-  static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level) {
+            static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level) {
     PyObject *empty_list = 0;
     PyObject *module = 0;
     PyObject *global_dict = 0;
     PyObject *empty_dict = 0;
     PyObject *list;
     #if PY_MAJOR_VERSION < 3
     PyObject *py_import;
@@ -24877,15 +24955,15 @@
         #endif
         if (!module) {
             #if PY_MAJOR_VERSION < 3
             PyObject *py_level = PyInt_FromLong(level);
             if (!py_level)
                 goto bad;
             module = PyObject_CallFunctionObjArgs(py_import,
-                name, global_dict, empty_dict, list, py_level, (PyObject *)NULL);
+                name, global_dict, empty_dict, list, py_level, NULL);
             Py_DECREF(py_level);
             #else
             module = PyImport_ImportModuleLevelObject(
                 name, global_dict, empty_dict, list, level);
             #endif
         }
     }
@@ -24895,29 +24973,29 @@
     #endif
     Py_XDECREF(empty_list);
     Py_XDECREF(empty_dict);
     return module;
 }
 
 /* ImportFrom */
-  static PyObject* __Pyx_ImportFrom(PyObject* module, PyObject* name) {
+            static PyObject* __Pyx_ImportFrom(PyObject* module, PyObject* name) {
     PyObject* value = __Pyx_PyObject_GetAttrStr(module, name);
     if (unlikely(!value) && PyErr_ExceptionMatches(PyExc_AttributeError)) {
         PyErr_Format(PyExc_ImportError,
         #if PY_MAJOR_VERSION < 3
             "cannot import name %.230s", PyString_AS_STRING(name));
         #else
             "cannot import name %S", name);
         #endif
     }
     return value;
 }
 
 /* HasAttr */
-  static CYTHON_INLINE int __Pyx_HasAttr(PyObject *o, PyObject *n) {
+            static CYTHON_INLINE int __Pyx_HasAttr(PyObject *o, PyObject *n) {
     PyObject *r;
     if (unlikely(!__Pyx_PyBaseString_Check(n))) {
         PyErr_SetString(PyExc_TypeError,
                         "hasattr(): attribute name must be string");
         return -1;
     }
     r = __Pyx_GetAttr(o, n);
@@ -24926,66 +25004,16 @@
         return 0;
     } else {
         Py_DECREF(r);
         return 1;
     }
 }
 
-/* PyObject_GenericGetAttrNoDict */
-  #if CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP && PY_VERSION_HEX < 0x03070000
-static PyObject *__Pyx_RaiseGenericGetAttributeError(PyTypeObject *tp, PyObject *attr_name) {
-    PyErr_Format(PyExc_AttributeError,
-#if PY_MAJOR_VERSION >= 3
-                 "'%.50s' object has no attribute '%U'",
-                 tp->tp_name, attr_name);
-#else
-                 "'%.50s' object has no attribute '%.400s'",
-                 tp->tp_name, PyString_AS_STRING(attr_name));
-#endif
-    return NULL;
-}
-static CYTHON_INLINE PyObject* __Pyx_PyObject_GenericGetAttrNoDict(PyObject* obj, PyObject* attr_name) {
-    PyObject *descr;
-    PyTypeObject *tp = Py_TYPE(obj);
-    if (unlikely(!PyString_Check(attr_name))) {
-        return PyObject_GenericGetAttr(obj, attr_name);
-    }
-    assert(!tp->tp_dictoffset);
-    descr = _PyType_Lookup(tp, attr_name);
-    if (unlikely(!descr)) {
-        return __Pyx_RaiseGenericGetAttributeError(tp, attr_name);
-    }
-    Py_INCREF(descr);
-    #if PY_MAJOR_VERSION < 3
-    if (likely(PyType_HasFeature(Py_TYPE(descr), Py_TPFLAGS_HAVE_CLASS)))
-    #endif
-    {
-        descrgetfunc f = Py_TYPE(descr)->tp_descr_get;
-        if (unlikely(f)) {
-            PyObject *res = f(descr, obj, (PyObject *)tp);
-            Py_DECREF(descr);
-            return res;
-        }
-    }
-    return descr;
-}
-#endif
-
-/* PyObject_GenericGetAttr */
-  #if CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP && PY_VERSION_HEX < 0x03070000
-static PyObject* __Pyx_PyObject_GenericGetAttr(PyObject* obj, PyObject* attr_name) {
-    if (unlikely(Py_TYPE(obj)->tp_dictoffset)) {
-        return PyObject_GenericGetAttr(obj, attr_name);
-    }
-    return __Pyx_PyObject_GenericGetAttrNoDict(obj, attr_name);
-}
-#endif
-
 /* SetVTable */
-  static int __Pyx_SetVtable(PyObject *dict, void *vtable) {
+            static int __Pyx_SetVtable(PyObject *dict, void *vtable) {
 #if PY_VERSION_HEX >= 0x02070000
     PyObject *ob = PyCapsule_New(vtable, 0, 0);
 #else
     PyObject *ob = PyCObject_FromVoidPtr(vtable, 0);
 #endif
     if (!ob)
         goto bad;
@@ -24995,15 +25023,15 @@
     return 0;
 bad:
     Py_XDECREF(ob);
     return -1;
 }
 
 /* SetupReduce */
-  static int __Pyx_setup_reduce_is_named(PyObject* meth, PyObject* name) {
+            static int __Pyx_setup_reduce_is_named(PyObject* meth, PyObject* name) {
   int ret;
   PyObject *name_attr;
   name_attr = __Pyx_PyObject_GetAttrStr(meth, __pyx_n_s_name_2);
   if (likely(name_attr)) {
       ret = PyObject_RichCompareBool(name_attr, name, Py_EQ);
   } else {
       ret = -1;
@@ -25070,77 +25098,16 @@
     Py_XDECREF(reduce_ex);
     Py_XDECREF(reduce_cython);
     Py_XDECREF(setstate);
     Py_XDECREF(setstate_cython);
     return ret;
 }
 
-/* TypeImport */
-  #ifndef __PYX_HAVE_RT_ImportType
-#define __PYX_HAVE_RT_ImportType
-static PyTypeObject *__Pyx_ImportType(PyObject *module, const char *module_name, const char *class_name,
-    size_t size, enum __Pyx_ImportType_CheckSize check_size)
-{
-    PyObject *result = 0;
-    char warning[200];
-    Py_ssize_t basicsize;
-#ifdef Py_LIMITED_API
-    PyObject *py_basicsize;
-#endif
-    result = PyObject_GetAttrString(module, class_name);
-    if (!result)
-        goto bad;
-    if (!PyType_Check(result)) {
-        PyErr_Format(PyExc_TypeError,
-            "%.200s.%.200s is not a type object",
-            module_name, class_name);
-        goto bad;
-    }
-#ifndef Py_LIMITED_API
-    basicsize = ((PyTypeObject *)result)->tp_basicsize;
-#else
-    py_basicsize = PyObject_GetAttrString(result, "__basicsize__");
-    if (!py_basicsize)
-        goto bad;
-    basicsize = PyLong_AsSsize_t(py_basicsize);
-    Py_DECREF(py_basicsize);
-    py_basicsize = 0;
-    if (basicsize == (Py_ssize_t)-1 && PyErr_Occurred())
-        goto bad;
-#endif
-    if ((size_t)basicsize < size) {
-        PyErr_Format(PyExc_ValueError,
-            "%.200s.%.200s size changed, may indicate binary incompatibility. "
-            "Expected %zd from C header, got %zd from PyObject",
-            module_name, class_name, size, basicsize);
-        goto bad;
-    }
-    if (check_size == __Pyx_ImportType_CheckSize_Error && (size_t)basicsize != size) {
-        PyErr_Format(PyExc_ValueError,
-            "%.200s.%.200s size changed, may indicate binary incompatibility. "
-            "Expected %zd from C header, got %zd from PyObject",
-            module_name, class_name, size, basicsize);
-        goto bad;
-    }
-    else if (check_size == __Pyx_ImportType_CheckSize_Warn && (size_t)basicsize > size) {
-        PyOS_snprintf(warning, sizeof(warning),
-            "%s.%s size changed, may indicate binary incompatibility. "
-            "Expected %zd from C header, got %zd from PyObject",
-            module_name, class_name, size, basicsize);
-        if (PyErr_WarnEx(NULL, warning, 0) < 0) goto bad;
-    }
-    return (PyTypeObject *)result;
-bad:
-    Py_XDECREF(result);
-    return NULL;
-}
-#endif
-
 /* CalculateMetaclass */
-  static PyObject *__Pyx_CalculateMetaclass(PyTypeObject *metaclass, PyObject *bases) {
+            static PyObject *__Pyx_CalculateMetaclass(PyTypeObject *metaclass, PyObject *bases) {
     Py_ssize_t i, nbases = PyTuple_GET_SIZE(bases);
     for (i=0; i < nbases; i++) {
         PyTypeObject *tmptype;
         PyObject *tmp = PyTuple_GET_ITEM(bases, i);
         tmptype = Py_TYPE(tmp);
 #if PY_MAJOR_VERSION < 3
         if (tmptype == &PyClass_Type)
@@ -25171,33 +25138,32 @@
 #endif
     }
     Py_INCREF((PyObject*) metaclass);
     return (PyObject*) metaclass;
 }
 
 /* ClassMethod */
-  static PyObject* __Pyx_Method_ClassMethod(PyObject *method) {
+            static PyObject* __Pyx_Method_ClassMethod(PyObject *method) {
 #if CYTHON_COMPILING_IN_PYPY && PYPY_VERSION_NUM <= 0x05080000
     if (PyObject_TypeCheck(method, &PyWrapperDescr_Type)) {
         return PyClassMethod_New(method);
     }
 #else
 #if CYTHON_COMPILING_IN_PYSTON || CYTHON_COMPILING_IN_PYPY
-    if (PyMethodDescr_Check(method))
+    if (PyMethodDescr_Check(method)) {
 #else
     static PyTypeObject *methoddescr_type = NULL;
     if (methoddescr_type == NULL) {
        PyObject *meth = PyObject_GetAttrString((PyObject*)&PyList_Type, "append");
        if (!meth) return NULL;
        methoddescr_type = Py_TYPE(meth);
        Py_DECREF(meth);
     }
-    if (__Pyx_TypeCheck(method, methoddescr_type))
+    if (__Pyx_TypeCheck(method, methoddescr_type)) {
 #endif
-    {
         PyMethodDescrObject *descr = (PyMethodDescrObject *)method;
         #if PY_VERSION_HEX < 0x03020000
         PyTypeObject *d_type = descr->d_type;
         #else
         PyTypeObject *d_type = descr->d_common.d_type;
         #endif
         return PyDescr_NewClassMethod(d_type, descr->d_method);
@@ -25206,26 +25172,26 @@
     else if (PyMethod_Check(method)) {
         return PyClassMethod_New(PyMethod_GET_FUNCTION(method));
     }
     else if (PyCFunction_Check(method)) {
         return PyClassMethod_New(method);
     }
 #ifdef __Pyx_CyFunction_USED
-    else if (__Pyx_CyFunction_Check(method)) {
+    else if (__Pyx_TypeCheck(method, __pyx_CyFunctionType)) {
         return PyClassMethod_New(method);
     }
 #endif
     PyErr_SetString(PyExc_TypeError,
                    "Class-level classmethod() can only be called on "
                    "a method_descriptor or instance method.");
     return NULL;
 }
 
 /* Py3ClassCreate */
-  static PyObject *__Pyx_Py3MetaclassPrepare(PyObject *metaclass, PyObject *bases, PyObject *name,
+              static PyObject *__Pyx_Py3MetaclassPrepare(PyObject *metaclass, PyObject *bases, PyObject *name,
                                            PyObject *qualname, PyObject *mkw, PyObject *modname, PyObject *doc) {
     PyObject *ns;
     if (metaclass) {
         PyObject *prep = __Pyx_PyObject_GetAttrStr(metaclass, __pyx_n_s_prepare);
         if (prep) {
             PyObject *pargs = PyTuple_Pack(2, name, bases);
             if (unlikely(!pargs)) {
@@ -25284,51 +25250,44 @@
         Py_DECREF(margs);
     }
     Py_XDECREF(owned_metaclass);
     return result;
 }
 
 /* GetNameInClass */
-  static PyObject *__Pyx_GetGlobalNameAfterAttributeLookup(PyObject *name) {
-    PyObject *result;
+              static PyObject *__Pyx_GetGlobalNameAfterAttributeLookup(PyObject *name) {
     __Pyx_PyThreadState_declare
     __Pyx_PyThreadState_assign
     if (unlikely(!__Pyx_PyErr_ExceptionMatches(PyExc_AttributeError)))
         return NULL;
     __Pyx_PyErr_Clear();
-    __Pyx_GetModuleGlobalNameUncached(result, name);
-    return result;
+    return __Pyx_GetModuleGlobalName(name);
 }
-static PyObject *__Pyx__GetNameInClass(PyObject *nmspace, PyObject *name) {
+static PyObject *__Pyx_GetNameInClass(PyObject *nmspace, PyObject *name) {
     PyObject *result;
     result = __Pyx_PyObject_GetAttrStr(nmspace, name);
     if (!result) {
         result = __Pyx_GetGlobalNameAfterAttributeLookup(name);
     }
     return result;
 }
 
 /* CLineInTraceback */
-  #ifndef CYTHON_CLINE_IN_TRACEBACK
-static int __Pyx_CLineForTraceback(PyThreadState *tstate, int c_line) {
+              #ifndef CYTHON_CLINE_IN_TRACEBACK
+static int __Pyx_CLineForTraceback(CYTHON_UNUSED PyThreadState *tstate, int c_line) {
     PyObject *use_cline;
     PyObject *ptype, *pvalue, *ptraceback;
 #if CYTHON_COMPILING_IN_CPYTHON
     PyObject **cython_runtime_dict;
 #endif
-    if (unlikely(!__pyx_cython_runtime)) {
-        return c_line;
-    }
     __Pyx_ErrFetchInState(tstate, &ptype, &pvalue, &ptraceback);
 #if CYTHON_COMPILING_IN_CPYTHON
     cython_runtime_dict = _PyObject_GetDictPtr(__pyx_cython_runtime);
     if (likely(cython_runtime_dict)) {
-        __PYX_PY_DICT_LOOKUP_IF_MODIFIED(
-            use_cline, *cython_runtime_dict,
-            __Pyx_PyDict_GetItemStr(*cython_runtime_dict, __pyx_n_s_cline_in_traceback))
+      use_cline = PyDict_GetItem(*cython_runtime_dict, __pyx_n_s_cline_in_traceback);
     } else
 #endif
     {
       PyObject *use_cline_obj = __Pyx_PyObject_GetAttrStr(__pyx_cython_runtime, __pyx_n_s_cline_in_traceback);
       if (use_cline_obj) {
         use_cline = PyObject_Not(use_cline_obj) ? Py_False : Py_True;
         Py_DECREF(use_cline_obj);
@@ -25337,24 +25296,24 @@
         use_cline = NULL;
       }
     }
     if (!use_cline) {
         c_line = 0;
         PyObject_SetAttr(__pyx_cython_runtime, __pyx_n_s_cline_in_traceback, Py_False);
     }
-    else if (use_cline == Py_False || (use_cline != Py_True && PyObject_Not(use_cline) != 0)) {
+    else if (PyObject_Not(use_cline) != 0) {
         c_line = 0;
     }
     __Pyx_ErrRestoreInState(tstate, ptype, pvalue, ptraceback);
     return c_line;
 }
 #endif
 
 /* CodeObjectCache */
-  static int __pyx_bisect_code_objects(__Pyx_CodeObjectCacheEntry* entries, int count, int code_line) {
+              static int __pyx_bisect_code_objects(__Pyx_CodeObjectCacheEntry* entries, int count, int code_line) {
     int start = 0, mid = 0, end = count - 1;
     if (end >= 0 && code_line > entries[end].code_line) {
         return count;
     }
     while (start < end) {
         mid = start + (end - start) / 2;
         if (code_line < entries[mid].code_line) {
@@ -25426,15 +25385,15 @@
     entries[pos].code_line = code_line;
     entries[pos].code_object = code_object;
     __pyx_code_cache.count++;
     Py_INCREF(code_object);
 }
 
 /* AddTraceback */
-  #include "compile.h"
+              #include "compile.h"
 #include "frameobject.h"
 #include "traceback.h"
 static PyCodeObject* __Pyx_CreateCodeObjectForTraceback(
             const char *funcname, int c_line,
             int py_line, const char *filename) {
     PyCodeObject *py_code = 0;
     PyObject *py_srcfile = 0;
@@ -25511,15 +25470,15 @@
     PyTraceBack_Here(py_frame);
 bad:
     Py_XDECREF(py_code);
     Py_XDECREF(py_frame);
 }
 
 /* CIntFromPyVerify */
-  #define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)\
+              #define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)\
     __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 0)
 #define __PYX_VERIFY_RETURN_INT_EXC(target_type, func_type, func_value)\
     __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 1)
 #define __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, exc)\
     {\
         func_type value = func_value;\
         if (sizeof(target_type) < sizeof(func_type)) {\
@@ -25533,16 +25492,16 @@
                     goto raise_overflow;\
             }\
         }\
         return (target_type) value;\
     }
 
 /* CIntToPy */
-  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
-    const int neg_one = (int) ((int) 0 - (int) 1), const_zero = (int) 0;
+              static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
+    const int neg_one = (int) -1, const_zero = (int) 0;
     const int is_unsigned = neg_one > const_zero;
     if (is_unsigned) {
         if (sizeof(int) < sizeof(long)) {
             return PyInt_FromLong((long) value);
         } else if (sizeof(int) <= sizeof(unsigned long)) {
             return PyLong_FromUnsignedLong((unsigned long) value);
 #ifdef HAVE_LONG_LONG
@@ -25564,16 +25523,16 @@
         unsigned char *bytes = (unsigned char *)&value;
         return _PyLong_FromByteArray(bytes, sizeof(int),
                                      little, !is_unsigned);
     }
 }
 
 /* CIntToPy */
-  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_PY_LONG_LONG(PY_LONG_LONG value) {
-    const PY_LONG_LONG neg_one = (PY_LONG_LONG) ((PY_LONG_LONG) 0 - (PY_LONG_LONG) 1), const_zero = (PY_LONG_LONG) 0;
+              static CYTHON_INLINE PyObject* __Pyx_PyInt_From_PY_LONG_LONG(PY_LONG_LONG value) {
+    const PY_LONG_LONG neg_one = (PY_LONG_LONG) -1, const_zero = (PY_LONG_LONG) 0;
     const int is_unsigned = neg_one > const_zero;
     if (is_unsigned) {
         if (sizeof(PY_LONG_LONG) < sizeof(long)) {
             return PyInt_FromLong((long) value);
         } else if (sizeof(PY_LONG_LONG) <= sizeof(unsigned long)) {
             return PyLong_FromUnsignedLong((unsigned long) value);
 #ifdef HAVE_LONG_LONG
@@ -25595,15 +25554,15 @@
         unsigned char *bytes = (unsigned char *)&value;
         return _PyLong_FromByteArray(bytes, sizeof(PY_LONG_LONG),
                                      little, !is_unsigned);
     }
 }
 
 /* None */
-  static CYTHON_INLINE long __Pyx_pow_long(long b, long e) {
+              static CYTHON_INLINE long __Pyx_pow_long(long b, long e) {
     long t = b;
     switch (e) {
         case 3:
             t *= b;
         CYTHON_FALLTHROUGH;
         case 2:
             t *= b;
@@ -25622,16 +25581,16 @@
         b *= b;
         e >>= 1;
     }
     return t;
 }
 
 /* CIntToPy */
-  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value) {
-    const long neg_one = (long) ((long) 0 - (long) 1), const_zero = (long) 0;
+              static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value) {
+    const long neg_one = (long) -1, const_zero = (long) 0;
     const int is_unsigned = neg_one > const_zero;
     if (is_unsigned) {
         if (sizeof(long) < sizeof(long)) {
             return PyInt_FromLong((long) value);
         } else if (sizeof(long) <= sizeof(unsigned long)) {
             return PyLong_FromUnsignedLong((unsigned long) value);
 #ifdef HAVE_LONG_LONG
@@ -25653,16 +25612,16 @@
         unsigned char *bytes = (unsigned char *)&value;
         return _PyLong_FromByteArray(bytes, sizeof(long),
                                      little, !is_unsigned);
     }
 }
 
 /* CIntToPy */
-  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_uint32_t(uint32_t value) {
-    const uint32_t neg_one = (uint32_t) ((uint32_t) 0 - (uint32_t) 1), const_zero = (uint32_t) 0;
+              static CYTHON_INLINE PyObject* __Pyx_PyInt_From_uint32_t(uint32_t value) {
+    const uint32_t neg_one = (uint32_t) -1, const_zero = (uint32_t) 0;
     const int is_unsigned = neg_one > const_zero;
     if (is_unsigned) {
         if (sizeof(uint32_t) < sizeof(long)) {
             return PyInt_FromLong((long) value);
         } else if (sizeof(uint32_t) <= sizeof(unsigned long)) {
             return PyLong_FromUnsignedLong((unsigned long) value);
 #ifdef HAVE_LONG_LONG
@@ -25684,16 +25643,16 @@
         unsigned char *bytes = (unsigned char *)&value;
         return _PyLong_FromByteArray(bytes, sizeof(uint32_t),
                                      little, !is_unsigned);
     }
 }
 
 /* CIntFromPy */
-  static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *x) {
-    const long neg_one = (long) ((long) 0 - (long) 1), const_zero = (long) 0;
+              static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *x) {
+    const long neg_one = (long) -1, const_zero = (long) 0;
     const int is_unsigned = neg_one > const_zero;
 #if PY_MAJOR_VERSION < 3
     if (likely(PyInt_Check(x))) {
         if (sizeof(long) < sizeof(long)) {
             __PYX_VERIFY_RETURN_INT(long, long, PyInt_AS_LONG(x))
         } else {
             long val = PyInt_AS_LONG(x);
@@ -25873,16 +25832,16 @@
 raise_neg_overflow:
     PyErr_SetString(PyExc_OverflowError,
         "can't convert negative value to long");
     return (long) -1;
 }
 
 /* CIntFromPy */
-  static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *x) {
-    const int neg_one = (int) ((int) 0 - (int) 1), const_zero = (int) 0;
+              static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *x) {
+    const int neg_one = (int) -1, const_zero = (int) 0;
     const int is_unsigned = neg_one > const_zero;
 #if PY_MAJOR_VERSION < 3
     if (likely(PyInt_Check(x))) {
         if (sizeof(int) < sizeof(long)) {
             __PYX_VERIFY_RETURN_INT(int, long, PyInt_AS_LONG(x))
         } else {
             long val = PyInt_AS_LONG(x);
@@ -26062,16 +26021,16 @@
 raise_neg_overflow:
     PyErr_SetString(PyExc_OverflowError,
         "can't convert negative value to int");
     return (int) -1;
 }
 
 /* CIntFromPy */
-  static CYTHON_INLINE sqlite3_int64 __Pyx_PyInt_As_sqlite3_int64(PyObject *x) {
-    const sqlite3_int64 neg_one = (sqlite3_int64) ((sqlite3_int64) 0 - (sqlite3_int64) 1), const_zero = (sqlite3_int64) 0;
+              static CYTHON_INLINE sqlite3_int64 __Pyx_PyInt_As_sqlite3_int64(PyObject *x) {
+    const sqlite3_int64 neg_one = (sqlite3_int64) -1, const_zero = (sqlite3_int64) 0;
     const int is_unsigned = neg_one > const_zero;
 #if PY_MAJOR_VERSION < 3
     if (likely(PyInt_Check(x))) {
         if (sizeof(sqlite3_int64) < sizeof(long)) {
             __PYX_VERIFY_RETURN_INT(sqlite3_int64, long, PyInt_AS_LONG(x))
         } else {
             long val = PyInt_AS_LONG(x);
@@ -26251,16 +26210,16 @@
 raise_neg_overflow:
     PyErr_SetString(PyExc_OverflowError,
         "can't convert negative value to sqlite3_int64");
     return (sqlite3_int64) -1;
 }
 
 /* CIntFromPy */
-  static CYTHON_INLINE size_t __Pyx_PyInt_As_size_t(PyObject *x) {
-    const size_t neg_one = (size_t) ((size_t) 0 - (size_t) 1), const_zero = (size_t) 0;
+              static CYTHON_INLINE size_t __Pyx_PyInt_As_size_t(PyObject *x) {
+    const size_t neg_one = (size_t) -1, const_zero = (size_t) 0;
     const int is_unsigned = neg_one > const_zero;
 #if PY_MAJOR_VERSION < 3
     if (likely(PyInt_Check(x))) {
         if (sizeof(size_t) < sizeof(long)) {
             __PYX_VERIFY_RETURN_INT(size_t, long, PyInt_AS_LONG(x))
         } else {
             long val = PyInt_AS_LONG(x);
@@ -26440,16 +26399,16 @@
 raise_neg_overflow:
     PyErr_SetString(PyExc_OverflowError,
         "can't convert negative value to size_t");
     return (size_t) -1;
 }
 
 /* CIntFromPy */
-  static CYTHON_INLINE PY_LONG_LONG __Pyx_PyInt_As_PY_LONG_LONG(PyObject *x) {
-    const PY_LONG_LONG neg_one = (PY_LONG_LONG) ((PY_LONG_LONG) 0 - (PY_LONG_LONG) 1), const_zero = (PY_LONG_LONG) 0;
+              static CYTHON_INLINE PY_LONG_LONG __Pyx_PyInt_As_PY_LONG_LONG(PyObject *x) {
+    const PY_LONG_LONG neg_one = (PY_LONG_LONG) -1, const_zero = (PY_LONG_LONG) 0;
     const int is_unsigned = neg_one > const_zero;
 #if PY_MAJOR_VERSION < 3
     if (likely(PyInt_Check(x))) {
         if (sizeof(PY_LONG_LONG) < sizeof(long)) {
             __PYX_VERIFY_RETURN_INT(PY_LONG_LONG, long, PyInt_AS_LONG(x))
         } else {
             long val = PyInt_AS_LONG(x);
@@ -26629,15 +26588,15 @@
 raise_neg_overflow:
     PyErr_SetString(PyExc_OverflowError,
         "can't convert negative value to PY_LONG_LONG");
     return (PY_LONG_LONG) -1;
 }
 
 /* FastTypeChecks */
-  #if CYTHON_COMPILING_IN_CPYTHON
+              #if CYTHON_COMPILING_IN_CPYTHON
 static int __Pyx_InBases(PyTypeObject *a, PyTypeObject *b) {
     while (a) {
         a = a->tp_base;
         if (a == b)
             return 1;
     }
     return b == &PyBaseObject_Type;
@@ -26684,76 +26643,131 @@
     int res = exc_type1 ? __Pyx_IsSubtype((PyTypeObject*)err, (PyTypeObject*)exc_type1) : 0;
     if (!res) {
         res = __Pyx_IsSubtype((PyTypeObject*)err, (PyTypeObject*)exc_type2);
     }
     return res;
 }
 #endif
-static int __Pyx_PyErr_GivenExceptionMatchesTuple(PyObject *exc_type, PyObject *tuple) {
-    Py_ssize_t i, n;
-    assert(PyExceptionClass_Check(exc_type));
-    n = PyTuple_GET_SIZE(tuple);
-#if PY_MAJOR_VERSION >= 3
-    for (i=0; i<n; i++) {
-        if (exc_type == PyTuple_GET_ITEM(tuple, i)) return 1;
-    }
-#endif
-    for (i=0; i<n; i++) {
-        PyObject *t = PyTuple_GET_ITEM(tuple, i);
-        #if PY_MAJOR_VERSION < 3
-        if (likely(exc_type == t)) return 1;
-        #endif
-        if (likely(PyExceptionClass_Check(t))) {
-            if (__Pyx_inner_PyErr_GivenExceptionMatches2(exc_type, NULL, t)) return 1;
-        } else {
-        }
-    }
-    return 0;
-}
 static CYTHON_INLINE int __Pyx_PyErr_GivenExceptionMatches(PyObject *err, PyObject* exc_type) {
     if (likely(err == exc_type)) return 1;
     if (likely(PyExceptionClass_Check(err))) {
-        if (likely(PyExceptionClass_Check(exc_type))) {
-            return __Pyx_inner_PyErr_GivenExceptionMatches2(err, NULL, exc_type);
-        } else if (likely(PyTuple_Check(exc_type))) {
-            return __Pyx_PyErr_GivenExceptionMatchesTuple(err, exc_type);
-        } else {
-        }
+        return __Pyx_inner_PyErr_GivenExceptionMatches2(err, NULL, exc_type);
     }
     return PyErr_GivenExceptionMatches(err, exc_type);
 }
 static CYTHON_INLINE int __Pyx_PyErr_GivenExceptionMatches2(PyObject *err, PyObject *exc_type1, PyObject *exc_type2) {
-    assert(PyExceptionClass_Check(exc_type1));
-    assert(PyExceptionClass_Check(exc_type2));
     if (likely(err == exc_type1 || err == exc_type2)) return 1;
     if (likely(PyExceptionClass_Check(err))) {
         return __Pyx_inner_PyErr_GivenExceptionMatches2(err, exc_type1, exc_type2);
     }
     return (PyErr_GivenExceptionMatches(err, exc_type1) || PyErr_GivenExceptionMatches(err, exc_type2));
 }
 #endif
 
 /* CheckBinaryVersion */
-  static int __Pyx_check_binary_version(void) {
+              static int __Pyx_check_binary_version(void) {
     char ctversion[4], rtversion[4];
     PyOS_snprintf(ctversion, 4, "%d.%d", PY_MAJOR_VERSION, PY_MINOR_VERSION);
     PyOS_snprintf(rtversion, 4, "%s", Py_GetVersion());
     if (ctversion[0] != rtversion[0] || ctversion[2] != rtversion[2]) {
         char message[200];
         PyOS_snprintf(message, sizeof(message),
                       "compiletime version %s of module '%.100s' "
                       "does not match runtime version %s",
                       ctversion, __Pyx_MODULE_NAME, rtversion);
         return PyErr_WarnEx(NULL, message, 1);
     }
     return 0;
 }
 
+/* ModuleImport */
+              #ifndef __PYX_HAVE_RT_ImportModule
+#define __PYX_HAVE_RT_ImportModule
+static PyObject *__Pyx_ImportModule(const char *name) {
+    PyObject *py_name = 0;
+    PyObject *py_module = 0;
+    py_name = __Pyx_PyIdentifier_FromString(name);
+    if (!py_name)
+        goto bad;
+    py_module = PyImport_Import(py_name);
+    Py_DECREF(py_name);
+    return py_module;
+bad:
+    Py_XDECREF(py_name);
+    return 0;
+}
+#endif
+
+/* TypeImport */
+              #ifndef __PYX_HAVE_RT_ImportType
+#define __PYX_HAVE_RT_ImportType
+static PyTypeObject *__Pyx_ImportType(const char *module_name, const char *class_name,
+    size_t size, int strict)
+{
+    PyObject *py_module = 0;
+    PyObject *result = 0;
+    PyObject *py_name = 0;
+    char warning[200];
+    Py_ssize_t basicsize;
+#ifdef Py_LIMITED_API
+    PyObject *py_basicsize;
+#endif
+    py_module = __Pyx_ImportModule(module_name);
+    if (!py_module)
+        goto bad;
+    py_name = __Pyx_PyIdentifier_FromString(class_name);
+    if (!py_name)
+        goto bad;
+    result = PyObject_GetAttr(py_module, py_name);
+    Py_DECREF(py_name);
+    py_name = 0;
+    Py_DECREF(py_module);
+    py_module = 0;
+    if (!result)
+        goto bad;
+    if (!PyType_Check(result)) {
+        PyErr_Format(PyExc_TypeError,
+            "%.200s.%.200s is not a type object",
+            module_name, class_name);
+        goto bad;
+    }
+#ifndef Py_LIMITED_API
+    basicsize = ((PyTypeObject *)result)->tp_basicsize;
+#else
+    py_basicsize = PyObject_GetAttrString(result, "__basicsize__");
+    if (!py_basicsize)
+        goto bad;
+    basicsize = PyLong_AsSsize_t(py_basicsize);
+    Py_DECREF(py_basicsize);
+    py_basicsize = 0;
+    if (basicsize == (Py_ssize_t)-1 && PyErr_Occurred())
+        goto bad;
+#endif
+    if (!strict && (size_t)basicsize > size) {
+        PyOS_snprintf(warning, sizeof(warning),
+            "%s.%s size changed, may indicate binary incompatibility. Expected %zd, got %zd",
+            module_name, class_name, basicsize, size);
+        if (PyErr_WarnEx(NULL, warning, 0) < 0) goto bad;
+    }
+    else if ((size_t)basicsize != size) {
+        PyErr_Format(PyExc_ValueError,
+            "%.200s.%.200s has the wrong size, try recompiling. Expected %zd, got %zd",
+            module_name, class_name, basicsize, size);
+        goto bad;
+    }
+    return (PyTypeObject *)result;
+bad:
+    Py_XDECREF(py_module);
+    Py_XDECREF(result);
+    return NULL;
+}
+#endif
+
 /* InitStrings */
-  static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
+              static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
     while (t->p) {
         #if PY_MAJOR_VERSION < 3
         if (t->is_unicode) {
             *t->p = PyUnicode_DecodeUTF8(t->s, t->n - 1, NULL);
         } else if (t->intern) {
             *t->p = PyString_InternFromString(t->s);
         } else {
@@ -26771,15 +26785,15 @@
         } else {
             *t->p = PyBytes_FromStringAndSize(t->s, t->n - 1);
         }
         #endif
         if (!*t->p)
             return -1;
         if (PyObject_Hash(*t->p) == -1)
-            return -1;
+            PyErr_Clear();
         ++t;
     }
     return 0;
 }
 
 static CYTHON_INLINE PyObject* __Pyx_PyUnicode_FromString(const char* c_str) {
     return __Pyx_PyUnicode_FromStringAndSize(c_str, (Py_ssize_t)strlen(c_str));
@@ -26854,21 +26868,14 @@
     }
 }
 static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject* x) {
    int is_true = x == Py_True;
    if (is_true | (x == Py_False) | (x == Py_None)) return is_true;
    else return PyObject_IsTrue(x);
 }
-static CYTHON_INLINE int __Pyx_PyObject_IsTrueAndDecref(PyObject* x) {
-    int retval;
-    if (unlikely(!x)) return -1;
-    retval = __Pyx_PyObject_IsTrue(x);
-    Py_DECREF(x);
-    return retval;
-}
 static PyObject* __Pyx_PyNumber_IntOrLongWrongResultType(PyObject* result, const char* type_name) {
 #if PY_MAJOR_VERSION >= 3
     if (PyLong_Check(result)) {
         if (PyErr_WarnFormat(PyExc_DeprecationWarning, 1,
                 "__int__ returned non-int (type %.200s).  "
                 "The ability to return an instance of a strict subclass of int "
                 "is deprecated, and may be removed in a future version of Python.",
@@ -26938,15 +26945,15 @@
   Py_ssize_t ival;
   PyObject *x;
 #if PY_MAJOR_VERSION < 3
   if (likely(PyInt_CheckExact(b))) {
     if (sizeof(Py_ssize_t) >= sizeof(long))
         return PyInt_AS_LONG(b);
     else
-        return PyInt_AsSsize_t(b);
+        return PyInt_AsSsize_t(x);
   }
 #endif
   if (likely(PyLong_CheckExact(b))) {
     #if CYTHON_USE_PYLONG_INTERNALS
     const digit* digits = ((PyLongObject*)b)->ob_digit;
     const Py_ssize_t size = Py_SIZE(b);
     if (likely(__Pyx_sst_abs(size) <= 1)) {
@@ -26992,16 +26999,13 @@
   }
   x = PyNumber_Index(b);
   if (!x) return -1;
   ival = PyInt_AsSsize_t(x);
   Py_DECREF(x);
   return ival;
 }
-static CYTHON_INLINE PyObject * __Pyx_PyBool_FromLong(long b) {
-  return b ? __Pyx_NewRef(Py_True) : __Pyx_NewRef(Py_False);
-}
 static CYTHON_INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t ival) {
     return PyInt_FromSize_t(ival);
 }
 
 
 #endif /* Py_PYTHON_H */
```

### Comparing `peewee-3.9.5/playhouse/kv.py` & `peewee-3.9.6/playhouse/kv.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/sqliteq.py` & `peewee-3.9.6/playhouse/sqliteq.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/shortcuts.py` & `peewee-3.9.6/playhouse/shortcuts.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/_pysqlite/prepare_protocol.h` & `peewee-3.9.6/playhouse/_pysqlite/prepare_protocol.h`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/_pysqlite/cursor.h` & `peewee-3.9.6/playhouse/_pysqlite/cursor.h`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/_pysqlite/connection.h` & `peewee-3.9.6/playhouse/_pysqlite/connection.h`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/_pysqlite/util.h` & `peewee-3.9.6/playhouse/_pysqlite/util.h`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/_pysqlite/row.h` & `peewee-3.9.6/playhouse/_pysqlite/row.h`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/_pysqlite/backup.h` & `peewee-3.9.6/playhouse/_pysqlite/backup.h`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/_pysqlite/cache.h` & `peewee-3.9.6/playhouse/_pysqlite/cache.h`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/_pysqlite/sqlite_constants.h` & `peewee-3.9.6/playhouse/_pysqlite/sqlite_constants.h`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/_pysqlite/microprotocols.h` & `peewee-3.9.6/playhouse/_pysqlite/microprotocols.h`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/_pysqlite/module.h` & `peewee-3.9.6/playhouse/_pysqlite/module.h`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/_pysqlite/statement.h` & `peewee-3.9.6/playhouse/_pysqlite/statement.h`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/apsw_ext.py` & `peewee-3.9.6/playhouse/apsw_ext.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/hybrid.py` & `peewee-3.9.6/playhouse/hybrid.py`

 * *Files identical despite different names*

### Comparing `peewee-3.9.5/playhouse/dataset.py` & `peewee-3.9.6/playhouse/dataset.py`

 * *Files identical despite different names*

